(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[39],{1400:function(A,F,b){function a(T){var H=ba.call(this)||this;H.Oc=T;H.dc();return H}function c(T,H){var S=this;this.fge=this.yKc=!1;this.vEb=function(K,da){(null===da||void 0===da?0:da.gH)&&Q.a.qLg([da.gH])&&(S.suc=!0)};this.Hq=function(){S.suc=!1};this.$c=function(K,da){U.b(da)&&S.Fea(!0);S.suc=!1};this.rd=function(){S.iR=S.$.iR;S.Fea()};this.TCf=function(){S.HS()};this.WBf=function(){S.iR=S.$.iR};this.Bzd=function(){la.g(S.$).Ca.Kq(S.Bzd);
S.iR=S.$.iR};this.lWf=H;this.$=T;this.$.userOperationManager.lx(this.WBf);this.$.Qk(this.rd);this.$.ea.YGg(this.TCf);this.$.ea.Uj(this.$c);this.$.sVc(this.vEb);this.$.ea.RP(this.Hq);this.Fea()}function e(){this.jQc=this.mPc=this.qlb=this.tb=null}function l(T,H,S,K){this.nga=this.gga=this.rga=this.qga=null;this.bEa=0;this.RD=this.iQc=this.rCa=this.TEc=this.YEa=null;this.Vd=T;this.S8=H;this.J1=S;this.kj=K;this.r9d=!0;this.eM=!1;this.Vz=3;this.jra=!0}function n(T,H){this.gs=null;this.qga=CommonUIStrings.l_SavedStatus;
this.rga=CommonUIStrings.l_SavingStatus;this.gga=CommonUIStrings.l_ReadOnlyStatus;this.nga=CommonUIStrings.l_ReviewModeStatus;this.sSb=H;this.J1=T;this.Vz=3;this.jra=!0}function m(T){this.nga=this.gga=this.rga=this.qga=null;this.T$d=this.Ww=this.eM=!1;this.wPc=this.hae=null;this.$$d=0;this.wb=this.fae=null;this.J1=T;this.Vz=3;this.Xib=!0}b.r(F);A=b(0);var f=b(80),x=b(13),y=b(168),t=b(47);m.prototype.initialize=function(T,H,S){var K=this;this.qga=this.Pgd(T,H);this.rga=CommonUIStrings.l_SavingStatus;
this.gga=CommonUIStrings.l_ReadOnlyStatus;this.nga=CommonUIStrings.l_ReviewModeStatus;this.J1&&this.J1.execute(function(da){da.nVc(Object(f.a)(K,K.ONb,"updateToSavingStatus"))});this.Ww=!0;this.wb=S;return!0};m.prototype.Fea=function(T,H){this.eM=T;this.Vz=H;this.HS(this.Xib)};m.prototype.HS=function(T){!this.Xib&&T&&(this.fae=new Date);this.Xib=T;T=null;3===this.Vz&&(T=this.Xib?this.qga:this.rga);this.Zfh(T)};m.prototype.Pgd=function(T,H){return T?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):
H&&H.length?String.format(CommonUIStrings.l_SavedToStatus,H):CommonUIStrings.l_SavedStatus};m.prototype.ONb=function(){this.HS(!1)};m.prototype.WTh=function(){switch(this.Vz){case 1:return this.gga;case 2:return this.nga;default:return null}};m.prototype.Hhi=function(T){return this.T$d===this.eM&&this.$$d===this.Vz&&this.hae===T};m.prototype.XIe=function(T){var H=this;appChrome.getHeaderApi().then(function(S){S.updateDocumentTitleStatus(H.eM,T,H.WTh(),H.fae,H.Xib);return null});this.wPc=null};m.prototype.Zfh=
function(T){var H=this;this.Ww&&y.c()&&!this.Hhi(T)&&(t.a.lTf()?(this.wPc&&x.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.wPc=window.requestIdleCallback(function(){H.XIe(T)})):window.requestAnimationFrame(function(){H.XIe(T)}),this.T$d=this.eM,this.hae=T,this.$$d=this.Vz)};Object(A.a)(m,"ReactSaveStatusUIHandler",null,[332]);var B=b(170);n.prototype.hv=function(){var T=this;this.J1&&this.J1.execute(function(H){H.nVc(Object(f.a)(T,T.ONb,
"updateToSavingStatus"))});this.sSb.execute(function(H){T.gs=H})};n.prototype.Fea=function(T,H){this.Vz=H;3===H?this.HS(this.jra):2===H?this.iXd(this.nga):this.iXd(this.gga)};n.prototype.ONb=function(){this.HS(!1)};n.prototype.HS=function(T){this.jra=T;this.iXd(this.jra?this.qga:this.rga)};n.prototype.iXd=function(T){this.gs&&this.gs.Sj(B.a.mPj,this.T1g(T))};n.prototype.T1g=function(T){var H={};H.StatusText=T;return H};Object(A.a)(n,"SaveStatusPostMessageHandler",null,[332]);var z=b(833),u=b(165),
C=b(87);l.prototype.initialize=function(T,H){if(!this.Vd)return!1;this.qga=this.Pgd(T,H);this.rga=CommonUIStrings.l_SavingStatus;this.gga=CommonUIStrings.l_ReadOnlyStatus;this.nga=CommonUIStrings.l_ReviewModeStatus;this.hv();return!0};l.prototype.Pgd=function(T,H){return T?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):H&&H.length?String.format(CommonUIStrings.l_SavedToStatus,H):CommonUIStrings.l_SavedStatus};l.prototype.hv=function(){var T=this;this.S8&&this.S8.execute(function(H){H.xGg(Object(f.a)(T,
T.sFe,"createStatusAndModeElements"));H.oGg(Object(f.a)(T,T.yBj,"showHideSaveStatusElement"));H.yMj&&T.sFe(null,null)});this.J1&&this.J1.execute(function(H){H.nVc(Object(f.a)(T,T.ONb,"updateToSavingStatus"))})};l.prototype.wv=function(){this.RD&&this.Vd&&this.Vd.oG(this.RD)};l.prototype.yBj=function(T,H){this.Fea("true"===H,this.Vz)};l.prototype.Fea=function(T,H){this.eM=T;this.Vz=H;this.TEc&&(this.TEc.style.display=this.eM||3===this.Vz||!this.YEa?"none":"");this.rCa&&(this.rCa.style.display=this.eM||
3===this.Vz?"none":"",this.rCa.innerText=1===this.Vz?this.gga:this.nga,this.rCa.title=1===this.Vz?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.iQc&&(this.iQc.style.display=this.eM||1===this.Vz||!this.YEa&&!this.rCa?"none":"");this.RD&&(this.RD.style.display=this.eM||1===this.Vz?"none":"",this.HS(this.jra),this.RD.title=CommonUIStrings.l_SaveStatusTooltip)};l.prototype.sFe=function(T,H){T=document.getElementById(z.CuiHelper.V8e);H&&H.vYj||!T||""===this.qga||
""===this.rga||""===this.gga||""===this.nga||(this.YEa=document.getElementById(z.CuiHelper.r0b),this.TEc=z.CuiHelper.hta(T,"BreadcrumbAppModeDash","-",null,!1),this.rCa=z.CuiHelper.hta(T,"BreadcrumbAppModeStatus",1===this.Vz?this.gga:this.nga,null,!1),this.xdg(this.rCa),this.iQc=z.CuiHelper.hta(T,"BreadcrumbSaveStatusDash","-",null,!1),this.RD=z.CuiHelper.hta(T,"BreadcrumbSaveStatus",this.qga,null,!1),this.xdg(this.RD),this.Fea(this.eM,this.Vz))};l.prototype.ONb=function(){this.HS(!1)};l.prototype.HS=
function(T){this.jra=T;this.eUj(this.jra?this.qga:this.rga)};l.prototype.eUj=function(T){!this.RD||3!==this.Vz&&2!==this.Vz||(this.r9d&&!this.jra?(this.bEa=this.RD.offsetWidth<this.bEa?this.bEa:this.RD.offsetWidth,this.jRj(this.rga),this.r9d=!1):this.RD.innerText=T)};l.prototype.xdg=function(T){T.style.direction=this.kj?"rtl":"ltr";T.style.width="auto";T.style.textAlign=this.kj?"right":"left";T.style.display=this.eM?"none":"";T.setAttribute("Unselectable","on")};l.prototype.jRj=function(T){this.RD&&
(this.RD.style.width="",this.RD.innerText=T,this.bEa=this.RD.offsetWidth<this.bEa?this.bEa:this.RD.offsetWidth,T=u.a.WA(this.RD),this.RD.style.width=this.bEa-C.a.dD(T.paddingLeft)-C.a.dD(T.paddingRight)+1+"px")};Object(A.a)(l,"SaveStatusUIHandler",null,[332]);var r=b(5),J=b(97);e.prototype.ji=function(T){var H=this;this.tb=T;r.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?this.tb.register(n,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Bc().Lc(function(){return new n(H.tb.oc("Common.App.HostNotification.EditNotificationEventSource"),
H.tb.oc("Postmessage.IHostPostmessenger"))}):r.AFrameworkApplication.sa.Qa.nif||(r.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled?this.tb.register(m,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Bc().Lc(function(){return new m(H.tb.oc("Common.App.HostNotification.EditNotificationEventSource"))}):this.tb.register(l,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").Bc().Lc(function(){return new l(J.EventHandlerManager.instance,
H.tb.oc("Common.App.Header.HeaderEventSource"),H.tb.oc("Common.App.HostNotification.EditNotificationEventSource"),r.AFrameworkApplication.isRtl)}))};e.prototype.init=function(){r.AFrameworkApplication.ga.ow(Object(f.a)(this,this.lB,"onFullAppSettingsReady"))};e.prototype.lB=function(){var T=r.AFrameworkApplication.ga,H=!!r.AFrameworkApplication.sa.Qa&&4===r.AFrameworkApplication.sa.Qa.Pj;if(T.ra("WordEditorAutoSaveImprovementIsEnabled")||T.ra("PptEditorSaveStatusInHeaderEnabled")||H&&T.ra("SimplifiedReactRibbonUxIsEnabled")||
T.ra("ExcelSaveStatusInHeaderEnabled")||T.ra("VisioSaveStatusInHeaderEnabled"))r.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?(this.jQc=this.tb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.jQc.hv():r.AFrameworkApplication.sa.Qa.nif||(r.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled?(this.mPc=this.tb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.mPc.initialize(T.ra("IsSkyDrive"),T.Ua("HostNameToIncludeInSavedStatus"),
r.AFrameworkApplication.ga):(this.qlb=this.tb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.qlb.initialize(T.ra("IsSkyDrive"),T.Ua("HostNameToIncludeInSavedStatus")))};e.prototype.dispose=function(){this.qlb&&this.qlb.wv()};Sk.Object.defineProperties(e.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveStatus"}}});Object(A.a)(e,"PackageManager",null,[4,5]);F=b(273);var v=b(10),D=b(86),V=b(214),U=b(217),Q=b(27),la=b(20);c.prototype.dispose=function(){this.$&&
(this.$.pl(this.rd),this.$.CJd(this.vEb),this.$.userOperationManager&&this.$.userOperationManager.jv(this.WBf),this.$.ea&&(this.$.ea.Wdj(this.TCf),this.$.ea.lk(this.$c),this.$.ea.QW(this.Hq)),la.g(this.$)&&la.g(this.$).Ca&&la.g(this.$).Ca.Kq(this.Bzd))};c.prototype.Fea=function(T){T=!this.$.isEditMode||(void 0===T?!1:T);this.lWf.Fea(T,this.$.isEditMode?3:1);this.HS()};c.prototype.HS=function(){this.$.isEditMode&&this.lWf.HS(!this.iR&&!this.qri&&!this.suc)};Sk.Object.defineProperties(c.prototype,{qri:{configurable:!0,
enumerable:!0,get:function(){return this.$.ea?this.$.ea.Jkf:!1}},iR:{configurable:!0,enumerable:!0,get:function(){return this.yKc},set:function(T){T?this.yKc=!0:la.g(this.$)&&la.g(this.$).Ca&&(la.g(this.$).Ca.HH()?this.yKc=!1:la.g(this.$).Ca.Fp(this.Bzd));this.HS()}},suc:{configurable:!0,enumerable:!0,get:function(){return this.fge},set:function(T){this.fge=T;this.HS()}}});Object(A.a)(c,"SaveStatusManager",null,[3]);var ba=V.a;vm(a,ba);a.prototype.create=function(){var T=this,H=D.a.instance;H.oc("Common.App.SaveStatus.ISaveStatusUIHandler").execute(function(S){var K=
new c(T.Oc,S);H.register(c,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").Bc().Lc(function(){return K});T.Fb(H.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"))})};a.ja=function(T){T.da.Ha(299,new a(T))};Object(A.a)(a,"SaveStatusFactory",V.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.SaveStatus");F.a.instance.sj(new e);v.a.Ga(a.ja)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.savestatus.js.map/fed4bbeffd24e0adb1d7f1b741dfd260/EwaDS.savestatus.js.map