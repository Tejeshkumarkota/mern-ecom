(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[40],{1401:function(A,F,b){function a(Ka){var Ta=ma.call(this)||this;Ta.$=Ka;Ta.dc();return Ta}function c(Ka){var Ta=hc.call(this,Ka)||this;Ta.FAb=null;Ta.vxa=null;Ta.zoomEventManager=null;Ta.KAb=-1;Ta.yef=!1;Ta.nd=function(){Ta.KAb=-1};t.ULS.sendTraceTag(537149785,0,50,"AppZoom feature is Enabled.");Ta.Efb=new e(Ka);Ta.zZi()&&(t.ULS.sendTraceTag(537149784,0,50,"ZoomManager.ZoomManager Attaching pinch to zoom events"),Ta.kMg());
Ta.L$i();return Ta}function e(Ka){var Ta=jb.call(this)||this;Ta.statusBarManager=null;Ta.cWe=!1;Ta.$=Ka;Ta.$.da.Za(29,function(ob){Ta.statusBarManager=ob;ob.xJ(Ta)});return Ta}function l(){return db.call(this)||this}function n(Ka){this.A5a=this.Eec=0;this.z1b=null;this.Aef=!1;this.$=Ka;this.Aef=Ka.tic}function m(Ka){return D.call(this,Ka)||this}function f(Ka){this.$=Ka}b.r(F);var x=b(10);A=b(0);var y=b(817),t=b(13),B=b(958),z=b(8),u=b(77),C=b(175),r=b(372),J=b(34),v=b(52);f.prototype.Yc=function(){return!1};
f.prototype.executeCommand=function(Ka,Ta,ob){var Cb=!1;Ka=Ta.command;var eb=J.a(this.$);11!==Ta.af&&7!==Ta.af&&6!==Ta.af&&2!==Ta.af&&14!==Ta.af&&15!==Ta.af&&16!==Ta.af&&t.ULS.sendTraceTag(537149787,0,15,"ZoomCommandHandler.ExecuteCommand - unsupported zoom origin {0}",Ta.af);var ya=6===Ta.af;switch(Ta.command){case -1365094462:case -1441674458:eb.oDc(Math.floor(10*eb.zoom)/10+.1,ya);Cb=!0;break;case 1056010365:case 1664364901:eb.oDc(Math.ceil(10*eb.zoom)/10-.1,ya);Cb=!0;break;case 346087880:eb.oDc(z.a.ica,
ya);Cb=!0;break;case -1918142559:case 1517993347:u.a.ld in ob?(ob=parseFloat(ob[u.a.ld]),ob!==eb.zoom&&eb.nDc(ob,1517993347===Ta.command),Cb=!0):t.ULS.shipAssertTag(537149786,0,!1,"ZoomCommandHandler.ExecuteCommand - no MenuItemIdKey");break;case -2096586688:case -581733362:Ta=parseFloat(ob[B.a.Value]);isNaN(Ta)||eb.nDc(Ta/100,!0);Cb=!0;break;case 1409187195:eb.zoomFitToScreen();Cb=!0;break;case -1836771825:eb.zoomFitToScreenUndo(),Cb=!0}return Cb?v.Task.Ta(!0):C.a(Ka)};f.prototype.Jc=function(Ka,
Ta){switch(Ta.command){case -1441674458:case 1664364901:case -1918142559:case 346087880:case 1517993347:case -581733362:case 1409187195:case -1836771825:return J.a(this.$).FX();case -1365094462:case 1056010365:case -2096586688:return r.a(this.$);default:return!1}};f.prototype.fd=function(){return!1};Object(A.a)(f,"ZoomCommandHandler",null,[188]);var D=y.a;vm(m,D);m.prototype.Od=function(){this.Fd([new f(this.$)])};m.ja=function(Ka){y.a.fe(370,new m(Ka))};Object(A.a)(m,"ZoomCommandHandlerFactory",
y.a,[]);F=b(214);var V=b(88),U=b(23),Q=b(86),la=b(567),ba=b(45),T=b(4),H=b(153),S=b(61),K=b(283),da=b(126),fa=b(43),X=b(39),ca=b(11),ja=b(1),ea=b(9),qa=b(102),pa=b(105),Pa=b(20),Ha=b(300),Xa=b(127);n.prototype.iji=function(){return Pa.g(this.$).isEditing?(t.ULS.sendTraceTag(537149795,0,50,"PinchToZoomAdapter.IsGesturePossible A cell is being edited -> don't allow pinch"),!1):this.$.Ab.TC?(t.ULS.sendTraceTag(537149794,0,50,"PinchToZoomAdapter.IsGesturePossible A modal dialog is opened -> don't allow pinch"),
!1):!0};n.prototype.RLi=function(Ka){this.z1b=new Sys.UI.Point(Math.round(Ka.Xua.center.x),Math.round(Ka.Xua.center.y));this.Eec=J.a(this.$).zoom;this.A5a=Ka.Xua.scale;var Ta={};Ta=(Ta.InitialZoom=this.Eec,Ta.Location="canvas",Ta.InputMethod=Ka.yb,Ta);Xa.b(this.$).ee(da.a.yZi,Ta);t.ULS.sendTraceTag(537149793,0,50,"PinchToZoomAdapter.OnGestureStart starting gesture. center ({0},{1}), initial zoom {2}, initial scale {3}",this.z1b.x,this.z1b.y,this.Eec,this.A5a);this.v8a(Ka,"onGestureStart");return!0};
n.prototype.QLi=function(Ka){if(!this.A5a)return t.ULS.shipAssertTag(537149792,0,!1,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be 0"),this.v8a(Ka,"OnGestureEvent"),!0;if(!isFinite(this.A5a))return t.ULS.sendTraceTag(537149791,0,15,"PinchToZoomAdapter:OnGestureEvent initialPinchScale should never be infinite. initialPinchScale={0}",this.A5a),this.v8a(Ka,"OnGestureEvent"),!0;var Ta=Ka.Xua.scale/this.A5a*this.Eec;J.a(this.$).Fhg(Ta,this.z1b);t.ULS.sendTraceTag(537149790,0,50,"PinchToZoomAdapter.OnGestureEvent processing gesture. New zoom {0}. Current scale {1}",
Ta,Ka.Xua.scale);this.v8a(Ka,"OnGestureEvent");return!0};n.prototype.PLi=function(Ka){J.a(this.$).Ghg();t.ULS.sendTraceTag(537149789,0,50,"PinchToZoomAdapter.OnGestureEnd end of gesture");this.v8a(Ka,"OnGestureEnd")};n.prototype.OLi=function(Ka){t.ULS.sendTraceTag(537149788,0,50,"PinchToZoomAdapter.OnGestureCancel gesture canceled");this.v8a(Ka,"OnGestureCancel")};n.prototype.v8a=function(Ka,Ta){var ob,Cb,eb;this.Aef&&(t.ULS.sendTraceTag(536990857,0,50,"PinchToZoomAdapter.markGestureEventAsHandled - Invoked from {0},        eventArgs non-null: {1}, gestureData non-null: {2},        srcEvent non-null: {3}",
Ta,isNullOrUndefined(Ka),isNullOrUndefined(null===Ka||void 0===Ka?void 0:Ka.Xua),isNullOrUndefined(null===(ob=null===Ka||void 0===Ka?void 0:Ka.Xua)||void 0===ob?void 0:ob.srcEvent)),null===(eb=null===(Cb=null===Ka||void 0===Ka?void 0:Ka.Xua)||void 0===Cb?void 0:Cb.srcEvent)||void 0===eb?void 0:eb.preventDefault())};Object(A.a)(n,"PinchToZoomAdapter",null,[359]);var Na=b(36),db=Na.a;vm(l,db);l.prototype.ape=function(Ka){this.addHandler("ZCIEK",Ka)};l.prototype.IRf=function(Ka){this.removeHandler("ZCIEK",
Ka)};l.prototype.$oe=function(Ka){this.addHandler("ZCUIK",Ka)};l.prototype.HRf=function(Ka){this.removeHandler("ZCUIK",Ka)};l.prototype.PHg=function(Ka){this.addHandler("ZCEK",Ka)};l.prototype.Dej=function(Ka){this.removeHandler("ZCEK",Ka)};l.prototype.x5i=function(){this.raiseEvent("ZCIEK")};l.prototype.w5i=function(){this.raiseEvent("ZCUIK")};l.prototype.y5i=function(){this.raiseEvent("ZCEK")};Object(A.a)(l,"ZoomEventManager",Na.a,[289]);var Ja=b(19),jb=Na.a;vm(e,jb);e.prototype.tq=function(Ka){this.addHandler("Zoom",
Ka)};e.prototype.Mq=function(Ka){this.removeHandler("Zoom",Ka)};e.prototype.vz=function(){this.kn("QueryZoomStatus")&&this.raiseEvent("Zoom")};e.prototype.$r=function(Ka,Ta){return"QueryZoomStatus"!==Ka?!1:this.Y4h(Ta)};e.prototype.kn=function(){return J.a(this.$).FX()};e.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.RF(this),this.statusBarManager=null);this.$=null;jb.prototype.dispose.call(this)};e.prototype.i5e=function(Ka){Ka=this.A1h(Ka);if(!Ka)return null;Ka=Ka.getElementsByClassName("cui-ctl-mediumlabel");
return 1!==Ka.length?(t.ULS.shipAssertTag(537149764,0,!1,"ZoomStatusBarManager.GetZoomUIElement Cannot find zoom label element"),null):Ka[0]};e.prototype.Y4h=function(Ka){if(!this.$)return!1;var Ta=J.a(this.$).GOb,ob=this.i5e("HandleQueryZoomStatusCommand");ob?Ja.a.equals(Ka.LabelText.toString(),Ta,!1)||(ob.innerText="",this.F_f(Ka,Ta)):this.F_f(Ka,Ta);return!0};e.prototype.F_f=function(Ka,Ta){Ka.LabelText=Ta};e.prototype.A1h=function(Ka){var Ta=ca.DOMElementExtensions.getElementById(this.$.domElement,
"m_excelWebRenderer_ewaCtl_zoomLevel-Medium14");if(!Ta)return Ta=(Ta=this.$.ea.nc)?Ta.inEmbedView:!1,U.a.Xp||Ta||t.ULS.sendTraceTag(537149763,0,15,"ZoomStatusBarManager.GetZoomBaseElement Cannot find zoom label. Called from {0}",Ka),null;this.cWe||(this.cWe=!0,t.ULS.sendTraceTag(537149762,0,50,"ZoomManager.GetZoomBaseElement - Zoom label was found first time. Called from {0}",Ka));return Ta};Object(A.a)(e,"ZoomStatusBarManager",Na.a,[3,185,186]);var hc=la.a;vm(c,hc);c.prototype.dispose=function(){this.Efb&&
(V.a.Fa(this.Efb),this.Efb=null);this.zoomEventManager&&(this.$.da.OU(419),this.zoomEventManager=null);this.yef&&this.Ceh();hc.prototype.dispose.call(this)};c.prototype.FX=function(){return!0};c.prototype.Fhg=function(Ka,Ta){Ka=this.Fua(Ka);if(Pa.g(this.$).rtl){var ob=Math.round(ca.DOMElementExtensions.getBounds(this.$.tf).width*J.a(this.$).zoom);this.FAb=new Sys.UI.Point(ob-Ta.x,Ta.y)}else this.FAb=Ta;this.xAa(Ka,!1,"ZoomWithPinch")};c.prototype.mDc=function(){return!0};c.prototype.lDc=function(Ka,
Ta){var ob=U.a.isMac?.07:.15;Ka=this.zoom+(Ka?ob:-ob);Ka=this.Fua(Ka);Pa.g(this.$).rtl?(ob=Math.round(ca.DOMElementExtensions.getBounds(this.$.tf).width*J.a(this.$).zoom),this.vxa=new Sys.UI.Point(ob-Ta.x,Ta.y)):this.vxa=Ta;Ta=this.zoom;this.xAa(Ka,!0,"ZoomWithMouse");ob={};Ta=(ob.InitialZoom=Ta,ob.FinalZoom=Ka,ob.Location="canvas",ob);Xa.b(this.$).ee(da.a.zZj,Ta)};c.prototype.Ghg=function(){this.FAb=null};c.prototype.nDc=function(Ka,Ta){this.xAa(this.Fua(Ka),!1,Ta?"ZoomWithDropDownFromRibbon":"ZoomWithDropDown")};
c.prototype.Hhg=function(Ka){isNaN(Ka)?t.ULS.sendTraceTag(537149783,0,15,"ZoomManager.ZoomToSelectionForFollowAlongInExcelLive: Invalid zoom value was provided"):this.xAa(this.Fua(Ka),!1,"ZoomToLevelInExcelLive")};c.prototype.Ihg=function(Ka){this.xAa(this.Fua(Ka),!1,"ZoomWithActionPen")};c.prototype.oDc=function(Ka,Ta){this.xAa(this.Fua(Ka),!0,Ta?"ZoomWithShortcuts":"ZoomWithButtons")};c.prototype.f3e=function(Ka,Ta){var ob=Pa.g(this.$).rtl,Cb=yl(this.mgd(ob));ob=Cb.next().value;Cb=Cb.next().value;
var eb=yl(this.Yhd(Ka,Cb)),ya=eb.next().value;eb=eb.next().value;return this.vxa?(Ka=this.Sfd(this.vxa,Ka,Ta,Cb,ob,"ZoomWithMouse"),this.vxa=null,Ka):this.FAb?this.Sfd(this.FAb,Ka,Ta,Cb,ob,"ZoomWithPinch"):Pa.g(this.$).ha.Pa.i5?this.yZj(Ka,Ta,Cb,ob,ya,eb,Pa.g(this.$).rtl):this.AZj(Ka,Ta,Cb,ob,ya,eb,Pa.g(this.$).rtl)};c.prototype.fXf=function(Ka,Ta,ob){Ka?(t.ULS.sendTraceTag(537149782,0,50,"Zoom To: ({0} {1}) (new top-left) from zoom:{2} to zoom:{3}",Ka.x,Ka.y,Ta,ob),Ka=new ba.a(Ka.x,Ka.y),ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6055130_UseViewportInDocumentCoordinatesForZoomScroll")?
(ob=Pa.g(this.$).rtl,ob=yl(this.mgd(ob)),ob.next(),ob=ob.next().value,ob=yl(this.Yhd(Ta,ob)),Ta=ob.next().value,ob=ob.next().value):(Ta=Pa.g(this.$).view.visibleArea.width,ob=Pa.g(this.$).view.visibleArea.height),Pa.g(this.$).Bpe(Ka,Ta,ob,pa.a.xKg)):t.ULS.sendTraceTag(537149781,0,50,"Zooming top-left: from zoom:{0} to zoom:{1}",Ta,ob)};c.prototype.zoomFitToScreen=function(){var Ka=this.zoom,Ta=Pa.g(this.$).rtl,ob=yl(this.mgd(Ta)),Cb=ob.next().value,eb=ob.next().value,ya=yl(this.Yhd(Ka,eb));ob=ya.next().value;
var za=ya.next().value;(Ta=(ya=Pa.g(this.$).ha.Pa.i5)?this.v_e(this.HEb,ob,za,!1):this.m3e(this.HEb,eb,Cb,ob,za,Ta,!1))?(Ta=Math.min(ob/(Ta.width+100),za/(Ta.height+100)),Ta=this.RDh(Ta),this.xAa(Ta,!0,"ZoomWithFitToScreen"),ya?Pa.g(this.$).ha.Pa.Gsa(Pa.g(this.$).ha.Pa.lc,!1):(Ta=fa.v(Pa.g(this.$).ha.va.activeRange,this.$),Pa.g(this.$).Vg(Ta,null,null,null,3,pa.a.xZj)),this.KAb=Ka,this.yef||this.hMg()):t.ULS.sendTraceTag(537149780,0,15,"ZoomManager.ZoomFitToScreen: Bounds found to be null with FloatingObjectSelected: {0}",
ya)};c.prototype.zoomFitToScreenUndo=function(){this.xAa(this.KAb,!1,"ZoomWithFitToScreen")};c.prototype.lRd=function(){return-1!==this.KAb};c.prototype.hMg=function(){var Ka=Pa.g(this.$);Ka&&(Ka.ha.OG(this.nd),Ka.cE(this.nd))};c.prototype.Ceh=function(){var Ka=Pa.g(this.$);Ka&&(Ka.ha.WF(this.nd),Ka.UF(this.nd))};c.prototype.RDh=function(Ka){Ka=Math.min(Ka,z.a.kAi);Ka=Math.max(Ka,z.a.nBi);return Math.round(100*Ka)/100};c.prototype.xAa=function(Ka,Ta,ob){if(this.jDc()){var Cb=Pa.g(this.$).view.visibleArea.toString();
Ka=this.Fua(Ka);var eb=S.d(this.$.xa.pa);eb||(eb=la.a.Msf);Pa.g(this.$).Mi.C7(5,Ha.a.iDc,ob);Pa.g(this.$).Mi.Bla(Ha.a.iDc,this.$.ea.uf);t.ULS.sendTraceTag(537149779,0,50,"ZoomManager.SetNewZoomLevel Setting zoom {0} to sheet {1} origin {2} prevZoom {3}",Ka,eb,ob,this.zoom);this.jvj(eb,Ka);this.zoomEventManager.y5i();this.wNj(ob);this.DNj(Ta);this.KAb=-1;r.b(this.$,ob);t.ULS.sendTraceTag(537149778,0,50,"ZoomManager.SetNewZoomLevel OldGridVisibleArea: {0}, NewGridVisibleArea: {1}, IsShyRibbonActive: {2}",
Cb,Pa.g(this.$).view.visibleArea.toString(),this.$.Yka)}};c.prototype.cNh=function(Ka){return(Ka=ea.HelperMethods.YA(this.$.tf,this.$.domElement,Ka))?Ka:new Sys.UI.Point(0,0)};c.prototype.mgd=function(Ka){var Ta=this.cNh(Ka);Ka=this.ORh(Ta,Ka);return[Ta,Ka]};c.prototype.Yhd=function(Ka,Ta){var ob=ca.DOMElementExtensions.getBounds(this.$.tf);return[Math.round((ob.width-Ta.x)*Ka),Math.round((ob.height-Ta.y)*Ka)]};c.prototype.ORh=function(Ka,Ta){Ta=ea.HelperMethods.YA(Pa.g(this.$).domElement,this.$.domElement,
Ta);return Ta?(Ka=new Sys.UI.Point(Math.round(Ta.x-Ka.x),Math.round(Ta.y-Ka.y)),Ka):new Sys.UI.Point(0,0)};c.prototype.AZj=function(Ka,Ta,ob,Cb,eb,ya,za){return(za=this.m3e(Ka,ob,Cb,eb,ya,za))?this.m2e(za,Ka,Ta,ob,Cb,eb,ya):null};c.prototype.m3e=function(Ka,Ta,ob,Cb,eb,ya,za){za=void 0===za?!0:za;var Ga=fa.F(Pa.g(this.$).ha.va.selectedRanges);if(za&&(Ga=Ga.zf(fa.F(Pa.g(this.$).kcc())),!Ga))return t.ULS.sendTraceTag(537149777,0,50,"ZoomManager.GetSelectedRangeBounds No range inside the viewport is selected."),
null;var cb=Pa.g(this.$).uc(Ga.topLeft);Ga=Pa.g(this.$).uc(Ga.bottomRight);if(!cb||!Ga)return t.ULS.sendTraceTag(537149776,0,15,"ZoomManager.GetSelectedRangeBounds Cannot get cells for top-left or bottom-right of the selected range. Will zoom top-left"),null;Ka=cb.cell.rK===Ga.cell.rK&&cb.cell.qK===Ga.cell.qK?this.ULh(Ka,Ga,Ta,ob,Cb,ya):this.p0h(Ka,cb,Ga,Ta,ob,Cb,ya);return Ka?za?this.VUe(Ka,Cb,eb):Ka:(t.ULS.sendTraceTag(537149775,0,15,"ZoomManager.GetSelectedRangeBounds got null bounds"),null)};
c.prototype.VUe=function(Ka,Ta,ob){if(0>Ka.x||Ka.x>Ta)Ka.x=0;if(0>Ka.y||Ka.y>ob)Ka.y=0;Ka.x+Ka.width>Ta&&(Ka.width=Ta-Ka.x);Ka.y+Ka.height>ob&&(Ka.height=ob-Ka.y);return Ka};c.prototype.p0h=function(Ka,Ta,ob,Cb,eb,ya,za){Ta=Pa.g(this.$).getCellBounds(Ta.cell);if(!Ta)return null;var Ga=Pa.g(this.$).getCellBounds(ob.cell);if(!Ga)return null;var cb=eb.x;za&&(cb=0,Ta.x=Math.round(ya/Ka)-Ta.x-Math.round(Ta.width),Ga.x=Math.round(ya/Ka)-Ga.x-Math.round(Ga.width));Ka=new Sys.UI.Bounds(Math.round((Ta.x-Cb.x)*
Ka)-cb,Math.round((Ta.y-Cb.y)*Ka-eb.y),Math.round((Ga.x+Ga.width-Ta.x)*Ka),Math.round((Ga.y+Ga.height-Ta.y)*Ka));t.ULS.sendTraceTag(537149774,0,50,"ZoomManager.GetTwoCellsBoundsWithZoom - a range with more than 1 cell was selected. Will zoom to range: (t:{0}, b:{1}, r:{2}, l:{3}) in bounds ({4}, {5}, {6}, {7})",ob.cell.getRange().top,ob.cell.getRange().bottom,ob.cell.getRange().right,ob.cell.getRange().left,Ka.x,Ka.y,Ka.width,Ka.height);return Ka};c.prototype.ULh=function(Ka,Ta,ob,Cb,eb,ya){var za=
Pa.g(this.$).getCellBounds(Ta.cell);if(!za)return null;var Ga=Cb.x;ya&&(Ga=0,za.x=Math.round(eb/Ka)-za.x-Math.round(za.width));Ka=new Sys.UI.Bounds(Math.round((za.x-ob.x)*Ka)-Ga,Math.round((za.y-ob.y)*Ka-Cb.y),Math.round(za.width*Ka),Math.round(za.height*Ka));t.ULS.sendTraceTag(537149773,0,50,"ZoomManager.GetCellBoundsWithZoom - single cell was selected. Will zoom to cell: (t:{0}, l:{1}) in bounds ({2}, {3}, {4}, {5})",Ta.cell.getRange().top,Ta.cell.getRange().left,Ka.x,Ka.y,Ka.width,Ka.height);return Ka};
c.prototype.yZj=function(Ka,Ta,ob,Cb,eb,ya){var za=this.v_e(Ka,eb,ya);return za?this.m2e(za,Ka,Ta,ob,Cb,eb,ya):null};c.prototype.m2e=function(Ka,Ta,ob,Cb,eb,ya,za){Ka=new Sys.UI.Point(this.M2e(ya,Ka.x,Ka.width),this.M2e(za,Ka.y,Ka.height));return this.Sfd(Ka,Ta,ob,Cb,eb)};c.prototype.M2e=function(Ka,Ta,ob){return Ka===ob?(t.ULS.sendTraceTag(537149772,0,50,"ZoomManager.GetRelativePointCoordinate returning size/2 since the bounds are the same as the grid bounds"),Ka/2):Ka*Ta/(Ka-ob)};c.prototype.v_e=
function(Ka,Ta,ob,Cb){Cb=void 0===Cb?!0:Cb;var eb=Pa.g(this.$).ha.Pa.lc.domElement,ya=ea.HelperMethods.YA(eb,Pa.g(this.$).domElement,Pa.g(this.$).rtl);if(!ya)return t.ULS.sendTraceTag(537149771,0,50,"ZoomManager.GetFloatingObjectBounds got null for floatingObjectPointOnGrid"),null;var za=ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6055130_UseViewportInDocumentCoordinatesForZoomScroll")?Pa.g(this.$).$vb():Pa.g(this.$).view.visibleArea;ya=new Sys.UI.Point(Math.round((ya.x-za.topLeft.x)*Ka),Math.round((ya.y-
za.topLeft.y)*Ka));Ka=new Sys.UI.Bounds(ya.x,ya.y,Math.round(eb.offsetWidth*Ka),Math.round(eb.offsetHeight*Ka));return Cb?this.VUe(Ka,Ta,ob):Ka};c.prototype.jtf=function(){this.Efb.vz()};c.prototype.cFi=function(Ka){"ZoomToLevelInExcelLive"===Ka?this.zoomEventManager.x5i():this.zoomEventManager.w5i()};c.prototype.L$i=function(){this.zoomEventManager=this.$.da.Ha(419,new l)};c.prototype.Sfd=function(Ka,Ta,ob,Cb,eb,ya){ya=void 0===ya?"":ya;var za=Pa.g(this.$).rtl?0:eb.x;eb="ZoomWithPinch"===ya||"ZoomWithMouse"===
ya?new Sys.UI.Point(Ka.x-za-Math.round(Cb.x*Ta),Ka.y-eb.y-Math.round(Cb.y*Ta)):Ka;eb=new Sys.UI.Point(Math.round(eb.x/Ta),Math.round(eb.y/Ta));t.ULS.shipAssertTag(537149770,0,!!Ta,"Original zoom level must be different than 0");za=ob/Ta;eb=new Sys.UI.Point(Math.round(eb.x*(1-1/za)),Math.round(eb.y*(1-1/za)));"ZoomWithMouse"===ya||"ZoomWithPinch"===ya?(eb.x+=Math.round((Cb.x-Pa.g(this.$).wI)*(za-1)),eb.y+=Math.round((Cb.y-Pa.g(this.$).LJ)*(za-1))):(za=Math.round(Cb.x*(ob-Ta)),0<za&&eb.x>za&&(eb.x+=
za),Ta=Math.round(Cb.y*(ob-Ta)),0<Ta&&eb.y>Ta&&(eb.y+=Ta));"ZoomWithMouse"===ya&&(Ka.x||(eb.x=0),Ka.y||(eb.y=0));Ka=ja.EwaSettings.isChangeGateEnabled("OfficeVSO:6055130_UseViewportInDocumentCoordinatesForZoomScroll")?Pa.g(this.$).$vb():Pa.g(this.$).view.visibleArea;return new Sys.UI.Point(eb.x+Ka.topLeft.x,eb.y+Ka.topLeft.y)};c.prototype.kMg=function(){var Ka=this,Ta=[];Q.a.instance.oc("Common.IGestureInputManager").execute(function(ob){0===ob.nRh()&&ob.v9i(document.body,new n(Ka.$),Ta)})};c.prototype.zZi=
function(){return this.jDc()&&(U.a.ep&&U.a.aMa(67)||this.$.tic)};c.prototype.jvj=function(Ka,Ta){r.a(this.$)?this.setZoomLevel(Ka,Ta,this.U_d,z.a.lJf):this.setZoomLevel(Ka,Ta,this.zoomPerSheetId,this.HEb)};c.prototype.setZoomLevel=function(Ka,Ta,ob,Cb){ob.remove(Ka);Ta!==Cb&&ob.add(Ka,Ta)};c.prototype.wNj=function(Ka){this.t0f();this.$.vza(K.a.GZ("TriggerImmediateZoomOperations"));this.$Uj();this.cFi(Ka)};c.prototype.$Uj=function(){this.Hmi()?this.$.If():this.Efb.vz();var Ka=this.Efb.i5e("UpdateZoomStatusBar");
Ka&&(Ka.innerText=this.GOb)};c.prototype.Hmi=function(){var Ka=H.a(this.$);return Ka?Ka.Im.Do===(X.a.bxa(this.$)?T.a.erc:this.$.Ib+T.a.KUf):!1};c.prototype.DNj=function(Ka){Pa.g(this.$).wZj(Ka);this.xIg()};c.prototype.xIg=function(){var Ka=qa.a(this.$);if(Ka)for(var Ta=yl(Pa.g(this.$).Ca.XE()),ob=Ta.next();!ob.done;ob=Ta.next())if(ob=ob.value,!ob)t.ULS.sendTraceTag(537149768,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - cacheItem is null");else{if(ob.ik&&(ob=ob.Yi))for(var Cb=0;Cb<
ob.count;Cb++)if(2===ob.fg(Cb).type){var eb=Ka.Up(ob.fg(Cb).Hg());eb?(eb.d1(!1),t.ULS.sendTraceTag(537149766,0,50,"ZoomManager.AdjustSlicersToZoom - Slicer zoomed to zoom {0}",this.zoom)):t.ULS.sendTraceTag(537149767,0,50,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - control is null")}}else t.ULS.sendTraceTag(537149769,0,15,"ZoomManager.AdjustSlicersToZoom - Cannot zoom slicers - floatingObjectManager is null")};Object(A.a)(c,"ZoomManager",la.a,[]);var ma=F.a;vm(a,ma);a.prototype.create=
function(){var Ka=new c(this.$);this.bVj(Ka);this.Fb(Ka)};a.prototype.bVj=function(Ka){var Ta=J.a(this.$);if(Ta){var ob=Ta.fid("ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager");Ka.zPd(ob);Ka.tuc(Ta.YAc)}else t.ULS.shipAssertTag(537149765,0,!0,"ZoomManagerFactory.UpdateZoomPerSheetIdFromExistingManager existingZoomManager is missing (expected to find here a DefaultZoomManager to pass zoom-per-sheet state from)")};a.ja=function(Ka){Ka.da.Ha(369,new a(Ka))};Object(A.a)(a,"ZoomManagerFactory",
F.a,[]);b=b(516);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Zoom");Type.registerNamespace("_Ewa");(function(){x.a.Ga(function(Ka){a.ja(Ka);m.ja(Ka)})})();b.a.$i(".ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{background:linear-gradient(120deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{background:linear-gradient(300deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{background:linear-gradient(30deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{background:linear-gradient(210deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,#b1b1b1 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,#b1b1b1 30%,rgba(0,0,0,0) 31%);background-color:#757778}.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:start:decrement,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-button:end:increment,.ewa-scrollbars-enabled .ewr-namedsheetview .ewa-scrollbars.ewa-scrollbarszoomvar::-webkit-scrollbar-thumb{width:calc(16px/var(--zoom-level,1));height:calc(16px/var(--zoom-level,1));border:solid calc(1px/var(--zoom-level,1)) #363636;background-color:#b1b1b1}@media screen and (-ms-high-contrast:active){.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar{background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-thumb{background-color:WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-corner{background-color:Window}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(120deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(240deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(0deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:vertical:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(300deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(60deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(180deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:start:decrement{-ms-high-contrast-adjust:none;background:linear-gradient(30deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(150deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(270deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}.ewa-scrollbars-enabled .ewr-namedsheetview .ewr-grdblkcontainer.ewa-scrollbars.ewa-scrollbarszoomdefault::-webkit-scrollbar-button:horizontal:end:increment{-ms-high-contrast-adjust:none;background:linear-gradient(210deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(330deg,WindowText 40%,rgba(0,0,0,0) 41%),linear-gradient(90deg,WindowText 30%,rgba(0,0,0,0) 31%);background-color:Window;border:1px solid WindowText}}")}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.zoom.js.map/f1fec5747b1f825ef469af966b79c33d/EwaDS.zoom.js.map