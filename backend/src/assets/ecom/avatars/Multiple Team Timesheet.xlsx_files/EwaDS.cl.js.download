(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1021:function(A,F,b){function a(){this.die=!1;this.VOc=null;this.u4d=0;this.mIc=this.KFe();this.GQb=this.KFe();this.LCa=this.UVa=0;this.ew=function(){return new Date}}b.d(F,"a",function(){return a});A=b(0);a.prototype.KFe=function(){for(var c=Array(6),e=0;e<c.length;e++)c[e]=0;return c};a.prototype.lQh=function(){return this.mIc.toString()};a.prototype.aNh=function(){return this.GQb.toString()};a.prototype.iGj=function(){this.VOc=
this.ew()};a.prototype.vGb=function(c,e,l){if(!this.$Hj){if(void 0===l?0:l)this.die=!0;l=this.ew();0===c&&5<this.UVa||1===c&&5<this.LCa||(this.u4d<c?(1===this.UVa%2&&(this.mIc[this.UVa]=-1,this.UVa++),this.u4d=c,1===e&&(this.GQb[this.LCa]=-1,this.LCa++),this.GQb[this.LCa]=this.XTd(l),this.LCa++):0===c?(this.mIc[this.UVa]=this.XTd(l),this.UVa++):(this.GQb[this.LCa]=this.XTd(l),this.LCa++))}};a.prototype.XTd=function(c){var e=c.getTime()-this.VOc.getTime();this.VOc=c;return e};Sk.Object.defineProperties(a.prototype,
{$Hj:{configurable:!0,enumerable:!0,get:function(){return this.die}}});Sk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.Oa||(a.Oa=new a);return a.Oa},set:function(c){a.Oa=c}}});a.Oa=null;Object(A.a)(a,"LatencyMetrics",null,[])},1070:function(A,F,b){function a(x){this.XBe=this.qUe=null;this.Xpf=this.jWe=0;this.Bp=null;this.Vae=this.PMc=0;this.Tg=x;this.Kbi();this.XHc=this.R6d=this.lNc=!1;this.JMc=0}A=b(0);var c=b(13),e=b(80),l=b(109),n;(function(x){x[x.SendNotification=
0]="SendNotification";x[x.SendPersistentState=1]="SendPersistentState";x[x.FindSession=2]="FindSession";x[x.Last=3]="Last"})(n||(n={}));Object(A.b)("ApiType",n);var m;(function(x){x[x.AttemptCount=0]="AttemptCount";x[x.SuccessCount=1]="SuccessCount";x[x.DropCount=2]="DropCount";x[x.FailedCount=3]="FailedCount";x[x.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";x[x.LatencyUnderThresholdCount=5]="LatencyUnderThresholdCount";x[x.ThrottledCount=6]="ThrottledCount";x[x.Last=7]="Last"})(m||(m=
{}));Object(A.b)("EventCountType",m);var f=b(1021);b.d(F,"a",function(){return a});a.prototype.gGj=function(x){this.Vae=x;window.setInterval(Object(e.a)(this,this.nud,"logMetricsBatchAndReset"),x);this.PMc=(new Date).getTime()};a.prototype.Ox=function(x,y){this.qxj(x)&&!this.R6d||this.Kzh||!window.navigator.onLine||this.Tg.C6a||(this.Bp[x][y]++,this.lNc=!0)};a.prototype.Kbi=function(){this.Bp=Array(3);for(var x=0;3>x;x++){this.Bp[x]=Array(7);for(var y=0;7>y;y++)this.Bp[x][y]=0}};a.prototype.$Qg=function(){for(var x=
{},y=0;3>y;y++)for(var t=0;7>t;t++)this.gpi(y,t)&&(x[n[y]+m[t]]=this.Bp[y][t]);x.FSDomain=this.qUe;x.ConnectionDomain=this.XBe;x.FSRetryInterval=this.jWe;x.MaxPayloadSize=this.Xpf;x.LogNumber=this.JMc;1===this.JMc&&(x.FSLatencies=f.a.instance.lQh(),x.ConLatencies=f.a.instance.aNh());return x};a.prototype.gpi=function(x,y){return 2===x&&3!==y&&0!==y?!1:!0};a.prototype.qxj=function(x){return 2===x?!1:!0};a.prototype.nud=function(){if(this.lNc){this.JMc++;if((new Date).getTime()-this.PMc<5E3+this.Vae){var x=
l.a.toJSON(this.$Qg());c.ULS.sendTraceTag(50644352,500,15,x)}this.PMc=(new Date).getTime();for(x=0;3>x;x++)for(var y=0;7>y;y++)this.Bp[x][y]=0;this.lNc=!1}};a.prototype.gzi=function(){this.R6d=!0};a.create=function(x){a.instance||(a.Oa=new a(x));return a.instance};Sk.Object.defineProperties(a.prototype,{Kzh:{configurable:!0,enumerable:!0,get:function(){return this.XHc}}});Sk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Oa}}});a.Oa=null;Object(A.a)(a,"FrequentLoggingMetrics",
null,[955])},1133:function(A,F,b){b.d(F,"a",function(){return a});A=b(0);var a;(function(c){c[c.disconnected=0]="disconnected";c[c.connecting=1]="connecting";c[c.connected=2]="connected"})(a||(a={}));Object(A.b)("ChannelConnectionState",a)},1134:function(A,F,b){function a(e,l,n,m){var f=c.call(this)||this;f.type=e;f.a8=l;f.Cdh=n;f.pea=m;return f}b.d(F,"a",function(){return a});A=b(0);var c=Sys.EventArgs;vm(a,c);Object(A.a)(a,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1135:function(A,F,b){function a(){}
b.d(F,"a",function(){return a});A=b(0);a.gMd="rr";a.dkj="rd";a.bkj="rbp";a.yNd="sa";Object(A.a)(a,"RtcReconnectParams",null,[])},1136:function(A,F,b){function a(c,e,l,n){this.XAi=c;this.kBa=e;this.Uzi=l;this.h2h=n}b.d(F,"a",function(){return a});A=b(0);Object(A.a)(a,"ThrottlerManagerSettings",null,[])},1227:function(A,F,b){function a(){this.rb=new ja.a}function c(ea,qa){var pa=ca.call(this)||this;pa.type=ea;pa.dVj=qa;return pa}function e(ea){var qa=X.call(this)||this;qa.X0c=ea;return qa}function l(ea,
qa){var pa=fa.call(this)||this;pa.J_j=ea;pa.q0j=qa;return pa}function n(ea,qa,pa){var Pa=K.call(this)||this;Pa.type=ea;Pa.presence=qa;Pa.pea=pa;return Pa}function m(ea,qa){var pa=S.call(this)||this;pa.U_j=ea;pa.errorMessage=qa;return pa}function f(ea){var qa=H.call(this)||this;qa.hubConnection=ea;return qa}function x(ea,qa,pa,Pa,Ha,Xa){var Na=T.call(this)||this;Na.ufb=ea;Na.t2c=qa;Na.E1g=pa;Na.qSe=Ha;Na.A0c=Pa;Na.stopwatch=Xa;return Na}function y(ea){var qa=ba.call(this)||this;qa.I0j=ea;return qa}
function t(ea,qa){qa=void 0===qa?null:qa;var pa=la.call(this)||this;pa.VB=ea;pa.oyg=qa;return pa}function B(ea,qa){var pa=U.call(this)||this;pa.type=ea;pa.bP=qa;return pa}function z(ea){var qa=V.call(this)||this;qa.X0c=ea;return qa}function u(ea){var qa=D.call(this)||this;qa.presence=ea;return qa}function C(ea,qa){var pa=v.call(this)||this;pa.ZYg=ea;pa.pea=qa;return pa}function r(ea,qa){var pa=J.call(this)||this;pa.newState=ea;pa.oldState=qa;return pa}A=b(0);var J=Sys.EventArgs;vm(r,J);Object(A.a)(r,
"ChangedConnectionStateEventArgs",Sys.EventArgs,[]);var v=Sys.EventArgs;vm(C,v);Object(A.a)(C,"ClientInfoEventArgs",Sys.EventArgs,[]);var D=Sys.EventArgs;vm(u,D);Object(A.a)(u,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);var V=Sys.EventArgs;vm(z,V);Object(A.a)(z,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);var U=Sys.EventArgs;vm(B,U);Object(A.a)(B,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var Q=b(1300),la=Sys.EventArgs;vm(t,la);Sk.Object.defineProperties(t.prototype,{type:{configurable:!0,
enumerable:!0,get:function(){return this.VB}},a8:{configurable:!0,enumerable:!0,get:function(){return this.oyg}}});Object(A.a)(t,"UpdateNotificationEventArgs",Sys.EventArgs,[]);var ba=Sys.EventArgs;vm(y,ba);Object(A.a)(y,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);var T=Sys.EventArgs;vm(x,T);Object(A.a)(x,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);var H=Sys.EventArgs;vm(f,H);Object(A.a)(f,"RefreshProxyEventArgs",Sys.EventArgs,[]);var S=Sys.EventArgs;vm(m,S);Object(A.a)(m,
"RtcConnectFailedEventArgs",Sys.EventArgs,[]);var K=Sys.EventArgs;vm(n,K);Object(A.a)(n,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var da=b(1134),fa=Sys.EventArgs;vm(l,fa);Object(A.a)(l,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);var X=Sys.EventArgs;vm(e,X);Object(A.a)(e,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);var ca=Sys.EventArgs;vm(c,ca);Object(A.a)(c,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var ja=b(93);b.d(F,"a",function(){return a});a.prototype.u4i=
function(ea,qa){this.rb.raiseEvent("CSC",new r(ea,qa))};a.prototype.e5i=function(ea){this.rb.raiseEvent("RP",new f(ea))};a.prototype.Vqc=function(ea){this.rb.raiseEvent("RC",ea)};a.prototype.g5i=function(){this.rb.raiseEvent("RMID")};a.prototype.d5i=function(ea,qa,pa,Pa,Ha,Xa){this.rb.raiseEvent("RPS",new x(ea,qa,pa,Pa,Ha,Xa))};a.prototype.oMf=function(ea,qa){this.rb.raiseEvent("UPSR",new c(ea,qa))};a.prototype.ZLf=function(ea,qa){this.rb.raiseEvent("PU",new Q.a(ea,qa))};a.prototype.T4i=function(ea){this.rb.raiseEvent("MPU",
new u(ea))};a.prototype.oGd=function(ea,qa,pa,Pa){this.rb.raiseEvent("SUN",new da.a(ea,qa,pa,Pa))};a.prototype.t5i=function(ea,qa){this.rb.raiseEvent("UNR",new t(ea,qa))};a.prototype.gMf=function(ea,qa,pa){this.rb.raiseEvent("SP",new n(ea,qa,pa))};a.prototype.a5i=function(ea,qa){this.rb.raiseEvent("PSU",new B(ea,qa))};a.prototype.$4i=function(ea){this.rb.raiseEvent("PSC",new z(ea))};a.prototype.P4i=function(ea){this.rb.raiseEvent("IPSC",new z(ea))};a.prototype.u5i=function(ea){this.rb.raiseEvent("UPSC",
new e(ea))};a.prototype.j5i=function(ea,qa){this.rb.raiseEvent("SPC",new l(ea,qa))};a.prototype.dMf=function(ea,qa){this.rb.raiseEvent("RCF",new m(ea,qa))};a.prototype.J4i=function(ea){this.rb.raiseEvent("CPSWM",new y(ea))};a.prototype.s5i=function(ea,qa){this.rb.raiseEvent("UCI",new C(ea,qa))};a.prototype.GYa=function(ea){this.rb.addHandler("CSC",ea)};a.prototype.wsc=function(ea){this.rb.removeHandler("CSC",ea)};a.prototype.OGg=function(ea){this.rb.addHandler("RP",ea)};a.prototype.NGg=function(ea){this.rb.addHandler("RC",
ea)};a.prototype.SGg=function(ea){this.rb.addHandler("RMID",ea)};a.prototype.MGg=function(ea){this.rb.addHandler("RPS",ea)};a.prototype.FHg=function(ea){this.rb.addHandler("UPSR",ea)};a.prototype.IFa=function(ea){this.rb.addHandler("PU",ea)};a.prototype.Oza=function(ea){this.rb.removeHandler("PU",ea)};a.prototype.xFg=function(ea){this.rb.addHandler("IPU",ea)};a.prototype.DHg=function(ea){this.rb.addHandler("UCI",ea)};a.prototype.eHg=function(ea){this.rb.addHandler("SUN",ea)};a.prototype.yFg=function(ea){this.rb.addHandler("IUNR",
ea)};a.prototype.NYa=function(ea){this.rb.addHandler("UNR",ea)};a.prototype.xHb=function(ea){this.rb.removeHandler("UNR",ea)};a.prototype.wFg=function(ea){this.rb.addHandler("IPSU",ea)};a.prototype.vFg=function(ea){this.rb.addHandler("IPSC",ea)};a.prototype.EHg=function(ea){this.rb.addHandler("UPSC",ea)};a.prototype.dHg=function(ea){this.rb.addHandler("SP",ea)};a.prototype.gHg=function(ea){this.rb.addHandler("SPC",ea)};a.getInstance=function(){return a.Oa||(a.Oa=new a)};a.Oa=null;Object(A.a)(a,"RtcEventHub",
null,[607])},1231:function(A,F,b){function a(S,K,da,fa,X,ca,ja,ea,qa,pa,Pa,Ha,Xa){var Na=this;Xa=void 0===Xa?null:Xa;this.S$d=(new Date(0)).getTime();this.$ae=0;this.BTb=!1;this.Oge=null;this.zHd=36E5;this.qVa=a.Maf;this.dib=0;this.JQa=null;this.Eda=0;this.Rbb=this.YBe=null;this.cvg=[x.mzb,x.errorMessage,x.q5f,x.iC,x.N6,x.D5e,x.y8a,x.kBa,x.E8a];this.bvg=[x.mzb,x.errorMessage];this.iC=this.Akc=null;this.N6d=new n(Pa?Pa:function(){return u.AFrameworkApplication.mj},X,ca,ja,S,K);this.Rgb=Ha;this.Ah=
fa;this.Tg=K;this.Vog=da;this.Pl=ea;this.jh=qa;this.nib=Xa;this.O6d=!1;this.C9b=9E4;pa&&pa.execute(function(db){db.ZYb(function(){y.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",Na.Pl);Na.N6d.sOf()})});2>=100*Math.random()&&(this.zHd=3E5);Q.a.instance&&(Q.a.instance.jWe=this.zHd)}function c(){}function e(){}function l(){}function n(S,K,da,fa,X,ca){this.AEa=null;var ja=b(1231).FindSessionStrategy;this.vug=S;S=String.format("{0}={1}",m.clientId,V.a.pf(fa));
S=String.format("{0}&{1}={2}",S,m.userSessionId,V.a.pf(X));S=String.format("{0}&{1}={2}",S,m.zVj,V.a.pf(da.toString()));S=String.format("{0}&{1}={2}",S,m.userType,V.a.pf("1"));S=String.format("{0}&{1}={2}",S,m.SVj,V.a.pf(K));S=String.format("{0}&{1}={2}",S,m.cZg,V.a.pf(ja.aZg));(K=n.yKh(da,ca))&&(S=String.format("{0}&{1}",S,K));this.$mg=S}function m(){}function f(){this.E5e=this.Vpf=this.Wpf=this.$pf=0;this.Ghc=!1;this.correlationId=this.iC=this.N6=this.u2c=this.errorMessage=null}function x(){}b.r(F);
A=b(0);var y=b(13),t=b(80),B=b(184),z=b(1133);x.E8a="throttling_messageDelay";x.mzb="enabled";x.kBa="throttling_timeToWaitForResponse";x.y8a="throttling_maxNumberOfOutstandingMessages";x.D5e="throttling_globalMaxNumberOfOutstandingMessages";x.errorMessage="errorMessage";x.q5f="url";x.N6="queryString";x.iC="connectionString";Object(A.a)(x,"RtcFindSessionOutputFieldNameConstants",null,[]);var u=b(5),C=b(78),r=b(47),J=b(419),v=b(807),D=b(109),V=b(29),U=b(178);Sk.Object.defineProperties(f.prototype,{J0g:{configurable:!0,
enumerable:!0,get:function(){return this.u2c+"?"+this.N6}}});Object(A.a)(f,"FindSessionResponse",null,[]);m.clientId="ClientId";m.zVj="UserApp";m.userSessionId="usid";m.userType="UserType";m.SVj="UserVersion";m.Mqc="qs";m.cZg="clientProtocol";m.aEi="NoAuth";Object(A.a)(m,"RtcFindSessionInputQueryParamConstants",null,[]);n.prototype.sOf=function(){this.AEa=this.vug()};n.prototype.Pcd=function(){this.AEa&&""!==this.AEa||(this.sOf(),y.ULS.sendTraceTag(575784194,500,this.AEa&&""!==this.AEa?50:15,"Query signature delegate called for refresh returned: {0} ",
this.AEa));var S=String.format("{0}={1}",m.Mqc,V.a.pf(this.AEa));return String.format("{0}&{1}",S,this.$mg)};n.yKh=function(S,K){return 4===S?String.format("{0}={1}",m.aEi,"1"):K?K.T0h():null};Object(A.a)(n,"FindSessionQueryStringGenerator",null,[]);var Q=b(1070),la=b(1021),ba=b(841),T=b(1136);l.cDh="FSType";Object(A.a)(l,"RtcFindSessionRequestHeaders",null,[]);e.Q6i="polling";Object(A.a)(e,"RtcFindSessionTypes",null,[]);var H=b(1135);c.HWj="RTC-TokenProofkey";c.ypi="RTC-IsWacJsBootFsRequest";Object(A.a)(c,
"RtcRequestHeaders",null,[]);b.d(F,"FindSessionStrategy",function(){return a});a.prototype.Utj=function(S){this.Rbb=S};a.prototype.init=function(){this.jh.SGg(Object(t.a)(this,this.qhj,"resetGetMachineIdDelay"));this.jh.GYa(Object(t.a)(this,this.lW,"onConnectionStateChanged"))};a.prototype.lW=function(S,K){this.Eda=K.newState;2===K.newState&&(this.dib=0)};a.prototype.n_e=function(){var S=this.JQa.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.JQa.N6,a.cDe,V.a.pf(S)),correlationId:S}};
a.prototype.bYh=function(S,K,da,fa,X){var ca=this;this.hoj(function(){fa(X,"GetMachineIdSuccess")&&(y.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",ca.iC,ca.Pl),S(ca.Oge),da(ca.J_h()))},function(ja){fa(X,"GetMachineIdFailure")&&(y.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",ca.Pl),K(ja))},fa,X)};a.prototype.Cgh=function(){this.qze();this.R9h()};a.prototype.hoj=function(S,K,da,fa){var X=this;y.ULS.sendTraceTag(17956952,500,
50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",this.iC);if(this.iC)S();else{var ca=this.PTg();window.setTimeout(function(){X.sendFindSessionRequestToServerInternal(S,K,da,fa)},ca)}};a.prototype.sendFindSessionRequestToServerInternal=function(S,K,da,fa){var X=this;da(fa,"RequestMachineId")&&(this.S$d=(new Date).getTime(),da=r.a.we(),this.o_e(function(ca){var ja=r.a.we();X.VGf(ca);X.VOd();S();ca=r.a.we()-ja;y.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",
ca)},function(ca){var ja=r.a.we();X.qze();Q.a.instance&&Q.a.instance.Ox(2,3);K(ca);ca=r.a.we()-ja;y.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",ca)},!1),da=r.a.we()-da,y.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",da))};a.prototype.R9h=function(){this.qVa+=a.FTh;this.qVa=Math.min(this.qVa,a.Gzi)};a.prototype.PTg=function(){var S=(new Date).getTime();S=this.S$d+this.qVa-S;0>S&&(S=0);return S};a.prototype.VGf=function(S){try{this.JQa=S,this.Akc=S.J0g,this.iC=
S.iC,this.YBe=S.N6,this.Oge=S.u2c}catch(K){y.ULS.sendTraceTag(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",K.toString())}};a.prototype.qze=function(){this.iC=null;this.rze()};a.prototype.VOd=function(){this.rze();this.BTb=!0;this.$ae=window.setTimeout(Object(t.a)(this,this.D8i,"refreshMachineId"),this.zHd)};a.prototype.rze=function(){this.BTb&&(window.clearTimeout(this.$ae),this.BTb=!1)};a.prototype.D8i=function(){var S=this;this.BTb=!1;this.o_e(function(K){var da=
S.YBe!==K.N6,fa=S.iC!==K.iC,X=S.iC;S.VGf(K);0!==S.Eda&&(fa?(y.ULS.sendTraceTag(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",X||"null",K.iC),S.jh.Vqc()):(S.jh.j5i(da,fa),S.VOd()))},function(){Q.a.instance&&Q.a.instance.Ox(2,3);S.VOd()},!0)};a.prototype.qhj=function(){this.qVa=a.Maf};a.prototype.J_h=function(){return new T.a(this.JQa.$pf,this.JQa.Wpf,this.JQa.Vpf,this.JQa.E5e)};a.prototype.gNj=function(S){if(Object.getType(S)!==Object)return null;for(var K in S);
return this.A6g(S)};a.prototype.A6g=function(S){if(!(x.mzb in S))return null;for(var K=S[x.mzb],da=yl(K?this.cvg:this.bvg),fa=da.next();!fa.done;fa=da.next())if(!(fa.value in S))return null;da=Object.assign(new f,{Ghc:S[x.mzb],errorMessage:S[x.errorMessage],correlationId:U.a.create().toString()});K&&(da.u2c=S[x.q5f],da.N6=S[x.N6],da.iC=S[x.iC],da.E5e=S[x.D5e],da.Vpf=S[x.y8a],da.Wpf=S[x.kBa],da.$pf=S[x.E8a]);return da};a.prototype.mQh=function(S,K){var da=this;y.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");
this.nib.aDh.continueWith(function(){da.nib.aDh.result?(y.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),S(da.nib.bDh)):(y.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),K(da.nib.bDh))})};a.prototype.qTf=function(S,K,da,fa,X){var ca=this;X=void 0===X?!1:X;return function(ja){la.a.instance.vGb(0,1);S&&S.stop();ca.Rbb=null;ca.Rgb=null;ca.snf(ja.data,!0,K);var ea=ba.RtcUtils.deserialize(ja.data.ie,"FindSession",null);if(ea)if(ea=
ca.gNj(ea)){if(ea.Ghc&&ea.N6&&ea.iC){y.ULS.sendTraceTag(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",ca.Pl);ca.Vui(ja.data);da(ea);return}K.FindSessionFailureReason="FindSessionInvalidResponse";K.IsRtcEnabled=ea.Ghc;K.IsQueryStringEmpty=!ea.N6;K.IsConnectionStringEmpty=!ea.iC;y.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",ca.Pl,
ea.Ghc,!ea.N6,!ea.iC)}else K.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",y.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",ca.Pl);else K.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",y.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",ca.Pl);ca.eMf(K,X);fa(null)}};a.prototype.jTf=function(S,K,da,fa){var X=this;fa=void 0===fa?!1:fa;return function(ca){la.a.instance.vGb(0,
1);S&&S.stop();X.Rbb=null;X.Rgb=null;X.snf(ca.data,!1,K);var ja=null,ea="unknown",qa="unknown";ca.data&&((ea=ca.data.responseHeaders)&&a.mIb in ea&&(ja=ea[a.mIb].toString()),ea=v.a[ca.data.status],qa=ca.data.httpStatus.toString());K.FindSessionFailureReason="FindSessionRequestFailed";K.HttpErrorCode=qa;K.HttpErrorStatus=ea;K[a.mIb]=ja;y.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",ea,qa,X.Pl,ja,fa);
X.eMf(K,fa);da(qa)}};a.prototype.o_e=function(S,K,da){var fa=this;da=void 0===da?!1:da;var X=null;y.ULS.sendTraceTag(4317445,500,50,"Getting MachineId from server for [{0}]",this.Pl);var ca={},ja=this.N6d.Pcd();ca[J.a.XY]=U.a.create().toString();this.Rbb&&""!==this.Rbb?ja=String.format("{0}&{1}={2}",ja,H.a.gMd,this.Rbb):this.Rgb&&""!==this.Rgb&&(ja=String.format("{0}&{1}={2}",ja,H.a.gMd,this.Rgb),ca[c.HWj]="True",ca[c.ypi]="True");ja=this.Vog+"?"+ja;da&&(ca[l.cDh]=e.Q6i);var ea={};ea.IsNetworkOfflineBeforeSendRequest=
this.Tg.C6a;ea.HasAvailableConnectionsBeforeSendRequest=this.Tg.Q7e;ea.MaxConnectionsAllowed=this.Tg.Hkc;ea.IsRefreshMachineId=da;this.nib&&!this.O6d?(this.mQh(this.qTf(null,ea,S,K,da),this.jTf(null,ea,K,da)),this.O6d=!0):(this.Ah&&(X=this.Ah.Hc("WebServiceCall","GetMachineIdFromTheServer")),Q.a.instance&&Q.a.instance.Ox(2,0),0>this.Tg.I9(ja,1,null,ca,[a.E3b,a.mIb,a.OCb,a.fMd,a.Erf,a.Ztf,a.Ytf],!1,1,this.qTf(X,ea,S,K,da),this.jTf(X,ea,K,da),null,null,!1,null,this.C9b,"3",null,!0)&&(5<this.dib&&200>
this.dib&&y.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",this.dib),window.setTimeout(function(){fa.dib++;K("-1")},1E3)))};a.prototype.snf=function(S,K,da){da||(da={});da.IsNetworkOfflineAfterRequestComplete=this.Tg.C6a;da.IsRequestSucceeded=K;S&&(da.EnqueueTime=S.F7b,da.InvokedTime=S.iF,da.CompletedTime=S.q3,S.responseHeaders&&(a.E3b in S.responseHeaders&&(da.CorrelationId=S.responseHeaders[a.E3b]),a.OCb in
S.responseHeaders&&(da[a.OCb]=S.responseHeaders[a.OCb])));y.ULS.sendTraceTag(38633565,500,K?50:15,ba.RtcUtils.pOa(da))};a.prototype.eMf=function(S,K){S||(S={});S.ConnectionState=z.a[this.Eda];K||this.jh.dMf(1,S)};a.prototype.Vui=function(S){try{var K=!1,da=!1,fa=S.responseHeaders,X=C.a.YM(S.request.get_url());if(fa&&a.fMd in fa){var ca=fa[a.fMd].toString().toLocaleLowerCase();da="true"===ca;K="false"===ca}fa=!1;var ja=0<=X.toLocaleLowerCase().indexOf("collab");da&&!ja?fa=!0:K&&ja&&(fa=!0);if(fa){K=
{HostName:X};K.Status=v.a[S.status];K.HttpStatus=S.httpStatus.toString();var ea=S.request.get_headers(),qa;for(qa in ea){var pa=ea[qa];(da=qa)&&0<da.length&&(X=0,pa&&(X=pa.toString().length),K["r_"+da]=X)}if(S.responseHeaders){var Pa=new B.a;Pa.add(a.E3b);Pa.add(a.OCb);Pa.add(a.mIb);Pa.add(a.Ztf);Pa.add(a.Ytf);Pa.add(a.Erf);a.FCg(K,S.responseHeaders,Pa)}a.uCg(S.request.get_url(),K);var Ha=D.a.toJSON(K);y.ULS.sendTraceTag(559437006,500,15,Ha)}}catch(Xa){y.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",
Xa.toString())}};a.createInstance=function(S,K,da,fa,X,ca,ja,ea,qa,pa,Pa,Ha){return a.s7g(S,K,da,fa,X,ca,ja,ea,qa,pa,Pa,void 0===Ha?null:Ha)};a.s7g=function(S,K,da,fa,X,ca,ja,ea,qa,pa,Pa,Ha){Ha=void 0===Ha?null:Ha;S=S||U.a.create().toString();S=new a(S,K,da,fa,X,ca,ja,ea,qa,pa,null,Pa,Ha);S.init();return S};a.FCg=function(S,K,da){da=yl(da);for(var fa=da.next();!fa.done;fa=da.next())fa=fa.value,fa in K&&(S[fa]=K[fa])};a.uCg=function(S,K){if(S){var da=S.indexOf("?");if(-1!==da)for(S=S.substr(da+1).split("&"),
da=0;da<S.length;++da){var fa=S[da].split("=");if(2===fa.length){var X=fa[0];if(X&&0<X.length){var ca=0;if(fa=fa[1])ca=fa.length;K["q_"+X]=ca}}}}};a.FTh=3E3;a.Gzi=3E5;a.aZg="1.0";a.Maf=1E3;a.E3b="X-CorrelationId";a.cDe="corrid";a.mIb="RtcErrorCode";a.OCb="X-OfficeCluster";a.fMd="X-NewEnv";a.Erf="X-MSEdge-Ref";a.Ytf="X-OFFICEFD";a.Ztf="X-OfficeFE";Object(A.a)(a,"FindSessionStrategy",null,[963])},1299:function(A,F,b){function a(){this.zce=this.Ace=this.Bce=this.xce=this.wce=this.yce=this.lkb=this.QNc=
0;this.XRb=this.oMc=this.vjb=this.hMc=this.iMc=this.ZLc=this.sqa=this.sjb=this.yWa=this.YLc=this.VRb=this.MVa=null;this.ZMc=this.Qjb=this.Mge=this.u3d=0;this.zbe=!1;this.ENf=this.fHd;this.HNf=this.iHd;this.GNf=this.hHd;this.LNf=this.kHd;this.KNf=this.jHd;this.qHd=this.rHd;this.nHd=this.oHd;this.fQa=this.lHd;this.wGb=this.mHd;this.FNf=this.gHd;this.qCb=this.Fxd;this.Hlc=this.Hxd}b.r(F);b.d(F,"RealtimeChannelMetrics",function(){return a});A=b(0);var c=b(13),e=b(231),l=b(109),n=b(841);a.prototype.fHd=
function(){this.QNc++;this.YLc=new Date;this.MVa||(this.MVa=new Date)};a.prototype.iHd=function(){this.lkb++;this.sqa=new Date;this.VRb||(this.VRb=this.sqa);this.vjb=this.sqa;this.T0g()};a.prototype.hHd=function(){this.yce++;this.ZLc=new Date};a.prototype.kHd=function(){this.wce++;this.yWa=new Date};a.prototype.jHd=function(){this.xce++;this.sjb=new Date};a.prototype.oHd=function(){this.iMc=new Date;this.Bce++};a.prototype.mHd=function(){this.XRb||(this.XRb=new Date);this.Ace++};a.prototype.lHd=function(){this.hMc=
new Date;this.zce++};a.prototype.rHd=function(){!this.zbe&&this.QNc&&(c.ULS.sendTraceTag(39321871,500,15,l.a.toJSON(this.f_g())),this.zbe=!0)};a.prototype.gHd=function(m){var f=n.RtcUtils.eAh(m);m=f.o$e;var x=f.q$e;f=f.exception;if(m&&m!==e.a.kP){var y={};c.ULS.sendTraceTag(40157596,500,15,l.a.toJSON((y.HttpErrorCode=m,y.HttpErrorStatus=x,y.Exception=f,y)));e.a.hdf(m)&&this.u3d++;e.a.Nhf(m)&&this.Mge++}};a.prototype.Fxd=function(){this.oMc=new Date};a.prototype.Hxd=function(){this.yWa=this.vjb=new Date};
a.prototype.f_g=function(){var m={};return m.numberOfConnectionAttempts=this.QNc,m.numberOfSuccessfulConnections=this.lkb,m.numberOfFailedConnections=this.yce,m.numberOfDisconnectedConnections=this.wce,m.numberOfExplicitDisconnectedConnections=this.xce,m.numberOfSentMessages=this.Bce,m.numberOfReceivedMessages=this.Ace,m.numberOfLostMessages=this.zce,m.firstConnectionAttempt=this.MVa?this.MVa:null,m.firstMessageReceived=this.XRb?this.XRb:null,m.firstConnectionSuccess=this.VRb?this.VRb:null,m.lastConnectionAttempt=
this.YLc?this.YLc:null,m.lastConnectionSuccess=this.sqa?this.sqa:null,m.lastConnectionFailure=this.ZLc?this.ZLc:null,m.lastMessageSent=this.iMc?this.iMc:null,m.lastMessageLost=this.hMc?this.hMc:null,m.lastDisconnect=this.yWa?this.yWa:null,m.lastExplicitDisconnect=this.sjb?this.sjb:null,m.lastTimeOnline=this.vjb?this.vjb:null,m.lastTimeOffline=this.oMc?this.oMc:null,m.maxDisconnectedTimeMs=this.Qjb,m.maxExplicitDisconnectedTimeMs=this.ZMc,m.clientConnectionErrors=this.u3d,m.serverConnectionErrors=
this.Mge,m};a.prototype.T0g=function(){this.MVa&&1===this.lkb&&(this.Qjb=Math.max(this.Qjb,this.sqa.getTime()-this.MVa.getTime()));this.yWa&&1<this.lkb&&(this.Qjb=Math.max(this.Qjb,this.sqa.getTime()-this.yWa.getTime()));this.sjb&&1<this.lkb&&(this.ZMc=Math.max(this.ZMc,this.sqa.getTime()-this.sjb.getTime()))};a.createInstance=function(m){a.Oa||(a.Oa=new a,c.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",m));return a.Oa};a.Oa=null;Object(A.a)(a,"RealtimeChannelMetrics",
null,[964,143])},1300:function(A,F,b){function a(e,l){var n=c.call(this)||this;n.bP=e;n.K3=l;return n}b.d(F,"a",function(){return a});A=b(0);var c=Sys.EventArgs;vm(a,c);Object(A.a)(a,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1382:function(A,F,b){function a(La){this.$=La}function c(La,Db,uc,Vc,yd,Md){var qe=kg.call(this)||this;qe.Fj=null;qe.jyd=!1;qe.ykd=null;qe.currentUserId=null;qe.Y$d=null;qe.qBd=function(ac,Kc){if(Kc.bP){ac=Kc.bP;for(var dd in ac)(ac=dd)&&ac!==qe.currentUserId&&!qe.O_a.has(ac)&&
qe.Bbc(ac).BTj()}};qe.kI=function(){qe.NNf()};qe.Aca=function(ac,Kc){qe.jyd=!0;var dd=Object(Jb.a)(Object,Kc.a8);if(1===Kc.type)if(ac=jc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1),null===dd||void 0===dd?0:dd[se.a.u8h]){if(!ac||!Object(Jb.a)(String,dd[se.a.Y9e]))return;ac=qe.BCe(Object(Jb.a)(String,dd[se.a.Y9e]));Object(Jb.a)(String,dd[se.a.Z9e])===se.a.s8h?(ac=[ac],ac[0]===qe.currentUserId||qe.O_a.has(ac[0])||qe.Bbc(ac[0]).yTj(),qe.ZQd(ac)&&qe.ANb(ac,null)):
Object(Jb.a)(String,dd[se.a.Z9e])===se.a.t8h&&ac!==qe.currentUserId&&qe.ANb(null,null)}else{Kc=Array.isArray(Kc.a8)?Kc.a8:null;!Kc&&dd&&(Kc=Array.isArray(dd[se.a.GKe])?dd[se.a.GKe]:null);if(Kc&&ac)for(var Ud=yl(Kc),Le=Ud.next();!Le.done;Le=Ud.next())Le=Le.value,Le===qe.currentUserId||qe.O_a.has(Le)||qe.Bbc(Le).ATj();jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5930962_ProcessPeerNotificationAsFallback")?Kc&&!qe.ZQd(Kc)||qe.ANb(Kc,null):Kc&&(ac||!qe.ZQd(Kc))||qe.ANb(Kc,null);return}if(dd)if(0===Kc.type){var ce;
(function(){var pg=qe.kGa(dd);ce=pg.uNf;return pg})().returnValue?(qe.OOa(dd),se.a.uf in dd&&(qe.$.ea.yX(dd[se.a.uf],"ContentRefreshManager.OnUpdateNotificationReceived"),qe.Ucg())):Ub.ULS.sendTraceTag(22905367,0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",ce,qe.$.ea.n7)}else{if(3===Kc.type){if(!(se.a.iVf in dd)){Ub.ULS.sendTraceTag(537154117,13,10,"RTC WetContentUpdate does not specify a type. Ignoring this update.");return}Kc=dd[se.a.iVf];
if(Kc===se.a.kkj)qe.i5h(dd);else if(Kc===se.a.ikj){if(!jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5935009_UseSignalRForRtc")){if(qe.kGa(dd).returnValue)return;if(Kc=dd[se.a.ekj])Ub.ULS.sendTraceTag(537154114,0,50,"RTC : FullSaveStarted received. Now invoking ProcessFullSaveStartedNotification web method"),D(qe.$.na.ta,Kc,null,null,null,null)}}else if(Kc===se.a.lkj||Kc===se.a.mkj||Kc===se.a.sVf){if(!jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5935009_UseSignalRForRtc")&&jc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HandleUploadNotificationsRTC",
!0)){if(qe.kGa(dd).returnValue)return;ac=0;Kc!==se.a.sVf&&(ac=dd[se.a.eMd]);(Ud=dd[se.a.eVf])&&qe.kVj.Dpc(new e(Kc,ac,Ud,qe.Emc))}}else Kc!==se.a.jkj&&Ub.ULS.sendTraceTag(537154081,13,50,"RTC WetContentUpdate of unknown type {0}. Ignoring this update.",Kc);return}if(4===Kc.type){ac=!1;se.a.BHf in dd&&(ac=dd[se.a.BHf]);if(qe.kGa(dd).returnValue)return;qe.$.ea.Tgi()&&qe.d0c();if(qe.$.ea.n7a&&ac)return;Ud=dd[se.a.kZi];qe.$.ea.qc&&Ud&&qe.jZi.Dpc(new m(Ud,ac,qe.Emc))}else if(8===Kc.type){if(qe.obj)return;
var Nf=0,af=dd[se.a.gkj],wf=dd[se.a.eVf],vf=dd[se.a.fkj];se.a.eMd in dd&&(Nf=dd[se.a.eMd]);qe.$.ea.qc&&af&&(ac=Object.assign(new t,{OcsSessionId:af,ClientId:wf&&jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5544917_HookUpRevisionTrackerOnXLO")?wf:"",SeqNum:vf,XrevidSaved:Nf}),Ud=function(){Ub.ULS.sendTraceTag(537154080,0,10,"BatchCheckCollabServiceContent failed. OcsSessionId: {0}, ClientId: {1}, SeqNum: {2}, XrevidSaved: {3}",af,wf,vf,Nf)},jc.EwaSettings.la(481)?(Le=Array(1),Le[0]=ac,V(qe.$.na.ta,
Le,qe.Emc,Ud,null,null)):qe.$Zg.Dpc(new y(ac,qe.Emc,Ud)))}}2===Kc.type?dd&&qe.kGa(dd).returnValue||(Ub.ULS.sendTraceTag(537154079,0,50,"RTC : FileNameUpdate received. Now invoking CheckWorkbookFileNameUpdate web method"),v(qe.$.na.ta,null,null,null,null)):12!==Kc.type||dd&&qe.kGa(dd).returnValue||qe.raiseEvent("LabelUpdateEventKey")};qe.Emc=function(ac){var Kc=ac.Errors;Ke.a.er(Kc)?(Kc=Ke.a.SF(Kc,[1552731907],"ContentRefreshManager"),Ke.a.iha(Kc)||qe.$.ea.np(Kc)):(Kc=ac.StateId+1,ac.Result&&qe.$.ea.uf<
Kc&&qe.$.ea.yX(se.a.Te,"ContentRefreshManager.OnCheckForUpdateSuccess"))};qe.Nh=function(){qe.akj&&qe.jyd&&qe.$.ea.m7b&&qe.Ucg()};qe.wwf=function(){qe.jyd=!1;qe.$.ea.vna=500;qe.Y$d=ie.a.Ra.Kb};qe.hDb=function(ac,Kc){qe.sTd(Kc.Fj)};qe.$=La;qe.rn=Db;qe.$.na.uq(qe.Nh);qe.rn.MYb(qe.hDb);qe.rn.yne(qe.wwf);qe.$Zg=uc;qe.jZi=Vc;qe.VTj=yd;qe.kVj=Md;qe.mLa={};qe.O_a=new Set;qe.rn.K_a();jc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&(qe.currentUserId=qe.$.workbookContext.ClientId,
qe.NNf(),qe.$.ea.bha(qe.kI));qe.obj=jc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveWebRequestsForCollabServiceContentUpdates",!1);return qe}function e(La,Db,uc,Vc){this.UYd=new Ae.a(!0);this.UYd.add(uc,Object.assign(new l,{RtcUpdateType:La,XrevidSaved:Db,ClientId:uc}));this.Cr=Vc}function l(){}function n(La,Db,uc){this.jGc={};this.kGc={};this.Cr=uc;this.c_b(La,this.jGc);this.c_b(Db,this.kGc)}function m(La,Db,uc){this.nbh=La;this.ymc=Db;this.Cr=uc}function f(La,Db,uc,Vc){this.jCc=
this.jqc=this.wpc=this.Tdc=0;this.E9d=this.Dcf=!1;this.clientId=La;this.Rah=Db;this.$=Vc;this.axi=Wb.a.we()+uc}function x(La,Db,uc,Vc,yd){var Md=uf.call(this)||this;Md.ij=La;Md.Xoj=Db;Md.Woj=uc;Md.n7=Vc;Md.E_g=yd;return Md}function y(La,Db,uc){this.Uha=new Xf.a;this.Uha.add(La.ClientId,La);this.Cr=Db;this.l4=uc}function t(){}function B(La){var Db=Ze.call(this)||this;Db.Fe=null;Db.mergeSuspensionManager=null;Db.Zwa=!1;Db.nDd=null;Db.Md=!1;Db.Uyc=!1;Db.Syc=!1;Db.Tyc=!1;Db.rEb=function(uc,Vc){Db.Zwa!==
Vc.Zwa&&(Db.Zwa=Vc.Zwa,Db.nDd=Db.Zwa?null:ie.a.Ra.Kb)};Db.rd=function(){Db.$.Uu&&Db.RHj()};Db.$c=function(uc,Vc){Vc.qc||Db.Ur(uc,Vc)};Db.Ur=function(){if(0<Db.Xza.length||0<Db.iea.count)Ub.ULS.sendTraceTag(537154128,13,15,"Dropping {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",Db.Xza.length,Db.iea.count),Db.Xza=[],Db.iea=new Pd.a;Db.rob.cancel();Db.zcg();Db.IXd();Db.RQj()};Db.sCf=function(uc,Vc){Db.PHj();Db.QHj();uc=new u;uc.Xluid=Vc.ij;uc.NotificationReceivedOn=ie.a.Ra.Kb.toISOString();
uc.CurrentPresenceUserCount=Db.$.ea.km.length;uc.OurCollabModeIsUsingOcs=Db.$.ea.n7a;uc.SenderCollabMode=Vc.Xoj;uc.SenderClientType=Vc.Woj;uc.SessionSiteIdentifier=Vc.n7;uc.CommandTimeInMs=Vc.E_g;Ub.ULS.sendTraceTag(537154127,13,50,"ContentLatencyTracker.OnRemoteRevisionGenerated: RevisionGeneratedNotification: {0}",JSON.stringify(uc));Db.Xza.push(uc)};Db.Jg=function(){Db.vDe(Db.$.ea.uf,"OnBlockCacheConsistent")};Db.wCf=function(uc,Vc){(uc=Object(Jb.a)(589,Vc.qf))&&Db.vDe(uc.DJ,"OnRenderedContent")};
Db.jVj=function(){if(!Db.$.ea.qc)Ub.ULS.sendTraceTag(537154122,13,15,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: session isn't active");else if(Db.Xza.length||Db.iea.count){var uc=null;0<Db.Xza.length&&(uc=Db.Xza,Db.Xza=[]);var Vc=null;if(0<Db.iea.count){Vc=Array(Db.iea.count);for(var yd=0,Md=yl(Db.iea.values),qe=Md.next();!qe.done;qe=Md.next())qe=qe.value,Vc[yd++]=qe;Db.iea=new Pd.a}Ub.ULS.sendTraceTag(537154120,13,100,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: Uploading {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",
uc?uc.length:0,Vc?Vc.length:0);yd=Db.$.na.ta;Md=Db.dVi;qe=yd.Na(1,null);qe.GenerateNotifications=uc;qe.DownloadNotifications=Vc;bc.i(yd,"UploadLatencyTelemetry",qe,Md,null,null,null,128)}};Db.dVi=function(uc){uc.Result&&0<uc.Result&&Db.Ovd()};Db.$=La;Db.Ca=of.g(Db.$).Ca;Db.viewport=of.g(Db.$).view;Db.contentRefreshManager=Db.$.da.Aa(292);Db.sf=Db.$.sf;Db.Xza=[];Db.iea=new Pd.a;La=jc.EwaSettings.la(289)?1E3:3E4;Db.rob=mf.a.instance.nC(Db.jVj,La,Zd.a.h2g,!1,!1);Db.$.Qk(Db.rd);Db.$.ea.Uj(Db.$c);Db.$.ea.BVc(Db.Ur);
Db.$.da.Za(291,function(uc){Db.Fe=uc});Db.$.da.Za(343,function(uc){Db.Md||(Db.mergeSuspensionManager=uc,Db.mergeSuspensionManager.hZb(Db.rEb),Db.mergeSuspensionManager.bGb())});Ub.ULS.sendTraceTag(537154131,13,50,"ContentLatencyTracker initialized");Db.rd(Db.$,null);return Db}function z(){}function u(){}function C(La){this.$=La}function r(La){this.$=La}function J(La){this.$=La}function v(La,Db,uc,Vc,yd,Md){Md=La.Na(1,void 0===Md?null:Md);return bc.i(La,"CheckWorkbookFileNameUpdate",Md,Db,uc,Vc,yd,
0)}function D(La,Db,uc,Vc,yd,Md,qe){qe=La.Na(1,void 0===qe?null:qe);qe.fullSaveId=Db;return bc.i(La,"ProcessFullSaveStartedNotification",qe,uc,Vc,yd,Md,0)}function V(La,Db,uc,Vc,yd,Md,qe){qe=La.Na(1,void 0===qe?null:qe);qe.updateInfo=Db;return bc.i(La,"BatchCheckCollabServiceContent",qe,uc,Vc,yd,Md,516)}function U(La,Db,uc){var Vc=If.call(this)||this;Vc.yEd=null;Vc.DPa=null;Vc.YDb=function(yd,Md){if(Md.bP){yd=[];var qe=[],ac=of.g(Vc.$).ha,Kc=!(2===ac.Ve||128===ac.Ve);ac=Kc?qd.k(ac.va.selectedRanges,
Vc.$):ac.Pa.lc.floatingObject;Md=Md.bP;for(var dd in Md)Vc.presenceView.bIe(ac,Kc,yd,qe,dd);dd=yl(Vc.RHa);for(Md=dd.next();!Md.done;Md=dd.next())Md=Md.value,Array.contains(yd,Md)||Array.contains(qe,Md)||Vc.presenceView.bIe(ac,Kc,yd,qe,Md.UserID);Vc.RHa=[];Array.addRange(Vc.RHa,yd);Array.addRange(Vc.RHa,qe);Vc.yEd&&(Wd.a.Fa(Vc.DPa),Vc.DPa=null,Vc.yEd=null);var Ud=U.nve(yd,qe);Vc.DPa=new Yd.a;Vc.yEd=Ua.TaskExtensions.Ba(ra.Task.delay(1),function(){Vc.ariaLiveNotifier.wab(Ud,ig.a.uZa)},Vc.DPa.token,
3)}};Vc.$=Db;Vc.ariaLiveNotifier=La;Vc.presenceView=uc;Vc.RHa=[];uc.HFa(Vc.YDb);Vc.$.da.Ha(231,Vc);return Vc}function Q(La){var Db=je.call(this)||this;Db.manager=null;Db.$=La;Db.dc();return Db}function la(La,Db){var uc=ng.call(this)||this;uc.Fj=null;uc.fieldManagerPane=null;uc.z_=null;uc.uMb=null;uc.J9f=null;uc.messageId=0;uc.lp=function(){uc.$&&uc.CNd(0,!1)};uc.fj=function(){uc.qVd?uc.uMb(!1):(uc.xc.PresenceType=1,uc.raiseEvent(la.C0),uc.sendPresenceToService(!1))};uc.Kg=function(){uc.qVd?uc.J9f(!1):
(uc.ecb(!1),uc.zNd())};uc.Xmc=function(){uc.ha.Pa.lc?uc.CNd(1,!1):uc.LNd(0,!1)};uc.lma=function(Vc,yd){uc.raiseEvent(la.wEd,yd)};uc.nd=function(){uc.LNd(of.g(uc.$).isEditing?1:0,!1)};uc.$c=function(Vc,yd){hf.a(yd)&&(uc.Wqa={})};uc.ODb=function(){uc.UXf()};uc.vFf=function(Vc,yd){if(yd&&yd.methodName in la.Gpc){Vc=!1;switch(la.Gpc[yd.methodName]){case 0:yd=yd.parameters.cell;break;case 1:yd=yd.parameters.parameters.Location;break;case 2:yd=qd.v(uc.ha.va.activeRange,uc.$);Vc=!0;break;default:return}yd.LastColumn=
yd.FirstColumn;yd.LastRow=yd.FirstRow;yd.NamedObjectName=null;uc.xc.SelectedRange=[yd];uc.xc.PresenceType=0;if(Vc){yd=[];Vc=yl(uc.$.zb.sUh());for(var Md=Vc.next();!Md.done;Md=Vc.next()){Md=Md.value;var qe={};qe.ObjectType=uc.Taa(Md.type);qe.ObjectPresenceType=1;qe.ObjectId=Md.ij;Array.add(yd,qe)}uc.xc.Object=yd}else yd=Mb(yd,uc.$,1),Vc=null,yd&&(Vc={},Vc.ObjectType=uc.Taa(yd.type),Vc.ObjectPresenceType=0,Vc.ObjectId=yd.ij),uc.xc.Object=[Vc];uc.raiseEvent(la.C0);uc.sendPresenceToService(!1)}};uc.Mn=
function(Vc,yd){yd.context.methodName in la.Gpc&&(uc.xc.Object=[null],uc.ecb(!1))};uc.Nh=function(Vc,yd){yd.context.methodName in la.Gpc&&(uc.xc.Object=[null],uc.ecb(!1))};uc.rd=function(Vc,yd){yd.wK||(uc.Wqa={},jc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&uc.$.ya.IsMeetingLiveSession&&uc.$.ya.IsMeetingPresenter&&(uc.xc.MeetingInfo=uc.Lfd()),uc.$.Uu?uc.e5a():uc.jNb())};uc.od=function(){uc.zNd()};uc.Tif=function(){uc.UXf();uc.Qtf.vz()};uc.$=La;
uc.ha=of.g(uc.$).ha;uc.jOa=Db;uc.Ohf=jc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1);uc.$.Qk(uc.rd);uc.$.vl(uc.od);uc.Wqa={};uc.$Wa=new Me.a(null,null,null,null);uc.oAa={};uc.oAa.b=0;uc.oAa.c=0;uc.Qtf=new ba(uc.$);jc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&uc.$.ya.IsMeetingLiveSession&&uc.$.ya.IsMeetingPresenter&&(uc.xc.MeetingInfo=uc.Lfd());uc.qVd=jc.EwaSettings.KH();uc.qVd&&(uc.uMb=kf.a(function(Vc){uc.xc.PresenceType=
1;uc.raiseEvent(la.C0);uc.sendPresenceToService(Vc)},40,uc.$.ma,"SelectionPresenceManager.SendPresenceToService",!0),uc.J9f=kf.a(function(Vc){uc.ecb(Vc);uc.zNd()},40,uc.$.ma,"SelectionPresenceManager.SendCurrentPresence",!0));return uc}function ba(La){var Db=rf.call(this)||this;Db.statusBarManager=null;Db.$=La;Db.$.da.Za(29,function(uc){Db.statusBarManager=uc;uc.xJ(Db)});return Db}function T(La,Db,uc,Vc,yd){yd=void 0===yd?null:yd;var Md=Ee.call(this)||this;Md.yu={};Md.I3b=0;Md.H3b=0;Md.wrb=null;Md.Tsd=
null;Md.Smf=3E4;Md.ljd=!1;Md.BQd=!0;Md.uEd=null;Md.txf=function(){var qe=Md.vma,ac;for(ac in qe)qe=ac,Md.zme(qe)?(Md.Qjc(qe,!0),delete Md.A$a[qe],delete Md.vma[qe]):Ub.ULS.sendTraceTag(537154377,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",qe)};Md.KBd=function(qe,ac){qe={};qe.UpdatedCount=ac.bP?Object.keys(ac.bP).length:0;qe.DisconnectedCount=ac.K3?ac.K3.length:0;qe.Location="canvas";sd.b(Md.$).ee(be.a.DEd,qe);qe=null;Md.$.Vb&&(qe=Md.$.Vb.Wh("ModelUpdate","PresenceRendering"),
qe.start());var Kc={};if(ac.bP){if(jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var dd=(new Date).getTime();Ua.TaskExtensions.Ba(sa.GetServiceTaskFactory.Wa(Md.$.da,435,436,1),function(pg){pg.result.iwi(dd)},Md.$.ma,3)}Md.Atb||(Md.uud(!0),Md.Atb=!0);var Ud=ac.bP;for(wf in Ud){var Le=Ud[wf],ce=wf;Md.sld[ce]=ie.a.Ra.Kb;if(!dc.e(Md.$)||null==Le.NavigationState)if(Md.FAe(ce,new Date),Md.tIg(Le),ce!==Md.wrb){var Nf=Md.yu[ce];Nf||(Md.zme(ce)?Md.Qjc(ce,!0):(ce in
Md.vma?Ub.ULS.sendTraceTag(537154376,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",ce):(Md.A$a[ce]=ie.a.Ra.Kb,Kc[ce]=1),Md.vma[ce]=!0,Nf=Md.EVh(ce),Md.yu[ce]=Md.GFe(Nf)),Nf=Md.yu[ce]);Nf&&(Nf.xc=Le,Le.SelectedRange&&1<Le.SelectedRange.length?Md.I3b++:Md.H3b++,Md.hQf(ce),Md.L_a(Nf))}}if(jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&Md.$.ea&&Md.$.ea.X4a){var af=(new Date).getTime();Ua.TaskExtensions.Ba(sa.GetServiceTaskFactory.Wa(Md.$.da,
435,436,1),function(pg){pg.result.jwi(af)},Md.$.ma,3)}}if(ac.K3){var wf=0;for(Ud=ac.K3.length;wf<Ud;wf++)ce=ac.K3[wf],Md.T6c[ce]=ie.a.Ra.Kb,Md.aQf(ce,!0)}if(ac.K3&&0<ac.K3.length||0<Gd.a(Kc).length||0<Gd.a(Md.vma).length)wf=[],Array.addRange(wf,Gd.a(Kc)),Array.addRange(wf,Gd.a(Md.vma)),(Kc=Md.$.da.Aa(292))&&Kc.ANb(wf,ac.K3);qe&&qe.stop();Md.ljd=!1;qe=Md.yu;for(var vf in qe)if(0===Object(Jb.a)(ma,qe[vf]).xc.CollabMode){Md.ljd=!0;break}Md.raiseEvent("pcek",ac)};Md.g8=function(qe,ac){ac&&Md.$.Uu&&(ac.XFa.HasAnyNonOcsCoauthor=
Md.ljd)};Md.ODb=function(){var qe=new Sf.a({},null),ac=Md.KBa,Kc;for(Kc in ac){var dd=Kc,Ud=ac[Kc].xc;Ud.SelectedRange=Ud.SelectedRangeRaw;qe.bP[dd]=Ud}Md.KBd(Md,qe)};Md.nd=function(){Md.t7e()};Md.ixi=function(){Md.Tsd&&kd.a(ie.a.Ra,Md.Tsd)<Md.Smf||(Md.Tsd=ie.a.Ra.Kb,Md.Xtd(),Md.lui(),Md.Uui(),Md.Atb||Md.uud(!1))};Md.w6=function(){Md.t7e();var qe=Md.yu,ac;for(ac in qe)Md.L_a(qe[ac])};Md.od=function(){Md.Xtd();Md.Atb||Md.uud(!1);Md.Atb=!1};Md.QBf=function(){var qe=Md.yu,ac;for(ac in qe)qe[ac].dispose();
Md.yu={};Md.cze();Md.A$a={};Md.EOc={};Array.clear(Md.Qx);Md.Cxc()};Md.hDb=function(qe,ac){Md.sTd(ac.Fj)};Md.T6c={};Md.sld={};Md.A$a={};Md.EOc={};Md.$=La;Md.jOa=Vc;Md.rn=Db;Md.Gge=uc;ca.FKb=!0;ca.Ona=!0;Md.e5a();Md.jy=new X(La);Md.$.xa&&Md.$.xa.Qf(Md.w6);Md.rn.MYb(Md.hDb);La.na&&Md.$.na.P9(Md.g8);Md.Qx=[];Md.rn.K_a();La.da.Ha(25,Md);Md.Atb=!1;Md.$.vl(Md.od);Md.oXc=mf.a.instance.nC(Md.ixi,Md.Smf/2,Zd.a.r1i,!0,!1);Md.vEd=yd;return Md}function H(La,Db,uc){var Vc=ma.call(this)||this;Vc.iH=new Ae.a(!0);
Vc.m3c=0;Vc.n3c=0;Vc.countFloatingObjects=0;Vc.ht=function(){Vc.IOd()};Vc.w6=function(){Vc.IOd()};Vc.Oz=new Ka(La);Vc.j1f(La);Vc.jy=uc;Vc.FPd([]);Vc.$=Db;Vc.$.xa.Qf(Vc.w6);of.g(Vc.$).XT(Vc.ht);return Vc}function S(La,Db,uc){var Vc=Oc.call(this,Db,of.g(Db),!0,!1,La.User.UserID)||this;Vc.gN=[];Vc.p1d=46;Vc.cLb=!1;Vc.Mgc=!1;Vc.ZDb=function(){if(Vc.Ao.User.UserID===S.excelLiveManager.pPa.bL){var yd=Vc.Ao.UserColor;Vc.gN.forEach(function(Md){Md.style.backgroundColor=yd;Md.style.opacity="0.1"});Vc.gN=[]}};
S.q0a||(S.q0a={});Vc.Ao=La;Vc.dv=new da(Vc.gridView,Vc.Ao.User.UserID,Vc.Ao.User.UserName,Vc.Ao.UserColor,Vc,uc,Vc.$,Vc.Ao.IsAnonymous);Vc.ZDb=Vc.ZDb.bind(Vc);dc.f(Vc.$)&&Vc.dti();return Vc}function K(La,Db,uc){this.fi=this.objectId=this.pDa=null;this.Ao=La;this.$=Db;this.jy=uc;this.dv=new da(of.g(this.$),this.Ao.User.UserID,this.Ao.User.UserName,this.Ao.UserColor,null,uc,this.$,this.Ao.IsAnonymous)}function da(La,Db,uc,Vc,yd,Md,qe,ac){var Kc=ae.call(this)||this;Kc.jd=null;Kc.uz={};Kc.Tke=0;Kc.Ira=
null;Kc.fi=null;Kc.Rqa=0;Kc.ADb=function(dd){Kc.Ira&&Kc.Ira!==dd||(Kc.Ira=null,Kc.V4(!1));Kc.raiseEvent("hidePresenceTooltip")};Kc.iEb=function(dd){Kc.Ira&&Kc.Ira!==dd||(Kc.Ira=null,Kc.Pna(!0,!1));Kc.raiseEvent("showPresenceTooltip")};Kc.hEb=function(dd){Kc.Ira||Kc.raiseEvent("showFullPresenceTooltip");Kc.Ira=dd};Kc.YDb=function(){Kc.V4(!1);Kc.raiseEvent("presenceChanged")};ac=uc===ge.a.instance.Cb(86)||ac;Kc.POc=new Me.a(Db,uc,Vc,new rc.a,null,null,null,null,ac);Kc.gridView=La;Kc.xSc=Db;Kc.highlight=
yd;Kc.jy=Md;Kc.$=qe;return Kc}function fa(La,Db,uc,Vc,yd){var Md=Uc.call(this)||this;Md.Qx=[];Md.j_a=null;Md.visible=!1;Md.GAb=null;Md.pob=null;Md.Hua=!1;Md.Xie=null;Md.fDj=function(){Wd.a.Fa(Md.pob);Md.pob=null;Md.visible&&(Md.uMa()?Md.raiseEvent("showPresenceTooltip"):Md.V4(!0))};Md.MAd=function(qe){Md.Vab(qe)};Md.xz=function(){Md.Ycg()};Md.DF=function(){Md.Ycg()};Md.domElement=La;Md.gridView=Db;Md.xSc=La.id;Md.Rqa=Vc;Md.$=yd;Md.Ihc=!1;Md.N9e();Md.POc=uc;Md.fi=null;Md.Yw={};Md.Yw.FirstColumn=0;
Md.Yw.FirstRow=0;Md.Yw.LastColumn=0;Md.Yw.LastRow=0;return Md}function X(La){var Db=this;this.Jhc=!1;this.Joa=this.CEd=null;this.ADb=function(uc){var Vc=Db.Uja(uc.CB);Vc&&Db.osc(Vc,uc.iza.clientId,uc.CB)};this.iEb=function(uc){Db.lX(!1,uc)};this.hEb=function(uc){Db.lX(!0,uc)};this.xz=function(){Db.Seg()};this.DF=function(){Db.Seg()};this.w6=function(){Db.Yqb();Db.clearCache()};this.d1h=function(uc){uc=ze.DOMElementExtensions.getBounds(uc.element);uc=new Yc.a(uc.x,uc.y,uc.width,uc.height);for(var Vc=
yl(ja.JKa()),yd=Vc.next();!yd.done;yd=Vc.next())if(yd=Db.gridView.Sf(yd.value),yd=ze.DOMElementExtensions.getBoundingClientRect(yd.domElement),(new Yc.a(yd.x,yd.y,yd.width,yd.height)).Qd(uc))return yd;return null};this.SUj=function(){var uc=Db.uz,Vc;for(Vc in uc){var yd=uc[Vc];if(yd){var Md=yd.uMa(),qe=Db.Uja(yd.CB),ac=Md?Db.s2e(yd.kqc,yd.paneType,yd.range):null;if(ac!==qe){qe&&Db.osc(qe,yd.iza.clientId,yd.CB);if(!ca.Ona)break;ac&&Md&&(ac.BYa(yd.iza),Db.XTa[yd.CB]=ac,yd.LLb(ac),Db.J7e(ac,yd))}else Db.J7e(qe,
yd)}}};this.x$e=Tc.a.Buh;this.jwa=20;this.gridView=of.g(La);this.$=La;this.DFb={};this.XTa={};this.uz={};this.WTa={};this.$.xa&&this.$.xa.Qf(this.w6);this.Yqb()}function ca(){}function ja(La,Db,uc){var Vc=Hc.call(this)||this;Vc.eza=null;Vc.yIf=null;Vc.PMd=!1;Vc.xz=function(){Vc.nkd()};Vc.DF=function(){Vc.nkd()};Vc.gridView=La;Vc.rtl=La.rtl;Vc.ipd=!1;Vc.Go=new Ae.a(!0);for(var yd=0;4>yd;yd++)if(Vc.gridView.$a.dqd(uc,ja.JKa()[yd])||1===ja.JKa()[yd]){var Md=Db.v5g(),qe=La.Sf(ja.JKa()[yd]).domElement;
qe.insertBefore(Md.element,qe.firstChild);Vc.Go.add(Enum.toString(nb,ja.JKa()[yd]),Md)}return Vc}function ea(La,Db,uc){if(!Db)return null;La=La.Iq;return new Sys.UI.Point(Db.x+La.x*(uc?1:-1),Db.y+La.y*(uc?1:-1))}function qa(La){this.Ae=La;this.Ae.zYa(10,mc.a.instance);this.Ae.zYa(9,Nd.a.instance);this.Ae.zYa(6,20);this.Ae.zYa(13,Wc.a.instance);this.Ae.zYa(17,!1)}function pa(La,Db,uc){La=jb.call(this,La)||this;La.rDa=!1;La.CSb=!1;La.U8=!1;La.jXa=!1;La.lA=[];La.Pib={};La.Ae=uc;La.kj=uc.get(8,!1);La.W7d=
uc.get(15,!1);La.Lng=uc.get(12,0);La.tsa=uc.get(6,0);La.lWb=Db;La.Rje=uc.get(16);La.BIc=uc.get(17,!1);La.h_j=uc.get(19,!1);La.hug=uc.get(20,!1);La.qTb=0;La.dug=new Ha(La.kj,La.BIc);La.qgb=La.xZe();La.BOc=!1;La.afa=[];La.Rib=[];La.element.id=pa.GHh();La.element.className=jb.M9g(La.kj);La.Lrb&&(La.zIndex=La.Lrb);La.rtl=La.kj;La.wqj(Db);La.Dfa=La.createElement("div");La.Dfa.className="prFlyoutContainer";La.element.appendChild(La.Dfa);La.bM=[];La.fqa=new Pa(La.YJ,La.element,La.tsa,4,6,32,La.kj);La.gA=
uc.get(9);La.gA.qa(hd.a.pointerDown,La.fqa.element,Object(pb.a)(La,La.v9a,"onHitTarget"));La.gA.qa(hd.a.pointerOver,La.fqa.element,Object(pb.a)(La,La.v9a,"onHitTarget"));La.gA.qa(hd.a.pointerOut,La.fqa.element,Object(pb.a)(La,La.v9a,"onHitTarget"));return La}function Pa(La,Db,uc,Vc,yd,Md,qe){this.bM=La;this._parent=Db;this.I3d=uc;this.Hmg=Vc;this.sqg=yd;this.MXa=Md;this.qJ=qe;this._element=document.createElement("div");this.element.className="prTouchTarget"}function Ha(La,Db){this.kj=void 0===La?
!1:La;this.BIc=void 0===Db?!1:Db}function Xa(La,Db,uc,Vc){this.offsetTop=La;this.offsetLeft=Db;this.ngg=void 0===uc?2:uc;this.R9e=void 0===Vc?4:Vc}function Na(La,Db){var uc=jb.call(this,La)||this;uc.Fi=null;uc.gA=null;uc.NGc=null;uc.bKc=null;uc.dGc=null;uc.Ypa=null;uc.wje=null;uc.qJ=Db.get(8,!1);uc.Ihb=Db.get(6,0);uc.tyg=Db.get(15,!1);uc.Ae=Db;uc.v6d=0;uc.element=La;uc.element.className=Na.BEh;uc.GG=document.createElement("span");uc.element.appendChild(uc.GG);uc.gog=db.dOh(Db.get(6,0));uc.hv(Db);
uc._state=5;return uc}function db(){}function Ja(La,Db){var uc=Re.call(this)||this;uc.type=La;uc.Wsb=Db;return uc}function jb(La){var Db=ke.call(this)||this;Db._element=null;Db.element=La;return Db}function hc(){this.uP={}}function ma(){var La=Qd.call(this)||this;La.Oz=null;La.hee=null;La.jee=null;return La}function Ka(La){var Db=Cd.call(this)||this;Db.Bje=La;Db.Wqa=null;Db.UOc=null;return Db}function Ta(La){var Db=Qe.call(this)||this;Db.$=La;Db.dc();return Db}function ob(La){var Db=this;this.hJf=
this.zEd=this.jJf=this.fJf=this.qHf=this.dMd=this.jVf=this.pVf=this.oVf=!1;this.AEd=this.pDd=this.lIb=this.nIb=this.buc=this.hMd=0;this.xhf=!1;this.zxd=this.opb=0;this.Nhc=!1;this.$c=function(){Db.Nhc=!0;Db.$.ea.lk(Db.$c)};this.$=La;kc.a.eQ&&(this.zxd=window.performance.timing.navigationStart);this.zxd||Ub.ULS.sendTraceTag(537154379,0,15,"Navigation start time is zero");this.$.ea.Uj(this.$c)}function Cb(){var La=me.call(this)||this;La.TCe=null;La.dc();return La}function eb(){}function ya(){}function za(La){var Db=
this;this.Ma=new fd.a;this.disposed=!1;this.xEb=function(){Ub.ULS.sendTraceTag(537154381,0,50,"PeopleInfoProvider.OnUserListUpdated fired");Db.Ma.raiseEvent("UU",Db)};this.$=La;this.$.ea.bha(this.xEb)}function Ga(La){var Db=rb.call(this)||this;Db.manager=null;Db.$=La;Db.dc();return Db}function cb(La){var Db=ld.call(this)||this;Db.ata=null;Db.y0a=null;Db.Jta=!1;Db.YCc=!1;Db.Mf=function(){var uc=Db.$.ea.Dm;if(null===uc||void 0===uc?0:uc.SheetChanges){uc=yl(uc.SheetChanges);for(var Vc=uc.next();!Vc.done;Vc=
uc.next())if(Vc=Vc.value,2===Vc.Type){if(Db.ata)for(var yd=yl(Db.ata),Md=yd.next();!Md.done;Md=yd.next())Md=Md.value,Md.Range.SheetName===Vc.Name&&(Md.Range.SheetName=Vc.NewName);if(Db.y0a)for(yd=yl(Db.y0a),Md=yd.next();!Md.done;Md=yd.next())Md=Md.value,Md.Range.SheetName===Vc.Name&&(Md.Range.SheetName=Vc.NewName)}}};Db.fzf=function(){Ub.ULS.sendTraceTag(537154395,0,50,"NamedSheetViewConversionManager.OnGridLoaded");Db.YCc=!1;Db.Lmc(Db,Sys.EventArgs.Empty)};Db.od=function(){Ub.ULS.sendTraceTag(537154394,
0,50,"NamedSheetViewConversionManager.OnWorkbookClosing");Db.YCc=!0};Db.Lmc=function(){Ub.ULS.sendTraceTag(50620166,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: triggered with version [{0}]",Db.$.ea.hya);if(!Db.$.isEditMode||!Db.$.ea.qc||Db.$.ea.T4a||Db.YCc||Db.$.ea.hya===se.a.z5b)Ub.ULS.sendTraceTag(537154393,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: Request skipped [Edit Mode: {0}] [IsSessionActive: {1}] [HasRaisedSessionEnded: {2}] [WorkbookClosed: {3}]",
Db.$.isEditMode,Db.$.ea.qc,Db.$.ea.T4a,Db.YCc);else{Db.ata=null;Db.y0a=null;var uc=Db.$.na.ta.Zb(),Vc=Db.$.na.ta,yd=Db.KMi,Md=Db.JMi,qe=Vc.Na(1,null);bc.i(Vc,"GetNamedSheetViewConversion",qe,yd,Md,null,uc,132)}};Db.KMi=function(uc){if(Ke.a.er(uc.Errors)){Db.Jta=!0;var Vc=[-1100324317,-1857233882];Ke.a.kh(uc.Errors,Vc)&&Ub.ULS.sendTraceTag(537154392,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionSuccess Errors: [{0}]",Ke.a.Tc(uc.Errors));uc=Ke.a.SF(uc.Errors,Vc,"NamedSheetViewConversionManager:OnGetNamedSheetViewConversionSuccess");
Db.$.ea.np(uc)}else Db.Jta=!1,uc=uc.Result,Db.$.ea.hya=uc.ConversionVersion,Db.s2i(uc.NamedSheetViewConversionEntries),Db.w4i()};Db.JMi=function(uc){Db.Jta=!0;uc=oe.a.og(uc.data);Ub.ULS.sendTraceTag(537154391,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionFailure: Errors: [{0}].",Ke.a.Tc(uc))};Db.$=La;Ub.ULS.shipAssertTag(537154397,0,!!Db.$.ea,"NamedSheetViewConversionManager ctor: EwaControl.SessionStateManager should not be null");Db.$.vl(Db.od);Db.$.ea.YT(Db.fzf);Db.$.ea.XFg(Db.Lmc);
Db.$.ea.Dt(Db.Mf);Db.$.ea.Vt&&Db.Lmc(Db,Sys.EventArgs.Empty);return Db}function Mb(La,Db,uc){if(!Db||!Db.zb)return null;for(var Vc=0;Vc<Db.zb.count;Vc++){var yd=Db.zb.getItem(Vc);if(yd&&yd.type===uc&&yd.usedRange&&yd.usedRange.contains(qd.D(La))&&zc.a.equals(yd.sheetName,La.SheetName,!0))return yd}return null}function Dc(La,Db){return!!La&&!!Db&&La.SheetName===Db.SheetName&&(!!La.NamedObjectName&&La.NamedObjectName===Db.NamedObjectName||!La.NamedObjectName&&!Db.NamedObjectName&&qd.D(La).Qd(qd.D(Db)))}
function vb(){}function ib(La,Db,uc,Vc,yd,Md,qe,ac,Kc){Kc=void 0===Kc?!1:Kc;this.ipa=null;this.vIc=!0;this.OOc=this.KEa=this.hFc=null;this.rb=new fd.a;this.Rsg=La;this.Yfe=Db;this.iee=uc;this.gee=Vc;this.f2d=Md;ib.me=yd;this.nug=qe;this.Lqa=ac;this.Nug=Kc;ra.Task.WAA(Db,uc).continueWith(Object(pb.a)(this,this.N$h,"initOnTaskReady"))}function ub(La){var Db=Zc.call(this)||this;Db.Y2b=null;Db.qVf=null;Db.hga=null;Db.c9d=!1;Db.lW=function(uc,Vc){if(2===Vc.newState){if(Db.Fj){if(jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var yd=
(new Date).getTime();Ua.TaskExtensions.Ba(sa.GetServiceTaskFactory.Wa(Db.$.da,435,436,1),function(Md){Md.result.Cwi(yd)},Db.$.ma,3)}Db.raiseEvent("connectionCompleted",new Eb(Db.Fj),Vc)}else Ub.ULS.sendTraceTag(537167630,0,15,"RealTimeChannelController.OnConnectionStateChanged: new state is connected and this.RealTimeChannel is null");Db.Y2b=Vc}else if(2===Vc.oldState||0===Vc.newState)Db.Y2b=null,Db.raiseEvent("connectionLostEventKey")};Db.Foc=function(){if(Db.Fj){var uc=Object(Jb.a)(284,Db.Fj);uc&&
(Ub.ULS.sendTraceTag(537167629,0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),uc.disconnect(),uc.wsc(Db.lW))}Db.hga=null};Db.$=La;Db.$.vl(Db.Foc);Db.$.ea.BVc(Db.Foc);La.da.Za(38,function(uc){uc.voe(Db.Foc)});return Db}function Eb(La){var Db=Lb.call(this)||this;Db.Fj=La;return Db}function Ya(){}function tb(La,Db,uc,Vc,yd,Md,qe,ac,Kc){qe=void 0===qe?null:qe;ac=void 0===ac?null:ac;Kc=void 0===Kc?null:Kc;this.yee={};this.qGc={};this.w$d=new ta.a;this.Uib=this.Xw=this.vVb=null;
this.Ohe=this.Nhe=0;this.hFa=new Ia.a(function(){return qe.$Q("PresenceBootLatencyThreshold",1E4)});this.TCa=new Ia.a(function(){return qe.$Q("PresenceBootLatencyCutoffThreshold",6E4)});this.Lyg=new Ia.a(function(){return qe.$Q("PresenceLightupLatencyThreshold",2E3)});this.xng=new Ia.a(function(){return qe.$Q("PresenceLightupLatencyCutoffThreshold",1E4)});this.cug=Vc;this.E3d=La;this.Xfe=Db;this.Vqa=uc;this.ai=yd;this.SWa=ac;this.zCa=Md;this.Ld=Kc;this.t2d=!1;this.init()}function ec(La,Db,uc){this.a3d=
this.C3d=this.rQb=this.BQb=this.IUa=0;this._id=La;this.hFa=Db;this.TCa=uc;this.LUa=Object(Jb.a)(String,cc.AFrameworkApplication.Yb.Application)||""}function Za(La,Db,uc,Vc,yd,Md,qe,ac,Kc){this.Uge=!1;this._id=La;this.Cp=Db;this.aM=uc;this.yNc=Vc;this.bSc=yd;this.hFa=Md;this.TCa=qe;this.x3d=ac;this.zCa=Kc;this.LUa=Object(Jb.a)(String,cc.AFrameworkApplication.Yb.Application)||""}function mb(){this.ct=this.vt=this.d=0}function sc(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=
!1}function pd(La,Db,uc,Vc){this.l9=null;this.FHc=this.xNc=!1;this.Gkb=La;this.KRc=Db;this.wb=uc;this.SWa=Vc}function $b(La){this.Xw=null;this.CQb={};this.zUb={};this.Tib=null;this.Vqa=La}function Xb(La,Db,uc,Vc,yd,Md,qe,ac,Kc){this.Kde=this.F3d=this.Xw=null;this.BPb=La;this.pWb=new ic.a;this.wb=uc;this.rGc=Db;this.MUa=Vc;this.ai=yd;this.GOc=Md;this.Vqa=qe;this.llg=ac;this.L7d=this.I7d=!1;this.LWb=0;this.D3d=1;this.zCa=Kc;this.Fje=this.wb.ra("PeoplesWellExtraButtonInfoIsEnabled");this.LUa=Object(Jb.a)(String,
cc.AFrameworkApplication.Yb.Application)||""}function lc(La,Db){this.l9=null;this.Gkb=La;this.$tg=Db}b.r(F);var Oa=b(0),pb=b(80);lc.prototype.init=function(){var La=this;this.Gkb.continueWith(function(){La.l9=La.Gkb.result;La.l9.OYa(Object(pb.a)(La,La.LF,"onUsersUpdated"))})};lc.prototype.LF=function(){lc.kse(this.l9.Zua())&&(this.l9.Rsc(Object(pb.a)(this,this.LF,"onUsersUpdated")),this.$tg.IsRealCoauthSession=!0)};lc.kse=function(La){var Db,uc=null;La=yl(La);for(Db=La.next();!Db.done;Db=La.next())if(Db=
Db.value)if(Db=Db.isAnonymous||!Db.email?Db.clientId:Db.email.toUpperCase(),!uc)uc=Db;else if(uc!==Db)return!0;return!1};Object(Oa.a)(lc,"CoauthTelemetry",null,[422]);var Ub=b(13),ic=b(139),Jb=b(84),cc=b(5),Ob;(function(La){La[La.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";La[La.notImplemented=1]="notImplemented";La[La.renderHandled=2]="renderHandled";La[La.renderHandledWithVeto=3]="renderHandledWithVeto"})(Ob||(Ob={}));Object(Oa.b)("CoauthorGalleryTelemetryEndResult",Ob);var P=b(95),
Ba=b(109),ra=b(52);Xb.prototype.init=function(){var La=this;ra.Task.WAA.call(null,this.Vqa,this.rGc,this.GOc).continueWith(function(){La.Xw=La.Vqa.result;La.F3d=La.rGc.result;La.Kde=La.GOc.result;ra.Task.WAA.call(null,La.rGc.result.s1c,La.GOc.result.Tzc).continueWith(function(){La.D3d=La.F3d.s1c.result;La.LWb=La.Kde.Tzc.result;La.Xw.OYa(Object(pb.a)(La,La.Boc,"onUsersUpdatedEventListener"));La.Xw.Zua().length&&La.LF()})})};Xb.prototype.Boc=function(){this.LF()};Xb.prototype.LF=function(){this.llg(this.Xw.Zua())?
(this.Xw.Rsc(Object(pb.a)(this,this.Boc,"onUsersUpdatedEventListener")),this.nLi(this.I7d)):this.pWb.Ow(1);this.I7d=!0};Xb.prototype.nLi=function(La){var Db=this;this.L7d?this.Q6f.continueWith(function(){Ub.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",Ob[Db.Q6f.result])}):(this.L7d=!0,this.R2i(0===this.D3d&&!La))};Xb.prototype.R2i=function(La){La?this.MUa.kl(4,Object(pb.a)(this,this.KAd,"onInteractiveReady")):this.pWb.Ow(1)};Xb.prototype.KAd=function(){var La=
this.ai.sH("AppInitStatus_interactivityReady");Ub.ULS.shipAssertTag(42259235,325,!!this.LWb);var Db=this.LWb-La;La={InteractiveTime:La};La.ReactRenderComplete=this.LWb;La.HadTabSwitch=this.zCa();La.IsModernGallery=this.Fje;Ub.ULS.sendTraceTag(594883104,325,50,Ba.a.toJSON(La));this.Fje?(Ub.ULS.sendTraceTag(42062997,325,15,Db.toString()),this.pWb.Ow(this.eXj(Db)?3:2)):Ub.ULS.sendTraceTag(594883103,325,15,Db.toString())};Xb.prototype.eXj=function(La){var Db=La>this.wb.Ad("CoauthorGalleryTimeToRenderDurationMs",
1E4),uc="Word"===this.LUa;if(this.zCa())return Ub.ULS.sendTraceTag(50455714,325,50,Db.toString()),!1;uc&&P.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);Db&&(uc&&P.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",!1,!0,null),Ub.ULS.sendTraceTag(42062998,325,15,La.toString()));return Db};Sk.Object.defineProperties(Xb.prototype,{Q6f:{configurable:!0,enumerable:!0,get:function(){return this.pWb.task}}});
Object(Oa.a)(Xb,"CoauthorGalleryTelemetry",null,[421]);$b.prototype.Gbc=function(La){var Db=this,uc=new ic.a;this.init().continueWith(function(){La in Db.CQb?uc.Ow(Db.CQb[La]):Db.zUb[La]=uc});return uc.task};$b.prototype.init=function(){var La=this;if(this.Tib)return this.Tib.task;this.Tib=new ic.a;this.Vqa.continueWith(function(){La.Xw=La.Vqa.result;La.Xw.OYa(Object(pb.a)(La,La.LF,"onUsersUpdated"));La.meg();La.Tib.setResult(null)});return this.Tib.task};$b.prototype.meg=function(){var La=this.Xw.Zua();
La.sort(Object(pb.a)(this,this.B0g,"comparePresenceUsers"));this.CQb={};for(var Db=0;Db<La.length&&La[Db]&&La[Db].hla;Db++)this.qCg(this.CQb,La[Db].clientId,Db)};$b.prototype.qCg=function(La,Db,uc){La[Db]=uc;Db in this.zUb&&(this.zUb[Db].Ow(uc),delete this.zUb[Db])};$b.prototype.LF=function(){this.meg()};$b.prototype.B0g=function(La,Db){return La.hla>Db.hla?1:La.hla<Db.hla?-1:0};Object(Oa.a)($b,"CoauthorPositionFinder",null,[420]);var ta=b(184);pd.prototype.init=function(){var La=this;this.Gkb.continueWith(function(){La.l9=
La.Gkb.result;La.l9.OYa(Object(pb.a)(La,La.LF,"onUsersUpdated"))})};pd.prototype.LF=function(){this.e_g(this.l9.Zua());!this.xNc||this.hGe&&!this.FHc||this.l9.Rsc(Object(pb.a)(this,this.LF,"onUsersUpdated"))};pd.prototype.e_g=function(La){var Db=new ta.a,uc=0;La=yl(La);for(var Vc=La.next();!Vc.done;Vc=La.next())(Vc=Vc.value)&&Vc.isAnonymous&&(cc.AFrameworkApplication.Yjc("70eb6120;2gfeb930"),this.hGe&&!this.FHc&&(Db.contains(Vc.userName)?(Ub.ULS.sendTraceTag(526394833,302,50,"Duplicate guest friendly name detected"),
this.FHc=!0):Db.add(Vc.userName)),Vc.clientId===this.SWa||this.xNc||(uc++,2<=uc&&this.Uvi()))};pd.prototype.Uvi=function(){var La=this;Ub.ULS.sendTraceTag(525112603,302,50,"Multiple guests simultaneously coauthoring");this.xNc=!0;this.Z2h&&this.KRc&&this.KRc.continueWith(function(){window.setTimeout(function(){La.KRc.result.logActivity("MultipleGuestsCoauthoring",null)},5E3)})};Sk.Object.defineProperties(pd.prototype,{hGe:{configurable:!0,enumerable:!0,get:function(){return this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",
!1)}},Z2h:{configurable:!0,enumerable:!0,get:function(){return this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GuestCoauthFloodgateEnabled",!1)}}});Object(Oa.a)(pd,"GuestCoauthTelemetry",null,[]);var Ia=b(685);Object(Oa.a)(sc,"PL",null,[]);var bb=b(40);mb.rYf=function(La,Db,uc){var Vc=new mb;Vc.d=La;Vc.vt=Db;Vc.ct=uc;return bb.c(Vc)};Object(Oa.a)(mb,"VD",null,[]);var Va=b(338);Za.prototype.veto=function(La){var Db=this;ra.Task.WAA(this.yNc,this.bSc).continueWith(function(){if(Db.yNc.result<=
Db.bSc.result)La.Ow(!1);else{var uc=Db.aM-Db.Cp,Vc=new sc;Vc.id=Db._id;Vc.et=Db.aM;Vc.st=Db.Cp;Vc.d=Db.aM-Db.Cp;Vc.mp=Db.yNc.result;Vc.tp=Db.bSc.result;Vc.ct=Db.sMh(Db.x3d);Vc.vc=Db.zCa();var yd=bb.c(Vc),Md="Word"===Db.LUa;Ub.ULS.sendTraceTag(42078597,302,15,yd);if(Md){var qe=new Map;qe.set("data",yd);P.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",qe)}uc>Db.hFa.value&&!Db.Uge&&!Vc.vc&&(Db.Uge=!0,La.Ow(!0),Vc=Object.assign(new Va.a,{inStaging:!0,extendedProperties:new Map}),
Vc.extendedProperties.set("data",yd),Md&&P.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,Vc),uc<Db.TCa.value&&Ub.ULS.sendTraceTag(42078598,302,15,mb.rYf(uc,Db.hFa.value,Db.TCa.value)));La.task.isCompleted||La.Ow(!1)}})};Za.prototype.sMh=function(La){switch(La){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}};Object(Oa.a)(Za,"PresenceLatencyActivityLogger",null,[]);ec.prototype.Z_c=function(){!this.sAe&&
this.IUa&&this.BQb&&(this.C3d=this.veto(this.BQb,"CoauthGalleryLightupDurationTooLong"));!this.qxe&&this.IUa&&this.rQb&&(this.a3d=this.veto(this.rQb,"CanvasPresenceLightupDurationTooLong"))};ec.prototype.veto=function(La,Db){var uc=La-this.IUa,Vc=new sc;Vc.id=this._id;Vc.et=La;Vc.st=this.IUa;Vc.d=uc;var yd=bb.c(Vc);La="Word"===this.LUa;Vc="CanvasPresenceLightupDurationTooLong"===Db?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===Db?Ub.ULS.sendTraceTag(572289499,
302,15,yd):Ub.ULS.sendTraceTag(571524118,302,15,yd);if(La){var Md=new Map;Md.set("data",yd);P.Health.instance.recordKpiUsage(Vc,0,"wordcollabrel",Md)}return uc>this.hFa.value?(Md=Object.assign(new Va.a,{inStaging:!0,extendedProperties:new Map}),Md.extendedProperties.set("data",yd),yd=uc<this.TCa.value,Md.extendedProperties.set("cash",yd?"true":"false"),La&&P.Health.instance.recordKpiFailure(Vc,Db,!1,!0,Md),Ub.ULS.sendTraceTag(572289500,302,15,mb.rYf(uc,this.hFa.value,this.TCa.value)),yd?2:1):3};Sk.Object.defineProperties(ec.prototype,
{zIg:{configurable:!0,enumerable:!0,get:function(){return this.IUa},set:function(La){this.IUa=La;this.Z_c()}},VZg:{configurable:!0,enumerable:!0,get:function(){return this.BQb},set:function(La){this.BQb=La;this.Z_c()}},pVg:{configurable:!0,enumerable:!0,get:function(){return this.rQb},set:function(La){this.rQb=La;this.Z_c()}},sAe:{configurable:!0,enumerable:!0,get:function(){return 0!==this.C3d}},qxe:{configurable:!0,enumerable:!0,get:function(){return 0!==this.a3d}}});Object(Oa.a)(ec,"PresenceLightupLatencyLogger",
null,[]);var lb=b(51),kc=b(314);tb.prototype.klh=function(La,Db,uc){var Vc=this;uc=void 0===uc?null:uc;var yd=void 0===yd?0:yd;uc&&(Ub.ULS.shipAssertTag(42274970,302,!this.SWa||this.SWa===uc,"_myClientId is already set and you are trying to update it to something different"),this.SWa=uc);var Md=new ic.a;this.init().continueWith(function(){Vc.WQi(La);Vc.llh(Md,La,Db,yd)})};tb.prototype.init=function(){var La=this;if(this.Uib)return this.Uib.task;this.Uib=new ic.a;this.zCa()&&Ub.ULS.sendTraceTag(50951700,
302,15,"TabSwitched Session");this.E3d.continueWith(function(){var Db=La.E3d.result,uc=Db.s1c,Vc=Db.YBi;Vc.continueWith(function(){uc.continueWith(function(){La.Ld&&La.Ld.addQosPillar("RealTimeCoauth");La.AGj(uc.result,Vc.result);La.Uib.setResult(null)})})});this.Xfe.continueWith(function(){La.vVb=La.Xfe.result;La.vVb.GYa(Object(pb.a)(La,La.dSi,"onRtcConnection"));La.vVb.NYa(Object(pb.a)(La,La.aJi,"onCoauthorBootReceived"))});this.Vqa.continueWith(function(){La.Xw=La.Vqa.result;La.Xw.OYa(Object(pb.a)(La,
La.Boc,"onUsersUpdatedEventListener"));0<La.Xw.Zua().length&&La.LF()});return this.Uib.task};tb.prototype.IYe=function(){return this.ai.Ysa(lb.a.TTa)?this.ai.sH(lb.a.TTa):kc.a.eQ?window.performance.timing.fetchStart:-1};tb.prototype.dSi=function(La,Db){this.t2d||2!==Db.newState||(La=Date.now()-this.IYe(),Db={},Db.clientId=this.Orf,Db.bootTime=La,this.t2d=!0,this.vVb.Nda(15,Db))};tb.prototype.aJi=function(La,Db){if(15===Db.type){La=Date.now();Db=Db.a8;var uc=Db.bootTime;this.Ffd(Db.clientId).zIg=La-
uc}};tb.prototype.Boc=function(){this.LF()};tb.prototype.LF=function(){var La=Date.now(),Db=this.Xw.Zua(),uc=new ta.a;Db=yl(Db);for(var Vc=Db.next();!Vc.done;Vc=Db.next())Vc=Vc.value,this.w$d.contains(Vc.clientId)||(this.w$d.add(Vc.clientId),uc.add(Vc.clientId));if(0<uc.count)for(uc=yl(uc),Db=uc.next();!Db.done;Db=uc.next())Db=this.Ffd(Db.value),Db.sAe||(Db.VZg=La)};tb.prototype.WQi=function(La){La=this.Ffd(La);La.qxe||(La.pVg=Date.now())};tb.prototype.Ffd=function(La){return La in this.qGc?this.qGc[La]:
this.qGc[La]=new ec(La,this.Lyg,this.xng)};tb.prototype.AGj=function(La,Db){Db=void 0===Db?0:Db;this.Nhe=La;this.Ohe=Db?Db:(new Date).getTime()};tb.prototype.llh=function(La,Db,uc,Vc){uc=uc?uc.getTime():(new Date).getTime();Db in this.yee?La.Nz():(Vc=new Za(Db,this.FZh(),uc,this.Gbc(this.Orf),this.Gbc(Db),this.hFa,this.TCa,Vc,this.zCa),this.yee[Db]=Vc,Vc.veto(La))};tb.prototype.FZh=function(){return 1===this.Nhe?this.Ohe:this.IYe()};tb.prototype.Gbc=function(La){return this.cug.Gbc(La)};Sk.Object.defineProperties(tb.prototype,
{Orf:{configurable:!0,enumerable:!0,get:function(){return this.SWa||"{"+cc.AFrameworkApplication.userSessionId+"}"}}});Object(Oa.a)(tb,"PresenceBootTelemetry",null,[414]);var zb=b(144),Sb=b(273),gb=b(211),Sa=b(86),Kb=b(525);Ya.prototype.ji=function(La){var Db=this;La.register(lc,"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").Bc().Lc(function(){return new lc(Kb.a.Tq(La.oc("Common.IPeopleInfoProvider")),cc.AFrameworkApplication.dg)});La.register(Xb,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").Bc().Lc(function(){return new Xb(cc.AFrameworkApplication.Gb,
Kb.a.Tq(La.oc("Common.ICoauthoringTelemeryInfoProvider")),cc.AFrameworkApplication.ga,zb.a.get_instance(),gb.a.instance,Kb.a.Tq(La.oc("Common.IPeoplesWell")),Kb.a.Tq(La.oc("Common.IPeopleInfoProvider")),lc.kse,function(){return Db.Wue()})});La.register(tb,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").Bc().Lc(function(){return new tb(Kb.a.Tq(La.oc("Common.ICoauthoringTelemeryInfoProvider")),Kb.a.Tq(La.oc("Common.IRealtimeChannelBasic")),
Kb.a.Tq(La.oc("Common.IPeopleInfoProvider")),La.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),gb.a.instance,function(){return Db.Wue()},cc.AFrameworkApplication.ga,null,P.Health.instance)});La.register($b,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").Bc().Lc(function(){return new $b(Kb.a.Tq(La.oc("Common.IPeopleInfoProvider")))});La.register(pd,"Common.App.CoauthTelemetry.GuestCoauthTelemetry").Bc().Lc(function(){return new pd(Kb.a.Tq(La.oc("Common.IPeopleInfoProvider")),
Kb.a.Tq(La.oc("Common.ISystemInitiatedFeedback")),cc.AFrameworkApplication.ga,"{"+cc.AFrameworkApplication.userSessionId+"}")})};Ya.prototype.init=function(){cc.AFrameworkApplication.ga.ow(function(){Sa.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();Sa.a.instance.resolve("Common.App.CoauthTelemetry.GuestCoauthTelemetry").init();cc.AFrameworkApplication.ga.ra("CoauthorGalleryTelemetryIsEnabled")&&Sa.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();cc.AFrameworkApplication.ga.ra("CashTelemetryIsEnabled")&&
(Sa.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),Sa.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})};Ya.prototype.dispose=function(){};Ya.prototype.Wue=function(){return kc.a.eQ&&gb.a.instance.Ysa(lb.a.VNb)?0<gb.a.instance.sH(lb.a.VNb)[lb.a.xgg]:!1};Ya.main=function(){Sb.a.instance.sj(new Ya)};Sk.Object.defineProperties(Ya.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CoauthTelemetry"}}});Object(Oa.a)(Ya,"CoauthTelemetryPackage",
null,[4,5]);var Gc=b(934),Hb=b(36),Lb=Sys.EventArgs;vm(Eb,Lb);Object(Oa.a)(Eb,"ConnectionCompletedEventArgs",Sys.EventArgs,[]);var sa=b(56),Ua=b(35),Yb=b(53),jc=b(1),md=b(48),jd=b(1227),Zc=Hb.a;vm(ub,Zc);ub.prototype.MYb=function(La){this.addHandler("connectionCompleted",La)};ub.prototype.gJd=function(La){this.removeHandler("connectionCompleted",La)};ub.prototype.xVc=function(La){this.addHandler("rtcInitialized",La)};ub.prototype.tHb=function(La){this.removeHandler("rtcInitialized",La)};ub.prototype.yne=
function(La){this.addHandler("connectionLostEventKey",La)};ub.prototype.CQf=function(La){this.removeHandler("connectionLostEventKey",La)};ub.prototype.dispose=function(){this.Fj&&this.Fj.wsc(this.lW);this.$&&this.$.sn(this.Foc);this.hga=this.$=null;Zc.prototype.dispose.call(this)};ub.prototype.hFe=function(La){Ua.TaskExtensions.Ba(this.c3e().task,function(Db){La(Db.result)},this.ma)};ub.prototype.WBe=function(La,Db){this.c9d=Db;this.oPi(La)};ub.prototype.K_a=function(){this.Fj&&(this.raiseEvent("rtcInitialized"),
2===this.Fj.connectionState&&this.Y2b&&this.raiseEvent("connectionCompleted",new Eb(this.Fj),this.Y2b))};ub.prototype.Iti=function(){Ub.ULS.sendTraceTag(537167633,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice");if(jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5856505_RtcDownloadBreakDownMetrics")){var La=(new Date).getTime();Ua.TaskExtensions.Ba(sa.GetServiceTaskFactory.Wa(this.$.da,435,436,1),function(Vc){Vc.result.Fwi(La)},this.$.ma,3)}var Db=[];Db.push(Yb.a.current.ro(43));Db.push(Yb.a.current.ro(44));
Db=Yb.a.Ftd(Db,this.$.ma);var uc=Yb.a.loadScript(10,0,1);return ra.Task.WAA.call(null,Db,uc)};ub.prototype.oPi=function(La){var Db=this,uc=this.Iti();Ua.TaskExtensions.Ba(uc,function(){Ub.ULS.sendTraceTag(537167632,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice Before RealtimeChannel create. RealtimeChannel = null: {0}",void 0===Gc.RealtimeChannel||null===Gc.RealtimeChannel);if(jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var Vc=(new Date).getTime();
Ua.TaskExtensions.Ba(sa.GetServiceTaskFactory.Wa(Db.$.da,435,436,1),function(qe){qe.result.Gwi(Vc)},Db.$.ma,3)}Db.hga=Gc.RealtimeChannel.createInstance(La,Db.$.ya.UserSessionId,cc.AFrameworkApplication.rVf,cc.AFrameworkApplication.Jd,null,2,md.b().b5e(),Db.$.workbookContext.RtcEndpointUrl,void 0,new jd.a,void 0,void 0,Db.$.workbookContext.RtcBootToken);Ub.ULS.sendTraceTag(571770432,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice RealtimeChannel created");jc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",
!1)&&(Sa.a.instance.register(Gc.RealtimeChannel,"AppRealtimeChannel.RealtimeChannel").as("Common.IRealtimeChannelBasic").as("AppRealtimeChannel.IRealtimeChannel").Bc().Lc(function(){return Db.Fj}),Sa.a.instance.resolve("Common.IRealtimeChannelBasic"));Db.c3e().setResult(Db.Fj);if(jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var yd=(new Date).getTime();Ua.TaskExtensions.Ba(sa.GetServiceTaskFactory.Wa(Db.$.da,435,436,1),function(qe){qe.result.Ewi(Db.vnd,yd)},
Db.$.ma,3)}Db.raiseEvent("rtcInitialized");Ub.ULS.sendTraceTag(571770403,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice raise RealTimeChannelInitializedEventKey");var Md=Object(Jb.a)(284,Db.Fj);Md&&(Ub.ULS.sendTraceTag(571770402,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice attach changed handler"),Md.GYa(Db.lW),Md.connect())},this.ma,3)};ub.prototype.c3e=function(){return this.qVf||(this.qVf=new ic.a)};ub.ja=function(La){La.da.Ha(26,new ub(La))};Sk.Object.defineProperties(ub.prototype,
{Fj:{configurable:!0,enumerable:!0,get:function(){return this.hga}},vnd:{configurable:!0,enumerable:!0,get:function(){return this.c9d}}});Object(Oa.a)(ub,"RealTimeChannelController",Hb.a,[9,10]);var Qb=b(10),fd=b(93),xd=b(108),Ad=b(30);ib.prototype.qMf=function(){this.rb.raiseEvent("u",null,this)};ib.prototype.N$h=function(){this.Yfe.result&&this.iee.result&&(this.KEa=this.Yfe.result,this.OOc=this.iee.result,this.KEa.IFa(Object(pb.a)(this,this.lma,"onPresenceUpdated")),this.hFc=new xd.a(2,2,this.f2d,
Object(pb.a)(this,this.qRj,"updateAwayClientsTask"),88),ib.me.Zg(this.hFc))};ib.prototype.lma=function(La,Db){(this.vIc||this.y7i(Db.bP))&&ib.me.$ma(this.hFc,0)};ib.prototype.y7i=function(La){for(var Db in La){var uc=this.gee.t2e({key:Db,value:La[Db]});if(uc&&uc.clientId&&(uc=uc.clientId.toLowerCase(),(uc=this.ipa[uc]||this.ipa[uc.toUpperCase()])&&2===uc.status))return!0}return!1};ib.prototype.qRj=function(La){var Db=this.KEa.$Jh();if(Db){var uc=new Date,Vc=!1;if(this.vIc){this.ipa=Db;this.vIc=!1;
Db=this.ipa;for(var yd in Db){var Md=yd,qe=Db[yd];qe.O7a<uc&&(uc=qe.O7a);2===qe.status&&(Vc=!0,this.OOc.jQf(Md))}Vc&&this.qMf();ib.me.$ma(La,this.t1e(uc))}else{qe=new ta.a;yd=!1;var ac=this.ipa;for(Md in ac)if(ac=Md,ac in this.ipa&&this.Rsg.clientId!==ac){var Kc=this.ipa[ac],dd=Db[ac];if(Kc&&dd){Kc=Kc.status;var Ud=dd.status;2===Kc&&1===Ud?(qe.add(ac),Ub.ULS.sendTraceTag(38052609,392,50,ac+" returned from away")):1===Kc&&2===Ud&&(yd=Vc=!0,this.OOc.jQf(ac),Ub.ULS.sendTraceTag(38052610,392,50,ac+" went away"));
1===Ud&&dd.O7a<uc&&(uc=dd.O7a)}}this.ipa=Db;ib.me.$ma(La,this.t1e(uc));(0<qe.count||Vc)&&this.qMf();0<qe.count&&!this.Nug?(La=this.yMh(qe),this.JLj(La)):La=new ta.a;(yd||0<La.count)&&this.nug(Ad.a.r1c,2)}}};ib.prototype.JLj=function(La){if(La.count){La=yl(La);for(var Db=La.next();!Db.done;Db=La.next())Db=this.Lqa.M$(String.format(CommonUIStrings.l_EditorsToastArriving,Db.value),!1),Db.image=5,Db.pka="CoAuth_AuthorStatus_16x16x32",this.Lqa.$D(Db)}};ib.prototype.yMh=function(La){var Db=this.KEa.udd(),
uc=new ta.a,Vc;for(Vc in Db){var yd={key:Vc,value:Db[Vc]};if(La.contains(yd.key)){var Md=this.gee.t2e(yd);Md&&(uc.add(Md.userName),La.remove(yd.key))}}uc.count||Ub.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return uc};ib.prototype.t1e=function(La){var Db=new Date;return Math.max(La.getTime()+this.f2d-Db.getTime(),0)};ib.me=null;Object(Oa.a)(ib,"AwayManager",null,[]);var Me=b(1301),Ue=b(98),Jd=b(282),Sd=b(214);Object(Oa.a)(vb,"NamedSheetViewConversionEntry",null,[]);var se=
b(8),oe=b(114),Ke=b(27),bc=b(81),qd=b(43),zc=b(19),ld=Hb.a;vm(cb,ld);cb.prototype.ioe=function(La){this.addHandler("SVCU",La)};cb.prototype.fRf=function(La){this.removeHandler("SVCU",La)};cb.prototype.dispose=function(){this.y0a=this.ata=null;this.$&&this.$.sn(this.od);this.$.ea&&(this.$.ea.jS(this.fzf),this.$.ea.fdj(this.Lmc),this.$.ea.Ew(this.Mf));this.$=null;ld.prototype.dispose.call(this)};cb.prototype.j3g=function(La){return this.Jta?null:this.KCe(La,this.y0a,"ConvertPresencePublicToPrivate")};
cb.prototype.i3g=function(La){return this.Jta?null:this.KCe(La,this.ata,"ConvertPresencePrivateToPublic")};cb.prototype.s2i=function(La){La?(this.fch(La),this.ata=La,this.y0a=this.u7g(this.ata)):Ub.ULS.sendTraceTag(537154396,0,10,"NamedSheetViewConversionManager.ProcessConversionEntries: conversionEntries can be empty but not null")};cb.prototype.w4i=function(){Ub.ULS.sendTraceTag(537154390,0,50,"NamedSheetViewConversionManager.RaiseConversionUpdatedEvent: new version is update on client from server");
this.raiseEvent("SVCU")};cb.prototype.KCe=function(La,Db,uc){if(!Db||!Db.length)return Ub.ULS.sendTraceTag(537154389,0,50,"NamedSheetViewConversionManager.{0}: skipping convert due to {1} ConversionEntries. ",uc,Db?"empty":"null"),La;uc=yl(La);for(var Vc=uc.next();!Vc.done;Vc=uc.next()){Vc=Vc.value;for(var yd=yl(Db),Md=yd.next();!Md.done;Md=yd.next())if(Md=Md.value,Md.IsRow&&Dc(Md.Range,Vc)&&!(Vc.FirstRow<=Md.Range.FirstRow&&Vc.LastRow>=Md.Range.LastRow)){var qe={};qe.SheetName=Vc.SheetName;qe.FirstRow=
qe.LastRow=Vc.FirstRow;qe.FirstColumn=qe.LastColumn=Vc.FirstColumn;Dc(Md.Range,qe)?(qe=Vc.FirstRow-Md.Range.FirstRow,0>qe||qe>=Md.ConversionMap.length?Ub.ULS.sendTraceTag(537154388,0,10,"NamedSheetViewConversionManager.ConvertRanges: invalid mapIndex after adjust. Index: [{0}], ConversionMap.Length: {1}",qe,Md.ConversionMap.length):(qe=Md.ConversionMap[qe]-qe,Vc.FirstRow+=qe,Vc.LastRow=Vc.FirstRow,Vc.LastColumn=Math.min(Vc.LastColumn,Md.Range.LastColumn))):Vc.FirstRow<Md.Range.FirstRow&&Vc.LastRow>=
Md.Range.FirstRow?Vc.LastRow=Md.Range.FirstRow-1:Vc.LastColumn>=Md.Range.FirstColumn&&(Vc.LastColumn=Md.Range.FirstColumn-1)}if(0>Vc.FirstRow||Vc.FirstRow>se.a.rz)Vc.FirstRow=Math.max(Math.min(Vc.FirstRow,se.a.rz),0);if(0>Vc.LastRow||Vc.LastRow>se.a.rz)Vc.LastRow=Math.max(Math.min(Vc.LastRow,se.a.rz),0);if(0>Vc.FirstColumn||Vc.FirstColumn>se.a.uw)Vc.FirstColumn=Math.max(Math.min(Vc.FirstColumn,se.a.uw),0);if(0>Vc.LastColumn||Vc.LastColumn>se.a.uw)Vc.LastColumn=Math.max(Math.min(Vc.LastColumn,se.a.uw),
0)}return La};cb.prototype.u7g=function(La){if(!La||!La.length)return Ub.ULS.sendTraceTag(537154387,0,50,"NamedSheetViewConversionManager.CreateInverseConversionEntries: skip creating inverse due to {0} ConversionEntries. ",this.ata?"empty":"null"),La;for(var Db=Array(La.length),uc=0;uc<La.length;++uc){var Vc=new vb;Vc.Range=La[uc].Range;Vc.IsRow=La[uc].IsRow;Vc.ConversionMap=Array(La[uc].ConversionMap.length);Vc.IsRow||(this.Jta=!0,Ub.ULS.sendTraceTag(537154386,0,10,"NamedSheetViewConversionManager.CreateInverseConversionEntries: adjusting presence against column sort map is NYI."));
for(var yd=0;yd<La[uc].ConversionMap.length;++yd)Vc.ConversionMap[La[uc].ConversionMap[yd]]=yd;Db[La.length-uc-1]=Vc}return Db};cb.prototype.fch=function(La){if(La&&La.length){La=yl(La);for(var Db=La.next();!Db.done;Db=La.next()){Db=Db.value;this.ech(Db);var uc=Db.IsRow?Db.Range.LastRow-Db.Range.FirstRow+1:Db.Range.LastColumn-Db.Range.FirstColumn+1;Db.ConversionMap.length!==uc&&(Ub.ULS.shipAssertTag(537154385,0,!1,"NamedSheetViewConversionManager.DecompressEntries: decompressed conversion map doesn't match expected size - Expected: [{0}] | Actual: [{1}]",
uc,Db.ConversionMap.length),this.Jta=!0)}}};cb.prototype.ech=function(La){var Db=La.ConversionMap;if(Db&&Db.length)if(0>Db[0])Ub.ULS.shipAssertTag(537154384,0,!1,"NamedSheetViewConversionManager.DecompressConversionMap: conversionMap starts with a negative number"),this.Jta=!0;else{for(var uc=[],Vc=0;Vc<Db.length;++Vc)if(0>Db[Vc])for(var yd=Db[Vc-1],Md=-1*Db[Vc],qe=1;qe<=Md;++qe)Array.add(uc,yd+qe);else Array.add(uc,Db[Vc]);La.ConversionMap=uc}};Object(Oa.a)(cb,"NamedSheetViewConversionManager",Hb.a,
[620,3]);var rb=Sd.a;vm(Ga,rb);Ga.prototype.create=function(){this.Fb(this.manager||(this.manager=new cb(this.$)))};Object(Oa.a)(Ga,"NamedSheetViewConversionManagerFactory",Sd.a,[]);var Wd=b(88),rc=b(1137);za.prototype.dispose=function(){this.disposed||(this.$&&this.$.ea&&this.$.ea.sda(this.xEb),Wd.a.rc([this.Ma]),this.$=this.Ma=null,this.disposed=!0)};za.prototype.OYa=function(La){this.Ma.addHandler("UU",La)};za.prototype.Rsc=function(La){this.Ma.removeHandler("UU",La)};za.prototype.Zua=function(){for(var La=
[],Db=yl(this.$.ea.km),uc=Db.next();!uc.done;uc=Db.next())uc=uc.value,uc=new Me.a(uc.User.UserID,uc.User.UserName,uc.UserColor,new rc.a(1),null,uc.UserEmail,void 0,void 0,void 0,void 0,void 0,uc.JoinCoauthTime),Array.add(La,uc);Ub.ULS.sendTraceTag(537154383,0,50,"PeopleInfoProvider.GetAllUsers: Count: [{0}]",La.length);return La};Object(Oa.a)(za,"PeopleInfoProvider",null,[586,3]);var nd=b(683);ya.prototype.$D=function(){Ub.ULS.sendTraceTag(537154380,0,50,"PresenceBootstrapper.AddNotificationBarEntry: User state changed from inactive to active")};
ya.prototype.removeEntry=function(){};ya.prototype.M$=function(La,Db){return new nd.a(La,Db)};ya.prototype.dispose=function(){};Sk.Object.defineProperties(ya.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return!1}}});Sk.Object.defineProperties(ya,{instance:{configurable:!0,enumerable:!0,get:function(){ya.Oa||(ya.Oa=new ya);return ya.Oa}}});ya.Oa=null;Object(Oa.a)(ya,"NoOpNotificationBar",null,[585,3]);eb.prototype.t2e=function(La){var Db=La.key;La=La.value;if(!La)return null;
var uc=La.SupportsChat?4:0;return Object.assign(new Me.a,{clientId:Db,Y_c:La.ChatThreadId,X_c:La.ChatThreadDiscoveryUri,yxb:La.InChat,email:La.Cid,capabilities:new rc.a(uc)})};Object(Oa.a)(eb,"PresenceConverter",null,[616]);var me=Sd.a;vm(Cb,me);Cb.prototype.create=function(){this.Fb(this.TCe||(this.TCe=new eb))};Cb.ja=function(La){La.da.Ha(159,new Cb)};Object(Oa.a)(Cb,"PresenceConverterFactory",Sd.a,[]);var be=b(126),sd=b(127);ob.prototype.Fwi=function(La){this.oVf||(this.hMd=La,this.oVf=!0)};ob.prototype.Gwi=
function(La){this.pVf||(this.buc=La,this.pVf=!0)};ob.prototype.Ewi=function(La,Db){this.jVf||(this.nIb=Db,this.xhf=La,this.jVf=!0)};ob.prototype.Cwi=function(La){this.dMd||(this.lIb=La,this.dMd=!0)};ob.prototype.iwi=function(La){!this.zEd&&this.dMd&&(this.AEd=La,this.zEd=!0)};ob.prototype.fwi=function(La){this.qHf||(this.pDd=La,this.qHf=!0)};ob.prototype.hwi=function(La){if(!this.fJf&&this.hha&&!this.Nhc){this.fJf=!0;var Db=this.Ydd();Db.RtcIntializeToPeopleWellServiceCreate=this.pDd-this.nIb;Db.PeopleWellServiceCreateToPresenceGalleryRender=
La-this.pDd;Db.PresenceGalleryRenderTotalTime=La-this.hha;sd.b(this.$).ee(be.a.gJf,Db,void 0,!0)}};ob.prototype.kwi=function(La){if(!this.jJf&&this.hha&&!this.Nhc){this.jJf=!0;var Db=this.Ydd();Db.RtcIntializeToRtcConnect=this.lIb-this.nIb;Db.RtcConnectToPresenceSent=La-this.lIb;Db.PresenceSentTotalTime=La-this.hha;sd.b(this.$).ee(be.a.kJf,Db,void 0,!0)}};ob.prototype.jwi=function(La){if(!this.hJf&&this.zEd&&this.hha&&!this.Nhc){this.hJf=!0;var Db=this.Ydd();Db.RtcIntializeToRtcConnect=this.lIb-this.nIb;
Db.RtcConnectToPresenceRenderInitiate=this.AEd-this.lIb;Db.PresenceRenderInitiateToPresenceRenderFinish=La-this.AEd;Db.PresenceRenderTotalTime=La-this.hha;sd.b(this.$).ee(be.a.iJf,Db,void 0,!0)}};ob.prototype.dispose=function(){this.$=null};ob.prototype.Ydd=function(){var La={};La.CoAuthorCountsOnBoot=this.$.ea.km.length;La.RtcConnectedLaterInSession=this.xhf;La.BrowserVisibilityChanged=this.NPg();La.AppInteractiveAbsTime=this.hha;La.NavigationStartTime=this.zxd;La.AppInteractiveToRtcSliceDownloadInitialize=
this.hMd-this.hha;La.RtcSliceDownloadInitializeToRtcSliceLoad=this.buc-this.hMd;La.AppInteractiveToRtcSliceLoad=this.buc-this.hha;La.RtcSliceLoadToRtcInitialize=this.nIb-this.buc;return La};ob.prototype.NPg=function(){return kc.a.eQ&&gb.a.instance.Ysa(lb.a.VNb)?0<gb.a.instance.sH(lb.a.VNb)[lb.a.xgg]:!1};Sk.Object.defineProperties(ob.prototype,{hha:{configurable:!0,enumerable:!0,get:function(){if(this.opb)return this.opb;gb.a.instance.Ysa("AppInitStatus_interactivityReady")&&(this.opb=gb.a.instance.sH("AppInitStatus_interactivityReady"));
this.opb||Ub.ULS.sendTraceTag(537154378,0,15,"App interactive time is zero");return this.opb}}});Object(Oa.a)(ob,"PresenceTelemetry",null,[615,3]);var Qe=Sd.a;vm(Ta,Qe);Ta.prototype.create=function(){this.Fb(this.$.da.Aa(435)||this.$.da.Ha(435,new ob(this.$)))};Ta.ja=function(La){La.da.Ha(436,new Ta(La))};Object(Oa.a)(Ta,"PresenceTelemetryFactory",Sd.a,[]);var Sf=b(1300),mf=b(44),Zd=b(42),ie=b(26),kd=b(113),ge=b(14),of=b(20),Ec=b(74),Cd=Hb.a;vm(Ka,Cd);Ka.prototype.dispose=function(){this.raiseEvent("userPresenceChanged");
this.raiseEvent("userLeft");this.UOc=this.Wqa=this.Bje=null;Cd.prototype.dispose.call(this)};Sk.Object.defineProperties(Ka.prototype,{ZNb:{configurable:!0,enumerable:!0,get:function(){return this.Bje}},xc:{configurable:!0,enumerable:!0,get:function(){return this.Wqa||{}},set:function(La){this.UOc=this.Wqa;this.Wqa=La;this.raiseEvent("userPresenceChanged")}},aFd:{configurable:!0,enumerable:!0,get:function(){return this.UOc}}});Object(Oa.a)(Ka,"UserPresence",Hb.a,[]);var Qd=Ec.a;vm(ma,Qd);ma.prototype.FPd=
function(La){this.hee=La};ma.prototype.j1f=function(La){this.jee=La};ma.prototype.L_a=function(){};ma.prototype.e4a=function(){return null};ma.prototype.Sed=function(){return null};ma.prototype.g5f=function(){};ma.prototype.h5f=function(){};ma.prototype.jeg=function(){};ma.prototype.zxc=function(){};ma.prototype.Adc=function(){};ma.NTj=function(La,Db){var uc=La.Oz.xc;Wd.a.rc(La.iy);Wd.a.rc([La.Oz]);La.Oz=null;La.Oz=new Ka(Db);La.FPd([]);La.j1f(Db);La.xc=uc};Sk.Object.defineProperties(ma.prototype,
{iy:{configurable:!0,enumerable:!0,get:function(){return this.hee}},Ao:{configurable:!0,enumerable:!0,get:function(){return this.jee}},xc:{configurable:!0,enumerable:!0,get:function(){return this.Oz.xc},set:function(La){this.Oz.xc=La}}});Object(Oa.a)(ma,"IUserGridPresence",Ec.a,[]);var od;(function(La){La[La.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";La[La.peopleImageClassName=1]="peopleImageClassName";La[La.peopleImageClusterPath=4]="peopleImageClusterPath";La[La.multipleBrowserImageClusterPath=
5]="multipleBrowserImageClusterPath";La[La.imageDimension=6]="imageDimension";La[La.rtl=8]="rtl";La[La.pointerInputManager=9]="pointerInputManager";La[La.clickInputManager=10]="clickInputManager";La[La.vertical=11]="vertical";La[La.zIndex=12]="zIndex";La[La.contextMenuInputManager=13]="contextMenuInputManager";La[La.imageDomElement=14]="imageDomElement";La[La.useIdleTooltip=15]="useIdleTooltip";La[La.viewportBoundsCallback=16]="viewportBoundsCallback";La[La.flipHorizontalDirection=17]="flipHorizontalDirection";
La[La.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";La[La.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";La[La.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(od||(od={}));Object(Oa.b)("PresenceTooltipSettingKeys",od);hc.prototype.get=function(La,Db){La=od[La];return"number"===typeof(void 0===Db?null:Db)?(Db=this.uP[La])?Number.parseInvariant(Db.toString()):0:this.uP[La]};hc.prototype.add=function(La,Db){this.uP[od[La]]=Db};hc.prototype.zYa=function(La,Db){od[La]in
this.uP||(this.uP[od[La]]=Db)};hc.prototype.remove=function(La){delete this.uP[od[La]]};Object(Oa.a)(hc,"PresenceTooltipSettings",null,[]);var ke=fd.a;vm(jb,ke);jb.prototype.dispose=function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;ke.prototype.dispose.call(this)};jb.prototype.createElement=function(La){return this.element.ownerDocument.createElement(La)};jb.prototype.Hyc=function(){return!0};jb.M9g=function(La){return"prControl"+
(La?"Rtl":"")};Sk.Object.defineProperties(jb.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return this._element},set:function(La){this._element=La}},visible:{configurable:!0,enumerable:!0,get:function(){return"visible"===this.element.style.visibility},set:function(La){this.element.style.visibility=La?"visible":"hidden"}},rtl:{configurable:!0,enumerable:!0,get:function(){return"rtl"===this.element.dir.toLowerCase()},set:function(La){this.element.dir=La?"rtl":"ltr"}},zIndex:{configurable:!0,
enumerable:!0,get:function(){return this.element.style.zIndex},set:function(La){this.element.style.zIndex=String(La)}}});Object(Oa.a)(jb,"BasePresenceControl",fd.a,[3,717]);var Re=Sys.EventArgs;vm(Ja,Re);Ja.zka="InteractivityChanged";Object(Oa.a)(Ja,"InteractivityChangedEventArgs",Sys.EventArgs,[]);db.dOh=function(La){return db.eOh(La)};db.eOh=function(La){var Db=document.createElementNS(db.J_d,"svg");Db.setAttribute("viewBox",String.format(db.bbh,db.qgg,db.pgg));Db.appendChild(db.g_h(La));return Db};
db.g_h=function(La){var Db=db.qgg/La,uc=2*Db,Vc=db.pgg/2;La=(La-12-8)*Db/2;var yd=document.createElementNS(db.J_d,"g");Sys.UI.DomElement.addCssClass(yd,db.abh);for(var Md=1;3>=Md;Md++)yd.appendChild(db.pMh(Md,uc,La+(6*Md-2)*Db,Vc));return yd};db.pMh=function(La,Db,uc,Vc){var yd=document.createElementNS(db.J_d,"circle");Sys.UI.DomElement.addCssClass(yd,String.format("{0}-{1}",db.NXg,La));yd.setAttribute("cx",String.format("{0}",uc));yd.setAttribute("cy",String.format("{0}",Vc));yd.setAttribute("r",
String.format("{0}",Db));return yd};db.J_d="http://www.w3.org/2000/svg";db.abh="prDancingDots";db.NXg="prAnimateCircle";db.bbh="0 0 {0} {1}";db.pgg=40;db.qgg=120;Object(Oa.a)(db,"ModernPresenceTooltipDancingDots",null,[]);var lf=b(142),vc=b(370),hd=b(12),Ac=b(89),Vd=b(165),Bd=b(87),tf=b(29);vm(Na,jb);Na.prototype.eVc=function(La){this.addHandler(Ja.zka,La)};Na.prototype.Fsc=function(La){this.removeHandler(Ja.zka,La)};Na.prototype.dispose=function(){this.element&&(this.Fi.za(hd.a.click,this.element,
Object(pb.a)(this,this.Zc,"onClick")),this.Fi.za(hd.a.hk,this.element,Object(pb.a)(this,this.Hyc,"stopPropagationAndPreventDefaultBehavior")),this.gA.za(hd.a.pointerDown,this.element,Object(pb.a)(this,this.onPointerDown,"onPointerDown")),this.gA.za(hd.a.pointerOut,this.element,Object(pb.a)(this,this.YN,"onPointerOut")),this.gA.za(hd.a.pointerOver,this.element,Object(pb.a)(this,this.xw,"onPointerOver")),this.NGc.za(this.element,Object(pb.a)(this,this.Hyc,"stopPropagationAndPreventDefaultBehavior")));
jb.prototype.dispose.call(this)};Na.prototype.hv=function(La){this.Fi=La.get(10);this.Fi.qa(hd.a.click,this.element,Object(pb.a)(this,this.Zc,"onClick"));this.Fi.qa(hd.a.hk,this.element,Object(pb.a)(this,this.Hyc,"stopPropagationAndPreventDefaultBehavior"));this.gA=La.get(9);this.gA.qa(hd.a.pointerOver,this.element,Object(pb.a)(this,this.xw,"onPointerOver"));this.gA.qa(hd.a.pointerOut,this.element,Object(pb.a)(this,this.YN,"onPointerOut"));this.gA.qa(hd.a.pointerDown,this.element,Object(pb.a)(this,
this.onPointerDown,"onPointerDown"));this.NGc=La.get(13);this.NGc.qa(this.element,Object(pb.a)(this,this.Hyc,"stopPropagationAndPreventDefaultBehavior"))};Na.prototype.hide=function(La,Db,uc){La=void 0===La?null:La;Db=void 0===Db?0:Db;uc=void 0===uc?0:uc;this.tyg&&La?this.DBj(La,Db,uc):(3===this.state&&this.JPf(),this.visible=!1,this._state=5)};Na.prototype.DBj=function(La,Db,uc){this.show(La,Db,15,4,void 0,void 0===uc?0:uc)};Na.prototype.K3f=function(La,Db,uc,Vc,yd,Md){this.show(La,Db,20,(void 0===
uc?0:uc)?2:(void 0===Vc?0:Vc)?1:0,void 0===yd?!1:yd,void 0===Md?0:Md)};Na.prototype.aBj=function(La,Db,uc,Vc,yd){this.show(La,Db,uc+20,3,void 0===Vc?!1:Vc,void 0===yd?0:yd)};Na.prototype.show=function(La,Db,uc,Vc,yd,Md){Vc=void 0===Vc?3:Vc;Md=void 0===Md?0:Md;!La||Vc===this.state&&this.H6h(Db,uc)||(this.JAg(Vc,void 0===yd?!1:yd,Md),this.BYa(La,Vc,Md),this._state=Vc,4===Md||0===Md&&!this.qJ?this.element.style.left=Db+"px":this.element.style.right=Db+"px",this.element.style.top=uc+"px",this.visible=
!0)};Na.prototype.BYa=function(La,Db,uc){this.wje=La;Bd.a.Wpb(this.GG);Vd.a.MYg(this.GG);this.GG.id="fly_"+La.clientId;this.GG.style.backgroundColor=La.color;4!==Db?(this.GG.style.height=this.Ihb+"px",this.GG.style.lineHeight=this.Ihb+"px",Vd.a.LRa(this.GG,"border-radius",this.Ihb+"px")):4===uc||0===uc&&!this.qJ?this.GG.style.left="0px":this.GG.style.right="0px";2!==Db&&(4===Db?Bd.a.Ovc(this.GG,""):1===Db?this.GG.appendChild(this.gog):(this.GG.setAttribute("dir","auto"),uc=tf.a.jSh(La.userName),(!La.isAnonymous||
cc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsCustomAnonymousNameEnabled",!1))&&uc||0!==Db?(La=La.userName,0===Db&&(La=uc,Vd.a.LRa(this.GG,"text-align","center")),Bd.a.Ovc(this.GG,La)):(this.bKc||(this.bKc=this.M4g()),this.GG.appendChild(this.bKc),Vd.a.LRa(this.GG,"text-align","start"))))};Na.prototype.Zc=function(La){if(0===this.state)return this.raiseEvent(Ja.zka,new Ja(1,La)),!0;3===this.state&&Ub.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");
return!1};Na.prototype.YN=function(La){3===this.state&&this.raiseEvent(Ja.zka,new Ja(3,La));return!1};Na.prototype.xw=function(La){3!==La.yb&&this.raiseEvent(Ja.zka,new Ja(2,La));return!1};Na.prototype.onPointerDown=function(La){if(3!==La.yb)return!0;this.raiseEvent(Ja.zka,new Ja(4,La));return!1};Na.prototype.M4g=function(){var La=document.createElement("img");La.src=lf.a.Usa("doughperson_white_glyph.svg");La.setAttribute("Unselectable","on");Ac.a.Yg(La,Ac.a.Td,Ac.a.Rr);return vc.createClusteredImageFromClusterWithImageClass(this.Ihb,
this.Ihb,null,null,Na.EEh,"",!1,"",this.element.ownerDocument,La)};Na.prototype.JAg=function(La,Db,uc){Db=void 0===Db?!1:Db;uc=void 0===uc?0:uc;if(!this.lyb(this.state)||!this.lyb(La))switch(Sys.UI.DomElement.removeCssClass(this.element,this.dGc),this.state){case 4:3===La?this.Tga(Na.Cbd,Na.nVe):this.lyb(La)&&this.Tga(Na.Abd,Na.nVe);break;case 3:4===La?this.Tga(Na.Fbd,Na.mVe):this.lyb(La)&&(Db&&this.JPf(),this.Tga(Na.Abd,Na.mVe,Db?Na.DEh:""));break;case 0:case 1:case 2:4===La?this.Tga(Na.Fbd,Na.Dbd):
3===La&&(Db&&this.iBg(),this.Tga(Na.Cbd,Na.Dbd,Db?Na.oVe:"",3===uc?Na.HEh:Na.FEh));break;default:4===La?this.Tga(Na.Fbd):3===La?this.Tga(Na.Cbd):this.lyb(La)&&this.Tga(Na.Abd)}};Na.prototype.Tga=function(La){for(var Db=[],uc=0;uc<arguments.length;++uc)Db[uc-0]=arguments[uc];this.dGc=Db.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.dGc)};Na.prototype.iBg=function(){var La=this;this.v6d=window.setTimeout(function(){La.element&&(La.Ypa=La.element.cloneNode(!0),La.element.parentNode.appendChild(La.Ypa),
La.element.style.zIndex="2",La.Ypa.style.zIndex="1")},300)};Na.prototype.JPf=function(){var La=this;window.clearTimeout(this.v6d);this.Ypa&&(Sys.UI.DomElement.removeCssClass(this.Ypa,Na.Dbd+" "+Na.oVe),Sys.UI.DomElement.addCssClass(this.Ypa,Na.CEh),ra.Task.delay(300).continueWith(function(){La.element&&La.element.parentNode===La.Ypa.parentNode&&La.element.parentNode.removeChild(La.Ypa)}),Vd.a.XGb(this.element,"z-index"))};Na.prototype.lyb=function(La){return 0===La||1===La||2===La};Na.prototype.H6h=
function(La,Db){var uc=Vd.a.eD(this.element.style.top);return Vd.a.eD(this.element.style.left)===La&&uc===Db};Na.prototype.QKd=function(La){3===La&&Vd.a.f3(this.element,"left")?(La=Vd.a.eD(this.element.style.left),Vd.a.XGb(this.element,"left"),this.element.style.right=-1*La+"px"):4===La&&Vd.a.f3(this.element,"right")&&(La=Vd.a.eD(this.element.style.right),Vd.a.XGb(this.element,"right"),this.element.style.left=-1*La+"px")};Sk.Object.defineProperties(Na.prototype,{user:{configurable:!0,enumerable:!0,
get:function(){return this.wje}},state:{configurable:!0,enumerable:!0,get:function(){return this._state}}});Na.BEh="prModernFlyout UIFont";Na.Fbd="flyoutIdle";Na.Cbd="flyoutExpanded";Na.Abd="flyoutCollapsed";Na.nVe="flyoutFromIdle";Na.mVe="flyoutFromExpanded";Na.Dbd="flyoutFromCollapsed";Na.oVe="flyoutStacked";Na.DEh="flyoutFromStacked";Na.CEh="flyoutFadeOut";Na.EEh="cui-img-cont-float cui-img-20by20";Na.FEh="flyoutLtrDir";Na.HEh="flyoutRtlDir";Object(Oa.a)(Na,"ModernPresenceTooltipFlyoutControl",
jb,[]);Object(Oa.a)(Xa,"FlyoutsPositioningInfo",null,[]);var Wb=b(47);Ha.prototype.XSh=function(La,Db,uc,Vc,yd){var Md=yd.y,qe=yd.height,ac=this.jLh(Vc),Kc=ac+Db,dd=La*uc+2*(La-1);uc=null;1===La||this.CUg(ac,dd,Md,qe)?La=new Xa(0,0,2):(La=this.qbd(Kc,dd,Md,qe),La.offsetTop-=ac);this.BIc?uc=new Xa(0,0,void 0,this.kj?4:3):(Vc=this.iLh(Vc,yd),ac=Math.max(0,yd.x),yd=yd.width,Db=Vc+Db,this.DUg(Vc,ac,yd)?uc=new Xa(0,0,void 0,this.kj?3:4):this.EUg(Db,ac)&&(uc=new Xa(0,0,void 0,this.kj?4:3)),uc||(uc=this.LDh(Vc,
Db,ac,yd)));return new Xa(La.offsetTop,uc.offsetLeft,La.ngg,uc.R9e)};Ha.prototype.jLh=function(La){return Wb.a.hLh(La)};Ha.prototype.iLh=function(La,Db){return this.kj?Db.width-Wb.a.gLh(La):Wb.a.fLh(La)};Ha.prototype.CUg=function(La,Db,uc,Vc){return La+Db<=uc+Vc};Ha.prototype.qbd=function(La,Db,uc,Vc){var yd=1,Md=Math.max(uc,La-Db);Db>La-uc&&(yd=2,Md=Db<Vc?Vc-Db:uc);return new Xa(Md,0,yd)};Ha.prototype.DUg=function(La,Db,uc){return La+150<=Db+uc};Ha.prototype.EUg=function(La,Db){return 150<=La-Db};
Ha.prototype.LDh=function(La,Db,uc,Vc){Vc-Db>=La-uc?La=4:(Db=La,La=3);return new Xa(0,Db,void 0,La)};Object(Oa.a)(Ha,"ModernPresenceTooltipPositioner",null,[]);Pa.prototype.update=function(La,Db){if(3!==La)if(5!==La&&this.bM&&this.bM.length){if(4===La){var uc=this.sqg;var Vc=(this.MXa-uc)/2;this.element.style.height=this.MXa+"px";this.element.style.width=this.MXa+"px";La=Vd.a.eD(this.bM[0].element.style.top);Db=Vd.a.eD(this.qJ?this.bM[0].element.style.right:this.bM[0].element.style.left)}else uc=
this.I3d,Vc=(this.MXa-uc)/2,this.element.style.height=this.MXa+"px",this.element.style.width=this.AMh()+2*Vc+"px",La=Vd.a.eD(this.bM[this.bM.length-1].element.style.top),Db=this.aUg(this.bM[this.bM.length-1].element,uc,Db);Vd.a.LRa(this.element,"border-radius",this.MXa+"px");this.element.style.top=La-Vc-uc+"px";this.qJ?this.element.style.right=Db-Vc+"px":this.element.style.left=Db-Vc+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&
this.element.parentNode.removeChild(this.element)};Pa.prototype.aUg=function(La,Db,uc){return this.qJ&&!uc?Vd.a.eD(La.style.right):this.qJ||uc?this.qJ&&uc?-Vd.a.eD(La.style.left)-Db:-Vd.a.eD(La.style.right)-Db:Vd.a.eD(La.style.left)};Pa.prototype.AMh=function(){return this.bM&&this.bM.length?this.I3d+Math.min(this.bM.length-1,2)*this.Hmg:0};Sk.Object.defineProperties(Pa.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return this._element}}});Object(Oa.a)(Pa,"ModernPresenceTooltipTarget",
null,[]);var wc=b(168),yb=b(309);vm(pa,jb);pa.prototype.eVc=function(La){this.addHandler(Ja.zka,La)};pa.prototype.Fsc=function(La){this.removeHandler(Ja.zka,La)};pa.prototype.dispose=function(){if(this.jef)this.BOc=!0;else{if(this.YJ)for(var La=yl(this.YJ),Db=La.next();!Db.done;Db=La.next())Db=Db.value,Db.Fsc(Object(pb.a)(this,this.y9a,"onInteractivityChanged")),Wd.a.Fa(Db);this.bM=null;this.gA.za(hd.a.pointerDown,this.fqa.element,Object(pb.a)(this,this.v9a,"onHitTarget"));this.gA.za(hd.a.pointerOver,
this.fqa.element,Object(pb.a)(this,this.v9a,"onHitTarget"));this.gA.za(hd.a.pointerOut,this.fqa.element,Object(pb.a)(this,this.v9a,"onHitTarget"));jb.prototype.dispose.call(this)}};pa.prototype.K0=function(){this.ZGa();this.visible=!0};pa.prototype.Rna=function(){this.visible=!0;this.uSe();this.rDa=!0};pa.prototype.hide=function(){this.ZPf();this.g9e();this.fqa.update(this.rBa,this.jXa)};pa.prototype.BYa=function(La){var Db=this.rBa,uc=this.rDa;La.clientId||(La.clientId=(pa.H8d++).toString());if(La.clientId in
this.Pib){var Vc=this.vtb(La.clientId);if(0<=Vc){Vc=this.lA[Vc];if(Vc.color===La.color&&Vc.userName===La.userName)return;this.Vab(La.clientId)}}this.hide();Vc=new Na(this.createElement("div"),this.Ae);Vc.eVc(Object(pb.a)(this,this.y9a,"onInteractivityChanged"));this.Dfa.insertBefore(Vc.element,this.Dfa.firstChild);this.Pib[La.clientId]=Vc;Array.add(this.lA,La);Array.add(this.YJ,Vc);this.Reg(Db,uc);this.visible=!0};pa.prototype.Vab=function(La){if(this.jef)Array.add(this.Rib,La);else{var Db=this.rBa,
uc=this.rDa;this.hide();this.iQf(La);this.Reg(Db,uc)}};pa.prototype.Reg=function(La,Db){0>=this.lA.length?this.hide():3===La&&Db?this.Rna():this.K0()};pa.prototype.YJb=function(La,Db){Db?this.iAg(La):this.qPf(La)};pa.prototype.Cna=function(La){La!==this.CSb&&(this.CSb=La,this.hPd(La))};pa.prototype.position=function(La,Db){this.element.style.top=Db+"px";this.element.style.left=La+"px"};pa.prototype.ZGa=function(La){if(void 0===La||!La||this.U8){this.CSb&&this.hPd(!0);var Db=Math.min(3,this.kja)-1;
La=0;var uc=1,Vc=0;this.jXa&&(La=this.qgb,uc=-1,Vc=-this.tsa);for(var yd=this.kja-1;yd>Db;yd--)this.YJ[yd].K3f(this.lA[yd],-4*Db*uc+Vc,!0,!1,!0,La);for(;0<=Db;Db--)this.YJ[Db].K3f(this.lA[Db],-4*Db*uc+Vc,0<Db,Array.contains(this.afa,this.lA[Db].clientId),Db!==this.qTb,La);this.qTb=0;this.fqa.update(0,this.jXa);this.zIndex=this.Lrb;this.rDa=!1;this.ZPf(0);this.BOc&&this.dispose()}};pa.prototype.uSe=function(){this.CSb&&this.hPd(!1);this.zIndex=this.Lrb+1;var La=this.usj();var Db=La.offsetX;var uc=
La.offsetY;La=La.Q9e;for(var Vc=0;Vc<this.kja;Vc++)this.YJ[Vc].aBj(this.lA[Vc],Db,uc+(this.tsa+2)*Vc,Vc!==this.qTb,La)};pa.prototype.g9e=function(){var La=0,Db=0;this.jXa&&(La=this.qgb,Db=-6);for(var uc=0;uc<this.kja;uc++)this.YJ[uc].hide(this.lA[uc],Db,La);this.zIndex=this.Lrb;this.visible=this.rDa=!1;this.BOc&&this.dispose()};pa.prototype.x1c=function(La){var Db=this;(La=void 0===La?0:La)?(this.U8=!0,ra.Task.delay(La).continueWith(function(){Db.W7d?Db.V7h():Db.ZGa(!0);Db.U8=!1})):this.W7d?this.hide():
this.ZGa()};pa.prototype.V7h=function(){this.U8&&this.hide()};pa.prototype.COg=function(){if(cc.AFrameworkApplication.sa&&cc.AFrameworkApplication.sa.Qa.pz&&wc.c()){var La=appChrome.selectors.getShyState();return La.isActive&&0!==La.state}return!1};pa.prototype.y9a=function(La,Db){var uc=this;La=this.rBa;this.COg()||2!==Db.type&&(4!==Db.type||3===La)?4===Db.type&&3===La?(this.U8&&(this.U8=!1),this.x1c()):3!==Db.type||3!==La||this.rDa||(1<this.kja?(this.U8=!0,ra.Task.delay(250).continueWith(function(){uc.ZGa(!0);
uc.U8=!1})):this.x1c()):(this.U8&&(this.U8=!1),3!==La&&(this.uSe(),3===Db.Wsb.yb&&this.x1c(2E3)));this.raiseEvent(Ja.zka,Db)};pa.prototype.v9a=function(La){3===La.yb?this.y9a(this,new Ja(4,La)):La.eventName===hd.a.pointerOver?this.y9a(this,new Ja(2,La)):La.eventName===hd.a.pointerOut&&this.y9a(this,new Ja(3,La));return!1};pa.prototype.wqj=function(La){this.element.style.width=La+"px";this.element.style.height=this.tsa+"px"};pa.prototype.iQf=function(La){this.qPf(La);La=this.vtb(La);if(!(0>La)){var Db=
this.lA[La];Array.removeAt(this.lA,La);delete this.Pib[Db.clientId];Db=this.YJ[La];this.Dfa.removeChild(Db.element);this.Ae.get(18,!1)&&Db.Fsc(Object(pb.a)(this,this.y9a,"onInteractivityChanged"));Array.removeAt(this.YJ,La);Db.dispose()}};pa.prototype.ZPf=function(La){La=void 0===La?5:La;if(this.Rib.length){this.visible&&this.g9e();for(var Db=0;Db<this.Rib.length;Db++)this.iQf(this.Rib[Db]);Array.clear(this.Rib);0>=this.lA.length||5===La?this.hide():0===La&&this.K0()}};pa.prototype.vtb=function(La){for(var Db=
0;Db<this.lA.length;Db++)if(this.lA[Db].clientId===La)return Db;return-1};pa.prototype.yrf=function(La){if(La in this.Pib){var Db=this.vtb(La);if(Db){var uc=this.lA[Db];La=this.Pib[La];Array.removeAt(this.lA,Db);Array.insert(this.lA,0,uc);Array.removeAt(this.YJ,Db);Array.insert(this.YJ,0,La);this.Dfa.removeChild(La.element);this.Dfa.appendChild(La.element);this.ZGa()}}};pa.prototype.iAg=function(La){if(-1===this.vtb(La))Ub.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");
else{if(Array.contains(this.afa,La)){if(this.lA[0].clientId===La)return;Array.remove(this.afa,La)}Array.add(this.afa,La);this.yrf(La);1!==this.rBa&&this.ZGa()}};pa.prototype.qPf=function(La){-1===this.vtb(La)?Ub.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.afa,La)&&(Array.remove(this.afa,La),this.lA[0].clientId===La&&0<this.afa.length&&this.yrf(this.afa[this.afa.length-1]),this.lA[0].clientId===La&&1===this.rBa&&this.ZGa())};pa.prototype.hPd=
function(La){La?Sys.UI.DomElement.addCssClass(this.Dfa,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.Dfa,"prBackgroundSelection")};pa.prototype.usj=function(){var La;var Db=La=0;var uc=this.qgb;if(this.Rje){var Vc=this.Rje(this);if(!Vc)return{offsetX:La,offsetY:Db,Q9e:uc};var yd=4===this.rBa;uc=this.dug.XSh(this.kja,yd?6:this.tsa,this.tsa,this.element,Vc);Db=uc.offsetTop;this.qTb=this.gSh(uc.ngg,uc.offsetTop);uc=uc.R9e;uc!==this.qgb&&(this.QKd(uc),this.element.dir=3===uc?"rtl":"ltr",
this.qgb=uc);uc!==this.xZe()?(La=this.hug?-2:yd?-6:-this.tsa,this.jXa=!0):this.jXa=!1}return{offsetX:La,offsetY:Db,Q9e:uc}};pa.prototype.gSh=function(La,Db){if(1===La)return this.kja-1;La=Math.abs(Db);return 0<La?La/(this.tsa+2):0};pa.prototype.QKd=function(La){for(var Db=0;Db<this.kja;Db++)this.YJ[Db].QKd(La)};pa.prototype.xZe=function(){return this.kj?3:4};pa.GHh=function(){return String.format("{0}-{1}","presencetooltip",pa.H8d++)};Sk.Object.defineProperties(pa.prototype,{lqc:{configurable:!0,
enumerable:!0,get:function(){return yb.a.clone(this.lA)}},YJ:{configurable:!0,enumerable:!0,get:function(){return this.bM}},Lrb:{configurable:!0,enumerable:!0,get:function(){return this.Lng}},kja:{configurable:!0,enumerable:!0,get:function(){return this.YJ?this.YJ.length:0}},rBa:{configurable:!0,enumerable:!0,get:function(){return 0<this.kja?this.YJ[0].state:5}},jef:{configurable:!0,enumerable:!0,get:function(){return 3===this.rBa&&!this.rDa}}});pa.H8d=0;Object(Oa.a)(pa,"ModernPresenceTooltipControl",
jb,[711,3]);var mc=b(275),Wc=b(349),Nd=b(169);qa.prototype.v5g=function(){var La=document.createElement("div");this.Ae.zYa(15,!1);return new pa(La,20,this.Ae)};Object(Oa.a)(qa,"ModernPresenceTooltipFactory",null,[720]);var Tc=b(16),Yc=b(58),oc=b(185),ze=b(11),Ae=b(32),Ve=b(342),nb;(function(La){La[La.none=0]="none";La[La.master=1]="master";La[La.fixed=2]="fixed";La[La.horizontal=3]="horizontal";La[La.vertical=4]="vertical";La[La.first=1]="first";La[La.last=4]="last"})(nb||(nb={}));Object(Oa.b)("PaneType",
nb);var Hc=Hb.a;vm(ja,Hc);ja.prototype.eVc=function(La){this.addHandler("interactivityChanged",La)};ja.prototype.Fsc=function(La){this.removeHandler("interactivityChanged",La)};ja.prototype.dispose=function(){if(0<this.Go.count){this.hide();var La=this.Go.Yu,Db;for(Db in La)La[Db].dispose()}this.gridView=null;this.Go.clear();Hc.prototype.dispose.call(this)};ja.prototype.ntj=function(La){this.yIf=La};ja.prototype.K0=function(){var La=this.Go.Yu,Db;for(Db in La)La[Db].K0()};ja.prototype.Rna=function(){this.nkd();
var La=this.Go.Yu,Db;for(Db in La)La[Db].Rna()};ja.prototype.hide=function(){this.ATa();var La=this.Go.Yu,Db;for(Db in La)La[Db].hide()};ja.prototype.BYa=function(La){var Db=this.Go.Yu,uc;for(uc in Db)Db[uc].BYa(La)};ja.prototype.Vab=function(La){var Db=this.Go.Yu,uc;for(uc in Db)Db[uc].Vab(La)};ja.prototype.YJb=function(La,Db){var uc=this.Go.Yu,Vc;for(Vc in uc)uc[Vc].YJb(La,Db)};ja.prototype.Cna=function(La){this.ipd!==La&&(this.ipd=La,La=Ae.a.Gc(this.Go.Yu,Enum.toString(nb,ja.JKa()[0])),this.eza&&
La&&(La=ze.DOMElementExtensions.getWidth(La.element)/2,this.position(this.ipd?this.eza.x+14+La:this.eza.x-14-La,this.eza.y)))};ja.prototype.position=function(La,Db){var uc=this.Go.Yu,Vc;for(Vc in uc){var yd=uc[Vc],Md=Enum.parse(nb,Vc);Md=this.gridView.Sf(Md);var qe=ea(Md,new Sys.UI.Point(La,Db),!1);this.eza=new Sys.UI.Point(La,Db);0>qe.x&&(qe.x+=Md.domElement.scrollLeft);ze.DOMElementExtensions.updatePosition(yd.element,qe.x,qe.y,!1,this.rtl)}};ja.prototype.nkd=function(){this.eza&&(this.position(this.eza.x,
this.eza.y),this.PMd||(this.PMd=!0,this.gridView.Ca.KG(this.xz),this.gridView.Ca.sq(this.xz),this.gridView.view.Ms(this.DF)))};ja.prototype.ATa=function(){this.PMd&&(this.gridView.Ca.oI(this.xz),this.gridView.Ca.pp(this.xz),this.gridView.view.Nq(this.DF))};ja.JKa=function(){return ja.YFa||(ja.YFa=[1,3,2,4])};Sk.Object.defineProperties(ja.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return null}},lqc:{configurable:!0,enumerable:!0,get:function(){var La=Ae.a.Gc(this.Go.Yu,Enum.toString(nb,
ja.JKa()[0]));return La?La.lqc:null}},a0i:{configurable:!0,enumerable:!0,get:function(){return this.yIf}}});ja.YFa=null;Object(Oa.a)(ja,"PaneInvariantTooltip",Hb.a,[711,3]);ca.FKb=!1;ca.Ona=!1;Object(Oa.a)(ca,"PresenceViewSettings",null,[]);X.prototype.dispose=function(){this.ATa();this.clearCache();this.$&&this.$.xa&&this.$.xa.ug(this.w6);this.gridView=null};X.prototype.ATa=function(){this.Jhc&&(this.gridView.Ca.oI(this.xz),this.gridView.Ca.pp(this.xz),this.gridView.view.Nq(this.DF),this.Jhc=!1)};
X.prototype.RPj=function(La){var Db=this.uz[La],uc=this.Uja(La);Db&&this.IPf(Db);uc&&this.osc(uc,Db.iza.clientId,Db.CB);delete this.XTa[La];delete this.uz[La];delete this.WTa[La]};X.prototype.QYd=function(La){var Db=La.CB;this.uz[Db]||(this.e5a(La),this.uz[Db]=La)};X.prototype.VUj=function(La){var Db=La.CB,uc=this.s2e(La.kqc,La.paneType,La.range),Vc=this.Uja(Db);uc&&uc!==Vc&&(La.LLb(uc),this.XTa[Db]=uc,this.uz[Db]=La,this.WTa[Db]&&uc.Cna(this.WTa[Db]));Vc!==uc&&Vc&&this.osc(Vc,La.iza.clientId,La.CB);
!this.Jhc&&this.gridView&&(this.gridView.Ca.KG(this.xz),this.gridView.Ca.sq(this.xz),this.gridView.view.Ms(this.DF),this.Jhc=!0)};X.prototype.osc=function(La,Db,uc){La.Vab(Db);jc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")&&this.Uja(uc)===La&&delete this.XTa[uc];La.lqc&&La.lqc.length||((Db=La.a0i)&&delete this.DFb[Db],jc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")||this.Uja(uc)===La&&delete this.XTa[uc],La.dispose())};X.prototype.IPf=function(La){La&&
(La.pJd(this.ADb),La.QJd(this.iEb),La.PJd(this.hEb),La.LLb(null))};X.prototype.e5a=function(La){La.dVc(this.ADb);La.FVc(this.iEb);La.EVc(this.hEb)};X.prototype.lX=function(La,Db){if(ca.Ona){Db.Hua||this.QYd(Db);this.VUj(Db);var uc=this.Uja(Db.CB);uc&&(uc.BYa(Db.iza),Db.uMa()?La?uc.Rna():uc.K0():uc.hide())}};X.prototype.Uja=function(La){return this.XTa[La]};X.prototype.s2e=function(La,Db,uc){if(!La)return null;La=this.sfd(La,Db);var Vc=this.gridView.Sf(Db).Iq;Db=X.$Vh(La,Db,Vc).toString();Vc=Ae.a.Gc(this.DFb,
Db);Vc||(Vc=new ja(this.gridView,this.CEd,uc),Vc.position(La.x,La.y),Vc.ntj(Db),this.DFb[Db]=Vc);return Vc};X.prototype.sfd=function(La,Db){var uc=this.gridView.Sf(Db).pn,Vc=this.gridView.Sf(Db).Iq;Db=Ve.a.ZM(Db,uc.topLeft);var yd=Math.max(Vc.x,La.x-this.jwa/2-2);yd=Math.min(Math.max(Db.x+Vc.x,yd),Db.x+Vc.x+uc.width-this.jwa);La=Math.max(Vc.y,La.y-this.jwa/2+1);jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5703071_toolTipOnRightForFirstRow")&&Db.y+Vc.y>La&&(yd=Math.min(yd+this.jwa/4,Db.x+Vc.x+uc.width-
this.jwa));La=Math.min(Math.max(Db.y+Vc.y,La),Db.y+Vc.y+uc.height-this.jwa);return new Sys.UI.Point(yd,La)};X.prototype.clearCache=function(){var La=this.uz,Db;for(Db in La)this.IPf(La[Db]);La=this.DFb;for(var uc in La)La[uc].dispose();this.XTa={};this.uz={};this.DFb={};this.WTa={};Wd.a.Fa(this.Joa);this.Joa=null};X.prototype.Yqb=function(){var La=new hc;La.add(0,Tc.a.Z9c);La.add(1,this.x$e);La.add(12,49);La.add(6,this.jwa);this.gridView&&(La.add(4,Yb.a.Ee(3)),La.add(5,Yb.a.Ee(3)),La.add(8,this.gridView.rtl));
La.add(18,!0);this.CEd=new qa(La);La.add(16,this.d1h)};X.prototype.UTj=function(La){var Db=new hc;Db.add(0,Tc.a.Z9c);Db.add(1,this.x$e);Db.add(12,Number.parseInvariant(La.toString()));Db.add(6,this.jwa);this.gridView&&(Db.add(4,Yb.a.Ee(3)),Db.add(5,Yb.a.Ee(3)),Db.add(8,this.gridView.rtl));this.CEd=new qa(Db)};X.prototype.ZUj=function(La){this.UTj(La)};X.prototype.Seg=function(){ca.Ona&&(this.Joa=oc.AsyncMethodContext.Zy(this.SUj,100,Zd.a.q1i,this.Joa))};X.prototype.J7e=function(La,Db){ca.Ona&&(this.WTa[Db.CB]&&
La.Cna(this.WTa[Db.CB]),Db.uMa()?Db.Pna(!0,!0):Db.Pna(!1,!0))};X.prototype.Cna=function(La,Db){this.WTa[La]=Db;(La=this.Uja(La))&&La.Cna(Db)};X.prototype.YJb=function(La,Db){var uc=this.Uja(La);uc&&uc.YJb(La,Db)};X.$Vh=function(La,Db,uc){return La.x.toString()+"-"+La.y.toString()+"-"+Db.toString()+"-"+uc.x.toString()+"-"+uc.y.toString()};Object(Oa.a)(X,"PresenceTooltipManager",null,[3]);var Cc=b(102),Sc=b(118),Uc=Hb.a;vm(fa,Uc);fa.prototype.dVc=function(La){this.addHandler("hidePresenceTooltip",La)};
fa.prototype.pJd=function(La){this.removeHandler("hidePresenceTooltip",La)};fa.prototype.FVc=function(La){this.addHandler("showPresenceTooltip",La)};fa.prototype.QJd=function(La){this.removeHandler("showPresenceTooltip",La)};fa.prototype.EVc=function(La){this.addHandler("showFullPresenceTooltip",La)};fa.prototype.PJd=function(La){this.removeHandler("showFullPresenceTooltip",La)};fa.prototype.HFa=function(La){this.addHandler("presenceChanged",La)};fa.prototype.Nza=function(La){this.removeHandler("presenceChanged",
La)};fa.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");this.raiseEvent("presenceChanged");this.zze();this.ATa();Wd.a.Fa(this.pob);this.Xie=this.domElement=this.gridView=null;Uc.prototype.dispose.call(this)};fa.prototype.ySd=function(La,Db){var uc=!!La&&!qd.D(La).equals(qd.D(this.Yw)),Vc=!!Db&&(!this.fi||this.fi.get_id()!==Db.get_id());if(uc||Vc)this.raiseEvent("presenceChanged"),this.zze(),this.Hua=!1,this.Yw=La,this.fi=Db,this.GAb=null};fa.prototype.V4=function(La){this.visible=
this.Hua=!1;La&&this.raiseEvent("hidePresenceTooltip")};fa.prototype.Wga=function(La){Array.add(this.Qx,La);this.N9e();La.HFa(this.MAd)};fa.prototype.Pna=function(La,Db){La?(this.visible=!0,Db&&(this.pob=oc.AsyncMethodContext.Zy(this.fDj,this.$.ya.ShowTooltipDelayInMs,Zd.a.qMj,this.pob))):this.V4(Db)};fa.prototype.LLb=function(La){this.Xie=La};fa.prototype.Qeb=function(){if(this.domElement&&this.visible){this.j_a=ze.DOMElementExtensions.getBoundingClientRect(this.domElement);var La=Math.floor(this.j_a.x);
this.j_a.x=La===this.j_a.x?La:La+1;this.j_a.y=Math.floor(this.j_a.y)}};fa.prototype.uMa=function(){if(!this.Yw)return!1;if(jc.EwaSettings.la(710)){var La=this.gWh();return La?this.gridView.ami(La,this.paneType):!1}La=this.gridView.Sf(this.paneType).pn;var Db=this.gridView.pg(this.range,this.paneType);return La.Qd(Db)};fa.prototype.gWh=function(){if(this.range.isSingle){var La=this.gridView.Ca.qva(this.range,this.$.activeItemName);return La?(La=La.Vs(this.range))?La.WE:null:null}return this.range};
fa.prototype.zze=function(){for(var La=0,Db=this.Qx.length;La<Db;La++)this.Qx[La].Nza(this.MAd);Array.clear(this.Qx);this.ATa()};fa.prototype.N9e=function(){!this.Ihc&&1<=this.Qx.length&&(this.Ihc=!0,this.gridView.Ca.KG(this.xz),this.gridView.Ca.sq(this.xz),this.gridView.view.Ms(this.DF))};fa.prototype.ATa=function(){this.Ihc&&!this.Qx.length&&(this.Ihc=!1,this.gridView&&(this.gridView.Ca.oI(this.xz),this.gridView.Ca.pp(this.xz),this.gridView.view.Nq(this.DF)))};fa.prototype.Vab=function(La){La.Nza(this.MAd);
Array.remove(this.Qx,La);this.ATa()};fa.prototype.Ycg=function(){this.Qeb();for(var La=0,Db=this.Qx.length;La<Db;La++)this.Qx[La].Qeb()};Sk.Object.defineProperties(fa.prototype,{CB:{configurable:!0,enumerable:!0,get:function(){return this.xSc}},iza:{configurable:!0,enumerable:!0,get:function(){return this.POc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.Rqa}},kqc:{configurable:!0,enumerable:!0,get:function(){if(!this.domElement)return null;var La=this.gridView.Sf(this.paneType).pn,
Db=this.gridView.rtl,uc=this.domElement.offsetWidth;if(!this.fi&&4>=uc){if(this.Yw){uc=this.gridView.Kh;var Vc=this.Yw.FirstRow;Db=Db?this.Yw.FirstColumn:this.Yw.LastColumn;if(uc&&!(Vc>=uc.top&&Vc<=uc.bottom&&Db>=uc.left&&Db<=uc.right))return Vc=Vc<=uc.top?La.y:La.y+(Vc>=uc.bottom?La.height:La.height/2),Db=Db<=uc.left?La.x:La.x+(Db>=uc.right?La.width:La.width/2),this.GAb=new Sys.UI.Point(Db,Vc)}return this.GAb}if(this.fi){La=this.domElement.offsetTop-2;Vc=parseInt(this.domElement.style.left,10);var yd=
0;Db&&(yd=parseInt(this.domElement.parentNode.style.width,10)-uc-Vc,yd-=this.gridView.tO.oxa&&this.gridView.tO.Erd?Sc.a.gq:0);return this.GAb=new Sys.UI.Point((Db?yd:Vc)+uc+4,La)}return this.GAb=new Sys.UI.Point(parseInt(Db?this.domElement.style.right:this.domElement.style.left,10)+uc,this.domElement.offsetTop)}},range:{configurable:!0,enumerable:!0,get:function(){return qd.D(this.Yw)}}});Object(Oa.a)(fa,"TooltipNotificationUnit",Hb.a,[715,3]);var ae=Hb.a;vm(da,ae);da.prototype.dVc=function(La){this.addHandler("hidePresenceTooltip",
La)};da.prototype.pJd=function(La){this.removeHandler("hidePresenceTooltip",La)};da.prototype.FVc=function(La){this.addHandler("showPresenceTooltip",La)};da.prototype.QJd=function(La){this.removeHandler("showPresenceTooltip",La)};da.prototype.EVc=function(La){this.addHandler("showFullPresenceTooltip",La)};da.prototype.PJd=function(La){this.removeHandler("showFullPresenceTooltip",La)};da.prototype.HFa=function(La){this.addHandler("presenceChanged",La)};da.prototype.Nza=function(La){this.removeHandler("presenceChanged",
La)};da.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");this.raiseEvent("presenceChanged");this.jy&&this.jy.RPj(this.CB);var La=this.uz,Db;for(Db in La){var uc=La[Db];uc.pJd(this.ADb);uc.QJd(this.iEb);uc.PJd(this.hEb);uc.Nza(this.YDb);uc.dispose()}this.jy=this.jd=this.highlight=this.gridView=this.uz=null;ae.prototype.dispose.call(this)};da.prototype.o5f=function(La,Db,uc){uc=void 0===uc?null:uc;La?(this.jd=qd.D(La),this.Rqa=this.gridView.$a.oj(this.jd.topRight)):uc?(this.fi=uc,
this.Rqa=uc.Eg.paneType):this.Rqa=1;this.Tke=Db;this.wva(this.paneType);this.ySd(La,uc)};da.prototype.ySd=function(La,Db){var uc=this.uz,Vc;for(Vc in uc)uc[Vc].ySd(La,Db)};da.prototype.V4=function(La){this.wva(this.paneType).V4(La);La=this.uz;for(var Db in La)La[Db].V4(!1)};da.prototype.Cme=function(La){var Db=this.uz,uc;for(uc in Db){var Vc=Db[uc];Vc.Wga(La.wva(Vc.paneType))}};da.prototype.Wga=function(La){this.wva(La.paneType).Wga(La)};da.prototype.uMa=function(){var La=this.wva(this.paneType).uMa(),
Db=this.uz,uc;for(uc in Db)La=Db[uc].uMa()||La;return La};da.prototype.Pna=function(La,Db){this.jy.QYd(this);this.wva(this.paneType).Pna(La,Db);Db=this.uz;for(var uc in Db)Db[uc].Pna(La,!1)};da.prototype.LLb=function(La){var Db=this.uz,uc;for(uc in Db)Db[uc].LLb(La)};da.prototype.Qeb=function(){var La=this.uz,Db;for(Db in La)La[Db].Qeb();this.jy.QYd(this)};da.prototype.wva=function(La){return this.kVh(La,this.Tke)};da.prototype.kVh=function(La,Db){var uc=this.highlight?this.highlight.ZE(Db,La).Cg:
this.fi?this.fi.get_element():null;Db=da.v0h(Db,La);var Vc=Ae.a.Gc(this.uz,Db);Vc||(Vc=new fa(uc,this.gridView,this.iza,La,this.$),this.uz[Db]=Vc,Vc.dVc(this.ADb),Vc.FVc(this.iEb),Vc.EVc(this.hEb),Vc.HFa(this.YDb));return Vc};da.v0h=function(La,Db){return La.toString()+Db.toString()};Sk.Object.defineProperties(da.prototype,{CB:{configurable:!0,enumerable:!0,get:function(){return this.xSc}},iza:{configurable:!0,enumerable:!0,get:function(){return this.POc}},paneType:{configurable:!0,enumerable:!0,
get:function(){return this.Rqa}},range:{configurable:!0,enumerable:!0,get:function(){return this.jd}},kqc:{configurable:!0,enumerable:!0,get:function(){return this.jd||this.fi?ea(this.gridView.Sf(this.paneType),this.wva(this.paneType).kqc,!0):null}},Hua:{configurable:!0,enumerable:!0,get:function(){return this.wva(this.paneType).Hua},set:function(La){var Db=this.uz,uc;for(uc in Db)Db[uc].Hua=La}}});Object(Oa.a)(da,"PaneInvariantTooltipNotificationUnit",Hb.a,[715,3]);K.prototype.dispose=function(){this.bxb();
Wd.a.Fa(this.dv);this.objectId=this.$=this.Ao=this.fi=null};K.prototype.Wga=function(La){this.dv.Cme(La.dv)};K.prototype.bxb=function(){this.fi&&this.Ao&&this.Ao.User&&(this.fi.jBc(!1,this.Ao.User.UserID,null),this.dv.V4(!0))};K.prototype.$Kb=function(){ca.FKb&&this.fi&&this.Ao&&this.Ao.User&&(this.fi.jBc(!0,this.Ao.User.UserID,this.Ao.UserColor),this.dv.Qeb())};K.prototype.lX=function(La){ca.Ona&&(this.dv.Hua=La,this.dv.Pna(La,!0))};K.prototype.hLb=function(La,Db){this.dv.o5f(null,0===Db?46:47,La)};
Sk.Object.defineProperties(K.prototype,{fi:{configurable:!0,enumerable:!0,get:function(){return this.pDa},set:function(La){this.pDa=La;!this.pDa||jc.EwaSettings.isChangeGateEnabled("OfficeVSO:6032771_PresenceToolTipZIndexCheck")&&!this.pDa.xy||this.jy.ZUj(this.pDa.xy)}}});Object(Oa.a)(K,"FloatingObjectPresenceHighlight",null,[710,3]);var ue=b(669),Lf=b(68),xf=b(9),Rf=b(246),dc=b(186),Oc=ue.a;vm(S,Oc);S.prototype.dispose=function(){var La;Wd.a.Fa(this.dv);Oc.prototype.dispose.call(this);var Db=S.q0a,
uc;for(uc in Db){var Vc=uc,yd=Db[uc];yd&&!yd.children.length&&(ze.DOMElementExtensions.Tf(yd),S.q0a[Vc]=null)}null===(La=S.excelLiveManager)||void 0===La?void 0:La.HJd(this.ZDb);this.gN=null};S.prototype.Wga=function(La){this.dv.Cme(La.dv)};S.prototype.lX=function(La){ca.Ona&&(this.Mgc||(this.dv.Hua=La,this.dv.Pna(La,!0)),this.cLb=La&&this.Mgc)};S.prototype.hLb=function(La,Db){this.dv.o5f(La,0===Db?46:47);this.cLb=!1};S.prototype.$Kb=function(La){ca.FKb&&(this.dv.Pna(!0,!0),this.p1d=La,this.ys([La]))};
S.prototype.bxb=function(La){this.V4();this.ll(La)};S.prototype.uFe=function(La,Db,uc){uc.className=Lf.a.Fwh;uc.style.borderColor=this.Ao.UserColor;var Vc=document.createElement("div");46!==La&&47!==La&&(Vc.style.backgroundColor=this.Ao.UserColor);uc.appendChild(Vc);Vc.className=[Lf.a.Hwh,Lf.a.Gwh][La-46];La=Ae.a.Gc(S.q0a,Db.toString());if(!La){var yd=this.gridView.Sf(Db).domElement;La=document.createElement("div");yd.insertBefore(La,yd.firstChild);S.q0a[Db.toString()]=La}La.appendChild(uc);dc.f(this.$)&&
this.f9h(Vc)};S.prototype.Ywb=function(){};S.prototype.p_f=function(La,Db,uc,Vc){var yd=this.kIg(Vc,La,Db);Rf.c(uc,this.gridView.rtl,xf.HelperMethods.Qb(yd.x));uc.width=xf.HelperMethods.Qb(yd.width);uc.top=xf.HelperMethods.Qb(yd.y);uc.height=xf.HelperMethods.Qb(yd.height);Db=Db.Cg;uc=Db.parentNode;47===La?S.ZGd(uc,Db,!1):46===La&&(yd=this.ZE(47),Vc.equals(yd.Lic)?S.ZGd(uc,Db,!1):S.ZGd(uc,Db,!0));this.j0i(La)};S.prototype.W2f=function(){return!1};S.prototype.kIg=function(La,Db,uc){var Vc=La.y+this.evb(uc,
!1);uc=La.x+this.evb(uc,!0)+Sc.a.cdd(uc.Cg.parentNode.parentNode,this.gridView.rtl);var yd=La.width;La=La.height+1;1>uc&&-1<=uc&&46===Db&&(yd-=1-uc,uc=1);1>Vc&&-1<=Vc&&46===Db&&(La-=1-Vc,Vc=1);yd=Math.max(0,yd-1);La=Math.max(0,La-2);return new Yc.a(uc,Vc,yd,La)};S.prototype.j0i=function(La){this.dv.Qeb();this.p1d=La;this.Mgc=!1;this.cLb&&this.lX(!0);this.cLb=!1};S.prototype.V4=function(){this.Mgc||(this.dv.V4(!0),this.cLb=!1)};S.ZGd=function(La,Db,uc){uc?Db!==La.firstChild&&(La.removeChild(Db),La.insertBefore(Db,
La.firstChild)):Db!==La.lastChild&&(La.removeChild(Db),La.appendChild(Db))};S.prototype.f9h=function(La){var Db;(null===(Db=S.excelLiveManager)||void 0===Db?0:Db.pPa.bL)?this.g9h(La):Array.add(this.gN,La)};S.prototype.g9h=function(La){this.Ao.User.UserID===S.excelLiveManager.pPa.bL&&(La.style.backgroundColor=this.Ao.UserColor,La.style.opacity="0.1")};S.prototype.dti=function(){var La=this;S.excelLiveManager?S.excelLiveManager.dZb(this.ZDb):this.$.da.Za(473,function(Db){S.excelLiveManager=Db;S.excelLiveManager.dZb(La.ZDb)})};
S.q0a=null;Object(Oa.a)(S,"PresenceHighlight",ue.a,[]);vm(H,ma);H.prototype.zxc=function(){for(var La=1===this.xc.PresenceType?47:46,Db=0;Db<this.iy.length;Db++)this.iy[Db].$Kb(La);for(La=0;La<this.iH.count;La++)this.iH.fg(La).$Kb()};H.prototype.Adc=function(){for(var La=1===this.xc.PresenceType?47:46,Db=0;Db<this.iy.length;Db++)this.iy[Db].bxb([La]);for(La=0;La<this.iH.count;La++)this.iH.fg(La).bxb()};H.prototype.dispose=function(){this.$&&(this.$.xa&&this.$.xa.ug(this.w6),of.g(this.$).kO(this.ht));
this.jJe();Wd.a.rc(this.iy);Wd.a.rc([this.Oz]);this.Oz=this.$=null;this.FPd(null);this.iH=null;ma.prototype.dispose.call(this)};H.prototype.jJe=function(){if(this.iH){for(var La=0;La<this.iH.count;La++)this.iH.fg(La).dispose();this.iH.clear()}};H.prototype.L_a=function(La){1===this.xc.Version?this.jXg(La):this.kXg(La)};H.prototype.jXg=function(La){if(La.xc.SelectedRange&&this.xc.SelectedRange)for(var Db=this.xc.SelectedRange.length,uc=La.xc.SelectedRange.length,Vc=0;Vc<Db;Vc++)for(var yd=0;yd<uc;yd++)if(Dc(this.xc.SelectedRange[Vc],
La.xc.SelectedRange[yd])){this.iy[Vc].Wga(La.e4a(yd));return}};H.prototype.kXg=function(La){var Db,uc=0,Vc=0;if(this.xc&&this.xc.Object&&(null===(Db=La.xc)||void 0===Db?0:Db.Object)){Db=this.xc.Object.length;for(var yd=La.xc.Object.length,Md=0;Md<Db;Md++)if(this.xc.Object[Md]&&this.ahd(this.xc.Object[Md])){uc++;for(var qe=0;qe<yd;qe++)if(La.xc.Object[qe]&&this.ahd(La.xc.Object[qe])&&(Vc++,this.TWc(this.xc.Object[Md],La.xc.Object[qe]))){var ac=this.e4a(uc),Kc=La.e4a(Vc);if(ac&&Kc){ac.Wga(Kc);return}}}else if(this.xc.Object[Md]&&
La.xc.Object[Md]&&(0===this.xc.Object[Md].ObjectType||2===this.xc.Object[Md].ObjectType))for(qe=0;qe<yd;qe++)if(La.xc.Object[qe]&&(0===La.xc.Object[Md].ObjectType||2===La.xc.Object[Md].ObjectType)&&this.xc.Object[Md].ObjectId===La.xc.Object[qe].ObjectId&&(ac=this.Sed(this.xc.Object[Md].ObjectId),Kc=La.Sed(this.xc.Object[Md].ObjectId),ac&&Kc)){ac.Wga(Kc);return}}if(La.xc.SelectedRange&&this.xc.SelectedRange)for(Db=this.xc.SelectedRange.length,yd=La.xc.SelectedRange.length,Md=0;Md<Db;Md++)for(qe=0;qe<
yd;qe++)if(Dc(this.xc.SelectedRange[Md],La.xc.SelectedRange[qe])&&(ac=this.e4a(uc+Md),Kc=La.e4a(Vc+qe),ac&&Kc)){ac.Wga(Kc);return}};H.prototype.TWc=function(La,Db){return!!La&&!!Db&&Db.ObjectType===La.ObjectType&&(1===La.ObjectType||3===La.ObjectType)&&!La.ObjectId.localeCompare(Db.ObjectId)};H.prototype.e4a=function(La){return 0<=La&&this.iy.length>La?this.iy[La]:null};H.prototype.g5f=function(La){for(var Db=0,uc=this.iy.length;Db<uc;Db++)this.iy[Db].lX(La)};H.prototype.Sed=function(La){return La&&
this.iH.xb(La)?this.iH.getItem(La):null};H.prototype.h5f=function(La,Db){Db=void 0===Db?null:Db;if(La)(La=this.iH.getItem(Db))&&La.lX(!0);else for(La=0;La<this.iH.count;La++)(Db=this.iH.fg(La))&&Db.lX(!1)};H.prototype.jeg=function(La){ma.NTj(this,La)};H.prototype.q4c=function(La,Db){if(La<Db)return this.iy[La];if(!this.Ao||!this.$||!this.jy)return null;La=new S(this.Ao,this.$,this.jy);Array.add(this.iy,La);return La};H.prototype.Urj=function(){for(var La=this.iy.length,Db=this.xc.SelectedRange?this.xc.SelectedRange.length:
0,uc=this.$.xa.pa,Vc=0;Vc<Db;Vc++){var yd=this.q4c(Vc,La);yd&&this.xc.SelectedRange[Vc]&&(this.xc.SelectedRange[Vc].NamedObjectName?yd.ll([47,46]):(yd.hLb(this.xc.SelectedRange[Vc],this.xc.PresenceType),H.yYd(this.xc.PresenceType,yd,this.xc.SelectedRange[Vc],uc,this.Ao,this.jy)))}for(Db=this.Oz&&this.Oz.aFd&&this.Oz.aFd.PresenceType!==this.Oz.xc.PresenceType?0:Db;Db<La;Db++)this.iy[Db].ll([1===this.Oz.aFd.PresenceType?47:46])};H.prototype.ahd=function(La){return(null===La||void 0===La?0:La.ObjectId)&&
(1===this.i1e(La.ObjectType)||2===this.i1e(La.ObjectType))&&(La=this.$.zb.Rfd(La.ObjectId))?qd.w(La):null};H.prototype.Vrj=function(){for(var La=this.iy.length,Db=this.$.xa.pa,uc=this.xc.SelectedRange?this.xc.SelectedRange.length:0,Vc=this.xc.Object?this.xc.Object.length:0,yd=0;yd<La;yd++)this.iy[yd].ll([47,46]);this.rYg();for(var Md=this.n3c=this.m3c=yd=0;Md<Vc;Md++){var qe=this.xc.Object[Md],ac=this.ahd(qe);if(ac){var Kc=this.q4c(yd,La);1===qe.ObjectType?this.m3c++:3===qe.ObjectType&&this.n3c++;
yd++;Kc.hLb(ac,qe.ObjectPresenceType);H.yYd(qe.ObjectPresenceType,Kc,ac,Db,this.Ao,this.jy)}}for(Vc=0;Vc<uc;Vc++)this.xc&&this.xc.SelectedRange&&(Md=this.xc.SelectedRange[Vc],Md.NamedObjectName||(qe=!!Db&&Md.SheetName===Db.name,ac=!!Mb(Md,this.$,1),qe&&ac||(qe=this.q4c(yd+Vc,La),qe.hLb(Md,this.xc.PresenceType),H.yYd(this.xc.PresenceType,qe,Md,Db,this.Ao,this.jy))));0<(this.countFloatingObjects=this.LYf())&&Ub.ULS.sendTraceTag(537154370,0,50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')};
H.prototype.rYg=function(){this.LYf();this.jJe()};H.prototype.LYf=function(){var La=0;if(this.xc&&this.xc.Object)for(var Db=0;Db<this.xc.Object.length;Db++)this.vSj(this.xc.Object[Db])&&La++;return La};H.prototype.w8g=function(La,Db){if(this.iH.xb(Db))return Db=this.iH.getItem(Db),Db.fi=La,Db;if(!this.Ao||!this.$||!this.jy)return null;var uc=new K(this.Ao,this.$,this.jy);uc.fi=La;this.iH.add(Db,uc);return uc};H.prototype.vSj=function(La){var Db=!1;if((null===La||void 0===La?0:La.ObjectId)&&(0===La.ObjectType||
2===La.ObjectType))try{var uc=this.zQh(La);if(uc){var Vc=this.w8g(uc,La.ObjectId);Vc.hLb(uc,La.ObjectPresenceType);Vc.$Kb();Db=!0}}catch(yd){throw Ub.ULS.sendTraceTag(537154369,0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',yd.stack),yd;}return Db};H.prototype.zQh=function(La){if(!La)return null;var Db=null;2===La.ObjectType?Db=Cc.a(this.$).cvb(La.ObjectId):0===La.ObjectType&&(La=this.$.zb.Rfd(La.ObjectId),null===La||void 0===La?0:La.nka)&&(Db=Cc.a(this.$).lSh(La.nka));return Db};
H.prototype.IOd=function(){try{1===this.xc.Version?(this.Urj(),Ub.ULS.sendTraceTag(537154368,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.Vrj(),Ub.ULS.sendTraceTag(537154339,0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',this.countFloatingObjects,this.m3c,this.n3c))}catch(La){throw Ub.ULS.sendTraceTag(537154338,0,10,'{{"SetGridHighlight Exception":"{0}"}',La.stack),La;}};H.prototype.i1e=function(La){switch(La){case 0:return 0;case 1:return 1;case 3:return 2;case 2:return 9;
default:return-1}};H.yYd=function(La,Db,uc,Vc,yd,Md){var qe=1===La?47:46;Vc&&uc&&Vc.name===uc.SheetName?(Db.Nl(qd.D(uc),[qe]),Db.$Kb(qe),Ub.ULS.shipAssertTag(537154337,0,Db.dv.CB===yd.User.UserID,"UserID and UnitID should match"),Md.YJb(Db.dv.CB,1===La)):Db.bxb([qe])};Sk.Object.defineProperties(H.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return this.Oz.xc},set:function(La){this.Oz.xc=La;this.IOd()}}});Object(Oa.a)(H,"UserGridPresence",ma,[]);var Ed=b(46),Gd=b(925),Ee=Hb.a;vm(T,Ee);
T.prototype.HFa=function(La){this.addHandler("pcek",La)};T.prototype.Nza=function(La){this.removeHandler("pcek",La)};T.prototype.jQf=function(La){this.KBa[La]&&this.aQf(La,!1)};T.prototype.sTd=function(La){this.wrb&&this.wrb!==La.clientId&&(this.BQd=!1);!jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5657706_CorrectPresenceBootTelemetry")||this.$.ea.X4a&&Ed.PageLoadTrackingInfo.instance.Cpj||(this.BQd=!1);this.tL.C1g(La);this.wrb=La.clientId};T.prototype.sSh=function(La,Db){var uc=[];var Vc=[];var yd=
this.KBa,Md;for(Md in yd){var qe=yd[Md];if(Db){var ac=qd.k(La,this.$);this.Q4e(ac,uc,Vc,qe)}else this.P4e(La,uc,Vc,qe)}return{Gdi:uc,tjh:Vc}};T.prototype.bIe=function(La,Db,uc,Vc,yd){(yd=this.KBa[yd])&&(Db?this.Q4e(La,uc,Vc,yd):this.P4e(La,uc,Vc,yd))};T.prototype.m1h=function(){var La=[],Db=this.KBa,uc;for(uc in Db){var Vc=Db[uc],yd=Vc.xc.SelectedRange;if(void 0!==yd&&null!==yd&&jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5280212_Guard_PresenceState.SelectedRange")){yd=yl(yd);for(var Md=yd.next();!Md.done;Md=
yd.next()){Md=Md.value;var qe=qd.D(Md),ac=of.g(this.$).ha.va.s4;if(this.$.xa.pa.sheetName===Md.SheetName&&qe.right===ac.right&&qe.top===ac.top){Vc=Vc.Ao;Vc=new Me.a(Vc.User.UserID,Vc.User.UserName,Vc.UserColor,new rc.a(1),null,Vc.UserEmail,void 0,void 0,void 0,void 0,void 0,Vc.JoinCoauthTime);Array.add(La,Vc);break}}}}return La};T.prototype.zxc=function(){ca.FKb=!0;ca.Ona=!0;var La=this.yu,Db;for(Db in La)La[Db].zxc()};T.prototype.Adc=function(){ca.FKb=!1;ca.Ona=!1;var La=this.yu,Db;for(Db in La)La[Db].Adc()};
T.prototype.dispose=function(){this.jNb();this.$&&(this.$.xa&&this.$.xa.ug(this.w6),this.$.na&&this.$.na.tda(this.g8),this.$.sn(this.od));this.rn&&this.rn.gJd(this.hDb);this.oXc&&(this.oXc.dispose(),this.oXc=null);if(this.yu){var La=this.yu,Db;for(Db in La)La[Db].dispose()}Wd.a.rc([this.tL,this.jy]);this.cze();this.yu=this.$=this.Gge=null;Array.clear(this.Qx);Ee.prototype.dispose.call(this)};T.prototype.jNb=function(){this.tL&&(this.tL.Nza(this.KBd),this.tL.gcj(this.txf),this.tL.Gdj(this.QBf),this.tL.pda(this.nd));
this.jOa.fRf(this.ODb)};T.prototype.GFe=function(La){return new H(La,this.$,this.jy)};T.prototype.zme=function(La){var Db=this.$.ea.Qhd(La);if(Db)if(La in this.yu)this.yu[La].jeg(Db);else{var uc=this.GFe(Db);this.yu[La]=uc;this.L_a(uc)}return!!Db};T.prototype.Q4e=function(La,Db,uc,Vc){if(La){La=yl(La);for(var yd=La.next();!yd.done;yd=La.next()){if(yd=yd.value){var Md=Mb(yd,this.$,1);if(Md&&T.Shd(Md.ij,Db,uc,Vc))break;if((Md=Mb(yd,this.$,2))&&T.Shd(Md.ij,Db,uc,Vc))break}if(Vc.xc.SelectedRange){Md=
yl(Vc.xc.SelectedRange);for(var qe=Md.next();!qe.done;qe=Md.next())if((qe=qe.value)&&yd&&Dc(yd,qe)){Array.add(1===Vc.xc.PresenceType?uc:Db,Vc.Oz.ZNb.User);return}}}}};T.prototype.P4e=function(La,Db,uc,Vc){La&&T.Shd(this.FQh(La),Db,uc,Vc)};T.prototype.tIg=function(La){La.SelectedRange&&(La.SelectedRangeRaw=this.kch(La.SelectedRange),La.SelectedRange=this.jOa.j3g(La.SelectedRange))};T.prototype.kch=function(La){for(var Db=Array(La.length),uc=0;uc<La.length;uc++){var Vc=uc,yd=La[uc],Md={};Md.SheetName=
yd.SheetName;Md.FirstColumn=yd.FirstColumn;Md.FirstRow=yd.FirstRow;Md.LastRow=yd.LastRow;Md.LastColumn=yd.LastColumn;Md.NamedObjectName=yd.NamedObjectName;Db[Vc]=Md}return Db};T.prototype.FQh=function(La){if(La)switch(La.type){case 0:return(La=this.$.zb.h1e(La.id))?La.ij:null;case 2:return La.ij}return null};T.prototype.e5a=function(){this.tL.HFa(this.KBd);this.tL.IGg(this.QBf);this.tL.LEg(this.txf);this.tL.G2(this.nd);this.jOa.ioe(this.ODb)};T.prototype.knf=function(La,Db,uc,Vc){var yd={};yd.a=this.$.ya.UserSessionId;
yd.b=La;yd.c=uc?"PendingUserRemoved":"Non-PendingUserRemoved";yd.d=Vc?"Disconnected":"Inactivity";yd.e=Db;md.b().Pe(22,yd,!0)};T.prototype.aQf=function(La,Db){La in this.yu&&(this.hQf(La),this.yu[La].dispose(),delete this.yu[La],Ub.ULS.sendTraceTag(537154375,0,50,"PresenceView.RemovePresenceForUser: userId=[{0}] removed due to inactivity",La),this.knf(La,ie.a.Ra.Kb,!1,Db));La in this.vma&&(this.Qjc(La,!1),delete this.A$a[La],delete this.vma[La],Ub.ULS.sendTraceTag(537154374,0,50,"PresenceView.RemovePresenceForUser: Pending userId=[{0}] removed due to inactivity",
La),this.knf(La,ie.a.Ra.Kb,!0,Db))};T.prototype.hQf=function(La){for(var Db=this.Qx.length-1;0<=Db;Db--)if(this.Qx[Db].User.UserID===La){Array.removeAt(this.Qx,Db);for(var uc=yl(this.yu[La].iy),Vc=uc.next();!Vc.done;Vc=uc.next())this.jy.Cna(Vc.value.dv.CB,!1);this.Cxc()}};T.prototype.Uui=function(){if(this.H3b||this.I3b)this.$.xe(-70383382,-1,0,null),Ub.ULS.sendTraceTag(537154373,0,50,"PresenceView.LogDiscontinuousCountPresenceData: Discontinuous Presence Received with count= [{0}], Continuous Presence Received with count= [{1}]",
this.I3b,this.H3b);this.I3b=this.H3b=0};T.prototype.cze=function(){this.Xtd();this.EOc=this.A$a=null};T.prototype.Xtd=function(){var La=this.vma,Db;for(Db in La)this.Qjc(Db,!1)};T.prototype.lui=function(){var La=this.T6c,Db;for(Db in La)this.Vmf(Db,!0,La[Db]);La=this.sld;for(var uc in La)this.Vmf(uc,!1,La[uc]);this.T6c={};this.sld={}};T.prototype.Qjc=function(La,Db){if(this.$.Uu&&this.$.ea.qc){var uc={};uc.a=this.$.ya.UserSessionId;uc.b=La;uc.c=Db;uc.e=!1;uc.d=-1;uc.f=ie.a.Ra.Kb;this.$.ea&&(uc.e=
this.$.ea.MM);if(La=this.A$a[La])uc.d=kd.a(ie.a.Ra,La);md.b().Pe(20,uc,!0)}};T.prototype.uud=function(La){if(this.$.Uu){var Db={e:-1,f:-1,c:!1,d:!1};Db.b=La;Db.a=this.$.ya.UserSessionId;this.$.ea&&(Db.c=this.$.ea.X4a,Db.d=this.$.ea.MM,Db.e=this.$.ea.km.length,this.$.ea.YBa&&(Db.f=kd.a(ie.a.Ra,this.$.ea.UYj)));md.b().Pe(21,Db,!0)}};T.prototype.Vmf=function(La,Db,uc){if(this.$.Uu){var Vc={};Vc.a=this.$.ya.UserSessionId;Vc.b=La;Vc.c=Db;Vc.d=uc;md.b().Pe(19,Vc,!0)}};T.prototype.t7e=function(){var La=
[],Db=this.yu,uc;for(uc in Db){var Vc=Db[uc];if(this.tL.MXf(Vc.xc)){this.jne(La,Vc);Array.remove(this.Qx,Vc.Oz.ZNb);if(1===this.tL.xc.PresenceType){var yd={};yd.a=1===Vc.xc.PresenceType?"Editing":"Non-Editing";yd.b=this.$.ya.UserSessionId;yd.c=ie.a.Ra.Kb;md.b().Pe(18,yd)}yd=yl(Vc.iy);for(Vc=yd.next();!Vc.done;Vc=yd.next())this.jy.Cna(Vc.value.dv.CB,!0)}else for(yd=yl(Vc.iy),Vc=yd.next();!Vc.done;Vc=yd.next())this.jy.Cna(Vc.value.dv.CB,!1)}Array.clear(this.Qx);this.Qx=La;this.Cxc()};T.prototype.jne=
function(La,Db){var uc=Db.Oz.ZNb;if(0===Db.xc.PresenceType){Db=La.length;var Vc;for(Vc=0;Vc<Db&&0===this.yu[La[Vc].User.UserID].xc.PresenceType;Vc++);Array.insert(La,Vc,uc)}else Array.add(La,uc)};T.prototype.L_a=function(La){this.tL.MXf(La.xc)&&(this.jne(this.Qx,La),this.Cxc());var Db=La.Oz.ZNb.User.UserID,uc=this.yu,Vc;for(Vc in uc){var yd=uc[Vc];Vc!==Db&&La.L_a(yd)}};T.prototype.Cxc=function(){0<this.Qx.length&&this.gDj()};T.prototype.gDj=function(){for(var La=0,Db=this.Qx.length;La<Db;La++){var uc=
this.yu[this.Qx[La].User.UserID];if(uc)if(this.tL.wMf(uc.xc)){uc.g5f(!0);uc=yl(uc.iy);for(var Vc=uc.next();!Vc.done;Vc=uc.next())this.jy.Cna(Vc.value.dv.CB,!0)}else(Vc=this.tL.p0e(uc.xc))&&uc.h5f(!0,Vc)}};T.prototype.EVh=function(La){var Db={User:{}};Db.User.UserID=La;Db.User.UserName=ge.a.instance.Cb(86);Db.UserColor="#AAAAAA";return Db};T.prototype.FAe=function(La,Db){var uc=this;this.BQd&&this.vEd&&(La&&Db?this.uEd?this.uEd.klh(La,Db,this.wrb):this.vEd.continueWith(function(){uc.uEd=uc.vEd.result;
uc.FAe(La,Db)}):Ub.ULS.sendTraceTag(537154372,0,15,"userId: [{0}], endTime: [{1}]",La,Db))};T.Shd=function(La,Db,uc,Vc){if(!Vc||!Vc.xc||!Vc.xc.Object)return!1;for(var yd=yl(Vc.xc.Object),Md=yd.next();!Md.done;Md=yd.next())if(Md=Md.value,La&&Md&&Md.ObjectId&&!Md.ObjectId.localeCompare(La))return Array.add(1===Md.ObjectPresenceType?uc:Db,Vc.Oz.ZNb.User),!0;return!1};Sk.Object.defineProperties(T.prototype,{tL:{configurable:!0,enumerable:!0,get:function(){return this.Gge}},KBa:{configurable:!0,enumerable:!0,
get:function(){return this.yu}},vma:{configurable:!0,enumerable:!0,get:function(){return this.EOc}}});Object(Oa.a)(T,"PresenceView",Hb.a,[578,579]);var ee=b(199),hf=b(217),kf=b(378),rf=Hb.a;vm(ba,rf);ba.prototype.tq=function(La){this.addHandler("OSC",La)};ba.prototype.Mq=function(La){this.removeHandler("OSC",La)};ba.prototype.vz=function(){this.raiseEvent("OSC")};ba.prototype.$r=function(La,Db){if("QueryOcsConnectionStatus"===La)Db.Value=this.$.ea.n7a?ge.a.instance.fa(893):ge.a.instance.fa(894);else return!1;
return!0};ba.prototype.kn=function(){return!0};ba.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.RF(this),this.statusBarManager=null);this.$=null;rf.prototype.dispose.call(this)};Object(Oa.a)(ba,"OcsStatusBarManager",Hb.a,[3,185,186]);var ng=Hb.a;vm(la,ng);la.prototype.Lfd=function(){this.z_||(this.z_={},this.z_.IsPresenter=this.$.ya.IsMeetingPresenter,this.z_.MeetingId=this.$.ya.MeetingId);this.z_.MessageId=++this.messageId;Ub.ULS.sendTraceTag(524940883,0,50,"SelectionPresenceManager::getMeetingInfo: Sending presence with messageId: "+
this.messageId);return this.z_};la.prototype.HFa=function(La){this.addHandler(la.wEd,La)};la.prototype.Nza=function(La){this.removeHandler(la.wEd,La)};la.prototype.LEg=function(La){this.$.ea.bha(La)};la.prototype.gcj=function(La){this.$.ea.sda(La)};la.prototype.G2=function(La){this.addHandler(la.C0,La)};la.prototype.pda=function(La){this.removeHandler(la.C0,La)};la.prototype.IGg=function(La){this.addHandler(la.xEd,La)};la.prototype.Gdj=function(La){this.removeHandler(la.xEd,La)};la.prototype.dispose=
function(){this.$&&(this.jNb(),this.$.pl(this.rd),this.$.sn(this.od));this.Fj&&this.Fj.Oza(this.lma);Wd.a.Fa(this.Qtf);this.$=this.Fj=this.z_=null;ng.prototype.dispose.call(this)};la.prototype.C1g=function(La){this.Fj?this.Fj.Oza(this.lma):this.e5a();(this.Fj=La)?(this.Fj.IFa(this.lma),this.ecb(!0)):this.jNb()};la.prototype.e5a=function(){var La=this;this.ha.OG(this.nd);of.g(this.$).cE(this.lp);var Db=of.g(this.$).yc;Db.Mo(this.Kg);Db.Yl(this.fj);this.$.ea.Uj(this.$c);this.$.ea.Vne(this.Tif);this.jOa.ioe(this.ODb);
Db=this.$.na.ta;Db.JFa(this.vFf);Db.uq(this.Nh);Db.Ky(this.Mn);this.Ohf?this.$.da.Za(16,function(uc){uc.Lne(La.Xmc);uc.Kne(La.Kg)}):(Db=sa.GetServiceTaskFactory.Wa(this.$.da,16,74,1),Ua.TaskExtensions.Ba(Db,function(uc){La.fieldManagerPane=uc.result;La.fieldManagerPane.Lne(La.Xmc);La.fieldManagerPane.Kne(La.Kg)},ee.a.none,3))};la.prototype.jNb=function(){var La=this;this.ha.WF(this.nd);of.g(this.$).UF(this.lp);var Db=of.g(this.$).yc;Db.Pn(this.Kg);Db.ol(this.fj);this.$.ea.lk(this.$c);this.$.ea.VQf(this.Tif);
this.jOa.fRf(this.ODb);this.$.na.ta.xQa(this.vFf);this.$.na.ta.yr(this.Nh);this.$.na.ta.Ez(this.Mn);this.Ohf?this.$.da.Za(16,function(uc){uc.MQf(La.Xmc);uc.LQf(La.Kg)}):this.fieldManagerPane&&(this.fieldManagerPane.MQf(this.Xmc),this.fieldManagerPane.LQf(this.Kg));this.raiseEvent(la.xEd)};la.prototype.MXf=function(La){return this.wMf(La)||!!this.p0e(La)};la.prototype.wMf=function(La){if(2===this.xc.Version&&this.xc.Object&&2===La.Version&&La.Object&&0<this.xc.Object.length&&0<La.Object.length)for(var Db=
this.xc.Object.length,uc=La.Object.length,Vc=0;Vc<Db;Vc++)for(var yd=0;yd<uc;yd++)if(this.TWc(this.xc.Object[Vc],La.Object[yd]))return!0;if(this.xc.SelectedRange&&La.SelectedRange)for(Db=this.xc.SelectedRange.length,uc=La.SelectedRange.length,Vc=0;Vc<Db;Vc++)for(yd=0;yd<uc;yd++)if(la.nLg(this.xc.SelectedRange[Vc],La.SelectedRange[yd]))return!0;return!1};la.prototype.p0e=function(La){if(2===this.xc.Version&&this.xc.Object&&2===La.Version&&La.Object&&0<this.xc.Object.length&&0<La.Object.length)for(var Db=
this.xc.Object.length,uc=La.Object.length,Vc=0;Vc<Db;Vc++)for(var yd=0;yd<uc;yd++)if(la.eGi(this.xc.Object[Vc],La.Object[yd]))return this.xc.Object[Vc].ObjectId;return null};la.prototype.TWc=function(La,Db){return!!La&&!!Db&&La.ObjectType===Db.ObjectType&&(1===La.ObjectType||3===La.ObjectType)&&!!La.ObjectId&&!!Db.ObjectId&&!La.ObjectId.localeCompare(Db.ObjectId)};la.prototype.UXf=function(){this.ecb(!1)};la.prototype.ecb=function(La){this.ha.Pa.lc?this.CNd(0,La):this.LNd(of.g(this.$).yc.isEditing?
1:0,La)};la.prototype.CNd=function(La,Db){var uc={};this.$.Cj(uc);if(this.ha.Pa.lc){var Vc=this.ha.Pa.lc.floatingObject;uc.FirstColumn=-1;uc.FirstRow=-1;uc.LastColumn=-1;uc.LastRow=-1;uc.NamedObjectName=Vc?Vc.Hg():null;this.xc.SelectedRange=[uc];this.xc.PresenceType=0;uc=null;if(Vc)switch(Vc.type){case 0:if(Vc=this.$.zb.h1e(Vc.id))uc={},uc.ObjectType=this.Taa(0),uc.ObjectPresenceType=La,uc.ObjectId=Vc.ij;break;case 2:Vc.id&&(uc={},uc.ObjectType=this.Taa(9),uc.ObjectPresenceType=La,uc.ObjectId=Vc.ij)}this.xc.Object=
[uc]}this.raiseEvent(la.C0);this.sendPresenceToService(Db)};la.prototype.LNd=function(La,Db){if(!of.g(this.$).isEditing&&!of.g(this.$).Ci){var uc=this.$.Vb.Wh("ModelUpdate","SendRangePresence");uc.start();var Vc=qd.k(this.ha.va.selectedRanges,this.$);this.xc.SelectedRange=this.jOa.i3g(Vc);this.xc.Object=[];Vc=yl(Vc);for(var yd=Vc.next();!yd.done;yd=Vc.next())if(yd=Mb(yd.value,this.$,1)){var Md={};Md.ObjectType=this.Taa(yd.type);Md.ObjectPresenceType=0;Md.ObjectId=yd.ij;Array.add(this.xc.Object,Md)}this.xc.PresenceType=
La;this.raiseEvent(la.C0);this.xc.SelectedRange||this.xc.Object?this.sendPresenceToService(Db):Ub.ULS.sendTraceTag(537154371,0,50,"SelectionPresenceManager.SendRangePresence: skip sending range presence since selected range/object are both null.  UserId: [{0}]",this.Fj.clientId);uc.stop()}};la.prototype.sendPresenceToService=function(La){if(this.$.ea.m7b||!this.$.ea.X2b||La)if(this.amIAlone||++this.oAa.b,this.Fj){this.xc.Version=2;this.xc.ClientType=1;this.xc.ChatThreadId=this.$Wa.Y_c;this.xc.ChatThreadDiscoveryUri=
this.$Wa.X_c;this.xc.InChat=this.$Wa.yxb;this.xc.Cid=this.$Wa.email;this.xc.SupportsChat=!!this.$Wa.capabilities&&this.$Wa.capabilities.VKa(4);this.xc.CollabMode=this.$.ea.n7a?2:0;this.xc.OcsCapable=this.$.ea.ocsCapable;this.$.ya.IsMeetingLiveSession&&this.$.ya.IsMeetingPresenter&&jc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&(this.xc.MeetingInfo=this.Lfd());this.Fj.jYf(this.xc);if(jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&
this.$.ea&&this.$.ea.X4a){var Db=(new Date).getTime();Ua.TaskExtensions.Ba(sa.GetServiceTaskFactory.Wa(this.$.da,435,436,1),function(uc){uc.result.kwi(Db)},this.$.ma,3)}this.amIAlone||++this.oAa.c}};la.prototype.zNd=function(){this.$.Uu&&(this.oAa.a=this.$.ya.UserSessionId,md.b().Pe(26,this.oAa,!0));this.oAa.b=0;this.oAa.c=0};la.prototype.Taa=function(La){switch(La){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}};la.eGi=function(La,Db){return!!La&&!!La.ObjectId&&
!!Db&&!!Db.ObjectId&&(0===La.ObjectType||2===La.ObjectType)&&La.ObjectType===Db.ObjectType&&!La.ObjectId.localeCompare(Db.ObjectId)};la.nLg=function(La,Db){return!La.NamedObjectName&&Dc(La,Db)};Sk.Object.defineProperties(la.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return this.Wqa}},amIAlone:{configurable:!0,enumerable:!0,get:function(){return!this.$.ea||this.$.ea.amIAlone}}});Sk.Object.defineProperties(la,{Gpc:{configurable:!0,enumerable:!0,get:function(){var La={};return la.Vde||
(la.Vde=(La.ApplyFilter=1,La.ApplyPivot=0,La.ApplyPivotSort=0,La.ApplyPivotSortByValue=1,La.ApplyWellKnownPivotFilter=0,La.RemovePivotFilter=0,La.SetCustomFilter=1,La.SetTop10Filter=1,La.TogglePivotDrill=0,La.RefreshAll=2,La))}}});la.wEd="presenceChanged";la.xEd="presenceDisabled";la.C0="selectionChanged";la.Vde=null;Object(Oa.a)(la,"SelectionPresenceManager",Hb.a,[603,3,604]);var je=Sd.a;vm(Q,je);Q.prototype.create=function(){var La=this;this.manager?this.Fb(this.manager):Ua.TaskExtensions.Ba(sa.GetServiceTaskFactory.create(this.$.da,
28,this.ma,this.ub),function(Db){La.Fb(La.manager||(La.manager=new la(La.$,Db.result)))},this.ma,3)};Object(Oa.a)(Q,"SelectionPresenceManagerFactory",Sd.a,[]);var bg=b(1248),ig=b(4),Yd=b(179),If=Ec.a;vm(U,If);U.prototype.q0e=function(La,Db){this.RHa=[];Db=this.presenceView.sSh(La,Db);La=Db.Gdi;Db=Db.tjh;Array.addRange(this.RHa,La);Array.addRange(this.RHa,Db);return U.nve(La,Db)};U.prototype.dispose=function(){this.presenceView.Nza(this.YDb);this.DPa&&(Wd.a.Fa(this.DPa),this.DPa=null);If.prototype.dispose.call(this)};
U.nve=function(La,Db){if(!La.length&&!Db.length)return"";if(Db.length){if(1===Db.length)return La=ge.a.instance.Cb(82),String.format(La,Db[0].UserName);La=ge.a.instance.Cb(83);return String.format(La,Db.length)}if(1===La.length)return Db=ge.a.instance.Cb(84),String.format(Db,La[0].UserName);Db=ge.a.instance.Cb(85);return String.format(Db,La.length)};Object(Oa.a)(U,"PresenceReadoutHandlerService",Ec.a,[580]);J.prototype.I$b=function(La){return La};J.prototype.Bpc=function(La){for(var Db=Array(La.Uha.count),
uc=0,Vc=yl(La.Uha.values),yd=Vc.next();!yd.done;yd=Vc.next())Db[uc]=yd.value,uc++;return V(this.$.na.ta,Db,La.Cr,La.l4,null,null)};J.prototype.JZb=function(La,Db){if(!Db)return La;if(!La)return Ub.ULS.shipAssertTag(537154136,0,!!La,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),Db;Ub.ULS.shipAssertTag(537154135,0,1===La.Uha.count,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: newActionParameters has unexpected number of entries");
for(var uc={},Vc=yl(La.Uha),yd=Vc.next();!yd.done;uc={hP:uc.hP,Yea:uc.Yea},yd=Vc.next())uc.hP=yd.value,uc.Yea=void 0,function(Md){return function(){var qe=Db.Uha.Gc(Md.hP.key);Md.Yea=qe.value;return qe}}(uc)().returnValue?uc.Yea.OcsSessionId!==uc.hP.value.OcsSessionId?(Ub.ULS.sendTraceTag(537154134,0,15,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Found nonidentical OcsSessionIds. new SeqNum: {0}, aggregated SeqNum: {1}",uc.hP.value.SeqNum,uc.Yea.SeqNum),Db.Uha.ia(uc.hP.key,
uc.hP.value.SeqNum<uc.Yea.SeqNum?uc.hP.value:uc.Yea),Db.Cr=uc.hP.value.SeqNum<uc.Yea.SeqNum?La.Cr:Db.Cr):(uc.hP.value.SeqNum>uc.Yea.SeqNum&&Db.Uha.ia(uc.hP.key,uc.hP.value),Db.Cr=La.Cr):(Db.Uha.add(uc.hP.key,uc.hP.value),Db.Cr=La.Cr);return Db};Object(Oa.a)(J,"CheckCollabServiceActionAggregationPerformer",null,[576,577]);r.prototype.I$b=function(La){return La};r.prototype.Bpc=function(La){var Db=this.$.na.ta,uc=La.nbh,Vc=La.ymc;La=La.Cr;var yd=Db.Na(1,null);yd.Id=uc;yd.OnBehalfOfOcs=Vc;return bc.i(Db,
"CheckPersistedContentUpdate",yd,La,null,null,null,516)};r.prototype.JZb=function(La,Db){if(!Db)return La;if(!La)return Ub.ULS.shipAssertTag(537154133,0,!1,"CheckPersistedActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),Db;La.ymc=Db.ymc&&La.ymc;return La};Object(Oa.a)(r,"CheckPersistedActionAggregationPerformer",null,[576,577]);C.prototype.I$b=function(La){return La};C.prototype.Bpc=function(La){var Db=this.$.na.ta;La=La.TYd;var uc=Db.Na(1,null);uc.UploadInfo=
La;return bc.i(Db,"ProcessUploadRtcNotification",uc,null,null,null,null,0)};C.prototype.JZb=function(La,Db){if(!Db)return La;if(!La)return Ub.ULS.shipAssertTag(537154132,0,!!La,"UploadNotificationActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),Db;Db.eSj(La);return Db};Object(Oa.a)(C,"CheckUploadNotificationActionAggregationPerformer",null,[576,577]);Object(Oa.a)(u,"RevisionGeneratedNotification",null,[]);Object(Oa.a)(z,"StateDownloadedNotification",null,[]);
var Pd=b(123),Ze=Ec.a;vm(B,Ze);B.prototype.dispose=function(){this.Md=!0;this.rob&&(this.rob.dispose(),this.rob=null);this.contentRefreshManager&&(this.zcg(),this.contentRefreshManager=null);this.Ca&&(this.IXd(),this.Ca=null);this.viewport&&(this.IXd(),this.viewport=null);this.sf&&(this.sf=null);this.$&&(this.$.pl(this.rd),this.$.ea.lk(this.$c),this.$.ea.tRf(this.Ur),this.$=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.Psc(this.rEb),this.mergeSuspensionManager=null);Ze.prototype.dispose.call(this)};
B.prototype.RHj=function(){this.Uyc||(this.contentRefreshManager.QGg(this.sCf),this.Uyc=!0,this.rob.Pq())};B.prototype.zcg=function(){this.Uyc&&(this.contentRefreshManager.Mdj(this.sCf),this.Uyc=!1)};B.prototype.PHj=function(){this.Syc||(this.Ca.Fp(this.Jg),this.Syc=!0)};B.prototype.IXd=function(){this.Syc&&(this.Ca.Kq(this.Jg),this.Syc=!1)};B.prototype.QHj=function(){this.Tyc||(this.viewport.RGg(this.wCf),this.Tyc=!0)};B.prototype.RQj=function(){this.Tyc&&(this.viewport.Pdj(this.wCf),this.Tyc=!1)};
B.prototype.vDe=function(La,Db){if(La!==se.a.Te&&!this.iea.xb(La)){var uc=ie.a.Ra.Kb.toISOString();uc=Object.assign(new z,{StateId:La,DownloadedOn:uc,IsHidden:this.Fe?this.Fe.Di:"visible"!==window.document.visibilityState,DocumentLastUnhidden:this.Fe&&this.Fe.Pic?this.Fe.Pic.toISOString():null,LastLostRtcConnection:this.contentRefreshManager&&this.contentRefreshManager.rkf?this.contentRefreshManager.rkf.toISOString():null,LastOffline:this.sf&&this.sf.wxa?this.sf.wxa.toISOString():null});this.mergeSuspensionManager&&
(uc.IsPendingMergeBlockedByClient=this.Zwa,this.nDd&&(uc.PendingMergeBlockedByClientLastEnded=this.nDd.toISOString()));Ub.ULS.sendTraceTag(537154124,13,50,"ContentLatencyTracker.CreateAndAddstateDownloadedNotifications: {0} - StateDownloadedNotification: {1}",Db,JSON.stringify(uc));this.iea.add(La,uc)}};B.prototype.Ovd=function(){cc.AFrameworkApplication.dg&&cc.AFrameworkApplication.dg.Ovd()};Object(Oa.a)(B,"ContentLatencyTracker",Ec.a,[]);var Yf=b(1022);Object(Oa.a)(t,"UpdateInfo",null,[]);var Xf=
b(100);Object(Oa.a)(y,"CollabServiceContentUpdateActionParameters",null,[]);var rg=b(1023),uf=Sys.EventArgs;vm(x,uf);Object(Oa.a)(x,"RevisionGeneratedEventArgs",Sys.EventArgs,[]);f.prototype.BTj=function(){this.jqc||(this.jqc=Wb.a.we(),this.mBb())};f.prototype.yTj=function(){this.Tdc||(this.Tdc=Wb.a.we(),this.mBb())};f.prototype.ATj=function(){this.wpc||(this.wpc=Wb.a.we(),this.mBb())};f.prototype.CTj=function(La){this.jCc||(this.jCc=Wb.a.we(),this.Dcf=La,this.mBb())};f.prototype.mBb=function(La){La=
void 0===La?0:La;this.Jff||(La&&La>this.axi?this.Jxa(!0):this.jqc&&this.wpc&&this.Tdc&&this.jCc&&this.Jxa(!1))};f.prototype.dispose=function(){this.$=null};f.prototype.Jxa=function(La){var Db={};Db.CoAuthorsCount=this.$.ea.km.length;Db.HostNotificationTime=this.Tdc;Db.PeerNotificationTime=this.wpc;Db.PresenceNotificationTime=this.jqc;Db.UserFetchTime=this.jCc;Db.IsAlreadyFetchedFromServer=this.Dcf;Db.IsTimeout=La;Db.ClientId=this.clientId;Db.CurrentUserClientId=this.Rah;Ub.ULS.sendTraceTag(541388879,
0,50,"Host Notification Latency Entry: {0}",Db);this.E9d=!0};Sk.Object.defineProperties(f.prototype,{Jff:{configurable:!0,enumerable:!0,get:function(){return this.E9d}}});Object(Oa.a)(f,"HostNotificationLatencyEntry",null,[3]);Object(Oa.a)(m,"PersistedContentUpdateActionParameters",null,[]);n.prototype.VPj=function(La){this.c_b(La.U0c,this.jGc);this.c_b(La.V0c,this.kGc)};n.prototype.c_b=function(La,Db){if(La){La=yl(La);for(var uc=La.next();!uc.done;uc=La.next())Db[uc.value]=!0}};Sk.Object.defineProperties(n.prototype,
{U0c:{configurable:!0,enumerable:!0,get:function(){return Gd.a(this.jGc)}},V0c:{configurable:!0,enumerable:!0,get:function(){return Gd.a(this.kGc)}},Ief:{configurable:!0,enumerable:!0,get:function(){return!this.U0c.length&&!this.V0c.length}}});Object(Oa.a)(n,"UpdatePresenceUsersActionParameters",null,[]);Object(Oa.a)(l,"UploadRevisionInfo",null,[]);e.prototype.eSj=function(La){for(var Db=0;Db<La.TYd.length;Db++){var uc=La.TYd[Db];this.UYd.add(uc.ClientId,uc)}};Sk.Object.defineProperties(e.prototype,
{TYd:{configurable:!0,enumerable:!0,get:function(){return this.UYd.values}}});Object(Oa.a)(e,"UploadNotificationActionParameters",null,[]);var kg=Hb.a;vm(c,kg);c.prototype.QGg=function(La){this.addHandler("ekcrmrrg",La)};c.prototype.Mdj=function(La){this.removeHandler("ekcrmrrg",La)};c.prototype.tnb=function(La){this.addHandler("ekcrmmcu",La)};c.prototype.oHb=function(La){this.removeHandler("ekcrmmcu",La)};c.prototype.GFg=function(La){this.addHandler("LabelUpdateEventKey",La)};c.prototype.Qcj=function(La){this.removeHandler("LabelUpdateEventKey",
La)};c.prototype.ANb=function(La,Db){this.$.ea.qc&&(Ub.ULS.sendTraceTag(537154119,0,50,"ContentRefreshManager.UpdatePresenceUsers: clientIdsToAdd=[{0}] clientIdsToRemove=[{1}]",La?La.join(","):"null",Db?Db.join(","):"null"),this.VTj.Dpc(new n(La,Db,null)))};c.prototype.dispose=function(){this.Fj&&(this.Fj.xHb(this.Aca),this.Fj.Oza(this.qBd));this.$&&(this.$.na.yr(this.Nh),this.$.ea.sda(this.kI));this.rn&&(this.rn.gJd(this.hDb),this.rn.CQf(this.wwf));this.$=this.Fj=this.O_a=this.mLa=null;kg.prototype.dispose.call(this)};
c.prototype.sTd=function(La){this.Fj&&(this.Fj.xHb(this.Aca),this.Fj.Oza(this.qBd));this.Fj=Object(Jb.a)(284,La);this.Fj.NYa(this.Aca);jc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&this.Fj.IFa(this.qBd);this.currentUserId=this.Fj.clientId};c.prototype.NNf=function(){for(var La=!this.Fj,Db=yl(this.$.ea.km),uc=Db.next();!uc.done;uc=Db.next())(uc=uc.value.User.UserID)&&uc!==this.currentUserId&&!this.O_a.has(uc)&&this.Bbc(uc).CTj(La)};c.prototype.i5h=function(La){if(se.a.hVf in
La&&se.a.gVf in La&&se.a.fVf in La){var Db=La[se.a.fVf];1!==Db||se.a.n7 in La&&se.a.auc in La||Ub.ULS.sendTraceTag(537154076,13,10,"RTC WetContentUpdate was sent from ECS and is missing some expected fields. Has SessionSiteIdentifier: {0}, Has UserOperationTimeInMs: {1}.",se.a.n7 in La,se.a.auc in La);var uc=this.kGa(La);var Vc=uc.uNf;uc.returnValue||(La=new x(La[se.a.hVf],La[se.a.gVf],Db,Vc,se.a.auc in La?La[se.a.auc]:0),this.raiseEvent("ekcrmrrg",La,this))}else Ub.ULS.sendTraceTag(537154077,13,
10,"RTC WetContentUpdate is missing some critical fields. Ignoring this update.")};c.prototype.kGa=function(La){La=se.a.n7 in La?La[se.a.n7]:null;return{returnValue:this.$.ea.n7===La,uNf:La}};c.prototype.Ucg=function(){this.$.ea.vna=Math.max(c.HNg,this.$.ea.vna)};c.prototype.ZQd=function(La){La=yl(La);for(var Db=La.next();!Db.done;Db=La.next())if(!this.$.ea.Qhd(Db.value))return!0;return!1};c.prototype.d0c=function(){this.$.xe(1562177611,-1,0,null)};c.prototype.OOa=function(La){se.a.Iqf in La&&se.a.Jqf in
La&&se.a.Kqf in La&&(La=Object.assign(new Yf.a,{Pending:La[se.a.Jqf],Current:La[se.a.Iqf],SuspensionStartTimestamp:La[se.a.Kqf]}),this.raiseEvent("ekcrmmcu",new rg.a(La),this))};c.prototype.Bbc=function(La){La=this.BCe(La);if(!this.mLa[La]){var Db=new f(La,this.currentUserId,4E4,this.$);this.mLa[La]=Db}this.LWf();return Object(Jb.a)(f,this.mLa[La])};c.prototype.BCe=function(La){if(!La)return La;var Db=La.toLocaleLowerCase();Db.startsWith("{")||(Db="{"+La+"}");return Db};c.prototype.LWf=function(){var La=
this;this.ykd||Ba.a.isEmpty(this.mLa)||!jc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)||(this.ykd=ra.Task.delay(2E4).continueWith(function(){La.r8h()}))};c.prototype.r8h=function(){var La=[],Db=Wb.a.we(),uc=this.mLa,Vc;for(Vc in uc){var yd=Vc,Md=Object(Jb.a)(f,uc[Vc]);Md.mBb(Db);Md.Jff&&(Md.dispose(),La.push(yd))}La=yl(La);for(Db=La.next();!Db.done;Db=La.next())Db=Db.value,delete this.mLa[Db],this.O_a.add(Db);this.ykd=null;this.LWf()};Sk.Object.defineProperties(c.prototype,
{rkf:{configurable:!0,enumerable:!0,get:function(){return this.Y$d}},akj:{configurable:!0,enumerable:!0,get:function(){return!!this.Fj&&2===this.Fj.connectionState}}});c.HNg=3E4;Object(Oa.a)(c,"ContentRefreshManager",Hb.a,[588]);var qh=b(59);a.prototype.I$b=function(La){return La+5E3};a.prototype.Bpc=function(La){var Db=this;return this.$.ea.qc?Ua.TaskExtensions.ts(Ua.TaskExtensions.ts(ra.Task.delay(0),function(){var uc=Db.$.na.ta,Vc=La.U0c,yd=La.V0c,Md=La.Cr,qe=uc.Na(1,null);qe.clientIdsToAdd=Vc;
qe.clientIdsToRemove=yd;return bc.i(uc,"UpdatePresenceUsers",qe,Md,null,null,null,0)},ee.a.none,0,qh.a.current),function(){return ra.Task.delay(5E3)},ee.a.none,0,qh.a.current):ra.Task.Ta(!0)};a.prototype.JZb=function(La,Db){if(!Db)return La;if(!La)return Ub.ULS.shipAssertTag(537154073,0,!1,"UpdatePresenceUsersActionAggregationPerformer.AggregateActionParameters: Received null newActionParameter"),Db;if(Db.Ief)return Db;if(La.Ief)return La;Db.VPj(La);return Db};Object(Oa.a)(a,"UpdatePresenceUsersActionAggregationPerformer",
null,[576,577]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.CoauthTelemetry");Ya.main();Type.registerNamespace("Common.App.CollabControls");Type.registerNamespace("Common.App.Presence");Type.registerNamespace("RealtimePresenceUI");Qb.a.Ga(ub.ja);(function(){Qb.a.Ga(function(La){jc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&Ta.ja(La);var Db=La.da;Db.Ha(28,new Ga(La));Db.Ha(158,new Q(La));Qb.a.Ga(Cb.ja);var uc=sa.GetServiceTaskFactory.create(La.da,
158,Db.ma,1),Vc=sa.GetServiceTaskFactory.create(La.da,28,Db.ma,1);Ua.TaskExtensions.Ba(Ua.TaskExtensions.ve([uc,Vc],Db.ma),function(){var yd=new ic.a,Md=Db.Aa(26);Md.hFe(Object(pb.a)(yd,yd.setResult,"setResult"));var qe=new T(La,Md,uc.result,Vc.result,Kb.a.Tq(Sa.a.instance.oc("Common.App.CoauthTelemetry.IPresenceBootTelemetry")));Jd.a.getInstance(La.da).add(qe);Db.Ha(159,new Cb);Ua.TaskExtensions.Ba(sa.GetServiceTaskFactory.create(Db,159,Db.ma,1),function(ac){var Kc=new ic.a;Kc.setResult(qe);new ib(Object.assign(new Me.a,
{clientId:La.workbookContext.ClientId}),yd.task,Kc.task,ac.result,Ue.a.instance,cc.AFrameworkApplication.ga.ra("AwayStatusOneMinuteTimeoutIsEnabled")?6E4:cc.AFrameworkApplication.ga.Ad("AwayCoauthorThresholdMs",9E5),Object(pb.a)(cc.AFrameworkApplication.Gb,cc.AFrameworkApplication.Gb.processAction,"processAction"),ya.instance)},Db.ma)},Db.ma,3);Sa.a.instance.register(180,"Microsoft.Office.Excel.WebUI.Client.ISessionStateManager").as("Common.ICoauthoringTelemeryInfoProvider").Bc().Lc(function(){return La.ea});
Sa.a.instance.resolve("Common.ICoauthoringTelemeryInfoProvider");Sa.a.instance.register(za,"Microsoft.Office.Excel.WebUI.Client.Presence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").Bc().Lc(function(){return new za(La)});Sa.a.instance.resolve("Common.IPeopleInfoProvider")})})();Qb.a.Ga(bg.a.ja);Qb.a.Ga(function(La){var Db=La.da,uc=sa.GetServiceTaskFactory.Wa(La.da,211,212,1);Db.Za(25,function(Vc){Ua.TaskExtensions.Ba(uc,function(yd){Db.Aa(231)||new U(yd.result,La,Vc)},Db.ma,3)})});(function(){Qb.a.Ga(function(La){Ua.TaskExtensions.Ba(sa.GetServiceTaskFactory.Wa(La.da,
12,477,0),function(Db){var uc=new J(La),Vc=La.da.Aa(291);uc=Db.result.P3b(uc,uc,Vc,"collabService");var yd=new r(La);Vc=Db.result.P3b(yd,yd,Vc,"persisted");yd=new a(La);yd=Db.result.P3b(yd,yd,null,"updatePresence");var Md=new C(La);Db=Db.result.P3b(Md,Md,null,"uploadNotification");La.da.Ha(292,new c(La,La.da.Aa(26),uc,Vc,yd,Db));Jd.a.getInstance(La.da).add(new B(La));Jd.a.getInstance(La.da).add(uc);Jd.a.getInstance(La.da).add(Vc);Jd.a.getInstance(La.da).add(Db)},La.ma)})})()},841:function(A,F,b){function a(){}
b.r(F);b.d(F,"RtcUtils",function(){return a});A=b(0);var c=b(13),e=b(934),l=b(40);a.a0c=function(n,m){m=void 0===m?e.RealtimeChannel.Vvd:m;try{var f=l.c(n)}catch(x){throw n=String.format("Failed to JSON-serialize payload : {0}",x),c.ULS.sendTraceTag(18637072,500,10,n),Error.argument("payload",n);}if(f.length>m)throw n=String.format("Payload exceeds maximum length: {0} > {1}.",f.length,m),c.ULS.sendTraceTag(18637074,500,10,n),Error.argument("payload",n);return f};a.deserialize=function(n,m,f){if(!n)return null;
if(Object.getType(n)!==String){var x=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",m,Object.getType(n).getName(),f);c.ULS.sendTraceTag(18637075,500,10,x);return null}x=null;try{x=l.a(n)}catch(y){n=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",m,y,f),c.ULS.sendTraceTag(18637077,500,10,n)}return x};a.pOa=function(n){if(!n)return"";if("string"===typeof n)return n.toString();
try{return l.c(n)}catch(m){return n.toString()}};a.eAh=function(n){var m;var f=0;var x=m=null;if(!n)return{o$e:f,q$e:m,exception:x};try{var y=n.source;y&&Object.getType(y)===String&&(x=y);var t=n.context;t&&(n=t,f=n.status?n.status:0,m=n.statusText?n.statusText:null)}catch(B){}return{o$e:f,q$e:m,exception:x}};Object(A.a)(a,"RtcUtils",null,[])},934:function(A,F,b){function a(za,Ga,cb,Mb,Dc,vb,ib,ub,Eb,Ya,tb,ec){this.tRc=!1;this.y8=null;this.EG=new ja.a;this.khb=1;this.sP=null;this.yt=!1;this.$Lc=(new Date(0)).getTime();
this.zhe=0;this._clientId=za;this.TWb=Ga;this.XL=0;this.Ah=Mb;this.FGc=ub;this.Cvg=ib;this.ykg=Eb;this.Ymg=Dc;this.qpa=vb;this.Pl=cb;this.Bp=Ya;this.Ae=tb;this.Tg=ec;this.Bwg=1>100*Math.random()}function c(za){return za?za.charAt(0).toLocaleUpperCase()+za.substring(1,za.length):za}function e(za,Ga,cb){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",za,c(ya[cb]),c("browser"),Ga)}function l(za,Ga,cb,Mb,Dc,vb,ib,ub,Eb,Ya,tb,ec){Eb=void 0===Eb?null:Eb;Ya=void 0===Ya?null:Ya;
tb=void 0===tb?null:tb;ec=void 0===ec?null:ec;var Za=D.createInstance(ea.AFrameworkApplication.ga),mb=ea.AFrameworkApplication.buildVersion?ea.AFrameworkApplication.buildVersion:"1.0",sc=e(za,Ga,ib,mb),pd=Za.$Yg?b(1299).RealtimeChannelMetrics.createInstance(sc):new la,$b=Ha.a.create(Dc);Za.rtcJsClientFrequentlyLogsMetrics&&$b.gGj(Za.hkj);var Xb="";Xb=Eb&&""!==Eb?Eb:"/rtc2/";$b.qUe=qa.a.YM(Xb);var lc=Xb+"signalr";Eb=Xb+"findsession";var Oa=U.H8h;Xb=new m;tb=tb||Na.a.getInstance();da.ULS.shipAssertTag(556867617,
500,Za.mVf<=b(934).RealtimeChannel.Ypf,"Client attempting to override max payload size beyond absolute limit");var pb=Math.min(Za.mVf,b(934).RealtimeChannel.Ypf);$b.Xpf=pb;$b=new t(Za,new n(Xb),za,sc,function(Ub){return new V(Ub.createHubProxy(Oa))},ub,tb,pd,$b,pb);Ya||(Ya=b(1231).FindSessionStrategy.createInstance(Ga,Dc,Eb,ub,mb,ib,za,sc,tb,vb,Mb,ec));Ya.C9b=Za.C9b;Ga=new ba(sc);cb=cb?cb.split(","):null;za=new (b(934).RealtimeChannel)(za,cb,sc,ub,function(){return $.hubConnection(lc)},Ya,$b,Ga,tb,
pd,Za,Dc);za.init();return za}function n(za){var Ga=this;this.Ae=null;this.Ww=!1;this.rb=new Cb.a;this.dNc=new ja.a;this.cNc=new ja.a;this.dSc=za;this.XVa=this.dSc.AEe(function(cb){return cb.send()},"GlobalMaxOustandingThrottler");this.XVa.iZb(function(){Ga.rb.raiseEvent("TMUDM")})}function m(){}function f(za,Ga){za=y.call(this,za,void 0===Ga?"":Ga)||this;za.E8a=0;za.tjb=(new Date(0)).getTime();za.currentTime=function(){return(new Date).getTime()};return za}function x(za,Ga){za=y.call(this,za,void 0===
Ga?"":Ga)||this;za.kBa=0;za.y8a=0;za.rb=new Cb.a;za.tWa=!1;za.cSc=0;za.HQb=0;za.TQb=0;za.$Tb=0;za.NWb=[];za.clearTimeout=x.Z5c;return za}function y(za,Ga){this.Rhb=this.bmb=0;this.bLc=!1;this.PXa=this.KWb=null;this.uWa=!1;this.Jge=za;this.Q9f=void 0===Ga?"":Ga;this.setTimeout=y.l6c;this.$Ea=this.bmb=this.Rhb=0}function t(za,Ga,cb,Mb,Dc,vb,ib,ub,Eb,Ya){ib=v.call(this,ib)||this;ib.Lr=null;ib.Pae=!1;ib.zP=0;ib.COc=new Ja.a;ib.Ae=za;ib.sce=0;ib.tce=0;ib.cmb=Ga;ib.cmb.iZb(Object(fa.a)(ib,ib.FUi,"onTooManyUndeliveredMessages"));
ib._clientId=cb;ib.qug=Dc;ib.jh.OGg(Object(fa.a)(ib,ib.ARi,"onRefreshProxyRequired"));ib.jh.MGg(Object(fa.a)(ib,ib.xRi,"onRefreshAllPersistentStateRequest"));ib.jh.eHg(Object(fa.a)(ib,ib.Nda,"sendUpdateNotification"));ib.jh.xFg(Object(fa.a)(ib,ib.yOi,"onInternalPresenceUpdated"));ib.jh.yFg(Object(fa.a)(ib,ib.zOi,"onInternalUpdateNotificationReceived"));ib.jh.wFg(Object(fa.a)(ib,ib.xOi,"onInternalPersistentStateUpdated"));ib.jh.vFg(Object(fa.a)(ib,ib.wOi,"onInternalPersistentStateCleared"));ib.jh.dHg(Object(fa.a)(ib,
ib.JNd,"sendPersistentState"));ib.jh.DHg(Object(fa.a)(ib,ib.Seb,"updateClientInfo"));ib.Ah=vb;ib.Pl=Mb;ib.Bp=ub;ib.KB=Eb;ib.Rjb=Ya;ib.LUa=Object(db.a)(String,ea.AFrameworkApplication.Yb.Application)||"";return ib}function B(){this.uRc=this.Cp=null}function z(za,Ga,cb,Mb){var Dc=ma.call(this)||this;Dc.lKd=za;Dc.reconnectDelay=Ga;Dc.reason=cb;Dc.yNd=Mb;return Dc}function u(){this.xbe=new C;this.vbe=new C}function C(){this.R2d=this.EGc=!1;this.callback=null}function r(za,Ga){this.Mvg=za;this.zP=void 0===
Ga?"":Ga}function J(){this.Presence=null;this.TimeStamp=0}function v(za){this.cmb=null;this.Eda=0;this.lJa=!1;this.jh=za;this.jh.GYa(Object(fa.a)(this,this.lW,"onConnectionStateChanged"))}function D(){this.iFc=this.e2d=!1;this.gFc=0;this.lGc=this.QQc=this.PQc=this.BEc=!1;this.nIc=0;this.Wfe=!1;this.Vfe=this.Ufe=0;this.XPc=!1;this.aQc=this.$Pc=this.bQc=this.YPc=0}function V(za){this.Lr=za}function U(){}function Q(){}function la(){this.ENf=this.fHd;this.HNf=this.iHd;this.GNf=this.hHd;this.LNf=this.kHd;
this.KNf=this.jHd;this.qHd=this.rHd;this.nHd=this.oHd;this.fQa=this.lHd;this.wGb=this.mHd;this.FNf=this.gHd;this.qCb=this.Fxd;this.Hlc=this.Hxd}function ba(za){this.v9=!1;this.QXa=0;this.GGc=!1;this.setTimeout=ba.l6c;this.clearTimeout=ba.Z5c;this.jxi=Object(fa.a)(this,this.Dwi,"logRtcConnectingUsageStatement");this.Pl=za}function T(za,Ga){this.data=za;this.timeStamp=Ga}function H(za,Ga,cb){this.b9=null;this.QMc=this.vQc=0;this.Ae=Ga;this.ybe=cb;this.ylb=!1;this.jh=za;this.jh.NYa(Object(fa.a)(this,
this.v7i,"receiveMessage"))}function S(za){this.messageId=za;this.Moj=(new Date).getTime();this.Usd=new Pa.a}function K(za,Ga){this.status=za;this.O7a=Ga}b.r(F);A=b(0);var da=b(13),fa=b(80),X=b(139),ca=b(1133),ja=b(100),ea=b(5);Object(A.a)(K,"UserStatusInfo",null,[]);var qa=b(78),pa=b(592),Pa=b(184);Object(A.a)(S,"MessageLatencyDetails",null,[]);H.prototype.start=function(){if(this.ybe&&!this.ylb){var za=this.Ae.nVf;this.QMc=this.Ae.lVf;za<=this.QMc?(da.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",
this.Ae.nVf,this.Ae.lVf),this.ybe=!1):(this.ylb=!0,this.vQc=window.setInterval(Object(fa.a)(this,this.Sj,"sendMessage"),za))}};H.prototype.Sj=function(){var za=this;if(this.ylb){var Ga=pa.a.create().toString();this.b9=new S(Ga);this.jh.oGd(16,Ga,!1,new X.a);window.setTimeout(function(){za.Rvi(Ga)},this.QMc)}};H.prototype.Rvi=function(za){this.b9&&this.b9.messageId===za&&(0<this.b9.Usd.count?(za=this.b9.Usd.toArray().join(","),da.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",za)):
da.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.b9=null)};H.prototype.stop=function(){this.vQc&&(window.clearInterval(this.vQc),this.ylb=!1)};H.prototype.v7i=function(za,Ga){16===Ga.type?this.jh.oGd(17,Ga.a8,!1,new X.a):17===Ga.type&&this.ylb&&Ga.a8&&this.B2i(Ga.a8)};H.prototype.B2i=function(za){za&&this.b9&&za.toString()===this.b9.messageId&&(za=(new Date).getTime()-this.b9.Moj,this.b9.Usd.add(za))};H.fgd=function(za,Ga,cb){return H.instance||(H.Oa=new H(za,Ga,cb))};
Sk.Object.defineProperties(H,{instance:{configurable:!0,enumerable:!0,get:function(){return H.Oa}}});H.Oa=null;Object(A.a)(H,"ClientToClientMessageTelemetry",null,[]);var Ha=b(1070),Xa=b(1021);Object(A.a)(T,"PresenceData",null,[]);ba.prototype.lJi=function(){var za=this;this.v9||(this.QXa=this.setTimeout(function(){za.v9=!1;za.tnf()},8E3),this.v9=!0,this.GGc=!1)};ba.prototype.lKi=function(){this.DM()};ba.prototype.OTi=function(){this.tnf()};ba.prototype.tnf=function(){this.DM();this.GGc||(this.GGc=
!0,this.jxi())};ba.prototype.Dwi=function(){da.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Pl)};ba.prototype.DM=function(){this.v9&&this.clearTimeout(this.QXa);this.QXa=0;this.v9=!1};ba.l6c=function(za,Ga){return window.setTimeout(za,Ga)};ba.Z5c=function(za){window.clearTimeout(za)};Object(A.a)(ba,"ConnectedUsageKpiLogger",null,[971]);la.prototype.fHd=function(){};la.prototype.iHd=function(){};la.prototype.hHd=function(){};la.prototype.kHd=function(){};
la.prototype.jHd=function(){};la.prototype.oHd=function(){};la.prototype.mHd=function(){};la.prototype.lHd=function(){};la.prototype.rHd=function(){};la.prototype.gHd=function(){};la.prototype.Fxd=function(){};la.prototype.Hxd=function(){};Object(A.a)(la,"NoopRealtimeChannelMetrics",null,[964,143]);Q.zNb="presenceUpdated";Q.updateNotification="updateNotification";Q.EHf="persistentStateCleared";Q.updatePersistentState="persistentStateUpdated";Object(A.a)(Q,"RtcClientMethodNames",null,[]);U.H8h="realtimeChannelHub";
U.zNb="UpdatePresence";U.Nda="SendUpdateNotification";U.Zdd="GetCompletePersistentStateWithMetadata";U.updatePersistentState="UpdatePersistentState";U.Seb="UpdateClientInfo";Object(A.a)(U,"RtcHubMethodNames",null,[]);V.prototype.d$i=function(za){this.Lr.on(Q.zNb,za)};V.prototype.E$i=function(za){this.Lr.on(Q.updateNotification,za)};V.prototype.b$i=function(za){this.Lr.on(Q.updatePersistentState,za)};V.prototype.a$i=function(za){this.Lr.on(Q.EHf,za)};V.prototype.yQj=function(za){this.Lr.off(Q.zNb,
za)};V.prototype.GQj=function(za){this.Lr.off(Q.updateNotification,za)};V.prototype.xQj=function(za){this.Lr.off(Q.updatePersistentState,za)};V.prototype.wQj=function(za){this.Lr.off(Q.EHf,za)};V.prototype.zNb=function(za){return this.Lr.invoke(U.zNb,za)};V.prototype.Seb=function(za){return this.Lr.invoke(U.Seb,za)};V.prototype.Nda=function(za,Ga){return this.Lr.invoke(U.Nda,za,Ga)};V.prototype.Zdd=function(za){return this.Lr.invoke(U.Zdd,za)};V.prototype.updatePersistentState=function(za,Ga){return this.Lr.invoke(U.updatePersistentState,
za,Ga)};Object(A.a)(V,"RealtimeChannelProxy",null,[968,969,970]);D.createInstance=function(za){var Ga=b(934).RealtimeChannel;return za?Object.assign(new D,{e2d:za.ra("AwayStatusManagerIsEnabled"),iFc:za.ra("AwayStatusOneMinuteTimeoutIsEnabled"),gFc:za.Ad("AwayCoauthorThresholdMs",9E5),BEc:za.ra("RtcAllowCrossDomainAccessEnabled"),PQc:za.ra("ShouldLogOnContentNotification"),QQc:za.ra("ShouldLogOnHostSubscriptionNotification"),lGc:za.ra("RtcClientMetricsEnabled"),nIc:za.Ad("RtcFindSessionRequestTimeoutInMS",
6E4),Wfe:za.ra("RtcJsClientFrequentlyLogsMetrics"),Ufe:za.Ad("RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),Vfe:za.Ad("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),XPc:za.ra("RtcClientMessageTelemetryEnabled"),YPc:za.Ad("RtcClientMessageTelemetrySampleSize",5),bQc:za.Ad("RtcSendTelemetryMessageIntervalInMS",3E5),$Pc:za.Ad("RtcLogClientMessageMetricsTimeOutInMs",2E4),aQc:za.Ad("RtcMaxPayloadSizeInCharactersOverride",Ga.Vvd)}):Object.assign(new D,{e2d:!1,iFc:!1,gFc:9E5,BEc:!1,PQc:!1,QQc:!0,
lGc:!1,nIc:9E4,XPc:!1,YPc:5,bQc:3E5,$Pc:2E4,aQc:Ga.Vvd})};Sk.Object.defineProperties(D.prototype,{DNg:{configurable:!0,enumerable:!0,get:function(){return this.iFc}},CNg:{configurable:!0,enumerable:!0,get:function(){return this.gFc}},eJg:{configurable:!0,enumerable:!0,get:function(){return this.BEc}},syj:{configurable:!0,enumerable:!0,get:function(){return this.PQc}},tyj:{configurable:!0,enumerable:!0,get:function(){return this.QQc}},$Yg:{configurable:!0,enumerable:!0,get:function(){return this.lGc}},
C9b:{configurable:!0,enumerable:!0,get:function(){return this.nIc}},rtcJsClientFrequentlyLogsMetrics:{configurable:!0,enumerable:!0,get:function(){return this.Wfe}},kVf:{configurable:!0,enumerable:!0,get:function(){return this.Ufe}},hkj:{configurable:!0,enumerable:!0,get:function(){return this.Vfe}},rtcClientMessageTelemetryEnabled:{configurable:!0,enumerable:!0,get:function(){return this.XPc}},ckj:{configurable:!0,enumerable:!0,get:function(){return this.YPc}},nVf:{configurable:!0,enumerable:!0,
get:function(){return this.bQc}},lVf:{configurable:!0,enumerable:!0,get:function(){return this.$Pc}},mVf:{configurable:!0,enumerable:!0,get:function(){return this.aQc}}});Object(A.a)(D,"RealtimeChannelSettings",null,[967]);var Na=b(1227),db=b(84),Ja=b(343);v.prototype.lW=function(za,Ga){this.Eda=Ga.newState};v.prototype.FUi=function(){da.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.jh.Vqc()};v.prototype.lai=function(za){this.cmb.init(za)};Object(A.a)(v,
"ARtcMessageHandler",null,[]);var jb=b(95);Object(A.a)(J,"PresenceDataEntryForClients",null,[]);var hc=b(109);r.prototype.send=function(){return this.Mvg()};Sk.Object.defineProperties(r.prototype,{messageId:{configurable:!0,enumerable:!0,get:function(){return this.zP}}});Object(A.a)(r,"MessageHandler",null,[980]);C.prototype.PN=function(za){this.callback=za;this.mag()};C.prototype.Dpf=function(za){this.EGc||(this.EGc=!0,this.Vmg=za,this.mag())};C.prototype.mag=function(){this.EGc&&this.callback&&
!this.R2d&&(this.R2d=!0,this.callback(this.Vmg))};Object(A.a)(C,"CompletionTask",null,[]);u.prototype.Bnc=function(za){this.xbe.PN(za)};u.prototype.Anc=function(za){this.vbe.PN(za)};u.prototype.KBb=function(za){this.xbe.Dpf(za)};u.prototype.Wxa=function(za){this.vbe.Dpf(za)};u.prototype.Pvd=function(){this.KBb(2);this.Wxa(2)};Object(A.a)(u,"MessageStatus",null,[979]);var ma=Sys.EventArgs;vm(z,ma);Object(A.a)(z,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var Ka=b(1134);B.prototype.start=function(){this.Cp=
new Date};B.prototype.stop=function(){this.uRc=new Date};Sk.Object.defineProperties(B.prototype,{Dc:{configurable:!0,enumerable:!0,get:function(){return this.Cp?this.uRc?this.uRc.getTime()-this.Cp.getTime():(new Date).getTime()-this.Cp.getTime():0}}});Object(A.a)(B,"SimpleStopwatch",null,[]);var Ta=b(1135),ob;(function(za){za[za.contentUpdate=0]="contentUpdate";za[za.editorsTableUpdate=1]="editorsTableUpdate";za[za.fileNameUpdate=2]="fileNameUpdate";za[za.wetContentUpdate=3]="wetContentUpdate";za[za.persistedContentUpdate=
4]="persistedContentUpdate";za[za.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";za[za.replicationTelemetry=6]="replicationTelemetry";za[za.lockUpdate=7]="lockUpdate";za[za.collabServiceContentUpdate=8]="collabServiceContentUpdate";za[za.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";za[za.saveTargetUpdate=10]="saveTargetUpdate";za[za.uploadToOcsUpdate=11]="uploadToOcsUpdate";za[za.labelUpdate=12]="labelUpdate";za[za.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";
za[za.subscribeOrExtend=14]="subscribeOrExtend";za[za.elapsedBootTelemetry=15]="elapsedBootTelemetry";za[za.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";za[za.clientToClientResponseMessage=17]="clientToClientResponseMessage";za[za.verifyNotificationPipeline=18]="verifyNotificationPipeline";za[za.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";za[za.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";za[za.last=21]="last"})(ob||(ob={}));Object(A.b)("UpdateNotificationType",
ob);vm(t,v);t.prototype.ARi=function(za,Ga){this.Lr=this.qug(Ga.hubConnection);this.cmb.reset();this.Lr.d$i(Object(fa.a)(this,this.lma,"onPresenceUpdated"));this.Lr.b$i(Object(fa.a)(this,this.Snc,"onPersistentStateUpdated"));this.Lr.a$i(Object(fa.a)(this,this.nBd,"onPersistentStateCleared"));this.Lr.E$i(Object(fa.a)(this,this.Aca,"onUpdateNotificationReceived"))};t.prototype.lW=function(za,Ga){this.Eda=Ga.newState;2===Ga.newState&&this.zoj()};t.prototype.zoj=function(){for(var za=yl(this.COc),Ga=
za.next();!Ga.done;Ga=za.next())Ga=Ga.value,this.Nda(null,new Ka.a(Ga.key,Ga.value,!1,new X.a));this.COc=new Ja.a};t.prototype.xRi=function(za,Ga){Ga.A0c();for(za=0;3>za;++za)this.joj(za,Ga)};t.prototype.joj=function(za,Ga){var cb=this;try{this.Lr.Zdd(za).done(function(Mb){Ga.ufb(Ga.t2c,"GetCompletePresenceSuccess")&&(Ga.E1g.OTi(),da.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",cb.Pl),cb.jh.g5i(),cb.NQi(za,Mb),cb.jh.J4i(Mb),Ga.qSe.xb(za)&&cb.jh.gMf(za,
Ga.qSe.oa(za),new X.a))}).fail(function(Mb){var Dc=b(841).RtcUtils;Ga.ufb(Ga.t2c,"GetCompletePresenceFail")&&(da.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}]",Dc.pOa(Mb),cb.Pl),cb.jh.Vqc())}).always(function(){Ga.stopwatch&&Ga.stopwatch.stop()})}catch(Mb){da.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",Ga.t2c,
Mb.message)}};t.prototype.JNd=function(za,Ga){var cb=this,Mb=b(841).RtcUtils;za=Ga.presence;var Dc=Ga.pea;this.KB.Ox(1,0);try{var vb=Mb.a0c(za,this.Rjb)}catch(ub){this.KB.Ox(1,3);da.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",ub.message);Dc.setException(ub);return}Mb=new ja.a;Mb.ia(this._clientId,Object.assign(new J,{Presence:za,TimeStamp:(new Date).getTime()}));this.jh.oMf(Ga.type,Mb);if(2!==this.Eda)this.Bp.fQa(),this.KB.Ox(1,2),
Dc.setResult(null);else{var ib=this.zP.toString();++this.zP;za=new r(function(){return cb.Boj(Ga.type,vb,ib)},ib);za=this.P9f(0,Ga.type).add(za);za.Bnc(function(ub){2===ub&&cb.KB.Ox(1,6);Dc.setResult(null)});za.Anc(function(){})}};t.prototype.Boj=function(za,Ga,cb){var Mb=this,Dc=null,vb=new B,ib=new u;da.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.Pl);if(2!==this.Eda)return this.Bp.fQa(),this.KB.Ox(1,2),da.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",
this.Pl),ib.Pvd(),ib;this.Ah&&20>this.sce&&(Dc=this.Ah.Hc("WebServiceCall","Send Presence Message"),this.sce++);vb.start();ib.KBb(1);try{this.Lr.updatePersistentState(za,Ga).done(function(){Mb.Bp.nHd();Mb.KB.Ox(1,1);da.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",cb,Mb.Pl);ib.Wxa(1);vb&&(vb.stop(),vb.Dc>Mb.Ae.kVf?Mb.KB.Ox(1,4):Mb.KB.Ox(1,5))}).fail(function(ub){var Eb=b(841).RtcUtils;Mb.lJa||(Mb.Bp.fQa(),Mb.KB.Ox(1,3),da.ULS.sendTraceTag(3249503,
500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",cb,Eb.pOa(ub),Mb.Pl));ib.Wxa(2)}).always(function(){Dc&&Dc.stop()})}catch(ub){da.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",ub.message),this.KB.Ox(1,3),ib.Wxa(2)}return ib};t.prototype.Seb=function(za,Ga){var cb=this;za=b(841).RtcUtils;var Mb=Ga.ZYg,Dc=Ga.pea;try{var vb=za.a0c(Mb,this.Rjb)}catch(ib){da.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",
ib.message);Dc.setException(ib);return}try{this.Lr.Seb(vb).done(function(){da.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(function(ib){var ub=b(841).RtcUtils;cb.lJa||da.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",ub.pOa(ib));Dc.setResult(null)})}catch(ib){da.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",ib.message),Dc.setResult(null)}};t.prototype.Nda=function(za,Ga){var cb=
this;za=b(841).RtcUtils;var Mb=Ga.type,Dc=Ga.a8,vb=Ga.Cdh,ib=Ga.pea;this.KB.Ox(0,0);try{var ub=za.a0c(Dc,this.Rjb)}catch(Ya){this.KB.Ox(0,3);da.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",Ya.message);ib.setException(Ya);return}if(2!==this.Eda)vb?this.COc.ia(Mb,Dc):(this.Bp.fQa(),this.KB.Ox(0,2)),ib.setResult(null);else{var Eb=this.zP.toString();++this.zP;Ga=new r(function(){return cb.Voj(Mb,ub,Eb)},Eb);Ga=this.P9f(1,Mb).add(Ga);
Ga.Bnc(function(Ya){2===Ya&&cb.KB.Ox(0,6);ib.setResult(null)});Ga.Anc(function(){})}};t.prototype.Voj=function(za,Ga,cb){var Mb=this,Dc=null,vb=new B,ib=new u;da.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.Pl);if(2!==this.Eda)return this.Bp.fQa(),this.KB.Ox(0,2),da.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.Pl),ib.Pvd(),ib;this.Ah&&3===za&&20>this.tce&&(Dc=this.Ah.Hc("WebServiceCall","Send WetContent Update"),this.tce++);
vb.start();ib.KBb(1);this.Lr.Nda(za,Ga).done(function(){Mb.Bp.nHd();Mb.KB.Ox(0,1);da.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",cb,Mb.Pl);ib.Wxa(1);vb&&(vb.stop(),vb.Dc>Mb.Ae.kVf?Mb.KB.Ox(0,4):Mb.KB.Ox(0,5))}).fail(function(ub){var Eb=b(841).RtcUtils;Mb.lJa||(Mb.Bp.fQa(),Mb.KB.Ox(0,3),da.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",cb,Eb.pOa(ub),Mb.Pl));ib.Wxa(2)}).always(function(){Dc&&
Dc.stop()});return ib};t.prototype.wv=function(){this.Lr.yQj(Object(fa.a)(this,this.lma,"onPresenceUpdated"));this.Lr.xQj(Object(fa.a)(this,this.Snc,"onPersistentStateUpdated"));this.Lr.wQj(Object(fa.a)(this,this.nBd,"onPersistentStateCleared"));this.Lr.GQj(Object(fa.a)(this,this.Aca,"onUpdateNotificationReceived"))};t.prototype.yOi=function(za,Ga){this.lma(Ga.bP,Ga.K3)};t.prototype.lma=function(za){this.Bp.wGb();this.Snc(0,za)};t.prototype.xOi=function(za,Ga){this.Snc(Ga.type,Ga.bP)};t.prototype.NQi=
function(za,Ga){var cb={},Mb;for(Mb in Ga)cb[Mb]=Ga[Mb].Presence;this.yBf(za,cb,Ga)};t.prototype.Snc=function(za,Ga){this.Bp.wGb();this.yBf(za,Ga)};t.prototype.yBf=function(za,Ga,cb){cb=void 0===cb?null:cb;var Mb=b(841).RtcUtils;if(da.ULS.Yda(500,100))for(var Dc in Ga);delete Ga[this._clientId];if(!hc.a.isEmpty(Ga)){for(var vb in Ga)Dc=vb,Ga[Dc]=Mb.deserialize(Ga[vb],"Presence",Dc,!1,this.Rjb);Mb=new ja.a;vb=(new Date).getTime();for(var ib in Ga){Dc=Ga[ib];var ub=ib;if(cb){var Eb=cb[ub];Eb.Presence=
Dc}else Eb=Object.assign(new J,{Presence:Dc,TimeStamp:vb});Mb.ia(ub,Eb)}this.jh.oMf(za,Mb);switch(za){case 0:this.Pae||(da.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Pl),this.Pae=!0,ea.AFrameworkApplication.dg&&ea.AFrameworkApplication.dg.dzi());this.jh.ZLf(Ga,[]);break;default:this.jh.a5i(za,Ga)}}};t.prototype.wOi=function(za,Ga){this.nBd(Ga.X0c)};t.prototype.nBd=function(za){this.Bp.wGb();if(da.ULS.Yda(500,100))for(var Ga=0;Ga<za.length;++Ga);za.length&&
(this.jh.u5i(za),this.jh.$4i(za),this.jh.ZLf({},za))};t.prototype.zOi=function(za,Ga){this.Aca(Ga.type,Ga.a8)};t.prototype.Aca=function(za,Ga){Ga=void 0===Ga?null:Ga;this.Ae.syj&&0===za&&da.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(0===za){var cb=ea.AFrameworkApplication.ga.Ua("OwningFeatureCrewForRtcNotificationKpis");if(cb&&0<cb.length){var Mb=new Map;Mb.set("AreaName","RealTimeCoauth");Mb.set("FeatureName","RtcNotification");Mb.set("SkipAria","True");
jb.Health.instance.recordKpiUsage("ContentUpdateNotificationReceived",0,cb,Mb)}}this.Ae.tyj&&13===za&&da.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",Ga||"<none>"));this.Bp.wGb();5===za?(Ga=(za=this.mYi(Ga))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",za.reason,za.reconnectDelay):"Received client reconnection request from the server without params.",da.ULS.sendTraceTag(18637071,
500,50,Ga),this.jh.Vqc(za)):(Ga=b(841).RtcUtils.deserialize(Ga,String.format("UpdateNotification-{0}",ob[za]),null,!1,this.Rjb),this.jh.t5i(za,Ga))};t.prototype.mYi=function(za){try{if(!za||""===za)return null;var Ga=JSON.parse(za);return new z(Ga[Ta.a.gMd],Ga[Ta.a.bkj],Ga[Ta.a.dkj],Ga[Ta.a.yNd])}catch(cb){return da.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",cb.message),null}};t.prototype.P9f=function(za,Ga){return this.cmb.H_h(this.I_h(za,Ga))};t.prototype.I_h=function(za,
Ga){return za+","+Ga};Object(A.a)(t,"RtcMessageHandler",v,[]);var Cb=b(93);y.prototype.pHd=function(){0<this.$Ea&&0<this.Rhb&&da.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.Q9f,this.Rhb,this.$Ea);0<this.$Ea&&0<this.bmb&&da.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.Q9f,this.bmb,this.$Ea)};y.prototype.rwc=function(za,Ga){this.bmb++;this.bqb(!0);this.bLc=!0;this.KWb=za;this.PXa=Ga};y.prototype.bqb=function(za){this.bLc=
!1;this.PXa&&za&&(this.Rhb++,this.PXa.Pvd());this.PXa=this.KWb=null};y.l6c=function(za,Ga){return window.setTimeout(za,Ga)};Sk.Object.defineProperties(y.prototype,{y6a:{configurable:!0,enumerable:!0,get:function(){return this.bLc}}});Object(A.a)(y,"ThrottlerBase",null,[]);vm(x,y);x.prototype.add=function(za){this.uWa||this.init(x.nHe,x.hHe);this.$Ea++;var Ga=new u;this.y6a?this.rwc(za,Ga):this.$Tb<this.y8a?this.aJb(za,Ga):(this.rwc(za,Ga),this.tWa=!1);return Ga};x.prototype.aJb=function(za,Ga){var cb=
this;za=this.Jge(za);var Mb=this.setTimeout(Object(fa.a)(this,this.JPi,"onMessageWaitTimeExpired"),this.kBa);++this.$Tb;Array.add(this.NWb,Mb);var Dc=this.HQb;za.Bnc(function(vb){Ga.KBb(vb)});za.Anc(function(vb){cb.HQb===Dc&&(cb.IPi(Dc,Mb),Ga.Wxa(vb))})};x.prototype.IPi=function(za,Ga){this.HQb===za&&(--this.$Tb,this.clearTimeout(Ga),Array.remove(this.NWb,Ga),this.y6a&&this.Koj())};x.prototype.Koj=function(){this.y6a&&!this.tWa&&(this.cSc=this.setTimeout(Object(fa.a)(this,this.Loj,"sendThrottledMessageFromTimer"),
0),this.tWa=!0)};x.prototype.Loj=function(){this.tWa=!1;if(this.y6a){var za=this.KWb,Ga=this.PXa;this.bqb(!1);this.aJb(za,Ga)}};x.prototype.JPi=function(){++this.TQb;this.TQb>Math.floor(this.y8a/2)&&(this.TQb=-1E9,this.rb.raiseEvent("TMUDM"))};x.prototype.iZb=function(za){this.rb.addHandler("TMUDM",za)};x.prototype.reset=function(){this.$Ea=this.bmb=this.Rhb=this.TQb=0;++this.HQb;for(var za=yl(this.NWb),Ga=za.next();!Ga.done;Ga=za.next())this.clearTimeout(Ga.value);this.$Tb=0;this.NWb=[];this.bqb(!0);
this.tWa&&(this.clearTimeout(this.cSc),this.cSc=0,this.tWa=!1)};x.prototype.init=function(za,Ga){this.uWa||(this.kBa=za,this.y8a=Ga,this.uWa=!0)};x.createInstance=function(za,Ga){return new x(za,void 0===Ga?"":Ga)};x.Z5c=function(za){window.clearTimeout(za)};x.nHe=15E3;x.hHe=5;Object(A.a)(x,"MaxOutstandingThrottler",y,[978,977]);vm(f,y);f.prototype.init=function(za){this.uWa||(this.E8a=za,this.uWa=!0)};f.prototype.add=function(za){this.uWa||this.init(f.YGe);this.$Ea++;var Ga=this.currentTime(),cb=
new u;this.tjb>Ga&&(this.tjb=Ga);this.y6a?(this.bqb(!0),this.rwc(za,cb)):this.tjb+this.E8a<=Ga?this.aJb(za,cb):(this.rwc(za,cb),this.setTimeout(Object(fa.a)(this,this.Joj,"sendThrottledMessage"),this.tjb+this.E8a-Ga));return cb};f.prototype.Joj=function(){if(this.y6a){var za=this.KWb,Ga=this.PXa;this.bqb(!1);this.aJb(za,Ga)}};f.prototype.aJb=function(za,Ga){this.tjb=this.currentTime();za=this.Jge(za);za.Bnc(function(cb){Ga.KBb(cb)});za.Anc(function(cb){Ga.Wxa(cb)})};f.createInstance=function(za,Ga){return new f(za,
void 0===Ga?"":Ga)};f.YGe=200;Object(A.a)(f,"MaxRateThrottler",y,[976,977]);m.prototype.AEe=function(za,Ga){return x.createInstance(za,void 0===Ga?"":Ga)};m.prototype.L7g=function(za,Ga){return f.createInstance(za,void 0===Ga?"":Ga)};Object(A.a)(m,"ThrottlerFactory",null,[966]);var eb=b(1136);n.prototype.init=function(za){this.Ww||(this.Ae=za,this.XVa.init(this.Ae.kBa,this.Ae.h2h),this.Ww=!0)};n.prototype.H_h=function(za){var Ga=this;this.Ww||this.init(new eb.a(f.YGe,x.nHe,x.hHe,n.Vzi));if(!function(){var vb=
Ga.dNc.Gc(za);Dc=vb.value;return vb}().returnValue){if(!function(){var vb=Ga.cNc.Gc(za);Mb=vb.value;return vb}().returnValue){var cb="MaxOutstandingThrottler-"+za;var Mb=this.dSc.AEe(Object(fa.a)(this.XVa,this.XVa.add,"add"),cb);Mb.init(this.Ae.kBa,this.Ae.Uzi);Mb.iZb(function(){Ga.rb.raiseEvent("TMUDM")});this.cNc.add(za,Mb)}cb="MaxRateThrottler-"+za;var Dc=this.dSc.L7g(Object(fa.a)(Mb,Mb.add,"add"),cb);Dc.init(this.Ae.XAi);this.dNc.add(za,Dc)}return Dc};n.prototype.reset=function(){for(var za=yl(this.dNc),
Ga=za.next();!Ga.done;Ga=za.next())Ga.value.value.pHd();za=yl(this.cNc);for(Ga=za.next();!Ga.done;Ga=za.next())Ga=Ga.value,Ga.value.pHd(),Ga.value.reset();this.XVa.pHd();this.XVa.reset()};n.prototype.iZb=function(za){this.rb.addHandler("TMUDM",za)};n.Vzi=1E3;Object(A.a)(n,"ThrottlerManager",null,[965]);var ya;(function(za){za[za.unspecified=0]="unspecified";za[za.word=1]="word";za[za.excel=2]="excel";za[za.powerPoint=3]="powerPoint";za[za.test=4]="test";za[za.wacFrontEnd=5]="wacFrontEnd";za[za.oneNote=
6]="oneNote";za[za.visio=7]="visio";za[za.officeMobile=8]="officeMobile";za[za.cosmosDBChangefeed=9]="cosmosDBChangefeed";za[za.last=10]="last"})(ya||(ya={}));Object(A.b)("RtcClientAppName",ya);b.d(F,"RealtimeChannel",function(){return a});a.prototype.init=function(){var za=this;this.jh.NGg(Object(fa.a)(this,this.i6b,"disconnectAndCreateNewConnection"));this.jh.FHg(Object(fa.a)(this,this.TUi,"onUpdatePersistentStateRequestReceivedInternal"));this.jh.EHg(Object(fa.a)(this,this.SUi,"onUpdatePersistentStateClearedRequestReceived"));
this.Tg.vUc(this.Bp);ea.AFrameworkApplication.MLb(function(){za.Bp.qHd();Ha.a.instance&&Ha.a.instance.nud()});this.IEe();this.Dfh();this.jh.gHg(Object(fa.a)(this,this.RRj,"updateConnectionQueryString"))};a.prototype.Dfh=function(){try{var za=$.signalR;if(!za)throw Error.invalidOperation("Failed to retrieve Signalr object");var Ga=za.version;if(!Ga)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===Ga){var cb=za.transports;if(!cb)throw Error.invalidOperation("Failed to retrieve transports object");
var Mb=cb.longPolling;if(!Mb)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!Mb.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");Mb.supportsKeepAlive=this.g$g()}}catch(Dc){da.ULS.sendTraceTag(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",Dc.message)}};a.prototype.g$g=function(){return function(){return!1}};a.prototype.IEe=function(){var za=this,Ga=++this.khb;this.$Lc=(new Date(0)).getTime();
this.sP=this.Ymg();this.jh.e5i(this.sP);this.sP.stateChanged(function(cb){za.nJi(cb,Ga)});this.sP.connectionSlow(Object(fa.a)(this,this.CTi,"onSlowConnection"));this.sP.error(Object(fa.a)(this,this.tTi,"onSignalRError"));this.sP.log=Object(fa.a)(this,this.uTi,"onSignalRLog")};a.prototype.ufb=function(za,Ga){return za!==this.khb?(da.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",Ga),!1):!0};a.prototype.connect=function(){2!==this.XL&&1!==this.XL&&(da.ULS.sendTraceTag(4539721,
500,50,"Starting a new RTC connection for client [{0}]",this.Pl),this.FGc.lJi(),Xa.a.instance.iGj(),this.lW(1,this.XL),this.p6f())};a.prototype.p6f=function(){var za=this.khb;this.tRc=!1;this.Bp.ENf();this.qpa.bYh(Object(fa.a)(this,this.z1g,"connectSignalrConnection"),Object(fa.a)(this,this.Sxf,"onFailureToConnect"),Object(fa.a)(this.$za,this.$za.lai,"initThrottlerManager"),Object(fa.a)(this,this.ufb,"verifyConnectionToken"),za)};a.prototype.Sxf=function(za){za=void 0===za?null:za;this.Bp.GNf();var Ga=
null;!za||"documentsessiondeleted"!==(Ga=za.toLowerCase())&&"documentsessionexpired"!==Ga?this.i6b():(da.ULS.sendTraceTag(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Pl,za),this.disconnect())};a.prototype.i6b=function(za,Ga){Ga=void 0===Ga?null:Ga;da.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.y8);za=(za=2===this.XL||1===this.XL)&&!this.$za.lJa;var cb=!0,Mb=0;Ga&&Object.getType(Ga)!==
Object.getType(Sys.EventArgs.Empty)&&Ga.lKd&&""!==Ga.lKd&&(za=!0,this.qpa.Utj(Ga.lKd),cb=Ga.yNd,Mb=Ga.reconnectDelay);za&&this.lW(1,this.XL);++this.khb;this.$za.wv();this.iHj(cb);this.qpa.Cgh();this.IEe();za&&window.setTimeout(Object(fa.a)(this,this.p6f,"startConnecting"),Math.min(Mb,3E4))};a.prototype.RRj=function(){var za=this.qpa.n_e();var Ga=za.correlationId;this.sP.qs=za.returnValue;da.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",
this.Pl,Ga)};a.prototype.z1g=function(za){var Ga=this;this.$Lc=(new Date).getTime();var cb=null;this.sP.qs=function(){var Dc=Ga.qpa.n_e();cb=Dc.correlationId;return Dc}().returnValue;this.Ae.eJg&&(this.sP.url=za,Ha.a.instance&&(Ha.a.instance.XBe=qa.a.YM(za)));var Mb=null;this.Ah&&(Mb=this.Ah.Hc("WebServiceCall","ConnectToServer"));da.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Pl);za={};this.TWb&&(za.transport=1===this.TWb.length?this.TWb[0]:this.TWb);za.pingInterval=
null;Xa.a.instance.vGb(1,0);za.waitForPageLoad=!1;this.sP.start(za,null).done(function(Dc){Ga.Bp.HNf();Xa.a.instance.vGb(1,1,!0);da.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",Dc.id,cb)}).fail(function(Dc){var vb=b(841).RtcUtils;da.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1}, callback parameter:{2} for [{3}]",Ga.qpa.iC,cb,vb.pOa(Dc),Ga.Pl);Ga.Sxf();Ga.Bp.FNf(Dc);Xa.a.instance.vGb(1,
1,!1);vb={};Ga.jh.dMf(0,(vb.CorrelationId=cb,vb.ErrorDetails=Dc,vb.ConnectionState=ca.a[Ga.XL],vb))}).always(function(){Mb&&Mb.stop();Ha.a.instance&&(Ha.a.instance.XHc=!1)})};a.prototype.disconnect=function(){0===this.XL?da.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Pl):(this.Bp.KNf(),Ha.a.instance&&(Ha.a.instance.XHc=!0),da.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Pl),this.$za.lJa=!0,this.FGc.lKi(),
this.lW(0,this.XL),this.i6b(),this.$za.lJa=!1)};a.prototype.iHj=function(za){function Ga(){if(cb.tRc)da.ULS.sendTraceTag(591692192,500,15,"Stop connection was called twice, possibly on the same connection.");else try{cb.tRc=!0,Dc.stop(!0,za)}catch(ib){da.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",ib.message)}}var cb=this,Mb=this.dUg(),Dc=this.sP,vb=this.y8;0<Mb?(da.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",vb,Mb),window.setTimeout(Ga,Mb)):
(da.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",vb),Ga())};a.prototype.dUg=function(){var za=0;0===this.sP.state&&(za=this.$Lc+a.TXj-(new Date).getTime(),0>za&&(za=0));return za};a.prototype.GYa=function(za){this.jh.GYa(za)};a.prototype.wsc=function(za){this.jh.wsc(za)};a.prototype.jYf=function(za){this.JNd(0,za)};a.prototype.JNd=function(za,Ga){var cb=new X.a;this.jh.gMf(za,Ga,cb);return cb.task};a.prototype.IFa=function(za){this.jh.IFa(za)};a.prototype.Oza=function(za){this.jh.Oza(za)};
a.prototype.Zvb=function(za){return this.L0h(za)};a.prototype.udd=function(){return this.VJh()};a.prototype.VJh=function(){for(var za={},Ga=yl(this.EG),cb=Ga.next();!cb.done;cb=Ga.next())cb=cb.value,cb.value.xb(0)&&(za[cb.key]=cb.value.oa(0).data);return za};a.prototype.L0h=function(za){return this.EG.xb(za)&&this.EG.oa(za).xb(0)?this.EG.oa(za).oa(0).data:null};a.prototype.TUi=function(za,Ga){za=yl(Ga.dVj);for(var cb=za.next();!cb.done;cb=za.next()){cb=cb.value;this.EG.xb(cb.key)||this.EG.ia(cb.key,
new Ja.a);var Mb=cb.value;this.EG.oa(cb.key).ia(Ga.type,new T(Mb.Presence,new Date(Mb.TimeStamp)));cb.key===this._clientId&&0===Ga.type&&this.jh.T4i(Mb.Presence)}};a.prototype.SUi=function(za,Ga){za=yl(Ga.X0c);for(Ga=za.next();!Ga.done;Ga=za.next())this.EG.remove(Ga.value)};a.prototype.UJh=function(){var za=new Ja.a;if(!this.EG.xb(this._clientId))return za;for(var Ga=yl(this.EG.oa(this._clientId)),cb=Ga.next();!cb.done;cb=Ga.next())cb=cb.value,za.ia(cb.key,cb.value.data);return za};a.prototype.Nda=
function(za,Ga,cb){Ga=void 0===Ga?null:Ga;cb=void 0===cb?!1:cb;var Mb=new X.a;this.jh.oGd(za,Ga,cb,Mb);return Mb.task};a.prototype.NYa=function(za){this.jh.NYa(za)};a.prototype.xHb=function(za){this.jh.xHb(za)};a.prototype.Gva=function(za){var Ga=this,cb,Mb;return function(){var Dc=Ga.EG.Gc(za);cb=Dc.value;return Dc}().returnValue&&function(){var Dc=cb.Gc(0);Mb=Dc.value;return Dc}().returnValue?new K(this.P0h(Mb),Mb.timeStamp):null};a.prototype.$Jh=function(){for(var za={},Ga={},cb=yl(this.EG),Mb=
cb.next();!Mb.done;Ga={Wfb:Ga.Wfb,DDc:Ga.DDc},Mb=cb.next())Ga.Wfb=Mb.value,Ga.DDc=void 0,function(Dc){return function(){var vb=Dc.Wfb.value.Gc(0);Dc.DDc=vb.value;return vb}}(Ga)().returnValue&&(za[Ga.Wfb.key]=this.Gva(Ga.Wfb.key));return za};a.prototype.Seb=function(za){var Ga=new X.a;this.jh.s5i(za,Ga);return Ga.task};a.prototype.dispose=function(){this.yt||(this.$za.wv(),this.Tg.Saj(this.Bp),this.Bp.qHd(),Ha.a.instance&&Ha.a.instance.nud(),this.yt=!0)};a.prototype.nJi=function(za,Ga){this.ufb(Ga,
"StateChangedSignalR")&&this.lW(this.MCe(za.newState),this.MCe(za.oldState))};a.prototype.lW=function(za,Ga){if((1!==this.XL||0!==Ga||1!==za)&&this.XL!==Ga){var cb=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.XL,Ga,za]));da.ULS.sendTraceTag(3290053,500,10,cb)}if(this.XL!==za){switch(za){case 2:Ha.a.instance&&Ha.a.instance.gzi();this.y8=this.sP.id;da.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",
this.y8,this.Pl);this.cxi(this.sP);da.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");cb=null;this.Ah&&(cb=this.Ah.Hc("WebServiceCall","Receive First Presence"));var Mb=this.khb;this.jh.d5i(Object(fa.a)(this,this.ufb,"verifyConnectionToken"),Mb,this.FGc,Object(fa.a)(this,this.A0c,"clearExistingPersistentState"),this.UJh(),cb);this.Ae.rtcClientMessageTelemetryEnabled&&H.fgd(this.jh,this.Ae,100*Math.random()<=this.Ae.ckj).start();break;case 1:2===Ga&&da.ULS.sendTraceTag(4298644,
500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.y8);break;case 0:if(H.instance&&H.instance.stop(),this.$za.lJa)da.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.y8);else{1===Ga&&(da.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.y8),this.Bp.LNf());2===Ga&&da.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",
this.y8);this.i6b();return}}this.XL=za;this.jh.u4i(za,Ga)}};a.prototype.cxi=function(za){if(za&&za.transport&&za.transport.name){za=za.transport.name;var Ga=za.toLowerCase();"websockets"===Ga?da.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",za,this.Pl):"serversentevents"===Ga?da.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",za,this.Pl):"foreverframe"===Ga?da.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",za,this.Pl):"longpolling"===Ga?da.ULS.sendTraceTag(4290754,
500,50,"Transport name - {0} for [{1}]",za,this.Pl):"mocktransport"!==Ga&&da.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",za)}else da.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")};a.prototype.CTi=function(){da.ULS.sendTraceTag(3249544,500,50,"Detected that the connection [{0}] is slow",this.y8)};a.prototype.tTi=function(){da.ULS.sendTraceTag(3249545,600,10,"SignalR ERROR for connection [{0}];",this.y8)};a.prototype.uTi=function(za){za=b(841).RtcUtils.pOa(za);
this.rDj&&2E3>this.zhe&&!za.startsWith("Invok")&&!za.startsWith("Trigger")&&(da.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",za),this.zhe++)};a.prototype.A0c=function(){var za=[],Ga=this.EG.Gc(this._clientId);var cb=Ga.value;Ga.returnValue&&this.EG.remove(this._clientId);var Mb=yl(this.EG.keys);for(Ga=Mb.next();!Ga.done;Ga=Mb.next())Array.add(za,Ga.value);Mb=yl(za);for(Ga=Mb.next();!Ga.done;Ga=Mb.next())this.EG.remove(Ga.value);cb&&this.EG.ia(this._clientId,cb);this.jh.P4i(za)};a.prototype.MCe=
function(za){switch(za){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",za,"Unknown SignalR state");}};a.prototype.P0h=function(za){return za&&za.timeStamp?(new Date).getTime()-za.timeStamp.getTime()>(this.Ae.DNg?6E4:this.Ae.CNg)?2:1:1};a.createInstance=function(za,Ga,cb,Mb,Dc,vb,ib,ub,Eb,Ya,tb,ec,Za){return l(za,Ga,cb,void 0===Za?null:Za,Mb,Dc,vb,ib,void 0===ub?null:ub,void 0===Eb?null:Eb,void 0===Ya?null:Ya,void 0===ec?null:ec,void 0===
tb?null:tb)};Sk.Object.defineProperties(a.prototype,{Akc:{configurable:!0,enumerable:!0,get:function(){return this.qpa.Akc},set:function(za){this.qpa.Akc=za}},$za:{configurable:!0,enumerable:!0,get:function(){return this.Cvg}},jh:{configurable:!0,enumerable:!0,get:function(){return this.ykg}},connectionState:{configurable:!0,enumerable:!0,get:function(){return this.XL}},clientId:{configurable:!0,enumerable:!0,get:function(){return this._clientId}},rDj:{configurable:!0,enumerable:!0,get:function(){return this.Bwg}}});
a.Ypf=31E3;a.Vvd=8E3;a.TXj=15E3;Object(A.a)(a,"RealtimeChannel",null,[284,948])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.cl.js.map/60324e75bd85e021fec526e00d4a1d3b/EwaDS.cl.js.map