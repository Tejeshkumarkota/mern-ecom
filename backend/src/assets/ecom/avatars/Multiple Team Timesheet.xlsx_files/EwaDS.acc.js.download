(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[29],{1375:function(A,F,b){function a(R){var Aa=Hi.call(this)||this;Aa.$=R;Aa.dc();return Aa}function c(R,Aa){var hb=Mg.call(this)||this;hb.tob=function(Ib,Bc){Ib=Bc.X4;var gc=hb.gridView;Bc=Bc.h8h;var Id=Bc.Cg,fe=Bc.h$;af.a.ah&&Array.add(fe,new C(Id,gc));switch(Ib){case 24:Array.add(Bc.h$,new z(Id,Bc));break;case 0:Array.add(Bc.h$,new r(Id,gc));af.a.Xp||Array.add(fe,new J(Id,hb.gridView.$,Bc.paneType,hb.tableManager,hb.Hp));
Array.add(fe,new e(Bc,Id,gc,Bc.paneType));break;case 3:Array.add(fe,new Q(Id));af.a.Xp||(Array.add(fe,new D(Id,hb.gridView.$,Bc.paneType,hb.Wx,hb.Hp,Bc)),Array.add(fe,new x(Id,hb.gridView,hb.Wx,hb.Hp,Bc)),Array.add(fe,new f(Id,hb.gridView,hb.Wx,hb.Hp,Bc)));break;case 4:case 5:Array.add(fe,new m(Id));break;case 30:Array.add(fe,new n(Id));break;case 16:Array.add(fe,new l(Id));Array.add(fe,new B(Bc,Id,gc,Bc.paneType));break;case 11:case 12:Array.add(fe,new t(Id,11===Ib));break;case 17:Array.add(fe,new Q(Id));
break;case 19:Array.add(fe,new Q(Id)),Array.add(fe,new la(Bc,Id,gc,Bc.paneType))}Bc.d0b=!0};hb.$=R;hb.gridView=ce.g(R);hb.tableManager=Aa;hb.Wx=new u(hb.gridView);hb.Hp=new S(hb.gridView);hb.gridView.Nb&&(hb.gridView.Nb.oFg(hb.tob),hb.gridView.Nb.update(!1));R.da.Ha(64,hb);return hb}function e(R,Aa,hb,Ib){return ba.call(this,R,Aa,hb,Ib)||this}function l(R){var Aa=H.call(this,R)||this;l.irb(R,cg.a.Wxh+" "+Te.a.tua);l.irb(R,cg.a.Vxh+" "+Te.a.tua);l.irb(R,cg.a.Sxh+" "+Te.a.tua);l.irb(R,cg.a.Uxh+" "+
Te.a.tua);l.irb(R,Te.a.Txh);return Aa}function n(R){var Aa=H.call(this,R)||this;appChrome.renderSpinner(R);return Aa}function m(R){var Aa=H.call(this,R)||this;m.Uqb(R,cg.a.Bxh+" "+Te.a.tua);m.Uqb(R,cg.a.Axh+" "+Te.a.tua);m.Uqb(R,cg.a.xxh+" "+Te.a.tua);m.Uqb(R,cg.a.zxh+" "+Te.a.tua);m.Uqb(R,Te.a.yxh);return Aa}function f(R,Aa,hb,Ib,Bc){var gc=y.call(this,R,Aa,hb,Ib,Bc)||this;gc.DDb=function(){var Id=3===Pf.a.$b;gc.xsd&&!Id?gc.Hp.QJb(gc.eba,gc.oL,!1):!gc.xsd&&Id&&gc.Hp.QJb(gc.eba,gc.oL,!0);gc.xsd=Id};
gc.PRi=function(Id,fe){fe.Cxb===gc.eba.y$&&gc.Hp.QJb(gc.eba,gc.oL,!fe.start&&gc.eRd())};Pf.a.doe(gc.DDb);gc.xsd=3===Pf.a.$b;gc.Hp.RFg(gc.PRi);return gc}function x(R,Aa,hb,Ib,Bc){return y.call(this,R,Aa,hb,Ib,Bc)||this}function y(R,Aa,hb,Ib,Bc){var gc=H.call(this,R)||this;gc.sL=null;gc.Ya=null;gc.y3=0;gc.sourceRange=null;gc.jd=null;gc.HSa=!1;gc.onPointerDown=function(Id){Id=qf.a(gc.$).He(Id);if(gc.C2f(Id)&&!gc.HSa){gc.Anf();gc.Ya=gc.Hp.hdd();gc.sL=gc.Hp.l3e(Id);if(!gc.Ya||!gc.sL||!gc.sL.range)return Tc.ULS.shipAssertTag(537159361,
0,!!gc.Ya,"ResizeMarqueeBehaviorBase.OnPointerDown: cellContentEditor is null"),Tc.ULS.shipAssertTag(537159360,0,!!gc.sL,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState is null"),Tc.ULS.shipAssertTag(537159331,0,!!gc.sL.range,"ResizeMarqueeBehaviorBase.OnPointerDown: selectedHighlightState.Range is null"),!1;gc.jd=gc.sL.range.clone();gc.sourceRange=gc.jd.clone();gc.y3=gc.r_e(Id);if(4===gc.y3)return Tc.ULS.shipAssertTag(537159330,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),
!1;var fe=gc.b1e(Id,!0);if(!fe)return Tc.ULS.shipAssertTag(537159329,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: mouseSelection is null. Not expect when clicking on handler."),!1;if(!gc.GEe(fe))return Tc.ULS.shipAssertTag(537159328,0,!1,"ResizeMarqueeBehaviorBase.OnPointerDown: currentFixedCorner is not valid"),!1;gc.gridView.zLa=!0;gc.Ya.iE(!1);gc.Wx.gKe(Id.Tb);gc.Hp.RLf(!0,gc.eba.y$);gc.Ya.textBox.removeSelection();gc.Ya.VYb(gc.b7e);gc.QOf();gc.HSa=!0;jg.b(gc.$,!0)}return!0};gc.b7e=function(){gc.D9b(!0)};
gc.gridView=Aa;gc.$=Aa.$;gc.oL=[];gc.ha=gc.gridView.ha;gc.Wx=hb;gc.Hp=Ib;gc.eba=Bc;gc.coloredReferencesManager=gc.$.da.Aa(281);Tc.ULS.shipAssertTag(537159362,0,!!gc.coloredReferencesManager,"ResizeMarqueeBehaviorBase Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");Aa=yl(gc.UTf());for(hb=Aa.next();!hb.done;hb=Aa.next())hb=gc.Hp.WDe(R,hb.value,gc.hpe(),gc.onPointerDown),Array.add(gc.oL,hb);R=yl(gc.oL);for(Aa=R.next();!Aa.done;Aa=R.next())Aa=Aa.value,
Hd.a.instance.qa(Ye.a.AW,Aa,Object(hd.a)(gc.Wx,gc.Wx.l$e,"hoveringStarted")),Hd.a.instance.qa(Ye.a.hy,Aa,Object(hd.a)(gc.Wx,gc.Wx.m$e,"hoveringStopped"));gc.WYa(Bc);return gc}function t(R,Aa){var hb=H.call(this,R)||this;var Ib=document.createElement("div"),Bc=document.createElement("div");Ib.className=Aa?U.Yxh:U.$xh;Bc.className=Aa?U.Zxh:U.Xxh;R.appendChild(Ib);R.appendChild(Bc);return hb}function B(R,Aa,hb,Ib){return ba.call(this,R,Aa,hb,Ib)||this}function z(R,Aa){var hb=H.call(this,R)||this;hb.HBf=
function(){if(!hb.Tu)return Tc.ULS.shipAssertTag(537159364,0,!1,"RangeCatchUpActivityHighlightBehavior.OnPointerEnter: highlightController is null"),!1;hb.Tu.hMf(hb.AH,!1);hb.Tu.XLe(hb.AH,!1);if(3===hb.Tu.model.state)return!0;hb.Tu.h$e(!0);return!0};hb.wca=function(){if(!hb.Tu)return!1;hb.Tu.z4i();hb.Tu.cLd(hb.AH,!1);if(3===hb.Tu.model.state)return!0;hb.Tu.h$e(!1);return!0};hb.onPointerDown=function(Ib){return hb.Tu?2===Ib.yb&&Ib.Kn===Sys.UI.MouseButton.leftButton?!0:!1:!1};hb.JDb=function(){if(!hb.Tu)return!1;
hb.Tu.cLd(hb.AH,!0);hb.Tu.hMf(hb.AH,!0);hb.Tu.XLe(hb.AH,!0);hb.Tu.RIb(!0);return!0};hb.onDoubleClick=function(Ib){if(Ib.Ea)return Ib.Ea.stopPropagation(),!0;Tc.ULS.sendTraceTag(537159363,0,50,"CatchUpActivityHighlightBehavior::OnDoubleClick Double click event handled on Pill.");return!0};hb.Tu=Object(xf.a)(Th.a,Aa.metadata);hb.nK=document.createElement("div");hb.nK.id=String.format("{0}-{1}",R.id,dd.a.yxe);hb.nK.className=Ef.a.HVg;hb.AH=document.createElement("div");hb.AH.id=String.format("{0}-{1}",
R.id,dd.a.x_c);hb.AH.className=Ef.a.x_c;hb.nK.appendChild(hb.AH);R.appendChild(hb.nK);Tc.ULS.sendTraceTag(537159365,0,50,"RangeCatchUpActivityHighlightBehavior::RangeCatchUpActivityHighlightBehavior: An activity indicator has been created.");Hd.a.instance.qa(Ye.a.AW,hb.nK,hb.HBf);Hd.a.instance.qa(Ye.a.hy,hb.nK,hb.wca);Hd.a.instance.qa(Ye.a.pointerDown,hb.nK,hb.onPointerDown);Pg.a.instance.qa(Ye.a.click,hb.nK,hb.JDb);Pg.a.instance.qa(Ye.a.hk,hb.nK,hb.onDoubleClick);return hb}function u(R){var Aa=this;
this.Yh=function(){Aa.Uod=!1};this.tr=function(){Aa.Uod=!0};this.gridView=R;this.i5a=0;this.Uod=this.vgc=!1;this.L5=Number.NaN;this.gridView.ha.O9(this.tr);this.gridView.ha.I2(this.Yh);this.gridView.ha.Ioe(this.Yh)}function C(R,Aa){var hb=H.call(this,R)||this;hb.JSi=function(Ib){var Bc=Fe.HelperMethods.Am(Ib),gc=hb.Jva.UZd(Ib.clientPoint);if(!gc)return!1;var Id=gc.qf,fe=hb.Jva.Ca.O3a(Id.hashCode).tja(gc.XI);if(!fe)return!1;Ib=Id.wj.domElement;gc=Fe.HelperMethods.Eme(Fe.HelperMethods.tKa(Id.domElement,
Ib),gc.XI);Id=0;fe=hb.Jva.uc(fe.getRange());for(var sf=0,hg=C.Nxe.length;sf<hg;++sf){var $f=C.Nxe[sf];if(128!==$f&&64!==$f||!hb.Jva.$.isEditMode){var th=fe.oKa($f);if(th&&th.G5a&&"none"!==th.G5a.style.display){th=th.G5a;var ji=Fe.HelperMethods.tKa(th,Ib);th=new Sys.UI.Bounds(ji.x,ji.y,th.offsetWidth,th.offsetHeight);if(ze.a.fB(th,gc)){Id=$f;break}}}}return 0!==Id?(fe.invoke(Id,Bc),!0):!1};hb.Opg=Aa;W.a.instance.qa(Ye.a.click,R,hb.JSi);return hb}function r(R,Aa){var hb=Q.call(this,R)||this;hb.Yh=function(){hb.domElement.classList.remove(U.selecting);
Bb.c(hb.gridView.$,!0,"FillHandleClickBehavior:OnSelectionEnded")};hb.tr=function(){hb.domElement.classList.add(U.selecting)};hb.onPointerDown=function(Ib){2===Ib.yb&&Ib.Kn===Sys.UI.MouseButton.leftButton&&(hb.gridView.ha.selectionType=4,hb.gridView.ha.sourceRange=hb.gridView.ha.va.Sd,Bb.c(hb.gridView.$,!1,"FillHandleClickBehavior:OnSelectionStarted"));return!1};hb.rca=function(){hb.gridView.$.xe(1983983164,2,30,null);return!0};hb.rd=function(){Ud.DOMElementExtensions.setVisible(hb.waa,hb.gridView.$.isEditMode)};
hb.z6=function(){Ud.DOMElementExtensions.setVisible(hb.waa,!1)};hb.y6=function(){Ud.DOMElementExtensions.setVisible(hb.waa,!0)};hb.czf=function(){Ud.DOMElementExtensions.setVisible(hb.waa,!1)};hb.bzf=function(){Ud.DOMElementExtensions.setVisible(hb.waa,!0)};hb.gDb=function(Ib,Bc){Ud.DOMElementExtensions.setVisible(hb.waa,!Bc.Zke)};hb.gridView=Aa;Aa=document.createElement("div");Aa.className=Te.a.Qxh;hb.waa=Aa;hb.rd(null,null);R.appendChild(Aa);Hd.a.instance.qa(Ye.a.pointerDown,hb.waa,hb.onPointerDown);
W.a.instance.qa(Ye.a.hk,hb.waa,hb.rca);hb.gridView.ha.O9(hb.tr);hb.gridView.ha.I2(hb.Yh);hb.gridView.$.Qk(hb.rd);hb.gridView.$.Ab.mZb(hb.z6);hb.gridView.$.Ab.lZb(hb.y6);hb.gridView.xne(hb.gDb);hb.gridView.pc.Yl(hb.czf);hb.gridView.pc.Mo(hb.bzf);return hb}function J(R,Aa,hb,Ib,Bc){var gc=V.call(this,R,Aa,hb,Bc)||this;gc.V6b=Pd.a.instance.fa(2199);gc.iKe=Pd.a.instance.fa(2200);gc.Lwc=Pd.a.instance.fa(2201);gc.Z1f=Pd.a.instance.fa(2202);gc.Fu=null;gc.cea=null;gc.xR=!1;gc.isRow=!1;gc.Sh=!1;gc.wR=!1;gc.DIa=
null;gc.YRa=null;gc.Tjf=0;gc.OJ=0;gc.onKeyDown=function(Id){if(gc.nr){if(gc.Kfc(Id)||Id.Ea.keyCode===va.a.pfb)return gc.cpd||(Fg.KeyInputManager.instance.qa(Ye.a.Wd,gc.domElement.ownerDocument.body,gc.onKeyUp),gc.cpd=!0),!gc.YZ&&gc.Kfc(Id)&&(ce.g(gc.$).Hh.hu(J.VCe),gc.YZ=!0),gc.ZZ||Id.Ea.keyCode!==va.a.pfb||(ce.g(gc.$).Hh.hu(V.B7c),gc.ZZ=!0,2===gc.OJ?(gc.Msa(!1),gc.m3=0,gc.Fu=gc.wR?[11]:[12],gc.xR=gc.wR,gc.RHd(),gc.GTa()):3===gc.OJ?(gc.Spb(!1),gc.m3=gc.isRow?1:2,gc.DGb(),gc.Z7()):1===gc.OJ&&(gc.q0c(!1),
gc.DGb(),gc.Z7())),!0}else if(!gc.YZ&&(Id.Ea.keyCode===va.a.LBa||af.a.isMac&&Id.Ea.keyCode===va.a.nfb))return Fg.KeyInputManager.instance.qa(Ye.a.Wd,gc.domElement.ownerDocument.body,gc.onKeyUp),ce.g(gc.$).Hh.hu(J.VCe),gc.YZ=!0;return!1};gc.onKeyUp=function(Id){if(gc.nr){if(gc.Kfc(Id)||Id.Ea.keyCode===va.a.pfb)return gc.Tjf=gc.Kfc(Id)?0:1,gc.JH&&ce.g(gc.$).Hh.hu(V.B7c),Id.Ea.keyCode===va.a.pfb&&(2===gc.OJ?(gc.Spb(!1),gc.m3=0,gc.DGb(!0),gc.Z7(!0)):3===gc.OJ?(gc.Msa(!1),gc.m3=gc.isRow?1:2,gc.Fu=gc.isRow?
[11]:[12],gc.RHd(!0),gc.GTa(!0)):1===gc.OJ&&(gc.Msa(!1),gc.Fu=gc.wR?[11]:[12],gc.VOf(!0),gc.GTa(!0))),gc.QAc(gc.Tjf),!0}else if(Id.Ea.keyCode===va.a.LBa||af.a.isMac&&Id.Ea.keyCode===va.a.nfb)return gc.QAc(),gc.JH&&ce.g(gc.$).Hh.hu(V.aKe),!0;return!1};gc.Q9a=function(Id){Id=qf.a(gc.$).He(Id);5===gc.Gu?gc.NBf(Id):(gc.JH=!1,gc.Nb.ll(gc.Fu),!gc.$.Ns([gc.jd],!1)||gc.r7i()||gc.jgf()||(gc.ha.sourceRange=gc.sourceRange.clone(),gc.nr?gc.L2i():gc.lSe(),gc.E5()?gc.jd.top>gc.sourceRange.top&&(Id=gc.jd.height,
gc.jd.top-=Id,gc.jd.bottom-=Id):gc.jd.left>gc.sourceRange.left&&(Id=gc.jd.width,gc.jd.left-=Id,gc.jd.right-=Id),gc.Sda()));gc.CM(gc.N9a,gc.Q9a);gc.tableRange=null;gc.Gu=-1;gc.nr&&(gc.cea=null,gc.OJ=0);return!0};gc.XDb=function(){gc.JH=!1;gc.OJ=0;gc.Nb.ll(gc.Fu);if(!gc.$.Ns([gc.jd],!1))return gc.CM(gc.WDb,gc.XDb),gc.Gu=-1,!0;if(!(gc.ha.va.Sd.equals(gc.jd)||gc.Uec(gc.jd)||gc.Uec(gc.sourceRange)||gc.jgf())){gc.Sda();gc.ha.sourceRange=gc.sourceRange.clone();var Id=gc.ha.sourceRange,fe=gc.ha.va.Sd,sf=
{};gc.$.xe(-694765314,2,30,(sf[dd.a.jsb]=gc.YZ,sf[dd.a.w7c]=!0,sf[dd.a.A7c]=gc.xR,sf[dd.a.Wta]=Id,sf[dd.a.Vta]=fe,sf[dd.a.x7c]=gc.ZZ,sf));gc.YZ||(gc.jd.top>gc.sourceRange.top&&(gc.isRow||gc.jd.left===gc.sourceRange.left&&gc.xR)?(Id=gc.jd.height,gc.jd.top-=Id,gc.jd.bottom-=Id):gc.jd.left>gc.sourceRange.left&&(gc.Sh||gc.jd.top===gc.sourceRange.top&&!gc.xR)&&(Id=gc.jd.width,gc.jd.left-=Id,gc.jd.right-=Id),gc.Sda())}gc.CM(gc.WDb,gc.XDb);gc.tableRange=null;gc.cea=null;gc.Gu=-1;gc.xR=!1;return!0};gc.N9a=
function(Id){var fe=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");fe&&(Id=qf.a(gc.$).He(Id));var sf=Id.clientPoint;fe||(Id=qf.a(gc.$).He(Id));gc.nr&&(gc.Mca=Id);if(Id=gc.ha.xr(sf,Id.Tb,5,void 0,void 0,!0)){if(gc.tableRange.contains(Id.topLeft)){fe=ce.g(gc.$);var hg=fe.pg(Id),$f=fe.Sf(gc.paneType);sf=Ug.a.nu($f.view.Sg,gc.domElement.parentNode,sf,fe.rtl);$f=!1;var th=2;gc.E5()&&sf.y-hg.topLeft.y>hg.height/2?($f=!0,th=1):!gc.E5()&&sf.x-hg.topLeft.x>hg.width/
2&&($f=!0);if($f){fe=fe.xl("DragSelectionClickBehavior.OnPointerMoveRearrange",fe.mH,th);try{fe.Zu(Id),fe.$$mn(),Id=fe.$$cu().range}finally{fe&&fe.dispose()}}gc.jd=gc.EZc(Id);gc.ha.sourceRange=gc.jd;gc.Nb.Nl(gc.jd,gc.Fu);gc.Nb.ys(gc.Fu);gc.Nb.ll(gc.Dja());if(6!==gc.Gu){for(Id=1;4>=Id;Id++)fe=gc.Go[Id.toString()],fe.parentNode.removeChild(fe),gc.Nb.ZE(gc.E5()?11:12,Id).Cg.appendChild(fe);gc.Gu=6}}else if(gc.jd=gc.vpb(Id),gc.nr)gc.A6e(!1);else if(gc.Nb.Nl(gc.jd,gc.Dja()),gc.Nb.ys(gc.Dja()),gc.Nb.ll(gc.Fu),
5!==gc.Gu){for(Id=1;4>=Id;Id++)fe=gc.Go[Id.toString()],fe.parentNode.removeChild(fe),gc.Nb.ZE(gc.Gac(),Id).Cg.appendChild(fe);gc.Gu=5}gc.lX()}return!0};gc.WDb=function(Id){var fe=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5719921_FixDragAndDropCTTableRowOnZoom");fe&&(Id=qf.a(gc.$).He(Id));var sf=Id.clientPoint;fe||(Id=qf.a(gc.$).He(Id));gc.Mca=Id;if(fe=gc.ha.xr(sf,Id.Tb,5,void 0,void 0,!0)){if(gc.i8e(fe))return gc.jd=gc.vpb(fe),gc.z6e(!1),!0;var hg=ce.g(gc.$),$f=hg.pg(fe),th=hg.Sf(gc.paneType);
sf=Ug.a.nu(th.view.Sg,gc.domElement.parentNode,sf,hg.rtl);th=!1;var ji=2;gc.xR=!1;if(gc.isRow||gc.Sh){gc.isRow&&sf.y-$f.topLeft.y>$f.height/2?(th=!0,ji=1):gc.Sh&&sf.x-$f.topLeft.x>$f.width/2&&(th=!0);if(th){Id=hg.xl("DragSelectionClickBehavior.OnPointerMoveDragInsert",hg.mH,ji);try{Id.Zu(fe),Id.$$mn(),fe=Id.$$cu().range}finally{Id&&Id.dispose()}}gc.jd=gc.vpb(fe)}else{sf.x-$f.topLeft.x===$f.width?(gc.xR=!1,th=!0):sf.y-$f.topLeft.y>$f.height/2&&(th=!0,gc.xR=!0,ji=1);gc.cea&&(gc.xR=gc.wR);if(th){hg=
hg.xl("DragSelectionClickBehavior.OnPointerMoveDragInsert",hg.mH,ji);try{hg.Zu(fe),hg.$$mn(),fe=hg.$$cu().range}finally{hg&&hg.dispose()}}gc.Nb.ll(gc.Fu);gc.Fu=gc.xR?[11]:[12];for(hg=1;4>=hg;hg++)($f=gc.Go[hg.toString()])&&$f.parentNode.removeChild($f),gc.Go[hg.toString()]=null;gc.Gna(Id.clientPoint,Id.Tb,gc.xR?11:12,!0);gc.jd=gc.EZc(fe)}gc.ha.sourceRange=gc.jd;gc.Nb.Nl(gc.jd,gc.Fu);gc.Nb.ys(gc.Fu);gc.Nb.ll(gc.Dja());if(6!==gc.Gu){for(Id=1;4>=Id;Id++)fe=gc.Go[Id.toString()],fe.parentNode.removeChild(fe),
gc.Nb.ZE(gc.isRow||gc.xR?11:12,Id).Cg.appendChild(fe);gc.Gu=6}gc.lX()}return!0};gc.Yh=function(){gc.domElement.classList.remove(U.selecting)};gc.tr=function(){gc.domElement.classList.add(U.selecting)};gc.nd=function(){if(gc.$.isEditMode){var Id=gc.pzj();gc.wOd(Id)}};gc.qDf=function(){gc.nr?gc.JH&&5<=gc.Gu&&(gc.tableRange?gc.ZZ?gc.Msa(!0):gc.q0c(!0):gc.ZZ?gc.isRow||gc.Sh?gc.Msa(!0):gc.Spb(!0):gc.isRow||gc.Sh?gc.Spb(!0):gc.Msa(!0)):gc.JH&&5<=gc.Gu&&(gc.tableRange?(gc.Nb.ll(gc.Fu),gc.CM(gc.N9a,gc.Q9a)):
(gc.Nb.ll(gc.Dja()),gc.CM(Object(hd.a)(gc,gc.qj,"onPointerMove"),Object(hd.a)(gc,gc.Og,"onPointerUp"))))};gc.tableManager=Ib;gc.tableRange=null;gc.Go={};gc.JH=!1;gc.YZ=!1;gc.ZZ=!1;gc.cpd=!1;gc.ha.O9(gc.tr);gc.ha.I2(gc.Yh);gc.ha.Ioe(gc.qDf);gc.ha.NG(gc.nd);return gc}function v(R,Aa){this.destinationRange=this.sourceRange=null;this.sourceRange=R;this.destinationRange=Aa}function D(R,Aa,hb,Ib,Bc,gc){var Id=V.call(this,R,Aa,hb,Bc)||this;Id.sL=null;Id.Ya=null;Id.a7e=function(){Id.W8b(!0)};Id.gridView=
ce.g(Id.$);Id.Wx=Ib;Id.coloredReferencesManager=Id.$.da.Aa(281);Tc.ULS.shipAssertTag(537159391,0,!!Id.coloredReferencesManager,"DragMarqueeClickBehavior Ctor: coloredReferencesManager is null. We already have marquee highlights so it shouldn't happen.");R=yl(Id.vC);for(Aa=R.next();!Aa.done;Aa=R.next())Aa=Aa.value,Hd.a.instance.qa(Ye.a.AW,Aa,Object(hd.a)(Id.Wx,Id.Wx.l$e,"hoveringStarted")),Hd.a.instance.qa(Ye.a.hy,Aa,Object(hd.a)(Id.Wx,Id.Wx.m$e,"hoveringStopped"));Id.WYa(gc);return Id}function V(R,
Aa,hb,Ib){var Bc=Q.call(this,R)||this;Bc.HSa=!1;Bc.Wke=null;Bc.Vke=null;Bc.Hra=0;Bc.nr=ac.EwaSettings.getBooleanFeatureGate(dg.a.S6b,!1);Bc.m3=0;Bc.qkd=0;Bc.PZd=0;Bc.Fma=null;Bc.sourceRange=null;Bc.jd=null;Bc.Mca=null;Bc.onPointerDown=function(gc){gc=qf.a(Bc.$).He(gc);if(2===gc.yb&&gc.Kn===Sys.UI.MouseButton.leftButton&&!Bc.HSa){var Id=Bc.Ugd(gc);if(!Id)return Tc.ULS.shipAssertTag(537159379,0,!1,"DragSelectionClickBehaviorBase.OnPointerDown: GetSelectedRange failed"),!1;Bc.jd=Id.clone();Bc.sourceRange=
Bc.jd.clone();Bc.Fma=Bc.jd;if(Id=Bc.fUh(gc))Bc.Gu=5,Bc.PZd=Id.top-Bc.sourceRange.top,Bc.qkd=Id.left-Bc.sourceRange.left,ce.g(Bc.$).Hh.hu(Bc.nr?V.B7c:V.aKe),Bc.DBf(gc),Bc.HSa=!0,jg.b(Bc.$,!0)}return!1};Bc.rd=function(gc,Id){Id.wK||Bc.wOd(Bc.$.isEditMode)};Bc.vC=[];Bc.$=Aa;Bc.ha=ce.g(Bc.$).ha;Bc.paneType=hb;Bc.Hp=Ib;Aa=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");hb=af.a.Af;Aa=yl(Aa&&!hb?[U.Kxh,U.Dxh,U.Gxh,U.Ixh]:[U.Lxh,U.Exh,U.Hxh,U.Jxh]);for(hb=Aa.next();!hb.done;hb=Aa.next())hb=
Bc.Hp.WDe(R,hb.value,Bc.nr?[U.Fxh]:[U.Cxh],Bc.onPointerDown),Array.add(Bc.vC,hb);Bc.$.Qk(Bc.rd);Bc.wOd(Bc.$.isEditMode);return Bc}function U(){}function Q(R){var Aa=H.call(this,R)||this;var hb=document.createElement("div");hb.className=Te.a.Rxh;R.appendChild(hb);return Aa}function la(R,Aa,hb,Ib){return ba.call(this,R,Aa,hb,Ib)||this}function ba(R,Aa,hb,Ib){var Bc=H.call(this,Aa)||this;Bc.Znb=!1;Bc.m_b=!1;Bc.rrd=!1;Bc.l_a=null;Bc.prd=!1;Bc.uba=!1;Bc.yw=function(){Bc.Znb&&Bc.prd?Bc.Qna():Bc.U4()};Bc.izf=
function(Id){3===Id.yb&&(Bc.prd=!0,Bc.Qna());return!1};Bc.jzf=function(Id){if(3===Id.yb){if(!Id.Tb||Bc.nii(Id))return!1;Bc.prd=!1;Bc.U4()}return!1};Bc.Yh=function(){Bc.uba&&Bc.GXd();Bc.Qna();Bc.rrd=!1};Bc.tr=function(){Bc.U4();Bc.rrd=!0};Bc.Iya=function(Id,fe){fe.X4===Bc.X4&&(fe.visible?Bc.rrd||Bc.Qna():Bc.U4())};Bc.XEf=function(){Bc.kzf(Bc.aP.domElement,!1)};Bc.pvf=function(){Bc.kzf(Bc.uM.domElement,!0)};Bc.hnc=function(Id,fe){Bc.ha.wza(fe)};Bc.inc=function(Id,fe){Bc.ha.wza(Td.b(fe))};Bc.DDb=function(){3===
Pf.a.$b?Bc.Qna():Bc.U4();Bc.uba&&1===Pf.a.$b&&Bc.GXd()};Bc.YEf=function(){Bc.Xpj()};Bc.BKe=function(){Bc.U4()};Bc.lp=function(){Bc.ha.Pa.lc&&Bc.U4()};Bc.dvf=function(){Bc.U4()};Bc.azf=function(Id,fe){Bc.GXd();3===fe.yb?Bc.Qna():Bc.U4()};Bc.Zqc=function(){Bc.Znb&&(Bc.U4(),Bc.Qna())};var gc=hb.$;Bc.Dy=hb;Bc.ha=hb.ha;Bc.eba=R;Bc.ynj=Aa;Bc.paneType=Ib;R=Bc.domElement.currentStyle;Aa="#000000";R&&(Aa=R.borderTopColor);Bc.aP=new T(Bc.bbd(),Aa,gc);Bc.uM=new T(Bc.bbd(),Aa,gc);Bc.zpd=gc.ea.isNamedObjectViewMode&&
1===gc.workbookContext.NovMode;Bc.aP.Tne(Bc.XEf);Bc.aP.Sne(Bc.hnc);Bc.aP.Une(Bc.inc);Bc.uM.Tne(Bc.pvf);Bc.uM.Sne(Bc.hnc);Bc.uM.Une(Bc.inc);R=yl(Bc.gridView.nn);for(Aa=R.next();!Aa.done;Aa=R.next())Aa=Aa.value,Fd.a.instance.qa(Ye.a.Hf,Aa.domElement,Bc.jzf),Fd.a.instance.qa(Ye.a.ye,Aa.domElement,Bc.izf);hb.view.Ms(Bc.yw);hb.yc.Yl(Bc.BKe);hb.Nb.Anb(Bc.Iya);hb.IYb(Bc.dvf);gc.nA(Bc.Zqc);hb.ar(Bc.Zqc);Bc.ha.I2(Bc.Yh);Bc.ha.O9(Bc.tr);hb.cE(Bc.lp);Bc.ha.NYb(Bc.azf);Pf.a.doe(Bc.DDb);ig.TaskExtensions.Ba(bg.GetServiceTaskFactory.Wa(gc.da,
376,377,0),function(Id){Id.result.wHg(Bc.YEf)},gc.ma,3);return Bc}function T(R,Aa,hb){var Ib=Zf.call(this,document.createElement("div"))||this;Ib.Y4b=null;Ib.sOb=!1;Ib.onPointerDown=function(gc){gc=qf.a(Ib.$)?qf.a(Ib.$).He(gc):gc;Ib.sOb=!1;if(3===(Pf.a.$b=gc.yb)){var Id=gc.Ea.rawEvent,fe=Id.srcElement||Id.target;Ud.DOMElementExtensions.Oe(Ib.domElement,fe)&&Ud.DOMElementExtensions.Oe(Id.currentTarget,fe)&&(Ib.sOb=!0,Ib.Y4b=gc.clientPoint)}return!1};Ib.Og=function(gc){gc=qf.a(Ib.$)?qf.a(Ib.$).He(gc):
gc;Ib.raiseEvent("GrPointerUp",gc);return Ib.sOb=!1};Ib.qj=function(gc){gc=qf.a(Ib.$)?qf.a(Ib.$).He(gc):gc;3===gc.yb&&Ib.sOb&&Ib.A6h(gc.clientPoint)&&(Ib.raiseEvent("GrDrag"),Ib.sOb=!1);return!1};Ib.Zc=function(gc){qf.a(Ib.$)&&qf.a(Ib.$).He(gc);return!0};Ib.$=hb;hb=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");var Bc=af.a.Af;Ib.domElement.classList.add(!hb||Bc?Te.a.wRe:Te.a.vRe);Ib.domElement.classList.add(Te.a.x8b);R.appendChild(Ib.domElement);Ud.DOMElementExtensions.setVisible(Ib.domElement,
!1);Ib.RKa=document.createElement("div");Ib.RKa.classList.add(Te.a.w8b);Ib.RKa.style.borderColor=Aa;Ib.domElement.appendChild(Ib.RKa);Hd.a.instance.qa(Ye.a.pointerDown,Ib.domElement,Ib.onPointerDown);Hd.a.instance.qa(Ye.a.Yd,Ib.domElement,Ib.Og);Fd.a.instance.qa(Ye.a.ye,Ib.domElement,Ib.Og);Hd.a.instance.qa(Ye.a.fh,Ib.domElement,Ib.qj);Fd.a.instance.qa(Ye.a.xg,Ib.domElement,Ib.qj);W.a.instance.qa(Ye.a.click,Ib.domElement,Ib.Zc);return Ib}function H(R,Aa){return Dd.call(this,R,void 0===Aa?null:Aa)||
this}function S(R){var Aa=bd.call(this)||this;Aa.Ipf=[3];Aa.gridView=R;return Aa}function K(R,Aa){var hb=fc.call(this)||this;hb.start=R;hb.Cxb=Aa;return hb}function da(R){var Aa=Ra.call(this)||this;Aa.$=R;Aa.dc();return Aa}function fa(R){var Aa=Y.call(this)||this;R.da.Ha(376,Aa);return Aa}function X(R){var Aa=$i.call(this)||this;Aa.$=R;Aa.dc();return Aa}function ca(){this.KLd=wc.AFrameworkApplication.y_d;this.aAi=wc.AFrameworkApplication.EYj;this.$O=wc.AFrameworkApplication.a2h();this.priority=wc.AFrameworkApplication.z_d;
this.wfe=this.Btj();this.aTc=wc.AFrameworkApplication.$1h();this.oLc=!1;this.zfe=wc.AFrameworkApplication.y_d;wc.AFrameworkApplication.ga&&(this.oLc=wc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorIsEnabled",!1))&&(this.zfe=wc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.WordOnline.RetryOverrideOnServerErrorMilliseconds",wc.AFrameworkApplication.y_d))}function ja(R,Aa,hb,Ib,Bc,gc,Id){var fe=this;Ib=void 0===Ib?null:Ib;Bc=void 0===
Bc?!1:Bc;gc=void 0===gc?null:gc;Id=void 0===Id?!1:Id;this.fra=0;this.Bga=this.Vi=null;this.PWb=new La.a;this.jT=new La.a;this.Vl=null;this.gTb=!1;this.me=R;this.eee=Aa;this.eee.execute(function(sf){sf.Kl(nb.a.Ckd,Object(hd.a)(fe,fe.RNi,"onHostResponseReceived"))});this.p9=hb;this.Vie=new Ki.a("WebServiceCall","TokenRefresh");this.uj=Ib||new ea(R);this.Nvg=Bc;this.yT=gc?gc:ii.SessionStatusManager.instance;this.Y5d=Id}function ea(R){this.Io={};this.LX={};this.bug={};this.Xmf=15;this.l$d=!1;this.Tvg=
new Date;this.oTb=new Date;this.me=R;this.FWb=new Sc.a(2,2,6E4*this.Xmf,Object(hd.a)(this,this.vhg,"writeMeasures"),135,"SL",!1);this.me.Zg(this.FWb);this.Ibi()}function qa(){}function pa(R,Aa){var hb=this;this.documentVisibilityObserver=null;this.Ma=new ud.a;this.qx=null;this.Hdb=this.blb=!1;this.Crc=null;this.IGb=!1;this.Kud=!0;this.R$d=this.q$d=this.hH=this.fmb=!1;this.cT=null;this.g7e=function(){if(!hb.P9b||hb.P9b&&hb.$.ea.qc)hb.I7e(!1);else if(hb.Kud){hb.Kud=!1;var Ib=Cf.a(hb.$);Tc.ULS.sendTraceTag(537170709,
0,50,"EwaAccessTokenExpirationRefreshManager.HandleOnTokenExpiring - session is not active - postponing refresh current-activity [{0}] TimeUntilTokenExpirationInMin [{1}]",Ib.yi?Ib.yi.activityName:"None",hb.e$f())}};this.$c=function(Ib,Bc){hb.context&&(Ib=hb.$.ea,Bc.FH&&hb.context.CGb&&!hb.context.fAc?(hb.context.fAc=!0,Bc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - reconnect"},Bc.IsUserActive=Ib.wf.pr,Bc.RefreshAccessTokenCorrelationID=hb.context.correlationID,Bc=Sg.a.Kc(Bc),
Tc.ULS.sendTraceTag(537170708,0,50,Bc)):hb.P9b&&hb.blb&&!Ib.qc&&!hb.context.R4c&&(Bc={Name:"EwaAccessTokenExpirationRefreshManager.OnSessionIdChanged - consider abort ongoing refresh due to reopen"},hb.qx&&(hb.qx.C(),Bc.Aborted=!0,ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4877031_allowRefreshExpiringAfterAbort")&&(Bc.ResetStopRefreshRetriesUntilTokenExpired=!0,hb.Hdb=!1)),Bc.TimeUntilTokenExpirationInMin=hb.e$f(),Bc.RefreshAccessTokenCorrelationID=hb.context.correlationID,Bc=Sg.a.Kc(Bc),Tc.ULS.sendTraceTag(572019856,
0,50,Bc)))};this.Fya=function(){if(hb.context&&hb.context.CGb&&!hb.context.fAc){var Ib={Name:"EwaAccessTokenExpirationRefreshManager.OnOpenWorkbookFailed"};Ib.CreatedForExpired=hb.context.R4c;Ib.RefreshAccessTokenCorrelationID=hb.context.correlationID;Ib.OpenWorkbookErrors=dh.a.Tc(hb.$.ea.MF);Ib.ExecutionContextErrors=dh.a.Tc(Cf.a(hb.$).qd.errors);Ib.accesstokenTTL=wc.AFrameworkApplication.rk;Ib=Sg.a.Kc(Ib);Tc.ULS.sendTraceTag(537170707,0,15,Ib)}};this.H7e=function(){hb.Hdb=!1;hb.I7e(!0)};this.cCd=
function(){hb.IGb&&(hb.$.ea.wf.Pza(hb.cCd),hb.IGb=!1);hb.K6f()};this.$=R;this.$Vd=Aa;this.HHd=R.Vb.Wh("WebServiceCall","refreshToken");this.P9b=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4874136_fixRaceOpenWorkbookRefreshExpiringToken");cf.a.instance.CVc(this.H7e);cf.a.instance.AVc(this.g7e);Aa=this.$.ea;Aa.Uj(this.$c);Aa.$Yb(this.Fya);this.mBi=this.$.ya.MinTokenLifetimeForRegularExpirationPromptInMin;this.$1f=this.$.ya.ShortAccessTokenExpirationPromptSeconds;this.bOf=this.$.ya.RefreshAccessTokenDurationLimitInSec;
this.Qeg(R.ea.xGf,wc.AFrameworkApplication.rk);R=new Date;Aa={};Tc.ULS.sendTraceTag(537170714,217,50,"Initializing EwaAccessTokenExpirationRefreshManager. {0}",(Aa.AccessTokenTtl=wc.AFrameworkApplication.rk,Aa.NowGetTime=R.getTime(),Aa.BootTime=wc.AFrameworkApplication.yha,Aa.WopiTokenExpiresAfterMinutes=wc.AFrameworkApplication.w_d,Aa.WopiTokenTaskItemPriority=wc.AFrameworkApplication.z_d,Aa));this.$.da.Za(291,function(Ib){hb.documentVisibilityObserver=Ib})}function Pa(R,Aa){this.PWb=R;this.jT=Aa}
function Ha(){return Xa.apply(this,arguments)||this}function Xa(){}function Na(){}function db(R,Aa){this.CGb=!1;this.correlationID=R;this.R4c=Aa;this.fAc=!1;this.creationTime=nh.a.Ra.Kb}function Ja(R){var Aa=jb.call(this)||this;Aa.Ma=new ud.a;Aa.fmb=!1;Aa.hH=!1;Aa.$=R;return Aa}function jb(){this.Rge=this.zQc=!1;var R=wc.AFrameworkApplication.rk;if(!(0>=R)){this.rk=R;R=new Date;var Aa={};Tc.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",(Aa.AccessTokenTtl=this.rk,Aa.NowGetTime=
R.getTime(),Aa.BootTime=wc.AFrameworkApplication.yha,Aa));cf.a.instance.CVc(Object(hd.a)(this,this.SOa,"onSessionExpiredDetected"));cf.a.instance.AVc(Object(hd.a)(this,this.yDf,"onSessionExpiringDetected"))}}function hc(R){var Aa=Xd.call(this)||this;Aa.$=R;Aa.dc();return Aa}function ma(R,Aa,hb){hb=void 0===hb?null:hb;var Ib=Rc.call(this,Aa)||this;Ib.sheetTabActivatePreviousHidden=Pd.a.instance.fa(709);Ib.sheetTabActivateNextHidden=Pd.a.instance.fa(711);Ib.svgIconProvider=null;Ib.wh=[];Ib.QK=Array(6);
Ib.xxd=Array(6);Ib.Nk=null;Ib.qQd=null;Ib.Kwc=null;Ib.Scb=null;Ib.Iwc=null;Ib.EH=null;Ib.Txb=null;Ib.TRa=null;Ib.isRtl=!1;Ib.Mu=0;Ib.yK=0;Ib.ctc=!1;Ib.O6b=!1;Ib.mna=0;Ib.Lpc=0;Ib.X6b=null;Ib.Z$=null;Ib.W3=null;Ib.LM=null;Ib.HC=0;Ib.ucc=0;Ib.WLb=null;Ib.mAb=-1;Ib.bZ=null;Ib.Roc=0;Ib.wyc=-1;Ib.Ima=0;Ib.Kta=new Eb;Ib.mLc=!1;Ib.D_=null;Ib.dhe=null;Ib.rQd=null;Ib.sQd=null;Ib.dtc=null;Ib.b$d=!1;Ib.yld=null;Ib.Qwd=!1;Ib.che=null;Ib.ZC=function(Bc,gc){Ib.LDf(gc.item)};Ib.Lya=function(Bc,gc){Bc=Ib.$.xa.pa.index;
for(var Id=0,fe=Ib.wh.length;Id<fe;Id++){var sf=Ib.bR(Id);if(sf.name===gc.oldName){sf.name=gc.newName;Ib.i0();Id===Bc&&Ib.x0(6);break}}};Ib.QDf=function(Bc,gc){(Bc=Ib.G2a(gc.item))&&Bc.ffb()};Ib.RDf=function(Bc,gc){gc.visible?(Ib.KRa(!1),Ib.NDf(gc.item)):Ib.LDf(gc.item)};Ib.VK=function(Bc){Ib.pF?(Ib.bZ=Bc,Ib.vNb()):(Ib.bZ&&(Ib.Lpc+=Ib.bZ.clientPoint.x-Bc.clientPoint.x),Ib.bZ=Bc,Math.abs(Ib.Lpc)>=Ib.cih&&Ib.vNb());return!0};Ib.ZN=function(Bc){Bc.Ea.preventDefault();return!1};Ib.hXf=function(Bc){Ib.eXf(Bc,
!0)};Ib.gXf=function(Bc){Ib.eXf(Bc,!1)};Ib.K_=function(Bc){if(Ib.pF&&(Ib.mz||Ib.Vhf(Bc)))if(Ib.O6b=Ib.gef(Bc),Ib.mz){var gc;Bc=(gc=Ib.bR(Ib.HC+1))?gc.sheet:null;Ib.reorderSheets(Bc,Ib.HC+1===Ib.oQd,!0)}else Bc=Ib.Qwd?null:Ib.yld,Ib.reorderSheets(Bc,Ib.Qwd,!0);Ib.MQ();return!0};Ib.ii=function(Bc,gc){gc.mI&&Ib.OYd(gc.mI);Ib.Mvc(!1);Ib.i0();gc.pa&&(Ib.OYd(gc.pa),Ib.x0(6),Ib.ea.oma())};Ib.vuf=function(Bc,gc){Ib.UBc(gc.item)};Ib.wuf=function(Bc,gc){Ib.UBc(gc.item)};Ib.xuf=function(Bc,gc){Ib.UBc(gc.item)};
Ib.MOa=function(Bc,gc){Ib.UBc(gc.item)};Ib.o6=function(){Ib.N0c()};Ib.rd=function(){Ib.isVisible=!Ib.ea.isNamedObjectViewMode;Ib.N0c();Ib.I4c();ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&(gd.d(Ib.$)||gd.e(Ib.$))&&(tc.PageLoadTrackingInfo.instance.n0(dd.a.nKb,["sheetTabBar"]),tc.PageLoadTrackingInfo.instance.VW(dd.a.nKb,["sheetTabBar"]));Ib.p4c();Ib.i0();Ib.KRa(!0);Ib.x0(6)};Ib.ej=function(){Ib.isVisible&&(Ib.i0(),Ib.x0(6))};Ib.Mf=function(){Object(nc.a)(vb,
Ib.EH)===fh.k(Ib.$.lg)&&Ib.p4c();for(var Bc=yl(Ib.wh),gc=Bc.next();!gc.done;gc=Bc.next())gc.value.Npj(!fh.k(Ib.$.lg))};Ib.PDf=function(Bc,gc){Ib.Wej(gc.item,gc.isUserOperation)};Ib.gEb=function(Bc,gc){Ib.NDf(gc.item)};Ib.onKeyDown=function(Bc){switch(Bc.keyCode){case 9:var gc=Ib.domElement.querySelectorAll(Ud.DOMElementExtensions.Rp),Id=Ud.DOMElementExtensions.Cl(gc);gc=Ud.DOMElementExtensions.gz(gc);Ud.DOMElementExtensions.Qda(Bc,Id,gc);break;case 39:case 37:Ud.DOMElementExtensions.e_f(Bc,Ib.domElement.querySelectorAll(Ud.DOMElementExtensions.Rp),
39===Bc.keyCode?!Ib.isRtl:Ib.isRtl)}Tc.ULS.sendTraceTag(537153691,0,50,"SheetTabBarControl.OnKeyDown: Press on {0}",Bc.keyCode)};Ib.onScroll=function(){Ib.Nk.scrollLeft!==Ib.mna&&Ib.vKj()};Ib.t6=function(Bc){if(Bc.ctrlKey||Bc.n3)return!1;Ib.Nk.scrollLeft+=Math.floor(30*Bc.WBa);if(Ib.mz&&Ib.pF){var gc=Ib.J_e("OnMouseWheel");gc&&Ib.FUd(0<Bc.WBa,gc.x+gc.width/2)}return!0};Ib.GF=function(Bc,gc){if(Ib.Kta)Ib.o7e("PartialInteractivity",gc.PP?3:0);else{Ib.MQ(!1);Ib.XOd(gc.PP);Bc=yl(Ib.Mte);for(var Id=Bc.next();!Id.done;Id=
Bc.next())(Id=Id.value)&&Id.uX(gc.PP);Bc=yl(Ib.wh);for(Id=Bc.next();!Id.done;Id=Bc.next())(Id=Id.value)&&Id.uX(gc.PP)}};Ib.gDb=function(Bc,gc){Bc=0;gc.Zke&&(Bc=2|(gc.Owj?1:0));Ib.o7e("ComponentRangePicker",Bc)};Ib.$=R;Ib.ea=Ib.$.ea;Ib.mz=Cg.a.Xff();Ib.h7b=Ib.mz&&!ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2");Ib.jm=ac.EwaSettings.la(524);Ib.sw=Cg.a.rqd();Ib.Uhf=Ib.jm;Ib.mz&&(Ib.b$d=Ib.jm&&!af.a.Vu);Ib.gDi=Ib.$.ya.SheetTabNavigateButtonLongKeyPressPeriodMS;
Ib.fDi=Ib.$.ya.SheetTabNavigateButtonIntervalPeriodMS;Ib.cih=Ib.$.ya.SheetTabDragStartPixelThreshold;Ib.wPa=-1;Ib.vPa=-1;Ib.M2c=!1;Ib.sw&&(Ib.svgIconProvider=hb);Ib.$B=new Qf.a(Ib.domElement,3);Ib.jm&&Ib.domElement.classList.add(ub.Xth);Ib.$7g();Ib.C5g();Ib.a8g();Ib.b9g();Ib.Mvc(!0);Ib.rd(null,null);R=Ib.$.xa;R.Qf(Ib.ii);R.LYb(Ib.o6);R.vY(Ib.ZC);R.$ga(Ib.gEb);R.EFa(Ib.Lya);R.$ne(Ib.PDf);R.JYa(Ib.RDf);R.AFg(Ib.QDf);R.fVc(Ib.vuf);R.Xne(Ib.wuf);R.Yne(Ib.xuf);R.Zne(Ib.MOa);Ib.$.Qk(Ib.rd);Ib.$.nA(Ib.ej);
li.a(Ib.$).Rg(Ib);Ib.$.da.Ha(32,Ib);ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1)&&Ib.$.ea.Dt(Ib.Mf);Ib.Jwc=Ib.Pd.Dd(Ib.domElement);Ib.Jwc.ja("keydown",Ib.onKeyDown);td.a(Ib.$).Dq()&&Ib.GF(null,new qc.a(!0));td.a(Ib.$).sg.aha(Ib.GF);ce.g(Ib.$).xne(Ib.gDb);ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&Ib.Jwc.ja("mousedown",function(Bc){Bc.preventDefault()});Pg.a.instance.qa(Ye.a.VC,Ib.domElement,Ib.t6);
Ib.pQd=Ib.Pd.Dd(Ib.Nk);Ib.pQd.ja("scroll",Ib.onScroll);Ib.vKj=$g.a(function(){Ib.i0()},200,Ib.$.ma,vg.a.Swj,!0);Ib.$.dF(dd.a.FDj);Ib.Uhf&&(Ib.che=new cb(Ib.$,Ib.TRa.domElement));ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&tc.PageLoadTrackingInfo.instance.b7(dd.a.nKb,["sheetTabBar"]);return Ib}function Ka(R,Aa,hb){Aa=ib.call(this,document.createElement("a"),Aa)||this;Aa.Gha=ac.EwaSettings.la(524)?cg.a.M9c:cg.a.dvh;hb.Bb(Aa.domElement,Pd.a.instance.fa(700),0,Aa.Gha,
Pd.a.instance.fa(700),k.a.a2c,!0);R.appendChild(Aa.domElement);Aa.wc.ja("contextmenu",function(Ib){Yd.g(Ib)});return Aa}function Ta(R,Aa,hb,Ib,Bc,gc,Id){var fe=ib.call(this,document.createElement("li"),R)||this;fe.R1f=0;fe.S1f=0;fe.A1c=0;fe.B1c=0;fe.X4c=.5;fe.kQd=!1;fe.dV=!1;fe.XO=null;fe.mCb=null;fe.pE=null;fe.lHc=null;fe.color=null;fe.Eff=!1;fe.khc=!1;fe.d5b="#BEBBB8";fe.IEc=null;fe.onKeyDown=function(sf){return 13!==sf.Ea.keyCode||fe.disabled?!1:(fe.activateSheet(1),!0)};fe.yz=function(sf){return 32!==
sf.Ea.charCode||fe.disabled?!1:(fe.activateSheet(1),!0)};fe.EF=function(){fe.disabled||(fe.uS.iTi(fe),fe.uS.pF||fe.Ena(!0,void 0,"OnMouseOver"))};fe.jI=function(){fe.disabled||fe.Ena(!1,void 0,"OnMouseOut")};fe.Bya=function(){fe.uS.pF||(fe.bGj(),fe.sheet.u7||ce.g(fe.$).sbb(fe.sheet.sheetName));return!1};fe.Cya=function(){fe.KLe(!1);return!1};fe.Zc=function(sf){if(fe.disabled)return!0;var hg=ce.g(fe.$);fe.sheet.active||3!==sf.yb?fe.jm?fe.activateSheet(sf.yb):Cg.a.frd()&&hg.focus():(!Cg.a.WMa(fe.$)&&
!fe.Wzb||hg.isEditing||hg.Ci||hg.Urb(),fe.activateSheet(sf.yb));return 3!==sf.yb};fe.onPointerDown=function(sf){if(fe.disabled)return!0;fe.KLe(!0);ce.g(fe.$).inRangePicker&&Tc.ULS.sendTraceTag(35985038,0,15,"SheetTabButton:OnPointerDown() - Tried clicking different sheet while in range picker (e.g editing a formula).");var hg=3===sf.yb;if(2===sf.yb||hg&&fe.cxa)fe.jm?(fe.Ena(!0,!hg,"OnPointerDown"),hg=Da.Task.delay(hg?fe.S1f:fe.R1f).CWR(function(){return!0})):hg=fe.activateSheet(sf.yb),fe.Q6a&&(fe.khc=
!0,fe.uS.dtc=ig.TaskExtensions.Ba(hg,function(){fe.khc&&fe.uS.kTi(fe,sf)},fe.ma,11));return!1};fe.Og=function(sf){if(fe.disabled||!fe.Q6a&&ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",!1))return!0;var hg=fe.uS.pF&&!Cg.a.Xff();fe.khc=!1;fe.jm&&fe.Ena(2===sf.yb,void 0,"OnPointerUp");fe.uS.dtc&&(ig.TaskExtensions.Ba(fe.uS.dtc,function(){fe.uS.jTi(fe)},fe.ma,11),fe.uS.dtc=null);return hg};fe.ZN=function(){if(!fe.Q6a&&ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",
!1))return!0;fe.khc=!1;fe.kQd||fe.Ena(!1,void 0,"OnTouchMove");return!1};fe.Eze=new ob(fe,R);fe.jm=gc;fe.sw=Id;fe.Wzb=Cg.a.Wzb(R);fe.Lnd=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:3843903_DelayLoadSheetViewIcon")&&!fe.sw;fe.jm?(fe.R1f=R.ya.SheetDragReorderDelayInMilliseconds,fe.S1f=R.ya.SheetDragReorderDelayInMillisecondsForTouch,fe.A1c=18,fe.B1c=20):(fe.A1c=19,fe.B1c=22);fe.$=R;fe.TVb=Ib;fe.uS=Bc;fe.Q6a=Bc.Wpe();fe.n$g();fe.q4g();fe.Fkd=R.Vb.Wh("UserAction",fe.name);fe.Ood=!1;Ud.DOMElementExtensions.us(fe.domElement,
dd.a.Rr,null,null);fe.domElement.appendChild(fe.anchor);fe.anchor.appendChild(fe.pE);fe.Ina=new La.a;R=new ya(fe.sheet,fe.jm,fe.sw);fe.Ina.add(new Cb(fe.$,R));fe.$.ea.kKb&&(R=new za(fe.sheet,fe.jm,fe.sw),fe.Ina.add(new Cb(fe.$,R)));fe.Lnd||(R=new eb(fe.sheet,fe.uS.Ewc,function(){return fe.color?Ta.rRd(fe.color):!1},fe.sw),fe.mCb=new Cb(fe.$,R),fe.Ina.add(fe.mCb));fe.cxa=fe.uS.cxa;fe.ffb();fe.u$i();fe.Oue=new Qf.a(fe.domElement,1);Aa.insertBefore(fe.domElement,hb);Bb.a(fe.$)&&fe.Geg(!0);return fe}
function ob(R,Aa){var hb=Qa.call(this,R.domElement)||this;hb.onKeyDown=function(Ib){121===Ib.keyCode&&Ib.shiftKey&&!hb.Lna.disabled&&(hb.showContextMenu(new Sys.UI.Point(0,0),1,hb.Lna.anchor),Yd.g(Ib))};hb.rca=function(Ib){if(!hb.$.isEditMode||hb.Lna.disabled)return!0;hb.rename(!1,Ib.yb);return!0};hb.$k=function(Ib){return hb.Lna.disabled?!0:hb.showContextMenu(Ib.clientPoint,Ib.yb,Ib.Tb)};hb.hhe=R;hb.$=Aa;W.a.instance.qa(Ye.a.hk,R.domElement,hb.rca);ad.a.instance.qa(R.domElement,hb.$k);hb.wc.ja("keydown",
hb.onKeyDown);return hb}function Cb(R,Aa){var hb=this;this.xqa=this.I1=this.$Aa=this.Yj=null;this.Kgf=!1;this.lRc=this.foa=this.Lsa=this.Qha=this.Ksa=null;this.EF=function(){hb.dataSource.UH()&&ig.TaskExtensions.Ba(hb.fBb,function(){dialogControls.renderToolTip(hb.dataSource.Mz(),"SheetIconTooltip",hb.dataSource.eWd(),hb.DI,10,!1,!1,1)},hb.$.ma,3)};this.jI=function(){hb.dataSource.UH()&&hb.clearToolTip()};this.$=R;this.dataSource=Aa;this.sw=Cg.a.rqd()}function eb(R,Aa,hb,Ib){this.sheet=R;this.altText=
Pd.a.instance.fa(1856);this.lMj=Aa;this.v3f=hb;this.sw=Ib}function ya(R,Aa,hb){this.jm=Aa;this.sw=hb;this.sheet=R;this.altText=Pd.a.instance.fa(1933)}function za(R,Aa,hb){this.jm=Aa;this.sw=hb;this.sheet=R;this.altText=Pd.a.instance.fa(1934)}function Ga(R,Aa,hb){var Ib=ib.call(this,document.createElement("a"),R,!0)||this;Ib.Wg=function(){Ib.uX(!1);Ib.$.ea.Lq(Ib.Wg)};Ib.Zc=function(Bc){Ib.D$f(Bc.yb);return!0};Ib.onKeyDown=function(Bc){return 13===Bc.Ea.keyCode||32===Bc.Ea.keyCode?(Ib.D$f(Bc.yb),!0):
!1};Ib.wsa=Aa.Bb(Ib.domElement,Pd.a.instance.fa(506),0,cg.a.Dth,Pd.a.instance.fa(506),k.a.a3h,Ib.disabled);Ib.domElement.classList.add(ub.Gth);hb.appendChild(Ib.domElement);Ib.$.ea.Um(Ib.Wg);Ib.h9i();return Ib}function cb(R,Aa){var hb=E.call(this,document.createElement("div"))||this;hb.$R=function(){Tc.ULS.sendTraceTag(537153794,0,50,"SheetDropdownMenu.OnSheetsChanges");hb.dSf(!1,"OnSheetsChanged")};hb.AKi=function(){hb.cl()};hb.zKi=function(){hb.un()};hb.$=R;hb.uJj=Aa;hb.dV=!1;hb.IMb=0;return hb}
function Mb(R,Aa){this.sheetName=null;this.newSheetIndex=0;this.sheetName=R;this.newSheetIndex=Aa}function Dc(R,Aa,hb){var Ib=ib.call(this,document.createElement("a"),Aa)||this;Ib.Zc=function(Bc){Ib.$.xe(-684145703,Bc.yb,0,null);return!0};Ib.KDb=function(Bc){Fe.HelperMethods.WVd(Ib.Hve,Ib.Gha,Ib.Gha+dd.a.Wdc,("mouseover"===Bc.type||"focus"===Bc.type)&&!ce.g(Ib.$).inRangePicker)};Ib.$=Aa;Ib.Gha=ac.EwaSettings.la(524)?cg.a.M9c:cg.a.ZPe;Ib.Hve=hb.Bb(Ib.domElement,Pd.a.instance.fa(504),0,Ib.Gha,Pd.a.instance.fa(505),
k.a.a2c);R.appendChild(Ib.domElement);Ib.wc.ja("contextmenu",function(Bc){Yd.g(Bc)});Ib.wc.ja("mouseover",Ib.KDb);Ib.wc.ja("mouseout",Ib.KDb);W.a.instance.qa(Ye.a.click,Ib.domElement,Ib.Zc);Ib.aNa=Fg.KeyInputManager.instance.ps(Ib.domElement,Ib.Zc,va.a.$h,va.a.j1);return Ib}function vb(R,Aa,hb,Ib){Ib=void 0===Ib?!1:Ib;var Bc=ib.call(this,document.createElement("a"),Aa,Ib)||this;Bc.Zc=function(gc){Bc.disabled||Bc.$.xe(-1935155518,gc.yb,30,null);return!0};Bc.KDb=function(gc){gc="mouseover"===gc.type||
"focus"===gc.type;var Id=Bb.a(Bc.$)?Bc.S$a:Bc.wsa;Fe.HelperMethods.WVd(Id,Bc.Gha,Bc.Gha+dd.a.Wdc,gc&&!ce.g(Bc.$).inRangePicker)};Bc.fj=function(){Bc.uX(!0)};Bc.Kg=function(){Bc.uX(!1)};Bc.Gha=ac.EwaSettings.la(524)?cg.a.M9c:cg.a.ZPe;Bc.wsa=hb.Bb(Bc.domElement,Pd.a.instance.fa(502),0,Bc.Gha,Pd.a.instance.fa(503),k.a.a2c,Ib);R.appendChild(Bc.domElement);Bc.wc.ja("contextmenu",function(gc){Yd.g(gc)});ac.EwaSettings.la(524)||(Bc.wc.ja("mouseover",Bc.KDb),Bc.wc.ja("mouseout",Bc.KDb));W.a.instance.qa(Ye.a.click,
Bc.domElement,Bc.Zc);Bc.aNa=Fg.KeyInputManager.instance.ps(Bc.domElement,Bc.Zc,va.a.$h,va.a.j1);ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&(ce.g(Bc.$).pc.Yl(Bc.fj),ce.g(Bc.$).pc.Mo(Bc.Kg));return Bc}function ib(R,Aa,hb){hb=void 0===hb?!1:hb;R=N.call(this,R)||this;R.wsa=null;R.S$a=null;R.$=Aa;R.RX=hb;return R}function ub(){}function Eb(){this.IIe=new og.a(!0);this.yHc=0}function Ya(R){return eh.call(this,R)||this}function tb(R){this.sih=R}function ec(R){return Ag.call(this,
R)||this}function Za(R,Aa,hb,Ib){var Bc=this;this.menuId=null;this.mRa=-1;this.xEf=function(){Bc.fda()};this.EUi=function(gc){if(!(Bc.va.OLa()||(!ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4124510_JsCrashOnToggleTableStyleOptionSuccessful")||Qh.a(gc)||Bc.fMa())&&Qh.a(gc)&&Bc.fMa())){gc=Bc.va.activeCell;var Id=Bc.va.activeRange,fe=Bc.tableManager.Mg.usedRange;2===Bc.mRa&&he.g(Bc.tableManager.Mg)&&gc.bottom===fe.bottom&&(Id=Id.C5?new bf.Range(Id.top-1,Id.left,Id.bottom-1,Id.right,!1,!0):new bf.Range(Id.top,
Id.left,Id.bottom-1,Id.right,!1,!0),gc=Id.contains(gc)?gc:bf.Range.kd(Id.bottom,gc.left),ce.g(Bc.$).ha.updateSelection(Id,gc,0,3))}};this.WTi=function(gc){Qh.a(gc)?(Tc.ULS.sendTraceTag(594130062,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename failed due invalid user input"),Bc.$.If()):Tc.ULS.sendTraceTag(594130061,0,50,"TableManager.OnTableRenameSuccessful-Rename table rename successful")};this.VTi=function(){Tc.ULS.sendTraceTag(594130060,0,15,"TableManager.OnTableRenameFailure-Rename table failed");
Bc.$.If()};this.XTi=function(gc,Id){Id&&Bc.JL(Id);Qh.b(gc,-569193796)&&(Cf.a(Bc.$).qd.ZD(-569193796),Bc.fsi(gc.Errors[0]))};this.$=R;this.tableManager=Aa;this.namedSheetViewPublic=hb;this.frame=this.$.frame;this.ha=ce.g(this.$).ha;this.va=this.ha.va;this.qw=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");this.tableStyleManager=Ib;this.tableStyleManager.PGg(this.xEf)}function mb(R){R=Ld.call(this,R)||this;var Aa=ce.g(R.$);Aa=Aa.Rb.Xj(Aa.ha.va.activeCell);If.a.oi(Aa.aMb)?R.CCd=
"":R.CCd=Aa.aMb;If.a.oi(Aa.bMb)?R.zCd="":R.zCd=Aa.bMb;Aa=R.tV(R.CCd,R.zCd);R.initializeAndShow(Pd.a.instance.fa(729),R.aJj,Aa);return R}function sc(R){var Aa=sb.call(this,R)||this;Aa.jJj=function(hb,Ib){1===hb&&Aa.FNj(Bf.D(Aa.YGf(Ib[sc.uMf])))};Aa.mvb=function(hb){hb=Aa.yfd(hb);return Aa.Rcd(hb)};Aa.gridView=ce.g(R);Aa.va=Aa.gridView.ha.va;Aa.Soc=Aa.gridView.Rb.Xj(Aa.va.activeCell).usedRange;R=Aa.tV(Aa.Soc.toString());Aa.initializeAndShow(Pd.a.instance.fa(720),Aa.jJj,R);return Aa}function pd(R,Aa){R=
qg.call(this,R)||this;R.cBa=Aa;return R}function $b(R,Aa){R=si.call(this,R,Pd.a.instance.fa(719))||this;R.cBa=Aa;return R}function Xb(R,Aa,hb){this.nzb=!1;this.sharedSheetRange=Aa;this.$=R;this.gh=this.$.Vb.Wh("UserAction","ConvertToRangeManager");this.tableName=hb}function lc(R,Aa){var hb=this;this.f0d=null;this.g0d=0;this.jj=null;this._state=0;this.moveNext=function(){try{for(hb._state=1;1===hb._state;)hb.wu=hb.wu()}catch(Ib){hb.dispose(),hb._state=3}};this.Bf=R;this.eCa=Aa;this.wu=this.TL;this.moveNext()}
function Oa(R){this.tableName=null;this.tableName=R}function pb(R,Aa,hb){this.isPivotTable=!1;this.tableRange=null;this.optionType=0;this.tableRange=R;this.optionType=Aa;this.isPivotTable=hb}function Ub(R){this.originalRange=null;this.originalRange=R}function ic(R,Aa){this.newName=this.oldName=null;this.oldName=R;this.newName=Aa}function Jb(R,Aa,hb){this.description=this.title=this.tableRange=null;this.tableRange=R;this.title=Aa;this.description=hb}function cc(R,Aa,hb,Ib){R=Ob.call(this,R,hb)||this;
R.hasHeaders=!1;R.isCreation=!1;R.hasHeaders=Aa;R.isCreation=Ib;return R}function Ob(R,Aa){this.tableRange=this.tableRanges=null;this.styleIndex=0;this.tableRanges=R;this.tableRange=Bf.l(R.Ranges[0],R.SheetName);this.styleIndex=Aa}function P(R){this.autoFilterOptions=null;this.autoFilterOptions=R}function Ba(R,Aa){this.autoFilterOptions=null;this.sortType=0;this.autoFilterOptions=R;this.sortType=Aa}function ra(R){var Aa=ai.call(this)||this;Aa.tableStyleManager=null;Aa.$=R;Aa.dc();return Aa}function ta(R,
Aa,hb){var Ib=Kg.call(this)||this;var Bc={};Ib.H1i=(Bc.height="100%",Bc);Ib.GGb={};Ib.whd=0;Ib.OHa=0;Ib.lastSyncTime=new Date;Ib.Jda=-1;Ib.eO=null;Ib.Ema={};Ib.AL=null;Ib.hG={};Ib.VSa={};Ib.yrc=null;Ib.Igf=!1;Ib.isInitialized=!1;Ib.m6a=!1;Ib.Lzb=!1;Ib.wuc=null;Ib.OVe=!1;Ib.JLb=!1;Ib.Myc=!1;Ib.SAh=function(){Ib.Yhc()?Ib.$.ea.fJd(Ib.SAh):Ib.FKa("tableStyleManagerInitialization")};Ib.Vyf=function(gc,Id,fe){var sf=!1,hg=ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",
!1);if(Qh.a(gc))-315732528!==gc.Errors[0].MessageId&&(Tc.ULS.sendTraceTag(42821707,0,10,"TableStyleManager.OnGetTableStyleSuccess - Webservice call failed with Unexpected error : {0}",dh.a.Tc(gc.Errors)),Ib.AAd(null,Id,fe));else if(Tc.ULS.sendTraceTag(537151202,0,50,"TableStyleManager.OnGetTableStyleSuccess - Webservice call Success"),(gc=gc.Result)&&gc.TableStyleItems.length){fe=60<gc.TableStyleItems.length;var $f=!1,th=!1;if(Ib.AL)for(var ji=0;60>ji;++ji){var aj=gc.TableStyleItems[ji],Uj=Ib.AL.TableStyleItems[ji];
if(hg&&aj.HasStyleViolations!==Uj.HasStyleViolations){sf=th=!0;break}for(var de=0;9>de&&!(de>=aj.TableStyleElementsList.length);de++)if(!If.a.equals(aj.TableStyleElementsList[de].BackgroundColor,Uj.TableStyleElementsList[de].BackgroundColor,!1)){sf=$f=!0;break}}else for(Ib.OHa=0,ji=yl(gc.TableStyleItems),aj=ji.next();!aj.done;aj=ji.next())aj=aj.value,aj.TableStyleElementsList&&aj.TableStyleElementsList.sort(bb.Xnf),Ib.hG[aj.Name]=aj;if($f||th)for($f=0;60>$f;++$f)th=gc.TableStyleItems[$f],Ib.hG[th.Name]=
th;if(fe&&Ib.AL)for(Tc.ULS.sendTraceTag(42821700,0,50,"TableStyleManager.OnGetTableStyleSuccess, Number Custom Styles present - {0}",gc.TableStyleItems.length-60),sf=!0,fe=60;fe<gc.TableStyleItems.length;++fe)$f=gc.TableStyleItems[fe],$f.Name in Ib.hG||$f.TableStyleElementsList&&$f.TableStyleElementsList.sort(bb.Xnf),Ib.hG[$f.Name]=$f;if(Lh.a(Ib.hG).length!==gc.TableStyleItems.length)for(sf=!0,$f=fe=60;$f<Ib.AL.TableStyleItems.length;)fe>=gc.TableStyleItems.length?delete Ib.hG[Ib.AL.TableStyleItems[$f].Name]:
fe>=gc.TableStyleItems.length||!If.a.equals(gc.TableStyleItems[fe].Name,Ib.AL.TableStyleItems[$f].Name,!1)?delete Ib.hG[Ib.AL.TableStyleItems[$f].Name]:++fe,++$f;Ib.AL=gc;Ib.uOf(sf);sf&&Ib.ZYc();hg&&Id&&("accessibility"===Id?(Ib.JLb=!1,Ib.Myc=!0):Ib.Myc=!1);Ib.Igf||(Ib.loi()&&Ib.$.If(),Ib.Igf=!0);Ib.whd=0;Ib.Lzb||Ib.OVe?hg&&Ib.Myc&&Ib.raiseEvent("RefreshTableStyleGallery"):(Ib.raiseEvent("RefreshTableStyleGallery"),Ib.OVe=!0)}};Ib.AAd=function(){Tc.ULS.sendTraceTag(42821712,0,10,"TableStyleManager.OnGetTableStyleFailed - Webservice call failed");
Ib.whd++;5>Ib.whd&&He.a.instance.create(function(){Ib.FKa("getTableStylesFailed")},1E3,vg.a.R8f,!0,!0)};Ib.wEf=function(){Ib.Lzb&&(Ib.Lzb=!1,Ib.wuc&&Ib.wuc(),He.a.instance.create(function(){Ib.FKa("galleryMenuClosed")},1E3,vg.a.R8f,!0,!0))};Ib.$=R;Ib.Sa=Aa;Ib.tableManager=hb;Ib.$.da.Ha(329,Ib);Ib.wZc=Ib.Rub();Ib.$.Ka.FFa(Ib.wEf);return Ib}function Ia(R,Aa,hb,Ib,Bc,gc){this.headerRow=R;this.totalRow=Aa;this.firstCol=hb;this.lastCol=Ib;this.nS=Bc;this.$ha=gc}function bb(){}function Va(){}function lb(R){var Aa=
Dg.call(this)||this;Aa.tableManager=null;Aa.$=R;Aa.dc();return Aa}function kc(R){var Aa=sa.call(this,ce.g(R))||this;Aa.spb=null;Aa.pzc=null;Aa.U0=null;Aa.upb=null;Aa.zqe=!1;Aa.F$d=null;Aa.$Qb=0;Aa.f5b=null;Aa.P_b=function(){var hb={},Ib=Aa.Fgd(),Bc;for(Bc in Ib){var gc=Ib[Bc];if(gc){var Id=Aa.o_h(gc);if(Id){if(Id in Aa.qFa){var fe=Aa.qFa[Id];if(fe.dB){fe.Sn.equals(gc)||(fe.Sn=gc);delete Aa.qFa[Id];hb[Id]=fe;continue}}(fe=gb.createInstance(ce.g(Aa.$),gc,Aa.QJh(),Aa))?hb[Id]=fe:Tc.ULS.sendTraceTag(537151239,
0,15,"TableManager.AttachTableResizeBehavior - Attaching Grippie Failed for Range {0}",gc.FC(!1))}}}Aa.S1b(null,null);Aa.GPb=hb};Aa.S1b=function(){var hb=Aa.qFa,Ib;for(Ib in hb){var Bc=Ib,gc=hb[Ib];gc&&(gc.dispose(),delete Aa.qFa[Bc])}Aa.GPb={}};Aa.yMf=function(){Aa.S1b(null,null);Aa.P_b(null,null)};Aa.onFocus=function(){Aa.F$d=ce.g(Aa.$).ha.va.activeCell};Aa.m6=function(){Aa.$.isEditMode&&Aa.Mh(null,null)};Aa.Mh=function(){!Aa.zqe&&$e.c(Aa.$,Aa.gridView.ha.va.activeCell)&&Aa.Fti()};Aa.NN=function(){Aa.Lxb(1);
Aa.$.ea.Lq(Aa.NN)};Aa.xFb=function(){Aa.zqe=!0;Aa.pzc=new zb(Aa.$)};Aa.$=R;Aa.gridView=ce.g(Aa.$);Aa.$.da.Ha(66,Aa);Aa.GPb={};Aa.P_b(null,null);Aa.$.xa&&Aa.$.xa.Qf(Aa.yMf);Aa.yoe(Aa.P_b);Aa.$.ea.K9(Aa.m6);Aa.gridView.ha.JG(Aa.Mh);Aa.$.isEditMode&&Aa.Mh(null,null);return Aa}function zb(R){var Aa=ye.call(this,document.createElement("div"))||this;Aa.dR=!1;Aa.TGf=!1;Aa.Xnd=!1;Aa.DTc=!1;Aa.UIb=null;Aa.Mh=function(){$e.c(Aa.$,Aa.gridView.ha.va.activeCell)?(Aa.PLa=!0,Aa.Rqb(!1)):(Aa.PLa=!1,Aa.g5=!1,Aa.Ccg())};
Aa.it=function(){Aa.PLa?Aa.Rqb(!0):Aa.g5=!1};Aa.Evf=function(){Aa.DTc=!0;Aa.PLa&&(Aa.g5=!1)};Aa.onContentReady=function(){Aa.$.isEditMode?$e.c(Aa.$,Aa.gridView.ha.va.activeCell)&&(Aa.PLa=!0,Aa.Rqb(!1)):Aa.g5=!1};Aa.$Cb=function(){Aa.DTc=!1;Aa.PLa?Aa.Rqb(!1):Aa.g5=!1};Aa.Re=function(hb,Ib){Aa.PLa&&(hb=Aa.gridView.dpc(Ib.dd.block.ke.BlockCachePosition.PaneType).qG(Ib.dd.hash))&&(hb.SJd(Aa.aLa),hb.JVc(Aa.aLa))};Aa.aLa=function(){Aa.ZRf()};Aa.$=R;Aa.gridView=ce.g(Aa.$);Aa.parentElement=Aa.domElement;
Aa.parentElement.className=Sb.huh;Aa.MKa=Aa.gridView.xj;Aa.PLa=!0;Aa.pbi();Aa.mMg();Aa.Rqb(!1);Tc.ULS.sendTraceTag(537151201,0,50,"TableTotalRowOptions - React Component Created ");return Aa}function Sb(){}function gb(R,Aa,hb,Ib){var Bc=Ch.call(this,R)||this;Bc.Q8f=[6];Bc.L8f=[26];Bc.Sr=null;Bc.hic=!1;Bc.ezb=!1;Bc.$aa=null;Bc.ft=null;Bc.onPointerDown=function(gc){if(1!==Bc.$.Ka.pH())return!0;gc=qf.a(Bc.$).He(gc);if(Bc.dB)return!0;var Id=td.a(Bc.$).Rod||td.a(Bc.$).Dq();if(Bc.Hqd||Id)return Bc.wbb(),
!0;Bc.ft=Bc.Sn;Bc.zId();Bc.jkd();Id=2===gc.yb&&gc.Kn===Sys.UI.MouseButton.leftButton;var fe=3===gc.yb;if(Id||fe)gc=Bc.ha.xr(gc.clientPoint,gc.Tb,5,void 0,void 0,!0),gc||(gc=Bc.ft),Bc.ezb=Id,Bc.hic=fe,Bc.ft=Bc.N4e(gc),Bc.jkd(),Id?Bc.Q9i():fe&&Bc.D$i(),jg.b(Bc.$,!0);return!0};Bc.qj=function(gc){gc=qf.a(Bc.$).He(gc);if(!Bc.dB)return!1;if(gc=Bc.ezb?Bc.ha.xr(gc.clientPoint,gc.Tb,5,void 0,void 0,!0):Bc.ha.xr(gc.clientPoint,gc.Tb,5,!0,!1,!0))gc=Bc.N4e(Bc.xZb(gc)),Bc.s0b(gc.bottomRight),Bc.ft.equals(gc)||
(Bc.ft=gc,Bc.TGb(!1),Bc.zId(!1),Bc.jkd(!1),Bc.a8h(),Bc.Nb.update(!1)),Bc.aSj(Bc.ft);return!0};Bc.Og=function(gc){qf.a(Bc.$).He(gc);if(!Bc.dB)return!1;Bc.resizeTable();Bc.wbb();return!0};Bc.sEb=function(gc){qf.a(Bc.$).He(gc);if(!Bc.dB)return Tc.ULS.shipAssertTag(537151233,0,!0,"TableResizeBehavior.OnTouchUp - OnTouchUp Called without Operation in Progress"),!1;Bc.resizeTable();Bc.wbb();return!0};Bc.wca=function(gc){qf.a(Bc.$).He(gc);Bc.wbb();return!0};Bc.zvf=function(){Bc.dB&&Bc.wbb()};Bc.gridView=
Aa;Bc.$=Aa.$;Bc.tableManager=Ib;Bc.ha=Aa.ha;Bc.Nb=Aa.Nb;Bc.parentElement=R;Bc.YRg();af.a.Xp||af.a.Uwa||Hd.a.instance.qa(Ye.a.pointerDown,Bc.$aa,Bc.onPointerDown);Bc.Sn=hb;Bc.Hqd=!1;Bc.yLc=!1;Bc.tableManager.fEg(Bc.zvf);return Bc}function Sa(R){var Aa=Ab.call(this)||this;Aa.$=R;Aa.dc();return Aa}function Kb(R){var Aa=this;this.Wg=function(){Aa.Mlf();Aa.$.ea.Lq(Aa.Wg)};this.$=R;this.A8f={};this.CUd={};var hb=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":
"excelAppSprite",Ib=this.e0e(hb);Ib?(this.Yme(Ib),this.$.ea.Th?this.Mlf():R.ea.Um(this.Wg),this.$.da.Ha(388,this)):Tc.ULS.sendTraceTag(537151263,0,15,"window[{0}].icons returned null.",hb)}function Gc(){}function Hb(R){var Aa=Ea.call(this)||this;Aa.sparklineManager=null;Aa.$=R;Aa.dc();return Aa}function Lb(R,Aa){R=sa.call(this,R)||this;Aa.Ha(240,R);return R}function sa(R){var Aa=Df.call(this)||this;Aa.sT=[];Aa.Re=function(fe,sf){var hg,$f=sf.dd.block;fe=!1;if($f.ik&&$f.state&1&&(hg=Aa.view.Sf(sf.dd.block.ke.BlockCachePosition.PaneType).qG(sf.dd.hash))){$f=
Aa.tGd($f.se);if(hg=hg.Zf)for(var th=Aa.sT.length-1;0<=th;th--)hg.contains(Aa.sT[th].bottomRight)&&(Array.removeAt(Aa.sT,th),fe=!0);if($f)for(hg=0,th=$f.length;hg<th;hg++)Array.add(Aa.rangeList,Ge.a.VQ($f[hg])),fe=!0;fe&&(sf=(ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?Aa.view.dpc(sf.dd.block.ke.BlockCachePosition.PaneType):Aa.view.k3).qG(sf.dd.hash),Aa.raiseEvent(sa.uGd,new gf.a(sf)))}};Aa.Fm=function(){Aa.OGb()};Aa.xo=function(){Aa.sT=
[]};Aa.Oje=R;var hb=R.Ca;hb.sq(Aa.Re);hb.Yga(Aa.Re);hb.JYb(Aa.Re);hb.KG(Aa.Fm);R.$.xa.yJ(Aa.xo);R.$.zb.yJ(Aa.xo);hb=yl(R.nn);for(var Ib=hb.next();!Ib.done;Ib=hb.next()){Ib=yl(Ib.value);for(var Bc=Ib.next();!Bc.done;Bc=Ib.next()){Bc=yl(Bc.value);for(var gc=Bc.next();!gc.done;gc=Bc.next()){gc=gc.value;var Id=R.Ca.Vk(gc.hashCode);Aa.Re(Aa,new Ce.a(new zd.a(Id,gc.hashCode),null))}}}return Aa}function Ua(R){var Aa=Lc.call(this)||this;Aa.$=R;Aa.dc();return Aa}function Yb(R,Aa){var hb=this;this.pW=function(){hb.Md||
hb.sqe()};this.Md=!1;this.dZ=Aa.CU;this.ariaLiveNotifier=R;this.C_d=new md(R,Aa);this.dZ&&this.dZ.jR?this.sqe():this.cl()}function jc(R,Aa,hb){var Ib=this;this.Tzf=function(){Ib.C_d.hNf();Ib.ariaLiveNotifier.setEnabled(!0)};this.$=Aa;this.ariaLiveNotifier=R;this.C_d=new md(R,Aa);this.Z9b=hb.hgd(this.$);this.Z9b.FFg(this.Tzf)}function md(R,Aa){this.$=Aa;this.ariaLiveNotifier=R}function jd(R){var Aa=Fb.call(this)||this;Aa.$=R;Aa.dc();return Aa}function Zc(R,Aa,hb,Ib,Bc){var gc=this;this.gridReadoutNotifier=
null;this.qab=!1;this.ysa=this.nob=null;this.Xca=function(){ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5963256_DoNotReadActiveItemIfDisposed")&&!gc.$?Tc.ULS.sendTraceTag(526235470,0,15,"calling readActiveItemDescription after dispose, ignoring."):ce.g(gc.$).isEditing||gc.E_b.Pq()};this.QGi=function(){if(!ce.g(gc.$).ha.Pa.Kpd){var Id=gc.rJh();gc.readText(Id.returnValue,Id.activeCell)}};this.CF=function(){var Id=gc.activeCell;gc.readText("Editing",Id);ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5190952_removePhoneticErrorDialog2")||
Id&&Id.YKa&&!ce.g(gc.$).Y7e||gc.E_b.cancel()};this.nd=function(){ac.EwaSettings.isChangeGateEnabled("OfficeVSO:6053639_DoNotHandleSelectionChangedIfDisposed")&&!gc.$?Tc.ULS.sendTraceTag(525366409,0,15,"calling onSelectionChanged after dispose, ignoring."):(gc.Xca(),gc.qab&&ce.g(gc.$).inRangePicker&&1===Pf.a.$b&&(null===gc.nob?gc.nob=He.a.instance.create(gc.TGd,Zc.ATc,"readSelectedRanges"):gc.nob.Pq()))};this.$=Aa;this.ariaLiveNotifier=R;this.sparklineManager=Ib;this.tableManager=hb;this.iD=new Qb;
this.i6a=Me.i6a();this.qab=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5888244_FixCellReadoutInRangePicking");this.i6a&&(ac.EwaSettings.KH()?this.gridReadoutNotifier=Bc:this.gridReadoutNotifier=Aa.da.Aa(244),Tc.ULS.shipAssertTag(537153937,0,!!this.gridReadoutNotifier,"SelectionReadoutHandler.ctor: gridReadoutNotifier shouldn't be null"),Zc.ATc=700);this.E_b=He.a.instance.create(this.QGi,Zc.ATc,vg.a.Pnj,!1);this.cl()}function Qb(){this.activeItemName=null;this.Ihf=!1;this.tableName=null;this.a0a=
0;this.lzc=!1}function fd(){}function xd(R){switch(R){case 1:return 1412;case 2:return 1413;case 3:return 1414;case 4:return 1415;case 5:return 1416;case 6:return 1417;case 7:return 1418;case 8:return 1419;case 9:return 1420;case 10:return 1421;case 11:return 1422;case 12:return 1423;case 13:return 1424;case 14:return 1425;case 15:return 1426;case 16:return 1427;case 17:return 1428;case 18:return 1429;case 19:return 1430;case 20:return 1431;case 21:return 1432;case 22:return 1435;case 23:return 1433;
case 24:return 1434;case 25:return 1436;case 26:return 1437;case 27:return 1438;case 28:return 1439;default:return 1440}}function Ad(R){var Aa=vf.call(this)||this;Aa.$=R;Aa.dc();return Aa}function Me(R,Aa){this.h0=this.V6=this.LW=null;this.lja=Aa;this.r9g(R);this.T0i();ac.EwaSettings.KH()&&R.da.Ha(244,this)}function Ue(R){var Aa=Nf.call(this)||this;Aa.$=R;Aa.dc();return Aa}function Jd(R,Aa,hb){var Ib=this;this.kwf=function(Bc,gc){Ib.aNf(gc.ae.command)};this.$=R;this.efa=document.createElement("div");
this.efa.setAttribute(dd.a.XP,dd.a.vj);this.efa.className=Kc.a.A9c;Aa.insertBefore(this.efa,hb);this.sga=document.createElement("div");this.sga.setAttribute(dd.a.XP,dd.a.vj);this.sga.className=Kc.a.A9c;Aa.insertBefore(this.sga,this.efa);this.tsg=Pd.a.instance.Va(2);this.tha=document.createElement("div");this.tha.setAttribute(dd.a.Td,dd.a.csa);this.tha.setAttribute(dd.a.dsa,dd.a.dob);this.tha.className=Kc.a.A9c;Aa.insertBefore(this.tha,this.sga);this.register();this.$.da.Ha(211,this)}function Sd(R,
Aa){Aa&&(R.append(Aa),R.append(se.Oud))}function se(R){this.iuc=R||""}function oe(R){var Aa=qe.call(this)||this;Aa.$=R;Aa.dc();return Aa}function Ke(R){var Aa=Md.call(this)||this;Aa.ktd=null;Aa.$=R;Tc.ULS.sendTraceTag(537155201,0,50,"NewAndOpenCoreManager created");return Aa}function bc(){return kg.call(this)||this}function qd(R){var Aa=Yf.call(this)||this;Aa.$=R;Aa.dc();return Aa}function zc(R){var Aa=Ze.call(this,document.documentElement,R)||this;Aa.NB=0;Aa.NNg=[rf.a.b3c,rf.a.nyd,rf.a.qdc,rf.a.O$f,
rf.a.PLd,rf.a.aZc,rf.a.ocd,rf.a.X5e,rf.a.kYc,rf.a.hMb,rf.a.NDj,rf.a.Ccc,rf.a.s_c,rf.a.Htb,rf.a.nQd,rf.a.z_c,rf.a.U6f,rf.a.Hlf,rf.a.EYc];Aa.$Wj=[rf.a.qdc,rf.a.jgg,rf.a.igg,rf.a.kgg];Aa.W1i=[rf.a.qdc,rf.a.TJf,rf.a.UJf,rf.a.XJf];Aa.VVg=[rf.a.WVe,rf.a.W5e,rf.a.mcd,rf.a.icd];Aa.y1i=[rf.a.b3c,rf.a.nyd,rf.a.aZc,rf.a.ocd,rf.a.kYc,rf.a.hMb,rf.a.Ccc,rf.a.s_c,rf.a.Htb,rf.a.nQd,rf.a.oJf,rf.a.z_c,rf.a.EYc];Aa.I1i=[rf.a.Ccc,rf.a.aWe];var hb=Pd.a.instance.Va(251);Aa.Hrj=Aa.$.shortcutKeyManager.P3a(hb);Aa.mode=0;
R.da.Ha(15,Aa);ig.TaskExtensions.Ba(bg.GetServiceTaskFactory.Wa(R.da,21,137,1),function(Ib){Ib=Ib.result;Ib.Zn(nb.a.umb);Ib.Kl(nb.a.umb,Aa.WHb)},R.ma);return Aa}function ld(){this.jmb=this.Qee=this.tb=null;this.tm=!1}function rb(R,Aa,hb,Ib,Bc,gc,Id){this.pgb={};this.Z1=R;this.lsg=Aa;this.$qa=new rc(wc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruReadRetryIntervalMs",5E3),wc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxReadRetry",3),
this.nB.Ilc);this.Era=new rc(wc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruWriteRetryIntervalMs",15E3),wc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruMaxWriteRetry",3),this.nB.Ilc);this.Gug=hb;this.hke=Ib;this.Xyg={};this.pT=new nd;this.wpg=Bc;this.RTb="";this.Bv=gc;this.Z5d=Id;this.Hug=wc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.WordOnline.recentLinksCount",25);return this}function Wd(){this.mruItemId=this.app=
this.documentExt=this.documentName=this.folderName=this.documentUrl=null}function rc(R,Aa,hb){this.task=null;this.Cec=R;this.Zzi=Aa;this.taskManager=hb;this.retryCount=this.Vxb=0;this.SOc=this.yAb=null}function nd(){this._state=0;this.Pbe=this.Rbe=this.Qbe=null;this.state=this.Uie=0;this.sKc=!1;return this}function me(R,Aa,hb,Ib,Bc){this.yqg=6E4;this.baf="inactive";this.Pke="active";this.mT=!0;this.me=R;this.Apg=Aa;this.WIc=hb;this.MWb=Ib;this.rb=new Lf.a;Bc&&this.dGj();this.G$d=this.A0e()}function be(R,
Aa){this.pgb={};this.Z1=R;this.jlb=new sd(Aa,this.aCb.Ilc,"GetMoreInfo");this.Jo=new Sf;return this}function sd(R,Aa,hb){this.IVb=this.Vi=null;this.KPc=0;this.Pvg=R;this.me=Aa;this.c5d=hb}function Qe(R,Aa,hb,Ib,Bc,gc,Id,fe){this.La=R;this.Tg=Aa;this.flg=hb;this.t1=Ib;this.me=Bc;this.WIc=gc;this.Upg=Id;this.zWb=fe}function Sf(){this._state=0;this.xRc=this.Ikb=null;this.state=0;this.sKc=this.I8d=!1;return this}function mf(){this._state=0}function Zd(){this.pgb={}}function ie(){this.tb=null}function kd(){this.dWa=
null}function ge(R){return String.format("{0}RoamingServiceHandler.ashx?action={1}&{2}",wc.AFrameworkApplication.ga.appSettings.RoamingServiceHandlerWebServiceBase||"",R,wc.AFrameworkApplication.mj)}function of(R){var Aa=new Wb.a;wc.AFrameworkApplication.Jd.Xl(ge(R),1,null,null,!0,2,function(hb){200===hb.data.httpStatus?Aa.setResult("true"===hb.data.ie.toLowerCase()):Aa.setResult(!1)},function(){Aa.setResult(!1)},null,void 0,void 0,void 0,void 0,"7");return Aa.task}function Ec(R,Aa){this.La=R;this.APb=
Aa}function Cd(R){var Aa=Vd.call(this,!1,!1,!0)||this;Aa.APb=R;return Aa}function Qd(R,Aa){this.ID=R;this.type=Aa}function od(R,Aa){this.value=R;this.contextId=Aa}function ke(R,Aa,hb,Ib,Bc,gc,Id,fe){this.type=R;this.startTime=null==hb||void 0==hb.value?new od(hb,null):hb;this.endTime=null==Ib||void 0==Ib.value?new od(Ib,null):Ib;null!=Bc&&void 0!=Bc.value||new od(Bc,null);null!=gc&&void 0!=gc.value||new od(gc,null);this.operationType=fe}function Re(R){this.ID=R}function lf(){this.Pe=[];this.Onb=[];
this.tWc=0;this.duration=this.startTime=null;this.o7b={};this.$vd=this.Ewd=this.QXc=-1}b.r(F);var vc=b(0),hd=b(80),Ac=b(140),Vd=Ac.a;vm(Cd,Vd);Cd.prototype.start=function(){var R={},Aa={};R=(Aa.id="AccessibilitySettingsDialog",Aa.bodyControls=(R.tooltipPersistenceEnabled=this.APb.j$e,R),Aa);this.initializeAndShow("",Object(hd.a)(this,this.Jij,"resultHandler"),R)};Cd.prototype.Jij=function(R,Aa){1===R&&(this.APb.j$e=Aa.tooltipPersistenceEnabled)};Object(vc.a)(Cd,"AccessibilitySettingsDialog",Ac.a,
[]);var Bd=b(104),tf=b(30);Ec.prototype.Qg=function(){this.La.fc(tf.a.hAj,Bd.a.frame,Object(hd.a)(this,this.iAj,"showAccessibilitySettingsDialogHandler"))};Ec.prototype.iAj=function(){(new Cd(this.APb)).start();return 32};Object(vc.a)(Ec,"AccessibilitySettingsDialogActor",null,[259]);var Wb=b(139),wc=b(5),yb=b(168);kd.prototype.vti=function(){var R=this,Aa=new Wb.a;if(this.dWa)Aa.setResult(this.dWa);else if(this.whf()){var hb=of("getHoverableRibbonTooltipIsEnabled");hb.continueWith(function(){R.dWa=
hb.result;yb.a("setHoverableTooltipsPreference")&&appChrome.api.setHoverableTooltipsPreference(hb.result);Aa.setResult(hb.result)},8)}else Aa.setResult(!1)};kd.prototype.whf=function(){var R=wc.AFrameworkApplication.ga.ra("IsRoamingServiceEnabled"),Aa=wc.AFrameworkApplication.ga.ra("IsAnonymousUser");return R&&!Aa};Sk.Object.defineProperties(kd.prototype,{j$e:{configurable:!0,enumerable:!0,get:function(){return!!this.dWa},set:function(R){R!==this.dWa&&(this.dWa=R,yb.a("setHoverableTooltipsPreference")&&
appChrome.api.setHoverableTooltipsPreference(R),this.whf()&&wc.AFrameworkApplication.Jd.Xl(ge("saveHoverableRibbonTooltipIsEnabled"),2,R.toString().toLowerCase(),null,!0,2,null,null,null,void 0,void 0,void 0,void 0,"8"))}}});Object(vc.a)(kd,"AccessibilitySettingsInfo",null,[257]);var mc=b(273),Wc=b(167);ie.prototype.ji=function(R){var Aa=this;this.tb=R;this.tb.register(kd,"Common.App.AccessibilitySettings.AccessibilitySettingsInfo").as("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo").Lc(function(){return new kd}).Bc();
this.tb.register(Ec,"Common.App.AccessibilitySettings.AccessibilitySettingsDialogActor").as("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor").Lc(function(){return new Ec(wc.AFrameworkApplication.Gb,Aa.tb.Oh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"))}).Bc()};ie.prototype.init=function(){var R=this.tb.Oh("Common.App.AccessibilitySettings.IAccessibilitySettingsInfo"),Aa=this.tb.Oh("Common.App.AccessibilitySettings.IAccessibilitySettingsDialogActor");R&&Aa?(Aa.Qg(),
R.vti()):Wc.a(539637639,200,15,"Failed to resolve IAccessibilitySettingsDialogActor or IAccessibilitySettingsInfo. A11y dialog feature is not enabled.")};ie.prototype.dispose=function(){};ie.main=function(){mc.a.instance.sj(new ie)};Sk.Object.defineProperties(ie.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.AccessibilitySettings"}}});Object(vc.a)(ie,"AccessibilitySettingsPackage",null,[4,5]);var Nd=b(685),Tc=b(13);Zd.prototype.Gzg=function(R){this.pgb[R.id.toString()]=
R};Zd.prototype.GEi=function(R){var Aa=this.pgb,hb;for(hb in Aa)Aa[hb].notify(R,!1);this.pgb={}};Zd.prototype.H3i=function(R,Aa){Aa&&this.Gzg(Aa);return this.GCf(R,Aa)};Zd.prototype.i8c=function(R){this.GEi(R)};Zd.prototype.qLe=function(R,Aa){R.notify(Aa,!0)};Object(vc.a)(Zd,"AEventEmitter",null,[283]);var Yc;(function(R){R[R.notStarted=0]="notStarted";R[R.waiting=1]="waiting";R[R.shouldRetry=2]="shouldRetry";R[R.complete=3]="complete"})(Yc||(Yc={}));Object(vc.b)("EventResultState",Yc);Sk.Object.defineProperties(mf.prototype,
{state:{configurable:!0,enumerable:!0,get:function(){return this._state},set:function(R){var Aa={};Tc.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",(Aa.OldState=Yc[this._state],Aa.NewState=Yc[R],Aa),"ResultType",this.W2e());this._state=R}}});Object(vc.a)(mf,"AEventResult",null,[316]);vm(Sf,mf);Sf.prototype.W2e=function(){return"GetMoreInfo Result"};Sk.Object.defineProperties(Sf.prototype,{cS:{configurable:!0,enumerable:!0,get:function(){return this.Ikb}},coa:{configurable:!0,
enumerable:!0,get:function(){return this.xRc}},Edi:{configurable:!0,enumerable:!0,get:function(){return this.I8d}}});Object(vc.a)(Sf,"GetMoreInfoResult",mf,[317,316]);var oc=b(78),ze=b(47),Ae=b(807),Ve=b(373),nb=b(170),Hc=b(689),Cc=b(596);Qe.prototype.W8i=function(){this.R8a.fc(tf.a.openUrlInNewTab,Bd.a.frame,Object(hd.a)(this,this.openUrlInNewTab,"openUrlInNewTab"));this.R8a.fc(tf.a.bPa,Bd.a.frame,Object(hd.a)(this,this.bPa,"openDocumentUrl"));wc.AFrameworkApplication.HQ?this.bnf():this.R8a.ef(tf.a.N6b,
Bd.a.frame,Object(hd.a)(this,this.N6b,"documentLoaded"),96)};Qe.prototype.openUrlInNewTab=function(R,Aa,hb,Ib,Bc){Bc&&Bc.MenuItemId&&(R={},Tc.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",(R.Id=Bc.SourceControlId,R.AppType=Cc.a[this.gca],R)),ze.a.vf(Bc.MenuItemId.toString(),"_blank",void 0,"NewAndOpenCommonHelpers:OpenUrlInNewTab"));return 32};Qe.prototype.bPa=function(R,Aa,hb,Ib,Bc){if(Bc&&Bc.MenuItemId){var gc=wc.AFrameworkApplication.ga.ra("WacInTabOpenMRUIsEnabledForUiHost"),Id=wc.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures");
Tc.ULS.sendTraceTag(592237459,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",gc,Id);if(gc&&Id){R={};Tc.ULS.sendTraceTag(592237458,202,50,"Opening new tab {0}",(R.Id=Bc.SourceControlId,R.AppType=Cc.a[this.gca],R));Bc=Bc.MenuItemId.toString();var fe={};fe[Ve.a.bQa]="1";fe[Ve.a.documentUrl]=Bc;fe[Ve.a.reason]=Hc.a.open;Tc.ULS.sendTraceTag(592237460,202,50,"Send PostMessage to the Ui host to reboot a document");wc.AFrameworkApplication.vV().execute(function(sf){sf.Sj(nb.a.Qta,
fe)})}else this.openUrlInNewTab(R,Aa,hb,Ib,Bc)}return 32};Qe.prototype.N6b=function(){this.bnf();return 32};Qe.prototype.HNa=function(R,Aa,hb){hb=void 0===hb?"":hb;if(Aa&&Aa.iF){var Ib=Ae.a[Aa.status];Aa=Aa.iF.getTime();var Bc=this.ew()-Aa,gc={};Tc.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",(gc.Caller=R,gc.RequestStatus=Ib,gc.ElapsedMs=Bc,gc.StartTime=Aa,gc.Notes=hb,gc))}else hb={},Tc.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",
(hb.Caller=R,hb))};Qe.prototype.bnf=function(){var R=wc.AFrameworkApplication.ga.ra("QPGVCI"),Aa=oc.a.DC(document.URL,"wdNewAndOpenCt",R);if(Aa){Aa=parseInt(Aa);var hb=oc.a.DC(document.URL,"wdPreviousSession",R);R=oc.a.DC(document.URL,"wdPreviousCorrelation",R);var Ib=wc.AFrameworkApplication.ga.ra("NAOPLP");if(wc.AFrameworkApplication.HQ){var Bc=wc.AFrameworkApplication.HQ.getTime();if(!Aa||Aa>Bc)Ib={},Tc.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",
(Ib.ClickTimestamp=Aa,Ib.DocumentLoadedTime=Bc,Ib.SessionId=hb,Ib.Correlation=R,Ib));else{var gc={};Tc.ULS.sendTraceTag(5849683,202,Ib?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",(gc.ClickToLoadTime=Bc-Aa,gc.ClickTimestamp=Aa,gc.SessionId=hb,gc.Correlation=R,gc))}}else Bc={},Tc.ULS.sendTraceTag(5849681,202,Ib?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",(Bc.ClickTimestamp=Aa,Bc.SessionId=hb,
Bc.Correlation=R,Bc))}};Qe.iV=function(){return new Qe(new Nd.a(function(){return wc.AFrameworkApplication.Gb}),new Nd.a(function(){return wc.AFrameworkApplication.Jd}),new Nd.a(function(){return wc.AFrameworkApplication.sa}),new Nd.a(function(){return wc.AFrameworkApplication.sa.Qa.Pj}),new Nd.a(function(){return wc.AFrameworkApplication.hj}),function(){return(new Date).getTime()},new Nd.a(function(){return wc.AFrameworkApplication.sa.Qa.jW}),new Nd.a(function(){return wc.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage}))};
Sk.Object.defineProperties(Qe.prototype,{R8a:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},rCb:{configurable:!0,enumerable:!0,get:function(){return this.Tg.value}},lsf:{configurable:!0,enumerable:!0,get:function(){return this.flg.value}},gca:{configurable:!0,enumerable:!0,get:function(){return this.t1.value}},Ilc:{configurable:!0,enumerable:!0,get:function(){return this.me.value}},ew:{configurable:!0,enumerable:!0,get:function(){return this.WIc}},jW:{configurable:!0,enumerable:!0,
get:function(){return this.Upg.value}},supportsGetMoreInfoForPersonalStorage:{configurable:!0,enumerable:!0,get:function(){return this.zWb.value}}});Sk.Object.defineProperties(Qe,{instance:{configurable:!0,enumerable:!0,get:function(){return Qe.Oa||(Qe.Oa=Qe.iV())}}});Qe.Oa=null;Object(vc.a)(Qe,"NewAndOpenCommonHelpers",null,[282]);var Sc=b(108);sd.prototype.DIg=function(){this.KPc=this.Kbb+1};sd.prototype.gLd=function(R){this.Vi&&(this.me.Np(this.Vi),this.Vi=null);R&&(this.KPc=0)};sd.prototype.lGj=
function(R){var Aa=this.qLj;0<=Aa?(this.DIg(),this.gLd(!1),this.Vi=new Sc.a(4,1,Aa,R,107),this.me.Zg(this.Vi)):(this.gLd(!0),R={},Tc.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",(R.Action=this.c5d,R)))};Sk.Object.defineProperties(sd.prototype,{Kbb:{configurable:!0,enumerable:!0,get:function(){return this.KPc}},qLj:{configurable:!0,enumerable:!0,get:function(){return this.Kbb>=this.vYf.length?-1:this.vYf[this.Kbb]}},vYf:{configurable:!0,enumerable:!0,get:function(){if(!this.IVb){var R=(this.Pvg.value||
"0").split(",");this.IVb=[];for(var Aa=0;Aa<R.length;Aa++){var hb=parseInt(R[Aa]);isNaN(hb)?(hb={},Tc.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",(hb.Action=this.c5d,hb.Entry=R[Aa],hb))):Array.add(this.IVb,hb)}}return this.IVb}}});Object(vc.a)(sd,"RetryHelper",null,[]);var Uc=b(40),ae=b(29);vm(be,Zd);be.prototype.xyi=function(){this.Hvd("Document opened")};be.prototype.J7g=function(R){var Aa=this;return function(){Aa.Hvd(R,!0)}};be.prototype.GCf=function(R,
Aa){Aa=void 0===Aa?null:Aa;var hb={};Tc.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",(hb.Trigger=R,hb));3===this.Jo.state?(Aa&&this.qLe(Aa,this.Jo),Aa={},Tc.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",(Aa.Trigger=R,Aa))):this.Hvd(R);return this.Jo};be.prototype.Hvd=function(R,Aa){this.jlb.gLd(!(void 0===Aa?0:Aa));1===this.Jo.state?(Aa={},Tc.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",
(Aa.Trigger=R,Aa.RetryIndex=this.jlb.Kbb,Aa))):(Aa={},Tc.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",(Aa.Trigger=R,Aa.RetryIndex=this.jlb.Kbb,Aa)),this.Jo.state=1,Aa=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.aCb.jW,wc.AFrameworkApplication.mj),this.aCb.rCb.I9(Aa,1,null,null,[be.Qde,be.Xhe],!1,5,this.Q6g(),this.P6g(R),null))};be.prototype.Q6g=function(){var R=this;return function(Aa){var hb=!1,Ib=!1,Bc=!1;if(wc.AFrameworkApplication.ga.ra("GetMoreInfoDataFromResponseBody"))if(Aa.data.ie){var gc=
Uc.d(Aa.data.ie);var Id=gc.Ju;gc.returnValue?Id?(Bc=!0,R.Jo.xRc=Id.StorageServiceDisplayName,R.Jo.Ikb=be.Yif(Id.PersonalFileStorageUrl)?Id.PersonalFileStorageUrl:"",""===R.Jo.cS&&"SharePointOnlineConsumer"===wc.AFrameworkApplication.ga.Ua("FileSource")&&(R.Jo.Ikb=oc.a.hda(wc.AFrameworkApplication.breadcrumbFolderUrl)),hb=""===R.Jo.cS&&""!==R.Jo.coa):Tc.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):
Tc.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else Tc.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");Bc||((Id=Aa.data.responseHeaders)?(R.Jo.xRc=(Id[be.Xhe]||"").toString(),hb=(Id[be.Qde]||"").toString(),R.Jo.Ikb=be.Yif(hb)?hb:"",""===R.Jo.cS&&"SharePointOnlineConsumer"===wc.AFrameworkApplication.ga.Ua("FileSource")?
(R.Jo.Ikb=oc.a.hda(wc.AFrameworkApplication.breadcrumbFolderUrl),hb=""===R.Jo.cS&&""!==R.Jo.coa):hb=""===hb&&""!==R.Jo.coa):(Tc.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),Ib=!0));Bc=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",R.jlb.Kbb,Ib,hb,Bc);R.aCb.HNa("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",Aa.data,Bc);R.NYf(3,hb,Ib)}};be.prototype.P6g=function(R){var Aa=this;return function(hb){Aa.aCb.HNa("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",
hb.data,"Failure");Aa.NYf(2);Aa.jlb.lGj(Aa.J7g(R))}};be.prototype.NYf=function(R,Aa,hb){this.Jo.state=R;this.Jo.I8d=void 0===Aa?!1:Aa;this.Jo.sKc=void 0===hb?!1:hb;this.i8c(this.Jo)};be.iV=function(){return new be(new Nd.a(function(){return Qe.instance}),new Nd.a(function(){return wc.AFrameworkApplication.dUh}))};be.Yif=function(R){if(!R)return Tc.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(ae.a.Ol(R).startsWith("https://"))return!0;Tc.ULS.sendTraceTag(5849625,
202,10,"StorageUrl has invalid scheme.");return!1};Sk.Object.defineProperties(be.prototype,{aCb:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}}});Sk.Object.defineProperties(be,{instance:{configurable:!0,enumerable:!0,get:function(){return be.Oa||(be.Oa=be.iV())}}});be.Qde="PersonalFileStorageUrl";be.Xhe="StorageServiceDisplayName";be.Oa=null;Object(vc.a)(be,"GetMoreInfoActor",Zd,[]);var ue=b(98),Lf=b(93);me.prototype.aUc=function(R){this.rb.addHandler(this.Pke,R)};me.prototype.ZBg=
function(R){this.rb.addHandler(this.baf,R)};me.prototype.dGj=function(){var R=new Sc.a(5,2,this.yqg,Object(hd.a)(this,this.M9h,"inactiveLoop"),108);this.N9h.Zg(R)};me.prototype.M9h=function(){var R=this.A0e(),Aa=this.ew()-R;if(Aa>this.Uzc&&this.mT){var hb={};Tc.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",(hb.TimeSinceLastActive=Aa,hb));this.mT=!1;this.rb.raiseEvent(this.baf)}R-this.G$d>this.Uzc&&(this.mT=!0,this.rb.raiseEvent(this.Pke));this.G$d=R};me.iV=function(){return new me(new Nd.a(function(){return ue.a.instance}),
function(){return wc.AFrameworkApplication.Wkf.getTime()},function(){return(new Date).getTime()},new Nd.a(function(){return wc.AFrameworkApplication.Uzc}),!0)};Sk.Object.defineProperties(me.prototype,{N9h:{configurable:!0,enumerable:!0,get:function(){return this.me.value}},A0e:{configurable:!0,enumerable:!0,get:function(){return this.Apg}},ew:{configurable:!0,enumerable:!0,get:function(){return this.WIc}},Uzc:{configurable:!0,enumerable:!0,get:function(){return this.MWb.value}}});Sk.Object.defineProperties(me,
{instance:{configurable:!0,enumerable:!0,get:function(){return me.Oa||(me.Oa=me.iV())}}});me.Oa=null;Object(vc.a)(me,"InactivityManager",null,[]);var xf=b(84),Rf=b(1040);vm(nd,mf);nd.prototype.W2e=function(){return"MruActor Result"};Sk.Object.defineProperties(nd.prototype,{Zwd:{configurable:!0,enumerable:!0,get:function(){return this.Qbe}},Arf:{configurable:!0,enumerable:!0,get:function(){return this.Rbe}},Ywd:{configurable:!0,enumerable:!0,get:function(){return this.Pbe}},uLj:{configurable:!0,enumerable:!0,
get:function(){return this.Uie}}});Object(vc.a)(nd,"MruResult",mf,[315,316]);var dc=b(231);rc.prototype.vli=function(R,Aa){return R===dc.a.$bd||20===Aa||18===Aa||3===Aa};rc.prototype.Fmi=function(R){return 3===R||5===R||6===R||7===R||9===R||10===R||11===R||12===R||13===R||14===R||15===R||16===R||23===R||26===R||27===R||28===R};rc.prototype.reset=function(){this.Vxb=this.retryCount=0;this.SOc=this.yAb=null;this.task&&(this.taskManager.Np(this.task),this.task=null)};rc.prototype.Gci=function(R,Aa,hb,
Ib){this.SOc=String.format("{0}_{1}",hb,Ib);if(this.retryCount>=this.Zzi)return Tc.ULS.sendTraceTag(562656907,202,50,"Max retries exceeded"),!1;if(this.vli(hb,Ib))return Tc.ULS.sendTraceTag(562656908,202,50,"Encountered permanent error. Not retrying"),!1;if(this.Fmi(Ib)&&1<=this.Vxb)return this.yAb=hb,!1;Aa=Math.max(Aa,this.Cec*Math.pow(2,this.Vxb));if(26===Ib)Aa=Math.max(Aa,3E4);else if(27===Ib||28===Ib)Aa=Math.max(Aa,6E4);9===Ib||412===hb&&(null==this.yAb||412!==this.yAb)?Aa=500:this.Vxb+=1;this.yAb=
hb;this.retryCount+=1;this.task&&this.taskManager.Np(this.task);Tc.ULS.sendTraceTag(562656909,202,50,"Scheduling next retry after {0} ms.",Aa);this.task=new Sc.a(2,1,Aa,R,107);this.taskManager.Zg(this.task);return!0};Sk.Object.defineProperties(rc.prototype,{yqc:{configurable:!0,enumerable:!0,get:function(){return this.SOc}}});Object(vc.a)(rc,"RetryManager",null,[]);var Oc=b(95),Ed=b(129);Object(vc.a)(Wd,"WriteOptions",null,[]);var Gd=b(579),Ee=b(338);vm(rb,Zd);rb.prototype.K$i=function(){this.nB.R8a.fc(tf.a.renameMostRecentlyUsedFileEntry,
Bd.a.frame,Object(hd.a)(this,this.Fej,"renameMruEntry"))};rb.prototype.Fej=function(){return this.I_d("Rename")};rb.prototype.Iyi=function(){this.ypf("File Opened")};rb.prototype.Jyi=function(){this.ypf("IntervalUpdate")};rb.prototype.ypf=function(R){var Aa={};Tc.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",(Aa.Trigger=R,Aa));this.I_d(R)};rb.prototype.v4=function(R){(R=ae.a.v4(R))&&R.startsWith(".")&&(R=R.substring(1,R.length));return R};rb.prototype.NXe=function(){switch(this.nB.gca){case 3:return"Word";
case 1:return"Excel";case 2:return"PowerPoint";case 5:return"Visio";case 4:return"OneNote";default:return"Unknown"}};rb.prototype.V0h=function(R){var Aa=this.wpg();if(!Aa)return null;var hb=new Wd;hb.documentUrl=this.Z5d.value?encodeURI(Aa):Aa;hb.mruItemId=this.RTb;hb.app=this.NXe();if(Aa=this.Bv())hb.folderName=Aa.breadcrumbFolderName,Aa=Aa.zn,hb.documentName=ae.a.lr(Aa),hb.documentExt=this.v4(Aa);R&&(hb.documentName?hb.documentName.length?255<=hb.documentName.length?R.set("DocumentNameLength","Long"):
2084<=hb.documentName.length&&R.set("DocumentNameLength","VeryLong"):R.set("DocumentNameLength","0"):R.set("DocumentNameLength","Null"));return JSON.stringify(hb)};rb.prototype.I_d=function(R,Aa){Aa=void 0===Aa?!1:Aa;if(4===this.nB.gca&&!wc.AFrameworkApplication.AIa)return 2;var hb=Ed.a.Wr();hb&&(hb.set("Trigger",R),hb.set("IsRetry",Aa?"true":"false"),hb.set("MruIdSent",this.RTb?"true":"false"),hb.set("URLEncoded",this.Z5d.value?"true":"false"));Oc.Health.instance.recordKpiUsage("WriteMru",0,"smartfio",
hb);R=this.V0h(hb);if(!R)return Aa=!wc.AFrameworkApplication.webEditingEnabled,hb&&(hb.set("WebEditingIsEnabled",wc.AFrameworkApplication.webEditingEnabled?"true":"false"),hb.set("ProtectedFile",wc.AFrameworkApplication.Hqc?"true":"false")),Oc.Health.instance.recordKpiFailure("WriteMru","MissingDocumentUrl",Aa,!1,Object.assign(new Ee.a,{extendedProperties:hb})),2;this.Era&&!Aa&&this.Era.reset();hb=String.format("{0}MruV2ServiceHandler.ashx?rs={1}",this.nB.jW,this.localeName);this.hke?this.bDc["X-FileId"]=
wc.AFrameworkApplication.mj:hb+=String.format("&{0}",wc.AFrameworkApplication.mj);wc.AFrameworkApplication.Yb&&(this.bDc["X-Office-AudienceGroup"]=Object(xf.a)(String,wc.AFrameworkApplication.Yb.AudienceGroup)||"");this.bDc["X-Timeout"]=15E3;return this.nB.rCb.Xl(hb,2,R,this.bDc,!0,5,Object(hd.a)(this,this.cZj,"writeMruV2EntryOnServerSuccessCallback"),Object(hd.a)(this,this.oah,"createWriteMruV2EntryOnServerFailureCallback"),null,void 0,void 0,void 0,void 0,"4")};rb.prototype.cZj=function(R){this.f7e(R.data)};
rb.prototype.f7e=function(R){var Aa=Ed.a.Wr();this.Era&&(Aa&&this.Era.yqc&&(Aa.set("LastError",this.Era.yqc),Aa.set("NumRetries",this.Era.retryCount.toString())),this.Era.reset());var hb=Rf.c(R.ie);hb&&hb.diagnostics_data&&(this.RTb=hb.diagnostics_data.mru_id);R=+R.q3-+R.iF;Aa&&Aa.set("RequestDuration",R.toString());Oc.Health.instance.recordKpiSuccess("WriteMru",Object.assign(new Ee.a,{extendedProperties:Aa}))};rb.prototype.oah=function(R){if(R.data.httpStatus===dc.a.orb)this.f7e(R.data);else{var Aa=
R.data.httpStatus===dc.a.AFb,hb=Ed.a.Wr();this.r7e(this.Era,R,this.dah(),hb);hb&&(hb.set("StatusCode",R.data.httpStatus.toString()),Aa||this.jUc(R.data,hb));Oc.Health.instance.recordKpiFailure("WriteMru",String.format("RequestFailed_{0}",R.data.httpStatus),Aa,!1,Object.assign(new Ee.a,{extendedProperties:hb}))}};rb.prototype.dah=function(){var R=this;return function(){R.I_d("Retry",!0)}};rb.prototype.kUh=function(){this.u8a("Polling")};rb.prototype.jUh=function(){this.u8a("Retry",!0)};rb.prototype.Byi=
function(){this.u8a("Open")};rb.prototype.Ayi=function(){this.u8a("Activity")};rb.prototype.zyi=function(){this.u8a("OpenRecentLinks",!1,!0)};rb.prototype.yyi=function(){this.u8a("ActivityRecentLinks",!1,!0)};rb.prototype.u8a=function(R,Aa,hb){Aa=void 0===Aa?!1:Aa;hb=void 0===hb?!1:hb;var Ib={};Tc.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",(Ib.Trigger=R,Ib));if(Ib=Ed.a.Wr())Ib.set("Trigger",R),Ib.set("IsRetry",Aa?"true":"false");Oc.Health.instance.recordKpiUsage("GetMru",0,"smartfio",
Ib);this.$qa&&!Aa&&this.$qa.reset();hb?this.nEe(Object(hd.a)(this,this.lUh,"getMruV2ForRecentLinksFromServerSuccessCallback"),Object(hd.a)(this,this.hUh,"getMruForRecentLinksFromServerFailureCallback"),!0):this.nEe(Object(hd.a)(this,this.mUh,"getMruV2FromServerSuccessCallback"),Object(hd.a)(this,this.iUh,"getMruFromServerFailureCallback"))};rb.prototype.jUc=function(R,Aa){R&&R.responseHeaders&&(R=R.responseHeaders["X-CorrelationId"])&&Aa.set("ServerCorrelationId",R)};rb.prototype.uvi=function(R,Aa){R&&
(Aa&&Aa.set("RequestDuration",(+R.q3-+R.iF).toString()),Oc.Health.instance.recordKpiSuccess("GetMru",Object.assign(new Ee.a,{extendedProperties:Aa})))};rb.prototype.mUh=function(R){this.d1e(R)};rb.prototype.d1e=function(R,Aa){Aa=void 0===Aa?!1:Aa;var hb="",Ib=null,Bc=null,gc=null,Id=Rf.c(R.data.ie);Id&&(Ib=Id.places?Id.places.items:[],Bc=Id.documents?Id.documents.items:[],(gc=Rf.a(Id,Aa))&&(hb=Uc.c(gc)));wc.AFrameworkApplication.sa&&wc.AFrameworkApplication.sa.Qa.f_&&yb.c()&&!Aa&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(hb,
!0));hb=Ed.a.Wr();this.$qa&&(hb&&this.$qa.yqc&&(hb.set("LastError",this.$qa.yqc),hb.set("NumRetries",this.$qa.retryCount.toString())),this.$qa.reset());Aa&&hb&&hb.set("RecentLinks","true");gc||Ib||Bc?(this.nB.HNa("MruActor.GetMruV2FromServerSuccessCallback",R.data,"Success"),this.GBc(3,gc,Ib,Bc),this.uvi(R.data,hb)):(this.nB.HNa("MruActor.GetMruV2FromServerSuccessCallback",R.data,"Failure: Invalid JSON"),hb&&this.jUc(R.data,hb),Oc.Health.instance.recordKpiFailure("GetMru","JsonParseFailed",!1,!1,
Object.assign(new Ee.a,{extendedProperties:hb})),this.GBc(3,null,null,null,!0));this.i8c(this.pT)};rb.prototype.lUh=function(R){this.d1e(R,!0)};rb.prototype.r7e=function(R,Aa,hb,Ib){var Bc=0,gc=0,Id=Rf.c(Aa.data.ie);Id&&(null!=Id.response_code&&(Bc=Id.response_code,Ib&&Ib.set("MruResponseCode",Bc.toString()),9===Bc&&(this.RTb="")),Id.error_data&&null!=Id.error_data.retry_after_ms&&(gc=Id.error_data.retry_after_ms,Ib&&Ib.set("ExpectedRetryAfter",gc.toString())));R&&(Aa=R.Gci(hb,gc,Aa.data.httpStatus,
Bc),Ib&&(Ib.set("CurrentRetryCount",R.retryCount.toString()),Ib.set("RetryScheduled",Aa?"true":"false")))};rb.prototype.iUh=function(R){this.c1e(R)};rb.prototype.c1e=function(R){var Aa=void 0===Aa?!1:Aa;var hb=R.data.httpStatus===dc.a.AFb,Ib=Ed.a.Wr();Ib&&(Ib.set("StatusCode",R.data.httpStatus.toString()),Aa&&Ib.set("RecentLinks","true"),hb||this.jUc(R.data,Ib));this.nB.HNa("MruActor.GetMruFromServerFailureCallback",R.data,"Failure");this.GBc(2);this.r7e(this.$qa,R,Object(hd.a)(this,this.jUh,"getMruFromServerRetryTask"),
Ib);Oc.Health.instance.recordKpiFailure("GetMru",String.format("RequestFailed_{0}",R.data.httpStatus),hb,!1,Object.assign(new Ee.a,{extendedProperties:Ib}));this.i8c(this.pT);wc.AFrameworkApplication.sa&&wc.AFrameworkApplication.sa.Qa.f_&&yb.c()&&(appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)),Aa||appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson("",!1)))};rb.prototype.hUh=function(R){this.c1e(R)};rb.prototype.GBc=function(R,Aa,hb,Ib,Bc){if(3!==this.pT.state||3===R)this.pT.Qbe=
void 0===Aa?null:Aa,this.pT.Rbe=void 0===hb?null:hb,this.pT.Pbe=void 0===Ib?null:Ib,this.pT.state=R,this.pT.sKc=void 0===Bc?!1:Bc,this.pT.Uie=this.nB.ew()};rb.prototype.GCf=function(R,Aa){var hb={};Tc.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",(hb.Trigger=R,hb.ResultState=this.pT.state,hb));Aa&&3===this.pT.state&&this.qLe(Aa,this.pT);return this.pT};rb.prototype.nEe=function(R,Aa,hb){hb=void 0===hb?!1:hb;this.GBc(1);var Ib={};var Bc=hb?String.format(this.nB.jW+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}&cap={3}",
this.Hug,"OfficeSuite",this.localeName,"ClassicMru"):String.format(this.nB.jW+"MruV2ServiceHandler.ashx?sort=Date&show={0}&apps={1}&rs={2}",10,this.NXe(),this.localeName);this.Gug.value||(Bc+="&entity=docs");wc.AFrameworkApplication.Yb&&(Ib["X-Office-AudienceGroup"]=Object(xf.a)(String,wc.AFrameworkApplication.Yb.AudienceGroup)||"");hb&&(Ib["X-Office-Application"]="147");this.hke?Ib["X-FileId"]=wc.AFrameworkApplication.mj:Bc+=String.format("&{0}",wc.AFrameworkApplication.mj);this.nB.rCb.Xl(Bc,1,null,
Ib,!0,5,R,Aa,null)};rb.iV=function(){return new rb(new Nd.a(function(){return Qe.instance}),new Nd.a(function(){return Gd.a.cK(wc.AFrameworkApplication.lcid).name}),new Nd.a(function(){return wc.AFrameworkApplication.sa.Qa.rw}),wc.AFrameworkApplication.ga.ra("MruWriteFileIdInHeader"),function(){return wc.AFrameworkApplication.sa.Qa.eC},function(){return wc.AFrameworkApplication.dm},new Nd.a(function(){return wc.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled")}))};Sk.Object.defineProperties(rb.prototype,
{bDc:{configurable:!0,enumerable:!0,get:function(){return this.Xyg}},nB:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},localeName:{configurable:!0,enumerable:!0,get:function(){return this.lsg.value}}});Sk.Object.defineProperties(rb,{instance:{configurable:!0,enumerable:!0,get:function(){return rb.Oa||(rb.Oa=rb.iV())}}});rb.Oa=null;Object(vc.a)(rb,"MruActor",Zd,[]);ld.prototype.ji=function(R){this.tb=R;R.register(282,"Common.INewAndOpenCommonHelpers").Bc().Lc(function(){return Qe.instance});
R.register(283,"Common.IEventEmitter<Common.IGetMoreInfoResult>").Bc().Lc(function(){return be.instance});R.register(283,"Common.IEventEmitter<Common.IMruResult>").Bc().Lc(function(){return rb.instance})};ld.prototype.init=function(){var R=this;wc.AFrameworkApplication.ga.ow(function(){R.Fxb()})};ld.prototype.Fxb=function(){this.tb.resolve("Common.INewAndOpenCommonHelpers");this.tb.resolve("Common.IEventEmitter<Common.IGetMoreInfoResult>");this.tb.resolve("Common.IEventEmitter<Common.IMruResult>");
var R=!1;Qe.instance.W8i();wc.AFrameworkApplication.Ola&&(R=!0);wc.AFrameworkApplication.cNf&&(rb.instance.Byi(),wc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&rb.instance.zyi(),0<wc.AFrameworkApplication.Brf&&this.hme(),this.dwj(),R=!0);wc.AFrameworkApplication.supportsGetMoreInfoForPersonalStorage&&R&&be.instance.xyi();wc.AFrameworkApplication.qTj&&(R=rb.instance,R.K$i(),R.Iyi(),ue.a.instance.Zg(this.rTj))};ld.prototype.dwj=function(){me.instance.aUc(Object(hd.a)(rb.instance,
rb.instance.Ayi,"makeGetMruRequestActivityTrigger"));wc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.recentLinksIsEnabled",!1)&&me.instance.aUc(Object(hd.a)(rb.instance,rb.instance.yyi,"makeGetMruForRecentLinksRequestActivityTrigger"));me.instance.aUc(Object(hd.a)(this,this.hme,"addGetMruFromServerTask"));me.instance.ZBg(Object(hd.a)(this,this.qdh,"deleteGetMruFromServerTask"))};ld.prototype.qdh=function(){ue.a.instance.Np(this.Crf)};ld.prototype.hme=function(){ue.a.instance.Zg(this.Crf)};
ld.prototype.dispose=function(){this.tm||(this.tm=!0,this.jmb&&(ue.a.instance.Np(this.jmb),this.jmb=null))};Sk.Object.defineProperties(ld.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.Core"}},Crf:{configurable:!0,enumerable:!0,get:function(){return this.Qee||(this.Qee=new Sc.a(5,2,wc.AFrameworkApplication.Brf,Object(hd.a)(rb.instance,rb.instance.kUh,"getMruFromServerTask"),109))}},rTj:{configurable:!0,enumerable:!0,get:function(){return this.jmb||(this.jmb=
new Sc.a(2,2,6E4*wc.AFrameworkApplication.ga.getIntFeatureGate("Microsoft.Office.SharedOnline.MruUpdateIntervalInMinutes",1440),Object(hd.a)(rb.instance,rb.instance.Jyi,"makeUpdateMruTask"),197))}}});Object(vc.a)(ld,"CorePackageManager",null,[4,5,3]);var ee=b(516);new Qd(0,0,0,0,0,0);new Qd(1,1,0,0,0,0);new Qd(2,2,0,0,0,0);new Qd(3,3,0,0,0,1);new Qd(4,3,1,0,1,1);new Qd(5,3,0,0,.42,1);new Qd(6,3,.83,0,1,1);new Qd(7,3,0,0,.58,1);new Qd(8,3,.42,0,.58,1);new Qd(9,3,.1,.25,.75,.9);new Qd(10,3,.1,.9,.2,
1);new Qd(11,3,.1,.9,.2,1);new Qd(12,3,.9,.1,.2,1);new Qd(13,3,.4,0,0,1);new Qd(14,3,.13,.21,.1,.7);new Qd(15,3,.02,.33,.38,.77);new Qd(16,3,.57,.17,.95,.75);new Qd(17,3,0,.19,.07,.72);new Qd(18,3,0,0,.95,.37);new Qd(19,3,.66,0,.34,1);new Qd(20,3,.8,0,.2,1);ke.prototype={type:0,startTime:new od(0,null),endTime:new od(0,null),X0j:new od(0,null),Q_j:new od(0,null),operationType:0};new Re(0,[new ke(5,0,0,0,null,1,1,0)]);new Re(1,[new ke(5,2,0,0,null,0,2,0),new ke(5,2,0,50,null,1,1,0)]);new Re(2,[new ke(1,
3,0,167,null,0,1,1),new ke(2,3,0,167,null,0,1,1)]);new Re(3,[new ke(3,3,0,167,null,0,1,1),new ke(4,3,0,167,null,0,1,1)]);new Re(4,[new ke(5,2,0,0,null,0,2,0),new ke(5,2,0,167,null,1,1,0)]);new Re(5,[new ke(5,2,0,167,null,0,1,0)]);new Re(6,[new ke(1,3,0,100,null,0,1,1),new ke(2,3,0,100,null,0,1,1)]);new Re(7,[new ke(3,3,0,100,null,0,1,1),new ke(4,3,0,100,null,0,1,1)]);new Re(8,[new ke(5,2,0,100,null,1,1,0)]);new Re(9,[new ke(5,2,0,0,null,0,2,0),new ke(5,2,0,100,null,1,1,0)]);new Re(10,[new ke(5,2,
0,100,null,0,1,0)]);new Re(11,[new ke(1,3,0,267,null,0,1,1),new ke(2,3,0,267,null,0,1,1)]);new Re(12,[new ke(3,3,0,267,null,0,1,1),new ke(4,3,0,267,null,0,1,1)]);new Re(13,[new ke(5,2,0,267,null,1,1,0)]);new Re(14,[new ke(5,2,0,0,null,0,2,0),new ke(5,2,0,267,null,1,1,0)]);new Re(15,[new ke(5,2,0,267,null,0,1,0)]);new Re(16,[new ke(6,3,0,267,null,0,1,1),new ke(7,3,0,267,null,0,1,1)]);new Re(17,[new ke(1,3,0,750,null,0,1,1),new ke(2,3,0,750,null,0,1,1)]);new Re(18,[new ke(3,3,0,750,null,0,1,1),new ke(4,
3,0,750,null,0,1,1)]);new Re(19,[new ke(5,2,0,750,null,1,1,0)]);new Re(20,[new ke(5,2,0,0,null,0,2,0),new ke(5,2,0,750,null,1,1,0)]);new Re(21,[new ke(6,3,0,1E3,null,0,1,1),new ke(7,3,0,1E3,null,0,1,1)]);new Re(22,[new ke(1,3,0,367,null,0,1,1),new ke(2,3,0,367,null,0,1,1)]);new Re(23,[new ke(3,3,0,367,null,0,1,1),new ke(4,3,0,367,null,0,1,1)]);new Re(24,[new ke(5,2,0,367,null,1,1,0)]);new Re(25,[new ke(5,2,0,0,null,0,2,0),new ke(5,2,0,367,null,1,1,0)]);new Re(26,[new ke(5,2,0,367,null,0,1,0)]);new Re(27,
[new ke(5,2,0,0,null,1,1,0),new ke(5,2,0,50,null,0,1,0)]);new Re(28,[new ke(1,3,0,433,null,0,1,1),new ke(2,3,0,433,null,0,1,1)]);new Re(29,[new ke(5,2,0,0,null,0,2,0),new ke(5,2,0,50,null,1,1,0),new ke(2,3,0,0,null,40,1,1),new ke(2,3,0,100,null,0,1,1)]);new Re(30,[new ke(2,0,0,0,null,32,1,1),new ke(2,0,0,100,null,32,1,1),new ke(2,3,101,350,null,0,1,1),new ke(3,0,0,0,null,0,2,1),new ke(3,0,0,100,null,0,2,1),new ke(3,3,101,350,null,0,1,1),new ke(5,0,0,0,null,0,2,0),new ke(5,0,0,100,null,1,1,0)]);new Re(31,
[new ke(2,3,0,267,null,32,1,1),new ke(3,3,0,267,null,0,2,1),new ke(5,2,0,0,null,1,0,0),new ke(5,2,0,267,null,0,2,0)]);new Re(32,[new ke(5,2,0,0,null,0,2,0),new ke(5,2,0,100,null,0,2,0),new ke(5,2,101,267,null,1,1,0)]);new Re(33,[new ke(1,10,0,300,null,0,1,1),new ke(2,10,0,300,null,0,1,1)]);new Re(34,[new ke(3,10,0,300,null,0,1,1),new ke(4,10,0,300,null,0,1,1)]);new Re(35,[new ke(1,8,0,750,null,0,1,1),new ke(2,8,0,750,null,0,1,1)]);new Re(36,[new ke(5,2,0,0,null,0,2,0),new ke(5,2,0,200,null,0,2,0),
new ke(5,3,201,500,null,1,1,0)]);new Re(37,[new ke(1,2,0,0,null,0,2,1),new ke(2,2,0,0,null,0,2,1),new ke(1,2,0,200,null,0,2,1),new ke(2,2,0,200,null,0,2,1),new ke(1,3,201,267,null,0,1,1),new ke(2,3,201,267,null,0,1,1)]);new Re(38,[new ke(1,3,0,267,null,0,1,1),new ke(2,3,0,267,null,0,1,1)]);new Re(39,[new ke(5,2,0,0,null,0,2,0),new ke(5,2,0,267,null,1,1,0)]);new Re(40,[new ke(5,2,0,267,null,0,1,0)]);window.location.search.indexOf("AnimationLogging=1");window.requestAnimationFrame=function(){return window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(R){window.setTimeout(R,16)}}();lf.prototype={Pe:null,GJg:5,Onb:null,tWc:0,startTime:null,duration:null,o7b:null,QXc:-1,Ewd:-1,$vd:-1};lf.prototype.Start=function(){this.startTime=new Date;this.o7b={}};lf.prototype.GetRecentAnimationStats=function(){var R,Aa=[],hb=0;for(R=hf.tWc;R<hf.GJg;R++)null!=hf.Onb[R]&&(Aa[hb]=hf.Onb[R],hb++);for(R=0;R<hf.tWc;R++)null!=
hf.Onb[R]&&(Aa[hb]=hf.Onb[R],hb++);return Aa};lf.prototype.GetAnimationSqmStats=function(){var R=[];return R[0]=0>hf.QXc?0:hf.QXc,R[1]=0>hf.Ewd?0:hf.Ewd,R[2]=0>hf.$vd?0:hf.$vd,R};var hf=new lf;var kf=b(214),rf=b(244),ng=b(1205),je=b(143),bg=b(56),ig=b(35),Yd=b(69),If=b(19),Pd=b(14),Ze=ng.a;vm(zc,Ze);zc.prototype.nW=function(R){this.$.Hd&65536&&Ze.prototype.nW.call(this,R)};zc.prototype.M6e=function(R){if(If.a.equals(this.Hrj,this.$.shortcutKeyManager.hfd(R),!1)){var Aa=je.b(this.$);if(null===Aa||
void 0===Aa?0:Aa.canReceiveFocus)Yd.g(R),Aa.Ne(!0,!1)}};Sk.Object.defineProperties(zc.prototype,{mode:{configurable:!0,enumerable:!0,get:function(){return this.NB},set:function(R){this.NB=R;switch(R){case 0:this.jla=this.NNg;break;case 2:this.jla=this.$Wj;break;case 3:this.jla=this.W1i;break;case 4:this.jla=this.VVg;break;case 5:this.jla=this.y1i;break;case 6:this.jla=this.I1i;break;default:Tc.ULS.shipAssertTag(537170759,0,!0,"Accessibility Mode value is not in allowed values")}}}});Object(vc.a)(zc,
"EwaAccessibilityManager",ng.a,[]);var Yf=kf.a;vm(qd,Yf);qd.prototype.create=function(){this.Fb(this.$.da.Aa(15)||new zc(this.$))};qd.ja=function(R){R.da.Ha(157,new qd(R))};Object(vc.a)(qd,"AccessibilityManagerFactory",kf.a,[]);var Xf=b(10),rg=b(138),uf=b(645),kg=uf.a;vm(bc,kg);bc.prototype.dispose=function(){rg.WacAirSpace.Tmd()&&rg.WacAirSpace.$zc()};bc.prototype.animate=function(R,Aa,hb,Ib,Bc){Aa&&rg.WacAirSpace.uL(R.element,Aa);rg.WacAirSpace.animate(R,Ib,Bc);hb&&rg.WacAirSpace.daj(R.element,
hb)};Object(vc.a)(bc,"AnimationManager",uf.a,[3]);var qh=b(101),La=b(184),Db=b(940),uc=b(525),Vc=b(86),yd=b(74),Md=yd.a;vm(Ke,Md);Ke.prototype.Tij=function(){var R=new La.a,Aa=uc.a.Tq(Vc.a.instance.oc("Common.IEventEmitter<Common.IMruResult>")),hb=new Nd.a(function(){return Aa.result});this.ktd=new Nd.a(function(){return new Db.a(hb.value,null)});if(!this.ktd)return R;var Ib=this.ktd.value.hz("NewAndOpenCoreManager",!1);if(!Ib||3!==Ib.state||!Ib.Ywd)return Ib?Tc.ULS.sendTraceTag(544289226,0,50,"NewAndOpenCoreManager.RetrieveMruFiles - the mruResult state: {0}, mruResult MruDocuments is null: {1}",
Ib.state,!Ib.Ywd):Tc.ULS.sendTraceTag(544289227,0,50,"NewAndOpenCoreManager.RetrieveMruFiles: the mruResult is null"),null;Ib=Ib.Ywd;for(var Bc=["xlsx","xlsb","xlsm"],gc=0;gc<Ib.length;gc++){var Id=Ib[gc];if(!(0>Array.indexOf(Bc,Id.extension))){var fe=String.format("{0}.{1}",Id.title,Id.extension),sf=Rf.b(Id,wc.AFrameworkApplication.isRtl);Id=Id.url;if(fe&&sf&&Id){var hg={};R.add((hg[Ke.fileName]=fe,hg[Ke.friendlyPath]=sf,hg[Ke.section]="mru",hg[Ke.absoluteUrl]=Id,hg))}else Id||Tc.ULS.sendTraceTag(537155200,
0,50,"ChangeSourceDialog.GetMruFiles: the DAV url of the file is null")}}return R};Ke.prototype.dispose=function(){Md.prototype.dispose.call(this)};Ke.fileName="FileName";Ke.friendlyPath="FriendlyPath";Ke.section="Section";Ke.absoluteUrl="AbsoluteUrl";Object(vc.a)(Ke,"NewAndOpenCoreManager",yd.a,[272,3]);var qe=kf.a;vm(oe,qe);oe.prototype.create=function(){this.Fb(this.$.da.Aa(451)||this.$.da.Ha(451,new Ke(this.$)))};oe.ja=function(R){R.da.Ha(164,new oe(R))};Object(vc.a)(oe,"NewAndOpenCoreFactory",
kf.a,[]);var ac=b(1),Kc=b(28),dd=b(4),Ud=b(11),Le=b(239),ce=b(20);se.a3a=function(R){R=ae.a.Lf(R||"");return new se(R)};se.t$b=function(R){return se.a3a(Pd.a.instance.fa(R))};se.Bcd=function(R){return new se(Pd.a.instance.Va(R))};se.rGh=function(R,Aa){for(var hb=[],Ib=1;Ib<arguments.length;++Ib)hb[Ib-1]=arguments[Ib];return se.qGh.apply(null,[Pd.a.instance.Cb(R)].concat(hb))};se.qGh=function(R,Aa){for(var hb=[],Ib=1;Ib<arguments.length;++Ib)hb[Ib-1]=arguments[Ib];Ib=hb.length;for(var Bc=Array(Ib),
gc=0;gc<Ib;gc++)Bc[gc]=(hb[gc]||se.vLe).iuc;return new se(String.format.apply(null,[R].concat(Bc)))};Sk.Object.defineProperties(se,{vLe:{configurable:!0,enumerable:!0,get:function(){return se.W5d||(se.W5d=new se(""))}},Oud:{configurable:!0,enumerable:!0,get:function(){return se.Xae||(se.Xae=se.Bcd(2).iuc)}}});se.W5d=null;se.Xae=null;Object(vc.a)(se,"SafeHtml",null,[304]);Jd.prototype.dispose=function(){this.$&&this.unregister();Ud.DOMElementExtensions.Tf(this.tha);Ud.DOMElementExtensions.Tf(this.efa);
Ud.DOMElementExtensions.Tf(this.sga);this.sga=this.efa=this.tha=this.$=null};Jd.prototype.setEnabled=function(R){this.HZf(this.sga,R)};Jd.prototype.drj=function(){this.HZf(this.efa,!0)};Jd.prototype.readText=function(R){this.oGb(se.a3a(R),!0)};Jd.prototype.YPa=function(R){this.oGb(se.a3a(R),!1)};Jd.prototype.dNf=function(R,Aa){if(1>Aa||!R)Tc.ULS.shipAssertTag(537153954,0,!1,"Skiping listbox description readout");else{var hb=new Sys.StringBuilder;R=String.format(Pd.a.instance.Cb(33),Aa,R);Sd(hb,R);
Sd(hb,Pd.a.instance.fa(839));this.oGb(se.a3a(hb.toString()),!1)}};Jd.prototype.K6i=function(R,Aa,hb){if(1>hb||1>Aa||Aa>hb||!R)Tc.ULS.shipAssertTag(537153952,0,!1,"Skipping listbox item readout");else{var Ib=new Sys.StringBuilder;Sd(Ib,R);Ib.append(String.format(Pd.a.instance.Cb(54),Aa,hb));this.oGb(se.a3a(Ib.toString()),!1)}};Jd.prototype.aNf=function(R){R=this.QXh(R);this.oGb(R,!1)};Jd.prototype.oGb=function(R,Aa){if(R=R?R.iuc:null)Aa=Aa?this.sga:this.efa,If.a.equals(Aa.innerHTML,R,!1)&&(R+=se.Oud),
Aa.innerHTML=R};Jd.prototype.wab=function(R,Aa){this.tha.getAttribute(dd.a.dsa)!==Aa&&this.tha.setAttribute(dd.a.dsa,Aa);R=R?se.a3a(R).iuc:"";this.tha.innerHTML=R};Jd.prototype.L6i=function(R,Aa,hb,Ib,Bc){Bc=void 0===Bc?!1:Bc;var gc=Pd.a.instance.Cb(53);Tc.ULS.shipAssertTag(537153949,0,!(void 0===R||null===R));Tc.ULS.shipAssertTag(537153948,0,!(void 0===Aa||null===Aa));Tc.ULS.shipAssertTag(537153947,0,!(void 0===hb||null===hb));Tc.ULS.shipAssertTag(537153946,0,!(void 0===Ib||null===Ib));Tc.ULS.shipAssertTag(537153945,
0,!(void 0===gc||null===gc));R=String.format(gc,R||"",Aa||"",hb||"",Ib||"");Bc?this.wab(R,dd.a.uZa):this.readText(R)};Jd.prototype.lRj=function(R){var Aa=this.sga.style;R?(R=Le.a.B0b(R.cell,Aa),Aa=R.GI,Aa.top=Aa.left=Aa.bottom=Aa.right=null,R.Z9()):Aa.cssText=""};Jd.prototype.QXh=function(R){switch(R){case -1985798686:return se.t$b(12);case -911352779:return se.t$b(11);case 237279923:return se.t$b(13);case -1502853784:return se.Bcd(81);case -111689794:return se.Bcd(78);case -287251124:return this.Kgd(1290,
function(Aa){return Aa.bold});case -1925065947:return this.Kgd(1291,function(Aa){return Aa.italic});case 1764140053:return this.Kgd(1292,function(Aa){return Aa.underline})}return null};Jd.prototype.register=function(){Tc.ULS.shipAssertTag(537153944,0,!!this.$,"Can't register to ewaControl's events");this.$&&(Tc.ULS.shipAssertTag(537153943,0,!!this.$.Ka,"Can't register to CommandHandlerManager's event"),this.$.Ka&&this.$.Ka.CFa(this.kwf))};Jd.prototype.unregister=function(){this.$&&this.$.Ka.uQa(this.kwf)};
Jd.prototype.HZf=function(R,Aa){var hb=R===this.efa;Aa?(R.setAttribute(dd.a.dsa,dd.a.uZa),hb&&R.setAttribute(dd.a.Td,dd.a.csa),R.setAttribute(dd.a.XP,dd.a.Po),R.removeAttribute(dd.a.XP),R.innerHTML+=" "):(R.removeAttribute(dd.a.dsa),hb&&R.removeAttribute(dd.a.Td),R.setAttribute(dd.a.XP,dd.a.vj))};Jd.prototype.Kgd=function(R,Aa){var hb=this.activeCell;if(!hb)return null;Aa=Aa(hb)?7:8;return se.rGh(Aa,se.t$b(R))};Sk.Object.defineProperties(Jd.prototype,{Lxa:{configurable:!0,enumerable:!0,get:function(){return this.tsg}},
isActive:{configurable:!0,enumerable:!0,get:function(){return!0}},activeCell:{configurable:!0,enumerable:!0,get:function(){return ce.g(this.$).uc(null)}}});Object(vc.a)(Jd,"AriaLiveNotifier",null,[280,235,3]);var Nf=kf.a;vm(Ue,Nf);Ue.prototype.create=function(){this.Fb(this.$.da.Aa(211)||new Jd(this.$,this.$.Vv,this.$.tf))};Ue.ja=function(R){R.da.Ha(212,new Ue(R))};Object(vc.a)(Ue,"AriaLiveNotifierFactory",kf.a,[]);var af=b(23),wf=b(208);Me.prototype.readText=function(R){this.LW.setAttribute(dd.a.Et,
R);this.V6.setAttribute(dd.a.Et,R);this.HIj()};Me.prototype.dispose=function(){this.h0&&this.h0.parentNode&&this.h0.parentNode.removeChild(this.h0);this.V6=this.LW=this.h0=this.lja=null};Me.prototype.r9g=function(R){var Aa=R.Ib+"readoutElementWrapper",hb=R.Ib+"readoutElement1",Ib=R.Ib+"readoutElement2";this.h0=document.getElementById(Aa);this.h0||(this.h0=document.createElement(wf.a.div),this.h0.id=Aa,this.LW=document.createElement(wf.a.label),this.LW.id=hb,this.V6=document.createElement(wf.a.label),
this.V6.id=Ib,this.LW.style.width="0px",this.LW.style.height="0px",this.V6.style.width="0px",this.V6.style.height="0px",this.LW.tabIndex=-1,this.V6.tabIndex=-1,this.h0.appendChild(this.LW),this.h0.appendChild(this.V6),R=R.Ib+dd.a.F2c,Aa=document.getElementById(R),Tc.ULS.shipAssertTag(537153942,3,!!Aa,"FocusBasedReadout.CreateReadoutElementsIfNeeded: expected to find contentAreaDiv with id: {0}",R),Aa&&Aa.appendChild(this.h0))};Me.prototype.T0i=function(){this.lja&&this.LW&&this.V6&&(this.lja.setAttribute(dd.a.P2,
this.LW.id),this.lja.setAttribute(dd.a.bXc,String.format("{0} {1}",this.LW.id,this.V6.id)))};Me.prototype.HIj=function(){if(this.isActive){var R="";Ud.DOMElementExtensions.hasAttribute(this.lja,dd.a.P2)&&(R=this.lja.getAttribute(dd.a.P2).toString());this.lja.setAttribute(dd.a.P2,R===this.LW.id?this.V6.id:this.LW.id)}else Tc.ULS.shipAssertTag(537153941,0,!1,"FocusBasedReadout.SwitchVirtualFocus: called when is not active.")};Me.i6a=function(){if(null==Me.Otb)if(ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ActiveDescendantGridReadout",
!1))Me.Otb=!0,Tc.ULS.sendTraceTag(537153940,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: ActiveDescendantGridReadout Flight is enabled");else if(Me.Otb=!1,af.a.MH||af.a.Df)Me.Otb=!0,Tc.ULS.sendTraceTag(537153939,0,50,"FocusBasedReadout.IsFocusBasedCellReadoutActive: The FocusBasedCellReadout BRS is on");return Me.Otb};Me.ja=function(R){Me.i6a()&&R.da.Ha(244,new Me(R,ce.g(R).pc.textBox.nf))};Sk.Object.defineProperties(Me.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return!!this.lja&&
document.activeElement===this.lja}}});Me.Otb=null;Object(vc.a)(Me,"FocusBasedReadout",null,[235,3]);var vf=kf.a;vm(Ad,vf);Ad.prototype.create=function(){var R=this;Me.i6a()?ce.g(this.$).pc.textBox.oU(function(){var Aa=R.$.da.Aa(244)||new Me(R.$,ce.g(R.$).pc.textBox.nf);R.Fb(Aa)}):this.Fb(null)};Ad.ja=function(R){R.da.Ha(315,new Ad(R))};Object(vc.a)(Ad,"FocusBasedReadoutFactory",kf.a,[]);var pg=b(88),bf=b(24),Bf=b(43),$e=b(236),He=b(44),vg=b(42),ah=b(115);fd.Cgd=function(R){return fd.A2e(R.toString())};
fd.A2e=function(R){return fd.mXg.test(R)?R.replace(fd.B5i,"$1 ").replace(fd.A5i,' "$1"').trim():R};fd.sfj=function(R){var Aa=R.lastIndexOf("!");return R.substring(0,-1<Aa?Aa+1:0)+fd.A2e(R.substring(-1<Aa?Aa+1:0,R.length))};Sk.Object.defineProperties(fd,{B5i:{configurable:!0,enumerable:!0,get:function(){return fd.Iee||(fd.Iee=RegExp("([A-Z]+)","g"))}},A5i:{configurable:!0,enumerable:!0,get:function(){return fd.Hee||(fd.Hee=RegExp("([A-Z])","g"))}},mXg:{configurable:!0,enumerable:!0,get:function(){return fd.m3d||
(fd.m3d=RegExp("^\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+\\$?[0-9]+:\\$?[A-Z]+\\$?[0-9]+$|^\\$?[A-Z]+:\\$?[A-Z]+$|^\\$?[0-9]+:\\$?[0-9]+$"))}}});fd.Iee=null;fd.Hee=null;fd.m3d=null;Object(vc.a)(fd,"RangeAriaExtensions",null,[]);Object(vc.a)(Qb,"SelectionReadoutState",null,[]);var Ph=b(61),Pf=b(77);Zc.prototype.dispose=function(){this.$&&this.un();pg.a.Fa(this.E_b);this.sparklineManager=this.$=this.E_b=null};Zc.prototype.sYe=function(R,Aa,hb){hb=void 0===hb?!0:hb;if(!R)return"";var Ib=this.$.da,Bc=new Sys.StringBuilder;
this.rKg(Bc,R,Aa);if(ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4124702_ColumnHeaderReadout")){var gc=this.tableManager.vKa(R.range);(null===gc||void 0===gc?0:gc.BRd)&&this.Sqe(Bc,gc);gc=this.tableManager.En(R.range);(null===gc||void 0===gc?0:gc.Xva)&&this.Sqe(Bc,gc)}gc=R.bba?this.c0e(R):R.text;Sd(Bc,gc);gc=this.$.activeItemName;this.iD.activeItemName!==gc&&(Sd(Bc,gc),this.iD.activeItemName=gc);gc=1===Aa.length?Bf.K(Aa).isSingle?"":Pd.a.instance.fa(835):String.format(Pd.a.instance.Cb(30),Aa.length);
Sd(Bc,gc);gc=yl(Aa);for(var Id=gc.next();!Id.done;Id=gc.next())Id=Id.value,Sd(Bc,fd.Cgd(Id)),1===Aa.length&&Zc.Noi(Id)&&(Id=ce.g(this.$).Ca.es(Id.bottomRight),void 0!==Id&&null!==Id&&Id.text&&(Id=Id.bba?this.b0e(Id,Id.text):Id.text,Sd(Bc,Id)));gc=R.cell;gc=this.uVh(gc.Yjj,gc.p_g);Sd(Bc,gc);this.cKg(Bc,R);hb&&(R.I6a?Sd(Bc,Pd.a.instance.fa(823)):R.AMa&&Sd(Bc,Pd.a.instance.fa(824)));if(R.hasAutoFilter||R.R4)this.sKg(Bc,R.hasAutoFilter?R.cell.T_b:R.cell.AZi),hb&&Sd(Bc,Pd.a.instance.fa(826));$e.c(this.$,
R.range)&&Sd(Bc,Pd.a.instance.fa(830));this.$Jg(Bc,R);hb=(hb=Ib.Aa(14))?hb.pKh():"";Sd(Bc,hb);R.lK&&(hb=ce.g(this.$).Ca.es(R.range),hb=!!hb&&hb.n8e,Zc.hxj(R)?Zc.aKg(Bc,R):ac.EwaSettings.isChangeGateEnabled("OfficeVSO:3286994_NarratorForFormulaErrors")&&hb?Sd(Bc,Pd.a.instance.fa(828)):Sd(Bc,Pd.a.instance.fa(827)));R.aba&&(Sd(Bc,Pd.a.instance.fa(829)),R.xwb&&Sd(Bc,String.format(Pd.a.instance.Cb(16),R.Cbh)),Sd(Bc,R.iconName));R.hasRichValueIcon&&(gc=this.$.da.Aa(271),hb="",gc&&R.cell.Alf&&(gc=gc.IQ(R.cell.Alf))&&
gc.DomainId.Id!==Zc.wYj&&(hb=gc.Name),R.cell.Hfi?(Sd(Bc,String.format(Pd.a.instance.Cb(177),hb)),Sd(Bc,Pd.a.instance.fa(1762))):(Sd(Bc,String.format(Pd.a.instance.Cb(175),hb)),Sd(Bc,Pd.a.instance.fa(1761))));this.q6h(R)&&Sd(Bc,Zc.bRh(R));(Ib=Ib.Aa(231))&&Sd(Bc,Ib.q0e(Aa,!0));1===Aa.length&&Aa[0].isSingle&&Zc.gxj(R,Aa[0],this.$)&&(Aa=this.$.da.Aa(271))&&Sd(Bc,Aa.AKh());R.MMb&&R.NMb&&Sd(Bc,R.NMb);(Aa=R.cell.aWg)&&Sd(Bc,Aa);ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5463515_PhoneticSlice1")&&R.$wa&&
R.kFb&&(R=R.BDd)&&(Sd(Bc,Pd.a.instance.fa(1925)),Sd(Bc,R));return Bc.toString()};Zc.prototype.Xve=function(R){this.ysa=this.iD;this.iD=Object.assign(new Qb,{activeItemName:this.ysa.activeItemName,lzc:R?this.ysa.lzc:!1,tableName:R?this.ysa.tableName:"",a0a:R?this.ysa.a0a:-1})};Zc.prototype.nUf=function(){this.ysa&&(this.iD=this.ysa,this.ysa=null)};Zc.prototype.uVh=function(R,Aa){return 2===R||2===Aa?Pd.a.instance.fa(856):1===R||1===Aa?Pd.a.instance.fa(857):""};Zc.prototype.c0e=function(R){return this.b0e(R.cell,
R.text)};Zc.prototype.rKg=function(R,Aa,hb){if(hb&&1===hb.length&&hb[0].isSingle){hb="";var Ib=this.tableManager.vKa(Aa.range);Ib?(hb=Ib.pivotTableName,this.AWc(R,hb),this.Uqe(R,!0,hb,Ib.bgc?Pd.a.instance.fa(818):""),Sd(R,this.tableManager.Mmi(Ib,Aa.range)?Pd.a.instance.fa(820):""),Sd(R,this.tableManager.Wgi(Ib,Aa.range)?Pd.a.instance.fa(819):"")):(Ib=this.tableManager.En(Aa.range))?(hb=(hb=ce.g(this.$).Rb.Xj(Aa.range))?hb.name:"",this.AWc(R,hb),this.Uqe(R,!1,hb,""),Sd(R,this.tableManager.Ref(Ib,
Aa.range)?Pd.a.instance.fa(819):"")):(this.AWc(R,hb),this.iD.tableName="",this.iD.a0a=-1)}};Zc.prototype.AWc=function(R,Aa){Aa!==this.iD.tableName&&this.iD.tableName&&(R.append(Pd.a.instance.fa(this.iD.lzc?817:816)),Sd(R," "+this.iD.tableName))};Zc.prototype.Uqe=function(R,Aa,hb,Ib){hb!==this.iD.tableName&&(R.append(Pd.a.instance.fa(Aa?815:814)),Sd(R," "+hb),Sd(R,Ib),this.iD.tableName=hb,this.iD.lzc=Aa,this.iD.a0a=-1)};Zc.prototype.Sqe=function(R,Aa){var hb=ce.g(this.$).ha.va.activeCell;if(hb.top!==
Aa.top&&hb.left!==this.iD.a0a){R.append(Pd.a.instance.fa(819));Aa=new bf.Range(Aa.top,hb.left,Aa.top,hb.left,!0,!0);Sd(R,fd.Cgd(Aa));if(Aa=ce.g(this.$).uc(Aa))Aa=Aa.bba?this.c0e(Aa):Aa.text,Sd(R,Aa);this.iD.a0a=hb.left}};Zc.prototype.b0e=function(R,Aa){var hb=R.k5a;return R.zwb?String.format(Pd.a.instance.Cb(14),Aa,hb):String.format(Pd.a.instance.Cb(13),Aa,fd.sfj(hb))};Zc.prototype.cl=function(){Tc.ULS.shipAssertTag(537153930,0,!!this.$,"Can't register to ewaControl's events");if(this.$){var R=ce.g(this.$);
Tc.ULS.shipAssertTag(537153929,0,!!R,"Can't register to grid's events");R&&(R.yc.Yl(this.CF),R.Ca.Fp(this.Xca),R.cE(this.Xca),this.qab&&R.yc.Mo(this.Kg.bind(this)),R=R.ha,Tc.ULS.shipAssertTag(537153928,0,!!R,"Can't register to selectionManager's events"),R&&(R.OG(this.nd),R.JG(this.Xca),R.Pa.E2(this.Xca),this.qab&&(this.TGd=this.TGd.bind(this))))}};Zc.prototype.un=function(){if(this.$){var R=ce.g(this.$);R&&(R.yc.ol(this.CF),R.Ca.Kq(this.Xca),R.UF(this.Xca),this.qab&&R.yc.Pn(this.Kg),R=R.ha)&&(R.WF(this.Xca),
R.jO(this.Xca),R.Pa.Sma(this.Xca))}};Zc.prototype.readText=function(R,Aa){this.i6a&&this.gridReadoutNotifier&&this.gridReadoutNotifier.isActive?this.gridReadoutNotifier.readText(R):(ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5033038_Embed_Mode_Grid_Narrator_Fix")&&this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(R),this.qab&&!Aa||this.ariaLiveNotifier.lRj(Aa))};Zc.prototype.Kg=function(){this.nob&&this.nob.cancel()};Zc.prototype.TGd=function(){this.readText(this.zYh())};Zc.prototype.zYh=
function(){var R=this,Aa="";ce.g(this.$).ha.rangePicker.$K.forEach(function(hb){Aa+=R.pZh(hb)});return Aa+=" selected"};Zc.prototype.pZh=function(R){return" "+(R.sheetId!==Ph.d(this.$.pa)?this.$.xa.bhd(R.sheetId).name:"")+" "+R.range.topLeft+" "+(R.range.isSingle?"":R.range.bottomRight)};Zc.prototype.rJh=function(){var R=null;var Aa=ce.g(this.$).ha;if(1!==Aa.Ve&&!Aa.Pa.lc)return Tc.ULS.sendTraceTag(537153927,0,15,"selectionManager.CommandSelectionMode={0} and selectionManager.SelectedFloatingObjectControl is null",
Aa.Ve),{returnValue:"",activeCell:R};switch(Aa.Ve){case 2:return{returnValue:this.gMh(Aa),activeCell:R};case 64:var hb=Aa.Pa.lc.floatingObject,Ib="";if(Aa=Aa.Pa.lc.Bs||Aa.Pa.lc.Rd)Ib=(Ib=Aa.firstChild)?Ud.DOMElementExtensions.getTextContent(Ib):"";return{returnValue:String.format(Pd.a.instance.Cb(52),Zc.G$b(hb.altText,hb.altTextDescription,hb.name),Ib,hb.altTextDescription),activeCell:R};case 4:return{returnValue:Zc.nJg(Aa.Pa.lc.floatingObject),activeCell:R};case 512:return{returnValue:ah.a.QZe(Aa.Pa.lc.floatingObject.P7c),
activeCell:R};case 8:return hb=(hb=Aa.Pa.lc.floatingObject)?hb.name:"",{returnValue:String.format(Pd.a.instance.Cb(50),hb),activeCell:R};case 1:return R=this.activeCell,{returnValue:this.sYe(R,Aa.va.selectedRanges),activeCell:R}}return{returnValue:"",activeCell:R}};Zc.prototype.gMh=function(R){var Aa=new Sys.StringBuilder;Aa.append(Zc.FWg(R));var hb=this.$.da.Aa(231);hb&&Sd(Aa,hb.q0e(R.Pa.lc.floatingObject,!1));return Aa.toString()};Zc.prototype.q6h=function(R){R=R.$cf();var Aa=!1;this.iD.Ihf!==R&&
(this.iD.Ihf=R,Aa=!0);return Aa};Zc.prototype.cKg=function(R,Aa){if(Aa.Iwb)if(Aa=this.sparklineManager.xZh(Aa)){var hb=Pd.a.instance,Ib=hb.fa;a:switch(Aa.type){case 0:var Bc=811;break a;case 1:Bc=812;break a;default:Bc=813}hb=Ib.call(hb,Bc);Sd(R,String.format(Pd.a.instance.Cb(25),hb));Aa=String.format(Pd.a.instance.Cb(24),fd.Cgd(Aa.gFj));Sd(R,Aa)}else Tc.ULS.sendTraceTag(537153925,0,15,"No sparkline range was found on a cell with sparkline."),Sd(R,String.format(Pd.a.instance.Cb(25),""))};Zc.prototype.sKg=
function(R,Aa){switch(Aa){case 1:case 11:Sd(R,Pd.a.instance.fa(831));break;case 6:Sd(R,Pd.a.instance.fa(831));Sd(R,Pd.a.instance.fa(833));break;case 7:Sd(R,Pd.a.instance.fa(831));Sd(R,Pd.a.instance.fa(834));break;case 2:Sd(R,Pd.a.instance.fa(832));Sd(R,Pd.a.instance.fa(833));break;case 3:Sd(R,Pd.a.instance.fa(832));Sd(R,Pd.a.instance.fa(834));break;default:Sd(R,Pd.a.instance.fa(832))}};Zc.prototype.$Jg=function(R,Aa){var hb,Ib=this.$.da.Aa(65);Aa=Ib?Ib.cKa(Aa.range):null;var Bc="",gc=Object(xf.a)(277,
Aa);if(Aa)Bc=!Aa.t6a&&gc&&gc.poi?String.format(Pd.a.instance.Cb(29),gc.wJj):String.format(Pd.a.instance.Cb(23),Aa.author);else if(null===(hb=null===Ib||void 0===Ib?void 0:Ib.Ln)||void 0===hb?0:hb.cF)Bc=String.format(Pd.a.instance.Cb(28),Ib.Ln.DN.author);Sd(R,Bc)};Zc.nJg=function(R){return String.format(Pd.a.instance.Cb(51),Zc.G$b(R.altText,R.altTextDescription,R.name),R.altTextDescription)};Zc.bRh=function(R){return Pd.a.instance.fa(R.$cf()?821:822)};Zc.G$b=function(R,Aa,hb){return R||Aa?R:hb};Zc.FWg=
function(R){var Aa=R.Pa.lc;R=Aa.floatingObject;var hb=R.Xc,Ib=hb.ChartTitle,Bc=R.altText,gc=R.altTextDescription,Id=!!(hb.Attributes&4);return(Aa=Aa.getSelectionDescription())?Aa:hb.DataRangeForDisplay?String.format(Pd.a.instance.Cb(Id?48:46),Zc.G$b(Bc,gc,R.name),gc,Ib,Pd.a.instance.fa(xd(hb.ChartCategory)),hb.DataRangeForDisplay):String.format(Pd.a.instance.Cb(Id?49:47),Zc.G$b(Bc,gc,R.name),gc,Ib,Pd.a.instance.fa(xd(hb.ChartCategory)))};Zc.hxj=function(R){return ac.EwaSettings.la(103)&&(R.c6a||R.Zfc)};
Zc.aKg=function(R,Aa){if(!Aa.CSa)Tc.ULS.shipAssertTag(537153924,0,!1,"SelectionReadoutHandler.AppendAriaDynamicArrayFormulaDescription: This method should only be called with a valid dynamic array range.");else if(Aa.c6a)Aa=Aa.CSa.topLeft.toString(),Sd(R,String.format(Pd.a.instance.Cb(26),Aa));else if(Aa.Zfc){var hb=Aa.CSa.HL();Aa=(hb.LastColumn-hb.FirstColumn+1).toString();hb=(hb.LastRow-hb.FirstRow+1).toString();Sd(R,String.format(Pd.a.instance.Cb(27),Aa,hb))}};Zc.gxj=function(R,Aa,hb){return R.lK||
!ac.EwaSettings.la(139)?!1:(R=hb.da.Aa(271))?R.xfc(Aa):!1};Zc.Noi=function(R){return R.top===R.bottom&&R.left+1===R.right||R.top+1===R.bottom&&R.left===R.right};Sk.Object.defineProperties(Zc.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return ce.g(this.$).uc(null)}}});Zc.wYj=268435712;Zc.ATc=500;Object(vc.a)(Zc,"SelectionReadoutHandler",null,[278,3]);var Da=b(52),Fb=kf.a;vm(jd,Fb);jd.prototype.create=function(){var R=this,Aa=this.$.da,hb=bg.GetServiceTaskFactory.Wa(Aa,211,212,
this.ub),Ib=bg.GetServiceTaskFactory.Wa(Aa,66,134,this.ub),Bc=bg.GetServiceTaskFactory.Wa(Aa,240,239,this.ub),gc=Da.Task.Ta(null);ac.EwaSettings.KH()&&(gc=bg.GetServiceTaskFactory.Wa(Aa,244,315,this.ub));ig.TaskExtensions.Ba(ig.TaskExtensions.ve([hb,Ib,Bc,gc],this.ma),function(){var Id=Aa.Aa(226)||new Zc(hb.result,R.$,Ib.result,Bc.result,gc.result);R.Fb(Id)},this.$.ma,3)};jd.ja=function(R){R.da.Ha(227,new jd(R))};Object(vc.a)(jd,"SelectionReadoutHandlerFactory",kf.a,[]);md.prototype.hNf=function(){var R=
this.rKh();this.ariaLiveNotifier.wab(R,dd.a.dob)};md.prototype.rKh=function(){var R=new Sys.StringBuilder;this.$.workbookContext&&Sd(R,this.$.workbookContext.WorkbookFileName);Sd(R,Pd.a.instance.fa(837));Sd(R,this.tKh());Sd(R,this.sKh());Sd(R,Pd.a.instance.fa(838));return R.toString()};md.prototype.tKh=function(){return this.$.isEditMode?Pd.a.instance.fa(842):Pd.a.instance.fa(843)};md.prototype.sKh=function(){var R=this.EXj(),Aa=this.$.xa.pa;R=1!==R?String.format(Pd.a.instance.Cb(31),R):Pd.a.instance.fa(836);
R=new Sys.StringBuilder(R);Aa&&Aa.sheetName&&(R.append(se.Oud),R.append(String.format(Pd.a.instance.Cb(32),Aa.sheetName)));return R.toString()};md.prototype.EXj=function(){for(var R=0,Aa=yl(this.$.xa.items),hb=Aa.next();!hb.done;hb=Aa.next())hb.value.visible&&R++;return R};Object(vc.a)(md,"WorkbookReadout",null,[]);jc.prototype.dispose=function(){this.Z9b&&this.Z9b.Pcj(this.Tzf);this.Z9b=this.ariaLiveNotifier=this.$=null};Object(vc.a)(jc,"EmbeddedWorkbookReadoutHandler",null,[3]);Yb.prototype.dispose=
function(){this.un();this.ariaLiveNotifier=this.dZ=null;this.Md=!0};Yb.prototype.cl=function(){if(this.dZ){this.dZ.ar(this.pW);this.dZ.Ca.Fp(this.pW);this.dZ.cE(this.pW);var R=Object(xf.a)(227,this.dZ);R&&(R.yc.Yl(this.pW),R.ha.OG(this.pW),R.ha.JG(this.pW),R.ha.Pa.E2(this.pW))}else Tc.ULS.sendTraceTag(537153923,0,15,"WorkbookReadoutHandler.RegisterEvents: Can't register to view events")};Yb.prototype.un=function(){if(this.dZ){this.dZ.Ca.Kq(this.pW);this.dZ.UF(this.pW);var R=Object(xf.a)(227,this.dZ);
R&&(R.yc.ol(this.pW),R.ha.WF(this.pW),R.ha.jO(this.pW),R.ha.Pa.Sma(this.pW))}};Yb.prototype.sqe=function(){this.C_d.hNf();this.ariaLiveNotifier.setEnabled(!0);this.ariaLiveNotifier.drj();this.dispose()};Object(vc.a)(Yb,"WorkbookReadoutHandler",null,[3]);var Lc=kf.a;vm(Ua,Lc);Ua.prototype.create=function(){var R=this,Aa=bg.GetServiceTaskFactory.Wa(this.$.da,211,212,this.ub);if(this.$.rR){var hb=bg.GetServiceTaskFactory.Wa(this.$.da,12,477,this.ub);ig.TaskExtensions.Ba(ig.TaskExtensions.ve([Aa,hb],
this.$.ma),function(){var Ib=new jc(Aa.result,R.$,hb.result);R.Fb(Ib)},this.$.ma,3)}else ig.TaskExtensions.Ba(Aa,function(Ib){Ib=new Yb(Ib.result,R.$);R.Fb(Ib)},this.$.ma,3)};Ua.ja=function(R){R.da.Ha(229,new Ua(R))};Object(vc.a)(Ua,"WorkbookReadoutHandlerFactory",kf.a,[]);var ud=b(36),zd=b(237),Ce=b(357),Ge=b(177),gf=b(654),Df=ud.a;vm(sa,Df);sa.prototype.dispose=function(){this.view&&(this.view.Ca.pp(this.Re),this.view.Ca.oI(this.Fm),this.view.Ca.Xab(this.Re),this.view.Ca.bHb(this.Re),this.view.$.xa.TF(this.xo),
this.view.$.zb.TF(this.xo));this.sT=this.Oje=null;Df.prototype.dispose.call(this)};sa.prototype.zYb=function(R){R=this.tGd(R);var Aa=ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?this.view.mH:this.view.Kh;if(R&&0<R.length&&Aa)for(var hb=0,Ib=R.length;hb<Ib;hb++)Aa.contains(this.sT[hb])||Array.add(this.sT,Ge.a.VQ(R[hb]))};sa.prototype.OGb=function(){var R=ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",
!1)?this.view.mH:this.view.Kh;if(this.sT.length&&R)for(var Aa=this.sT.length-1;0<=Aa;Aa--)R.contains(this.sT[Aa])||Array.removeAt(this.sT,Aa)};sa.prototype.D2e=function(R){return this.X1e(R)};sa.prototype.X1e=function(R){R=Bf.I(R,this.sT,!0);return 0<R.length?R[0]:null};Sk.Object.defineProperties(sa.prototype,{rangeList:{configurable:!0,enumerable:!0,get:function(){return this.sT}},view:{configurable:!0,enumerable:!0,get:function(){return this.Oje}}});sa.uGd="lrc";Object(vc.a)(sa,"LoadedRangeCollection",
ud.a,[]);vm(Lb,sa);Lb.prototype.xZh=function(R){for(var Aa=yl(this.rangeList),hb=Aa.next();!hb.done;hb=Aa.next())if(hb=hb.value,R.range.contains(hb))return hb;return null};Lb.prototype.tGd=function(R){return R.GridBlockModel&&(R=gridRenderer.CanvasRendererFactoryGlobal.getModelAccessor(R.GridBlockModel))?R.getSparklineRanges():null};Object(vc.a)(Lb,"SparklineManager",sa,[270]);var Ea=kf.a;vm(Hb,Ea);Hb.prototype.create=function(){this.Fb(this.sparklineManager||(this.sparklineManager=new Lb(ce.g(this.$),
this.$.da)))};Hb.ja=function(R){R.da.Ha(239,new Hb(R))};Object(vc.a)(Hb,"SparklineManagerFactory",kf.a,[]);var kb=b(53),Vb=b(281);Gc.oPe="ewa-svg-icon";Object(vc.a)(Gc,"CssClassNames",null,[]);var Qc=b(306),Mc=b(335);Kb.prototype.dispose=function(){this.CUd=null;this.$.ea.Lq(this.Wg)};Kb.prototype.Eva=function(R,Aa,hb,Ib,Bc){Ib=void 0===Ib?null:Ib;Bc=void 0===Bc?null:Bc;var gc;(gc=this.CUd[R])||(this.CUd[R]=gc=this.uYi(this.A8f[R]));if(!gc)return Tc.ULS.shipAssertTag(537151262,0,!1,"SvgIconProvider.GetSvgElement: id {0} was not found in loaded SVG sprites.",
R),null;var Id=gc.cloneNode(!0);if(!Id.style){var fe=Qc.b(gc),sf=Qc.b(Id),hg={};hg.iconId=R;hg.isOriginalNodeStyleNull=void 0===gc.style||null===gc.style;hg.isOriginalNodeCurrentStyleNull=void 0===gc.currentStyle||null===gc.currentStyle;hg.isClonedNodeCurrentStyleNull=void 0===Id.currentStyle||null===Id.currentStyle;hg.originalNode=fe.substring(0,fe.indexOf(">")+1);hg.clonedNode=sf.substring(0,sf.indexOf(">")+1);Tc.ULS.sendTraceTag(537151261,0,10,"SvgIconProvider.GetSvgElement: cloned element's style is undefined. data: {0}",
JSON.stringify(hg))}R=String.format("height: {0}px; width: {0}px;",Aa,hb);Id.setAttribute("style",R);Bc&&(R=document.createElement("title"),R.innerHTML=Bc,Id.insertBefore(R,Id.childNodes[0]));if(Ib)for(Ib=yl(Ib),Bc=Ib.next();!Bc.done;Bc=Ib.next())Sys.UI.DomElement.addCssClass(Id,Bc.value);return Id};Kb.prototype.mba=function(R,Aa,hb,Ib,Bc,gc,Id,fe){Bc=void 0===Bc?0:Bc;gc=void 0===gc?0:gc;Id=void 0===Id?null:Id;fe=void 0===fe?null:fe;Bc&&gc||(gc=Ud.DOMElementExtensions.getBoundingClientRect(Ib),Bc=
gc.height,gc=gc.width);if(Id=this.Eva(R,Aa,hb,Id,fe))Ib.appendChild(Id),(Ib=Ud.DOMElementExtensions.CZ(Id,"style",null))?Id.setAttribute("style",Ib+String.format(" margin: {0}px {1}px;",(Bc-Aa)/2,(gc-hb)/2)):Tc.ULS.sendTraceTag(537151260,0,10,'SvgIconProvider.InsertAndCenterSvgElement: svgElement\'s GetAttribte("styl") returned null. Icon ID: {0}',R);return Id};Kb.prototype.Mlf=function(){var R=this;ig.TaskExtensions.Ba(bg.GetServiceTaskFactory.Wa(this.$.da,283,284,0),function(Aa){Aa=Mc.c(Aa.result.Un.loadScript("excel-uiSlice20-sprite"));
ig.TaskExtensions.Ba(Aa,function(){var hb=R.e0e("excelUiSlice20Sprite");hb?R.Yme(hb):Tc.ULS.sendTraceTag(537151259,0,15,"window[{0}].icons returned null.","excelUiSlice20Sprite")},R.$.ma,3)},this.$.da.ma,3)};Kb.prototype.Yme=function(R){R=yl(R);for(var Aa=R.next();!Aa.done;Aa=R.next())Aa=Aa.value,Aa.type===wf.a.y8f&&(this.A8f[Aa.id]=Aa)};Kb.prototype.uYi=function(R){if(!R)return null;var Aa=R.viewBox;R=R.children;var hb=document.createElementNS(Vb.a.EUd,wf.a.y8f);Sys.UI.DomElement.addCssClass(hb,
Gc.oPe);hb.setAttribute("focusable","false");hb.setAttribute("viewBox",Aa);this.cDg(hb,R);return hb};Kb.prototype.cDg=function(R,Aa){Aa=yl(Aa);for(var hb=Aa.next();!hb.done;hb=Aa.next()){hb=hb.value;var Ib=document.createElementNS(Vb.a.EUd,hb.type),Bc;for(Bc in hb){var gc=Bc,Id=hb[Bc];"className"===gc?Ib.setAttribute("class",Id):Ib.setAttribute(gc,Id)}R.appendChild(Ib)}};Kb.prototype.e0e=function(R){return(R=window[R])?R.icons:null};Object(vc.a)(Kb,"SvgIconProvider",null,[266,3]);var Ab=kf.a;vm(Sa,
Ab);Sa.prototype.create=function(){var R=this;ig.TaskExtensions.Ba(kb.a.s_([106],4,this.ub,void 0,void 0,void 0,387),function(){var Aa=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4431502_UseCommonIconSpriteInEwa")?"excelInitialAppSprite":"excelAppSprite";window[Aa]?R.Fb(R.$.da.Aa(388)||new Kb(R.$)):Tc.ULS.sendTraceTag(537151258,0,50,"window.[{0}] returned null.",Aa)},this.ma,3)};Sa.ja=function(R){R.da.Ha(387,new Sa(R))};Object(vc.a)(Sa,"SvgIconProviderFactory",kf.a,[]);var nc=b(411),Rd=b(528),Je=
b(234),he=b(154),Ff=b(122),Fe=b(9),Tf=b(336),Hd=b(169),Ye=b(12),Fd=b(158),ve=b(83),jg=b(232),Kf=b(105),td=b(41),qf=b(34),Ch=ve.a;vm(gb,Ch);gb.prototype.dispose=function(){this.wbb();this.tableManager.Ebj(this.zvf);this.pif||af.a.Xp||af.a.Uwa||Hd.a.instance.za(Ye.a.pointerDown,this.$aa,this.onPointerDown);if(this.dB){jg.b(this.$,!1);try{this.wv()}catch(R){Tc.ULS.sendTraceTag(537151236,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",R)}}this.parentElement&&this.parentElement.contains(this.$aa)&&
this.parentElement.removeChild(this.$aa);this.$aa=this.parentElement=null;Ch.prototype.dispose.call(this)};gb.prototype.N4e=function(R){var Aa=R.bottom-this.Sn.topLeft.bottom-1;return 0<=R.right-this.Sn.topLeft.right+1&&0<=Aa&&R.bottom>=this.Sn.top&&R.right>=this.Sn.left?new bf.Range(this.Sn.top,this.Sn.left,R.bottom,R.right,!1,!1):this.ft};gb.prototype.jkd=function(R){this.Xvc([this.ft],6,void 0===R?!0:R);this.Nb.ys(this.Q8f)};gb.prototype.TGb=function(R){R=void 0===R?!0:R;this.Nb.ll(this.Q8f);this.Xvc([null],
6,R)};gb.prototype.zId=function(R){R=void 0===R?!0:R;this.Nb.ll(this.L8f);this.Xvc([null],26,R)};gb.prototype.a8h=function(){var R=!1;R=void 0===R?!0:R;var Aa=this.iJj();0<Aa.length&&(this.Xvc(Aa,26,R),this.Nb.ys(this.L8f))};gb.prototype.iJj=function(){var R=[];this.Sn.contains(this.ft)&&(this.Sn.right!==this.ft.right&&R.push(new bf.Range(this.Sn.top,this.ft.right+1,this.ft.bottom,this.Sn.right,!1,!1)),this.Sn.bottom!==this.ft.bottom&&R.push(new bf.Range(this.ft.bottom+1,this.Sn.left,this.Sn.bottom,
this.Sn.right,!1,!1)));return R};gb.prototype.resizeTable=function(){if(!this.ft.equals(this.Sn)){var R=new bf.Range(this.Sn.top,this.Sn.left,this.ft.bottom,this.ft.right,!1,!1);this.KNj(R);this.Hqd=!0}};gb.prototype.onKeyDown=function(R){qf.a(this.$).He(R);return!0};gb.prototype.s9a=function(){this.pif&&(af.a.Xp||af.a.Uwa||(Hd.a.instance.qa(Ye.a.pointerDown,this.$aa,this.onPointerDown),this.$aa.classList.remove("ewr-table-resize-default-cursor"),this.yLc=this.$aa.disabled=!1),this.yLc=!1)};gb.prototype.YRg=
function(){var R=document.createElement("div");R.className="ewr-table-resize-handle";var Aa=document.createElement("div");Aa.className="ewr-table-resize-fillhandle-higher";var hb=document.createElement("div");hb.className="ewr-table-resize-fillhandle-broader";R.appendChild(Aa);R.appendChild(hb);this.$aa=R;this.parentElement.appendChild(this.$aa)};gb.prototype.s0b=function(R){var Aa=this,hb=this.ft.contains(R),Ib=R.top,Bc=R.bottom,gc=R.left;R=R.right;var Id=null;if(hb){if(this.gridView.Cba(this.Sn.topLeft)&&
!this.Sn.xSa)return;Ib=Math.max(1,Bc-5,this.Sn.top);gc=Math.max(1,R-5,this.Sn.left);Bc=Ib;R=gc;Id=new bf.Range(Ib,gc,Ib,gc,!1,!1)}else Bc+=5,R+=5,Ib=Bc,gc=R,Id=new bf.Range(Bc,R,Bc,R,!1,!1);this.gridView.Cba(Id)||(this.Sr?this.Sr.fp||(this.Sr=He.a.instance.create(function(){Aa.gridView.Rt(Id,60,Kf.a.N8f)},40,vg.a.O8f)):this.Sr=He.a.instance.create(function(){Aa.gridView.Rt(Id,60,Kf.a.N8f)},40,vg.a.O8f))};gb.prototype.xZb=function(R){var Aa=R;if(this.gridView.$a.P4){if(!this.gridView.uc(R.topLeft)){var hb=
this.gridView.xl("TableResizeBehavior.AdjustHiddenRowColumns",this.gridView.mH,this.ft.top!==R.top?1:2);try{hb.Uk=this.ft.top<R.top||this.ft.left<R.left,hb.Zu(R.topLeft),Aa=hb.$$cu().range}finally{hb&&hb.dispose()}}Aa.right=Aa.left+R.width-1;Aa.bottom=Aa.top+R.height-1}return Aa};gb.prototype.Xvc=function(R,Aa,hb){hb=void 0===hb?!0:hb;var Ib=[];R=yl(R);for(var Bc=R.next();!Bc.done;Bc=R.next())Ib.push(new Tf.a(Bc.value,Ph.d(this.$.pa)));this.Nb.ry(Ib,[Aa],!0,void 0,hb)};gb.prototype.Q9i=function(){for(var R=
yl(this.gridView.nn),Aa=R.next();!Aa.done;Aa=R.next())Hd.a.instance.qa(Ye.a.fh,Aa.value.domElement,this.qj);Hd.a.instance.qa(Ye.a.Yd,document.documentElement,this.Og);this.BIe()};gb.prototype.D$i=function(){for(var R=yl(this.gridView.nn),Aa=R.next();!Aa.done;Aa=R.next())Fd.a.instance.qa(Ye.a.xg,Aa.value.domElement,this.qj);Fd.a.instance.qa(Ye.a.ye,document.documentElement,this.sEb);this.BIe()};gb.prototype.wv=function(){this.ezb&&this.uQj();this.hic&&this.FQj()};gb.prototype.uQj=function(){for(var R=
yl(this.gridView.nn),Aa=R.next();!Aa.done;Aa=R.next())Hd.a.instance.za(Ye.a.fh,Aa.value.domElement,this.qj);Hd.a.instance.za(Ye.a.Yd,document.documentElement,this.Og);this.$Nf()};gb.prototype.FQj=function(){for(var R=yl(this.gridView.nn),Aa=R.next();!Aa.done;Aa=R.next())Fd.a.instance.za(Ye.a.xg,Aa.value.domElement,this.qj);Fd.a.instance.za(Ye.a.ye,document.documentElement,this.sEb);this.$Nf()};gb.prototype.BIe=function(){Hd.a.instance.qa(Ye.a.hy,document.documentElement,this.wca);this.gridView.pc.v7b(!0)};
gb.prototype.$Nf=function(){Hd.a.instance.za(Ye.a.hy,document.documentElement,this.wca);this.gridView.pc.v7b(!1)};gb.prototype.KNj=function(R){var Aa={};R=(Aa.ResizeTableRange=R,Aa.OriginalTableRange=this.Sn,Aa);this.$.xe(-1400250766,Pf.a.$b,30,R)};gb.prototype.aSj=function(R){if(!this.Sn.contains(R)){R=this.hJj();R=yl(R);for(var Aa=R.next();!Aa.done;Aa=R.next())if(this.tableManager.hrd(Aa.value)){this.gridView.Hh.hu(dd.a.tEi);return}}this.gridView.rtl?this.gridView.Hh.hu(dd.a.zDi):this.gridView.Hh.hu(dd.a.ZFi)};
gb.prototype.wbb=function(){if(this.dB){jg.b(this.$,!1);try{this.wv()}catch(R){Tc.ULS.sendTraceTag(537151232,0,10,"TableResizeBehavior.Dispose: Unregistering of Handlers failed with Exception {0}",R)}}this.Sr&&(this.Sr.cancel(),this.Sr.dispose());this.hic=this.ezb=!1;this.TGb();this.zId();jg.b(this.$,!1);this.gridView.Hh.hu(dd.a.Zaa)};gb.prototype.hJj=function(){var R=[];this.Sn.right!==this.ft.right&&R.push(new bf.Range(this.Sn.top,this.Sn.right+1,this.ft.bottom,this.ft.right,!1,!1));this.Sn.bottom!==
this.ft.bottom&&R.push(new bf.Range(this.Sn.bottom+1,this.Sn.left,this.ft.bottom,this.Sn.right,!1,!1));return R};gb.createInstance=function(R,Aa,hb,Ib){if(!Aa)return null;var Bc=R.Nb;Bc.ry(hb,[27],!0);Bc.ys(gb.cJj);hb=Bc.ZE(27,R.$a.oj(Aa.bottomRight),gb.SOh(Aa,hb)).Cg;return new gb(hb,R,Aa,Ib)};gb.SOh=function(R,Aa){for(var hb,Ib=0;Ib<Aa.length;Ib++)if((null===(hb=Aa[Ib])||void 0===hb?0:hb.range)&&Aa[Ib].range.equals(R))return Ib;return 0};Sk.Object.defineProperties(gb.prototype,{dB:{configurable:!0,
enumerable:!0,get:function(){return this.ezb||this.hic}},pif:{configurable:!0,enumerable:!0,get:function(){return this.yLc}}});gb.cJj=[27];Object(vc.a)(gb,"TableResizeBehavior",ve.a,[]);var Uf=b(230);Sb.huh="ewa-ttrd-buttonarea";Object(vc.a)(Sb,"CssClassNames",null,[]);var Rg=b(45),Od=b(126),gh=b(92),fi=b(127),hh=b(256),ye=Uf.a;vm(zb,ye);zb.prototype.dispose=function(){this.$&&this.$dh();this.$=this.gridView=this.parentElement=this.MKa=null;ye.prototype.dispose.call(this)};zb.prototype.JMh=function(R){var Aa=
this.i0h(this.gridView.uc(null).range);return Aa?String.format("=SUBTOTAL({0},{1})",R,Aa):null};zb.prototype.i0h=function(R){var Aa=ce.g(this.$).Rb.Xj(R);if(!Aa)return null;Aa=he.a(Aa,!1);Aa.right=Aa.left=R.left;return Aa.toString()};zb.prototype.pbi=function(){zb.rM={};zb.rM["100"]=Pd.a.instance.fa(1058);zb.rM["101"]=Pd.a.instance.fa(1061);zb.rM["102"]=Pd.a.instance.fa(1060);zb.rM["103"]=Pd.a.instance.fa(1065);zb.rM["104"]=Pd.a.instance.fa(1062);zb.rM["105"]=Pd.a.instance.fa(1063);zb.rM["109"]=Pd.a.instance.fa(1059);
zb.rM["107"]=Pd.a.instance.fa(1066);zb.rM["110"]=Pd.a.instance.fa(1068);zb.rM["111"]=Pd.a.instance.fa(1119)};zb.prototype.TXi=function(){var R=this.gridView.uc(null);if(R&&(R=R.lK?R.formulaBarText:null))if("=SUBTOTAL("===R.substring(0,10)){if(R=R.substring(10,13),R in zb.rM)return R}else return"111";return"100"};zb.prototype.mMg=function(){this.gridView.Ca.sq(this.Re);this.gridView.ha.JG(this.Mh);this.gridView.ar(this.onContentReady);this.gridView.pc.Yl(this.Evf);this.gridView.pc.Mo(this.$Cb)};zb.prototype.$dh=
function(){this.gridView&&(this.gridView.ha&&(this.gridView.ha.jO(this.Mh),this.gridView.Ca.pp(this.Re)),this.gridView.pt(this.onContentReady),this.gridView.pc&&(this.gridView.pc.ol(this.Evf),this.gridView.pc.Pn(this.$Cb)),this.Ccg())};zb.prototype.Rqb=function(R){this.lSj(R);this.Qzb&&(this.JHj(),this.Gmb?(this.TGf||this.xMg(),this.DTc?this.g5=!1:(this.g5=!0,this.ZRf())):(Tc.ULS.sendTraceTag(537151199,0,15,"TableTotalRowOptions.CreateAndShowDropdownInUpdatedPosition : Offset bounds could not be determined"),
this.g5=!1))};zb.prototype.ZRf=function(){var R=this;appChrome.renderTableTotalRowOptions(this.parentElement,zb.rM,zb.rM[this.TXi()].toString(),Math.round(qf.a(this.$).Ii(17)),function(Aa){Tc.ULS.sendTraceTag(537151198,0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option : {0}",Aa);var hb={};hb=(hb.SelectedOption=zb.rM[Aa],hb.FunctionKeyCode=Aa,hb.Location="canvas",hb);fi.b(R.$).ee(Od.a.nJj,hb,null,!0);if("111"===Aa)return R.Oei(),!0;if("100"!==Aa){R.UIb=R.JMh(Aa);if(!R.UIb)return Tc.ULS.sendTraceTag(537151197,
0,50,"TableTotalRowOptions.RenderReactTotalRowDropdown - Selected Option was null"),!0;R.xRa(R.UIb)}else R.xRa("");Ud.DOMElementExtensions.setFocus(R.gridView.yc.textBox.domElement);return!0})};zb.prototype.Oei=function(){Tc.ULS.sendTraceTag(537151196,0,50,"TableTotalRowOptions.InvokeMoreFunctionsDialog - More Functions dialog invoked");var R=new gh.a(753860909,0,this.$.isEditMode?2:1,19,null);this.$.Ka.Xb(R)};zb.prototype.vva=function(R){if(!R)return null;var Aa=this.gridView.pc.textBox.domElement;
var hb=0<Ud.DOMElementExtensions.getHeight(Aa)&&0<Ud.DOMElementExtensions.getWidth(Aa)&&0<=Aa.offsetTop&&0<=Aa.offsetLeft;if(hb)Aa=Ud.DOMElementExtensions.vva(Aa,this.gridView.xj);else{Aa=this.gridView.getCellBounds(R.cell);var Ib=Ud.DOMElementExtensions.getBoundingClientRect(this.gridView.xj);Aa=new Sys.UI.Bounds(Aa.x-Ib.x,Aa.y-Ib.y,Aa.width,Aa.height)}if(Aa)if(hb)2<Aa.height&&2<Aa.height&&(Aa.x+=1,Aa.y+=1,Aa.height-=2,Aa.width-=2);else if(hb=ce.g(this.$).aK(R.cell))hb=hb.width,Ib=If.a.equals(Le.a.z3a(R.cell,
this.gridView.rtl),"right",!0),this.gridView.rtl&&Ib&&(Aa.x=Aa.x+Aa.width-hb),R.Zka&&this.gridView.rtl===Ib&&(Aa.width=hb);else return null;return Aa};zb.prototype.lSj=function(R){var Aa=this.Gmb;if(Aa){var hb=17>=Aa.height?Aa.y:Aa.y+Aa.height-17-2;Aa=this.jki?this.gridView.rtl?Aa.x:Aa.x+Aa.width-(17<Aa.height?17:Aa.height):this.gridView.rtl?Aa.x-(17<Aa.height?17:Aa.height):Aa.x+Aa.width;var Ib=qf.a(this.$).Oja(new Sys.UI.Point(Aa,hb));this.parentElement.style.top=Fe.HelperMethods.Qb(Ib.y);this.parentElement.style.left=
Fe.HelperMethods.Qb(Ib.x);qf.a(this.$).Vsj(this.parentElement);R&&(this.g5=this.gridView.qic(new Rg.a(Aa,hb)))}else this.g5=!1};zb.prototype.xMg=function(){this.MKa.insertBefore(this.parentElement,this.MKa.firstChild);this.TGf=!0};zb.prototype.JHj=function(){this.dR||(this.gridView.view.Ms(this.it),this.dR=!0)};zb.prototype.Ccg=function(){this.dR&&this.gridView.view&&(this.gridView.view.Nq(this.it),this.dR=!1)};zb.prototype.xRa=function(R){var Aa=this.gridView.yc,hb=this.gridView.uc(null);hb&&(R=
Object.assign(new hh.a,{Text:R}),this.gridView.setCell(R,hb.range,0,127,null),Aa.endEdit(!0,"TableTotalRowOptions.SetCellContent",0))};Sk.Object.defineProperties(zb.prototype,{g5:{configurable:!0,enumerable:!0,get:function(){return this.Xnd},set:function(R){this.Xnd!==R&&(this.Xnd=this.isVisible=R)}},Qzb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Hd&16)}},jki:{configurable:!0,enumerable:!0,get:function(){var R=this.gridView.ha.va.activeCell;return R.right===R.maxColumns}},Gmb:{configurable:!0,
enumerable:!0,get:function(){var R=this.gridView.uc(null);return R&&this.gridView.e_(R.range)?this.vva(R):(R&&Tc.ULS.sendTraceTag(537151200,0,50,"TableTotalRowOptions.ActiveCellOffsetBounds - Active Cell not in viewport area"),null)}}});zb.mJj="TableTotalRowDropDownIconButtonId";zb.rM=null;Object(vc.a)(zb,"TableTotalRowOptions",Uf.a,[3]);vm(kc,sa);kc.prototype.yoe=function(R){this.addHandler(sa.uGd,R)};kc.prototype.kRf=function(R){this.removeHandler(sa.uGd,R)};kc.prototype.fEg=function(R){this.addHandler("tce",
R)};kc.prototype.Ebj=function(R){this.removeHandler("tce",R)};kc.prototype.hrd=function(R){return!!this.X1e(R)};kc.prototype.En=function(R){return this.XWh(this.D2e(R))};kc.prototype.XXe=function(R){return this.D2e(R)};kc.prototype.z$i=function(R){R?(this.upb?this.upb!==R&&(pg.a.Fa(this.U0),this.U0=null,this.upb=R):this.upb=R,this.U0||(this.U0=Ff.a.instance.Dd(this.upb)),this.U0.hn("focusin")||this.U0.ja("focusin",this.onFocus)):Tc.ULS.sendTraceTag(537151245,0,15,"TableManager.RegisterToTextboxFocusEvent empty textBoxDomElement recieved")};
kc.prototype.Ref=function(R,Aa){return R?R.Xva&&R.top===Aa.top:(Tc.ULS.shipAssertTag(537151244,0,!!R,"autofilterRange can't be null"),!1)};kc.prototype.vKa=function(R){R=this.spb?Bf.I(R,this.spb):this.view.getRangeInformation(R);return 0<R.length&&Object(nc.a)(Je.PivotTableRange,R[0])?R[0]:null};kc.prototype.Wgi=function(R,Aa){return R?!R.bgc&&!!R.C$&&R.C$.Qd(Aa):(Tc.ULS.shipAssertTag(537151243,0,!!R,"Pivot table can't be null"),!1)};kc.prototype.Mmi=function(R,Aa){return R?!R.bgc&&!!R.WQa&&R.WQa.Qd(Aa):
(Tc.ULS.shipAssertTag(537151242,0,!!R,"Pivot table can't be null"),!1)};kc.prototype.zYb=function(R){sa.prototype.zYb.call(this,R);if((R=Fe.HelperMethods.k2e(R))&&0<R.length){this.spb=Array(R.length);for(var Aa=0;Aa<R.length;Aa++)this.spb[Aa]=Ge.a.VQ(R[Aa])}};kc.prototype.OGb=function(){sa.prototype.OGb.call(this);this.spb=null};kc.prototype.W3g=function(R,Aa){return this.gDe(R,Aa).returnValue};kc.prototype.gDe=function(R,Aa){var hb=this;var Ib=!1;if(!R||!Aa)return{returnValue:!1,DY:Ib};R=R.clone();
R.right+=1;R.left=R.right;if(!R.isValidRange)return{returnValue:!1,DY:Ib};if(R.top<Aa.$a.Xi){var Bc=R.clone();Bc.bottom>=Aa.$a.Xi&&(Bc.bottom=Aa.$a.Xi-1);if(!function(){var Id=hb.fDe(Bc,Aa);Ib=Id.DY;return Id}().returnValue)return{returnValue:!1,DY:Ib}}if(R.bottom>=Aa.$a.Xi){var gc=R.clone();gc.top<=Aa.$a.Xi&&(gc.top=Aa.$a.Xi);if(!function(){var Id=hb.fDe(gc,Aa);Ib=Id.DY;return Id}().returnValue)return{returnValue:!1,DY:Ib}}return{returnValue:!0,DY:Ib}};kc.prototype.P8f=function(R){(R=this.En(R.topLeft))&&
R.toString()in this.qFa&&(this.qFa[R.toString()].Hqd=!1)};kc.prototype.r4i=function(){this.raiseEvent("tce")};kc.prototype.Rh=function(R,Aa){if(!this.pzc)return!1;switch(Aa){case -569786022:case 541421805:if(this.pzc.g5){var hb=document.getElementById(zb.mJj);hb&&He.a.instance.create(function(){Ud.DOMElementExtensions.Zec(hb,null)},0,vg.a.fJj,!0,!0)}return!0;default:return!1}};kc.prototype.dispose=function(){this.S1b(null,null);this.kRf(this.P_b);this.$.xa.ug(this.yMf);this.$.sn(this.S1b);this.GPb=
null;this.$.ea&&this.$.ea.Z6(this.m6);this.gridView.ha.jO(this.Mh);this.pzc=null;ac.EwaSettings.la(420)&&this.U0&&(pg.a.Fa(this.U0),this.U0=null);sa.prototype.dispose.call(this)};kc.prototype.F5h=function(R,Aa,hb,Ib){var Bc=this.gridView.Rb.Xj(new bf.Range(Aa,hb,Aa,hb,!1,!1));if(this.f5b=Bc){var gc=Bc.usedRange,Id=R.ctrlKey||af.a.isMac&&Yd.b(R),fe=!R.shiftKey&&Id;R=R.shiftKey&&!Id;ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&(ce.g(this.$).ha.selectionType=3);switch(Ib){case 0:this.$Qb=
0;ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Aa=this.N4c(R,gc.top,hb,gc.bottom,hb),this.oPd(Aa,fe,R)):this.pPd(gc.top,hb,gc.bottom,hb,he.d(Bc),he.g(Bc),fe);break;case 1:this.$Qb=1;ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?(Aa=this.N4c(R,Aa,gc.left,Aa,gc.right),this.oPd(Aa,fe,R)):this.pPd(Aa,gc.left,Aa,gc.right,!1,!1,fe);break;case 2:this.$Qb=2;ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5501906_TableSelectionEnableShiftSelection")?
(Aa=this.N4c(R,gc.top,gc.left,gc.bottom,gc.right),this.oPd(Aa,fe,R)):this.pPd(gc.top,gc.left,gc.bottom,gc.right,he.d(Bc),he.g(Bc),fe);break;default:Tc.ULS.shipAssertTag(537151240,0,!1,"TableManager.HandleTableSelectorsSelection: Table Selector can not be of type: {0}",Ib.toString());return}ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5501896_TableSelectionDragSelection")&&(ce.g(this.$).ha.selectionType=3);Tc.ULS.sendTraceTag(527212953,0,50,"TableManager.handleTableSelectorsSelection: A table selector was clicked using hover arrows")}else Tc.ULS.shipAssertTag(537151241,
0,!1,"TableManager.HandleTableSelectorsSelection: Table for table selector selection can't be null")};kc.prototype.Gxj=function(R){var Aa=this.f5b.usedRange;return this.Sgf(R)||1!==this.WHa&&this.Sgf(new bf.Range(Aa.top,R.left,Aa.bottom,R.right,!1,!1))?!0:!1};kc.prototype.tGd=function(R){return R.Autofilters};kc.prototype.fDe=function(R,Aa){var hb=!1;var Ib=Aa.$a.oj(R),Bc=Aa.Sf(Ib).Kh;if(!Bc)return Tc.ULS.sendTraceTag(537151238,0,15,"TableManager.CouldExpandImpl - loadedRange is null. PaneType={0}",
Ib),{returnValue:!1,DY:hb};if(!Bc.zf(R))return{returnValue:!0,DY:hb};R=Aa.xl("TableManager.CouldExpandImpl",R,2);try{for(;R.$$mn();){if(R.$$cu().text||R.ho.o8e)return hb=!0,{returnValue:!1,DY:hb};if(R.$$cu().NH)return{returnValue:!1,DY:hb}}}finally{R&&R.dispose()}return{returnValue:!0,DY:hb}};kc.prototype.XWh=function(R){if(!R)return null;var Aa=new Rd.AutofilterRange(R.top,R.left,R.bottom,R.right,null,null,null,R.id,R.Xva);Aa.xSa=R.xSa;for(var hb=0,Ib=this.rangeList.length;hb<Ib;hb++){var Bc=this.rangeList[hb];
Bc.id===R.id&&Bc!==R&&this.Uli(Bc)&&(Aa.union(Bc),Bc.xSa&&(Aa.xSa=!0))}return Aa};kc.prototype.Uli=function(R){return!!ce.g(this.$).Rb.Xj(R)};kc.prototype.QJh=function(){for(var R=[],Aa=yl(this.rangeList),hb=Aa.next();!hb.done;hb=Aa.next())hb=new Tf.a(this.En(hb.value.topLeft),Ph.d(this.$.pa)),R.push(hb);return R};kc.prototype.Fgd=function(){for(var R={},Aa=yl(this.rangeList),hb=Aa.next();!hb.done;hb=Aa.next())if(hb=hb.value){var Ib=this.En(hb.topLeft);Ib&&(R[Ib.toString()]=this.En(hb.topLeft))}return R};
kc.prototype.Fti=function(){this.$.ea.Th?this.Lxb(0):this.$.ea.Um(this.NN)};kc.prototype.Lxb=function(R){var Aa=this;this.$.$E(function(hb){hb.$ua(R).then(Aa.xFb)})};kc.prototype.o_h=function(R){var Aa=this.gridView.Rb.Xj(R);return Aa?Aa.name:R.toString()};kc.prototype.pPd=function(R,Aa,hb,Ib,Bc,gc,Id){var fe=R+(Bc?1:0),sf=hb-(gc?1:0),hg=this.gridView.inRangePicker||this.gridView.Ci,$f=!1,th=new bf.Range(fe,Aa,sf,Ib,!1,!1);if(Bc||gc)for(Bc=hg?Tf.a.GHa(this.gridView.ha.rangePicker.$K):this.gridView.ha.va.selectedRanges,
Bc=yl(Bc),gc=Bc.next();!gc.done;gc=Bc.next()){gc=gc.value;$f=this.uqb(gc,fe,Aa,sf,Ib);var ji=this.uqb(gc,R,Aa,hb,Ib);if(hg&&$f)break;if(!hg&&($f||ji)){this.gridView.ha.updateSelection(gc,gc.topLeft,0,1);if(Id&&ji)return;break}}$f&&(th.top=R,th.bottom=hb);R=th.topLeft;Id?this.gridView.ha.updateSelection(th,R,0,1):hg?this.gridView.ha.uD([th],0,R,0):this.gridView.ha.updateSelection(th,R,0,3)};kc.prototype.oPd=function(R,Aa,hb){R&&(hb=hb?ce.g(this.$).ha.va.activeCell:R.topLeft,Aa?this.gridView.ha.updateSelection(R,
hb,0,1):this.gridView.ha.uD([R],0,hb,0))};kc.prototype.N4c=function(R,Aa,hb,Ib,Bc){var gc=he.d(this.f5b),Id=he.g(this.f5b),fe=Aa+(1!==this.WHa&&gc?1:0),sf=Ib-(1!==this.WHa&&Id?1:0),hg=this.gridView.inRangePicker||this.gridView.Ci;if(R){var $f=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5593089_TableSelectorsBugFixes")&&hg&&!Tf.a.GHa(this.gridView.ha.rangePicker.$K).length?new bf.Range(fe,hb,sf,Bc,!1,!1):hg?this.gridView.ha.rangePicker.activeCell:this.gridView.ha.va.activeCell;$f=new bf.Range($f.top<
fe?$f.top:fe,$f.left<hb?$f.left:hb,$f.bottom>sf?$f.bottom:sf,$f.right>Bc?$f.right:Bc,!1,!1)}else $f=new bf.Range(fe,hb,sf,Bc,!1,!1);if(1!==this.WHa&&(gc||Id)&&(!R||R&&this.uqb($f,fe,hb,sf,Bc)))for(R=hg?Tf.a.GHa(this.gridView.ha.rangePicker.$K):this.gridView.ha.va.selectedRanges,R=yl(R),gc=R.next();!gc.done;gc=R.next())if(this.uqb(gc.value,fe,hb,sf,Bc)){$f.top=Aa;$f.bottom=Ib;break}return $f};kc.prototype.Sgf=function(R){var Aa=this.gridView.inRangePicker||this.gridView.Ci?Tf.a.GHa(this.gridView.ha.rangePicker.$K):
this.gridView.ha.va.selectedRanges;Aa=yl(Aa);for(var hb=Aa.next();!hb.done;hb=Aa.next())if(this.uqb(hb.value,R.top,R.left,R.bottom,R.right))return!0;return!1};kc.prototype.uqb=function(R,Aa,hb,Ib,Bc){return!!R&&R.top===Aa&&R.bottom===Ib&&R.left===hb&&R.right===Bc};Sk.Object.defineProperties(kc.prototype,{qFa:{configurable:!0,enumerable:!0,get:function(){return this.GPb}},psd:{configurable:!0,enumerable:!0,get:function(){return this.F$d}},WHa:{configurable:!0,enumerable:!0,get:function(){return this.$Qb}},
Mg:{configurable:!0,enumerable:!0,get:function(){var R=ce.g(this.$);return R.Rb.Xj(R.ha.va.activeCell,!1)}},cFd:{configurable:!0,enumerable:!0,get:function(){return this.psd?ce.g(this.$).Rb.Xj(this.psd,!1):null}}});Object(vc.a)(kc,"TableManager",sa,[271,3]);var Dg=kf.a;vm(lb,Dg);lb.prototype.create=function(){this.Fb(this.tableManager||(this.tableManager=new kc(this.$)))};Object(vc.a)(lb,"TableManagerFactory",kf.a,[]);var Jf=b(109),Ne=b(947),gi=b(1412),kh=b(849),Vf=b(1364),ti=b(153),Kh=b(81),Jh=b(107),
nh=b(26),ih=b(180),dh=b(27),Qh=b(303);Object(vc.a)(Va,"TableStyleElement",null,[]);var xh=b(877),Xg=b(201),Lg=b(85),hi=b(553);bb.Xnf=function(R,Aa){return bb.S8f[R.Type]-bb.S8f[Aa.Type]};bb.Q3a=function(R,Aa){try{return appChrome.buildTableStyleGalleryIconNew(bb.bBa,bb.ioa,R,Aa)}catch(hb){return null}};bb.rif=function(R){return R&&Pf.a.ld in R&&(R=R[Pf.a.ld])?If.a.yL(R,dd.a.FFb):!1};bb.bta=function(R){var Aa=[],hb=0;R=yl(R);for(var Ib=R.next();!Ib.done;Ib=R.next()){Ib=Ib.value;Aa[hb]={};Aa[hb].backgroundColor=
"white";Aa[hb].color="black";for(var Bc in Ib){var gc=Ib[Bc];switch(Bc){case "background-color":Aa[hb].backgroundColor=gc;break;case "color":Aa[hb].color=gc;break;case "font-size":Aa[hb].fontSize=gc;break;case "border-bottom":Aa[hb].borderBottom=gc;break;case "border-right":Aa[hb].borderRight=gc;break;case "border-left":Aa[hb].borderLeft=gc;break;case "border-top":Aa[hb].borderTop=gc}}hb++}return Aa};bb.z3b=function(R,Aa){var hb=[];if(null===R||void 0===R?0:R.TableStyleElementsList)for(var Ib=0===
R.Category,Bc=0;Bc<bb.ioa;Bc++)hb.push.apply(hb,bb.INh(R,Aa,Ib,Bc));else{if(bb.m6c)return bb.m6c;R={color:"black","background-color":"white"};for(Aa=0;Aa<bb.ioa;Aa++)for(Ib=0;Ib<bb.bBa;Ib++)hb.push(R);bb.m6c=hb}return hb};bb.p_h=function(R,Aa){if(!R.TableStyleElementsList)return"";var hb="";R=yl(R.TableStyleElementsList);for(var Ib=R.next();!Ib.done;Ib=R.next())if(Ib=Ib.value,Ib.BackgroundColor&&"#000000"!==Ib.BackgroundColor)switch(Ib.Type){case 0:hb=Ib.BackgroundColor;break;case 5:case 7:if(Aa.$ha||
Aa.nS)hb=Ib.BackgroundColor;break;case 3:case 4:if(Aa.firstCol||Aa.lastCol)hb=Ib.BackgroundColor;break;case 2:Aa.totalRow&&(hb=Ib.BackgroundColor);break;case 1:Aa.headerRow&&(hb=Ib.BackgroundColor)}return hb};bb.z2b=function(R){R=new Xg.a(parseInt(String("0x"+R.substr(1,2)),16),parseInt(String("0x"+R.substr(3,2)),16),parseInt(String("0x"+R.substr(5,2)),16));return xh.a.rKa(R)};bb.j4e=function(R,Aa){if(!R||!Aa)return"";Aa=(Aa=bb.p_h(R,Aa))?bb.z2b(Aa)+", ":Pd.a.instance.fa(2010)+", ";switch(R.Index){case 0:return Aa+
Pd.a.instance.fa(1944);case 1:return Aa+Pd.a.instance.fa(1945);case 2:return Aa+Pd.a.instance.fa(1946);case 3:return Aa+Pd.a.instance.fa(1947);case 4:return Aa+Pd.a.instance.fa(1948);case 5:return Aa+Pd.a.instance.fa(1949);case 6:return Aa+Pd.a.instance.fa(1950);case 7:return Aa+Pd.a.instance.fa(1951);case 8:return Aa+Pd.a.instance.fa(1952);case 9:return Aa+Pd.a.instance.fa(1953);case 10:return Aa+Pd.a.instance.fa(1954);case 11:return Aa+Pd.a.instance.fa(1955);case 12:return Aa+Pd.a.instance.fa(1956);
case 13:return Aa+Pd.a.instance.fa(1957);case 14:return Aa+Pd.a.instance.fa(1958);case 15:return Aa+Pd.a.instance.fa(1959);case 16:return Aa+Pd.a.instance.fa(1960);case 17:return Aa+Pd.a.instance.fa(1961);case 18:return Aa+Pd.a.instance.fa(1962);case 19:return Aa+Pd.a.instance.fa(1963);case 20:return Aa+Pd.a.instance.fa(1964);case 21:return Aa+Pd.a.instance.fa(1965);case 22:return Aa+Pd.a.instance.fa(1966);case 23:return Aa+Pd.a.instance.fa(1967);case 24:return Aa+Pd.a.instance.fa(1968);case 25:return Aa+
Pd.a.instance.fa(1969);case 26:return Aa+Pd.a.instance.fa(1970);case 27:return Aa+Pd.a.instance.fa(1971);case 28:return Aa+Pd.a.instance.fa(1972);case 29:return Aa+Pd.a.instance.fa(1973);case 30:return Aa+Pd.a.instance.fa(1974);case 31:return Aa+Pd.a.instance.fa(1975);case 32:return Aa+Pd.a.instance.fa(1976);case 33:return Aa+Pd.a.instance.fa(1977);case 34:return Aa+Pd.a.instance.fa(1978);case 35:return Aa+Pd.a.instance.fa(1979);case 36:return Aa+Pd.a.instance.fa(1980);case 37:return Aa+Pd.a.instance.fa(1981);
case 38:return Aa+Pd.a.instance.fa(1982);case 39:return Aa+Pd.a.instance.fa(1983);case 40:return Aa+Pd.a.instance.fa(1984);case 41:return Aa+Pd.a.instance.fa(1985);case 42:return Aa+Pd.a.instance.fa(1986);case 43:return Aa+Pd.a.instance.fa(1987);case 44:return Aa+Pd.a.instance.fa(1988);case 45:return Aa+Pd.a.instance.fa(1989);case 46:return Aa+Pd.a.instance.fa(1990);case 47:return Aa+Pd.a.instance.fa(1991);case 48:return Aa+Pd.a.instance.fa(1992);case 49:return Aa+Pd.a.instance.fa(1993);case 50:return Aa+
Pd.a.instance.fa(1994);case 51:return Aa+Pd.a.instance.fa(1995);case 52:return Aa+Pd.a.instance.fa(1996);case 53:return Aa+Pd.a.instance.fa(1997);case 54:return Aa+Pd.a.instance.fa(1998);case 55:return Aa+Pd.a.instance.fa(1999);case 56:return Aa+Pd.a.instance.fa(2E3);case 57:return Aa+Pd.a.instance.fa(2001);case 58:return Aa+Pd.a.instance.fa(2002);case 59:return Aa+Pd.a.instance.fa(2003);default:return R.Name?R.Name:""}};bb.JUh=function(R){return(R+1)%bb.U8h};bb.Xvb=function(R,Aa,hb){hb=void 0===
hb?"":hb;return R||!hb?String.format("{0}, {1}, -version, {2}",bb.z$e,R.Index.toString(),Aa.toString()):String.format("{0}, {1}, -version, {2}",bb.z$e,hb,Aa.toString())};bb.INh=function(R,Aa,hb,Ib){for(var Bc=[],gc=0;gc<bb.bBa;gc++)Bc.push(bb.ged(R,Aa,hb,Ib,gc));return Bc};bb.ged=function(R,Aa,hb,Ib,Bc){var gc=R.TableStyleElementsList;R=new Va;var Id={};if(!gc)return Id;for(var fe=yl(gc),sf=fe.next();!sf.done;sf=fe.next())if(sf=sf.value,0===sf.Type){R=sf;break}fe=!!R.BackgroundColor;var hg="";!hb&&
R.TableStyleBorderFromatList&&0<R.TableStyleBorderFromatList.length&&(hg=R.TableStyleBorderFromatList[0].Color);Id["background-color"]=fe?R.BackgroundColor:"#FFFFFF";R.FontColor||(R.FontColor="#000000");Id.color=R.FontColor;bb.lye(Ib,Bc,Id,R,hg,hb,fe);gc=yl(gc);for(sf=gc.next();!sf.done;sf=gc.next())(sf=sf.value)&&0!==sf.Type&&(2!==sf.Type||fe||(sf.BackgroundColor=R.BackgroundColor),bb.brd(sf,Ib,Bc,Aa)&&(sf.BackgroundColor&&(Id["background-color"]=sf.BackgroundColor),Id.color=sf.FontColor||R.FontColor,
bb.lye(Ib,Bc,Id,sf,hg,hb,fe)));return Id};bb.nV=function(R,Aa,hb,Ib,Bc,gc){hb&&(hb.Color&&!hb.Style&&(hb.Style=1),hb.Style&&!hb.Color&&(hb.Color=Bc?"#000000":Ib?Ib:gc?"#FFFFFF":"#000000"),Aa[bb.borders[R]]="1px "+bb.cW[hb.Style]+" "+hb.Color)};bb.brd=function(R,Aa,hb,Ib){return-1===R.Type?!1:bb.crd(R,Aa,hb,Ib)||bb.Wni(R,Aa,hb,Ib)||bb.drd(R,Aa,hb,Ib)};bb.Wni=function(R,Aa,hb,Ib){return!Aa&&Ib.headerRow||Aa===bb.ioa-1&&Ib.totalRow?!1:1===Aa%2&&5===R.Type&&Ib.nS&&Ib.headerRow||1<Aa&&!!((Aa-1)%(R.BandSize+
1))&&6===R.Type&&Ib.nS&&Ib.headerRow||!(Aa%2)&&5===R.Type&&Ib.nS&&!Ib.headerRow||!!(Aa%(R.BandSize+1))&&6===R.Type&&Ib.nS&&!Ib.headerRow||!(hb%2)&&7===R.Type&&Ib.$ha||!!(hb%(R.BandSize+1))&&8===R.Type&&Ib.$ha};bb.drd=function(R,Aa,hb,Ib){return Aa===bb.ioa-1&&2===R.Type&&Ib.totalRow||hb===bb.bBa-1&&Aa===bb.ioa-1&&12===R.Type&&Ib.totalRow&&Ib.lastCol||!hb&&Aa===bb.ioa-1&&11===R.Type&&Ib.totalRow&&Ib.firstCol||hb===bb.bBa-1&&4===R.Type&&Ib.lastCol};bb.crd=function(R,Aa,hb,Ib){return!Aa&&1===R.Type&&
Ib.headerRow||!hb&&3===R.Type&&Ib.firstCol||!hb&&!Aa&&9===R.Type&&Ib.headerRow&&Ib.firstCol||hb===bb.bBa-1&&!Aa&&10===R.Type&&Ib.headerRow&&Ib.lastCol};bb.lye=function(R,Aa,hb,Ib,Bc,gc,Id){if(Ib.TableStyleBorderFromatList)for(var fe=yl(Ib.TableStyleBorderFromatList),sf=fe.next();!sf.done;sf=fe.next())if(sf=sf.value,sf.Style)switch(sf.Position){case 0:R&&12!==Ib.Type&&11!==Ib.Type&&2!==Ib.Type&&5!==Ib.Type&&6!==Ib.Type||bb.nV(0,hb,sf,Bc,gc,Id);break;case 1:R!==bb.ioa-1&&1!==Ib.Type&&10!==Ib.Type&&
9!==Ib.Type&&5!==Ib.Type&&6!==Ib.Type||bb.nV(1,hb,sf,Bc,gc,Id);break;case 2:Aa&&12!==Ib.Type&&10!==Ib.Type&&7!==Ib.Type&&8!==Ib.Type&&4!==Ib.Type||bb.nV(2,hb,sf,Bc,gc,Id);break;case 3:Aa!==bb.bBa-1&&9!==Ib.Type&&11!==Ib.Type&&3!==Ib.Type&&7!==Ib.Type&&8!==Ib.Type||bb.nV(3,hb,sf,Bc,gc,Id);break;case 5:Aa!==bb.bBa-1&&3!==Ib.Type&&4!==Ib.Type&&7!==Ib.Type&&8!==Ib.Type&&bb.nV(3,hb,sf,Bc,gc,Id);break;case 6:R!==bb.ioa-1&&2!==Ib.Type&&1!==Ib.Type&&5!==Ib.Type&&6!==Ib.Type&&bb.nV(1,hb,sf,Bc,gc,Id)}};bb.s_h=
function(){var R=Array(12);R[0]=0;R[7]=1;R[8]=2;R[5]=3;R[6]=4;R[4]=5;R[3]=6;R[1]=7;R[2]=8;R[9]=9;R[10]=10;R[11]=11;R[12]=13;return R};bb.ioa=5;bb.bBa=5;bb.U8h=5;bb.z$e="TableStyleIcon";bb.cW=[null,Lg.a.solid,Lg.a.dashed,Lg.a.dotted,Lg.a.dashed,Lg.a.dotted,Lg.a.dashed,Lg.a.double];bb.borders=[hi.a.borderTop,hi.a.borderBottom,hi.a.borderLeft,hi.a.borderRight];bb.S8f=bb.s_h();bb.m6c=null;Object(vc.a)(bb,"TableStyleHelper",null,[]);Ia.prototype.equals=function(R){return R?this.headerRow===R.headerRow&&
this.totalRow===R.totalRow&&this.firstCol===R.firstCol&&this.lastCol===R.lastCol&&this.$ha===R.$ha&&this.nS===R.nS:!1};Object(vc.a)(Ia,"TableStyleOptions",null,[]);var Lh=b(925),Kg=ud.a;vm(ta,Kg);ta.prototype.G5h=function(R){var Aa=this.tableManager.Mg;if(!Aa)return!1;R=R[Pf.a.ld];if(!R)return!1;switch(Number.parseInvariant(R)){case 0:return he.d(Aa);case 1:return he.c(Aa);case 2:return he.g(Aa);case 3:return he.e(Aa);case 4:return he.f(Aa);case 5:return he.b(Aa);case 6:return Aa.hasAutoFilter}return!1};
ta.prototype.rIf=function(R,Aa){if(Jf.a.isEmpty(this.hG))return!0;if("PopulateTableMoreStylesMenu"!==R&&"PopulateTableAccessibleStylesMenu"!==R)return!1;if(ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)&&"PopulateTableAccessibleStylesMenu"===R&&!this.Myc)return this.JLb||(this.JLb=!0,this.FKa("accessibilityTab")),!0;this.Lzb=!0;var hb=this.Sa.Lp("TableStylesMenu"),Ib=this.Sa.GA("Ribbon.TableTools.TableStyles.Gallery.Custom",7,"Size48by48"),Bc=this.Sa.GA("Ribbon.TableTools.TableStyles.Gallery.Dark",
7,"Size48by48"),gc=this.Sa.GA("Ribbon.TableTools.TableStyles.Gallery.Medium",7,"Size48by48"),Id=this.Sa.GA("Ribbon.TableTools.TableStyles.Gallery.Light",7,"Size48by48"),fe=-123538519;if(Aa.MenuId)if(If.a.contains(Aa.MenuId,"FormatAsTable",!0))fe=753331043,this.m6a=!0;else{var sf=Pd.a.instance.fa(1943);var hg=bb.Xvb(null,1,"-1");ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4185429_NonNullIconNameForSLRGalleryItem")?Id.Bt("-1",fe,"QueryTableStyle",0,"-1",hg,void 0,void 0,sf):Id.Bt("-1",fe,"QueryTableStyle",
0,"-1",void 0,void 0,void 0,sf);this.m6a=!1}hg=0;var $f=this.hG,th;for(th in $f){var ji=$f[th];if(!ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)||"PopulateTableAccessibleStylesMenu"!==R||!ji.HasStyleViolations){sf=bb.j4e(ji,this.Rub());var aj=bb.Xvb(ji,this.OHa);if(ji)switch(ji.Category){case 0:Ib.Bt(ji.Index.toString(),fe,"QueryTableStyle",0,ji.Index.toString(),aj,void 0,void 0,sf);hg++;break;case 3:Bc.Bt(ji.Index.toString(),fe,"QueryTableStyle",0,ji.Index.toString(),
aj,void 0,void 0,sf);break;case 2:gc.Bt(ji.Index.toString(),fe,"QueryTableStyle",0,ji.Index.toString(),aj,void 0,void 0,sf);break;case 1:Id.Bt(ji.Index.toString(),fe,"QueryTableStyle",0,ji.Index.toString(),aj,void 0,void 0,sf)}}}0<hg&&this.B2(hb,Ib,1911);this.B2(hb,Id,1912);this.B2(hb,gc,1913);this.B2(hb,Bc,1914);Aa.MenuItems=hb.aC();this.isInitialized||(this.isInitialized=!0);return!0};ta.prototype.H5h=function(R){var Aa=this;R[Ne.a.On]=!1;var hb=R[Pf.a.ld];if(hb&&!Jf.a.isEmpty(this.hG)){If.a.contains(R.ParentMenuId,
"FormatAsTable",!0)?this.m6a=!0:this.m6a=!1;this.m6a||this.ndg();bb.rif(R)&&(hb=this.lvb(hb).toString());var Ib=this.Rub();R[Ne.a.Alt]="-1"===hb?Pd.a.instance.fa(1943):bb.j4e(this.vhd(hb),Ib);if(hb in this.VSa&&Ib.equals(this.wZc))this.uIf(R,hb,Ib,!0);else{if(!this.yrc||this.yrc&&!this.yrc.fp)this.Ema={},this.yrc=He.a.instance.create(function(){Aa.uOf();Aa.wZc=Aa.Rub()},0,vg.a.lJj,!0,!0);this.XDd(Ib,R,hb)}}};ta.prototype.getTableStyleIndexFromName=function(R){if(!R||Jf.a.isEmpty(this.hG))return-1;
if(R in this.hG)return this.hG[R].Index;this.FKa("getTableStyleIndexFromName");return-1};ta.prototype.Yhc=function(){return!!this.AL};ta.prototype.lvb=function(R){this.eO||this.ZYc();return R in this.eO?this.eO[R]:-1};ta.prototype.FKa=function(R){if(this.$.isEditMode)if(ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AccessibleAuthoringTab",!1)){var Aa=new Date;if(30<Jh.getElapsedSeconds(this.lastSyncTime,Aa)||Jf.a.isEmpty(this.hG)||this.JLb){var hb=this.$.na.ta.Zb();this.lastSyncTime=
Aa;R=this.JLb&&"accessibilityTab"===R||"galleryMenuClosed"===R;Kh.s(this.$.na.ta,R,this.Vyf,this.AAd,null,R?"accessibility":"normal",hb)}}else if(hb=new Date,30<Jh.getElapsedSeconds(this.lastSyncTime,hb)||Jf.a.isEmpty(this.hG))R=this.$.na.ta.Zb(),this.lastSyncTime=hb,Kh.r(this.$.na.ta,this.Vyf,this.AAd,null,null,R)};ta.prototype.dispose=function(){this.eO=this.VSa=this.AL=this.hG=null;this.$.Ka.cbb(this.wEf);Kg.prototype.dispose.call(this)};ta.prototype.PGg=function(R){this.addHandler("RefreshTableStyleGallery",
R)};ta.prototype.Ldj=function(R){this.removeHandler("RefreshTableStyleGallery",R)};ta.prototype.ZYc=function(){var R={};this.tableManager.Mg&&(this.Jda=this.getTableStyleIndexFromName(this.tableManager.Mg.ozc));for(var Aa=1;7>=Aa;Aa++)R["preview"+Aa]=this.MTh(Aa);this.eO=R};ta.prototype.MTh=function(R){var Aa=this.AL.TableStyleItems.length;Aa=4>=this.Jda?this.Jda+R-1:4<this.Jda&&this.Jda<Aa-4?4===R?this.Jda:Math.floor(this.Jda+R-4):this.Jda+R-1;-1===Aa||Aa.toString()in this.VSa||(Aa=R-3);return Aa};
ta.prototype.ndg=function(){if(this.tableManager.Mg){var R=!1,Aa=this.getTableStyleIndexFromName(this.tableManager.Mg.ozc);if(Aa!==this.Jda){if(this.eO){var hb=this.eO,Ib;for(Ib in hb)hb[Ib]===Aa&&(R=!0)}this.Jda=Aa;R||Jf.a.isEmpty(this.VSa)||this.ZYc()}}};ta.prototype.B2=function(R,Aa,hb){var Ib=this.Sa.Mc();Ib.Pp="Thin";Ib.title=Pd.a.instance.fa(hb);Ib.buttons.push(Aa);R.zc.push(Ib)};ta.prototype.Rub=function(){var R=this.tableManager.Mg;return this.m6a||!R?new Ia(!0,!1,!1,!1,!0,!1):new Ia(he.d(R),
he.g(R),he.c(R),he.e(R),he.f(R),he.b(R))};ta.prototype.uOf=function(R){R=void 0===R?!1:R;var Aa={},hb={},Ib=this.Rub();if(!Jf.a.isEmpty(this.hG)&&(this.tableManager.Mg&&this.ndg(),!Ib.equals(this.wZc)||R||Jf.a.isEmpty(this.VSa))){this.OHa=bb.JUh(this.OHa);R=this.hG;for(var Bc in R){var gc=R[Bc],Id=bb.Xvb(gc,this.OHa);Aa[gc.Index.toString()]=bb.Q3a(bb.bta(bb.z3b(gc,Ib)),Id);hb[Id]=Aa[gc.Index.toString()];this.FGb(hb)}Bc=bb.Xvb(null,this.OHa,"-1");Aa["-1"]=bb.Q3a(bb.bta(bb.z3b(null,Ib)),Bc);hb[Bc]=
Aa["-1"];this.FGb(hb);ih.c(this.VSa,Aa,!1)}};ta.prototype.loi=function(){var R=ti.a(this.$);return R?R.Im.Do===dd.a.drc:!1};ta.prototype.XDd=function(R,Aa,hb){Number.parseInvariant(hb);"-1"===hb&&If.a.contains(Aa.ParentMenuId,"FormatAsTable",!0)||this.uIf(Aa,hb,R,!1)};ta.prototype.uIf=function(R,Aa,hb,Ib){var Bc=bb.Xvb(null,this.OHa,Aa);bb.rif(R)?(Bc in this.Ema?hb=this.Ema[Bc]:(hb=bb.bta(bb.z3b(this.vhd(Aa),hb)),this.Ema[Bc]=hb),R[Ne.a.GalleryButtonProps]=Object.assign(new gi.a,{Command:"-123538519",
QueryCommand:"QueryTableStyle",Id:Bc,Alt:R[Ne.a.Alt],MenuItemId:Aa,TableCellStyles:hb,TableStyles:this.H1i})):(R[kh.a.Icon]=Bc,R[Ne.a.GalleryButtonProps]=Object.assign(new Vf.a,{Command:"-123538519",QueryCommand:"QueryTableStyle",Id:Bc,Alt:R[Ne.a.Alt],MenuItemId:Aa}),Ib||(Ib=[],this.vhd(Aa),"-1"===Aa||If.a.contains(R.ParentMenuId,"FormatAsTable",!0)||(Ib=bb.z3b(this.AL.TableStyleItems[Number.parseInvariant(Aa)],hb)),this.VSa[Aa]=bb.Q3a(bb.bta(Ib),Bc)))};ta.prototype.FGb=function(R){var Aa=this;if(this.Lzb)this.wuc=
function(){Aa.FGb(R)};else{this.wuc=null;var hb=[],Ib;for(Ib in R){var Bc=Ib;Bc in this.GGb?hb.push(Bc):this.GGb[Bc]=!0}try{0<hb.length&&appChrome.api.unregisterIcons(hb),Jf.a.isEmpty(R)||appChrome.api.registerIconProvider(function(){return R})}catch(gc){}}};ta.prototype.vhd=function(R){R=Number.parseInvariant(R);if(-1===R||!this.AL)return null;if(60<R)for(var Aa=60;Aa<this.AL.TableStyleItems.length;++Aa){var hb=this.AL.TableStyleItems[Aa];if(hb.Index===R)return hb}return this.AL.TableStyleItems[R]};
Object(vc.a)(ta,"TableStyleManager",ud.a,[269,3]);var ai=kf.a;vm(ra,ai);ra.prototype.create=function(){var R=this,Aa=bg.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.ub),hb=bg.GetServiceTaskFactory.Wa(this.$.da,66,134,this.ub);ig.TaskExtensions.Ba(Da.Task.WAA(Aa,hb),function(){R.Fb(R.tableStyleManager||(R.tableStyleManager=new ta(R.$,Aa.result,hb.result)))},this.$.ma,8)};Object(vc.a)(ra,"TableStyleManagerFactory",kf.a,[]);var Fh=b(817),Sg=b(54);Ba.prototype.jV=function(){return this.autoFilterOptions};
Object(vc.a)(Ba,"MacroRecorderRangeColumnSortedOrFilteredPayload",null,[147]);P.prototype.jV=function(){return this.autoFilterOptions};Object(vc.a)(P,"MacroRecorderRangeItemFilteredPayload",null,[147]);var zg=b(1057),wh=b(369),ch=b(164),Bg=b(175),Ah=b(272);Object(vc.a)(Ob,"MacroRecorderTableStyleAppliedPayload",null,[147]);vm(cc,Ob);Object(vc.a)(cc,"MacroRecorderRangeFormatedAsTablePayload",Ob,[]);Jb.prototype.En=function(){return this.tableRange};Jb.prototype.getTitle=function(){return this.title};
Jb.prototype.getDescription=function(){return this.description};Object(vc.a)(Jb,"MacroRecorderTableAltTextEditedPayload",null,[147]);Object(vc.a)(ic,"MacroRecorderTableRenamedPayload",null,[147]);Object(vc.a)(Ub,"MacroRecorderTableResizedPayload",null,[147]);Object(vc.a)(pb,"MacroRecorderTableStyleOptionToggledPayload",null,[147]);Object(vc.a)(Oa,"MacroRecorderTableConvertedToRangePayload",null,[147]);lc.prototype.TL=function(){Tc.ULS.sendTraceTag(537151186,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken to show Get IsRangeQueryTable is {0} milliseconds",
this.Bf.gh.Dc);if(this.eCa&&!Qh.a(this.eCa)){this.Bf.nzb=this.eCa.Result;if(this.Bf.nzb)return this.f0d=dh.a.hd(3,2,0,725,0,-66108047,"ConvertToRange"),this.jj=td.a(this.Bf.$).vi(this.f0d).G(),this.jj.isCompleted||(this._state=2,this.jj.PN(this.moveNext)),this.qDc;this.Bf.SCe();return this.Gfb}return this.p1};lc.prototype.p1=function(){this.Bf.gh.stop();Tc.ULS.sendTraceTag(537151185,0,50,"ConvertToRangeManager.ShowDialogOld: Total Time taken for complete operation is {0} milliseconds",this.Bf.gh.Dc);
this._state=3};lc.prototype.Gfb=function(){return this.p1};lc.prototype.qDc=function(){this.g0d=this.jj.hz();Tc.ULS.sendTraceTag(537151184,0,50,"ConvertToRangeManager.ShowDialogOld: Time taken for User Input is {0} milliseconds",this.Bf.gh.Dc);0===this.g0d&&this.Bf.RCe();return this.Gfb};lc.prototype.dispose=function(){};Object(vc.a)(lc,"$$sm_Microsoft$Office$Excel$WebUI$Client$TableOperations$ConvertToRangeManager$ShowDialogOld",null,[3]);var eg=b(872);Xb.prototype.D$a=function(){var R=this;this.gh.start();
var Aa=this.$.na.ta.Zb();return ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?eg.h(this.$.na.ta,this.sharedSheetRange,function(hb){R.showDialog(hb)},null,null,null,Aa):eg.h(this.$.na.ta,this.sharedSheetRange,function(hb){R.TAj(hb)},null,null,null,Aa)};Xb.prototype.showDialog=function(R){var Aa=this;Tc.ULS.sendTraceTag(537151193,0,50,"ConvertToRangeManager.ShowDialog: Time taken to show Get IsRangeQueryTable is {0} milliseconds",
this.gh.Dc);R&&!Qh.a(R)&&((this.nzb=R.Result)?(R=dh.a.hd(3,2,0,725,0,-66108047,"ConvertToRange"),ig.TaskExtensions.Ba(td.a(this.$).vi(R),function(hb){Tc.ULS.sendTraceTag(537151192,0,50,"ConvertToRangeManager.ShowDialog: Time taken for User Input is {0} milliseconds",Aa.gh.Dc);0===hb.result&&Aa.RCe()},this.$.ma,11)):this.SCe());this.gh.stop();Tc.ULS.sendTraceTag(537151191,0,50,"ConvertToRangeManager.ShowDialog: Total Time taken for complete operation is {0} milliseconds",this.gh.Dc)};Xb.prototype.TAj=
function(R){new lc(this,R)};Xb.prototype.Zue=function(){var R={};R.IsQueryTable=this.nzb;R.Range=this.sharedSheetRange;return R};Xb.prototype.RCe=function(){var R=this,Aa=this.$.na.ta;Tc.ULS.sendTraceTag(537151190,0,50,"Convert To Range initiated for Query Table");this.scf(194,function(hb,Ib,Bc){return eg.d(Aa,R.Zue(),hb,Ib,Bc,null)});Tc.ULS.sendTraceTag(537151189,0,50,"Convert To Range completed for Query Table")};Xb.prototype.SCe=function(){var R=this,Aa=this.$.na.ta;Tc.ULS.sendTraceTag(537151188,
0,50,"Convert To Range initiated for Normal Table");this.scf(193,function(hb,Ib,Bc){return eg.c(Aa,R.Zue(),hb,Ib,Bc,null)},function(){return new Oa(R.tableName)});Tc.ULS.sendTraceTag(537151187,0,50,"Convert To Range completed for Normal Table")};Xb.prototype.scf=function(R,Aa,hb){hb=void 0===hb?null:hb;wh.a(this.$.userOperationManager,Aa,function(Ib){return new ch.a(R,0,Ib,void 0,hb)},null)};Object(vc.a)(Xb,"ConvertToRangeManager",null,[]);var Mh=b(1216),pi=b(1215),mg=b(1252),si=mg.a;vm($b,si);$b.prototype.Zl=
function(){var R=this,Aa=Bf.s(this.mC.TableRange);return function(){return new cc(Aa,R.Q4a.checked,R.cBa,!0)}};$b.prototype.ox=function(){var R=this,Aa=Bf.s(this.mC.TableRange);return function(hb,Ib,Bc){return eg.g(R.$.na.ta,Aa,R.Q4a.checked,!1,R.mC.HasTotalRow,R.cBa,hb,Ib,Bc,null)}};$b.prototype.$x=function(R,Aa,hb){si.prototype.$x.call(this,R,Aa,hb)};Sk.Object.defineProperties($b.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"FormatAsTableDialog"}},Rw:{configurable:!0,enumerable:!0,
get:function(){return 215}}});Object(vc.a)($b,"FormatAsTableDialogDeprecated",mg.a,[]);var Wh=b(1081),qg=Wh.a;vm(pd,qg);pd.prototype.Zl=function(){var R=this,Aa=Bf.s(this.mC.TableRange);return function(){return new cc(Aa,R.hasHeaders,R.cBa,!0)}};pd.prototype.ox=function(){var R=this,Aa=Bf.s(this.mC.TableRange),hb=this.mC.HasTotalRow;return function(Ib,Bc,gc){return eg.g(R.$.na.ta,Aa,R.hasHeaders,!1,hb,R.cBa,Ib,Bc,gc,null)}};Sk.Object.defineProperties(pd.prototype,{Ac:{configurable:!0,enumerable:!0,
get:function(){return"FormatAsTableDialog"}},Rw:{configurable:!0,enumerable:!0,get:function(){return 215}},io:{configurable:!0,enumerable:!0,get:function(){return Pd.a.instance.fa(719)}}});Object(vc.a)(pd,"FormatAsTableReactDialog",Wh.a,[]);var Ca=b(371),ua=b(82),sb=Ca.a;vm(sc,sb);sc.prototype.YGf=function(R){R=R.startsWith("=")?R.substring(1,R.length):R;var Aa=Bf.Z(R,this.$.xa);R=Aa.sheetName;var hb=Aa.range;return Aa.returnValue&&hb?(hb=Bf.v(hb,this.$),hb.SheetName=If.a.equals(R,"",!0)?this.$.pa.name:
R,hb):null};sc.prototype.tV=function(R){var Aa={};return Aa[sc.a5]="ResizeTableDialog",Aa[sc.uMf]=R,Aa.getInputErrorIfInvalid=this.mvb,Aa};sc.prototype.yfd=function(R){R=this.YGf(R);if(!R)return 1;var Aa=Bf.D(R);return If.a.equals(R.SheetName,this.$.pa.sheetName,!0)&&this.Soc.top===Aa.top&&this.Soc.Qd(Aa)?0:2};sc.prototype.Rcd=function(R){var Aa="";switch(R){case 1:Aa=Pd.a.instance.fa(74);break;case 2:Aa=ua.a.ym(Pd.a.instance.fa(73))}return Aa};sc.prototype.FNj=function(R){var Aa={};R=(Aa.ResizeTableRange=
R,Aa.OriginalTableRange=this.Soc,Aa);this.$.xe(-1400250766,Pf.a.$b,8,R)};Sk.Object.defineProperties(sc.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"ResizeTableDialog"}}});sc.a5="id";sc.uMf="range";Object(vc.a)(sc,"ResizeTableDialog",Ca.a,[]);var Ld=Ca.a;vm(mb,Ld);mb.prototype.aJj=function(R,Aa){if(1===R&&(R=Aa[mb.yLj],Aa=Aa[mb.Hdh],R!==this.CCd||Aa!==this.zCd)){var hb={};R=(hb.Title=R,hb.Description=Aa,hb);this.$.xe(868579142,Pf.a.$b,8,R)}};mb.prototype.tV=function(R,Aa){var hb=
{};return hb.id="AltTextDialog",hb.title=R,hb.description=Aa,hb};Sk.Object.defineProperties(mb.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"TableAltTextDialog"}}});mb.a5="id";mb.yLj="title";mb.Hdh="description";Object(vc.a)(mb,"TableAltTextDialog",Ca.a,[]);var le=b(900),nf=b(901),ug=b(135),Cf=b(65),Cg=b(39);Za.prototype.Yc=function(R,Aa){switch(Aa){case -544558380:return!(this.tableManager&&this.va.tK()&&!this.fMa()&&he.d(this.tableManager.Mg));case 1544516694:return!(this.tableManager&&
(this.va.tK()?!this.fMa():this.va.OLa()));case -697806646:case 323142015:return!this.va.tK();case 341449783:case 2128797448:return ac.EwaSettings.isChangeGateEnabled("OfficeVSO:6083078_HeaderAndTotalRowDisabledFix")?!(this.tableManager&&(this.va.tK()?!this.fMa():this.va.OLa())):!(this.tableManager&&this.tableManager.hrd(this.va.activeCell));case -123538519:return!(this.va.tK()&&this.tableStyleManager&&this.tableStyleManager.Yhc());case 756677940:return!(ac.EwaSettings.la(420)&&this.hfi());case 753331043:case 2105103744:case -585683120:return!(this.tableStyleManager&&
this.ifi());case 844144422:return!this.va.tK();case -723113214:return!(ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&this.va.tK())}return!1};Za.prototype.executeCommand=function(R,Aa,hb){var Ib=this,Bc;R=ig.TaskExtensions.om();var gc=this.$.na.ta,Id=null,fe=1,sf=Aa.command,hg=this.$.na.ta.Zb(),$f=null;switch(sf){case -2058042992:var th=Sg.a.pi(hb[Pf.a.Ug]);Za.TYf(this.$,th);Id=function(Vg,ph,uj){return eg.a(gc,th,null,null,!1,!1,!1,le.a.Dva(ug.a.ksa,
nf.a.clearAutoFilter,Vg),ph,uj,null)};fe=176;$f=function(){return new P(th)};break;case 504133448:case -798968736:case 477776686:var ji=Sg.a.pi(hb[Pf.a.Ug]),aj=hb.TopCellAddress;Za.TYf(this.$,ji);var Uj=504133448===Aa.command?1:-798968736===Aa.command?2:3;if(ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&aj){hb=this.tableManager.En(aj);if(!hb&&ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")){var de=this.$.xa.pa;(null===
(Bc=Bf.D(de.I0))||void 0===Bc?0:Bc.contains(aj))?hb=Bf.D(de.I0):Tc.ULS.sendTraceTag(527700033,0,15,"TableCommandHandler.executeCommand: unknown sort range; unable to check for protected ranges")}if(!this.$.isEditMode){if(!ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||hb&&!this.$.UWc([hb],!0,1))break}else if(hb&&!this.$.Ns([hb],!0,1))break}Id=function(Vg,ph,uj){return Kh.ib(gc,ji,Uj,Ah.b(Vg,Ib.XTi),ph,uj,aj,hg)};fe=177;$f=function(){return new Ba(ji,Uj)};
break;case 341449783:case 2128797448:this.mRa=341449783===sf?0:2;Bc=this.toggleTableStyleOption(gc,hg);Id=Bc.Pgg;fe=Bc.operationName;$f=Bc.Zl;break;case -712419744:this.qw?this.ccf(hb[dd.a.event]):this.ccf(null);break;case 1868184698:ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new pi.a(this.$):(Bc=new Mh.a(this.$),Bc.initialize(),Bc.mf());break;case 844144422:new sc(this.$);break;case 1544516694:case -544558380:if(Bc=hb[Pf.a.ld])this.mRa=this.r_h(Bc),-1!==this.mRa&&
(Bc=this.toggleTableStyleOption(gc,hg),Id=Bc.Pgg,fe=Bc.operationName,$f=Bc.Zl);break;case 756677940:if(this.fMa()&&this.Lgf()){Tc.ULS.sendTraceTag(537151177,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while executing rename command");break}var Se=hb.Text,Qi=this.QSh();if(Qi){Id=function(Vg,ph,uj){return eg.i(gc,Se,Qi,Ah.b(Vg,Ib.WTi),Ah.a(ph,Ib.VTi),uj,hg)};fe=217;var Nh=null;this.tableManager.Mg?Nh=this.tableManager.Mg.name:
this.tableManager.cFd?Nh=this.tableManager.cFd.name:Tc.ULS.sendTraceTag(537151176,0,15,"TableCommandHandler.RenameTable: current table object and previous selected table object both found to be null while fetching oldName during executing rename command");Nh&&($f=function(){return new ic(Nh,Se)})}else return Tc.ULS.sendTraceTag(537151175,0,10,"TableCommandHandler.RenameTable: Selected Table Range is null"),Da.Task.Ta(!1);break;case 323142015:if(this.fMa())break;return(new Xb(this.$,this.idd(),this.tableManager.Mg.name)).D$a();
case -1400250766:fe=211;Id=this.$hj(hb,gc,hg);var fg=Bf.m(hb.OriginalTableRange,this.$.xa.pa);$f=function(){return new Ub(fg)};break;case 1872288872:this.tableManager.r4i();break;case -123538519:var bi=this.q_h(hb);Bc=If.a.contains(hb[Pf.a.ld],dd.a.FFb,!0)||If.a.contains(hb[dd.a.CI],"TableStyleIcon",!0)?"Preview Gallery":"Pop-out Gallery";Tc.ULS.sendTraceTag(51181323,0,50,"TableStyleManager.ApplyTableStyleWebInvocation - Apply Table Style Invoked from {0} with style index {1}",Bc,bi.toString());var Li=
this.p3e();Li&&(Id=function(Vg,ph,uj){return eg.b(gc,Li,bi,Vg,ph,uj,null,hg)},$f=function(){return new Ob(Li,bi)},fe=212);break;case 753331043:Bc=hb[Pf.a.ld];if(!Bc)break;var Rh=Number.parseInvariant(Bc);if(this.va.tK()){Tc.ULS.sendTraceTag(51181321,0,50,"TableCommandHandler.FormatAsTable invoked on existing table with style index: {0}",Rh);var kj=this.p3e();kj&&(Id=function(Vg,ph,uj){return eg.g(gc,kj,!1,!1,!1,Rh,Vg,ph,uj,null,hg)},$f=function(){return new cc(kj,!1,Rh,!1)},fe=215)}else Tc.ULS.sendTraceTag(51181322,
0,50,"TableCommandHandler.FormatAsTable invoked on newly created table with style index: {0}",Rh),ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TablesReactDialog",!1)?new pd(this.$,Number.parseInvariant(Bc)):(Bc=new $b(this.$,Number.parseInvariant(Bc)),Bc.initialize(),Bc.mf());break;case 71074531:var Uh=hb.HasHeader,bj=hb.TableRange;Id=function(Vg,ph,uj){return eg.e(gc,bj,Uh,!1,!1,Vg,ph,uj,null)};$f=function(){return new zg.a(Uh,bj)};fe=206;break;case -723113214:new mb(this.$);break;
case 868579142:Tc.ULS.sendTraceTag(526463700,0,50,"AltText on table changed.");fe=1022;var sg=hb.Title,Mf=hb.Description,Yh=this.idd();Id=function(Vg,ph,uj){return eg.f(gc,sg,Mf,Yh,Vg,ph,uj,null)};if(this.tableManager.Mg){de=If.a.oi(this.tableManager.Mg.aMb)?"":this.tableManager.Mg.aMb;var Bi=If.a.oi(this.tableManager.Mg.bMb)?"":this.tableManager.Mg.bMb}$f=sg==de?function(){return new Jb(Yh,void 0,Mf)}:Mf==Bi?function(){return new Jb(Yh,sg,void 0)}:function(){return new Jb(Yh,sg,Mf)};break;default:return Bg.a(sf)}if(Id){var Ih=
function(Vg){return new ch.a(fe,0,Vg,void 0,$f)};R=!this.namedSheetViewPublic||-2058042992!==sf&&504133448!==sf&&-798968736!==sf&&477776686!==sf?wh.a(this.$.userOperationManager,Id,Ih,Aa):this.namedSheetViewPublic.LAa().continueWith(function(Vg){Vg.result&&wh.a(Ib.$.userOperationManager,Id,Ih,Aa)})}return R};Za.prototype.toggleTableStyleOption=function(R,Aa){var hb=this,Ib=this.va.OLa();Tc.ULS.sendTraceTag(41996800,0,50,"TableCommandHandler: The selected {0} style option {1} was toggled.",Ib?"PivotTable":
"table",this.mRa);var Bc=this.idd();return{Pgg:function(gc,Id,fe){return eg.k(R,Bc,hb.mRa,Ah.b(gc,hb.EUi),Id,fe,null,Aa)},operationName:196,Zl:function(){return new pb(Bc,hb.mRa,Ib)}}};Za.prototype.$hj=function(R,Aa,hb){function Ib(sf){sf.Errors&&gc.tableManager.P8f(Id)}function Bc(){gc.tableManager.P8f(Id)}var gc=this,Id=R.OriginalTableRange,fe=Bf.m(R.ResizeTableRange,this.$.xa.pa);return function(sf,hg,$f){return eg.j(Aa,fe,Ah.b(sf,Ib),Ah.a(hg,Bc),$f,null,hb)}};Za.prototype.q_h=function(R){var Aa=
-1;R[Pf.a.ld]&&(Aa=R[Pf.a.ld],Aa=If.a.contains(Aa,dd.a.FFb,!0)?this.tableStyleManager.lvb(Aa):Number.parseInvariant(R[Pf.a.ld]));return Aa};Za.prototype.Jc=function(R,Aa){R=!1;switch(Aa.command){case -2058042992:case 504133448:case -798968736:case 477776686:case 341449783:case 2128797448:case -712419744:case 1868184698:case 1872288872:case 323142015:case 1544516694:case -544558380:case -1400250766:case -123538519:case 753331043:case 844144422:case 71074531:R=!0;break;case 756677940:R=ac.EwaSettings.la(420);
break;case -723113214:case 868579142:R=ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)}return R};Za.prototype.fd=function(R,Aa,hb){R=!1;switch(Aa){case "PopulateTableMoreStylesMenu":this.menuId=hb.MenuId;this.tableStyleManager.Yhc()||this.tableStyleManager.FKa("formatAsTableMenu");R=this.tableStyleManager.rIf(Aa,hb);break;case "PopulateTableAccessibleStylesMenu":this.menuId=hb.MenuId,this.tableStyleManager.Yhc()||this.tableStyleManager.FKa("accessibilityTab"),
R=this.tableStyleManager.rIf(Aa,hb)}return R};Za.prototype.dispose=function(){this.tableStyleManager.Ldj(this.xEf)};Za.prototype.fda=function(){(If.a.contains(this.menuId,"Format",!0)||If.a.contains(this.menuId,"Accessible",!0))&&this.menuId&&this.frame.Pw(this.menuId)};Za.prototype.idd=function(){return Bf.v(this.va.activeCell,this.$)};Za.prototype.QSh=function(){var R=this.tableManager.psd;return R?Bf.v(R,this.$):null};Za.prototype.ccf=function(R){if(this.tableManager){var Aa=ce.g(this.$),hb=this.va.activeCell,
Ib=this.tableManager.En(hb),Bc=null;if(!Ib||Ib.xSa)for(Aa=yl(Aa.k3),Ib=Aa.next();!Ib.done;Ib=Aa.next()){Ib=yl(Ib.value);for(var gc=Ib.next();!gc.done;gc=Ib.next()){gc=gc.value;var Id=gc.Fn;hb.left>=Id[0]&&hb.left<=Id[Id.length-1]&&(Bc=(gc=gc.Vs(hb).dK())?Ud.DOMElementExtensions.Bj(gc,Kc.a.Gpe):null)}}else{var fe=Aa.uc(bf.Range.kd(Ib.top,hb.left));if(this.qw){He.a.instance.create(function(){fe.invoke(8,R)},0,vg.a.J8f,!0,!0);return}Bc=fe.oKa(56).G5a}Bc&&He.a.instance.create(function(){Ud.DOMElementExtensions.Zec(Bc,
null)},0,vg.a.J8f,!0,!0)}};Za.prototype.r_h=function(R){R=Number.parseInvariant(R);return-1<R&&8>=R?R:-1};Za.prototype.fMa=function(){return!this.tableManager.Mg};Za.prototype.Lgf=function(){return this.tableManager.cFd?!1:(Tc.ULS.sendTraceTag(537151173,0,15,"TableCommandHandler.IsPreviousSelectedTableObjectNull PreviousSelectedTableObject is null"),!0)};Za.prototype.ifi=function(){var R=this.va.tK(),Aa=this.va.qh&&!ce.g(this.$).Rb.u5(this.va.Sd);return R||Aa};Za.prototype.hfi=function(){return this.va.tK()||
!this.Lgf()};Za.prototype.t_h=function(R){var Aa=[];R=yl(R);for(var hb=R.next();!hb.done;hb=R.next())if(hb=$e.b(this.$,hb.value),null===hb||void 0===hb?0:hb.length){hb=yl(hb);for(var Ib=hb.next();!Ib.done;Ib=hb.next())Ib=Ib.value,Ib.usedRange&&!Array.contains(Aa,Ib.usedRange)&&Array.add(Aa,Ib.usedRange)}return Aa};Za.prototype.p3e=function(){var R=this.va.selectedRanges,Aa=[];if(ac.EwaSettings.isChangeGateEnabled("OfficeVSO:3987000_ApplyTableStylesOnMultipleTablesInSingleRange"))Aa=this.t_h(R);else{R=
yl(R);for(var hb=R.next();!hb.done;hb=R.next())hb=hb.value,ce.g(this.$).Rb.u5(hb)&&Array.add(Aa,hb)}return Aa&&Aa.length?Bf.r(Aa,this.$):null};Za.prototype.JL=function(R){(ac.EwaSettings.isChangeGateEnabled("OfficeVSO:6063473_PTPSDisableLive")?Cg.a.Rka(this.$):ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1))&&ig.TaskExtensions.Ba(bg.GetServiceTaskFactory.Wa(this.$.da,430,431,1),function(Aa){Aa.result.yea(R);Tc.ULS.sendTraceTag(537151172,306,50,"TableCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},
this.$.ma,3)};Za.prototype.fsi=function(R){var Aa=this;ig.TaskExtensions.Ba(bg.GetServiceTaskFactory.Wa(this.$.da,446,447,0),function(hb){hb.result.m$g(Aa.$,R)},this.$.ma,3)};Za.TYf=function(R,Aa){Aa.SheetName=R.pa.name;Aa.NamedObjectView=R.ea.isNamedObjectViewMode};Object(vc.a)(Za,"TableCommandHandler",null,[188]);var Ag=Fh.a;vm(ec,Ag);ec.prototype.dispose=function(){Ag.prototype.dispose.call(this)};ec.prototype.Od=function(){var R=this,Aa=bg.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.ub),
hb=bg.GetServiceTaskFactory.create(this.$.da,330,this.ma,this.ub),Ib=bg.GetServiceTaskFactory.Wa(this.$.da,309,310,this.ub);ig.TaskExtensions.Ba(Da.Task.WAA(Aa,Ib,hb),function(){R.Fd([new Za(R.$,Aa.result,Ib.result,hb.result)],[2128797448,341449783,1544516694,-544558380,-123538519,753331043,756677940])},this.$.ma,3)};ec.ja=function(R){Fh.a.fe(86,new ec(R))};Object(vc.a)(ec,"TableCommandHandlerFactory",Fh.a,[]);tb.prototype.Yc=function(){return!1};tb.prototype.executeCommand=function(R,Aa){R=Aa.command;
Aa=null;switch(R){case 1243860697:this.sih.WLj();break;default:Aa=Bg.a(R)}return Aa||Da.Task.Ta(!0)};tb.prototype.Jc=function(R,Aa){return 1243860697===Aa.command};tb.prototype.fd=function(){return!1};Object(vc.a)(tb,"SheetDropdownMenuCommandHandler",null,[188]);var eh=Fh.a;vm(Ya,eh);Ya.prototype.Od=function(){var R=this;this.$.$E(function(Aa){Aa.Hld().then(function(){ig.TaskExtensions.Ba(bg.GetServiceTaskFactory.Wa(R.$.da,32,33,R.ub),function(hb){R.Fd([new tb(hb.result.Mwj)])},R.$.ma)})})};Ya.ja=
function(R){Fh.a.fe(392,new Ya(R))};Object(vc.a)(Ya,"SheetDropdownMenuCommandHandlerFactory",Fh.a,[]);var jh=b(73),Pg=b(206),te=b(38),Fg=b(117),og=b(32);Eb.prototype.DKg=function(R,Aa){this.IIe.add(R,Aa);this.JS()};Eb.prototype.JS=function(){var R=this;this.yHc=0;og.a.forEach(this.IIe.Yu,function(Aa){R.yHc=R.S6c|Aa.value})};Sk.Object.defineProperties(Eb.prototype,{S6c:{configurable:!0,enumerable:!0,get:function(){return this.yHc}},navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.S6c&
1)}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!(this.S6c&2)}}});Object(vc.a)(Eb,"SheetTabBarDisabledStateManager",null,[]);ub.Xth="ewa-stb-uir";ub.ZOe="ewa-stb-drag";ub.Hth="ewa-stb-navarea";ub.Ith="ewa-stb-navarea-dimensions";ub.Kth="ewa-stb-navbutton";ub.$Y="cui-disabled";ub.ria="cui-img-container";ub.Jth="ewa-stb-navareaextra";ub.Eth="ewa-stb-contentarea";ub.$Oe="ewa-stb-left-scrollable";ub.lPe="ewa-stb-right-scrollable";ub.Vth="ewa-stb-tabarea";ub.Uth="ewa-stb-sheettabmoveindicator";
ub.nPe="ewa-stb-tabs";ub.OIj="tab-active";ub.VIj="tab-inactive";ub.UIj="tab-hover";ub.Wth="ewa-stb-tabs-ghost";ub.QIj="tab-anchor-text";ub.dark="dark";ub.light="light";ub.PIj="tab-active-text";ub.SIj="tab-content-container";ub.XIj="tab-text";ub.Nth="ewa-stb-nsv-inactive";ub.Oth="ewa-stb-nsv-inactive-svg";ub.Lth="ewa-stb-nsv-active";ub.Mth="ewa-stb-nsv-active-svg";ub.rsh="ewa_nsv_margin";ub.Fth="ewa-stb-disable-scrollbar";ub.rsi="leave-size-fixed-on-tab-hover-old";ub.qsi="leave-size-fixed-on-tab-hover";
ub.dPe="ewa-stb-locked-sheet";ub.ePe="ewa-stb-locked-sheet-svg";ub.fPe="ewa-stb-locked-sheet-svg-16px";ub.Gth="ewa-stb-dropdown-menu-button";ub.Umh="ewa-active-sheet-menu-item";Object(vc.a)(ub,"CssClassNames",null,[]);var mh=b(522),cg=b(16),li=b(255),fh=b(96),pf=b(521),Qf=b(279),$g=b(378),yg=b(94),lh=b(341),h=b(240),Bb=b(372),qc=b(367),W=b(275),va=b(91),N=Uf.a;vm(ib,N);ib.prototype.dispose=function(){this.S$a=this.wsa=this.$=null;N.prototype.dispose.call(this)};ib.prototype.uX=function(R){this.RX=
R;this.domElement.setAttribute(dd.a.mha,R.toString());Ud.DOMElementExtensions.toggleCssClass(this.domElement,mh.a.$Y,R)};Sk.Object.defineProperties(ib.prototype,{disabled:{configurable:!0,enumerable:!0,get:function(){return this.RX}}});Object(vc.a)(ib,"SheetBarButton",Uf.a,[]);var k=b(835);vm(vb,ib);vb.prototype.dispose=function(){W.a.instance.za(Ye.a.click,this.domElement,this.Zc);Fg.KeyInputManager.instance.vv(this.domElement,this.aNa);ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4227145_InEditingDisableInsertSheetButton")&&
ce.g(this.$)&&ce.g(this.$).pc&&(ce.g(this.$).pc.ol(this.fj),ce.g(this.$).pc.Pn(this.Kg));ib.prototype.dispose.call(this)};vb.prototype.uX=function(R){var Aa=vb.A2f(this.$);ib.prototype.uX.call(this,R||Aa)};vb.A2f=function(R){return!R.isEditMode||!R.xa.count};Object(vc.a)(vb,"InsertSheetButton",ib,[]);vm(Dc,ib);Dc.prototype.dispose=function(){W.a.instance.za(Ye.a.click,this.domElement,this.Zc);Fg.KeyInputManager.instance.vv(this.domElement,this.aNa);this.Hve=null;ib.prototype.dispose.call(this)};Object(vc.a)(Dc,
"InsertTemplateButton",ib,[]);Mb.prototype.getSheetName=function(){return this.sheetName};Object(vc.a)(Mb,"MacroRecorderSheetReorderedPayload",null,[147]);var E=Uf.a;vm(cb,E);cb.prototype.dispose=function(){this.un();E.prototype.dispose.call(this)};cb.prototype.WLj=function(){this.dSf(!0,"TogglerSheetDropdownMenu")};cb.prototype.dSf=function(R,Aa){Tc.ULS.sendTraceTag(537153795,0,50,"SheetDropdownMenu.RenderSheetMenuInternal: render start. caller: {0}, toggle: {1}, toggleStateId: {2}",Aa,R,this.IMb);
R&&(this.IMb+=1);var hb=this.$.Vb.Hc("UserAction",String.format("SheetDropdownMenu.RenderSheetMenuInternal: caller: {0}, toggle: {1}, toggleStateId: {2}, sheetCount: {3}",Aa,R,this.IMb,this.$.xa.count));R=this.b$g();appChrome.renderSheetDropdownMenu(this.domElement,this.uJj,R,this.IMb,this.AKi,this.zKi,function(){hb.stop()},Bb.a(this.$))};cb.prototype.b$g=function(){for(var R=this.$.xa,Aa=[],hb=0;hb<R.count;hb++){var Ib=Object(xf.a)(yg.a,R.getItem(hb));0===Ib.uy&&(Ib=this.a$g(Ib),Aa.push(Ib))}return Aa};
cb.prototype.a$g=function(R){var Aa={};Aa.key=R.name;Aa.text=R.name;Aa.onClick=this.c$g(R);R.active&&(Aa.className=Bb.a(this.$)?"ewa-active-sheet-menu-item-present-mode":ub.Umh);return Aa};cb.prototype.c$g=function(R){var Aa=this;return function(){var hb=new gh.a(-1876836819,0,Aa.$.gd,30,null),Ib={};Aa.$.Ka.Xb(hb,(Ib[dd.a.mQd]=R.name,Ib))}};cb.prototype.cl=function(){if(!this.dV){var R=this.$.xa;R.Qf(this.$R);R.LYb(this.$R);R.vY(this.$R);R.$ga(this.$R);R.EFa(this.$R);R.$ne(this.$R);R.JYa(this.$R);
this.dV=!0}};cb.prototype.un=function(){if(this.dV){var R=this.$.xa;R.ug(this.$R);R.vsc(this.$R);R.a7(this.$R);R.Tma(this.$R);R.vQa(this.$R);R.$Qf(this.$R);R.mHb(this.$R);this.dV=!1}};Object(vc.a)(cb,"SheetDropdownMenu",Uf.a,[342,3]);var M=b(351);vm(Ga,ib);Ga.prototype.dispose=function(){this.mQj();ib.prototype.dispose.call(this)};Ga.prototype.uX=function(R){ib.prototype.uX.call(this,R||!this.$.ea.Dwa)};Ga.prototype.D$f=function(R){this.disabled||(Tc.ULS.sendTraceTag(537153793,0,50,"SheetDropdownMenuAnchor.ToggleMenu: inputMethod: {0}",
M.a[R]),this.$.Ka.Xb(new gh.a(1243860697,R,this.$.gd,30,null)))};Ga.prototype.h9i=function(){W.a.instance.qa(Ye.a.click,this.domElement,this.Zc);Fg.KeyInputManager.instance.qa(Ye.a.Sb,this.domElement,this.onKeyDown)};Ga.prototype.mQj=function(){W.a.instance.za(Ye.a.click,this.domElement,this.Zc);Fg.KeyInputManager.instance.za(Ye.a.Sb,this.domElement,this.onKeyDown)};Object(vc.a)(Ga,"SheetDropdownMenuAnchor",ib,[]);var aa=b(188),na=b(121),qb=b(57),Pb=b(215),Jc=b(160);za.prototype.UH=function(){return this.sheet.active};
za.prototype.Pod=function(){return this.sheet.isLockPausedInSession};za.prototype.Ksa=function(){return this.jm?cg.a.cPe:this.UH()?cg.a.bPe:cg.a.aPe};za.prototype.foa=function(){return this.sheet.Oj?k.a.OKf:ac.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?k.a.ZPj:k.a.YPj};za.prototype.BUd=function(){return ac.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};za.prototype.DUd=function(){return ac.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
16:12};za.prototype.Qha=function(){return null};za.prototype.Lsa=function(){return this.jm?this.sw?ac.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?ub.fPe:ub.ePe:ub.dPe:null};za.prototype.eWd=function(){return null};za.prototype.Mz=function(){return null};za.prototype.bld=function(){return 0};za.prototype.zWc=function(){return!0};Object(vc.a)(za,"LockPausedSheetIconDataSource",null,[358]);ya.prototype.UH=function(){return this.sheet.active};ya.prototype.Pod=function(){return this.sheet.Oj};
ya.prototype.Ksa=function(){return this.jm?cg.a.cPe:this.UH()?cg.a.bPe:cg.a.aPe};ya.prototype.foa=function(){return k.a.OKf};ya.prototype.BUd=function(){return ac.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:13};ya.prototype.DUd=function(){return ac.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?16:12};ya.prototype.Qha=function(){return null};ya.prototype.Lsa=function(){return this.jm?this.sw?ac.EwaSettings.isChangeGateEnabled("OfficeVSO:6104844_NewLockAndPauseSheetTabIcon")?
ub.fPe:ub.ePe:ub.dPe:null};ya.prototype.eWd=function(){return null};ya.prototype.Mz=function(){return null};ya.prototype.bld=function(){return 0};ya.prototype.zWc=function(){return!0};Object(vc.a)(ya,"LockedSheetIconDataSource",null,[358]);eb.prototype.UH=function(){return this.sheet.active};eb.prototype.Pod=function(){return this.sheet.Be.NC};eb.prototype.Qha=function(){return this.sw?this.UH()?ub.Mth:ub.Oth:this.UH()?ub.Lth:ub.Nth};eb.prototype.Ksa=function(){return!this.UH()&&this.v3f()?cg.a.Nvh:
cg.a.Mvh};eb.prototype.foa=function(){return!this.UH()&&this.v3f()?k.a.Vwj:k.a.Uwj};eb.prototype.BUd=function(){return 14};eb.prototype.DUd=function(){return 16};eb.prototype.Lsa=function(){return ub.rsh};eb.prototype.eWd=function(){return this.sheet.Be.Lmb};eb.prototype.Mz=function(){return this.lMj};eb.prototype.bld=function(){return 8};eb.prototype.zWc=function(){return!1};Object(vc.a)(eb,"NamedSeetViewSheetIconDataSource",null,[358]);Cb.prototype.Odg=function(){if(this.DI&&(this.Yj||this.$Aa)){if(this.sw){var R=
this.dataSource.foa();this.foa!==R&&(this.$Aa&&this.$Aa.parentNode.removeChild(this.$Aa),this.sbf(),this.foa=R)}else R=this.dataSource.Ksa(),this.Ksa!==R&&(this.iKd(this.Yj,this.Ksa,R),this.Ksa=R);R=this.dataSource.Qha();this.Qha!==R&&(this.sw?this.hfj(this.$Aa,this.Qha,R):this.iKd(this.Yj,this.Qha,R),this.Qha=R);R=this.dataSource.Lsa();this.Lsa!==R&&(this.iKd(this.DI,this.Lsa,R),this.Lsa=R);this.dataSource.Mz()&&!this.dataSource.UH()&&this.clearToolTip()}};Cb.prototype.vBj=function(R,Aa,hb){this.lci(R,
Aa,hb);Ud.DOMElementExtensions.setVisible(this.DI,this.dataSource.Pod())};Cb.prototype.clearToolTip=function(){var R=this;ig.TaskExtensions.Ba(this.fBb,function(){dialogControls.clearToolTip(R.dataSource.Mz())},this.$.ma,3)};Cb.prototype.lci=function(R,Aa,hb){this.DI&&this.Kgf!==R&&(this.DI.parentNode.removeChild(this.DI),this.Lsa=this.Qha=this.foa=this.Ksa=this.lRc=null,this.dataSource.Mz()&&(this.wc.detach("mouseover",!0),this.wc.detach("mouseout",!0)));this.DI||(this.lRc=document.createElement("span"),
Sys.UI.DomElement.addCssClass(this.DI,mh.a.ria),Sys.UI.DomElement.addCssClass(this.DI,cg.a.gr),ac.EwaSettings.la(524)?R===this.dataSource.zWc()?Aa.appendChild(this.DI):Aa.insertBefore(this.DI,hb):R?Aa.insertBefore(this.DI,hb):Aa.appendChild(this.DI),this.sw?this.sbf():(this.Yj=document.createElement("img"),this.Yj.tabIndex=-1,this.Yj.alt=this.dataSource.altText,this.DI.appendChild(this.Yj),this.Yj.src=kb.a.Ee(this.dataSource.bld())),this.dataSource.Mz()&&(this.wc.ja("mouseover",this.EF,!0),this.wc.ja("mouseout",
this.jI,!0)),this.Kgf=R)};Cb.prototype.hfj=function(R,Aa,hb){R&&(Sys.UI.DomElement.removeCssClass(R,Aa),Sys.UI.DomElement.addCssClass(R,hb))};Cb.prototype.iKd=function(R,Aa,hb){Aa&&Sys.UI.DomElement.removeCssClass(R,Aa);hb&&Sys.UI.DomElement.addCssClass(R,hb)};Cb.prototype.dispose=function(){pg.a.Fa(this.I1)};Cb.prototype.sbf=function(){var R=this.$.da.Aa(388);R?(this.$Aa=R.Eva(this.dataSource.foa(),this.dataSource.BUd(),this.dataSource.DUd()))?this.DI.appendChild(this.$Aa):Tc.ULS.shipAssertTag(537153763,
0,!1,"Sheeticon.InsertCurrentSvgIcon: Svg with id {0} was not found.",this.dataSource.foa()):Tc.ULS.shipAssertTag(537153792,0,!1,"Sheeticon.InsertCurrentSvgIcon: Unable to recieve SvgIconProvider service.")};Sk.Object.defineProperties(Cb.prototype,{wc:{configurable:!0,enumerable:!0,get:function(){return this.I1||(this.I1=Ff.a.instance.Dd(this.DI))}},fBb:{configurable:!0,enumerable:!0,get:function(){var R=this;if(this.xqa)return this.xqa;var Aa=new Wb.a;this.$.$E(function(hb){ig.TaskExtensions.Ba(hb.Gtd(),
function(){Aa.setResult(!0)},R.$.ma,3)});return this.xqa=Aa.task}},DI:{configurable:!0,enumerable:!0,get:function(){return this.lRc}}});Object(vc.a)(Cb,"SheetIcon",null,[3]);var ad=b(349),ia=b(147),Qa=ve.a;vm(ob,Qa);ob.prototype.dispose=function(){this.Lna&&(W.a.instance.za(Ye.a.hk,this.Lna.domElement,this.rca),ad.a.instance.za(this.Lna.domElement,this.$k),this.hhe=null);this.$=null;Qa.prototype.dispose.call(this)};ob.prototype.showContextMenu=function(R,Aa,hb){this.Lna.activate(Aa,Cg.a.frd());Aa=
new gh.a(-1075099431,Aa,this.$.gd,30,null);var Ib,Bc={};return!ia.a(Ib=this.$.Ka.Xb(Aa,(Bc[dd.a.V1f]=R,Bc[ob.Nwj]=this.Lna.sheet,Bc[dd.a.W1f]=hb,Bc)))&&(6!==Ib.status||Ib.result)};ob.prototype.rename=function(R,Aa){this.$.xe(817296323,Aa,R?19:0,null)};Sk.Object.defineProperties(ob.prototype,{Lna:{configurable:!0,enumerable:!0,get:function(){return this.hhe}}});ob.Nwj="Sheet";Object(vc.a)(ob,"SheetOpsSheetClickHelper",ve.a,[]);vm(Ta,ib);Ta.prototype.HQh=function(){return Ud.DOMElementExtensions.canReceiveFocus(this.anchor)?
this.anchor:null};Ta.prototype.dispose=function(){if(this.dV){Hd.a.instance.za(Ye.a.pointerDown,this.domElement,this.onPointerDown);Fg.KeyInputManager.instance.za(Ye.a.Sb,this.domElement,this.onKeyDown);Fg.KeyInputManager.instance.za(Ye.a.gp,this.domElement,this.yz);W.a.instance.za(Ye.a.click,this.domElement,this.Zc);Hd.a.instance.za(Ye.a.AW,this.domElement,this.Bya);Hd.a.instance.za(Ye.a.hy,this.domElement,this.Cya);if(this.Q6a||ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",
!1))Hd.a.instance.za(Ye.a.Yd,this.domElement,this.Og),this.cxa&&(Fd.a.instance.za(Ye.a.ye,this.domElement,this.Og),Fd.a.instance.za(Ye.a.xg,this.domElement,this.ZN));this.dV=!1;this.d5b="#BEBBB8"}pg.a.rc([this.Eze,this.Oue]);this.XO=this.pE=this.IEc=this.uS=this.Oue=this.Eze=null;if(this.Ina){for(var R=yl(this.Ina),Aa=R.next();!Aa.done;Aa=R.next())Aa.value.dispose();this.Ina=null}this.color=this.TVb=null;ib.prototype.dispose.call(this)};Ta.prototype.uX=function(R){R&&this.Ena(!1,!1);ib.prototype.uX.call(this,
R)};Ta.prototype.XRd=function(R){if(qb.a.Rf.sR){this.RIe();var Aa=bg.GetServiceTaskFactory.Wa(this.$.da,322,323,1);ig.TaskExtensions.Ba(Aa,function(hb){aa.UISurfaces.sV().then(function(Ib){var Bc=hb.result;Bc.Msj(Ib);Bc.show(R);return null},function(Ib){Tc.ULS.sendTraceTag(537153688,0,15,"SheetTabButton.ShowNamedSheetViewTeachingUI: Failed to GetNotificationsAPIAsync: {0}",Ib);return null})},this.ma,3)}};Ta.prototype.Ime=function(){var R=this;if(this.sheet.active&&this.$.dr){var Aa=this.$.dr,hb=ce.g(this.$),
Ib=hb.Sx;if(this.sheet.Be.NC){if(!this.mCb){var Bc=new eb(this.sheet,this.uS.Ewc,function(){return R.color?Ta.rRd(R.color):!1},this.sw);this.mCb=new Cb(this.$,Bc);this.Ina.add(this.mCb)}Ib?hb.Yeb(1):Aa.classList.add(cg.a.x$c);Aa=Ta.Qfd(dd.a.$rf);hb=Ta.Qfd(dd.a.nxd);Ib=Ta.Qfd(dd.a.Rrf);Bc=this.sheet.Be.cRd;this.sheet.Be.cRd=!1;"true"===Ib&&Bc&&this.$.ea.fRd?(na.a.pv(dd.a.Rrf,"false",na.a.iW),this.$.ea.fRd=!1,this.XRd(3)):"true"===Aa&&"true"===hb&&"true"===Ib?this.$.ea.gRd&&this.$.ea.HKb&&(this.sheet.Be.XV?
(Aa=1,na.a.pv(dd.a.nxd,"false",na.a.iW),this.$.ea.HKb=!1):Aa=0,na.a.pv(dd.a.$rf,"false",na.a.iW),this.$.ea.gRd=!1,this.XRd(Aa)):this.sheet.Be.XV&&"true"===hb&&"true"===Ib&&this.$.ea.HKb&&(na.a.pv(dd.a.nxd,"false",na.a.iW),this.$.ea.HKb=!1,this.XRd(2))}else this.RIe(),Ib?hb.Yeb(0):Aa.classList.remove(cg.a.x$c)}};Ta.prototype.RIe=function(){if(ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")){var R=this.$.da.Aa(322);R&&R.dismiss()}else this.$.Oqd&&(R=bg.GetServiceTaskFactory.Wa(this.$.da,
322,323,0),ig.TaskExtensions.Ba(R,function(Aa){Aa.result.dismiss()},this.$.ma,3))};Ta.prototype.ffb=function(){this.name=this.sheet.name;this.domElement.className=this.sheet.active||this.D6a()?ub.OIj:ub.VIj;ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5262355_SheetTabFocusBugFix")?this.XO.parentNode.classList.add(ub.qsi):this.XO.parentNode.classList.add(ub.rsi);this.Heg();this.Lnd&&this.Ime();this.wBj();this.Neg();this.cBc();this.Lnd||this.Ime()};Ta.prototype.gTi=function(){this.kQd=!0;this.Ena(!0,
!0,"OnSheetReorderStarted")};Ta.prototype.fTi=function(){this.kQd=!1;this.Ena(!1,void 0,"OnSheetReorderEnded")};Ta.prototype.activate=function(R,Aa){R=void 0===R?0:R;Aa=void 0===Aa?!1:Aa;this.N1b()||(this.sheet.activate(),Aa&&ce.g(this.$).focus(),Aa={},R=(Aa.InputMethod=M.a[R],Aa.AppMode=this.$.gd,Aa.Location="canvas",Aa),fi.b(this.$).ee(Od.a.Jwj,R))};Ta.prototype.Geg=function(R){this.d5b=R?"#797775":"#BEBBB8";this.X4c=R?-.5:.5;this.lHc=R?Pb.a.Tp("#3B3A39"):Pb.a.Tp("#F5F5F5");this.Neg()};Ta.prototype.Npj=
function(R){this.Q6a=R};Ta.prototype.Szd=function(R){R.p2c();this.Yxe(R)};Ta.prototype.Yxe=function(R){R.j0a();this.sheet.activate()};Ta.prototype.Qzg=function(R){R=new gh.a(-1876836819,R,this.$.gd,30,null);var Aa={};return this.$.Ka.Xb(R,(Aa[dd.a.mQd]=this.sheet.name,Aa))};Ta.prototype.Heg=function(){this.XO.parentNode.setAttribute("sheet-title",this.XO.innerText)};Ta.prototype.cBc=function(){var R=this.qKh();this.anchor.setAttribute(dd.a.Et,R);this.anchor.setAttribute(dd.a.nha,this.sheet.active.toString())};
Ta.prototype.qKh=function(){var R=this.sheet.Be.NC,Aa=this.sheet.Be.Lmb,hb=this.sheet.Oj,Ib=this.sheet.isLockPausedInSession;return R&&hb?String.format(Pd.a.instance.Cb(20),this.name,Aa):R&&Ib?String.format(Pd.a.instance.Cb(22),this.name,Aa):R?String.format(Pd.a.instance.Cb(19),this.name,Aa):hb?String.format(Pd.a.instance.Cb(18),this.name):Ib?String.format(Pd.a.instance.Cb(21),this.name):this.name};Ta.prototype.activateSheet=function(R){R=void 0===R?0:R;if(Cg.a.frd()){if(ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4099273_PromptForCommentsOnSheetChange")&&
this.N1b())return Da.Task.Ta(!1);Jc.a.current.pS="ActivateSheet";this.sheet.activate();return Da.Task.Ta(!0)}return this.Qzg(R)};Ta.prototype.Neg=function(){var R=this.sheet.tabColor;this.color=R?Pb.a.Tp(R):this.Nch;this.Eff=Ta.rRd(this.color);this.Ena(!1,void 0,"UpdateTabColor")};Ta.prototype.Ena=function(R,Aa,hb){Aa=void 0===Aa?!1:Aa;hb=void 0===hb?null:hb;if(this.sheet){hb=this.sheet.active;var Ib=this.D6a(),Bc=!!this.sheet.tabColor,gc=Pb.a.jG(hb||Ib?Xg.a.white:this.color);this.pE.style.background=
"";hb||Ib?(Bc?ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5293663_SheetTabHighContrastBackgroundBug")&&this.$.jLa?this.Huj():this.jm?this.Guj():this.Fuj():this.jm||(this.pE.style.backgroundColor=gc),this.pE.style.height=this.A1c.toString()+"px"):(this.pE.style.filter="",this.pE.style.backgroundColor=gc,this.pE.style.height=this.B1c.toString()+"px");this.XO.className=hb?ub.PIj:Ib?ub.dark:this.Eff?ub.light:ub.dark;gc=yl(this.Ina);for(var Id=gc.next();!Id.done;Id=gc.next())Id.value.Odg();this.jm&&
(R&&!Bc&&(this.pE.style.backgroundColor="#E1DFDD"),Ud.DOMElementExtensions.toggleCssClass(this.domElement,ub.UIj,R),Aa?(Bc||(this.pE.style.backgroundColor=this.d5b),this.domElement.style.backgroundColor=this.d5b):(Bc||(this.pE.style.backgroundColor=""),this.domElement.style.backgroundColor=""));this.XO.style.fontWeight=hb||Ib||!this.jm&&R?this.jm?"600":"bold":""}else Tc.ULS.sendTraceTag(537153687,0,15,"SheetTabButton.SetTabColors: can't change colors to a sheet tab without sheet, whihc means its not rendered. caller: {0}",
hb)};Ta.prototype.Guj=function(){var R=this.pE.style,Aa=Pb.a.jG(Ta.K_c(this.color,this.X4c));R.background=Aa};Ta.prototype.Fuj=function(){var R=this.pE.style,Aa=Pb.a.jG(Ta.K_c(this.color,1)),hb=Pb.a.jG(Ta.K_c(this.color,this.X4c)),Ib="";if(af.a.dla)Ib="-webkit-";else if(af.a.Df)Ib="-moz-";else if(af.a.Af){if(Ib="-ms-",!af.a.r6a){R.filter=String.format("progid:DXImageTransform.Microsoft.gradient(startColorstr={0}, endColorstr={1})",Aa,hb);return}}else af.a.ogf&&(Ib="-o-");R.background=String.format("{0}linear-gradient({1}, {2})",
Ib,Aa,hb)};Ta.prototype.Huj=function(){this.pE.style.background="transparent"};Ta.prototype.q4g=function(){this.IEc=document.createElement("a");this.anchor.removeAttribute("Href");this.anchor.className=ub.QIj;Ud.DOMElementExtensions.us(this.anchor,dd.a.gob,null,null);this.tabIndex=-1};Ta.prototype.n$g=function(){this.pE=document.createElement("span");this.pE.className=ub.SIj;this.XO=document.createElement("span");this.XO.className=ub.XIj;this.XO.dir=this.sheet.rtlName?"rtl":"ltr";this.pE.appendChild(this.XO)};
Ta.prototype.wBj=function(){for(var R=this.$.vJ,Aa=yl(this.Ina),hb=Aa.next();!hb.done;hb=Aa.next())hb.value.vBj(R,this.pE,this.XO)};Ta.prototype.D6a=function(){return ce.g(this.$).D6a(this.sheet)};Ta.prototype.bGj=function(){this.Fkd.start();this.Ood=!0};Ta.prototype.KLe=function(R){if(this.Ood){this.Fkd.stop();var Aa={};R=(Aa["Sheet index"]=this.sheet.index,Aa["Active Sheet"]=this.sheet.active,Aa["Hovering time"]=this.Fkd.Dc,Aa["Has been clicked"]=R,Aa);Tc.ULS.sendTraceTag(537153686,0,50,Uc.c(R));
this.Ood=!1}};Ta.prototype.u$i=function(){Hd.a.instance.qa(Ye.a.pointerDown,this.domElement,this.onPointerDown);Fg.KeyInputManager.instance.qa(Ye.a.Sb,this.domElement,this.onKeyDown);Fg.KeyInputManager.instance.qa(Ye.a.gp,this.domElement,this.yz);this.wc.ja("mouseover",this.EF);this.wc.ja("mouseout",this.jI);Hd.a.instance.qa(Ye.a.AW,this.domElement,this.Bya);Hd.a.instance.qa(Ye.a.hy,this.domElement,this.Cya);if(this.Q6a||ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CoauthWorkbookProtectionSupport",
!1))Hd.a.instance.qa(Ye.a.Yd,this.domElement,this.Og),this.cxa&&(Fd.a.instance.qa(Ye.a.ye,this.domElement,this.Og),Fd.a.instance.qa(Ye.a.xg,this.domElement,this.ZN));W.a.instance.qa(Ye.a.click,this.domElement,this.Zc);this.dV=!0};Ta.prototype.N1b=function(){var R=this.$.da.Aa(65);return R&&R.sba()?(R.yIb(),this.Yxe(R),!0):!1};Ta.Qfd=function(R){var Aa=na.a.get(R);Aa||(na.a.pv(R,"true",na.a.iW),Aa=na.a.get(R));return Aa};Ta.K_c=function(R,Aa){if(1<Aa||-1>Aa)return R;var hb=R.r,Ib=R.g;R=R.b;0<Aa?(hb=
hb*(1-Aa)+255*Aa,Ib=Ib*(1-Aa)+255*Aa,R=R*(1-Aa)+255*Aa):(hb*=1+Aa,Ib*=1+Aa,R*=1+Aa);return Xg.a.dub(Math.round(hb),Math.round(Ib),Math.round(R))};Ta.rRd=function(R){return 128>=(222*R.r+707*R.g+71*R.b)/1E3};Sk.Object.defineProperties(Ta.prototype,{Nch:{configurable:!0,enumerable:!0,get:function(){return this.lHc||(this.lHc=Pb.a.Tp("#F5F5F5"))}},name:{configurable:!0,enumerable:!0,get:function(){return this.XO.innerText},set:function(R){this.XO&&(this.XO.innerText=R,this.cBc(),this.Heg())}},sheet:{configurable:!0,
enumerable:!0,get:function(){return this.TVb}},anchor:{configurable:!0,enumerable:!0,get:function(){return this.IEc}},tabIndex:{configurable:!0,enumerable:!0,get:function(){return this.anchor.tabIndex},set:function(R){this.anchor.tabIndex=R}}});Object(vc.a)(Ta,"SheetTabButton",ib,[]);vm(Ka,ib);Object(vc.a)(Ka,"WorkbookProtectionButton",ib,[]);var Nb=b(48),tc=b(46),gd=b(55),Rc=Uf.a;vm(ma,Rc);ma.prototype.Bb=function(R,Aa,hb,Ib,Bc,gc,Id){Id=void 0===Id?!1:Id;R.removeAttribute("Href");R.setAttribute(dd.a.Td,
dd.a.Qr);R.className=ub.Kth;R.title=Aa;R.tabIndex=0;this.sw&&gc?hb=this.svgIconProvider.mba(gc,12,12,R,24,24):(Aa=document.createElement("span"),Aa.className=this.jm?cg.a.hZg:cg.a.gr,Aa.classList.add(mh.a.ria),Aa.tabIndex=-1,R.appendChild(Aa),gc=document.createElement("img"),gc.src=kb.a.Ee(hb),gc.className=Ib,gc.alt=Bc,gc.tabIndex=-1,Aa.appendChild(gc),hb=gc);Id&&R.classList.add(mh.a.$Y);return hb};ma.prototype.dispose=function(){if(this.$){var R=this.$.xa;R.ug(this.ii);R.vsc(this.o6);R.a7(this.ZC);
R.Tma(this.gEb);R.vQa(this.Lya);R.$Qf(this.PDf);R.mHb(this.RDf);R.Kcj(this.QDf);R.rJd(this.vuf);R.XQf(this.wuf);R.YQf(this.xuf);R.ZQf(this.MOa);this.$.pl(this.rd);this.$.mD(this.ej);td.a(this.$)&&td.a(this.$).sg.Uma(this.GF);this.Kta&&ce.g(this.$).BQf(this.gDb);Pg.a.instance.za(Ye.a.VC,this.domElement,this.t6)}pg.a.rc(this.xxd);this.xxd=null;if(this.QK)for(R=0;R<this.QK.length;R++){var Aa=Ud.DOMElementExtensions.dK(this.QK[R],this.domElement,!1,"a");Aa&&te.a.Qma(Aa)}pg.a.Fa(this.$B);pg.a.Fa(this.Jwc);
pg.a.Fa(this.pQd);this.pQd=this.Jwc=this.Txb=this.EH=this.$B=null;this.$&&this.mz&&this.MQ(!1);this.Z$=null;this.xOd(null,"Dispose");this.WLb=this.LM=this.X6b=null;this.N0c();this.Scb=this.Kwc=this.qQd=this.Nk=this.QK=this.$=this.ea=null;Rc.prototype.dispose.call(this)};ma.prototype.Ne=function(R,Aa){if(!Aa){Tc.ULS.shipAssertTag(537153760,0,0<this.wh.length,"There is no sheet tab button.");if(!this.wh.length)return!1;R=null;for(var hb=yl(this.wh),Ib=hb.next();!Ib.done&&!(R=Ib.value.HQh());Ib=hb.next());
if(!R)return Tc.ULS.shipAssertTag(537153759,0,!1,"There is no focusable tab element."),!1;Ud.DOMElementExtensions.setFocus(R)}return!Aa};ma.prototype.Yf=function(R){return Ud.DOMElementExtensions.Oe(this.Jb,R)};ma.prototype.gi=function(){};ma.prototype.Qh=function(){};ma.prototype.reorderSheets=function(R,Aa,hb){if(this.D_&&this.D_!==R){var Ib=this.D_.index;this.Vej(this.D_,R,Aa);R=R?R.index-1:Aa?this.$.xa.count-1:0;Ib!==R&&(this.ywi(Ib,R,hb),this.slh(this.D_.name,R))}};ma.prototype.l1h=function(R){R=
this.dja(R);return-1!==R&&this.Mu<=R&&R<=this.yK?this.wh[R].domElement:null};ma.prototype.pUj=function(R){if(this.sw){for(var Aa=0;Aa<this.QK.length;Aa++){var hb=this.QK[Aa];if(hb&&this.svgIconProvider){var Ib=hb.parentNode;this.fQf(hb);Ib&&(this.QK[Aa]=this.svgIconProvider.mba(R?this.mJf[Aa]:this.yxd[Aa],12,12,Ib,24,24))}}for(Aa=0;Aa<this.wh.length;Aa++)this.wh[Aa].Geg(R);this.TRa&&this.TRa.wsa&&this.Feg(k.a.b3h,this.TRa,R);this.EH&&this.EH.wsa&&this.Feg(k.a.q0g,this.EH,R)}};ma.prototype.Feg=function(R,
Aa,hb){Aa.S$a||(Aa.S$a=this.svgIconProvider.mba(R,12,12,Aa.wsa.parentNode,24,24));Aa.S$a&&(Ud.DOMElementExtensions.setVisible(Aa.wsa,!hb),Ud.DOMElementExtensions.setVisible(Aa.S$a,hb))};ma.prototype.kTi=function(R,Aa){var hb=ce.g(this.$),Ib=hb.inRangePicker,Bc=Fe.HelperMethods.Am(Aa);if(hb.isEditing&&!Ib){var gc=hb.Dj?"formulaBar_end_edit_sheet_changed":"cell_text_end_edit_sheet_changed",Id=void 0;ac.EwaSettings.Owa()&&(Id=hb.pc.textBox.gBa);ac.EwaSettings.EMa?h.b(this.$).qTa(Bc.rawEvent,gc,Id):h.b(this.$).rTa(Bc.rawEvent,
gc,Id);hb.endEdit(!0,"SheetTabBar.OnSheetTabMouseDown")}hb=this.cxa&&3===Aa.yb;!(2===Aa.yb&&Bc.button===Sys.UI.MouseButton.leftButton||hb)||Ib||this.pF||td.a(this.$).Dq()||(hb&&R.gTi(),this.mAb=Aa.clientPoint.x,this.bZ=Aa,this.gOg(R))};ma.prototype.iTi=function(R){!this.mz&&this.pF&&this.iSd(R.sheet,!1)};ma.prototype.jTi=function(R){this.mz||(this.pF&&this.reorderSheets(R.sheet,!1,!0),this.MQ());this.i0()};ma.prototype.Wpe=function(){return this.$.isEditMode&&!fh.k(this.$.lg)};ma.prototype.i0=function(){var R=
this,Aa=Fe.HelperMethods.Zxa(function(){R.tSj();R.jm&&R.huj();R.XOd()});Tc.ULS.sendTraceTag(537153757,0,50,"SheetTabBarControl.RearrangeContentAreaAndNavAreaExtra: duration = {0}",Aa)};ma.prototype.huj=function(){var R=this.yK===this.wh.length-1;Ud.DOMElementExtensions.toggleCssClass(this.Scb,this.$.vJ?ub.lPe:ub.$Oe,!!this.Mu);Ud.DOMElementExtensions.toggleCssClass(this.Scb,this.$.vJ?ub.$Oe:ub.lPe,!R)};ma.prototype.XOd=function(R){R=void 0===R?!1:R;var Aa=!this.Mu,hb=this.yK===this.wh.length-1;this.M_f(4,
this.sheetTabActivatePreviousHidden,!Aa);this.M_f(5,this.sheetTabActivateNextHidden,!hb);this.ewc(0,Aa||R);this.ewc(1,Aa||R);this.ewc(2,hb||R);this.ewc(3,hb||R)};ma.prototype.M_f=function(R,Aa,hb){if(R=this.QK[R]){Ud.DOMElementExtensions.setVisible(R,hb);var Ib=this.l1e(R);Ib.title="img"===R.nodeName?R.alt=0<this.wh.length&&hb?Aa:"":R.title=0<this.wh.length&&hb?Aa:"";Ib.tabIndex=hb?0:-1}};ma.prototype.l1e=function(R){return this.sw?R.parentNode:R.parentNode.parentNode};ma.prototype.ewc=function(R,
Aa){if(R=this.QK[R])R=this.l1e(R),void 0!==R&&null!==R&&(!this.wh.length||Aa?(R.classList.add(mh.a.$Y),R.setAttribute(dd.a.mha,"true")):(R.classList.remove(mh.a.$Y),R.setAttribute(dd.a.mha,"false")))};ma.prototype.KRa=function(R){var Aa=this.$.vJ?this.wh.length-1:0,hb=this.C3e(this.$.vJ?0:this.wh.length-1);hb&&(hb.borderRightWidth=R?"1px":"0");this.Mu!==this.yK&&(hb=this.C3e(Aa))&&(hb.borderRightWidth="0")};ma.prototype.Ume=function(R,Aa){this.wh||(this.wh=[]);-1===Aa?Array.add(this.wh,R):Array.insert(this.wh,
Aa,R)};ma.prototype.u4b=function(R,Aa){var hb=-1,Ib=null;Aa||(hb=this.IUh(R.index),-1!==hb&&(Ib=this.DKa(hb)));R=new Ta(this.$,this.Nk,Ib,R,this,this.jm,this.sw);this.Ume(R,hb);Ud.DOMElementExtensions.setVisible(R.domElement,!0)};ma.prototype.iSd=function(R,Aa){var hb=this.G2a(R);if(hb){this.yld=R;this.Qwd=Aa;R=hb.domElement;hb=this.isRtl?R.offsetLeft+(this.Nk.scrollWidth-this.Nk.clientWidth-this.Nk.scrollLeft):R.offsetLeft-this.Nk.scrollLeft;if(!this.isRtl&&Aa||this.isRtl&&!Aa)hb+=R.offsetWidth;
this.Iwc.style.left=Fe.HelperMethods.Qb(hb-4);Ud.DOMElementExtensions.setVisible(this.Iwc,!0)}};ma.prototype.z9e=function(){Ud.DOMElementExtensions.setVisible(this.Iwc,!1)};ma.prototype.x0=function(R){var Aa=this,hb=Fe.HelperMethods.Zxa(function(){switch(R){case 0:Aa.Buc(0);break;case 1:Aa.Buc(Aa.Mu-1);break;case 2:Aa.Buc(Aa.Mu+1);break;case 3:Aa.scrollIntoView(Aa.wh.length-1);break;case 4:Aa.Mu&&1<=Aa.wh.length&&(Aa.Lke(Aa.Mu-1),Aa.VMd());break;case 5:Aa.yK!==Aa.wh.length-1&&1<=Aa.wh.length&&(Aa.Lke(Aa.yK+
1),Aa.VMd());break;case 6:Aa.VMd()}});this.h7b&&this.pF&&this.vNb();Tc.ULS.sendTraceTag(537153755,0,50,"SheetTabBarControl.ScrollSheetTabs: operation = {0}, duration = {1}",R,hb)};ma.prototype.Lke=function(R){(R=this.bR(R))&&R.activate()};ma.prototype.iDh=function(R){if(0===R.uy)for(var Aa=this.$.xa,hb=0,Ib=0,Bc=Aa.count;Ib<Bc;Ib++){var gc=Object(xf.a)(yg.a,Aa.getItem(Ib));if(gc===R)return hb;0===gc.uy&&hb++}return-1};ma.prototype.WCh=function(R){var Aa=this.$.xa;R=R.index+1;for(var hb=Aa.count;R<
hb;R++){var Ib=Object(xf.a)(yg.a,Aa.getItem(R));if(0===Ib.uy)return Ib}return null};ma.prototype.dja=function(R){for(var Aa=0;Aa<this.wh.length;Aa++){var hb=this.bR(Aa);if(!hb)Tc.ULS.sendTraceTag(537153754,0,15,"SheetTabBarControl.FindMatchingSheetTabIndex: sheetTabButton[{0}] is null even though index is not out of bounds!",Aa);else if(hb.sheet===R)return Aa}return-1};ma.prototype.G2a=function(R){R=this.dja(R);return this.bR(R)};ma.prototype.ywi=function(R,Aa,hb){var Ib={};Ib.a=this.$.ya.UserSessionId;
Ib.b=hb;Ib.c=this.O6b;Ib.d=R;Ib.e=Aa;Ib.f=this.$.xa.count;Nb.b().Pe(2,Ib,hb)};ma.prototype.Vej=function(R,Aa,hb){var Ib=Object(xf.a)(lh.a,this.$.xa);Aa?(Aa=Aa.index,Aa=R.index<Aa?Aa-1:Aa):Aa=hb?Ib.count-1:0;Ib.reorderSheet(R,Aa,!0)};ma.prototype.j_f=function(R){ce.g(this.$).Hh.hu(R)};ma.prototype.gOg=function(R){if(!this.ctc){var Aa=this.domElement.ownerDocument.body;this.mz?(Hd.a.instance.qa(Ye.a.fh,document.documentElement,this.VK),this.cxa&&(Fd.a.instance.qa(Ye.a.xg,document.documentElement,this.VK),
Fd.a.instance.qa(Ye.a.xg,this.domElement,this.ZN))):(Hd.a.instance.qa(Ye.a.fh,Aa,this.VK),Fd.a.instance.qa(Ye.a.xg,Aa,this.VK));Hd.a.instance.qa(Ye.a.Yd,document.documentElement,this.K_);Fd.a.instance.qa(Ye.a.ye,Aa,this.K_);this.ctc=!0}this.D_=R.sheet;this.O6b=!1;this.mz?(this.LM=null,this.X6b=R,this.Z$=R.domElement,this.xOd(Ud.DOMElementExtensions.getBoundingClientRect(this.Z$),"BeginSheetTabButtonDrag")):(Tc.ULS.sendTraceTag(537153752,0,50,"SheetTabBarControl.BeginSheetTabButtonDrag: Starting legacy sheet tab drag and drop."),
this.domElement.classList.add(ub.ZOe),this.domElement.style.cursor="",this.j_f("pointer"))};ma.prototype.MQ=function(R){R=void 0===R?!0:R;if(this.ctc){this.j_f(dd.a.Zaa);var Aa=this.domElement.ownerDocument.body;this.mz?(Hd.a.instance.za(Ye.a.fh,document.documentElement,this.VK),this.cxa&&(Fd.a.instance.za(Ye.a.xg,document.documentElement,this.VK),Fd.a.instance.za(Ye.a.xg,this.domElement,this.ZN))):(Hd.a.instance.za(Ye.a.fh,Aa,this.VK),Fd.a.instance.za(Ye.a.xg,Aa,this.VK));Hd.a.instance.za(Ye.a.Yd,
document.documentElement,this.K_);Fd.a.instance.za(Ye.a.ye,Aa,this.K_);this.mLc=this.ctc=!1}this.Lpc=0;this.O6b=!1;this.yld=this.D_=null;this.mz?(this.Z$&&(this.Z$.style.visibility="visible",this.Z$=null),this.X6b=null,this.xOd(null,"EndSheetTabButtonDrag"),this.LM&&(this.LM.parentNode&&this.LM.parentNode.removeChild(this.LM),this.LM=null),this.khj(R)):(this.domElement.classList.remove(ub.ZOe),this.z9e())};ma.prototype.khj=function(R){this.RTd(R);this.HC=this.mAb=-1};ma.prototype.slh=function(R,Aa){function hb(Id,
fe,sf){var hg=gc.Na(9,null);hg.sheetName=R;hg.newSheetIndex=Aa;return Kh.i(gc,"ReorderSheets",hg,Id,fe,sf,null,0)}function Ib(){return new Mb(R,Aa)}var Bc=this.$.na,gc=Bc?Bc.ta:null;ac.EwaSettings.sc()?this.$.userOperationManager.hc(new ch.a(557,0,hb,64,Ib),null):this.$.userOperationManager.hc(new pf.a(557,0,hb,void 0,Ib),null)};ma.prototype.bR=function(R){return 0<=R&&R<this.wh.length?this.wh[R]:null};ma.prototype.B3e=function(R){return(R=this.bR(R))?R.sheet:null};ma.prototype.DKa=function(R){return(R=
this.bR(R))?R.domElement:null};ma.prototype.C3e=function(R){return(R=this.DKa(R))?R.style:null};ma.prototype.IUh=function(R){var Aa=this.$.xa;R+=1;for(var hb=-1,Ib=this.wh?this.wh.length:0;R<Aa.count;){var Bc=Object(xf.a)(yg.a,Aa.getItem(R));if(0===Bc.uy){for(hb=0;hb<Ib&&this.B3e(hb)!==Bc;hb++);break}R++}return-1===hb||hb===Ib?-1:hb};ma.prototype.LDf=function(R){var Aa=this.G2a(R);Aa&&(this.mz&&this.pF&&(Tc.ULS.sendTraceTag(537153751,0,50,"SheetTabBarControl.OnSheetDeletedOrHidden: A sheet has been deleted while re-order operation is midway."),
ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.MQ()),this.Nk.removeChild(Aa.domElement),Aa=Array.indexOf(this.wh,Aa),Array.removeAt(this.wh,Aa),this.i0(),(!this.isRtl&&Aa===this.wh.length||this.isRtl&&!Aa)&&this.KRa(!0),this.h7b&&this.pF?R===this.D_?(this.MQ(),this.x0(6)):this.vNb():this.x0(6))};ma.prototype.NDf=function(R){var Aa=Object(xf.a)(yg.a,R);this.mz&&this.pF&&(Tc.ULS.sendTraceTag(537153750,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: A sheet has been added to the sheet tab bar while re-order operation is midway."),
ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.MQ());if(0===Aa.uy){this.KRa(!1);var hb=this.dja(R);-1===hb&&(Tc.ULS.sendTraceTag(537153749,0,50,"SheetTabBarControl.OnSheetInsertedOrUnhidden: could not find matching sheet tab index. Creating sheet tab..."),this.u4b(Aa,!1),hb=this.dja(R));this.A7e(hb,!0)}};ma.prototype.Wej=function(R,Aa){var hb=this.G2a(R);hb&&(this.mz&&this.pF&&!Aa&&(Tc.ULS.sendTraceTag(537153748,0,50,"SheetTabBarControl.ReorderSheetTab: A sheet has been re-ordered while re-order operation is midway."),
ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4121018_EndReorderOperationOnIncomingSheetModificationsV2")&&this.MQ()),R=this.KIj(R,hb),!ac.EwaSettings.isChangeGateEnabled("OfficeVSO:4176044_CancelCallsToSetTabColorAfterReorder")&&this.mz&&R&&Aa&&R.fTi())};ma.prototype.KIj=function(R,Aa){var hb=Array.indexOf(this.wh,Aa),Ib=this.iDh(Object(xf.a)(yg.a,R));if(-1===Ib||-1===hb)return null;hb!==Ib||this.mz?(this.KRa(!1),Ib=ma.Sej(hb,Ib,this.Mu,this.yK),this.Mu=Ib.IDh,this.yK=Ib.tri,Aa&&Aa.domElement.parentNode===
this.Nk&&(this.Nk.removeChild(Aa.domElement),Array.removeAt(this.wh,hb)),Aa=this.WCh(R),hb=this.dja(Aa),Aa=new Ta(this.$,this.Nk,this.DKa(hb),Object(xf.a)(yg.a,R),this,this.jm,this.sw),this.Ume(Aa,hb),hb=this.dja(R),this.A7e(hb,!1,!this.jm)):Aa=null;return Aa};ma.prototype.emh=function(){for(var R=this.wh?this.wh.length:0,Aa=this.Mu,hb=this.yK,Ib=0;Ib<R;Ib++){var Bc=this.bR(Ib),gc=Ib>=Aa;Bc&&(Bc.tabIndex=gc&&Ib<=hb?0:-1)}};ma.prototype.hRj=function(){for(var R=this.wh?this.wh.length:0,Aa=0;Aa<R;Aa++){var hb=
this.bR(Aa);hb&&hb.ffb()}};ma.prototype.A7e=function(R,Aa,hb){hb=void 0===hb?!0:hb;Aa&&R<=this.Mu&&this.Mu++;this.emh();this.KRa(!0);this.i0();this.h7b&&this.pF?this.vNb():hb&&this.x0(6)};ma.prototype.Mvc=function(R){var Aa=this.$.vJ;if(R||this.isRtl!==Aa)this.isRtl=Aa,this.domElement.classList.remove(this.isRtl?cg.a.gPe:cg.a.mPe),this.domElement.classList.add(this.isRtl?cg.a.mPe:cg.a.gPe),this.domElement.dir=this.isRtl?"rtl":"ltr",this.hRj();R||this.KRa(!0);for(R=0;R<this.QK.length;R++)0!==R&&3!==
R&&(!this.jm||4!==R&&5!==R)&&this.N_f(R)};ma.prototype.$7g=function(){var R=this.qQd=document.createElement("div");R.className=ub.Hth;this.jm&&R.classList.add(ub.Ith);this.domElement.appendChild(R);this.o4b(R,1,704,703);this.o4b(R,2,706,705);this.Uhf&&(this.TRa=new Ga(this.$,this,R));this.jm||this.o4b(R,4,710,709)};ma.prototype.a8g=function(){var R=this.Kwc=document.createElement("div");R.className=ub.Jth;this.domElement.appendChild(R);this.jm||this.o4b(R,5,712,711);this.p4c()};ma.prototype.b9g=function(){var R=
document.getElementById(dd.a.Kwj),Aa=document.getElementById(dd.a.Lwj);R&&!Aa&&Tc.ULS.sendTraceTag(537153746,0,50,"CreateProgressBarArea - progressBar div is not null, separator div is null. progressBarDiv parent ID: {0}. progressBar div has child: {1}. ProgressBarMessage div exists: {2}",R.parentNode.id,!!R.firstChild,!!document.getElementById(dd.a.iQd));if(Cg.a.Zhf(this.$)&&R&&Aa)this.domElement.appendChild(R),this.rQd=R.firstChild,this.sQd=document.getElementById(dd.a.iQd),Aa.style.visibility=
"visible";else{R=document.createElement("div");Aa=document.createElement("div");R.className=cg.a.Sth;Aa.className=cg.a.Qth;Aa.style.display="none";var hb=document.createElement("div");hb.className=cg.a.Tth;var Ib=document.createElement("div");Ib.className=cg.a.Rth;var Bc=document.createElement("div");Bc.className=cg.a.Pth;Aa.appendChild(hb);Aa.appendChild(Ib);Aa.appendChild(Bc);R.appendChild(Aa);this.domElement.appendChild(R);this.rQd=Aa;this.sQd=Ib}};ma.prototype.N_f=function(R){var Aa=this.QK[R];
if(Aa)if(this.sw){var hb=Aa.parentNode;this.fQf(Aa);Aa=Bb.a(this.$)?this.mJf[R]:this.yxd[R];this.QK[R]=this.svgIconProvider.mba(Aa,12,12,hb,24,24)}else Aa.className=this.wxd[R]};ma.prototype.fQf=function(R){(null===R||void 0===R?0:R.parentNode)&&R.parentNode.removeChild(R)};ma.prototype.C5g=function(){var R=this.Scb=document.createElement("div");R.className=ub.Eth;this.domElement.appendChild(R);this.d$g(R)};ma.prototype.d$g=function(R){var Aa=document.createElement("div");Aa.className=ub.Vth;Aa.classList.add(ub.Fth);
this.$.printingEnabled||Aa.classList.add(Kc.a.uRe);R.appendChild(Aa);this.Nk=document.createElement("ul");Ud.DOMElementExtensions.us(this.Nk,dd.a.fXc,null,null);this.Nk.className=Kc.a.nPe;Aa.appendChild(this.Nk);this.T7g();this.dhe=document.createElement("div");this.Ewc.id="SheetIconTooltipContainer";Aa.appendChild(this.Ewc)};ma.prototype.T7g=function(){var R=document.createElement("div"),Aa="<div class='"+cg.a.kZg+"'>{0}</div>",hb=kb.a.Rdd(cg.a.cvh,0,"55_16_N","");R.innerHTML=String.format(Aa,hb);
R.className=ub.Uth;Ud.DOMElementExtensions.setVisible(R,!1);this.Iwc=R;this.Nk.appendChild(R)};ma.prototype.I4c=function(){for(var R=this.$.xa,Aa=0,hb=R.count;Aa<hb;Aa++){var Ib=Object(xf.a)(yg.a,R.getItem(Aa));0===Ib.uy&&(this.u4b(Ib,!0),Ib.active&&Ib.activate())}};ma.prototype.N0c=function(){pg.a.rc(this.wh);this.wh=[];this.yK=this.Mu=0};ma.prototype.o4b=function(R,Aa,hb,Ib){function Bc(sf){"mouseup"===sf.type&&gc.mz&&gc.pF||Yd.g(sf);Id.classList.contains(mh.a.$Y)||(fe?gc.TPi(sf,Aa):gc.jm||gc.UAf(sf,
Aa))}var gc=this,Id=document.createElement("a");R.appendChild(Id);R=this.yxd[Aa];this.QK[Aa]=this.Bb(Id,Pd.a.instance.fa(Ib),0,this.wxd[Aa],Pd.a.instance.fa(hb),R);if(5===Aa||4===Aa)Ud.DOMElementExtensions.dK(this.QK[Aa],Id,!1,"span").style.marginTop="10px";this.N_f(Aa);hb=this.xxd[Aa]=this.Pd.Dd(Id);Hd.a.instance.qa(Ye.a.pointerDown,Id,function(sf){return sf.ctrlKey&&gc.RJi(Aa)?!0:gc.SAf(Aa)});Hd.a.instance.qa(Ye.a.Yd,Id,function(){return gc.TAf()});Fd.a.instance.qa(Ye.a.ye,Id,function(){return gc.TAf()});
Hd.a.instance.qa(Ye.a.pointerOut,Id,function(){return gc.E0c()});Fg.KeyInputManager.instance.qa(Ye.a.Sb,Id,function(sf){return 13!==sf.Ea.keyCode&&32!==sf.Ea.keyCode||gc.M2c?!1:(gc.M2c=!0,gc.SAf(Aa))});Fg.KeyInputManager.instance.qa(Ye.a.Wd,Id,function(sf){return 13===sf.Ea.keyCode||32===sf.Ea.keyCode?(gc.M2c=!1,gc.E0c()):!1});var fe=this.Wpe();hb.ja("mouseover",Bc);hb.ja("mouseout",Bc);hb.ja("focus",Bc);hb.ja("blur",Bc);fe&&hb.ja("mouseup",Bc)};ma.prototype.gef=function(R){var Aa=!1,hb=this.$.tf;
hb&&(Aa=ze.a.fB(Ud.DOMElementExtensions.getBoundingClientRect(hb),R.clientPoint));return Aa};ma.prototype.Vhf=function(R){return ze.a.fB(Ud.DOMElementExtensions.getBoundingClientRect(this.domElement),R.clientPoint)||this.gef(R)};ma.prototype.eDh=function(R){var Aa=null,hb=R.clientPoint,Ib=this.Mu;if(this.Vhf(R))for(Ib=this.Mu;Ib<=this.yK;Ib++)if(Aa=this.bR(Ib))if(R=Ud.DOMElementExtensions.getBoundingClientRect(Aa.domElement),!this.isRtl&&hb.x<R.x+R.width||this.isRtl&&hb.x>R.x)break;return{returnValue:Aa,
lAj:Ib>this.yK}};ma.prototype.vNb=function(){if(this.mz){if(!this.LM){Tc.ULS.sendTraceTag(537153743,0,50,"SheetTabBarControl.UpdateDragAndDropState: Starting modern sheet tab drag and drop.");this.LM=this.Z$.cloneNode(!0);if(!this.DVf(this.LM,this.Z$,!0,"UpdateDragAndDropState"))return;this.Z$.style.visibility="hidden";this.LM.classList.add(ub.Wth);this.LM.style.borderRightWidth="";this.ucc=this.bZ.clientPoint.x-this.W3.width/2;this.LM.style.left=this.ucc+"px";this.HC=this.dja(this.D_);0>this.HC&&
Tc.ULS.sendTraceTag(537153742,0,15,"SheetTabBarControl.UpdateDragAndDropState: ghostIndex < 0!")}this.h7b&&(this.HC=this.dja(this.D_));var R=Ud.DOMElementExtensions.getBoundingClientRect(this.Nk),Aa=R.x;R=R.x+R.width;var hb=this.bZ.clientPoint.x-this.W3.width/2;hb=Math.min(hb,R-this.W3.width);hb=Math.max(hb,Aa);this.LM.style.transform="translateX("+Math.abs(hb-this.ucc)*(this.ucc<hb?1:-1)+"px)";var Ib=this.bZ.clientPoint.x>this.mAb,Bc=this.bZ.clientPoint.x;hb>=R-this.W3.width?(Bc=R-this.W3.width/
2,this.TMd()||this.Ima||(Tc.ULS.sendTraceTag(537153741,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the right."),this.Roc=this.Nk.scrollLeft,this.Ima=window.requestAnimationFrame(this.hXf))):hb<=Aa?(Bc=Aa+this.W3.width/2,this.SMd()||this.Ima||(Tc.ULS.sendTraceTag(537153740,0,50,"SheetTabBarControl.OnDocumentPointerMove: Starting modern sheet tab bar scroll with drag and drop to the left."),this.Roc=this.Nk.scrollLeft,this.Ima=window.requestAnimationFrame(this.gXf))):
this.Ima&&(Tc.ULS.sendTraceTag(537153739,0,50,"SheetTabBarControl.UpdateDragAndDropState: Ending scroll as dragged sheet left renderd edge of stb."),this.RTd());this.bZ.clientPoint.x!==this.mAb&&(this.FUd(Ib,Bc),this.mAb=this.bZ.clientPoint.x)}else R=this.eDh(this.bZ),Aa=R.lAj,(R=R.returnValue)?this.iSd(R.sheet,Aa):this.z9e();this.mLc=!0};ma.prototype.FUd=function(R,Aa){for(var hb=this,Ib;function(){var Bc=hb.dih(Aa,R);Ib=Bc.m1b;return Bc}().returnValue;)this.WLb=Ib,this.CJg(R)};ma.prototype.CJg=
function(R){if(this.WLb){var Aa=(R?1:-1)*this.W3.width;if(R&&!this.$.vJ||!R&&this.$.vJ){var hb=this.Z$;var Ib=this.HC+1;var Bc=!0}else hb=(Ib=this.bR(this.HC+1))?Ib.domElement:null,Ib=this.HC-1,Bc=!1;if(this.DVf(this.WLb,hb,Bc,"AnimateSheetSwap")){Tc.ULS.sendTraceTag(537153738,0,50,"SheetTabBarControl.AnimateSheetSwap: Sheet swap between ghost-index {0} and other sheet-index {1}. amount of sheets in the bar: {2} isMovingRight: {3}",this.HC,Ib,this.oQd,R);0<=this.HC&&this.HC<this.wh.length&&0<=Ib&&
Ib<this.wh.length?(R=this.wh[Ib],this.wh[Ib]=this.wh[this.HC],this.wh[this.HC]=R):(Tc.ULS.sendTraceTag(537153737,0,15,"SheetTabBarControl.AnimateSheetSwap: indices are out of range! length: {0}, ghostIndex: {1}, swappedSheetIndex: {2}",this.wh.length,this.HC,Ib),this.MQ());this.HC=Ib;var gc=this.WLb;gc.style.transform="translateX("+Aa+"px)";window.requestAnimationFrame(function(){gc.style.transform="translateX(0px)"})}}};ma.prototype.DVf=function(R,Aa,hb,Ib){function Bc(gc){return gc?String.format("Node ID: {0} , Node class: {1}, Node name: {2},",
gc.id,gc.className,gc.nodeName):null}try{return this.Nk.insertBefore(R,Aa),!0}catch(gc){return R=this.G2a(this.D_),Tc.ULS.sendTraceTag(537153736,0,15,"SheetTabBarControl.SafeInsertSheetBefore: Reference node is not a descendant of the sheet tab bar. sheetTabButonState: [{0}], Caller: [{1}], Node to insert before [{2}], That node's parent: [{3}],SheetTabListElement: [{4}], isReferenceSheetTheDraggedSheet:[{5}], ghostIndex:[{6}], sheetTabButtons length:[{7}], Exception: [{8}]",R?R!==this.X6b?"Changed":
"NoChange":"Removed",Ib,Bc(Aa),Bc(Aa.parentNode),Bc(this.Nk),hb,this.HC,this.oQd,gc),this.MQ(),!1}};ma.prototype.dih=function(R,Aa){var hb=this.$.vJ===Aa?this.bR(this.HC-1):this.bR(this.HC+1);if(!hb)return{returnValue:!1,m1b:null};hb=hb.domElement;var Ib=Ud.DOMElementExtensions.getBoundingClientRect(hb);return this.W3?Aa?{returnValue:R+this.W3.width/2>=Ib.x+.5*Ib.width,m1b:hb}:{returnValue:R-this.W3.width/2<=Ib.x+.5*Ib.width,m1b:hb}:(Tc.ULS.sendTraceTag(537153735,0,50,"SheetTabBarControl.DraggedSheetCrossesSiblingSheet: Avoding JS crash and ending drag and drop due to client bounds of dragged sheet being null."),
this.MQ(),{returnValue:!1,m1b:hb})};ma.prototype.eXf=function(R,Aa){var hb=Aa?this.hXf:this.gXf;if(-1===this.wyc)this.wyc=R,this.Ima=window.requestAnimationFrame(hb);else{R=Math.floor((R-this.wyc)/1E3*300);var Ib=this.dIb>this.SAb?1:-1;this.scrollLeft(Math.abs(this.Nk.scrollLeft-(Aa?this.Roc+R*Ib:this.Roc-R*Ib))*(Aa?-1:1));if(R=this.J_e("ScrollStep"))this.FUd(Aa,R.x+R.width/2),Aa&&!this.TMd()||!Aa&&!this.SMd()?this.Ima=window.requestAnimationFrame(hb):(Tc.ULS.sendTraceTag(537153734,0,50,"SheetTabBarControl.ScrollStep: Ending scroll as dragged sheet reached first/last sheet."),
this.RTd())}};ma.prototype.TMd=function(){var R=this.dIb>this.SAb;return R&&this.mna>=this.dIb||!R&&this.mna<=this.dIb};ma.prototype.SMd=function(){var R=this.dIb>this.SAb;return R&&this.mna<=this.SAb||!R&&this.mna>=this.SAb};ma.prototype.RTd=function(R){R=void 0===R?!0:R;this.Nk&&(this.mna=this.Nk.scrollLeft);window.cancelAnimationFrame(this.Ima);this.Ima=0;this.wyc=-1;R&&this.i0()};ma.prototype.xOd=function(R,Aa){R||Tc.ULS.sendTraceTag(537153733,0,50,"SheetTabBarControl.SetDraggedSheetTabButtonRect: DraggedSheetTabButtonRect set to null by {0}",
Aa);this.W3=R};ma.prototype.RJi=function(R){return 2===R?(this.x0(3),!0):1===R?(this.x0(0),!0):!1};ma.prototype.SAf=function(R){var Aa=this;Tc.ULS.shipAssertTag(537153732,0,-1===this.wPa&&-1===this.vPa,"SheetTabBarControl.OnNavigateButtonDown: PeriodicNavigateSetTimeoutID and PeriodicNavigateSetIntervalID should be -1 on button down!");-1!==this.wPa&&(window.clearTimeout(this.wPa),this.wPa=-1);-1!==this.vPa&&(window.clearInterval(this.vPa),this.vPa=-1);this.x0(R);this.wPa=window.setTimeout(function(){Aa.rGj(R)},
this.gDi);return!0};ma.prototype.rGj=function(R){var Aa=this;this.vPa=window.setInterval(function(){Aa.x0(R)},this.fDi)};ma.prototype.TAf=function(){this.E0c();return!this.mz||!this.pF};ma.prototype.E0c=function(){window.clearTimeout(this.wPa);window.clearInterval(this.vPa);this.vPa=this.wPa=-1;return!0};ma.prototype.UAf=function(R,Aa){var hb=this.wxd[Aa];Fe.HelperMethods.WVd(this.QK[Aa],hb,hb+dd.a.Wdc,"mouseover"===R.type||"focus"===R.type)};ma.prototype.TPi=function(R,Aa){var hb=this.sgc(Aa),Ib=
5===Aa;if("mouseup"===R.type){if(Ib||4===Aa)hb||this.reorderSheets(null,Ib,!1),this.MQ()}else!this.mz&&this.pF?(hb||this.iSd(this.B3e(Ib?this.yK:this.Mu),Ib),this.x0(Ib?2:1)):this.jm||this.UAf(R,Aa)};ma.prototype.sgc=function(R){return!!Ud.DOMElementExtensions.Med(this.QK[R],"a").title};ma.prototype.UBc=function(R){this.OYd(R);this.i0()};ma.prototype.OYd=function(R){(R=this.G2a(R))&&R.ffb()};ma.prototype.VMd=function(){var R=this.$.xa;if(R.pa&&(!gd.e(this.$)||R.count))if(R=this.dja(R.pa),-1===R)Tc.ULS.sendTraceTag(537153729,
0,50,"SheetTabBarControl.ScrollToActiveIndex: shouldn't have an invisible, active sheet");else{var Aa=this.DKa(R);R<this.Mu?this.Buc(R):R>this.Mu&&!this.grd(Aa)&&this.scrollIntoView(R)}};ma.prototype.tSj=function(){this.Mu=0;this.yK=this.wh.length-1;for(var R=!1,Aa=0;Aa<this.wh.length;Aa++){var hb=this.bR(Aa);if(!hb)break;var Ib=this.grd(hb.domElement);hb.tabIndex=Ib?0:-1;if(!R&&Ib)this.Mu=Aa,R=!0;else if(R&&!Ib){this.yK=Aa-1;break}}};ma.prototype.Buc=function(R){this.$.xa.count&&(this.wh.length||
this.I4c(),this.WYf(this.DKa(Math.max(0,Math.min(R,this.wh.length-1)))),this.i0())};ma.prototype.scrollIntoView=function(R){Tc.ULS.shipAssertTag(537153697,0,R>=this.Mu,"SheetTabBarControl.ScrollIntoView: sheetTabIndex must be greater than the first visisble sheet tab index!");if(this.$.xa.count){this.wh.length||this.I4c();var Aa=this.DKa(Math.max(0,Math.min(R,this.wh.length-1))),hb=this.DKa(this.Mu);if(!this.grd(Aa)){Aa=Ud.DOMElementExtensions.getBoundingClientRect(Aa);var Ib=Ud.DOMElementExtensions.getBoundingClientRect(this.Scb);
Aa=this.isRtl?Ib.x-Aa.x:Aa.x+Aa.width-(Ib.x+Ib.width);for(Ib=0;hb&&Ib<Aa;){var Bc=Ud.DOMElementExtensions.getBoundingClientRect(hb);Ib+=Bc.width;hb=hb.nextSibling}hb?this.WYf(hb):Tc.ULS.sendTraceTag(537153696,0,15,"SheetTabBarControl.ScrollIntoView: new firstVisible is null. firstVisibleSheetTabIndex = {0}, lastVisibleSheetTabIndex = {1}, scroll to index: {2}",this.Mu,this.yK,R)}this.i0()}};ma.prototype.WYf=function(R){var Aa=Ud.DOMElementExtensions.getBoundingClientRect(this.Nk);R=Ud.DOMElementExtensions.getBoundingClientRect(R);
this.isRtl?this.scrollLeft(Math.floor(Aa.x+Aa.width-(R.x+R.width+.5))):this.scrollLeft(Math.ceil(Aa.x-R.x-.5))};ma.prototype.scrollLeft=function(R){(0>R&&this.TMd()||0<R&&this.SMd())&&Tc.ULS.sendTraceTag(537153695,0,50,"SheetTabBarControl.Scrollleft: attempt to scroll after the edge (overflow) in sheet tab bar.");var Aa=this.Nk.scrollLeft;if(this.isRtl){if(af.a.sF||af.a.Df){this.Nk.scrollLeft=this.mna=Aa-R;return}if(af.a.cB||af.a.MH){this.Nk.scrollLeft=this.mna=Aa+R;return}Tc.ULS.sendTraceTag(537153694,
0,15,"SheetTabBarControl.ScrollLeft: unknown browser")}this.Nk.scrollLeft=this.mna=Aa-R};ma.prototype.grd=function(R){R=Ud.DOMElementExtensions.getBoundingClientRect(R);var Aa=Ud.DOMElementExtensions.getBoundingClientRect(this.Scb);return R&&Aa?R.x>=Aa.x-1&&R.x+R.width<=Aa.x+Aa.width+1:(Tc.ULS.sendTraceTag(537153693,0,15,"SheetTabBarControl.IsTabCompletelyVisible: sheetTabRect is null or contentAreaRect is null"),!1)};ma.prototype.t8g=function(){var R=this.Kwc;if(vb.A2f(this.$))this.jm?(pg.a.Fa(this.EH),
this.EH=new vb(R,this.$,this,!0)):(pg.a.Fa(this.EH),this.EH=null);else if(!this.EH||this.jm)pg.a.Fa(this.EH),fh.k(this.$.lg)?this.EH=new Ka(R,this.$,this):this.EH=new vb(R,this.$,this)};ma.prototype.PEe=function(R,Aa){var hb=this.$.xa;if(!this.$.isEditMode||!hb.count)pg.a.Fa(Aa),Aa=null;else if(!Aa)if(hb=this.jm?this.qQd:this.Kwc,fh.k(this.$.lg))Aa=new Ka(hb,this.$,this);else switch(R){case 0:Aa=new vb(hb,this.$,this);break;case 1:Aa=new Dc(hb,this.$,this);break;default:Tc.ULS.sendTraceTag(537153692,
0,10,"Unsupported SheetTabBarButtonType. Are you trying to create a new button? Make sure to update the SheetTabBarButtonType enum and add a case here to support creation of your new button.")}return Aa};ma.prototype.p4c=function(){ac.EwaSettings.la(441)?(this.EH=this.PEe(0,this.EH),this.Txb=this.PEe(1,this.Txb)):this.t8g()};ma.prototype.J_e=function(R){var Aa=Ud.DOMElementExtensions.getBoundingClientRect(this.LM);Aa||(Tc.ULS.sendTraceTag(537153689,0,50,"SheetTabBarControl.{0}: GetBoundingClientRect returned null for the dragged sheet.",
R),this.MQ());return Aa};ma.prototype.o7e=function(R,Aa){this.Kta.DKg(R,Aa);this.MQ(!1);this.XOd(this.navigationButtonsDisabled);R=yl(this.WIj);for(Aa=R.next();!Aa.done;Aa=R.next())(Aa=Aa.value)&&Aa.uX(this.navigationButtonsDisabled);R=yl(this.Mte);for(Aa=R.next();!Aa.done;Aa=R.next())(Aa=Aa.value)&&Aa.uX(this.operationButtonsDisabled)};ma.Sej=function(R,Aa,hb,Ib){R<hb?(Aa>hb&&hb--,Aa>Ib&&Ib--):R>Ib?(Aa<hb&&hb++,Aa<Ib&&Ib++):Aa<hb&&hb++;return{IDh:hb,tri:Ib}};Sk.Object.defineProperties(ma.prototype,
{Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Zd:{configurable:!0,enumerable:!0,get:function(){return rf.a.nQd}},pF:{configurable:!0,enumerable:!0,get:function(){return this.mLc}},oQd:{configurable:!0,enumerable:!0,get:function(){return this.wh.length}},Ewc:{configurable:!0,enumerable:!0,get:function(){return this.dhe}},cxa:{configurable:!0,enumerable:!0,get:function(){return this.b$d}},
navigationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Kta&&this.Kta.navigationButtonsDisabled}},operationButtonsDisabled:{configurable:!0,enumerable:!0,get:function(){return!!this.Kta&&this.Kta.operationButtonsDisabled}},wxd:{configurable:!0,enumerable:!0,get:function(){return this.jm?this.$.vJ?[cg.a.i8b,cg.a.iPe,cg.a.kPe,cg.a.h8b,cg.a.nua,cg.a.nua]:[cg.a.h8b,cg.a.kPe,cg.a.iPe,cg.a.i8b,cg.a.nua,cg.a.nua]:this.$.vJ?[cg.a.i8b,cg.a.hPe,cg.a.jPe,cg.a.h8b,cg.a.nua,cg.a.nua]:
[cg.a.h8b,cg.a.jPe,cg.a.hPe,cg.a.i8b,cg.a.nua,cg.a.nua]}},yxd:{configurable:!0,enumerable:!0,get:function(){return this.$.vJ?[null,k.a.pBe,k.a.nBe]:[null,k.a.nBe,k.a.pBe]}},mJf:{configurable:!0,enumerable:!0,get:function(){return this.$.vJ?[null,k.a.qBe,k.a.oBe]:[null,k.a.oBe,k.a.qBe]}},SAb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(af.a.sF)return 0;if(af.a.Df)return-1*(this.Nk.scrollWidth-this.Nk.clientWidth);if(af.a.Vu)return this.Nk.scrollWidth-this.Nk.clientWidth;Tc.ULS.sendTraceTag(537153762,
0,15,"SheetTabBarControl.ScrollLeftEdgeValue: unknown browser")}return 0}},dIb:{configurable:!0,enumerable:!0,get:function(){if(this.isRtl){if(af.a.sF)return this.Nk.scrollWidth-this.Nk.clientWidth;if(af.a.Df||af.a.Vu)return 0;Tc.ULS.sendTraceTag(537153761,0,15,"SheetTabBarControl.ScrollRightEdgeValue: unknown browser")}return this.Nk.scrollWidth-this.Nk.clientWidth}},Mte:{configurable:!0,enumerable:!0,get:function(){return this.Kta?[this.EH,this.Txb]:[this.EH,this.Txb,this.TRa]}},WIj:{configurable:!0,
enumerable:!0,get:function(){return this.wh.concat(this.TRa)}},Mwj:{configurable:!0,enumerable:!0,get:function(){return this.che}}});Object(vc.a)(ma,"SheetTabBarControl",Uf.a,[265,3,112]);var Xd=kf.a;vm(hc,Xd);hc.prototype.create=function(){var R=this,Aa=this.$.Ib;if(!jh.a(this.$.ya,1)){var hb=document.getElementById(Aa+dd.a.O5c);hb&&(ac.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&tc.PageLoadTrackingInfo.instance.sAa(dd.a.nKb),Cg.a.rqd()?ig.TaskExtensions.Ba(bg.GetServiceTaskFactory.Wa(this.$.da,
388,387,this.ub),function(Ib){R.Fb(R.$.da.Aa(32)||new ma(R.$,hb,Ib.result))},this.$.ma,3):this.Fb(this.$.da.Aa(32)||new ma(this.$,hb)))}};hc.ja=function(R){R.da.Ha(33,new hc(R))};Object(vc.a)(hc,"SheetTabBarFactory",kf.a,[]);var pe=b(49),cf=b(182);jb.prototype.SOa=function(){cf.a.instance.NJd(Object(hd.a)(this,this.SOa,"onSessionExpiredDetected"));Tc.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected");this.q5h()};jb.prototype.yDf=function(){cf.a.instance.MJd(Object(hd.a)(this,this.yDf,"onSessionExpiringDetected"));
this.Rge||this.zQc||(Tc.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this.Rge=!0,this.RCj())};jb.prototype.q5h=function(){this.zQc||(wc.AFrameworkApplication.YF(pe.a.qvc),this.zQc=!0,this.QCj())};Object(vc.a)(jb,"ASessionExpirationManager",null,[]);var ef=b(245),jf=b(6),yf=b(79),Eg=b(247);vm(Ja,jb);Ja.prototype.voe=function(R){this.Ma.addHandler("SessionExpired",R)};Ja.prototype.ZYb=function(R){this.Ma.addHandler("TokenRefreshed",R)};Ja.prototype.BJd=function(R){this.Ma.removeHandler("TokenRefreshed",
R)};Ja.prototype.idc=function(){return cf.a.instance.vR(wc.AFrameworkApplication.rk)};Ja.prototype.dispose=function(){pg.a.Fa(this.Ma);this.$=null};Ja.prototype.RCj=function(){this.$.isEditMode&&this.Icc(!1)};Ja.prototype.QCj=function(){this.fmb=!0;this.Icc(!0);this.Ma.raiseEvent("SessionExpired")};Ja.prototype.Icc=function(R){var Aa=this;Tc.ULS.sendTraceTag(537170715,0,15,"EwaAccessTokenExpirationManager.HandleAccessTokenExpirationDialog: isExpired {0}, GotDeploymentOrTimedOutError {1}",R,this.$.ea.Waa);
var hb=this.$.Ab.Mp;R&&hb&&hb.isVisible&&1299163859===hb.error.MessageId&&this.$.Ab.Mp.Du();var Ib=this.hd(R);td.a(this.$).kt(new ef.a(jf.a.fz,5,function(){var Bc=Cf.a(Aa.$),gc=Bc.qd.activityState;gc[yf.a.t2]=Aa.$.apb(Aa.$.isEditMode);gc[yf.a.nM]=yf.a.O8a;gc[Eg.a.Yq]=jf.a.accessTokenExpiringWarning;Bc.qd.At([Ib])}))};Ja.prototype.hd=function(R){return R?dh.a.mFe():this.Y9g()};Ja.prototype.Y9g=function(){var R=dh.a.hd(12,1,0,0,0,1299163859,"AccessTokenExpiringWarning");R.Description=this.accessTokenExpiringMessage;
return R};Sk.Object.defineProperties(Ja.prototype,{accessTokenExpiringMessage:{configurable:!0,enumerable:!0,get:function(){var R=(new Date(this.rk)).format(this.$.ya.ShortTimeFormat);return String.format(Pd.a.instance.Cb(77),R)}},tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.fmb}},Vcb:{configurable:!0,enumerable:!0,get:function(){return!1}},Iba:{configurable:!0,enumerable:!0,get:function(){return!1}},JHd:{configurable:!0,enumerable:!0,get:function(){return!1}},K5:{configurable:!0,
enumerable:!0,get:function(){return!1}}});Object(vc.a)(Ja,"EwaAccessTokenExpirationManager",jb,[273,274,3]);var rh=b(178),Eh=b(687);Object(vc.a)(db,"RefreshAccessTokenContext",null,[]);var Qg=b(185),Ng=b(113),Hh=b(136),Tg=b(33),tg=b(111);Object(vc.a)(Na,"Error",null,[]);Object(vc.a)(Xa,"NamedResult",null,[]);vm(Ha,Xa);Object(vc.a)(Ha,"ErrorInfo",Xa,[]);Sk.Object.defineProperties(Pa.prototype,{$O:{configurable:!0,enumerable:!0,get:function(){return this.PWb}},errors:{configurable:!0,enumerable:!0,
get:function(){return this.jT}}});Object(vc.a)(Pa,"TokenRefreshArgs",null,[302]);pa.prototype.voe=function(R){this.Ma.addHandler("SessionExpired",R)};pa.prototype.ZYb=function(R){this.Ma.addHandler("TokenRefreshed",R)};pa.prototype.BJd=function(R){this.Ma.removeHandler("TokenRefreshed",R)};pa.prototype.idc=function(){return cf.a.instance.vR(wc.AFrameworkApplication.rk)};pa.prototype.dispose=function(){cf.a.instance.NJd(this.H7e);cf.a.instance.MJd(this.g7e);var R=this.$.ea;R&&(R.lk(this.$c),R.Lsc(this.Fya));
pg.a.Fa(this.Ma);this.documentVisibilityObserver=this.$=null};pa.prototype.e$f=function(){return this.idc()?0:(wc.AFrameworkApplication.rk-(new Date).getTime())/6E4};pa.prototype.Qeg=function(R,Aa){if(0<Aa&&!this.idc()){var hb=wc.AFrameworkApplication.ga.Ad("AccessTokenExpirationPromptSeconds",wc.AFrameworkApplication.pY),Ib=(Aa-R.getTime())/6E4;Tc.ULS.shipAssertTag(537170713,0,0<=Ib,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime the access-token expiration time should be after token creation time accessTokenTTL [{0}] creationTime [{1}] tokenLifetimeInMin [{2}]",
Aa,R.getTime(),Ib);Ib<this.mBi?(Tc.ULS.sendTraceTag(537170712,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",this.$1f,Ib),wc.AFrameworkApplication.pY=this.$1f):wc.AFrameworkApplication.pY!==hb&&(Tc.ULS.sendTraceTag(537170711,0,15,"TokenManager.UpdateTokenExpirationPromptByTokenLifeTime updating AccessTokenExpirationPromptSeconds to [{0}] tokenLifetimeInMin [{1}]",hb,Ib),wc.AFrameworkApplication.pY=hb)}};
pa.prototype.z4g=function(R){return!this.context||this.context.CGb||this.context.R4c!==R?(R=new db(rh.a.create().toString(),R),this.context&&!this.context.fAc&&Tc.ULS.sendTraceTag(537170710,0,15,"TokenManager.InitContext: creating new context [{0}] although previeous one [{1}] not used successfully, isPreviousOneRefreshedSuccessfully [{2}] ",R.correlationID,this.context.correlationID,this.context.CGb),this.cT=R,!0):!1};pa.prototype.nhj=function(R){R&&this.hH&&!this.Iba&&this.$.ea.wf.pr&&!this.K5&&
(this.hH=!1)};pa.prototype.I7e=function(R){var Aa=this;this.nhj(R);if(!(this.blb||this.Hdb&&!R||this.hH)&&this.Vcb){this.blb=!0;var hb=this.context?this.context.creationTime:null,Ib=this.z4g(R);this.Kud=!0;var Bc=this.$.ea,gc={Name:"EwaAccessTokenExpirationRefreshManager.HandleTokenRefresh",newContextCreated:Ib};gc.IsUserActive=Bc.wf.pr;gc.IsSessionActive=Bc.qc;gc.ContainsChangesWorkbookOperations=this.$.userOperationManager.qHa();gc.isSessionExpired=R;gc.stopRefreshRetriesUntilTokenExpired=this.Hdb;
gc.FailedToRefreshExpiredToken=this.hH;gc.numOfFailuresWhileUserIsActive=tg.a.h6;gc.numOfFailuresWhileUserIsInActive=tg.a.i6;gc.numOfFailuresWhileOffline=tg.a.mya;gc.RefreshAccessTokenCorrelationID=this.context.correlationID;Ib&&hb&&(gc.TimeInMinFromPreviosContextCreation=Math.round(Ng.b(nh.a.Ra,hb)/60));hb=Sg.a.Kc(gc);Tc.ULS.sendTraceTag(40416199,0,50,hb);this.HHd.start();this.q$d=Bc.wf.pr;this.qx=new Eh.a;this.Rsi(R);var Id=this.$Vd.H8i(!R,this.qx?this.qx.token:null);Id.continueWith(function(){Aa.lYg();
var fe=Aa.$Vd.U2i(Id);Aa.HHd.stop();var sf=Aa.idc();if(!fe||ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5348973_FishbowlFixDuringTokenRefresh")&&sf){var hg=Id.result.errors;fe&&sf&&Aa.hBg(hg);Aa.a5h(hg,R)}else Aa.Hdb=!1,Aa.b5h(Id.result.$O,R);Aa.blb=!1},this.P9b?8:0)}};pa.prototype.hBg=function(R){var Aa=[Object.assign(new Na,{Id:"200",Details:"Expired accesstoken recieved on successful token request."})];R.add(Object.assign(new Ha,{Name:"ExpiredTokenAfterSuccessfulRefresh",Errors:Aa}))};pa.prototype.Rsi=
function(R){R&&(this.$.ea.wf.pr?this.K6f():(this.$.ea.wf.Qra(this.cCd),this.IGb=!0))};pa.prototype.K6f=function(){var R=this;this.Crc=Qg.AsyncMethodContext.Zy(function(){R.G8i()},1E3*this.bOf,vg.a.o8i,this.Crc)};pa.prototype.lYg=function(){this.Crc&&this.Crc.cancel();this.IGb&&(this.$.ea.wf.Pza(this.cCd),this.IGb=!1);this.qx=null};pa.prototype.G8i=function(){Tc.ULS.sendTraceTag(537170706,0,15,"EwaAccessTokenExpirationRefreshManager.RefreshTokenDurationThresholdReached durationLimitInSec [{0}]",this.bOf);
this.qx.C()};pa.prototype.a5h=function(R,Aa){this.Hdb=!0;Aa&&(this.hH||(this.fmb=this.hH=!0),this.$Vd.ehc(R)&&(this.R$d=!0));var hb=!Aa||this.Vcb&&!tg.a.axc?40380379:39982555;Aa=this.UDe(Aa);Aa.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshError";Aa.FailedToRefreshExpiredToken=this.hH;Aa.LastErrorIsPermanent=this.K5;if(0<R.count){var Ib=R.oa(0);Aa.errorName=Ib.Name;0<Ib.Errors.length&&(Aa.ErrorId=Ib.Errors[0].Id,Ib=Ib.Errors[0].Details,Aa.ErrorDetails=this.Dhh(Ib.toString())?"PiiScrubbed":
Ib)}Aa=Sg.a.Kc(Aa);Tc.ULS.sendTraceTag(hb,0,15,Aa);this.Ma.raiseEvent("TokenRefreshed",new Pa(null,R))};pa.prototype.Dhh=function(R){return If.a.contains(R,"makes the internet safe for businesses",!0)};pa.prototype.UDe=function(R){var Aa={},hb=this.$.ea;Aa.Name="";Aa.IsUserActive=hb.wf.pr;Aa.IsSessionActive=hb.qc;Aa.GotDeploymentOrTimedOutError=hb.Waa;Aa.TimeInSecFromLastStatefulSuccessfulRequest=hb.O7;Aa.TimeFromLastUserActivityInMs=hb.wf.feb;Aa.calledFromSessionExpiredFlow=R;Aa.RefreshTokenDurationInMS=
this.HHd.Dc;Aa.numOfFailuresWhileUserIsActive=tg.a.h6;Aa.numOfFailuresWhileUserIsInActive=tg.a.i6;Aa.numOfFailuresWhileOffline=tg.a.mya;Aa.RefreshAccessTokenCorrelationID=this.context.correlationID;Aa.accessTokenTTL=wc.AFrameworkApplication.rk;Aa.ContainsChangesWorkbookOperations=this.$.userOperationManager.qHa();Aa.IsDocumentHidden=this.documentVisibilityObserver?this.documentVisibilityObserver.Di.toString():"Unknown";Aa.TimeFromFirstOpenInHr=Math.floor(Ng.b(nh.a.Ra,Jh.toUtc(hb.xGf))/3600);return Aa};
pa.prototype.b5h=function(R,Aa){this.hH=!1;this.RUj();this.Qeg(new Date,wc.AFrameworkApplication.rk);var hb=this.$.ea,Ib=!Aa&&hb.wf.pr,Bc=!this.$.isEditMode&&hb.yab;Aa=this.UDe(Aa);Aa.Name="EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess";Aa.shouldTriggerSilentReloadAfterExpiring=Ib;Aa.WopiTokenTaskItemPriority=wc.AFrameworkApplication.z_d;Aa.isDirtyViewSession=Bc;Aa=Sg.a.Kc(Aa);Tc.ULS.sendTraceTag(39982556,0,15,Aa);this.Ma.raiseEvent("TokenRefreshed",new Pa(R,null));Bc?hb.wf.pr&&(Tc.ULS.sendTraceTag(537170705,
0,15,"EwaAccessTokenExpirationRefreshManager.HandleRefreshSuccess: User active after refresh dirty view session. trigger request to connect the same server."),hb.ecd()):hb.wf.pr?Ib&&(R=Cf.a(this.$).qd.activityState,R[tg.a.yeb]=!0,R[Hh.a.tY]=!0,R[Tg.a.Ls]=this.$.isEditMode,td.a(this.$).kt(new ef.a(jf.a.una,2,null))):hb.qc&&Kh.m(this.$.na.ta,!0,!1,!1,null,null,null,null,null)};pa.prototype.RUj=function(){void 0!==this.$.ea.workbookContext.WorkbookUri&&null!==this.$.ea.workbookContext.WorkbookUri?(this.$.ea.workbookContext.WorkbookUri=
oc.a.UT(this.$.ea.workbookContext.WorkbookUri,wc.AFrameworkApplication.OP,wc.AFrameworkApplication.accessToken),this.$.ea.workbookContext.WorkbookUri=oc.a.UT(this.$.ea.workbookContext.WorkbookUri,wc.AFrameworkApplication.qY,wc.AFrameworkApplication.rk.toString()),this.$.ea.Goc()):Tc.ULS.sendTraceTag(537170704,0,15,"EwaAccessTokenExpirationRefreshManager.UpdateTokensAtContext: WorkbookUri is null");this.$.ya.AccessToken=wc.AFrameworkApplication.accessToken;this.$.ya.AccessTokenValidTo=wc.AFrameworkApplication.rk;
void 0!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&null!==this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion&&(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=oc.a.UT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,wc.AFrameworkApplication.OP,wc.AFrameworkApplication.accessToken),this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion=oc.a.UT(this.$.ya.DocumentHostInfo.QuerySignatureWithoutVersion,wc.AFrameworkApplication.qY,wc.AFrameworkApplication.rk.toString()));
void 0!==this.$.ya.EmbedConfiguratorUrl&&null!==this.$.ya.EmbedConfiguratorUrl&&(this.$.ya.EmbedConfiguratorUrl=oc.a.UT(this.$.ya.EmbedConfiguratorUrl,wc.AFrameworkApplication.OP,wc.AFrameworkApplication.accessToken),this.$.ya.EmbedConfiguratorUrl=oc.a.UT(this.$.ya.EmbedConfiguratorUrl,wc.AFrameworkApplication.qY,wc.AFrameworkApplication.rk.toString()));this.context.CGb=!0};Sk.Object.defineProperties(pa.prototype,{tokenExpired:{configurable:!0,enumerable:!0,get:function(){return this.fmb}},Iba:{configurable:!0,
enumerable:!0,get:function(){return this.q$d}},K5:{configurable:!0,enumerable:!0,get:function(){return this.R$d}},context:{configurable:!0,enumerable:!0,get:function(){return this.cT}},Vcb:{configurable:!0,enumerable:!0,get:function(){return this.K5?!1:this.$.ea.wf.pr?1>tg.a.h6:6>tg.a.i6}},JHd:{configurable:!0,enumerable:!0,get:function(){return this.blb}}});Object(vc.a)(pa,"EwaAccessTokenExpirationRefreshManager",null,[273,274,3]);qa.WXb="ActivityDuration";qa.error="Error";qa.ymh="Errors";qa.failed=
"Failed";qa.vDh="FirstActivity";qa.initialized="Initialized";qa.gri="LastActivity";qa.Zij="RetryOverride";qa.Lgj="RequestGroups";qa.requests="Requests";qa.jUf="Responses";qa.svc="SessionDuration";qa.status="Status";qa.success="Success";qa.$O="Tokens";Object(vc.a)(qa,"SessionExpirationStrings",null,[]);ea.prototype.vhg=function(){var R={};Tc.ULS.sendTraceTag(41964821,217,50,Tc.ULS.Kc((R.Aggregate=this.LX,R.Current=this.Io,R)))};ea.prototype.Ibi=function(){this.LX[qa.Lgj]=0;this.LX[qa.requests]=0;this.LX[qa.jUf]=
0;this.LX[qa.status]=qa.initialized;this.LX[qa.vDh]=new Date;this.LX[qa.svc]=0;this.LX[qa.WXb]=0;this.LX[qa.svc]=0;this.Io[qa.svc]=0;this.LX[qa.WXb]=0;this.Io[qa.WXb]=0};ea.prototype.uld=function(R,Aa){var hb=R[Aa];hb=hb?hb:0;hb++;R[Aa]=hb;this.POd(R)};ea.prototype.POd=function(R){var Aa=new Date;R[qa.WXb]=+Aa-+this.oTb;this.oTb=Aa;R[qa.svc]=+this.oTb-+this.Tvg;R[qa.gri]=this.oTb};ea.prototype.Bcb=function(R,Aa){this.Io[R]=Aa;this.POd(this.Io)};ea.prototype.vZf=function(R,Aa){this.Io[R]=Aa;this.POd(this.Io)};
ea.prototype.incrementCounter=function(R){this.uld(this.Io,R);this.uld(this.LX,R);this.uld(this.bug,R)};ea.prototype.flush=function(){this.l$d||(this.LX[qa.status]=this.Io[qa.status],this.vhg(this.FWb),this.me.$ma(this.FWb,6E4*this.Xmf))};ea.prototype.stop=function(){Tc.ULS.sendTraceTag(41964822,217,100,"Stopping logger. Flushing one last time");this.flush();this.l$d=!0;this.me.Np(this.FWb)};Object(vc.a)(ea,"SessionLogger",null,[323]);var ii=b(688),Ki=b(1068);ja.prototype.RNi=function(R){if(R.MessageId!==
nb.a.Ckd)Wc.a(39408099,306,15,"Unexpected message.");else{var Aa=new La.a,hb=new La.a;this.uj.incrementCounter(qa.jUf);var Ib=R.Values[Ve.a.BYf];if(!Ib||0>=Ib.length)Wc.a(40122317,306,15,"Found no tokens in the dictionary"),Ib=R.Values;Wc.a(40122318,306,100,"The Tokens array contains {0} tokens",Ib.length);this.uj.Bcb("Correlation",R.CorrelationId);for(var Bc="",gc=0;gc<Ib.length;gc++){this.uj.vZf(qa.$O,Ib.length);var Id=Ib[gc],fe=Id;if(fe&&fe.Name){this.uj.incrementCounter(fe.Name);var sf=Id;if(sf&&
sf.Value)Wc.a(39408128,306,100,"Received token with name: {0}",sf.Name),Aa.add(sf),this.PWb.add(sf),this.uj.Bcb(qa.status,qa.success),this.Y5d&&this.yT&&this.yT.Mhj();else if(Id=this.rYh(Id),Wc.a(39408129,306,15,"Received error for token {0}. Creating error object from {1}, TaskId {2}",fe.Name,JSON.stringify(Id),this.Bga),hb.add(Id),this.jT.add(Id),Bc=JSON.stringify(Id),this.uj.Bcb(qa.error,JSON.stringify(Id)),this.uj.Bcb(qa.status,qa.failed),this.Y5d)for(fe=yl(Id.Errors),Id=fe.next();!Id.done;Id=
fe.next())Id=this.BPh(Id.value),this.yT&&this.yT.vDg(Id)}}0<hb.count&&""!==Bc?(Ib=Object.assign(new Ee.a,{extendedProperties:new Map}),Ib.extendedProperties.set("Errors",Bc),Oc.Health.instance.recordKpiFailure("WACTokenRefresh","TokenRefreshFailed",!1,!1,Ib)):Oc.Health.instance.recordKpiSuccess("WACTokenRefresh",null);Wc.a(39408130,306,50,"Received new tokens response. {0} tokens and {1} errors. Correlation {2}, TaskId {3}",Aa.count,hb.count,R.CorrelationId,this.Bga);0<hb.count&&!this.ehc(hb)?(R=
this.p9.OXh(hb),R!==this.p9.KLd&&(this.uj.vZf(qa.Zij,R),this.me.$ma(this.Vi,R))):(this.uj.flush(),this.Vi&&(Wc.a(39408131,306,100,"Deleting task {0} from task manager",this.Vi.name),this.me.Np(this.Vi)),this.Vl&&!this.Vl.task.isCompleted&&this.Vl.setResult(new Pa(Aa,hb)))}};ja.prototype.rYh=function(R){if(!R)return null;var Aa=Object.assign(new Ha,{Name:R.Name,Errors:[]});R=yl(R.Errors);for(var hb=R.next();!hb.done;hb=R.next()){hb=hb.value;var Ib=new Na;Ib.Id=hb.Id;Ib.Details=this.qYh(hb.Details);
Aa.Errors.push(Ib)}return Aa};ja.prototype.qYh=function(R){if(!R)return"";var Aa=R.toLowerCase();return 0<Aa.indexOf("<!doctype")?this.Ggd("Seems to contain HTML - Contains <!DOCTYPE"):0<Aa.indexOf("<html")?this.Ggd("Seems to contain HTML - Contains <html>"):500<Aa.length?this.Ggd(String.format("Error details content too long: Length: {0}",Aa.length)):R};ja.prototype.Ggd=function(R){return String.format("{0} - Reason: [{1}]","### REDACTED ###",R)};ja.prototype.requestTokensOnce=function(){this.rTf()};
ja.prototype.rTf=function(){wc.AFrameworkApplication.Yjc("SendSynchronousPostMessage;SendSynchronousPostMessageIsEnabledCf");this.fra>=this.p9.aAi?(Wc.a(39408132,306,15,"Too many attempts to refresh tokens. Aborting. TaskId {0}",this.Bga),this.$De(this.Vl,"TOO_MANY_ATTEMPTS","We did not receive a new token from the host after the maximum allowed number of attempts")):(Oc.Health.instance.recordKpiUsage("WACTokenRefresh",1,"wwrelfc",null),this.Tnj())};ja.prototype.Tnj=function(){var R={};R[Ve.a.BYf]=
this.p9.$O;var Aa=rh.a.create().toString();Wc.a(39408133,306,50,"Refreshing tokens {0}. Attempt {1}. Correlation {2}. TaskId {3}.",JSON.stringify(this.p9.$O),this.fra+1,Aa,this.Bga);this.eee.execute(function(hb){hb.Sj(nb.a.Hqe,R,Aa)});this.fra++;this.uj.incrementCounter(qa.requests)};ja.prototype.$De=function(R,Aa,hb){for(var Ib=new La.a,Bc=0;Bc<this.p9.$O.length;Bc++){var gc=Object.assign(new Ha,{Name:this.p9.$O[Bc],Errors:[Object.assign(new Na,{Id:Aa,Details:hb})]});Ib.add(gc);this.jT.add(gc)}this.me.Np(this.Vi);
this.uj.Bcb(qa.ymh,JSON.stringify(this.jT));this.uj.Bcb(qa.status,qa.failed);R&&!R.task.isCompleted&&R.setResult(new Pa(new La.a,this.jT))};ja.prototype.H8i=function(R,Aa){var hb=this;Aa=void 0===Aa?null:Aa;this.Vie.start();this.gTb=R;this.Bga=rh.a.create().toString();Wc.a(41755338,306,50,"RefreshTokens Start, TaskId: [{0}]. IsTokenExpiring: [{1}].",this.Bga,this.gTb);this.fra=0;this.jT.clear();this.PWb.clear();var Ib=new Wb.a;this.Vl=Ib;Aa&&Aa.R(function(){var Bc=!!Ib&&!Ib.task.isCompleted;Wc.a(588096223,
306,50,"RefreshTokens Cancelled, TaskId: [{0}]. IsTokenExpiring: [{1}]. isTaskStillRunning [{2}].",hb.Bga,hb.gTb,Bc);Bc&&hb.$De(Ib,"ABORTED_BY_CALLER","The refresh was aborted by the caller")});this.Vi=new Sc.a(this.p9.priority,2,this.p9.KLd,Object(hd.a)(this,this.requestTokensOnce,"requestTokensOnce"),98,nb.a.Hqe,!0);this.Nvg&&this.rTf();this.me.Zg(this.Vi);return this.Vl.task};ja.prototype.U2i=function(R){this.Vie.stop();var Aa=this.m6h(R.result.errors);Tc.ULS.sendTraceTag(41755339,217,50,"ProcessTokensOrErrors: TokenRefreshResult:{0},TaskId:{1},IsTriggerByTokenExpiring:{2},RetryCount:{3},TotalErrorCount:{4},LastErrorName:{5},LastErrorId:{6},LastErrorDetail:{7}",
!Aa,this.Bga,this.gTb,this.fra,this.jT.count,0<R.result.errors.count?R.result.errors.oa(0).Name:"",0<R.result.errors.count&&0<R.result.errors.oa(0).Errors.length?R.result.errors.oa(0).Errors[0].Id:"",0<R.result.errors.count&&0<R.result.errors.oa(0).Errors.length?R.result.errors.oa(0).Errors[0].Details:"");return Aa?!1:this.T2i(R.result.$O)};ja.prototype.ehc=function(R){return this.p9.ehc(R)};ja.prototype.T2i=function(R){for(var Aa=0;Aa<R.count;Aa++){var hb=R.oa(Aa);if(hb.Name===Ve.a.accessToken){var Ib=
(new Date).getTime();if(hb.Expiry>wc.AFrameworkApplication.rk){var Bc={};Tc.ULS.sendTraceTag(39706827,217,50,"Updating AccessToken: {0}",(Bc.AccessTokenTtl=hb.Expiry,Bc.NowGetTime=Ib,Bc.BootTime=wc.AFrameworkApplication.yha,Bc),"PreviousAccessTokenTtl",wc.AFrameworkApplication.rk);wc.AFrameworkApplication.accessToken=hb.Value;wc.AFrameworkApplication.rk=Math.floor(hb.Expiry);wc.AFrameworkApplication.x_d=Ib;wc.AFrameworkApplication.dYa=Math.floor(hb.Expiry)}else Bc={},Tc.ULS.sendTraceTag(39706828,
217,15,"Ignoring AccessToken because it expires sooner than the current one: {0}",(Bc.AccessTokenTtl=hb.Expiry,Bc.NowGetTime=Ib,Bc.BootTime=wc.AFrameworkApplication.yha,Bc),"PreviousAccessTokenTtl",wc.AFrameworkApplication.rk)}}return!0};ja.prototype.m6h=function(R){for(var Aa=!1,hb=0;hb<R.count;hb++){Aa=!0;var Ib=R.oa(hb);Tc.ULS.sendTraceTag(39706829,217,15,"Received error for token {0}. Errors: {1}. TaskId: {2} ",Ib.Name,JSON.stringify(Ib.Errors),this.Bga)}return Aa};ja.prototype.BPh=function(R){var Aa=
pe.a.qvc;R=parseInt(R.Id);if(isNaN(R))Aa=pe.a.AYj;else{switch(R){case 401:Aa=pe.a.DYj;break;case 403:Aa=pe.a.yYj;break;case 500:Aa=pe.a.zYj;break;case 503:Aa=pe.a.CYj}Aa===pe.a.qvc&&(Aa=500<R?pe.a.BYj:pe.a.xYj)}return Aa};Object(vc.a)(ja,"TokenRefreshManager",null,[275]);ca.prototype.ehc=function(R){var Aa=JSON.stringify(R);if(this.aTc&&0<this.aTc.length)for(var hb=yl(this.aTc),Ib=hb.next();!Ib.done;Ib=hb.next())if(Ib=Ib.value,0<Ib.length&&0<=Aa.indexOf(Ib))return!0;if(wc.AFrameworkApplication.ga&&
wc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.StopTokenRefreshOn403",!1))for(R=yl(R),Ib=R.next();!Ib.done;Ib=R.next())if(Ib=Ib.value,Ib.Errors)for(Aa=yl(Ib.Errors),Ib=Aa.next();!Ib.done;Ib=Aa.next())if((Ib=Ib.value)&&"403"===Ib.Id)return!0;return!1};ca.prototype.OXh=function(R){try{if(R)for(var Aa=yl(R),hb=Aa.next();!hb.done;hb=Aa.next()){var Ib=hb.value;if(Ib.Errors)for(var Bc=yl(Ib.Errors),gc=Bc.next();!gc.done;gc=Bc.next()){var Id=gc.value;if(Id.Id in this.wfe)return Number.parseInvariant(this.wfe[Id.Id].toString());
if(this.oLc)try{if(500<=Number.parseInvariant(Id.Id))return wc.AFrameworkApplication.Yjc("RetryIntervalOverrideOnServerError;RetryIntervalOverrideOnServerErrorcf"),this.zfe}catch(fe){Tc.ULS.sendTraceTag(540541017,217,50,"Unable to parse Error id to int. Exception {0}, ErrorId: {1}",fe.toString(),Id.Id)}}}}catch(fe){Tc.ULS.sendTraceTag(41501720,217,50,"TokenRefreshPolicy:GetRetryIntervalOverride, exception:{0}",fe.toString())}return this.KLd};ca.prototype.Btj=function(){var R={};try{if(!wc.AFrameworkApplication.tcc()||
0>=wc.AFrameworkApplication.tcc().length||""===wc.AFrameworkApplication.tcc()[0])return R;for(var Aa=yl(wc.AFrameworkApplication.tcc()),hb=Aa.next();!hb.done;hb=Aa.next()){var Ib=hb.value;0<Ib.length&&(R[Ib]=wc.AFrameworkApplication.FYj)}}catch(Bc){Tc.ULS.sendTraceTag(41755340,217,50,"TokenRefreshPolicy:SetRetryIntervalForNetworkIssue, exception:{0}",Bc.toString())}return R};Object(vc.a)(ca,"TokenRefreshPolicy",null,[267]);var $i=kf.a;vm(X,$i);X.prototype.create=function(){wc.AFrameworkApplication.CK("Microsoft.Office.Excel.Server.Flighting.IDenyListRefreshAccessTokenSilentlyV2_ManagerCreated");
wc.AFrameworkApplication.ga.ra("RefreshAccessTokenSilently")?this.Fb(this.s6g()):this.Fb(this.$.da.Aa(38)||this.$.da.Ha(38,new Ja(this.$)))};X.prototype.s6g=function(){var R=this.$.da.Aa(38);if(R)return R;R=new ja(wc.AFrameworkApplication.hj,wc.AFrameworkApplication.vV(),new ca);return this.$.da.Ha(38,new pa(this.$,R))};X.ja=function(R){R.da.Ha(39,new X(R))};Object(vc.a)(X,"AccessTokenExpirationManagerFactory",kf.a,[]);var Y=ud.a;vm(fa,Y);fa.prototype.wHg=function(R){this.addHandler("TAF",R)};fa.prototype.rej=
function(R){this.removeHandler("TAF",R)};fa.prototype.E4i=function(){this.raiseEvent("TAF")};Object(vc.a)(fa,"GridHighlightBehaviorEventManager",ud.a,[268,3]);var Ra=kf.a;vm(da,Ra);da.prototype.create=function(){this.Fb(this.$.da.Aa(376)||new fa(this.$))};da.ja=function(R){R.da.Ha(377,new da(R))};Object(vc.a)(da,"GridHighlightBehaviorEventManagerFactory",kf.a,[]);var xb=b(119),fc=Sys.EventArgs;vm(K,fc);Object(vc.a)(K,"MarqueeResizeStartedOrEndedEventArgs",Sys.EventArgs,[]);var bd=ud.a;vm(S,bd);S.prototype.RFg=
function(R){this.addHandler("mrek",R)};S.prototype.OW=function(R,Aa,hb){for(var Ib=yl(this.gridView.nn),Bc=Ib.next();!Bc.done;Bc=Ib.next())Hd.a.instance.qa(Ye.a.fh,Bc.value.domElement,R);Hd.a.instance.qa(Ye.a.Yd,document.documentElement,Aa);this.gridView.pc.v7b(!0);hb&&Hd.a.instance.qa(Ye.a.hy,this.gridView.xj,Aa)};S.prototype.BXd=function(R,Aa,hb){for(var Ib=yl(this.gridView.nn),Bc=Ib.next();!Bc.done;Bc=Ib.next())Hd.a.instance.za(Ye.a.fh,Bc.value.domElement,R);Hd.a.instance.za(Ye.a.Yd,document.documentElement,
Aa);this.gridView.pc.v7b(!1);hb&&Hd.a.instance.za(Ye.a.hy,this.gridView.xj,Aa)};S.prototype.B9i=function(R,Aa){for(var hb=yl(this.gridView.nn),Ib=hb.next();!Ib.done;Ib=hb.next())Fd.a.instance.qa(Ye.a.xg,Ib.value.domElement,R);Fd.a.instance.qa(Ye.a.ye,document.documentElement,Aa)};S.prototype.qQj=function(R,Aa){for(var hb=yl(this.gridView.nn),Ib=hb.next();!Ib.done;Ib=hb.next())Fd.a.instance.za(Ye.a.xg,Ib.value.domElement,R);Fd.a.instance.za(Ye.a.ye,document.documentElement,Aa)};S.prototype.WDe=function(R,
Aa,hb,Ib){var Bc=document.createElement("div");Bc.className=Aa;Aa=yl(hb);for(hb=Aa.next();!hb.done;hb=Aa.next())Bc.classList.add(hb.value);R.appendChild(Bc);Hd.a.instance.qa(Ye.a.pointerDown,Bc,Ib);return Bc};S.prototype.l3e=function(R){R=R.Tb.parentNode;if(!R)return Tc.ULS.shipAssertTag(537159394,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: selectedHighlightElement is null."),null;R=parseInt(R.getAttribute(dd.a.Cxb),10);return isNaN(R)?(Tc.ULS.shipAssertTag(537159393,0,!1,"BehaviorHelperMethods.GetSelectedMarqueeHighlightState: indexInMarqueeCollection is not a valid number."),
null):this.gridView.Nb.ZE(3,1,R)};S.prototype.QJb=function(R,Aa,hb){R=(void 0===hb?!0:hb)&&!!this.coloredReferencesManager&&this.coloredReferencesManager.xki(R);Aa=yl(Aa);for(hb=Aa.next();!hb.done;hb=Aa.next())Ud.DOMElementExtensions.setVisible(hb.value,R)};S.prototype.hdd=function(){return this.gridView.Dj?xb.a(this.gridView.$):this.gridView.yc};S.prototype.rNf=function(){var R=this.hdd();R&&this.coloredReferencesManager?this.coloredReferencesManager.wX(R,null):(Tc.ULS.sendTraceTag(537159392,0,10,
"BehaviorHelperMethods.RecalculateColoredReferences: Can't UpdateColoredReferences, will hide all marquee as a last fallback."),this.gridView.Nb.ll(this.Ipf),this.gridView.Nb.Nl(null,this.Ipf))};S.prototype.RLf=function(R,Aa){this.raiseEvent("mrek",new K(R,Aa))};Sk.Object.defineProperties(S.prototype,{coloredReferencesManager:{configurable:!0,enumerable:!0,get:function(){var R=this.gridView.$.da.Aa(281);R||Tc.ULS.sendTraceTag(537159395,0,50,"BehaviorHelperMethods.ColoredReferencesManager: coloredReferencesManager is null. (This is not always an error, for example when called from SetMarqueeHandlesVisibility while moving between view and edit modes).");
return R}}});Object(vc.a)(S,"BehaviorHelperMethods",ud.a,[]);var Dd=ve.a;vm(H,Dd);H.prototype.WYa=function(){};Object(vc.a)(H,"HighlightFlyweightBehavior",ve.a,[]);var Td=b(465),we=b(118),Oe=b(8),Te=b(68),Zf=Uf.a;vm(T,Zf);T.prototype.Tne=function(R){this.addHandler("GrDrag",R)};T.prototype.TQf=function(R){this.removeHandler("GrDrag",R)};T.prototype.Sne=function(R){this.addHandler("GrContxt",R)};T.prototype.SQf=function(R){this.removeHandler("GrContxt",R)};T.prototype.Une=function(R){this.addHandler("GrPointerUp",
R)};T.prototype.UQf=function(R){this.removeHandler("GrPointerUp",R)};T.prototype.dispose=function(){te.a.Qma(this.domElement);Zf.prototype.dispose.call(this)};T.prototype.ieg=function(R){this.domElement.parentNode.removeChild(this.domElement);R.appendChild(this.domElement)};T.prototype.SYf=function(){this.domElement.classList.remove(Te.a.x8b);this.RKa.classList.remove(Te.a.w8b);this.RKa.classList.add(Te.a.xRe)};T.prototype.wcg=function(){this.RKa.classList.remove(Te.a.xRe);this.RKa.classList.add(Te.a.w8b);
this.domElement.classList.add(Te.a.x8b)};T.prototype.A6h=function(R){return!!this.Y4b&&(3<Math.abs(R.x-this.Y4b.x)||3<Math.abs(R.y-this.Y4b.y))};T.Hub=function(R){var Aa=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),hb=af.a.Af;return Aa&&!hb?(R=qf.a(R.$)?qf.a(R.$).zoom:Oe.a.ica,Math.round(9/Math.max(R,1))):9};T.Mvd=0;Object(vc.a)(T,"TouchGrippie",Uf.a,[]);vm(ba,H);ba.prototype.dispose=function(){pg.a.rc([this.aP,this.uM]);this.aP.TQf(this.XEf);this.aP.SQf(this.hnc);this.aP.UQf(this.inc);
this.uM.TQf(this.pvf);this.uM.SQf(this.hnc);this.uM.UQf(this.inc);for(var R=yl(this.gridView.nn),Aa=R.next();!Aa.done;Aa=R.next())Aa=Aa.value,Fd.a.instance.za(Ye.a.Hf,Aa.domElement,this.jzf),Fd.a.instance.za(Ye.a.ye,Aa.domElement,this.izf);this.gridView.view.Nq(this.yw);this.gridView.yc.ol(this.BKe);this.gridView.Nb.uHb(this.Iya);this.gridView.usc(this.dvf);this.gridView.$.mD(this.Zqc);this.gridView.pt(this.Zqc);this.ha.m0(this.Yh);this.ha.rda(this.tr);this.gridView.UF(this.lp);this.ha.xsc(this.azf);
Pf.a.cRf(this.DDb);this.uba&&Tc.ULS.sendTraceTag(537159314,0,15,"SelectionTouchGrippiesBehaviorBase.Dispose during autofill mode");(R=this.gridView.$.da.Aa(376))&&R.rej(this.YEf);H.prototype.dispose.call(this)};ba.prototype.dSa=function(){if(!this.eba.range||!this.eba.range.equals(this.acb))return!1;var R=!this.gridView.zMa();return this.gridView.isEditing&&R&&(this.acb.isRow||this.acb.Sh)?!1:this.uba?!0:3===Pf.a.$b};ba.prototype.U4=function(){this.Znb&&(this.aP.set_visible(!1),this.uM.set_visible(!1),
this.Znb=!1)};ba.prototype.Qna=function(){if(this.dSa()){this.KTj();var R=Ud.DOMElementExtensions.getBoundingClientRect(this.l_a);R||Tc.ULS.shipAssertTag(537159313,0,!1,"grippiesParentBounds is null. IsNamedObjectViewMode: {0}, isNov15: {1}, areGrippiesAttachedToNovFocusPane: {2}GridView.ContainerElement: {3}, Freezepanes: {4}",this.gridView.$.ea.isNamedObjectViewMode,this.zpd,this.m_b,this.gridView.xj,this.gridView.$a.aj);var Aa=Ud.DOMElementExtensions.getBoundingClientRect(this.ynj),hb=new Sys.UI.Bounds(Aa.x-
R.x,Aa.y-R.y,Aa.width,Aa.height),Ib=this.acb,Bc=Ib.topLeft,gc=Ib.bottomRight,Id=Ib.isRow||Ib.Sh;if(Ib.Sh){var fe=this.JCh();Ib=hb.x-2*T.Hub(this.gridView);var sf=fe;var hg=hb.x+Aa.width}else Ib.isRow?(Ib=hg=this.ICh(),sf=hb.y-2*T.Hub(this.gridView),fe=hb.y+Aa.height):(sf=hb.y,fe=hb.y+Aa.height,this.gridView.rtl?(Ib=hb.x+Aa.width,hg=hb.x):(Ib=hb.x,hg=hb.x+Aa.width));Aa=T.Mvd+(Id?0:T.Hub(this.gridView));this.aP.style.left=Fe.HelperMethods.Qb(Ib-Aa);this.aP.style.top=Fe.HelperMethods.Qb(sf-Aa);this.uM.style.left=
Fe.HelperMethods.Qb(hg-Aa);this.uM.style.top=Fe.HelperMethods.Qb(fe-Aa);this.aP.set_visible(this.Qef(sf,Ib,Bc,Id,R));this.uM.set_visible(this.Qef(fe,hg,gc,Id,R));this.Znb=!0}};ba.prototype.Qef=function(R,Aa,hb,Ib,Bc){var gc=Ud.DOMElementExtensions.getBoundingClientRect(this.gridView.Sf(this.paneType).domElement);Bc=new Sys.UI.Bounds(gc.x-Bc.x-3,gc.y-Bc.y-3,gc.width+6,gc.height+6);return(this.gridView.$a.oj(hb)===this.paneType||Ib)&&ze.a.fB(Bc,new Sys.UI.Point(Aa,R))};ba.prototype.KTj=function(){if(this.zpd!==
this.m_b){this.l_a=null;var R=this.bbd();this.aP.ieg(R);this.uM.ieg(R)}};ba.prototype.JCh=function(){return(this.gridView.view.visibleArea.height+this.gridView.$a.height+T.Mvd-T.Hub(this.gridView))/2};ba.prototype.ICh=function(){return(this.gridView.view.visibleArea.width+this.gridView.$a.width+T.Mvd-T.Hub(this.gridView))/2};ba.prototype.aDf=function(){this.Qna()};ba.prototype.nii=function(R){return Ud.DOMElementExtensions.rIb(R.Tb,cg.a.Tk)&&(this.pji(R)||this.qji(R))};ba.prototype.qji=function(R){if(this.gridView.rtl)R=
R.clientPoint.x;else{var Aa=Ud.DOMElementExtensions.getBoundingClientRect(R.Tb);R=R.clientPoint.x-(Aa.x+Aa.width-we.a.gq)}return 0<R&&R<=we.a.gq};ba.prototype.pji=function(R){var Aa=Ud.DOMElementExtensions.getBoundingClientRect(R.Tb);R=R.clientPoint.y-(Aa.y+Aa.height-we.a.gq);return 0<R&&R<=we.a.gq};ba.prototype.kzf=function(R,Aa){this.uba&&Tc.ULS.sendTraceTag(537159312,0,50,"SelectionTouchGrippiesBehaviorBase: Performing Touch Autofill");this.ha.k_c(R,Aa,this.uba);this.U4()};ba.prototype.Xpj=function(){this.uba||
(Tc.ULS.sendTraceTag(537159311,0,50,"SelectionTouchGrippiesBehaviorBase.SetAutoFillMode"),this.uba=!0,this.aP.SYf(),this.uM.SYf(),this.gridView.ha.sourceRange=this.gridView.ha.va.Sd,this.Qna())};ba.prototype.GXd=function(){this.uba&&(Tc.ULS.sendTraceTag(537159310,0,50,"SelectionTouchGrippiesBehaviorBase.UnsetAutoFillMode"),this.uba=!1,this.aP.wcg(),this.uM.wcg())};ba.prototype.bbd=function(){if(!this.l_a){this.m_b=!1;if(this.zpd){var R=this.gridView.$.da.Aa(22);if(R)return this.m_b=!0,this.l_a=R.Jx}this.l_a=
this.gridView.xj}return this.l_a};Sk.Object.defineProperties(ba.prototype,{gridView:{configurable:!0,enumerable:!0,get:function(){return this.Dy}}});Object(vc.a)(ba,"SelectionTouchGrippiesBehaviorBase",H,[]);vm(la,ba);la.prototype.dSa=function(){var R=this.gridView.Ci||this.gridView.isEditing;return!this.gridView.ha.va.qh&&!R&&ba.prototype.dSa.call(this)};Sk.Object.defineProperties(la.prototype,{X4:{configurable:!0,enumerable:!0,get:function(){return 19}},acb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.va.activeRange}}});
Object(vc.a)(la,"DiscontinuousSelectionTouchGrippiesBehavior",ba,[]);var dg=b(307);vm(Q,H);Object(vc.a)(Q,"SelectionBorderBehavior",H,[]);U.Cxh="ewr-selection-draghandle";U.Fxh="ewr-selection-draghandle-grab";U.Lxh="ewr-selection-draghandle-top-ie";U.Kxh="ewr-selection-draghandle-top";U.Exh="ewr-selection-draghandle-bottom-ie";U.Dxh="ewr-selection-draghandle-bottom";U.Hxh="ewr-selection-draghandle-left-ie";U.Gxh="ewr-selection-draghandle-left";U.Jxh="ewr-selection-draghandle-right-ie";U.Ixh="ewr-selection-draghandle-right";
U.Mxh="ewr-selection-dragtooltip";U.Nxh="ewr-selection-dragtooltip-updated";U.Yxh="ewr_selection_rearrangeleft";U.Zxh="ewr_selection_rearrangeright";U.$xh="ewr_selection_rearrangetop";U.Xxh="ewr_selection_rearrangebottom";U.selecting="selecting";U.ayh="ewr-selection-resizemarqueehandle";U.dyh="ewr-selection-resizemarqueehandle-topleft";U.eyh="ewr-selection-resizemarqueehandle-topright";U.byh="ewr-selection-resizemarqueehandle-bottomleft";U.cyh="ewr-selection-resizemarqueehandle-bottomright";U.sxh=
"ewr-marquee-thick";U.wxh="ewr-resizemarqueehandle-thick";Object(vc.a)(U,"CssClassNames",null,[]);vm(V,Q);V.prototype.dispose=function(){var R=this;this.vC.forEach(function(Aa){Hd.a.instance.za(Ye.a.pointerDown,Aa,R.onPointerDown)});Array.clear(this.vC);this.Fma=this.sourceRange=this.jd=null;Tc.ULS.sendTraceTag(537159381,0,50,"DragSelectionClickBehaviorBase.Dispose: ActiveRegistrationCount = {0}, EwaControl is null : {1}",this.Hra,!this.$);this.$&&(this.$.pl(this.rd),1===this.Hra&&(Tc.ULS.sendTraceTag(537159380,
0,15,"DragSelectionClickBehaviorBase.Dispose: Some handlers are still registered"),this.CM(this.Vke,this.Wke,!1)));Q.prototype.dispose.call(this)};V.prototype.Og=function(R){R=qf.a(this.$).He(R);return this.NBf(R)};V.prototype.NBf=function(R){if(5!==this.Gu)return!1;(R=this.P9a(R))||this.W8b(!1);jg.b(this.$,!1);return R};V.prototype.qj=function(R){R=qf.a(this.$).He(R);if(this.nr&&this.LBf(R))return!0;if(R=this.ha.xr(R.clientPoint,R.Tb,5,void 0,void 0,!0)){R=this.vpb(R);if(this.jd.equals(R))return!0;
this.jd=R;if(!this.Z7())return Tc.ULS.shipAssertTag(537159378,0,!1,"DragSelectionClickBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),this.W8b(!0),!1}return!0};V.prototype.OW=function(R,Aa){Tc.ULS.shipAssertTag(537159377,0,!this.Hra,"DragSelectionClickBehaviorBase.RegisterHandlersForMouse: More than one active registration is not expected");this.Hra+=1;this.Vke=R;this.Wke=Aa;this.Hp.OW(R,Aa,this.DWd())};V.prototype.vpb=function(R){if(!R||!this.jd)return Tc.ULS.shipAssertTag(537159376,0,
!!R,"DragSelectionClickBehaviorBase.CalculateDragRange: mouseSelectionRange is null"),Tc.ULS.shipAssertTag(537159375,0,!!this.jd,"DragSelectionClickBehaviorBase.CalculateDragRange: CurrentRange is null"),null;var Aa=this.jd.clone();1!==this.m3&&(Aa.left=Math.max(R.left-this.qkd,1),Aa.right=Aa.left+this.sourceRange.width-1);2!==this.m3&&(Aa.top=Math.max(R.top-this.PZd,1),Aa.bottom=Aa.top+this.sourceRange.height-1);return this.xZb(Aa)};V.prototype.CM=function(R,Aa,hb,Ib){hb=void 0===hb?!0:hb;Ib=void 0===
Ib?!0:Ib;Tc.ULS.shipAssertTag(537159374,0,1===this.Hra,"DragSelectionClickBehaviorBase.CleanUp: Expected exactly one active registration");--this.Hra;this.nr||ce.g(this.$).Hh.hu(dd.a.Zaa);this.Hp.BXd(R,Aa,this.DWd());hb&&this.Zye(Ib);this.m3=0;this.HSa=!1};V.prototype.xZb=function(R){var Aa=ce.g(this.$),hb=R;if(Aa.$a.P4){if(!Aa.uc(R.topLeft)){Aa=Aa.xl("DragSelectionClickBehaviorBase.AdjustHiddenRowColumns",Aa.mH,this.Fma.top!==R.top?1:2);try{Aa.Uk=this.Fma.top<R.top||this.Fma.left<R.left,Aa.Zu(R.topLeft),
hb=Aa.$$cu().range}finally{Aa&&Aa.dispose()}}hb.right=hb.left+R.width-1;hb.bottom=hb.top+R.height-1}return this.Fma=hb};V.prototype.wOd=function(R){this.vC.forEach(function(Aa){Ud.DOMElementExtensions.setVisible(Aa,R)})};V.prototype.fUh=function(R){var Aa=R.Tb;R=R.clientPoint;if(!Aa||!R)return Tc.ULS.shipAssertTag(537159373,0,!!Aa,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: source is null"),Tc.ULS.shipAssertTag(537159372,0,!!R,"DragSelectionClickBehaviorBase.GetMouseSelectionRange: point is null"),
null;R.y+=Aa===this.vC[V.U6b]?2:Aa===this.vC[V.dKe]?-2:0;R.x+=Aa===this.vC[V.fKe]?2:Aa===this.vC[V.T6b]?-2:0;return this.ha.xr(R,Aa,5,void 0,void 0,!0)};Sk.Object.defineProperties(V.prototype,{Nb:{configurable:!0,enumerable:!0,get:function(){return ce.g(this.$).Nb}},Gu:{configurable:!0,enumerable:!0,get:function(){return this.ha.selectionType},set:function(R){this.ha.selectionType=R}}});V.aKe="move";V.B7c="grabbing";V.U6b=0;V.dKe=1;V.fKe=2;V.T6b=3;Object(vc.a)(V,"DragSelectionClickBehaviorBase",Q,
[]);vm(D,V);D.prototype.WYa=function(R){this.Hp.QJb(R,this.vC);this.Wx.Uza()};D.prototype.DBf=function(R){Tc.ULS.sendTraceTag(537159390,0,50,"DragMarqueeClickBehavior.OnPointerDownInternal: Starting drag marquee operation.");this.gridView.zLa=!0;this.Ya.iE(!1);this.Gu=5;this.Wx.gKe(R.Tb);this.Ya.textBox.removeSelection();this.Ya.VYb(this.a7e);this.OW(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"));this.m3=this.sourceRange.isRow?1:this.sourceRange.Sh?2:0};D.prototype.P9a=
function(){var R=this.Sda();this.Gu=-1;this.CM(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"));return R};D.prototype.Zye=function(){this.gridView.zLa=!1;this.Wx.hKe(this.vC[0]);this.Ya.textBox.setCaretPositionToEnd();this.Ya.Gsc(this.a7e);this.Hp.rNf()};D.prototype.W8b=function(R){Tc.ULS.sendTraceTag(537159389,0,10,"DragMarqueeClickBehavior.FailureFallback: Operation failed, will try to recalculate colored references as a fallback in CleanUp.");R&&this.CM(Object(hd.a)(this,
this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"))};D.prototype.Ugd=function(R){this.Ya=this.Hp.hdd();this.sL=this.Hp.l3e(R);return this.Ya&&this.sL&&this.sL.range?this.sL.range:(Tc.ULS.shipAssertTag(537159388,0,!!this.Ya,"DragMarqueeClickBehavior.GetSelectedRange: cellContentEditor is null"),Tc.ULS.shipAssertTag(537159387,0,!!this.sL,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState is null"),Tc.ULS.shipAssertTag(537159386,0,!!this.sL.range,"DragMarqueeClickBehavior.GetSelectedRange: selectedHighlightState.Range is null"),
null)};D.prototype.Sda=function(){return this.sL?this.coloredReferencesManager.srf(this.Ya,this.sL,this.jd):(Tc.ULS.shipAssertTag(537159385,0,!1,"DragMarqueeClickBehavior.SetSelectedRange called when selectedHighlightState is null. It shouldn't be null while dragging a marquee highlight."),!1)};D.prototype.Z7=function(){return this.Sda()};D.prototype.DWd=function(){return!0};D.prototype.LBf=function(){return!1};Object(vc.a)(D,"DragMarqueeClickBehavior",V,[]);var Jg=b(911),Ug=b(831),Xh=b(114);Object(vc.a)(v,
"MacroRecorderTableRowColumnRearrangedPayload",null,[147]);vm(J,V);J.prototype.dispose=function(){this.ha&&(this.ha.rda(this.tr),this.ha.m0(this.Yh),this.ha.qRf(this.qDf),this.ha.jL(this.nd));if(this.Go)for(var R=1;4>=R;R++)Ud.DOMElementExtensions.Tf(this.Go[R.toString()]);this.Go=this.Fu=null;this.YZ&&this.QAc();this.nr&&this.ZZ&&this.QAc(1);V.prototype.dispose.call(this)};J.prototype.DBf=function(R){this.nr&&(this.Mca=R,this.cea=null,this.wR=this.isRow=this.Sh=this.xR=!1,Fg.KeyInputManager.instance.qa(Ye.a.Sb,
this.domElement.ownerDocument.body,this.onKeyDown));this.JH=!0;this.tableRange=this.$Tg(this.tableManager.En(this.sourceRange.topLeft));ce.g(this.$);this.tableRange&&!this.tableRange.equals(this.sourceRange)?this.nr?(this.cea=this.tableRange,this.OJ=1,this.Fu=(this.wR=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Gu=6,this.OW(this.N9a,this.Q9a),this.DIa=this.V6b,this.YRa=this.Lwc,this.Gna(R.clientPoint,R.Tb,this.wR?11:12,!0,!0),this.GTa(!0)):
(this.Fu=(this.isRow=this.tableRange.left===this.sourceRange.left&&this.tableRange.right===this.sourceRange.right)?[11]:[12],this.Gu=6,this.OW(this.N9a,this.Q9a),this.Gna(R.clientPoint,R.Tb,this.isRow?11:12,!0)):(this.tableRange=null,this.nr?(this.isRow=this.sourceRange.isRow,this.Sh=this.sourceRange.Sh,this.isRow||this.Sh?(this.OJ=3,this.m3=this.isRow?1:2,this.Gu=6,this.Fu=this.isRow?[11]:[12],this.OW(this.WDb,this.XDb),this.DIa=this.V6b,this.YRa=this.Lwc,this.Gna(R.clientPoint,R.Tb,this.isRow?11:
12,!0,!0),this.GTa(!0)):(this.OJ=2,this.m3=0,this.OW(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp")),this.DIa=this.iKe,this.YRa=this.Z1f,this.Gna(R.clientPoint,R.Tb,this.Gac(),!1,!0),this.Z7(!0))):(this.OW(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp")),Fg.KeyInputManager.instance.qa(Ye.a.Sb,this.domElement.ownerDocument.body,this.onKeyDown),this.m3=this.sourceRange.isRow?1:this.sourceRange.Sh?2:0,this.Gna(R.clientPoint,R.Tb,
this.Gac(),!1),this.Z7()))};J.prototype.P9a=function(){this.JH=!1;this.nr&&(this.OJ=0);this.Nb.ll(this.Dja());if(!this.$.Ns([this.jd],!1))return this.CM(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp")),this.Gu=-1,!0;if(this.ha.va.Sd.equals(this.jd)||this.Uec(this.jd)||this.Uec(this.sourceRange))this.Gu=-1;else{this.Sda();this.ha.sourceRange=this.sourceRange.clone();var R=this.ha.sourceRange,Aa=this.ha.va.Sd;if(this.nr){var hb={};this.$.xe(-694765314,2,30,(hb[dd.a.jsb]=
this.YZ,hb[dd.a.Wta]=R,hb[dd.a.Vta]=Aa,hb[dd.a.x7c]=this.ZZ,hb))}else hb={},this.$.xe(-694765314,2,30,(hb[dd.a.jsb]=this.YZ,hb[dd.a.Wta]=R,hb[dd.a.Vta]=Aa,hb))}!this.nr&&this.tableRange||this.CM(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"));return!0};J.prototype.Zye=function(R){R&&(Fg.KeyInputManager.instance.za(Ye.a.Sb,this.domElement.ownerDocument.body,this.onKeyDown),this.nr&&ce.g(this.$).Hh.hu(dd.a.Zaa),this.JH=!1);for(R=1;4>=R;R++){var Aa=this.Go[R.toString()];
Aa&&Aa.parentNode.removeChild(Aa);this.Go[R.toString()]=null}this.Fu=null};J.prototype.LBf=function(R){var Aa=this.ha.xr(R.clientPoint,R.Tb,5,void 0,void 0,!0);this.Mca=R;return this.i8e(Aa)?(this.jd=this.EZc(Aa),this.z6e(!0),!0):this.h6h(Aa)?(this.jd=this.vpb(Aa),this.A6e(!0),!0):!1};J.prototype.i8e=function(R){return!!this.cea&&1!==this.OJ&&!!R&&this.cea.contains(R.topLeft)};J.prototype.h6h=function(R){return!!this.cea&&1===this.OJ&&!!R&&!this.cea.contains(R.topLeft)};J.prototype.z6e=function(R){this.tableRange=
this.cea;this.OJ=1;var Aa=!this.ZZ;R?(this.Msa(!1),this.Fu=this.wR?[11]:[12],this.VOf(Aa),this.GTa(Aa)):(this.Spb(!1),this.DGb(Aa),this.Z7(Aa))};J.prototype.A6e=function(R){this.tableRange=null;this.OJ=2;var Aa=!this.ZZ;R?(this.Msa(!1),this.Fu=this.wR?[11]:[12],this.xR=this.wR,this.RHd(Aa),this.GTa(Aa)):(this.q0c(!1),this.DGb(Aa),this.Z7(Aa))};J.prototype.Ugd=function(){return this.ha.va.Sd};J.prototype.Sda=function(){this.ha.updateSelection(this.jd,this.jd.topLeft,0);return!0};J.prototype.Z7=function(R){R=
void 0===R?!1:R;this.Nb.Nl(this.jd,this.Dja());this.Nb.ys(this.Dja());this.lX(R);return!0};J.prototype.GTa=function(R){R=void 0===R?!1:R;this.Nb.Nl(this.jd,this.Fu);this.Nb.ys(this.Fu);this.lX(R)};J.prototype.W8b=function(){Tc.ULS.sendTraceTag(537159384,0,15,"DragSelectionClickBehavior.FailureFallback: this function was not implemented for dragging selection")};J.prototype.DWd=function(){return!1};J.prototype.pzj=function(){if(!ce.g(this.$).ha.va.qh)return!1;var R=ce.g(this.$).getRangeInformation(this.ha.va.Sd);
R=yl(R);for(var Aa=R.next();!Aa.done;Aa=R.next())if(Object(nc.a)(Je.PivotTableRange,Aa.value))return!1;return!0};J.prototype.$Tg=function(R){if(R&&R.contains(this.sourceRange)&&!R.equals(this.sourceRange)){if(R.Xva&&this.sourceRange.bottom===this.sourceRange.top&&this.sourceRange.top===R.top){var Aa=new bf.Range(this.sourceRange.top,this.sourceRange.left,R.bottom,this.sourceRange.right,!1,!1);if(!Aa.equals(R))return this.sourceRange=Aa,this.ha.updateSelection(this.sourceRange,this.sourceRange.topLeft,
0),R}this.nr?this.wR=R.left===this.sourceRange.left&&R.right===this.sourceRange.right:this.isRow=R.left===this.sourceRange.left&&R.right===this.sourceRange.right;if(R.top===this.sourceRange.top&&R.bottom===this.sourceRange.bottom||this.E5())return R}return null};J.prototype.EZc=function(R){var Aa=R.clone();this.E5()?Aa.left=Math.max(R.left-this.qkd,1):Aa.top=Math.max(R.top-this.PZd,1);Aa.right=Aa.left+this.sourceRange.width-1;Aa.bottom=Aa.top+this.sourceRange.height-1;return this.xZb(Aa)};J.prototype.jgf=
function(){var R=this.jd.topLeft.Qd(this.sourceRange);return R||this.nr&&!this.tableRange?R:this.E5()?this.jd.top===this.sourceRange.bottom+1:this.jd.left===this.sourceRange.right+1};J.prototype.r7i=function(){if(this.E5()&&this.jd.left!==this.tableRange.left||!this.E5()&&this.jd.top!==this.tableRange.top){var R=dh.a.hd(1,1,0,887,0,2065438552,"RearrangeInvalidDest");td.a(this.$).nv([R]);return!0}return!1};J.prototype.L2i=function(){var R=this,Aa=this.$.Vb.Hc("UserAction","RearrangeRowColumnClientSide"),
hb={},Ib=(hb.CopyPasteTargetType=1,hb.OperationId=rh.a.create().toString(),hb.Stopwatch=Aa,hb.DragDropIsShiftKeyDown=this.ZZ,hb.EncounteredDeploymentErrors=!1,hb),Bc=this.YZ?2:1,gc=this.$.da.Aa(254);(new Promise(function(Id,fe){R.lSe(function(sf){sf.Errors&&0<sf.Errors.length?fe(new Jg.a(22,sf.Errors)):Id(!0)},function(sf){sf=Xh.a.og(sf.data);fe(new Jg.a(22,sf))})})).then(function(){Tc.ULS.sendTraceTag(537159383,0,50,'DragSelectionClickBehavior.RearrangeRowColumn: success. copyPasteTargetType="{0}"',
1);gc&&gc.swi(Ib,Bc,R.sourceRange,R.jd);return Promise.resolve(!0)},function(Id){Tc.ULS.sendTraceTag(537159382,0,10,'DragSelectionClickBehavior.RearrangeRowColumn: {0}, copyPasteTargetType="{1}"',Id?copyPasteInfra.getStringifiedError(Id):"null",1);return gc?gc.tRi(Id,Ib,Bc,R.sourceRange,R.jd):Promise.reject(Id)})};J.prototype.lSe=function(R,Aa){function hb(){return new v(Id,gc)}function Ib(fe,sf,hg){var $f=Bc.$.na.ta;fe=R?Ah.b(fe,R):fe;sf=Aa?Ah.a(sf,Aa):sf;var th=$f.Na(41,null);th.sourceRange=Id;
th.destinationRange=gc;return Kh.i($f,"RearrangeRowColumn",th,fe,sf,hg,null,0)}var Bc=this;R=void 0===R?null:R;Aa=void 0===Aa?null:Aa;var gc={};this.E5()?(gc.FirstRow=this.jd.top-1,gc.FirstColumn=0,gc.DeltaColumn=0,gc.DeltaRow=this.jd.bottom-this.jd.top+1):(gc.FirstRow=0,gc.FirstColumn=this.jd.left-1,gc.DeltaColumn=this.jd.right-this.jd.left+1,gc.DeltaRow=0);gc.LastRow=Oe.a.rz;gc.LastColumn=Oe.a.uw;gc.SheetName=this.$.xa.pa?this.$.xa.pa.name:this.$.zb.getItemByName(this.$.zb.pa.name).sheetName;var Id=
Bf.v(this.sourceRange,this.$);ac.EwaSettings.sc()?this.$.userOperationManager.hc(new ch.a(514,0,Ib,64,hb),null):this.$.userOperationManager.hc(new pf.a(514,0,Ib,void 0,hb),null)};J.prototype.Uec=function(R){R=ce.g(this.$).getRangeInformation(R);for(var Aa=0,hb=R.length;Aa<hb;++Aa)if(Object(nc.a)(Je.PivotTableRange,R[Aa]))return R=dh.a.hd(1,0,0,882,0,2105176604,"InsDelCellsPivotTable"),td.a(this.$).nv([R]),!0;return!1};J.prototype.Gna=function(R,Aa,hb,Ib,Bc){Bc=void 0===Bc?!1:Bc;var gc=Ud.DOMElementExtensions.getBoundingClientRect(Aa),
Id=Aa===this.vC[V.U6b]||Aa===this.vC[V.dKe];if(this.nr){var fe=Aa===this.vC[V.fKe]||Aa===this.vC[V.T6b];this.isRow&&fe||this.Sh&&Id?fe="100px":(Id=this.isRow||Id,fe=(Id?Bc?J.nMj:J.sMj:Bc?J.mMj:J.pMj)+"px");Aa=Id?Aa===this.vC[V.U6b]?"top":"bottom":Aa===this.vC[V.T6b]?"right":"left";R=100*(Id?R.x-gc.x:R.y-gc.y)/(Id?gc.width:gc.height);for(gc=1;4>=gc;gc++){Ib=document.createElement("div");var sf=document.createElement("div"),hg=document.createElement("div");Ib.appendChild(sf);Ib.appendChild(hg);Bc&&
(sf=document.createElement("div"),Ib.appendChild(sf),hg.style.fontWeight="bold");Ib.className=U.Nxh;this.Go[gc.toString()]=Ib;this.Nb.ZE(hb,gc).Cg.appendChild(Ib);Ib=this.Go[gc.toString()];Ib.style[Aa]=fe;Ib.style[Id?"left":"top"]=R+"%"}}else for(Bc=(Id?-J.rMj:-J.oMj)+"px",fe=Id?Aa===this.vC[V.U6b]?"top":"bottom":Aa===this.vC[V.T6b]||Ib?"right":"left",Aa=100*(Id?Ib?0:R.x-gc.x:R.y-gc.y)/(Id?gc.width:gc.height),R=1;4>=R;R++)gc=document.createElement("div"),gc.className=U.Mxh,this.Go[R.toString()]=gc,
this.Nb.ZE(hb,R).Cg.appendChild(gc),gc=this.Go[R.toString()],gc.style[fe]=Bc,gc.style[Id?"left":"top"]=Aa+"%"};J.prototype.lX=function(R){R=void 0===R?!1:R;var Aa=this.jd.toString();if(this.nr)for(var hb=1;4>=hb;hb++)this.Go[hb.toString()].childNodes[0].innerText=Aa,this.Go[hb.toString()].childNodes[1].innerText=this.DIa,R&&(this.Go[hb.toString()].childNodes[2].innerText=this.YRa);else for(R=1;4>=R;R++)this.Go[R.toString()].innerText=Aa};J.prototype.QAc=function(R){R=void 0===R?0:R;0===R?this.YZ=
!1:1===R&&(this.ZZ=!1);this.nr&&(this.YZ||this.ZZ)||(Fg.KeyInputManager.instance.za(Ye.a.Wd,this.domElement.ownerDocument.body,this.onKeyUp),this.cpd=!1)};J.prototype.Msa=function(R){this.Nb.ll(this.Dja());this.CM(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"),void 0,R)};J.prototype.Spb=function(R){this.Nb.ll(this.Fu);this.CM(this.WDb,this.XDb,void 0,R)};J.prototype.q0c=function(R){this.Nb.ll(this.Fu);this.CM(this.N9a,this.Q9a,void 0,R)};J.prototype.DGb=function(R){R=
void 0===R?!1:R;this.Gu=5;this.OW(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"));this.DIa=this.iKe;this.YRa=this.Z1f;this.Gna(this.Mca.clientPoint,this.Mca.Tb,this.Gac(),!1,R)};J.prototype.RHd=function(R){R=void 0===R?!1:R;this.Gu=6;this.OW(this.WDb,this.XDb);this.DIa=this.V6b;this.YRa=this.Lwc;this.Gna(this.Mca.clientPoint,this.Mca.Tb,this.isRow||this.wR?11:12,!0,R)};J.prototype.VOf=function(R){R=void 0===R?!1:R;this.Gu=6;this.OW(this.N9a,this.Q9a);this.DIa=
this.V6b;this.YRa=this.Lwc;this.Gna(this.Mca.clientPoint,this.Mca.Tb,this.E5()?11:12,!0,R)};J.prototype.Kfc=function(R){return R.Ea.keyCode===va.a.LBa||af.a.isMac&&R.Ea.keyCode===va.a.nfb};J.prototype.E5=function(){return!this.nr&&this.isRow||this.nr&&this.wR};J.prototype.Gac=function(){return this.nr?45:6};J.prototype.Dja=function(){return this.nr?J.Vhh:J.Yhh};J.oMj=50;J.rMj=25;J.pMj=-85;J.sMj=-40;J.mMj=-120;J.nMj=-50;J.VCe="copy";J.Yhh=[6];J.Vhh=[45];Object(vc.a)(J,"DragSelectionClickBehavior",
V,[]);vm(r,Q);r.prototype.dispose=function(){Hd.a.instance.za(Ye.a.pointerDown,this.waa,this.onPointerDown);W.a.instance.za(Ye.a.hk,this.waa,this.rca);this.gridView.$&&(this.gridView.ha.rda(this.tr),this.gridView.ha.m0(this.Yh),this.gridView.$.pl(this.rd),this.gridView.$.Ab.Tsc(this.z6),this.gridView.$.Ab.Ssc(this.y6),this.gridView.BQf(this.gDb),this.gridView.pc.ol(this.czf),this.gridView.pc.Pn(this.bzf));Q.prototype.dispose.call(this)};Object(vc.a)(r,"FillHandleClickBehavior",Q,[]);vm(C,H);Sk.Object.defineProperties(C.prototype,
{Jva:{configurable:!0,enumerable:!0,get:function(){return this.Opg}}});C.Nxe=[1,2,32,256,128,64];Object(vc.a)(C,"IPadSelectionClickThroughBehavior",H,[]);u.prototype.dispose=function(){this.gridView.ha.rda(this.tr);this.gridView.ha.m0(this.Yh);this.gridView.ha.qRf(this.Yh)};u.prototype.Uza=function(){this.i5a=0;this.vgc=!1;this.L5=Number.NaN};u.prototype.l$e=function(R){this.mBc(R.Tb,1);return!0};u.prototype.m$e=function(R){this.mBc(R.Tb,-1);return!0};u.prototype.gKe=function(R){this.vgc=!0;this.mBc(R,
1)};u.prototype.hKe=function(R){this.vgc=!1;this.mBc(R,-1)};u.prototype.mBc=function(R,Aa){if(R)if(R.parentNode)if(this.Uod)isNaN(this.L5)||(this.ABc(this.L5,!1),this.L5=Number.NaN);else if(R=parseInt(R.parentNode.getAttribute(dd.a.Cxb),10),isNaN(R))Tc.ULS.shipAssertTag(537159366,0,!1,"MarqueeHoveringManager.UpdateMarqueeStyle: indexInMarqueeCollection is not a valid number.");else{if(!isNaN(this.L5)&&R!==this.L5){if(this.vgc)return;this.ABc(this.L5,!1)}if(isNaN(this.L5)||R!==this.L5)this.L5=R,this.i5a=
0;!this.i5a&&0<Aa&&this.ABc(R,!0);this.i5a=Math.max(this.i5a+Aa,0);!this.i5a&&0>Aa&&(this.ABc(R,!1),this.L5=Number.NaN)}else Tc.ULS.shipAssertTag(537159367,0,!!R.parentNode,"MarqueeHoveringManager.UpdateMarqueeStyle: handle.ParentNode is null.");else Tc.ULS.shipAssertTag(537159368,0,!!R,"MarqueeHoveringManager.UpdateMarqueeStyle: handle is null.")};u.prototype.ABc=function(R,Aa){for(var hb=1;4>=hb;hb++){var Ib=this.gridView.Nb.ZE(3,hb,R).Cg;Ud.DOMElementExtensions.toggleCssClass(Ib,U.sxh,Aa);for(Ib=
Ib.firstChild;Ib;Ib=Ib.nextSibling)If.a.contains(Ib.className,"resizemarqueehandle",!0)&&Ud.DOMElementExtensions.toggleCssClass(Ib,U.wxh,Aa)}};Object(vc.a)(u,"MarqueeHoveringManager",null,[]);var Ef=b(962),Th=b(1245);vm(z,H);z.prototype.dispose=function(){Hd.a.instance.za(Ye.a.AW,this.nK,this.HBf);Hd.a.instance.za(Ye.a.hy,this.nK,this.wca);Hd.a.instance.za(Ye.a.pointerDown,this.nK,this.onPointerDown);Pg.a.instance.za(Ye.a.click,this.nK,this.JDb);Pg.a.instance.za(Ye.a.hk,this.nK,this.onDoubleClick);
Ud.DOMElementExtensions.Tf(this.AH);this.AH=null;Ud.DOMElementExtensions.Tf(this.nK);this.Tu=this.nK=null;H.prototype.dispose.call(this)};z.prototype.WYa=function(R){this.Tu=Object(xf.a)(Th.a,R.metadata)};Object(vc.a)(z,"RangeCatchUpActivityHighlightBehavior",H,[]);vm(B,ba);B.prototype.dSa=function(){return(this.gridView.inRangePicker||this.gridView.Ci)&&ba.prototype.dSa.call(this)};Sk.Object.defineProperties(B.prototype,{X4:{configurable:!0,enumerable:!0,get:function(){return 16}},acb:{configurable:!0,
enumerable:!0,get:function(){return this.gridView.ha.rangePicker.kdd(!1)}}});Object(vc.a)(B,"RangePickerTouchGrippiesBehavior",ba,[]);vm(t,H);Object(vc.a)(t,"RearrangeHighlightBehavior",H,[]);var sh;(function(R){R[R.topLeft=0]="topLeft";R[R.topRight=1]="topRight";R[R.bottomLeft=2]="bottomLeft";R[R.bottomRight=3]="bottomRight";R[R.error=4]="error"})(sh||(sh={}));Object(vc.b)("Corner",sh);vm(y,H);y.prototype.dispose=function(){var R=this;this.oL.forEach(function(Aa){Hd.a.instance.za(Ye.a.pointerDown,
Aa,R.onPointerDown)});Array.clear(this.oL);H.prototype.dispose.call(this)};y.prototype.WYa=function(R){this.eba=R;this.rpe(R);this.Hp.QJb(R,this.oL,this.eRd());this.Wx.Uza()};y.prototype.qj=function(R){R=qf.a(this.$).He(R);R=this.b1e(R,!1);if(!R)return!0;R=this.GEe(R);if(!R)return Tc.ULS.shipAssertTag(537159327,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: newMarqueeRange is null"),this.D9b(!0),!1;if(this.jd.equals(R))return!0;this.jd=R;R=this.Z7();R||(Tc.ULS.shipAssertTag(537159326,0,!1,"ResizeMarqueeBehaviorBase.OnPointerMove: UpdateHighlightOnMove failed"),
this.D9b(!0));return R};y.prototype.Og=function(R){var Aa=this;R=qf.a(this.$).He(R);R=this.Sda();Tc.ULS.shipAssertTag(537159325,0,R,"ResizeMarqueeBehaviorBase.OnPointerUp: SetSelectedRange failed");af.a.cB&&(this.ha.cec(!0),window.setTimeout(function(){Aa.ha.cec(!1)},100));this.D9b(!R);return R};y.prototype.b1e=function(R,Aa){var hb=R.Tb;R=R.clientPoint;if(!hb||!R)return Tc.ULS.shipAssertTag(537159324,0,!!hb,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: source is null"),Tc.ULS.shipAssertTag(537159323,
0,!!R,"ResizeMarqueeBehaviorBase.GetMouseSelectionRange: point is null"),null;Aa&&(R=this.urf(R));Aa=this.ha.xr(R,hb,0,!0,!1,!0);Aa||(R=this.urf(R),Aa=this.ha.xr(R,hb,0,!0,!1,!0));return Aa};y.prototype.urf=function(R){R.y+=0===this.y3||1===this.y3?2:-2;R.x+=0===this.y3||2===this.y3?2:-2;return R};y.prototype.GEe=function(R){if(!R||!this.sourceRange)return Tc.ULS.shipAssertTag(537159322,0,!!R,"ResizeMarqueeBehaviorBase.CreateNewRange: newCorner is null"),Tc.ULS.shipAssertTag(537159321,0,!!this.sourceRange,
"ResizeMarqueeBehaviorBase.CreateNewRange: sourceRange is null"),null;if(0===this.y3)return new bf.Range(R.top,R.left,this.sourceRange.bottom,this.sourceRange.right,!0,!1);if(1===this.y3)return new bf.Range(R.top,this.sourceRange.left,this.sourceRange.bottom,R.right,!0,!1);if(2===this.y3)return new bf.Range(this.sourceRange.top,R.left,R.bottom,this.sourceRange.right,!0,!1);if(3===this.y3)return new bf.Range(this.sourceRange.top,this.sourceRange.left,R.bottom,R.right,!0,!1);Tc.ULS.shipAssertTag(537159320,
0,!1,"ResizeMarqueeBehaviorBase.CreateNewRange: currentFixedCorner is not valid: {0}",sh[this.y3]);return null};y.prototype.Sda=function(){return this.coloredReferencesManager.srf(this.Ya,this.sL,this.jd)};y.prototype.Z7=function(){return this.Sda()};y.prototype.D9b=function(R){R&&Tc.ULS.sendTraceTag(537159319,0,10,"ResizeMarqueeBehaviorBase.FinishOrAbortOperation: Aborting operation, will try to recalculate colored references as a fallback.");this.Wx.hKe(this.oL[0]);this.Hp.RLf(!1,this.eba.y$);this.Ya.textBox.setCaretPositionToEnd();
this.Ya.Gsc(this.b7e);this.qcg();this.HSa=this.gridView.zLa=!1;jg.b(this.$,!1);this.Hp.rNf()};Object(vc.a)(y,"ResizeMarqueeBehaviorBase",H,[]);vm(x,y);x.prototype.UTf=function(){return[U.dyh,U.eyh,U.byh,U.cyh]};x.prototype.hpe=function(){return[U.ayh]};x.prototype.r_e=function(R){R=R.Tb;if(R===this.oL[0])return 0;if(R===this.oL[1])return 1;if(R===this.oL[2])return 2;if(R===this.oL[3])return 3;Tc.ULS.shipAssertTag(537159318,0,!1,"ResizeMarqueeMouseBehavior.GetFixedCorner: source doesn't match any resize handle.");
return 4};x.prototype.QOf=function(){this.Hp.OW(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"),!0)};x.prototype.qcg=function(){this.Hp.BXd(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"),!0)};x.prototype.C2f=function(R){return 2===(Pf.a.$b=R.yb)&&R.Kn===Sys.UI.MouseButton.leftButton};x.prototype.eRd=function(){return!0};x.prototype.Anf=function(){Tc.ULS.sendTraceTag(537159317,0,50,"ResizeMarqueeMouseBehavior.LogStartOperation: Starting resize marquee operation with mouse.")};
x.prototype.rpe=function(R){for(var Aa=yl(this.oL),hb=Aa.next();!hb.done;hb=Aa.next())hb.value.style.backgroundColor=R.Cg.style.borderColor};Object(vc.a)(x,"ResizeMarqueeMouseBehavior",y,[]);vm(f,y);f.prototype.dispose=function(){Pf.a.cRf(this.DDb);y.prototype.dispose.call(this)};f.prototype.UTf=function(){return[Te.a.kxh,Te.a.jxh]};f.prototype.hpe=function(){var R=ac.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest"),Aa=af.a.Af;R=!R||Aa;return[R?Te.a.wRe:Te.a.vRe,Te.a.x8b,R?Te.a.ixh:
Te.a.w8b]};f.prototype.r_e=function(R){R=R.Tb;if(R===this.oL[0])return 0;if(R===this.oL[1])return 3;Tc.ULS.shipAssertTag(537159316,0,!1,"ResizeMarqueeTouchBehavior.GetFixedCorner: source doesn't match any resize handle.");return 4};f.prototype.QOf=function(){af.a.Vu?this.Hp.OW(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"),!1):this.Hp.B9i(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"))};f.prototype.qcg=function(){af.a.Vu?this.Hp.BXd(Object(hd.a)(this,
this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"),!1):this.Hp.qQj(Object(hd.a)(this,this.qj,"onPointerMove"),Object(hd.a)(this,this.Og,"onPointerUp"))};f.prototype.C2f=function(R){return 3===(Pf.a.$b=R.yb)};f.prototype.eRd=function(){return 3===Pf.a.$b};f.prototype.Anf=function(){Tc.ULS.sendTraceTag(537159315,0,50,"ResizeMarqueeTouchBehavior.LogStartOperation: Starting resize marquee operation with touch.")};f.prototype.rpe=function(){};Object(vc.a)(f,"ResizeMarqueeTouchBehavior",
y,[]);vm(m,H);m.Uqb=function(R,Aa){var hb=document.createElement("div");hb.className=Aa;R.appendChild(hb)};Object(vc.a)(m,"SelectionCutCopyBehavior",H,[]);vm(n,H);Object(vc.a)(n,"SelectionPasteBehavior",H,[]);vm(l,H);l.irb=function(R,Aa){var hb=document.createElement("div");hb.className=Aa;R.appendChild(hb)};Object(vc.a)(l,"SelectionRangePickerBehavior",H,[]);vm(e,ba);e.prototype.dSa=function(){var R=this.gridView.Ci||this.gridView.isEditing;return this.gridView.ha.va.qh&&!R&&ba.prototype.dSa.call(this)};
Sk.Object.defineProperties(e.prototype,{X4:{configurable:!0,enumerable:!0,get:function(){return 0}},acb:{configurable:!0,enumerable:!0,get:function(){return this.gridView.ha.va.Sd}}});Object(vc.a)(e,"SelectionTouchGrippiesBehavior",ba,[]);var Mg=yd.a;vm(c,Mg);c.prototype.dispose=function(){this.gridView.Nb.Dcj(this.tob);this.Wx&&(this.Wx.dispose(),this.Wx=null);Mg.prototype.dispose.call(this)};Object(vc.a)(c,"GridHighlightsBehaviorManager",yd.a,[]);var Hi=kf.a;vm(a,Hi);a.prototype.create=function(){var R=
this;ig.TaskExtensions.Ba(bg.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.ub),function(Aa){R.Fb(R.$.da.Aa(64)||new c(R.$,Aa.result))},this.ma,3)};a.ja=function(R){R.da.Ha(149,new a(R))};Object(vc.a)(a,"GridHighlightsBehaviorManagerFactory",kf.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.GridHighlightsBehavior");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SheetTabBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SvgIconProvider");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Table");
Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.AccessibilitySettings");ie.main();Type.registerNamespace("Common.App.AltTextDialog");Type.registerNamespace("Common.App.NewAndOpen.Core");mc.a.instance.sj(new ld);ee.a.$i('.ewr-selection-draghandle,.ewr-selection-draghandle-grab{position:absolute;cursor:move;background-color:#fff;opacity:.01;z-index:15;pointer-events:auto}.ewr-selection-draghandle-grab{cursor:grab}.ewr-selection-draghandle-top-ie{top:-2px;left:-2px;right:-2px;height:5px}.ewr-selection-draghandle-top{top:-2px;left:-2px;right:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-bottom-ie{right:0;left:-2px;bottom:-2px;height:5px}.ewr-selection-draghandle-bottom{right:0;left:-2px;bottom:-2px;height:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-left-ie{top:0;left:-2px;bottom:0;width:5px}.ewr-selection-draghandle-left{top:0;left:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ewr-selection-draghandle-right-ie{top:0;right:-2px;bottom:0;width:5px}.ewr-selection-draghandle-right{top:0;right:-2px;bottom:0;width:calc(5px/var(--zoom-level-canvas,1))}.ms-core-needIEFilter .ewr-selection-draghandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-selection-dragtooltip{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:18px;font-size:12px;padding-left:2px;padding-right:2px}.ewr-selection-dragtooltip-updated{position:absolute;background-color:#fff;z-index:UndefinedLessParam;border:1px solid #6e7b8a;height:fit-content;width:max-content;font-size:10px;padding-left:2px;padding-right:2px}.ewr_selection_rearrangeleft{border-left:3px solid #217346;position:absolute;height:10px;width:0;left:-2px;top:-4px}.ewr_selection_rearrangeright{border-right:3px solid #217346;position:absolute;height:10px;width:0;right:-5px;top:-4px}.ewr_selection_rearrangetop{border-top:3px solid #217346;position:absolute;width:10px;height:0;top:-2px;left:-4px}.ewr_selection_rearrangebottom{border-bottom:3px solid #217346;position:absolute;width:10px;height:0;bottom:-5px;left:-4px}.ewr-cell-selection-highlight-all.selecting .ewr-selection-draghandle{cursor:unset}.ewr-selection-resizemarqueehandle{position:absolute;width:5px;height:5px;background-color:#217346;border:solid 1px #fff;z-index:16;pointer-events:auto}.ewr-selection-resizemarqueehandle-topleft,.ewr-selection-resizemarqueehandle-topright{top:-4px}.ewr-selection-resizemarqueehandle-bottomleft,.ewr-selection-resizemarqueehandle-bottomright{bottom:-4px}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{cursor:nwse-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{cursor:nesw-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright{cursor:nesw-resize}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright{cursor:nwse-resize}.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomright{left:-4px}.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-topleft,.ewr-grdcontarea-rtl .ewr-selection-resizemarqueehandle-bottomleft,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-topright,.ewr-grdcontarea-ltr .ewr-selection-resizemarqueehandle-bottomright{right:-4px}.ms-core-needIEFilter .ewr-selection-resizemarqueehandle{filter:alpha(opacity=1);-ms-filter:"alpha(opacity=1)"}.ewr-marquee-thick{z-index:calc(10 + 1) !important;border-width:3px !important}.ewr-grdcontarea-ltr .ewr-marquee-thick{margin:-3px 0 0 -3px !important}.ewr-grdcontarea-rtl .ewr-marquee-thick{margin:-3px -3px 0 0 !important}.ewr-resizemarqueehandle-thick{height:6px !important;width:6px !important}');
ee.a.$i('.ewa-stb-uir{background-color:#f5f5f5;height:32px}.grid-visual-refresh .ewa-stb-ltr,.grid-visual-refresh .ewa-stb-rtl{background-color:#f5f5f5}.ewa-stb-drag{cursor:pointer}.ewa-stb-navarea{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-uir .ewa-stb-navarea-dimensions{height:32px}.ewa-stb-ltr .ewa-stb-navarea{left:0}.ewa-stb-rtl .ewa-stb-navarea{right:0}.ewa-stb-navbutton{border:0;padding:0;margin:0;width:27px;height:27px}.ewa-stb-uir .ewa-stb-navbutton{width:24px;height:24px;margin:4px;border-radius:2px}.ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#e1dfdd}.ewa-stb-uir .ewa-stb-navbutton:active{background-color:#bebbb8}.ewa-stb-ltr .ewa-stb-navbutton{float:left}.ewa-stb-rtl .ewa-stb-navbutton{float:right}.ewa-stb-navbutton .clip16x16{display:inline-block;margin:5px 6px 6px 5px}.ewa-stb-uir .ewa-stb-navbutton .clip12x12{display:inline-block;margin:6px}.ewa-stb-uir .cui-disabled svg{fill-opacity:.3}.ewa-stb-navbutton.cui-disabled .cui-img-container{opacity:.3}.ewa-stb-navareaextra{position:relative;flex-shrink:0;top:0;border:0;height:27px;width:auto;padding:0;margin:0;overflow:hidden}.ewa-stb-contentarea{position:relative;flex:0 1 auto;min-width:0%;top:0;left:0;right:0;border:0;height:27px;padding:0;margin:0;white-space:nowrap}.ewa-stb-uir .ewa-stb-contentarea{height:32px}.ewa-stb-uir .ewa-stb-left-scrollable.ewa-stb-contentarea::before{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-uir .ewa-stb-right-scrollable.ewa-stb-contentarea::after{content:"";position:absolute;top:0;left:0;pointer-events:none;background-image:linear-gradient(-90deg,#dcdcdc,transparent 1%);width:100%;height:32px;z-index:1}.ewa-stb-tabarea{position:relative;top:0;height:27px;left:0;right:0}.ewa-stb-uir .ewa-stb-tabarea{height:32px}.ewa-stb-sheettabmoveindicator{position:absolute;top:-4px}.ewa-stb-tabs{display:block;height:27px;list-style:none;left:0;right:0;margin:0;padding:0;overflow-x:scroll;overflow-y:hidden;white-space:nowrap}.ewa-stb-uir .ewa-stb-tabs{height:32px}.ewa-stb-tabs-smooth{scroll-behavior:smooth}@media(prefers-reduced-motion:reduce){.ewa-stb-tabs{scroll-behavior:auto}}.ewa-stb-tabs .tab-active,.ewa-stb-tabs .tab-inactive{background-color:#f6f6f6;background-image:none;border:0 solid #ababab;border-left-width:1px;padding:0;height:22px;margin:2px 0 3px 0;display:inline-block;overflow:hidden;transform:translateX(0);transition:transform .2s}.ewa-stb-tabs .tab-active{border-bottom-width:2px;border-bottom-color:#217346;border-bottom-style:solid;margin:2px 0 3px 0;height:20px;background-color:#f6f6f6;transform:translateX(0);transition:transform .2s}.ewa-stb-uir .tab-active,.ewa-stb-uir .tab-inactive{background-color:#f5f5f5;border:0;margin:0;height:32px}.ewa-stb-uir .tab-hover{background-color:#e1dfdd}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active{background-color:Highlight;forced-color-adjust:none}}.ewa-stb-tabs .tab-active.ewa-stb-tabs-ghost,.ewa-stb-uir .ewa-stb-tabs-ghost{position:fixed;z-index:1000;border-right-width:1px;transition:none}.ewa-stb-tabs .tab-anchor-text{text-decoration:none;white-space:nowrap;height:22px;display:block}.ewa-stb-uir .tab-anchor-text{height:32px}.ewa-stb-tabs .dark{color:#444;white-space:pre;height:18px}.ewa-stb-tabs .light{color:#fff;white-space:pre;height:18px}.ewa-stb-tabs .tab-active-text{color:#217346;height:14px}.ewa-stb-uir .tab-active-text{color:#444;line-height:16px;padding-bottom:5px}.ewa-stb-uir .tab-active .tab-content-container::before{content:"";position:absolute;display:inline-block;top:0;bottom:0;left:0;right:0;color:rgba(0,0,0,0);border-bottom:3px solid #217346;padding-bottom:5px;width:calc(100% - 18px);margin:auto;transition:width 400ms cubic-bezier(.17,.17,0,1) 0s}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active .tab-content-container::before{border-bottom-color:HighlightText}.ewa-stb-uir .tab-active svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-stb-uir .tab-active.tab-hover .tab-content-container:hover::before{width:calc(100%)}.ewa-stb-tabs .tab-text,.ewa-stb-tabs .tab-content-container{white-space:pre;font-size:10pt;display:inline-block;text-align:center;margin-bottom:0}.ewa-stb-tabs .tab-content-container{padding:0 18px 0 18px;margin:0 2px 0 2px}.ewa-stb-uir .tab-content-container{padding:3px 6px 3px 6px;border-radius:2px;margin:2px 3px 2px 3px;font-size:14px}.ewa-stb-tabs .cui-img-container{top:1px}.ewa-stb-tabs .tab-content-container .clip12x12,.ewa-stb-tabs .tab-content-container .clip16x16,.ewa-stb-tabs .tab-content-container .clip24x16{display:inline-block}.ewa-stb-nsv-inactive{opacity:.7}.ewa-stb-nsv-inactive-svg{fill-opacity:.7}.ewa-stb-nsv-active{opacity:1}.ewa-stb-nsv-active-svg{fill-opacity:1}.ewa_nsv_margin{margin-left:4px !important;height:14px}.ewa-stb-rtl .ewa_nsv_margin{margin-left:0 !important;margin-right:4px !important}@media screen and (-ms-high-contrast:active){.ewa-stb-tabs .tab-active-text{color:ButtonText}}@media screen and (-ms-high-contrast:active){.ewa-stb-uir .tab-active-text{color:HighlightText}}.ewa-stb-disable-scrollbar *::-webkit-scrollbar{display:none}.ewa-stb-disable-scrollbar *{scrollbar-width:none;-ms-overflow-style:none}.leave-size-fixed-on-tab-hover-old::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden}.leave-size-fixed-on-tab-hover::after{display:block;content:attr(sheet-title);font-weight:bold;overflow:hidden;visibility:hidden;height:0}.ewa-stb-locked-sheet{margin-right:4px !important;height:13px !important;width:12px !important}.ewa-stb-locked-sheet-svg{margin-right:4px !important;height:15px !important;width:12px !important}.ewa-stb-tabs .ewa-stb-locked-sheet-svg-16px{margin-right:4px}.ewa-stb-rtl .ewa-stb-locked-sheet{margin-right:0 !important;margin-left:4px !important}.ewa-stb-dropdown-menu-button{position:relative;display:inline-block;padding:0;margin:0;border:0}.ewa-active-sheet-menu-item{background-color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir,.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive,.ewr-presentMode-on .ewa-stb-uir .tab-active,.ewr-presentMode-on .ewa-stb-uir .tab-inactive,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-on.grid-visual-refresh .ewa-stb-rtl{background-color:#3b3a39}.ewr-presentMode-on .ewa-stb-uir .tab-hover,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton:hover{background-color:#484644}.ewr-presentMode-on .ewa-stb-tabs .tab-active :focus,.ewr-presentMode-on .ewa-stb-tabs .tab-inactive :focus,.ewr-presentMode-on .ewa-stb-uir .ewa-stb-navbutton.cui-disabled:focus{background-color:#3b3a39 !important;border:1px solid #e5e5e5 !important}.ewr-presentMode-on .ewa-stb-tabs .tab-active,.ewr-presentMode-on .ewa-stb-tabs .tab-active-text{border-bottom-color:#37a660}.ewr-presentMode-on .ewa-stb-uir .tab-active .tab-content-container::before{border-bottom:3px solid #37a660}.ewr-presentMode-on .ewa-stb-tabs .light{color:#e1dfdd}.ewr-presentMode-on .ewa-stb-uir .tab-active-text{color:#f3f2f1}.ewa-active-sheet-menu-item-present-mode{background-color:#605e5c}.ewr-presentMode-transition .ewa-stb-uir,.ewr-presentMode-transition .ewa-stb-tabs .tab-active,.ewr-presentMode-transition .ewa-stb-tabs .tab-inactive,.ewr-presentMode-transition .ewa-stb-uir .tab-active,.ewr-presentMode-transition .ewa-stb-uir .tab-inactive,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-ltr,.ewr-presentMode-transition.grid-visual-refresh .ewa-stb-rtl{transition:background-color .4s linear}.ewr-presentMode-transition .ewa-stb-tabs .light,.ewr-presentMode-transition .ewa-stb-uir .tab-active-text{transition:color .4s linear}');
ee.a.$i(".ewa-svg-icon{height:100%;width:100%}");ee.a.$i(".ewa-ttrd-buttonarea{position:absolute;z-index:31}.ewr-table-resize-fillhandle-broader{position:absolute;width:6px;height:3px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-higher{position:absolute;width:3px;height:6px;bottom:0;background-color:#003960;z-index:17;pointer-events:auto}.ewr-grdcontarea-ltr .ewr-table-resize-fillhandle-higher{right:-6px}.ewr-grdcontarea-rtl .ewr-table-resize-fillhandle-higher{left:-6px}.ewr-grdcontarea-ltr .ewr-table-resize-handle{cursor:nwse-resize;right:6px;bottom:0}.ewr-grdcontarea-rtl .ewr-table-resize-handle{cursor:nesw-resize;left:6px;bottom:0}.ewr-grdcontarea-ltr .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-grdcontarea-rtl .ewr-table-resize-handle .ewr-table-resize-default-cursor{cursor:default}.ewr-cell-selection-highlight-all.Selecting .ewr-table-resize-handle{cursor:nesw-resize}@media screen and (-ms-high-contrast:active),(forced-colors:active){.ewr-table-resize-fillhandle-higher{forced-color-adjust:none;position:absolute;width:3px;height:6px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}.ewr-table-resize-fillhandle-broader{forced-color-adjust:none;position:absolute;width:6px;height:3px;bottom:0;background-color:#fff;z-index:17;pointer-events:auto}}@media screen and (-ms-high-contrast:black-on-white),(forced-colors:active) and (prefers-color-scheme:light){.ewr-table-resize-fillhandle-higher{background-color:#000}.ewr-table-resize-fillhandle-broader{background-color:#000}}");
Xf.a.Ga(qd.ja);qh.a.Zi.Ha(141,new bc);Xf.a.Ga(oe.ja);(function(){Xf.a.Ga(function(R){Ue.ja(R);ac.EwaSettings.KH()?Ad.ja(R):Me.ja(R);jd.ja(R);Ua.ja(R)})})();Xf.a.Ga(Hb.ja);Xf.a.Ga(Sa.ja);(function(){Xf.a.Ga(function(R){R.da.Ha(134,new lb(R));R.da.Ha(330,new ra(R))})})();Xf.a.Ga(ec.ja);(function(){Xf.a.Ga(function(R){hc.ja(R);Ya.ja(R)})})();Type.registerNamespace("Common.App.SessionExpiration");Xf.a.Ga(X.ja);Xf.a.Ga(a.ja);Xf.a.Ga(da.ja)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.acc.js.map/342a72cb6a3b5123b5a8bb373252a742/EwaDS.acc.js.map