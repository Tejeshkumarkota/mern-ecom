(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[33],{1387:function(A,F,b){function a(Hb){var Lb=Gc.call(this)||this;Lb.rn=null;Lb.RA=null;Lb.POa=function(){Lb.rn.tHb(Lb.POa);qa.ULS.sendTraceTag(537162849,0,50,"ExcelLiveManager::OnRealTimeChannelInitialized");Lb.Fb(Lb.$.da.Aa(473)||new m(Lb.$,Lb.rn,Lb.RA))};Lb.$=Hb;Lb.dc();return Lb}function c(Hb){var Lb=Kb.call(this)||this;Lb.Iv=null;Lb.fJa=null;Lb.eJa=null;Lb.Szb=!1;Lb.$=Hb;Lb.Szb=Mb.e(Lb.$);Lb.Nai();return Lb}function e(Hb,
Lb){Lb=void 0===Lb?null:Lb;this.container=null;this.Nn=0;this.HPa=null;this.ph=!1;Lb&&(this.$=Hb,this.initialize(Lb),this.ph=Ja.AFrameworkApplication.sa.Qa.ph)}function l(Hb,Lb){var sa=this;Lb=void 0===Lb?null:Lb;this.uoa=null;this.yWd=this.LUe=!0;this.container=null;this.Nn=0;this.HPa=this.kza=null;this.lastUpdateTime=0;this.$=null;this.L5h=function(){sa.yWd||(sa.SRf(),sa.yWd=!0,sa.container.classList.remove("ewa-excelLive-meetingPill-container-hidden"))};Lb&&this.initialize(Hb,Lb);this.$=Hb}function n(Hb){this.mee=
this.lee=this.kee=null;this.Fde=void 0;this.$=Hb}function m(Hb,Lb,sa){this.Wpa=this.cib=this.Nkb=this.sib=null;this.$=Hb;this.Xee=Lb;this.Fr=new f(this.$);this.hga=Object(Cb.a)(284,this.rn.Fj);this.Wpa=sa;this.z$h()}function f(Hb){this.mke=this.d7d=this.c7d=this.Sje=this.j6d=this.k6d=this.Tge=0;this.l6d=!1;this.qce=this.pce=0;this.lae=void 0;this.t4d=this.Ige=this.kie=0;this.$=Hb}function x(Hb,Lb,sa,Ua){this.controller=this.z_=null;this.vDi=1E4;this.$=Hb;this.gridView=ec.g(this.$);this.Fr=Ua;this.realtimeChannel=
Lb;this.controller=sa;this.Mob();this.Eqj();this.sGj()}function y(Hb,Lb,sa){this.viewBlockContainerHelpers=this.lOb=this.X_=null;this.qod=this.DMa=!1;this.x2a=0;this.hTe=10;this.iTe=500;this.jTe=3E4;this.lla=0;this.RA=sa;this.realtimeChannel=Lb;this.$=Hb;this.gridView=ec.g(Hb);this.Zcc=this.Zcc.bind(this);this.jma=this.jma.bind(this);this.hTe=this.$.ya.FetchPresenterNavigationStateMaxRetries;this.iTe=this.$.ya.FetchPresenterNavigationStateRetryBaseInMs;this.jTe=this.$.ya.FetchPresenterNavigationStateRetryMaxDelayInMs;
this.initialize()}function t(Hb,Lb,sa,Ua){this.statusBarManager=null;this.iaa=new B;this.rsd=this.MFb=null;this.taa=this.NFb=0;this.dTe=10;this.eTe=500;this.fTe=3E4;this.b_d=.98;this.Dyb=this.AV=this.Yfc=this.vyb=this.Znd=this.wyb=this.a7a=this.pod=!1;this.Vsd=null;this.controller=sa;this.realtimeChannel=Lb;this.$=Hb;this.gridView=ec.g(Hb);this.Fr=Ua;this.statusBarManager=new z(this.$,this.iaa);this.b_d=this.$.ya.ExcelLiveViewportRoundOffFactor;this.dTe=this.$.ya.FetchPresenterNavigationStateMaxRetries;
this.eTe=this.$.ya.FetchPresenterNavigationStateRetryBaseInMs;this.fTe=this.$.ya.FetchPresenterNavigationStateRetryMaxDelayInMs;this.Mob();this.jMg();this.gzc()}function B(){return cc.call(this)||this}function z(Hb,Lb){var sa=Jb.call(this)||this;sa.statusBarManager=null;sa.h5b=2;sa.oqc=null;sa.qFf=function(Ua,Yb){sa.h5b=Yb.h5b;sa.oqc=Yb.oqc;sa.vz()};sa.$=Hb;sa.$.da.Za(29,function(Ua){sa.statusBarManager=Ua;Ua.xJ(sa)});sa.iaa=Lb;sa.iaa.IHg(sa.qFf);return sa}function u(Hb,Lb){var sa=Oa.call(this)||
this;sa.h5b=Hb;sa.oqc=Lb;return sa}function C(Hb,Lb){Hb=document.getElementById(Hb.Ib+sc.a.d1a);return{pOb:Hb.clientWidth/Lb,mOb:Hb.clientHeight/Lb}}function r(Hb){return vb.call(this,Hb)||this}function J(Hb,Lb){this.$=Hb;this.excelLiveManager=Lb}function v(){this.tb=null}function D(Hb){this.Xvg=Hb}function V(Hb){this.Fqg=Hb}function U(){}function Q(){}function la(){}function ba(){}function T(Hb,Lb,sa,Ua){Ua=void 0===Ua?null:Ua;this.Vl=new ob.a;this.Btg=Hb;this.ssg=Lb;this.wb=sa;this.Aib=Ua}function H(){}
function S(){}function K(){}function da(Hb,Lb){this.La=Hb;this.HWa=Lb}function fa(){this.Ww=this.tm=!1}function X(Hb,Lb,sa,Ua,Yb,jc,md,jd,Zc){var Qb=this;this.tm=!1;this.MVb=this.hXa=this.LP=this.mga=null;this.Plb=X.YDc;this.rb=new db.a;this.tra=new ca(0);this.tra.HVc(Object(pa.a)(this,this.JTi,"onStateMachineChanged"));this.Bvg=Hb;this.uVb=Lb;this.zvg=sa;this.ZPc=Ua;this.me=Yb;this.yT=jc;md.execute(function(fd){Qb.tm||(Qb.hXa=fd,Qb.hXa.NYa(Object(pa.a)(Qb,Qb.Aca,"onUpdateNotificationReceived")),
Qb.start())});jd.execute(function(fd){Qb.tm||(Qb.MVb=fd,fd.ZYb(Object(pa.a)(Qb,Qb.TEf,"onTokenRefreshed")))});this.Rie=Zc}function ca(Hb){this.rb=new db.a;this.Qhe=new Date;this.xhb=Hb;this.THc=0}function ja(Hb,Lb,sa,Ua,Yb){var jc=Na.call(this)||this;jc.eFd=Hb;jc.newState=Lb;jc.L1i=sa;jc.M1i=Ua;jc.Y0j=Yb;return jc}function ea(Hb,Lb){var sa=Pa.call(this)||this;sa.A0j=Hb;sa.w0j=Lb;return sa}b.r(F);A=b(516);F=b(0);var qa=b(13),pa=b(80),Pa=Sys.EventArgs;vm(ea,Pa);Object(F.a)(ea,"RtcHostNotificationEventArgs",
Sys.EventArgs,[]);var Ha;(function(Hb){Hb[Hb.notYetStarted=0]="notYetStarted";Hb[Hb.polling=1]="polling";Hb[Hb.subscribed=2]="subscribed";Hb[Hb.blocked=3]="blocked";Hb[Hb.permanentlyStopped=4]="permanentlyStopped"})(Ha||(Ha={}));Object(F.b)("RtcHostNotificationSubscriptionState",Ha);var Xa=b(108),Na=Sys.EventArgs;vm(ja,Na);Object(F.a)(ja,"StateChangedEventArgs",Sys.EventArgs,[]);var db=b(93);ca.prototype.event=function(Hb,Lb){this.currentState!==Hb&&(this.tDh(this.currentState,Hb,this.WMe,void 0===
Lb?null:Lb),this.THc=0,this.Qhe=new Date);this.xhb=Hb;this.THc=this.WMe+1};ca.prototype.tDh=function(Hb,Lb,sa,Ua){Hb=new ja(Hb,Lb,sa,this.Qhe,Ua);this.rb.raiseEvent("c",Hb)};ca.prototype.HVc=function(Hb){this.rb.addHandler("c",Hb)};ca.prototype.CRf=function(Hb){this.rb.removeHandler("c",Hb)};Sk.Object.defineProperties(ca.prototype,{currentState:{configurable:!0,enumerable:!0,get:function(){return this.xhb}},WMe:{configurable:!0,enumerable:!0,get:function(){return this.THc}}});Object(F.a)(ca,"StateMachine",
null,[873]);X.prototype.start=function(){0!==this.Ldb?qa.ULS.sendTraceTag(573100178,502,15,"HostNotifications: Tried starting poll when in state {0}",Ha[this.Ldb]):(this.tra.event(1),this.NNd(null))};X.prototype.NNd=function(){this.mga=null;if(this.Qhf){qa.ULS.sendTraceTag(573100181,502,50,"HostNotifications: Send event when connected.  Current state: {0}",Ha[this.Ldb]);var Hb=null;this.ZPc&&this.ZPc.length&&(Hb={},Hb.etts=this.ZPc);this.hXa.Nda(14,Hb,!0);this.PWf(this.Bvg)}else this.tra.event(3)};
X.prototype.PWf=function(Hb){this.mga=Xa.a.o4c(1E3*Hb,Object(pa.a)(this,this.NNd,"sendSubscribeEvent"),this.uVb,192,"RtcHostNotificationSubscribe");this.me.Zg(this.mga)};X.prototype.Ulj=function(Hb){Hb=1E3*(Hb+this.zvg);var Lb=this.Rie().getTime()+Hb;this.Plb=new Date(Lb);Hb-=this.uVb;this.LP?this.me.$ma(this.LP,Hb):(this.LP=Xa.a.o4c(Hb,Object(pa.a)(this,this.YMj,"transitionToPollingEvent"),this.uVb/2,194,"RtcHostNotificationTransitionToPolling"),this.me.Zg(this.LP))};X.prototype.YMj=function(){this.LP=
null;2===this.Ldb&&(this.tra.event(1),qa.ULS.shipAssertTag(573100185,502,!!this.mga,"Missing task to ensure that we re-subscribe."))};X.prototype.TEf=function(){this.l3h()};X.prototype.l3h=function(){3===this.Ldb&&this.Qhf&&(this.tra.event(this.D5?2:1),this.NNd(null))};X.prototype.Aca=function(Hb,Lb){if(13===Lb.type&&(Hb=Lb.a8,Lb={},qa.ULS.sendTraceTag(573100183,502,50,"HostNotifications: Subscription status: {0}",(Lb.SerializableHostNotificationSubscription=Hb,Lb.DurationBeforeExpirationToResubscribeInSec=
this.uVb,Lb)),Lb=Hb.cts,!this.POj(Lb))){if(Hb.sb){var sa=2;this.Ulj(Hb.cts)}else sa=1,this.Plb=X.YDc,this.LP&&(this.me.Np(this.LP),this.LP=null);this.tra.event(sa);this.mga?this.me.$ma(this.mga,1E3*Lb):this.PWf(Lb)}};X.prototype.POj=function(Hb){if(!isNaN(Hb)&&isFinite(Hb)&&0<Hb)return!1;this.h7f(!1);return!0};X.prototype.h7f=function(Hb){this.mga&&(this.me.Np(this.mga),this.mga=null);this.LP&&(this.me.Np(this.LP),this.LP=null);this.hXa&&(this.hXa.xHb(Object(pa.a)(this,this.Aca,"onUpdateNotificationReceived")),
this.hXa=null);this.MVb&&(this.MVb.BJd(Object(pa.a)(this,this.TEf,"onTokenRefreshed")),this.MVb=null);Hb||this.tra.event(4)};X.prototype.JTi=function(Hb,Lb){Hb=Lb.newState;var sa=Lb.eFd,Ua={};Ua.NewState=Ha[Hb];Ua.PreviousState=Ha[sa];Ua.PreviousStateHits=Lb.L1i;Ua.PreviousStateTransitionTime=Lb.M1i.toISOString();Ua.IsSubscribed=this.D5;this.Plb!==X.YDc&&(Ua.SubscriptionExpiringTime=this.Plb.toISOString());qa.ULS.sendTraceTag(572346515,502,4===Hb?15:50,"HostNotificationChanged: {0}",Ua);this.rb.raiseEvent("HN",
new ea(sa,Hb))};X.prototype.dispose=function(){this.tm||(this.tm=!0,this.h7f(!0),this.LP&&(this.me.Np(this.LP),this.LP=null))};Sk.Object.defineProperties(X.prototype,{Ldb:{configurable:!0,enumerable:!0,get:function(){return this.tra.currentState}},Qhf:{configurable:!0,enumerable:!0,get:function(){return!this.yT||this.yT.$if}},D5:{configurable:!0,enumerable:!0,get:function(){return 2===this.Ldb&&this.Rie()<this.Plb}}});X.YDc=new Date(0);Object(F.a)(X,"RtcHostNotificationSubscriptionManager",null,[883,
3]);var Ja=b(5),jb=b(273),hc=b(688),ma=b(86);fa.prototype.ji=function(Hb){var Lb=this;Hb.register(X,"Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").as("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager").Bc().Lc(function(){var sa=Ja.AFrameworkApplication.ga;return new X(sa.Ad("RtcHostNotificationRetryIntervalIdeallyInSeconds",1800),sa.Ad("RtcHostNotificationRetryIntervalBufferInSeconds",120),sa.Ad("RtcHostNotificationSubscriptionLostBufferInSeconds",
60),Lb.jYh(sa),Ja.AFrameworkApplication.hj,hc.SessionStatusManager.instance,Hb.oc("Common.IRealtimeChannelBasic"),Hb.oc("Common.ISessionExpirationManager"),function(){return new Date})})};fa.prototype.init=function(){var Hb=this;Ja.AFrameworkApplication.ga.ow(function(){!Hb.tm&&Ja.AFrameworkApplication.ga.ra("RtcHostNotificationEnabled")&&(Hb.Ww=!0,ma.a.instance.resolve("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager"))})};fa.prototype.dispose=function(){this.tm||
(this.tm=!0,this.Ww&&ma.a.instance.resolve("Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").dispose())};fa.prototype.jYh=function(Hb){return Hb.Ty("RtcEventTypesToSubscribe")?Hb.fw("RtcEventTypesToSubscribe"):null};fa.main=function(){jb.a.instance.sj(new fa)};Sk.Object.defineProperties(fa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"RtcHostNotificationSubscription"}}});Object(F.a)(fa,"RtcHostNotificationSubscriptionPackage",null,[4,5]);var Ka=
b(104),Ta=b(30);da.prototype.Qg=function(){this.La.fc(Ta.a.Ilf,Ka.a.frame,Object(pa.a)(this,this.Jlf,"livePersonaCardActionHandler"))};da.prototype.kNb=function(){this.La.lD(Ta.a.Ilf,Ka.a.frame,Object(pa.a)(this,this.Jlf,"livePersonaCardActionHandler"))};da.prototype.Jlf=function(Hb,Lb,sa,Ua,Yb){if(!Yb||3===sa)return 2;if(1===sa)return this.iYa(this.HWa.Mwe(Yb.upn||Yb.aadObjectId));if(!this.amh(Yb))return 8;switch(Yb.action){case 0:return this.iYa(this.HWa.FAg(Yb));case 1:return this.iYa(this.HWa.EAg(Yb));
case 2:return this.iYa(this.HWa.GAg(Yb));case 3:return this.iYa(this.HWa.openCard(Yb));case 4:return this.iYa(this.HWa.jaj(Yb));default:return 2}};da.prototype.amh=function(Hb){var Lb=Hb.upn||Hb.aadObjectId;return Hb.targetElement&&(4===Hb.action||Lb&&""!==Lb)?!0:!1};da.prototype.iYa=function(Hb){return Hb?32:8};Object(F.a)(da,"LivePersonaCardActor",null,[]);var ob=b(139),Cb=b(84);Object(F.a)(K,"BootstrapperConfig",null,[]);Object(F.a)(S,"LivePersonaCardInitializerResult",null,[]);H.Aue=null;Object(F.a)(H,
"LivePersonaCardModule",null,[]);var eb=b(579);T.prototype.init=function(){this.Iff()?this.Btg.Cti().continueWith(Object(pa.a)(this,this.CQi,"onPackageLoaded")):this.Vl.setResult(Object.assign(new S,{isInitialized:!1,isEnabled:!1,failureMessage:"LivePersonaCard is not enabled."}));return this.Vl.task};T.prototype.CQi=function(){var Hb=this,Lb=H.Aue;if(Lb){var sa=this.bLh();try{Lb.initializeLivePersonaCardAsync(sa).then(function(){Hb.Vl.setResult(Object.assign(new S,{isInitialized:!0,isEnabled:!0}))}).catch(function(Ua){var Yb=
Object(Cb.a)(String,Ua);Yb?Hb.Vl.setException(Error.create(Yb)):Hb.Vl.setException(Error.create(JSON.stringify(Ua)))})}catch(Ua){this.Vl.setException(Ua)}}else this.Vl.setResult(Object.assign(new S,{isInitialized:!1,isEnabled:!0,failureMessage:"LivePersonaCardBootstrapper package is not loaded."}))};T.prototype.bLh=function(){var Hb=eb.a.cK(Ja.AFrameworkApplication.lcid);return Object.assign(new K,{culture:Hb?Hb.name.toLocaleLowerCase():"en-us",clientType:this.wb.Ua("LivePersonaCardClientType"),clientContextType:"Generic",
clientCorrelationId:Ja.AFrameworkApplication.userSessionId,complianceEnvironment:this.YMh(),logMessage:Object(pa.a)(this,this.logMessage,"logMessage"),getAuthToken:Object(pa.a)(this,this.getAuthToken,"getAuthToken")})};T.prototype.Iff=function(){if(!this.wb.ra("LivePersonaCardIsEnabled")||!this.IJg())return!1;var Hb=this.wb.Ua("SovereignEnvironmentName");return Hb&&""!==Hb?Hb.toLocaleLowerCase()==="USGov".toLocaleLowerCase()||Hb.toLocaleLowerCase()==="Blackforest".toLocaleLowerCase()?!0:!1:!0};T.prototype.IJg=
function(){return this.wb.ra("CoauthorGalleryLivePersonaCardIsEnabled")||!!Ja.AFrameworkApplication.sa&&Ja.AFrameworkApplication.sa.Qa.ZRa};T.prototype.YMh=function(){return this.wb.Ua("LivePersonaCardComplianceEnvironment")};T.prototype.logMessage=function(Hb,Lb,sa){var Ua={};Hb=JSON.stringify((Ua["Log Type"]=Hb,Ua["Log Result Type"]=Lb,Ua.Message=sa,Ua));qa.ULS.sendTraceTag(50431106,3006,50,Hb)};T.prototype.getAuthToken=function(Hb,Lb){var sa=this;Ja.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?
this.Aib.continueWith(function(Ua){Ua.Ih||Ua.kg?Lb("LokiTokenManagerTask is either canceled or faulted.",Ja.AFrameworkApplication.userSessionId):sa.Aib.result.Jfd().then(function(Yb){Yb.isSuccess&&Yb.token&&Yb.token.length?Hb(Yb.token,Ja.AFrameworkApplication.userSessionId):Lb(Yb.errorMessage,Ja.AFrameworkApplication.userSessionId)}).catch(function(Yb){return qa.ULS.sendTraceTag(539617039,3006,10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(Yb))})}):this.ssg.Jfd().then(function(Ua){Ua.isSuccess&&
Ua.token&&Ua.token.length?Hb(Ua.token,Ja.AFrameworkApplication.userSessionId):Lb(Ua.errorMessage,Ja.AFrameworkApplication.userSessionId)}).catch(function(Ua){return qa.ULS.sendTraceTag(50431107,3006,10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(Ua))})};Object(F.a)(T,"LivePersonaCardInitializer",null,[]);Object(F.a)(ba,"Behavior",null,[]);Object(F.a)(la,"Identifiers",null,[]);Object(F.a)(Q,"LivePersonaCardParameters",null,[]);Object(F.a)(U,"PersonaInfo",null,[]);V.prototype.Mwe=
function(Hb){return this.Fqg.Iff()&&Hb&&""!==Hb?!!window.self.LPC:!1};V.prototype.FAg=function(Hb){return this.aNb("addedPersonaToPageV2",Hb,0)};V.prototype.EAg=function(Hb){return this.aNb("addedPersonaToPageV2",Hb,1)};V.prototype.GAg=function(Hb){return this.aNb("addedPersonaToPageV2",Hb,2)};V.prototype.openCard=function(Hb){return this.aNb("openCard",Hb)};V.prototype.jaj=function(Hb){return this.aNb("removedPersonaFromPage",Hb)};V.prototype.BUg=function(Hb){return!!Hb.targetElement&&(this.Mwe(Hb.upn||
Hb.aadObjectId)||4===Hb.action)};V.prototype.aNb=function(Hb,Lb,sa){sa=void 0===sa?3:sa;if(!this.BUg(Lb))return!1;sa=4!==Lb.action?this.F7g(Lb,sa):null;var Ua=window.self.LPC;if(Ua&&Ua[Hb]){if(sa)Ua[Hb](Lb.targetElement,sa);else Ua[Hb](Lb.targetElement);return!0}return!1};V.prototype.F7g=function(Hb,Lb){Lb=void 0===Lb?3:Lb;var sa=Object.assign(new la,{PersonaType:"User",Upn:Hb.upn,AadObjectId:Hb.aadObjectId});return Object.assign(new Q,{personaInfo:Object.assign(new U,{identifiers:sa,displayName:Hb.name,
personaCoinColor:Hb.color}),behavior:Object.assign(new ba,{onCardOpen:function(){qa.ULS.sendTraceTag(595067869,3006,100,"LivePersonaCard opened");if(Hb.onCardOpen)Hb.onCardOpen()},onCardClose:Hb.onCardClose,disableClick:2===Lb||3===Lb,disableHover:0===Lb||3===Lb})})};Object(F.a)(V,"LivePersonaCardManager",null,[]);D.prototype.Cti=function(){var Hb=Ja.AFrameworkApplication.h7("midgardbootstrapper.js",5);return this.Xvg.Otd(Hb).continueWith(function(){H.Aue=window.self.MidgardBootstrapper})};Object(F.a)(D,
"LivePersonaCardPackageLoader",null,[398]);var ya=b(525);v.prototype.init=function(){Ja.AFrameworkApplication.ga&&Ja.AFrameworkApplication.ga.ow(Object(pa.a)(this,this.lB,"onFullAppSettingsReady"))};v.prototype.dispose=function(){};v.prototype.ji=function(Hb){this.tb=Hb};v.prototype.lB=function(){var Hb=Ja.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?new T(new D(this.tb.resolve("Common.ISharedDependencyLoader")),null,Ja.AFrameworkApplication.ga,
ya.a.Tq(this.tb.oc("Common.ILokiTokenManager"))):new T(new D(this.tb.resolve("Common.ISharedDependencyLoader")),this.tb.resolve("Common.ILokiTokenManager"),Ja.AFrameworkApplication.ga);Hb.init().continueWith(function(Lb){Lb.kg&&Lb.exception?qa.ULS.sendTraceTag(50431108,3006,15,"Failed to initialize LivePersonaCard, exception: [{0}]",Lb.exception.message):((Lb=Lb.result)||qa.ULS.sendTraceTag(595067868,3006,15,"LivePersonaCardInitializer did not return a result"),Lb.isInitialized?qa.ULS.sendTraceTag(50431109,
3006,100,"Successfully initialized LivePersonaCard"):qa.ULS.sendTraceTag(595067867,3006,Lb.isEnabled?15:100,"Failed to initialize LivePersonaCard, failure message: [{0}]",Lb.failureMessage))});(new da(Ja.AFrameworkApplication.Gb,new V(Hb))).Qg()};v.main=function(){jb.a.instance.sj(new v)};Sk.Object.defineProperties(v.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.LivePersonaCard"}}});Object(F.a)(v,"LivePersonaCardPackage",null,[4,5]);var za=b(10),Ga=b(817),cb=b(35),
Mb=b(186),Dc=b(175);J.prototype.Yc=function(){return!1};J.prototype.Jc=function(Hb,Lb){switch(Lb.command){case 1491932557:return Mb.e(this.$)&&2===this.excelLiveManager.pPa.Nn;case -440259636:return Mb.d(this.$)&&2===this.excelLiveManager.pPa.Nn;default:return!1}};J.prototype.executeCommand=function(Hb,Lb){Hb=cb.TaskExtensions.om();var sa=Lb.command;switch(Lb.command){case -440259636:this.excelLiveManager.lid();break;case 1491932557:this.excelLiveManager.LUd();break;default:Hb=Dc.a(sa)}return Hb};
J.prototype.fd=function(){return!1};Object(F.a)(J,"ExcelLiveCommandHandler",null,[188]);var vb=Ga.a;vm(r,vb);r.prototype.Od=function(){var Hb=this;this.$.da.Za(473,function(Lb){Hb.Fd([new J(Hb.$,Lb)])})};r.ja=function(Hb){Ga.a.fe(469,new r(Hb))};Object(F.a)(r,"ExcelLiveCommandHandlerFactory",Ga.a,[]);var ib=b(214),ub=b(8),Eb=b(45),Ya=b(24),tb=b(43),ec=b(20),Za=b(225),mb=b(34),sc=b(4),pd=b(122),$b=b(44),Xb=b(259),lc=b(9),Oa=Sys.EventArgs;vm(u,Oa);Object(F.a)(u,"ExcelLiveViewStateChangedArgs",Sys.EventArgs,
[]);var pb=b(36),Ub;(function(Hb){Hb[Hb.complete=0]="complete";Hb[Hb.nonComplete=1]="nonComplete";Hb[Hb.unknown=2]="unknown"})(Ub||(Ub={}));Object(F.b)("FollowerViewState",Ub);var ic=b(1),Jb=pb.a;vm(z,Jb);z.prototype.tq=function(Hb){this.addHandler("followerViewStateInfoChanged",Hb)};z.prototype.Mq=function(Hb){this.removeHandler("followerViewStateInfoChanged",Hb)};z.prototype.vz=function(){this.kn("QueryExcelLiveViewState")&&this.raiseEvent("followerViewStateInfoChanged")};z.prototype.$r=function(Hb,
Lb){return"QueryExcelLiveViewState"!==Hb?!1:this.U4h(Lb)};z.prototype.kn=function(){return Object(Mb.e)(this.$)&&ic.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowExcelLiveViewStateInStatusBar",!1)};z.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.RF(this),this.statusBarManager=null);this.iaa.zej(this.qFf);this.$=this.iaa=null;Jb.prototype.dispose.call(this)};z.prototype.U4h=function(Hb){if(!this.$)return!1;Hb.Value=String.format("View State: {0} | Presenter Visible Range: {1}",
Ub[this.h5b],this.oqc);return!0};Object(F.a)(z,"ExcelLiveStatusBarManager",pb.a,[3,185,186]);var cc=pb.a;vm(B,cc);B.prototype.IHg=function(Hb){this.addHandler("FollowerViewStateChanged",Hb)};B.prototype.zej=function(Hb){this.removeHandler("FollowerViewStateChanged",Hb)};B.prototype.G4i=function(Hb){this.raiseEvent("FollowerViewStateChanged",Hb)};Object(F.a)(B,"ExcelLiveFollowerOrExplorerEventManager",pb.a,[]);t.prototype.dispose=function(){this.Ydh();2!==this.controller.Nn&&(this.UHe(),this.Qrb());
this.gridView=this.$=this.controller=this.realtimeChannel=this.rsd=this.Zsd=this.T7a=this.Vsd=this.MFb=null};t.prototype.LUd=function(){this.Fr.KUd=lc.HelperMethods.kc();this.gzc(!0)};t.prototype.gzc=function(Hb,Lb){var sa=this;Hb=void 0===Hb?!1:Hb;Lb=void 0===Lb?null:Lb;var Ua;Hb&&this.Fr.Vwi();if(Lb)this.ZLb(Lb)?this.amd():qa.ULS.sendTraceTag(527496925,0,15,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Could not sync to presenter from presence update"),this.taa=0;else if(++this.taa,
this.taa>this.dTe)qa.ULS.sendTraceTag(527496924,0,10,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Presenter Nav State not available after "+(this.taa-1)+" retries."),this.pod=!0,this.taa=0;else{if(1===this.taa){var Yb=null!==(Ua=this.rsd)&&void 0!==Ua?Ua:this.MFb;if(null!==Yb&&this.ZLb(Yb,!0)){this.amd(Hb,!0);this.taa=0;return}}(Ua=this.vad())&&this.ZLb(Ua)?(this.amd(Hb,!0),this.taa=0):1!==this.controller.Nn&&(this.controller.Foa(3,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry"),
qa.ULS.sendTraceTag(527496923,0,15,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Retry\n           "+this.taa+" - Presenter Nav State not available."),$b.a.instance.create(function(){sa.gzc(Hb,Lb)},Xb.a.Ava(this.taa,this.eTe,this.fTe,!0),"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry",void 0,!0))}};t.prototype.amd=function(Hb,Lb){Hb=void 0===Hb?!1:Hb;Lb=void 0===Lb?!1:Lb;this.controller.Foa(1,"ExcelLiveFollowerOrExplorer::initializeFollower");this.iMg();this.N_b();
this.pod=!1;Hb&&this.Fr.Uwi(Lb)};t.prototype.Mob=function(){this.jma=this.jma.bind(this);this.$C=this.$C.bind(this);this.YC=this.YC.bind(this);this.Mf=this.Mf.bind(this);this.Coc=this.Coc.bind(this);this.fj=this.fj.bind(this);this.wmc=this.wmc.bind(this);this.ej=this.ej.bind(this);this.uoc=this.uoc.bind(this);this.vnc=this.vnc.bind(this);this.COa=this.COa.bind(this);this.Ioc=this.Ioc.bind(this);this.onScroll=this.onScroll.bind(this);this.b$a=this.b$a.bind(this);this.od=this.od.bind(this);this.J9a=
this.J9a.bind(this);this.enc=this.enc.bind(this);this.Qe=this.Qe.bind(this)};t.prototype.cTe=function(){var Hb=this.vad();return this.ZLb(Hb)};t.prototype.vad=function(Hb){Hb=void 0===Hb?null:Hb;if(Hb=null!==Hb&&void 0!==Hb?Hb:this.realtimeChannel.udd())for(var Lb in Hb){var sa=Lb,Ua=Hb[Lb];if(!Ua)break;if(Ua.NavigationState&&Ua.MeetingInfo&&(Ua.MeetingInfo.MeetingId===this.$.ya.MeetingId||Mb.b()))return this.controller.bL&&this.controller.bL===sa||this.controller.puc(sa,"ExcelLiveFollowerOrExplorer:extractNavigationStateFromMeetingPresence"),
Ua.NavigationState}return null};t.prototype.ZLb=function(Hb,Lb){Lb=void 0===Lb?!1:Lb;var sa=lc.HelperMethods.kc(),Ua=this.Z0g(Hb,this.MFb,Lb);if(0===Ua)return this.bWf(Ua,Hb),!1;if(!this.KOj(Hb.SheetID))return!0;Ua&4&&this.setZoom(this.MFb,Hb);Lb=this.U0g(Hb);this.LIj(Hb,Ua,Lb);this.bWf(Ua,Hb);Hb=tb.D(Hb.VisibleAreaRange);this.iaa.G4i(new u(Lb,Hb.toString()));this.Fr.MMj(Lb,sa);return!0};t.prototype.LIj=function(Hb,Lb,sa){this.wyb=!0;0===sa?this.E8f(Lb,Hb):this.MIj(Lb,Hb)};t.prototype.bWf=function(Hb,
Lb){this.MFb=Lb;this.NFb=Hb};t.prototype.KOj=function(Hb){this.Vsd=Hb=this.$.xa.getItemByName(Hb);if(!Hb)return this.Dyb=!0,!1;if(Hb!==this.$.pa){if(!Hb.visible)return!1;this.a7a=!0;Hb.activate()}return!0};t.prototype.setZoom=function(Hb,Lb){Hb&&Hb.SheetID===Lb.SheetID&&(Hb=(Lb.ZoomLevel-Hb.ZoomLevel)/Hb.ZoomLevel*100,Lb=mb.a(this.$).zoom,Hb=Lb+Lb*Hb/100,mb.a(this.$).Hhg(Hb),this.Fr.S_d=lc.HelperMethods.kc())};t.prototype.E8f=function(Hb,Lb){Hb&2&&(Hb=tb.D(Lb.VisibleAreaRange),this.T7a=Ya.Range.kd(Hb.top,
Hb.left),this.Zsd=new Eb.a(Lb.TopLeftCellOffsets.X,Lb.TopLeftCellOffsets.Y),Lb=Za.a(this.T7a,this.Zsd,this.gridView.Js,this.gridView.$a,0,0,this.$,this.gridView.rV()),this.gridView.CZb(Lb,this.T7a,60,this.T7a,"ExcelLiveFollowerOrExplorerApp.SyncViewportToMatchOrigin"))};t.prototype.MIj=function(Hb,Lb){var sa=tb.D(Lb.SelectedRanges[Lb.IndexOfActiveRange]),Ua=Hb!==this.NFb,Yb=tb.D(Lb.VisibleAreaRange);Hb&1?(this.CXj=this.gridView.qac(),this.gridView.Rt(sa,64,"ExcelLiveFollowerOrExplorer.syncViewportForNonCompleteViewState",
!0),Hb=this.gridView.G4(),this.T7a=Hb.lG,this.Zsd=Hb.wz,Ua&&this.gridView.$Uc(this.enc)):Hb&2&&(!Yb.Qd(sa)||this.NFb&2||this.NFb&4)&&(this.E8f(Hb,Lb),Ua&&this.Fr.dnf(),this.Fr.FCc=lc.HelperMethods.kc())};t.prototype.Q6h=function(Hb){var Lb=this.gridView.qac();return Lb.Qd(Hb)&&Hb.Qd(Lb)?!0:!1};t.prototype.Z0g=function(Hb,Lb,sa){sa=void 0===sa?!1:sa;if(null===Lb&&null===Hb)return 0;if(null===Lb&&Hb||sa)return 7;if(null!==Hb){var Ua=tb.D(Hb.SelectedRanges[Hb.IndexOfActiveRange]);var Yb=tb.D(Lb.SelectedRanges[Lb.IndexOfActiveRange]),
jc=tb.D(Hb.VisibleAreaRange),md=tb.D(Lb.VisibleAreaRange);Ua=null==Hb||Lb.SheetID!=Hb.SheetID||Lb.ZoomLevel!=Hb.ZoomLevel||!Ua.equals(Yb)||!jc.equals(md)||Lb.TopLeftCellOffsets.X!=Hb.TopLeftCellOffsets.X||Lb.TopLeftCellOffsets.Y!=Hb.TopLeftCellOffsets.Y}else Ua=void 0;if(!Ua)return sa?7:0;Ua=tb.D(Hb.VisibleAreaRange);sa=tb.D(Hb.SelectedRanges[Hb.IndexOfActiveRange]);Ua=Ya.Range.kd(Ua.top,Ua.left);Yb=new Eb.a(Hb.TopLeftCellOffsets.X,Hb.TopLeftCellOffsets.Y);md=tb.D(Lb.VisibleAreaRange);jc=tb.D(Lb.SelectedRanges[Lb.IndexOfActiveRange]);
md=Ya.Range.kd(md.top,md.left);var jd=new Eb.a(Lb.TopLeftCellOffsets.X,Lb.TopLeftCellOffsets.Y),Zc=0;jc.equals(sa)&&Hb.SheetID===Lb.SheetID||(Zc|=1);Hb.ZoomLevel!==Lb.ZoomLevel&&(Zc|=4);Yb.equals(jd)&&Ua.equals(md)||(Zc|=2);return Zc^0?Zc:0};t.prototype.U0g=function(Hb){var Lb=C(this.$,mb.a(this.$).zoom),sa=Lb.mOb;return Lb.pOb<Hb.ViewportWidth*this.b_d||sa<Hb.ViewportHeight*this.b_d?1:0};t.prototype.iMg=function(){var Hb=this;this.$.ea.LG(this.$C);this.$.ea.IYa(this.YC);this.$.da.Za(419,function(Lb){Lb.$oe(Hb.b$a);
Lb.ape(Hb.b$a)})};t.prototype.UHe=function(){var Hb=this;this.$&&(this.$.ea.VF(this.$C),this.$.ea.abb(this.YC),this.$.da.Za(419,function(Lb){Lb.HRf(Hb.b$a);Lb.IRf(Hb.b$a)}))};t.prototype.b$a=function(){this.Fr.NMj()};t.prototype.$C=function(){this.$.ea.uf!==ub.a.Te&&this.$.ea.qc&&(this.Dyb&&this.$.ea.Dt(this.Mf),this.AV=!0)};t.prototype.Mf=function(){(this.AV||this.Dyb)&&this.cTe()&&(this.$.ea.Ew(this.Mf),this.Dyb=this.AV=!1)};t.prototype.YC=function(){this.a7a?this.a7a=!1:this.AV&&this.cTe()&&(this.AV=
!1)};t.prototype.N_b=function(){var Hb=this;this.gridView.PYa(this.Coc);this.gridView.yc.Yl(this.fj);this.$.RUc(this.wmc);this.$.nA(this.ej);this.gridView.Bne(this.COa);this.$.da.Za(419,function(Lb){Lb.PHg(Hb.Ioc)});this.$.da.Za(65,function(Lb){Lb.dGg(Hb.uoc)})};t.prototype.Qrb=function(){this.gridView&&(this.gridView.gbb(this.Coc),this.gridView.yc.ol(this.fj),this.gridView.FQf(this.COa));this.$&&(this.$.cJd(this.wmc),this.$.mD(this.ej));var Hb=this.$.da.Aa(419);Hb&&Hb.Dej(this.Ioc);(Hb=this.$.da.Aa(65))&&
Hb.ldj(this.uoc)};t.prototype.Coc=function(){this.vyb?this.vyb=!1:this.Yfc||this.a7a||this.wyb||this.upi()||(this.Znd?this.Znd=!1:this.HOa())};t.prototype.upi=function(){var Hb=this.gridView.G4().lG;return this.Vsd===this.$.pa&&Hb.equals(this.T7a)?!0:!1};t.prototype.fj=function(){this.HOa()};t.prototype.wmc=function(){this.vyb=!0};t.prototype.ej=function(){this.vyb=!0};t.prototype.Ioc=function(){this.Yfc=!0};t.prototype.COa=function(){this.Yfc=!1};t.prototype.onScroll=function(Hb){this.wyb&&1===this.controller.Nn&&
(this.wyb=!1,this.Znd=!0);Hb.stopPropagation()};t.prototype.uoc=function(){this.HOa()};t.prototype.HOa=function(){this.Jhj();this.Fr.LMj(this.NFb);this.controller.Foa(2,"ExcelLiveFollowerOrExplorer::onExploreActionsObserved");this.UHe();this.Qrb()};t.prototype.jMg=function(){this.realtimeChannel.IFa(this.jma);this.$.ea.eoe(this.vnc);pd.a.instance.Dd(this.gridView.domElement).ja("scroll",this.onScroll);this.$.vl(this.od);this.$.pa.Be.LYa(this.J9a);this.$.pa.Be.WYb(this.J9a);this.$.xa.Qf(this.Qe)};
t.prototype.Ydh=function(){this.realtimeChannel&&this.realtimeChannel.Oza(this.jma);null!==this.$&&(this.$.ea.Xcj(this.vnc),this.$.sn(this.od),this.$.pa.Be.pHb(this.J9a),this.$.pa.Be.xJd(this.J9a),this.$.xa.ug(this.Qe))};t.prototype.jma=function(Hb,Lb){this.wFd(Lb.K3);this.CFd(Lb.bP)};t.prototype.wFd=function(Hb){var Lb=this;!Hb||1>Hb.length||2===this.controller.Nn||Hb.forEach(function(sa){sa===Lb.controller.bL&&(Lb.controller.fsc(),Lb.controller.Foa(3,"ExcelLiveFollowerOrExplorer:processDisconnectedClients"))})};
t.prototype.CFd=function(Hb){!Hb||1>Hb.length||(Hb=this.vad(Hb),null!==Hb&&(this.rsd=Hb,2!==this.controller.Nn&&(3===this.controller.Nn?this.gzc(this.pod,Hb):this.ZLb(Hb))))};t.prototype.Jhj=function(){this.Dyb=this.wyb=this.a7a=this.vyb=this.Yfc=!1};t.prototype.vnc=function(){1===this.controller.Nn?this.HOa():this.Fr.DSe=!0};t.prototype.J9a=function(Hb,Lb){this.Fr.QMj(Lb)};t.prototype.Qe=function(){this.a7a||this.HOa()};t.prototype.od=function(Hb,Lb){Lb.Ng||this.Fr.ovi()};t.prototype.enc=function(){this.gridView.nJd(this.enc);
this.Q6h(this.CXj)&&this.Fr.dnf()};Object(F.a)(t,"ExcelLiveFollowerOrExplorer",null,[]);var Ob=b(109),P=b(29),Ba=b(56),ra=b(102),ta=b(376),Ia=b(14);y.prototype.dispose=function(){this.Qrb();this.aeh();this.$=this.gridView=this.viewBlockContainerHelpers=this.lOb=this.realtimeChannel=this.IPa=this.RA=null};y.prototype.lid=function(){qa.ULS.sendTraceTag(537162846,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action performed");this.IPa&&this.IPa.Eq&&ta.a.Iy.notificationBar.removeEntry(this.IPa);if(this.qod)this.G4f(),
qa.ULS.sendTraceTag(537162845,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action ignored due to floating object selection.");else{var Hb=!0;this.DMa||(Hb=this.l2h());Hb?this.v6f():this.G4f()}};y.prototype.jma=function(Hb,Lb){this.wFd(Lb.K3);this.CFd(Lb.bP)};y.prototype.Zcc=function(){var Hb=this;if(0===this.RA.Nn)qa.ULS.sendTraceTag(529064851,0,50,"ExcelLiveParticipantV0::HandleViewportChanged: Viewport changed for presenter.");else if(!this.lOb||this.lOb&&!this.lOb.fp)this.lOb=$b.a.instance.create(function(){Hb.HOa()},
500,"ExcelLiveParticipantV0.HandleViewportChanged",void 0,!0)};y.prototype.HOa=function(){qa.ULS.sendTraceTag(529064849,0,50,"ExcelLiveParticipantV0::onExploreActionsObserved: Explore action observed.");this.VMe();this.DMa||this.t6f("ExcelLiveParticipantV0::onExploreActionsObserved")};y.prototype.G4f=function(){this.IPa||(this.IPa=ta.a.Iy.notificationBar.M$(Ia.a.instance.fa(2207),!1),this.IPa.image=0);ta.a.Iy.notificationBar.$D(this.IPa);qa.ULS.sendTraceTag(528786756,0,50,"ExcelLiveParticipantV0.GoToPresenter - Action not performed. Location not available.")};
y.prototype.initialize=function(){Mb.c(this.$)?(this.A$h(),this.N_b()):(this.yMg(),this.zaf())};y.prototype.A$h=function(){this.RA.Foa(0)};y.prototype.zaf=function(){var Hb=this;++this.x2a;if(this.x2a>this.hTe)qa.ULS.sendTraceTag(527766151,0,10,"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable: Presenter data not available after "+(this.x2a-1)+" retries.");else{var Lb=this.gTe();Lb?this.xaf(Lb):(qa.ULS.sendTraceTag(527766150,0,15,"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable: Retry "+
this.x2a+" - Presenter data not available."),$b.a.instance.create(function(){Hb.zaf()},Xb.a.Ava(this.x2a,this.iTe,this.jTe,!0),"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable",void 0,!0))}};y.prototype.xaf=function(Hb){Hb?(this.x2a=0,qa.ULS.sendTraceTag(537162844,0,50,"ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer: Update received from presenter with CID: "+this.RA.bL+" and messageId:"+this.lla),this.X_=Hb,this.VMe(),this.DMa&&3===this.RA.Nn?this.v6f():this.DMa||this.t6f("ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer")):
qa.ULS.sendTraceTag(527766149,0,50,"ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer: Update not from presenter.")};y.prototype.v6f=function(){this.RA.Foa(1,"ExcelLiveParticipantV0::startFollowing");this.N_b()};y.prototype.t6f=function(Hb){this.RA.Foa(2,Hb);this.Qrb()};y.prototype.yMg=function(){this.realtimeChannel.IFa(this.jma)};y.prototype.aeh=function(){this.realtimeChannel.Oza(this.jma)};y.prototype.N_b=function(){this.gridView.PYa(this.Zcc)};y.prototype.Qrb=function(){this.gridView.gbb(this.Zcc)};
y.prototype.wFd=function(Hb){var Lb=this;!Hb||1>Hb.length||Hb.forEach(function(sa){sa===Lb.RA.bL&&(Lb.X_=void 0,Lb.RA.fsc(),Lb.RA.Foa(3,"ExcelLiveParticipantV0::onMeetingPresenceUpdated"))})};y.prototype.CFd=function(Hb){!Hb||1>Hb.length||(Hb=this.gTe(Hb),this.xaf(Hb))};y.prototype.gTe=function(Hb){Hb=(void 0===Hb?null:Hb)||this.realtimeChannel.udd();if(!Hb)return null;this.RA.bL||this.h9h(Hb);if(this.RA.bL&&(Hb=Hb[this.RA.bL])){var Lb=Hb.MeetingInfo.MessageId;if(this.lla+1<Lb)qa.ULS.sendTraceTag(524940886,
0,15,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Presenter message lost. LastMessageId: "+this.lla+", CurrentMessageId: "+Lb);else{if(this.lla>Lb)return qa.ULS.sendTraceTag(524940885,0,15,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Older Presenter message received. LastMessageId: "+this.lla+", CurrentMessageId: "+Lb),null;if(this.lla===Lb)return qa.ULS.sendTraceTag(524940884,0,50,"ExcelLiveParticipantV0::fetchPresenterSelectionFromPresenceData: Duplicate Presenter message received. LastMessageId: "+
this.lla+", CurrentMessageId: "+Lb),null}this.lla=Lb;return Hb.SelectedRange}return null};y.prototype.h9h=function(Hb){for(var Lb in Hb){var sa=Lb,Ua=Hb[Lb];if((null===Ua||void 0===Ua?0:Ua.MeetingInfo)&&Ua.MeetingInfo.IsPresenter&&Ua.MeetingInfo.MeetingId===this.$.ya.MeetingId){this.lla=Ua.MeetingInfo.MessageId-1;this.RA.puc(sa,"ExcelLiveParticipantV0:identifyPresenterFromPresenceData");break}}};y.prototype.VMe=function(){if(this.X_){var Hb=this.X_.length;qa.ULS.sendTraceTag(537162840,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Called with {0} presenter ranges to evaluate against viewport with [SheetName: {1}, TopLeftCell: {2}, BottomRightCell: {3}]",
Hb,this.$.pa?this.$.pa.sheetName:null,Ob.a.toJSON(this.gridView.tH()),Ob.a.toJSON(this.gridView.gYe()));for(var Lb=0;Lb<Hb;Lb++){var sa=this.X_[Lb].NamedObjectName;qa.ULS.sendTraceTag(529064848,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Evaluating the following range for intersection: [{0}]",Ob.a.toJSON(this.X_[Lb]));if(P.a.i0c(sa)){if(qa.ULS.sendTraceTag(537162837,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to false"),
this.qod=!1,this.X_[Lb].SheetName===this.$.xa.pa.sheetName&&this.gridView.e_(tb.D(this.X_[Lb]))){qa.ULS.sendTraceTag(537162836,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.DMa=!0;return}}else if(qa.ULS.sendTraceTag(537162839,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to true"),this.qod=!0,this.X_[Lb].SheetName===this.$.xa.pa.sheetName&&
this.Mii(sa)){qa.ULS.sendTraceTag(537162838,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.DMa=!0;return}}qa.ULS.sendTraceTag(537162835,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to false")}this.DMa=!1};y.prototype.Mii=function(Hb){var Lb=this;Hb=ra.a(this.$).Up(Hb);if(!Hb||!Hb.floatingObject||!Hb.domElement)return!1;
this.viewBlockContainerHelpers||cb.TaskExtensions.Ba(Ba.GetServiceTaskFactory.Wa(this.$.da,103,104,0),function(Ua){Lb.viewBlockContainerHelpers=Ua.result},this.$.ma,8);if(!this.viewBlockContainerHelpers)return!1;var sa=this.viewBlockContainerHelpers.EZ(Hb.Eg,Hb.domElement);qa.ULS.sendTraceTag(529065985,0,50,"ExcelLiveParticipantV0::IsFoSelectedByPresenterIntersectingWithCurrentViewport: Floating object viewport area TopLeft:[{0}], BottomRight:[{1}]",Ob.a.toJSON(sa.topLeft),Ob.a.toJSON(sa.bottomRight));
return Hb.Eg.pn.Qd(sa)?!0:!1};y.prototype.l2h=function(){qa.ULS.sendTraceTag(537162834,0,50,"ExcelLiveParticipantV0.GoToPresenterLocation - Update participant viewport");var Hb=this.X_&&0<this.X_.length?this.X_[0]:null;if(!Hb||!Hb.SheetName)return!1;var Lb=this.$.xa.getItemByName(Hb.SheetName);if(!Lb||Lb!==this.$.pa&&!Lb.visible)return qa.ULS.sendTraceTag(529109851,0,15,"ExcelLiveParticipantV0.GoToPresenterLocation - sheet not available"),!1;Lb!==this.$.pa&&Lb.activate();this.gridView.Rt(tb.D(Hb),
3,"ExcelLiveParticipantV0.GoToPresenterLocation");return!0};Object(F.a)(y,"ExcelLiveParticipantV0",null,[]);x.prototype.dispose=function(){this.ceh();this.gridView=this.$=this.realtimeChannel=this.controller=null};x.prototype.Mob=function(){this.gnc=this.gnc.bind(this);this.Qva=this.Qva.bind(this);this.Jcc=this.Jcc.bind(this);this.od=this.od.bind(this)};x.prototype.sGj=function(){this.$pc(!0);this.IMg()};x.prototype.IMg=function(){this.$.xa.yJ(this.Jcc);this.gridView.PYa(this.Qva);this.gridView.ha.NG(this.Qva);
this.$.vl(this.od)};x.prototype.ceh=function(){this.$&&(this.$.xa.TF(this.Jcc),this.$.sn(this.od));this.gridView&&(this.gridView.gbb(this.Qva),this.gridView.ha.jL(this.Qva))};x.prototype.Jcc=function(){this.gridView.gbb(this.Qva);this.gridView.XT(this.gnc)};x.prototype.gnc=function(){this.$pc();this.gridView.kO(this.gnc);this.gridView.PYa(this.Qva)};x.prototype.Qva=function(){this.$.xa&&this.$.xa.wcf||this.$pc()};x.prototype.od=function(Hb,Lb){Lb.Ng||this.Fr.mwi()};x.prototype.TNh=function(){var Hb=
lc.HelperMethods.kc(),Lb=this.gridView.qac();if(null===Lb)return null;var sa=this.gridView.G4().wz;var Ua={};Ua.SheetID=this.$.pa?this.$.pa.sheetName:null;Ua.ZoomLevel=mb.a(this.$).zoom;Ua.SelectedRanges=tb.k(this.gridView.ha.va.selectedRanges,this.$);Ua.IndexOfActiveRange=this.gridView.ha.va.aB;Ua.VisibleAreaRange=tb.v(Lb,this.$);Ua.TopLeftCellOffsets={};Ua.TopLeftCellOffsets.X=sa.x;Ua.TopLeftCellOffsets.Y=sa.y;sa=C(this.$,Ua.ZoomLevel);var Yb=sa.pOb;Ua.ViewportHeight=sa.mOb;Ua.ViewportWidth=Yb;
this.Fr.OMj(Lb);this.Fr.Kxa(lc.HelperMethods.kc()-Hb,"ExcelLivePresenter.getCurrentViewportNavigationState: TimeToCreateNavigationState");return Ua};x.prototype.Eqj=function(){this.z_={};this.z_.MeetingId=this.$.ya.MeetingId;this.z_.IsPresenter=!0};x.prototype.$pc=function(Hb){var Lb=this;Hb=void 0===Hb?!1:Hb;var sa=this.TNh();if(null===sa)qa.ULS.sendTraceTag(527962826,0,15,"ExcelLivePresenter:postViewportUpdatesToMeetingParticipants CurrentViewportNavigationState is null");else{var Ua={};Ua.MeetingInfo=
this.z_;Ua.NavigationState=sa;this.realtimeChannel.jYf(Ua);Hb&&ic.EwaSettings.isChangeGateEnabled("OfficeVSO:6085564_ExcelLive_ResendViewportStateAfterInterval")&&$b.a.instance.create(function(){Lb.$pc(Hb)},this.vDi+this.V0g(),"ExcelLivePresenter::postViewportUpdatesToMeetingParticipants",void 0,!0)}};x.prototype.V0g=function(){var Hb=void 0===Hb?-3E3:Hb;return Math.random()*(3E3-Hb+1)+Hb};Object(F.a)(x,"ExcelLivePresenter",null,[]);var bb=b(648),Va;(function(Hb){Hb[Hb.none=0]="none";Hb[Hb.selection=
1]="selection";Hb[Hb.scroll=2]="scroll";Hb[Hb.zoom=4]="zoom";Hb[Hb.default=0]="default"})(Va||(Va={}));Object(F.b)("UpdateType",Va);var lb=b(54);f.prototype.dispose=function(){};f.prototype.ovi=function(){var Hb={};Hb.FollowerViewState=0<this.Qbd?"Hybrid":Ub[this.fjc];Hb.FollowerViewStateTransitions=this.Qbd;Hb.FollowerZoomInOppositeDirectionCount=this.AVe;Hb.ExplorerConsumptionTrends=this.DSe?"WorkbookEdited":"WorkbookViewed";Hb.ExplorerNSVModeTrends=this.utf;Hb.ExplorerNSVSwitchTrends=this.vtf;
Hb=lb.a.Kc(Hb);this.$.sendBeaconTraceTag(526987797,50,!1,"ExcelLiveFollowerOrExplorer.logFollowerOrExplorerTelemetry: "+Hb)};f.prototype.dnf=function(){2E3>lc.HelperMethods.kc()-this.FCc&&(this.Kxa(lc.HelperMethods.kc()-this.FCc,"ExcelLiveFollowerOrExplorer.logNonCompleteViewStateTelemetry: TimeElapsedSinceLastViewportChange"),this.FCc=0)};f.prototype.Kxa=function(Hb,Lb){qa.ULS.sendTraceTag(527499614,0,50,Lb+" = "+Hb)};f.prototype.MMj=function(Hb,Lb){this.fjc&&Hb!==this.fjc&&++this.Qbd;this.fjc=Hb;
this.Kxa(lc.HelperMethods.kc()-Lb,"ExcelLiveFollowerOrExplorer.trackAndLogFollowerViewStateTransitions: TimeElapsedInSyncingFollower")};f.prototype.LMj=function(Hb){this.$$c=lc.HelperMethods.kc();++this.CSe;1===this.CSe&&this.Kxa(lc.HelperMethods.kc()-this.sessionStartTime,"ExcelLiveFollowerOrExplorer.trackAndLogExplorerTransitions: TimeToFirstExplorerTransition");qa.ULS.sendTraceTag(527499613,0,50,"ExcelLiveFollowerOrExplorer.trackAndLogExplorerTransitions: Last Update Type from Presenter Was = {0}. Current View State = {1}",
Va[Hb],ec.g(this.$).qac().FC(!0))};f.prototype.NMj=function(){mb.a(this.$);var Hb=lc.HelperMethods.kc()-this.S_d;1E4>Hb&&(this.Kxa(Hb,"ExcelLiveFollowerOrExplorer.trackAndLogFollowerZoomTrends: TimeToZoomChangeInOppositeDirection"),this.S_d=0);this.PMj()};f.prototype.PMj=function(){lc.HelperMethods.kc()<this.sessionStartTime+12E4&&++this.AVe};f.prototype.Vwi=function(){var Hb=lc.HelperMethods.kc()-this.$$c;5E3>Hb&&this.Kxa(Hb,"ExcelLiveFollowerOrExplorer.logSyncBackToPresenterTelemetry: TimeElapsedToSyncBackSinceBecomingExplorer");
this.$$c=0};f.prototype.Uwi=function(Hb){Hb=void 0===Hb?!1:Hb;this.Kxa(lc.HelperMethods.kc()-this.KUd,"ExcelLiveFollowerOrExplorer.logSyncBackToPresenterTelemetry: Synced via Presence Notification = "+Hb+" TimeElapsedInSyncingExplorerBackToPresenter");this.KUd=0};f.prototype.QMj=function(Hb){typeof Hb===typeof bb.a?++this.utf:++this.vtf};f.prototype.OMj=function(Hb){var Lb=ec.g(this.$).ha.va.activeRange;Hb=Hb.Qd(Lb)?!0:!1;Hb||0!==this.XIb?Hb&&0<this.XIb&&(Hb=lc.HelperMethods.kc()-this.XIb,this.Kxa(Hb,
"ExcelLivePresenter.trackAndLogSelectionVisibilityForPresenter: Selection was outside presenter Viewport. TimeSpentWithoutSelectionVisible"),this.U4c+=Hb,this.XIb=0):this.XIb=lc.HelperMethods.kc()};f.prototype.mwi=function(){var Hb={},Lb=lc.HelperMethods.kc()-this.sessionStartTime;Hb.PercentageTimeSelectionVisible=(Lb-this.U4c)/Lb*100;Hb=lb.a.Kc(Hb);this.$.sendBeaconTraceTag(526987796,50,!1,"ExcelLivePresenter.logPresenterTelemetry: "+Hb)};Sk.Object.defineProperties(f.prototype,{sessionStartTime:{configurable:!0,
enumerable:!0,get:function(){return this.Tge},set:function(Hb){this.Tge=Hb}},CSe:{configurable:!0,enumerable:!0,get:function(){return this.k6d},set:function(Hb){this.k6d=Hb}},$$c:{configurable:!0,enumerable:!0,get:function(){return this.j6d},set:function(Hb){this.j6d=Hb}},FCc:{configurable:!0,enumerable:!0,get:function(){return this.Sje},set:function(Hb){this.Sje=Hb}},AVe:{configurable:!0,enumerable:!0,get:function(){return this.c7d},set:function(Hb){this.c7d=Hb}},Qbd:{configurable:!0,enumerable:!0,
get:function(){return this.d7d},set:function(Hb){this.d7d=Hb}},S_d:{configurable:!0,enumerable:!0,get:function(){return this.mke},set:function(Hb){this.mke=Hb}},DSe:{configurable:!0,enumerable:!0,get:function(){return this.l6d},set:function(Hb){this.l6d=Hb}},utf:{configurable:!0,enumerable:!0,get:function(){return this.pce},set:function(Hb){this.pce=Hb}},vtf:{configurable:!0,enumerable:!0,get:function(){return this.qce},set:function(Hb){this.qce=Hb}},fjc:{configurable:!0,enumerable:!0,get:function(){return this.lae},
set:function(Hb){this.lae=Hb}},KUd:{configurable:!0,enumerable:!0,get:function(){return this.kie},set:function(Hb){this.kie=Hb}},XIb:{configurable:!0,enumerable:!0,get:function(){return this.Ige},set:function(Hb){this.Ige=Hb}},U4c:{configurable:!0,enumerable:!0,get:function(){return this.t4d},set:function(Hb){this.t4d=Hb}}});Object(F.a)(f,"ExcelLiveTelemetryHelper",null,[3]);m.prototype.dispose=function(){this.Nkb&&(this.Nkb.dispose(),this.Nkb=null);this.sib&&(this.sib.dispose(),this.sib=null);this.cib&&
(this.cib.dispose(),this.cib=null);this.Fr&&(this.Fr.dispose(),this.Fr=null);this.$=this.hga=this.Xee=this.Wpa=null};m.prototype.LUd=function(){this.BVe?this.BVe.LUd():qa.ULS.sendTraceTag(537162880,0,10,"ExcelLiveManager::SyncToPresenter - FollowerOrExplorer object is not available to complete the action")};m.prototype.lid=function(){this.SRe?this.SRe.lid():qa.ULS.sendTraceTag(537162851,0,10,"ExcelLiveManager::GoToPresenter - ExcelLiveParticipantV0 object is not available to complete the action")};
m.prototype.dZb=function(Hb){this.Wpa.dZb(Hb)};m.prototype.HJd=function(Hb){this.Wpa.HJd(Hb)};m.prototype.z$h=function(){Mb.e(this.$)?Mb.c(this.$)?this.Nkb=new x(this.$,this.hga,this.Wpa,this.Fr):this.sib=new t(this.$,this.hga,this.Wpa,this.Fr):Mb.d(this.$)&&(this.cib=new y(this.$,this.hga,this.Wpa))};Sk.Object.defineProperties(m.prototype,{rn:{configurable:!0,enumerable:!0,get:function(){return this.Xee}},pPa:{configurable:!0,enumerable:!0,get:function(){return this.Wpa.pPa}},BVe:{configurable:!0,
enumerable:!0,get:function(){return this.sib}},presenter:{configurable:!0,enumerable:!0,get:function(){return this.Nkb}},SRe:{configurable:!0,enumerable:!0,get:function(){return this.cib}}});Object(F.a)(m,"ExcelLiveManager",null,[545,3]);n.prototype.dispose=function(){this.$=null};n.prototype.puc=function(Hb,Lb,sa){qa.ULS.sendTraceTag(527171654,0,50,"ExcelLiveFollowerOrExplorer:"+sa+" Setting presenter information to CID: "+Hb+" from CID: "+this.bL);this.bL=Hb;this.kza=Lb.User.UserName;this.nqc=Lb.UserColor};
n.prototype.fsc=function(){this.nqc=this.kza=this.bL=void 0};Sk.Object.defineProperties(n.prototype,{Nn:{configurable:!0,enumerable:!0,get:function(){return this.Fde},set:function(Hb){this.Fde=Hb}},bL:{configurable:!0,enumerable:!0,get:function(){return this.kee},set:function(Hb){this.kee=Hb}},kza:{configurable:!0,enumerable:!0,get:function(){return this.lee},set:function(Hb){this.lee=Hb}},nqc:{configurable:!0,enumerable:!0,get:function(){return this.mee},set:function(Hb){this.mee=Hb}}});Object(F.a)(n,
"ExcelLiveParticipantModel",null,[3]);var kc=b(244),zb=b(11),Sb;(function(Hb){Hb[Hb.presenter=0]="presenter";Hb[Hb.follower=1]="follower";Hb[Hb.explorer=2]="explorer";Hb[Hb.unknown=3]="unknown"})(Sb||(Sb={}));Object(F.b)("ParticipantRole",Sb);var gb=b(255),Sa=b(19);l.prototype.bKd=function(Hb,Lb,sa,Ua){sa=void 0===sa?null:sa;Ua=void 0===Ua?null:Ua;this.Jxa(Hb,Lb);this.Nn=Lb;this.kza=sa;this.HPa=Ua;this.LUe?(this.LUe=!1,this.SRf()):(this.yWd=!1,this.container.classList.add("ewa-excelLive-meetingPill-container-hidden"))};
l.prototype.dispose=function(){$removeHandler(this.container,"transitionend",this.uoa);$removeHandler(this.container,"transitioncancel",this.uoa);this.container=null};l.prototype.Ne=function(Hb,Lb){if(Lb)return!1;Hb=this.container.querySelectorAll(zb.DOMElementExtensions.Rp);var sa;for(Lb=0;Lb<Hb.length;Lb++){var Ua=Hb[Lb];zb.DOMElementExtensions.canReceiveFocus(Ua)&&(sa=Ua)}if(!sa)return qa.ULS.sendTraceTag(529109852,0,10,"ExcelLiveMeetingPillUtility.SetFocusOnSection: Could not find focusable element in live meeting pill"),
!1;sa.focus();return!0};l.prototype.Yf=function(Hb){return zb.DOMElementExtensions.Oe(this.Jb,Hb)};l.prototype.gi=function(){};l.prototype.Qh=function(){};l.prototype.initialize=function(Hb,Lb){this.container=document.createElement("div");this.container.id="excelLiveMeetingPillContainer";this.container.classList.add("ewa-excelLive-meetingPill-container");Lb.appendChild(this.container);Mb.a(Hb)&&(this.container.style.height="32px",qa.ULS.sendTraceTag(529073433,0,50,"ExcelLiveMeetingPillUtility.initialize:Changed the height of meeting pill container for mobile"));
this.uoa=this.L5h;$addHandler(this.container,"transitionend",this.uoa);$addHandler(this.container,"transitioncancel",this.uoa);gb.a(Hb).Rg(this)};l.prototype.SRf=function(){var Hb={};Hb.participantRole=this.Nn;ic.EwaSettings.isChangeGateEnabled("OfficeVSO:5931413_ShortenMeetingPillDisplayNameForMobile")&&this.$.pR?(qa.ULS.sendTraceTag(527991135,0,50,"ExcelLiveMeetingPillUtility.renderMeetingPillInternal: Getting shortened user name for mobile meeting pill"),Hb.presenterName=this.iZh(this.kza)):Hb.presenterName=
this.kza;Hb.presenterColor=this.HPa;appChrome.renderLiveMeetingPill(this.container,Hb)};l.prototype.iZh=function(Hb){if(Sa.a.oi(Hb))return qa.ULS.sendTraceTag(527991134,0,15,"ExcelLiveMeetingPillUtility.getShortenedUserName: Username is null or empty"),Hb;var Lb=Hb.split(" "),sa=Lb.length;return 2>sa||Sa.a.oi(Lb[sa-1])?Hb:Lb[0]+" "+Lb[sa-1].substring(0,1)};l.prototype.Jxa=function(Hb,Lb){if(0===this.lastUpdateTime)qa.ULS.sendTraceTag(527766152,0,50,Hb+"::FirstRole - ["+Sb[Lb]+"]");else{var sa=lc.HelperMethods.kc()-
this.lastUpdateTime;qa.ULS.sendTraceTag(528786757,0,50,"{0}:RoleTransition: Transition participant role from [{1}] to [{2}] after {3}s",Hb,Sb[this.Nn],Sb[Lb],(sa/1E3).toFixed(2))}this.lastUpdateTime=lc.HelperMethods.kc()};Sk.Object.defineProperties(l.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return this.container}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!!this.container&&2===this.Nn}},Zd:{configurable:!0,enumerable:!0,get:function(){return kc.a.Hlf}}});
Object(F.a)(l,"ExcelLiveMeetingPillUtility",null,[112,3]);e.prototype.zHb=function(Hb,Lb){this.Nn=Hb;this.HPa=void 0===Lb?null:Lb;appChrome.renderLiveMeetingBoundary(this.container,this.jPg)};e.prototype.dispose=function(){this.container=null;this.$.mD(this.rab);this.$.Vdj(this.rab)};e.prototype.initialize=function(Hb){this.Mob();this.container=document.createElement("div");this.container.id="excelLiveMeetingBoundaryContainer";this.container.classList.add("ewa-excelLive-meetingBoundary-container");
Hb.append(this.container);this.zHb(this.Nn,this.HPa);this.$.nA(this.rab);this.$.XGg(this.rab)};e.prototype.Mob=function(){this.rab=this.rab.bind(this)};e.prototype.rab=function(){this.zHb(this.Nn,this.HPa)};Sk.Object.defineProperties(e.prototype,{IFh:{configurable:!0,enumerable:!0,get:function(){var Hb;return(Hb=this.ph?document.getElementById("AdditionalBarsRegion"):document.getElementById(this.$.Ib+sc.a.e1a))?Hb.clientHeight:0}},vSg:{configurable:!0,enumerable:!0,get:function(){var Hb;return(Hb=
this.ph?document.getElementById("BusinessBar"):document.getElementById(this.$.Ib+sc.a.Bve))?Hb.clientHeight:0}},AAh:{configurable:!0,enumerable:!0,get:function(){var Hb=null;this.ph&&(Hb=document.getElementById("FarPaneRegion"));return Hb?Hb.clientWidth:0}},MJg:{configurable:!0,enumerable:!0,get:function(){var Hb=Mb.a(this.$)?(Hb=document.getElementById(this.$.Ib+sc.a.g0a))?Hb.clientHeight:0:this.$.Yka?0:this.$.GTg();return Hb}},Hwj:{configurable:!0,enumerable:!0,get:function(){var Hb;return(Hb=this.ph?
document.getElementById("Header"):document.getElementById(sc.a.eGa))?Hb.clientHeight:0}},T0c:{configurable:!0,enumerable:!0,get:function(){return this.ph?document.getElementById("EditorContainer"):this.$.Qy}},Gue:{configurable:!0,enumerable:!0,get:function(){return this.Hwj+this.MJg+this.vSg+this.IFh}},iPg:{configurable:!0,enumerable:!0,get:function(){return this.T0c.clientLeft}},kPg:{configurable:!0,enumerable:!0,get:function(){return this.T0c.clientWidth+this.AAh-3}},hPg:{configurable:!0,enumerable:!0,
get:function(){if(this.ph){var Hb=document.getElementById("StatusBar");return Hb.offsetTop+Hb.clientHeight-this.Gue}return this.T0c.clientHeight}},jPg:{configurable:!0,enumerable:!0,get:function(){var Hb={};Hb.participantRole=this.Nn;Hb.presenterColor=this.HPa;Hb.top=this.Gue;Hb.left=this.iPg;Hb.width=this.kPg;Hb.height=this.hPg;Hb.size=3;return Hb}}});Object(F.a)(e,"ExcelLiveMeetingBoundaryUtility",null,[3]);var Kb=pb.a;vm(c,Kb);c.prototype.dispose=function(){this.$=null;this.Iv&&(this.Iv.dispose(),
this.Iv=null);this.fJa&&(this.fJa.dispose(),this.fJa=null);this.eJa&&(this.eJa.dispose(),this.eJa=null)};c.prototype.Foa=function(Hb,Lb){if(void 0==this.Iv.Nn||this.Iv.Nn!==Hb)this.Iv.Nn=Hb,this.Oej(void 0===Lb?null:Lb)};c.prototype.puc=function(Hb,Lb){if(Hb){var sa=this.$.ea.Qhd(Hb);sa?(this.Iv.puc(Hb,sa,Lb),this.raiseEvent(c.HEd)):qa.ULS.sendTraceTag(528086351,0,10,"ExcelLiveController:savePresenterDetails Failed to get presenter information from sessionStateManager")}else qa.ULS.sendTraceTag(528086352,
0,10,"ExcelLiveController:savePresenterDetails Presenter CID is undefined")};c.prototype.fsc=function(){this.Iv.fsc()};c.prototype.dZb=function(Hb){this.addHandler(c.HEd,Hb)};c.prototype.HJd=function(Hb){this.removeHandler(c.HEd,Hb)};c.prototype.Nai=function(){this.Iv=new n(this.$);var Hb=this.$.Qy;Ja.AFrameworkApplication.sa.Qa.ph&&(Hb=document.getElementById("StatusBarRegion"));this.fJa=new l(this.$,Hb);Hb=this.$.dr;Ja.AFrameworkApplication.sa.Qa.ph&&(Hb=document.getElementById("regionComposerRoot"));
this.Szb&&(this.eJa=new e(this.$,Hb));Hb=Mb.c(this.$)?0:3;this.Foa(Hb,"ExcelLiveController::initializeController")};c.prototype.Oej=function(Hb){switch(this.Iv.Nn){case 2:this.fJa.bKd(Hb,this.Iv.Nn,this.Iv.kza);this.Szb&&this.eJa.zHb(this.Iv.Nn);break;case 1:this.fJa.bKd(Hb,this.Iv.Nn,this.Iv.kza,this.Iv.nqc);this.Szb&&this.eJa.zHb(this.Iv.Nn,this.Iv.nqc);break;case 3:case 0:this.fJa.bKd(Hb,this.Iv.Nn),this.Szb&&this.eJa.zHb(this.Iv.Nn)}};Sk.Object.defineProperties(c.prototype,{pPa:{configurable:!0,
enumerable:!0,get:function(){return this.Iv}},Nn:{configurable:!0,enumerable:!0,get:function(){return this.Iv.Nn}},bL:{configurable:!0,enumerable:!0,get:function(){return this.Iv.bL}}});c.HEd="PDS";Object(F.a)(c,"ExcelLiveController",pb.a,[3]);var Gc=ib.a;vm(a,Gc);a.prototype.create=function(){this.y$h()};a.prototype.dispose=function(){this.rn&&this.rn.tHb(this.POa);this.rn=null;this.RA&&(this.RA.dispose(),this.RA=null);Gc.prototype.dispose.call(this)};a.prototype.y$h=function(){var Hb=this;this.RA=
new c(this.$);this.$.da.Za(26,function(Lb){Hb.rn=Lb;Hb.D1g()})};a.prototype.D1g=function(){qa.ULS.sendTraceTag(537162850,0,50,"ExcelLiveCommandHandlerFactory::ConnectToRealTimeChannel - attach RealTimeChannelInitialized handler");this.rn.xVc(this.POa);this.rn.K_a()};a.ja=function(Hb){qa.ULS.sendTraceTag(537162848,0,50,"ExcelLiveManagerFactory::Attach: Begin service registration");Hb.da.Ha(474,new a(Hb));qa.ULS.sendTraceTag(537162847,0,50,"ExcelLiveManagerFactory::Attach: Complete service registration")};
Object(F.a)(a,"ExcelLiveManagerFactory",ib.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ExcelLive");Type.registerNamespace("_Ewa");A.a.$i(".ewa-excelLive-meetingPill-container{height:24px;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s;position:absolute;width:100%;bottom:0;pointer-events:none;z-index:992}.ewa-excelLive-meetingPill-container-hidden{height:0 !important;overflow:hidden;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s}.ewa-excelLive-meetingBoundary-container{position:fixed;z-index:992}");
Type.registerNamespace("Common.App.RtcHostNotificationSubscription");fa.main();Type.registerNamespace("Common.App.LivePersonaCard.Contracts");Type.registerNamespace("Common.App.LivePersonaCard");v.main();Type.registerNamespace("AppRealtimeChannel");(function(){za.a.Ga(function(Hb){a.ja(Hb);r.ja(Hb)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.rt.js.map/c4703527e4fdb6d9a6d6eee0f7c03c5e/EwaDS.rt.js.map