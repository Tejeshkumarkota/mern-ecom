(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[28],{1263:function(A,F,b){function a(){var z=B.call(this)||this;z.uBi=3E4;z.oeb={};z.QZd={};z.jue={};z.Qgf=!1;z.Qgf=n.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PublishToAsha",!1);return z}function c(z){var u=y.call(this)||this;u.$=z;u.dc();return u}b.r(F);A=b(0);var e=b(13),l=b(95),n=b(1),m=b(74),f=b(9),x=b(214),y=x.a;vm(c,y);c.prototype.create=function(){var z=b(1263).RenderingFidelityTracker,u=this.$.da.Aa(462);
u||(u=this.$.da.Ha(462,new z));this.Fb(u)};Object(A.a)(c,"RenderingFidelityTrackerFactory",x.a,[]);var t=b(46);b.d(F,"RenderingFidelityTracker",function(){return a});var B=m.a;vm(a,B);a.ja=function(z){z.da.Ha(463,new c(z))};a.prototype.uJg=function(z,u,C,r){var J=this;if(!(t.PageLoadTrackingInfo.instance.Pja(new Date)<this.uBi)){var v=f.HelperMethods.Zxa(function(){for(var D=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(u),V=Object.keys(D),U=J.jue[z],Q=0;Q<V.length;Q++){var la=V[Q];
J.QZd[la]||(null===U||void 0===U?0:U[la])&&J.oeb[la]&&(J.oeb[la]-=U[la])}J.jue[z]=D;for(Q=0;Q<V.length;Q++)if(U=V[Q],!J.QZd[U])if(la=D[U],J.oeb[U]&&(la+=J.oeb[U]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(U,la)){J.QZd[U]=!0;J.Qgf&&(D=gridRenderer.CanvasRendererGlobals.getErrorTypeForRenderingFidelityProblem(U),V=gridRenderer.CanvasRendererGlobals.getVetoForRenderingFidelityProblem(U),D&&V&&l.Health.instance.recordQosError(D,[V],!1,!0,!0,!1,null));e.ULS.sendTraceTag(527472324,
0,50,"Session Vetoed because of : { key:"+U+", isHC:"+C+", scaleFactor:"+r+"}");break}else J.oeb[U]=la});1<v&&e.ULS.sendTraceTag(527472323,1,50,"RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration={0}",v)}};Object(A.a)(a,"RenderingFidelityTracker",m.a,[349,3])},1378:function(A,F,b){function a(Ca){var ua=this;this.i9a=function(){ua.wHf(ua.$Ue)};this.Jg=function(){ua.wHf(ua.BOg)};this.$=Ca;this.BOg=new Fd.a;this.$Ue=new Fd.a;ve.g(this.$).Ca.Fp(this.Jg);
ve.g(this.$).Ca.qne(this.i9a)}function c(Ca,ua,sb){this.IWj=Ca;this.eV=ua;this.name=sb}function e(Ca,ua,sb,Ld,le,nf,ug){ua=void 0===ua?null:ua;sb=void 0===sb?null:sb;Ld=void 0===Ld?null:Ld;le=void 0===le?null:le;nf=void 0===nf?!1:nf;ug=void 0===ug?null:ug;var Cf=si.call(this)||this;Cf.azh=[La.a.yue,La.a.gNe,La.a.hNe,La.a.Aec,La.a.Fjc,La.a.fmf,La.a.renderCachedContent,La.a.renderServerContent,La.a.z4b,La.a.pWf,La.a.qWf,La.a.rWf,La.a.dpj];Cf.Whe=null;Cf.YWa=null;Cf.Hte=null;Cf.Rae=null;Cf.ifb=null;
Cf.UNb=null;Cf.SCa=null;Cf.hlb=null;Cf.wue=!1;Cf.rHf=!1;Cf.Dgg=null;Cf.NKd=null;Cf.Jfg=null;Cf.Gfg=null;Cf.Hfg=null;Cf.ACf=function(Cg,Ag){for(Cg=0;Cg<Ag.entries.length;Cg++){var eh=Ag.entries[Cg];eh.url=Qd.a.removeParameter(eh.url,of.AFrameworkApplication.OP);var jh=Qd.a.hda(eh.url);Cf.vmi(eh.url,jh)&&(eh.behavior=1);if("img"===eh.mu.initiatorType&&jh.endsWith(Sg.a.vKe)){var Pg=Qd.a.x4(eh.url,Sg.a.M7c),te=Qd.a.x4(eh.url,Sg.a.N7c);eh.S$=eh.S$+"imageID="+Pg+", imgStateID="+te}Pg=eh.mu[La.a.transferSize];
te=void 0;void 0!==Pg&&null!==Pg&&(te=0===Pg);yd.PageLoadTrackingInfo.instance.ECg(jh,Math.round(eh.mu.fetchStart),Math.round(eh.mu.responseEnd),te,Cf.Sni);hf.a.contains(jh,La.a.richTextEditor,!0)&&(jh=ih.TextEditorTelemetry.instance,jh.bE(La.a.oij,Math.round(eh.mu.fetchStart)),jh.bE(La.a.qij,Math.round(eh.mu.responseEnd)))}};Cf.mW=function(){var Cg=Cf.H7,Ag;for(Ag in Cg)Cg[Ag].h=!0};Cf.g8=function(Cg,Ag){Ag&&Cf.Fe&&Ag.XFa.IsWindowHidden!=Cf.Fe.Di&&(ge.ULS.sendTraceTag(0,0,15,"TelemetryManager: document visibility inconsistency, forcing an update. Hidden state: Observer:{0}, Document:{1}",
Cf.Fe.Di,Ag.XFa.IsWindowHidden),Cf.Fe.jFh())};Cf.userSessionId=Ca;Cf.z0a=ua=ua||new Ah.a;Cf.mh=sb||Df.a.Ra;Cf.mHj=Ld||Cf;Cf.Fe=le;Cf.Sni=nf;Cf.WGe=ua.t8a();Cf.na=ug;Cf.Fe&&Cf.Fe.DFa(Cf.mW);ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixDocumentVisibilityObserverState",!1)&&Cf.na&&Cf.na.P9(Cf.g8);return Cf}function l(){}function n(){}function m(){}function f(){}function x(){}function y(){}function t(Ca,ua){this.rMd=void 0===ua?1:ua;this.total=Ca}function B(){var Ca=pi.call(this)||
this;Ca.GDi=0;Ca.operation="DOMUpdate";Ca.target=null;Ca.sender=null;return Ca}function z(Ca,ua){function sb(nf,ug){null!=ug&&(Ld[nf]=ug)}var Ld={},le=null;switch(Ca){case 0:le="Actions";sb("Id",ua.a);sb("Operation",null==ua.b?null:ua.b);sb("Target",ua.c);sb("StartTime",null==ua.d?null:ua.d.toString());sb("Duration",null==ua.e?null:ua.e.toString());sb("CorrelationId",ua.f);sb("ParentAction",ua.g);sb("DocumentHidden",null==ua.h?null:ua.h.toString());break;case 1:le="CorrelationStart";sb("CorrelationId",
ua.a);sb("UserSessionId",ua.b);sb("UserAction",ua.c);break;case 2:le="ReorderSheetOp";sb("UserSessionId",ua.a);sb("IsDragReorder",null==ua.b?null:ua.b.toString());sb("DocumentUp",null==ua.c?null:ua.c.toString());sb("OldIndex",null==ua.d?null:ua.d.toString());sb("NewIndex",null==ua.e?null:ua.e.toString());sb("TotalSheets",null==ua.f?null:ua.f.toString());break;case 3:le="FormatCellOp";sb("UserSessionId",ua.a);sb("TaskId",null==ua.b?null:ua.b.toString());sb("NumberOfRanges",null==ua.c?null:ua.c.toString());
sb("Ranges",ua.d);sb("ActiveCell",ua.e);sb("ActionId",null==ua.f?null:ua.f.toString());sb("CommandParameters",ua.g);sb("UserActionStopwatchId",ua.h);break;case 4:le="CopyOp";sb("UserSessionId",ua.a);sb("IsChrome",null==ua.b?null:ua.b.toString());sb("IsIE",null==ua.c?null:ua.c.toString());sb("IsFromUI",null==ua.d?null:ua.d.toString());sb("IsCopyInLoadedRange",null==ua.e?null:ua.e.toString());sb("IsRepeatedCopy",null==ua.f?null:ua.f.toString());sb("IsClipboarAccessSupported",null==ua.g?null:ua.g.toString());
sb("IsClipboarAccessInstallationSupported",null==ua.h?null:ua.h.toString());sb("RibbonCommand",null==ua.i?null:ua.i.toString());sb("CutCopyPasteFlags",null==ua.j?null:ua.j.toString());sb("IsDrag",null==ua.k?null:ua.k.toString());sb("IsIeBeforeAlowDenyPopUp",null==ua.l?null:ua.l.toString());sb("IsPasteMatchCopy",ua.m);sb("WaitMessageInClipboard",ua.n);sb("CallCount",null==ua.o?null:ua.o.toString());break;case 5:le="PasteOp";sb("UserSessionId",ua.a);sb("IsChrome",null==ua.b?null:ua.b.toString());sb("IsIE",
null==ua.c?null:ua.c.toString());sb("IsCopyActive",null==ua.d?null:ua.d.toString());sb("IsFromUI",null==ua.e?null:ua.e.toString());sb("IsClipboarAccessSupported",null==ua.f?null:ua.f.toString());sb("IsClipboarAccessInstallationSupported",null==ua.g?null:ua.g.toString());sb("RibbonCommand",null==ua.h?null:ua.h.toString());sb("CutCopyPasteFlags",null==ua.i?null:ua.i.toString());sb("WaitMessageInClipboard",ua.j);sb("PopupDialog",ua.k);sb("SimplePopupMessage",ua.l);sb("DialogCloseButton",ua.m);sb("UserPressedInstallLink",
ua.n);sb("CallCount",null==ua.o?null:ua.o.toString());break;case 6:le="GetNumberViewModelDataOp";sb("UserSessionId",ua.a);sb("NumberFormatOptionsPreviousOutputJson",ua.b);sb("NumberFormatOptionsNewInputJson",ua.c);break;case 7:le="InstantaneousSetData";sb("Id",ua.a);sb("WasEmpty",null==ua.b?null:ua.b.toString());sb("ValueNotChanged",null==ua.c?null:ua.c.toString());sb("Source",ua.d);sb("ProcessingCompleted",null==ua.e?null:ua.e.toString());break;case 8:le="ImmediateSetData";sb("ClientStopwatchId",
ua.a);sb("Operation",ua.b);sb("Parameters",ua.c);sb("WasUpdatedByImmediate",null==ua.d?null:ua.d.toString());sb("areHtmlElementsEqualClientComparison",null==ua.e?null:ua.e.toString());sb("WasDecisionMadeByHtmlComparison",null==ua.f?null:ua.f.toString());sb("IsNumeric",null==ua.g?null:ua.g.toString());sb("IsDateTime",null==ua.h?null:ua.h.toString());sb("HasCurrencySymbol",null==ua.i?null:ua.i.toString());sb("HasPercentSymbol",null==ua.j?null:ua.j.toString());sb("IsFunc",null==ua.k?null:ua.k.toString());
sb("DiffInWrappingWhitespace",null==ua.l?null:ua.l.toString());sb("ImmediatePattern",ua.m);sb("TextAlignmentMatch",null==ua.n?null:ua.n.toString());sb("FontColorMatch",null==ua.o?null:ua.o.toString());sb("FormulaTextMatch",null==ua.p?null:ua.p.toString());sb("isFormula",null==ua.q?null:ua.q.toString());sb("FormulaText",ua.r);sb("InstantaneousPattern",ua.s);sb("AreHtmlInnerTextElementsEqualClientComparison",null==ua.t?null:ua.t.toString());sb("HtmlComparisonDecision",ua.u);break;case 9:le="DependentCellsCalc";
sb("CalcStatus",ua.a);sb("SuccessfullyCalculatedRanges",null==ua.b?null:ua.b.toString());sb("RangesSkipped",null==ua.c?null:ua.c.toString());sb("TotalErrors",null==ua.d?null:ua.d.toString());sb("Partial",null==ua.e?null:ua.e.toString());sb("Canceled",null==ua.f?null:ua.f.toString());sb("Aggregate",null==ua.g?null:ua.g.toString());sb("Unknown",null==ua.h?null:ua.h.toString());sb("UnavailableData",null==ua.i?null:ua.i.toString());sb("Cycle",null==ua.j?null:ua.j.toString());sb("NotImplemented",null==
ua.k?null:ua.k.toString());sb("InvalidInput",null==ua.l?null:ua.l.toString());sb("AreDepCells",null==ua.m?null:ua.m.toString());break;case 10:le="DependentCellsGraphStat";sb("ParsedFormulas",null==ua.a?null:ua.a.toString());sb("GraphNodes",null==ua.b?null:ua.b.toString());sb("GraphArcs",null==ua.c?null:ua.c.toString());sb("AnalyzedBlocks",null==ua.d?null:ua.d.toString());sb("IterationId",null==ua.e?null:ua.e.toString());sb("UniqueId",ua.f);sb("Aborted",null==ua.g?null:ua.g.toString());break;case 11:le=
"DependentCellsGraphSectionStat";sb("IterationId",null==ua.a?null:ua.a.toString());sb("BlockHash",ua.b);sb("Functions",ua.c);sb("Operators",ua.d);sb("CrossDocRefs",null==ua.e?null:ua.e.toString());sb("CrossSheetRefs",null==ua.f?null:ua.f.toString());sb("ErrRefs",null==ua.g?null:ua.g.toString());sb("LargeRanges",null==ua.h?null:ua.h.toString());sb("NameRefs",null==ua.i?null:ua.i.toString());sb("ParserErrors",null==ua.j?null:ua.j.toString());sb("RowRefs",null==ua.k?null:ua.k.toString());sb("ColumnRefs",
null==ua.l?null:ua.l.toString());sb("TableRefs",null==ua.m?null:ua.m.toString());sb("UniqueId",ua.n);sb("UnreachableReferences",null==ua.o?null:ua.o.toString());break;case 12:le="GetRangeContentPrefetchFailures";sb("UserSessionId",ua.a);sb("ClientStopwatchId",ua.b);sb("StateId",null==ua.c?null:ua.c.toString());break;case 13:le="GridBlockUpdates";sb("UserSessionId",ua.a);sb("CorrelationId",ua.b);sb("Operation",ua.c);sb("PerformanceType",null==ua.d?null:ua.d.toString());sb("BlockHash",ua.e);sb("DurationInMs",
null==ua.f?null:ua.f.toString());break;case 14:le="BrowserAppStart";sb("ScriptExecutionStart",null==ua.a?null:zg.a.cta(ua.a.getTime()));sb("UserSessionId",ua.b);sb("ClockMechanism",ua.c);sb("ScreenDPI",null==ua.d?null:ua.d.toString());sb("NavigationToScriptExecutionDelta",null==ua.e?null:ua.e.toString());break;case 15:le="LinkedObjects";sb("ChildId",ua.a);sb("ParentId",ua.b);sb("ChildTable",ua.c);sb("ParentTable",ua.d);break;case 16:le="LongFrames";sb("StartTime",null==ua.a?null:zg.a.cta(ua.a.getTime()));
sb("DurationInMs",null==ua.b?null:ua.b.toString());break;case 17:le="Task";sb("StopwatchId",ua.a);sb("Status",null==ua.b?null:ua.b.toString());sb("CreateTime",null==ua.c?null:ua.c.toString());sb("TaskId",null==ua.d?null:ua.d.toString());break;case 18:le="ConflictInEditing";sb("OtherUserState",ua.a);sb("UserSessionId",ua.b);sb("ConflictTime",null==ua.c?null:zg.a.cta(ua.c.getTime()));break;case 19:le="IncomingPresenceData";sb("UserSessionId",ua.a);sb("UserId",ua.b);sb("Disconnected",null==ua.c?null:
ua.c.toString());sb("ReceivedTime",null==ua.d?null:zg.a.cta(ua.d.getTime()));break;case 20:le="EditorTableDelay";sb("UserSessionId",ua.a);sb("UserId",ua.b);sb("Received",null==ua.c?null:ua.c.toString());sb("DurationInMs",null==ua.d?null:ua.d.toString());sb("NotAloneAtLogTime",null==ua.e?null:ua.e.toString());sb("Time",null==ua.f?null:zg.a.cta(ua.f.getTime()));break;case 21:le="PresenceStartup";sb("UserSessionId",ua.a);sb("EverReceived",null==ua.b?null:ua.b.toString());sb("NotAloneOnOpen",null==ua.c?
null:ua.c.toString());sb("NotAloneAtLogTime",null==ua.d?null:ua.d.toString());sb("EditorCount",null==ua.e?null:ua.e.toString());sb("WorkbookOpenToFirstReceivedInMs",null==ua.f?null:ua.f.toString());break;case 22:le="PresenceDelete";sb("UserSessionId",ua.a);sb("UserId",ua.b);sb("Context",ua.c);sb("Reason",ua.d);sb("Time",null==ua.e?null:zg.a.cta(ua.e.getTime()));break;case 23:le="EditorEvent";sb("UserSessionId",ua.a);sb("UserId",ua.b);sb("Context",ua.c);sb("Time",null==ua.d?null:zg.a.cta(ua.d.getTime()));
break;case 24:le="EditorTime";sb("UserSessionId",ua.a);sb("UserId",ua.b);sb("DurationInMs",null==ua.c?null:ua.c.toString());break;case 25:le="GridScreenReaderOps";sb("UserSessionId",ua.a);sb("CommandTaskId",ua.b);sb("CommandId",null==ua.c?null:ua.c.toString());sb("ClientSideOnly",null==ua.d?null:ua.d.toString());sb("DurationInMS",null==ua.e?null:ua.e.toString());sb("ReachedMaxReadoutCells",null==ua.f?null:ua.f.toString());sb("RequstedCellCount",null==ua.g?null:ua.g.toString());sb("NonEmptyCellCount",
null==ua.h?null:ua.h.toString());sb("Succeeded",null==ua.i?null:ua.i.toString());sb("Canceled",null==ua.j?null:ua.j.toString());sb("ErrorType",ua.k);break;case 26:le="SendPresenceToService";sb("UserSessionId",ua.a);sb("TotalCount",null==ua.b?null:ua.b.toString());sb("SendCount",null==ua.c?null:ua.c.toString());break;case 27:le="IME";sb("UserSessionId",ua.a);break;case 28:le="FreezePaneFloatingObjects";sb("UserSessionId",ua.a);sb("ObjectType",null==ua.b?null:ua.b.toString());sb("ObjectID",ua.c);sb("SpannedPanesCount",
null==ua.d?null:ua.d.toString());break;case 29:le="CustomizeStatusBar";sb("UserSessionId",ua.a);sb("UIControlName",ua.b);sb("IsControlVisible",null==ua.c?null:ua.c.toString());break;case 30:le="ClientWebRequests";sb("Path",ua.a);sb("ProxyStopwatchId",ua.b);sb("RequestStatus",ua.c);sb("ResponseSizeInBytes",null==ua.d?null:ua.d.toString());sb("ClientRequestId",ua.e);sb("StateId",null==ua.f?null:ua.f.toString());break;case 31:le="ShowCommentTaskPane";sb("UserSessionId",ua.a);sb("IsFromKeyboardShortcut",
null==ua.b?null:ua.b.toString());sb("IsShowPane",null==ua.c?null:ua.c.toString());sb("ShowForDeepLink",null==ua.d?null:ua.d.toString());sb("DeepLinkFound",null==ua.e?null:ua.e.toString());break;case 32:le="ApplyThreadedCommentChange";sb("UserSessionId",ua.a);sb("Operation",null==ua.b?null:ua.b.toString());sb("CommentId",ua.c);sb("CommentsCount",null==ua.d?null:ua.d.toString());break;case 33:le="UpgradeLegacyCommentsChange";sb("UserSessionId",ua.a);sb("OperationSuccessful",null==ua.b?null:ua.b.toString());
break;case 34:le="FindNextOrPreviousComment";sb("UserSessionId",ua.a);sb("Succeeded",null==ua.b?null:ua.b.toString());break;case 35:le="Goto";sb("UserSessionId",ua.a);sb("IsSucceeded",null==ua.b?null:ua.b.toString());sb("IsNOVMode",null==ua.c?null:ua.c.toString());break;case 36:le="LaunchOfficeAddInDialog";sb("UserSessionId",ua.a);sb("SourceId",ua.b);sb("SourceLabel",ua.c);sb("Flight",ua.d);sb("Experiment",ua.e);sb("UICultureTag",ua.f);sb("UICultureTagLcid",null==ua.g?null:ua.g.toString());sb("WacHostId",
null==ua.h?null:ua.h.toString());break;case 37:le="RichApiInvocation";sb("UserSessionId",ua.a);sb("Succeeded",null==ua.b?null:ua.b.toString());sb("ErrorType",ua.c);sb("ResultInfo",ua.d);sb("Source",ua.e);break;case 38:le="FxLibrary";sb("EntityName",ua.a);sb("EntryPoint",null==ua.b?null:ua.b.toString());sb("Action",null==ua.c?null:ua.c.toString());sb("InsertLocation",null==ua.d?null:ua.d.toString());break;case 39:le="EmbeddedApiSession";sb("UserSessionId",ua.a);break;case 40:le="NumberFormattingCalculator";
sb("Id",ua.a);sb("CounterName",ua.b);sb("Values",ua.c);break;case 41:le="RequestDataAfterSend";sb("ClientStopwatchId",ua.a);sb("RequestStatus",ua.b);sb("SendDuration",null==ua.c?null:ua.c.toString());sb("RequestId",null==ua.d?null:ua.d.toString());break;case 42:le="FloatingObjectsStopwatchData";sb("StopMessage",ua.a);sb("Type",null==ua.b?null:ua.b.toString());sb("GUID",ua.c);sb("Pane",null==ua.d?null:ua.d.toString());sb("IsAboveGrid",null==ua.e?null:ua.e.toString());sb("StartCorrelation",ua.f);sb("LoadImageCorrelation",
ua.g);sb("SkippedGetEffectsExtents",null==ua.h?null:ua.h.toString());sb("Version",null==ua.i?null:ua.i.toString());break;case 43:le="Copy";sb("UserSessionId",ua.a);sb("Trigger",ua.b);sb("RibbonCommandName",ua.c);sb("SourceItem",ua.d);sb("SourceRangeCellCount",null==ua.e?null:ua.e.toString());sb("ClientSideStopwatchId",ua.f);sb("CopyOperationId",ua.g);sb("IsAsync",null==ua.h?null:ua.h.toString());sb("IsFromCache",null==ua.i?null:ua.i.toString());sb("IsSuccessiveCopy",null==ua.j?null:ua.j.toString());
sb("IsSelectionAllowed",null==ua.k?null:ua.k.toString());sb("IsSuccess",null==ua.l?null:ua.l.toString());sb("IsExpectedError",null==ua.m?null:ua.m.toString());sb("ExpectedErrorReason",ua.n);sb("ErrorMessage",ua.o);sb("ClientSideCopyTimeInMs",null==ua.p?null:ua.p.toString());sb("TotalTimeInMs",null==ua.q?null:ua.q.toString());sb("PlainTextPayloadSize",null==ua.r?null:ua.r.toString());sb("CopyPasteTargetType",ua.s);sb("ShadowWorkbookPayloadSize",null==ua.t?null:ua.t.toString());sb("HtmlPayloadSize",
null==ua.u?null:ua.u.toString());sb("HtmlSizeExceedsLimit",null==ua.v?null:ua.v.toString());sb("CopyTotalSizeExceedsLimit",null==ua.w?null:ua.w.toString());sb("ErrorReason",null==ua.x?null:ua.x.toString());sb("ErrorName",ua.y);sb("IsSucceededWithAlert",null==ua.z?null:ua.z.toString());sb("EncounteredDeploymentErrors",null==ua.ba?null:ua.ba.toString());sb("ShadowWorkbookSizeExceedsLimit",null==ua.bb?null:ua.bb.toString());sb("CopyPasteTargetName",ua.bc);sb("CCPSliceName",ua.bd);sb("SyncClipboardItemsKeys",
ua.be);sb("AsyncClipboardItemsKeys",ua.bf);sb("CopyPasteHandlerName",ua.bg);sb("SucceededPopulatingSystemClipboardSync",ua.bh);sb("SucceededPopulatingSystemClipboardAsync",ua.bi);sb("Location",ua.bj);sb("CopyContextId",ua.bk);sb("ServerRequestTimeInMs",null==ua.bl?null:ua.bl.toString());sb("EcsOperationDuration",null==ua.bm?null:ua.bm.toString());sb("EcsRequestDuration",null==ua.bn?null:ua.bn.toString());sb("WfeRequestDuration",null==ua.bo?null:ua.bo.toString());sb("OriginalSourceRangesCountExceedsLimit",
null==ua.bp?null:ua.bp.toString());sb("UploadToClipServiceAttempted",null==ua.bq?null:ua.bq.toString());sb("FloatingObjectType",null==ua.br?null:ua.br.toString());break;case 44:le="Paste";sb("UserSessionId",ua.a);sb("Trigger",ua.b);sb("RibbonCommandName",ua.c);sb("PasteTypeFlagValue",null==ua.d?null:ua.d.toString());sb("PasteOperationId",ua.e);sb("CopyOperationId",ua.f);sb("ClientSideStopwatchId",ua.g);sb("OriginalDestinationRange",ua.h);sb("ExpandDestinationRange",ua.i);sb("SourceItem",ua.j);sb("SourceRangeCellCount",
null==ua.k?null:ua.k.toString());sb("IsSuccess",null==ua.l?null:ua.l.toString());sb("IsExpectedError",null==ua.m?null:ua.m.toString());sb("ClipboardFormatReadTimeInMs",ua.n);sb("ClipboardFormatReadStatus",ua.o);sb("ClipboardReadPermissionPromptShown",null==ua.p?null:ua.p.toString());sb("AsyncApiReadTimedOut",null==ua.q?null:ua.q.toString());sb("ExpectedErrorReason",ua.r);sb("ErrorMessage",ua.s);sb("TotalTimeInMs",null==ua.t?null:ua.t.toString());sb("PlainTextPayloadSize",null==ua.u?null:ua.u.toString());
sb("ShadowWorkbookPayloadSize",null==ua.v?null:ua.v.toString());sb("HtmlPayloadSize",null==ua.w?null:ua.w.toString());sb("CopyPasteTargetType",ua.x);sb("IsLastCopyWasExternal",null==ua.y?null:ua.y.toString());sb("IsClipboardDataContainShadowWorkbook",null==ua.z?null:ua.z.toString());sb("IsShadowWorkbookParsedSuccessfully",null==ua.ba?null:ua.ba.toString());sb("ActiveSelectionType",ua.bb);sb("PasteResult",ua.bc);sb("ErrorReason",null==ua.bd?null:ua.bd.toString());sb("ErrorName",ua.be);sb("IsSucceededWithAlert",
null==ua.bf?null:ua.bf.toString());sb("IsAfterCut",null==ua.bg?null:ua.bg.toString());sb("EncounteredDeploymentErrors",null==ua.bh?null:ua.bh.toString());sb("IsCrossSession",null==ua.bi?null:ua.bi.toString());sb("ShadowWorkbookSizeExceedsLimit",null==ua.bj?null:ua.bj.toString());sb("ClipboardContainXLOPayload",null==ua.bk?null:ua.bk.toString());sb("CopyPasteTargetName",ua.bl);sb("ChromeExtensionId",ua.bm);sb("PayloadOrigin",ua.bn);sb("PayloadType",ua.bo);sb("CCPSliceName",ua.bp);sb("ClipboardItemsKeys",
ua.bq);sb("CopyPasteHandlerName",ua.br);sb("IsSourceItemOriginSameSession",null==ua.bs?null:ua.bs.toString());sb("Location",ua.bt);sb("ExternalAppSource",ua.bu);sb("PasteContextId",ua.bv);sb("ServerRequestTimeInMs",null==ua.bw?null:ua.bw.toString());sb("IndicationDisplayScheduled",null==ua.bx?null:ua.bx.toString());sb("PasteIndicationDisplayStatus",ua.by);sb("PasteRecoveryUIDisplayed",null==ua.bz?null:ua.bz.toString());sb("IsFromPasteRecoveryUI",null==ua.ca?null:ua.ca.toString());sb("EcsOperationDuration",
null==ua.cb?null:ua.cb.toString());sb("EcsRequestDuration",null==ua.cc?null:ua.cc.toString());sb("WfeRequestDuration",null==ua.cd?null:ua.cd.toString());sb("OriginalSourceRangesCountExceedsLimit",null==ua.ce?null:ua.ce.toString());sb("PasteRecoveryUndoStopwatchId",ua.cf);sb("PasteRecoveryUndoTimeInMs",null==ua.cg?null:ua.cg.toString());sb("PasteCSEPerformed",null==ua.ch?null:ua.ch.toString());sb("CSEStatus",null==ua.ci?null:ua.ci.toString());sb("IsFromEnterShortcut",null==ua.cj?null:ua.cj.toString());
sb("pasteDestinationHasMergedCells",null==ua.ck?null:ua.ck.toString());break;case 45:le="DragDrop";sb("UserSessionId",ua.a);sb("Trigger",ua.b);sb("RibbonCommandName",ua.c);sb("OperationId",ua.d);sb("ClientSideStopwatchId",ua.e);sb("SourceRange",ua.f);sb("DestinationRange",ua.g);sb("CutCopyType",ua.h);sb("IsShiftKeyDown",null==ua.i?null:ua.i.toString());sb("IsDragInsert",null==ua.j?null:ua.j.toString());sb("IsSuccess",null==ua.k?null:ua.k.toString());sb("IsExpectedError",null==ua.l?null:ua.l.toString());
sb("ExpectedErrorReason",ua.m);sb("ErrorMessage",ua.n);sb("TotalTimeInMs",null==ua.o?null:ua.o.toString());sb("ErrorName",ua.p);sb("IsSucceededWithAlert",null==ua.q?null:ua.q.toString());sb("CopyPasteTargetType",ua.r);sb("EncounteredDeploymentErrors",null==ua.s?null:ua.s.toString());break;case 46:le="ClearCopyState";sb("UserSessionId",ua.a);sb("ClientSideStopwatchId",ua.b);sb("Trigger",ua.c);sb("IsClearClipboard",null==ua.d?null:ua.d.toString());sb("IsExplicit",null==ua.e?null:ua.e.toString());sb("IsSuccess",
null==ua.f?null:ua.f.toString());sb("ErrorMessage",ua.g);sb("ErrorName",ua.h);sb("TotalTimeInMs",null==ua.i?null:ua.i.toString());sb("CopyPasteTargetType",ua.j);break;case 47:le="WebWorkerRecalcStats";sb("SuccessCount",null==ua.a?null:ua.a.toString());sb("FailureCount",null==ua.b?null:ua.b.toString());sb("ValueTypeMismatchCount",null==ua.c?null:ua.c.toString());sb("CellValueMismatchCount",null==ua.d?null:ua.d.toString());sb("IfmtMismatchCount",null==ua.e?null:ua.e.toString());sb("FormattedTextMismatchCount",
null==ua.f?null:ua.f.toString());sb("CellValueStringMismatchCount",null==ua.g?null:ua.g.toString());sb("CellValueNumberMismatchCount",null==ua.h?null:ua.h.toString());sb("CellValueBooleanMismatchCount",null==ua.i?null:ua.i.toString());sb("CellValueBlankMismatchCount",null==ua.j?null:ua.j.toString());sb("CellValueErrorMismatchCount",null==ua.k?null:ua.k.toString());sb("FormattedTextStringMismatchCount",null==ua.l?null:ua.l.toString());sb("FormattedTextNumberMismatchCount",null==ua.m?null:ua.m.toString());
sb("FormattedTextBooleanMismatchCount",null==ua.n?null:ua.n.toString());sb("FormattedTextBlankMismatchCount",null==ua.o?null:ua.o.toString());sb("FormattedTextErrorMismatchCount",null==ua.p?null:ua.p.toString());sb("StringMismatchCount",null==ua.q?null:ua.q.toString());sb("NumericMismatchCount",null==ua.r?null:ua.r.toString());sb("ErrorMismatchCount",null==ua.s?null:ua.s.toString());sb("StringValuesCount",null==ua.t?null:ua.t.toString());sb("NumericValuesCount",null==ua.u?null:ua.u.toString());sb("BooleanValuesCount",
null==ua.v?null:ua.v.toString());sb("BlankValuesCount",null==ua.w?null:ua.w.toString());sb("ErrorValuesCount",null==ua.x?null:ua.x.toString());sb("NumericValuesDiffAverage",null==ua.y?null:ua.y.toString());sb("NumericEvaluatedValuesMismatchSamples",ua.z);sb("NumericFormattedTextMismatchSamples",ua.ba);sb("NumericMismatchSamples",ua.bb);sb("CellValueTypeMismatchSamples",ua.bc);sb("IfmtMismatchSamples",ua.bd);sb("BlockHashCode",ua.be);break;case 48:le="DataValidationEditOpenDialog";sb("ServerCommand",
ua.a);sb("SubDialogOpened",null==ua.b?null:ua.b.toString());sb("SubDialogButtonClicked",ua.c);sb("DialogOpened",null==ua.d?null:ua.d.toString());sb("RuleType",ua.e);sb("ConditionType",ua.f);sb("LowerBoundaryFilled",null==ua.g?null:ua.g.toString());sb("UpperBoundaryFilled",null==ua.h?null:ua.h.toString());sb("IgnoreBlank",null==ua.i?null:ua.i.toString());sb("InCellDropdown",null==ua.j?null:ua.j.toString());sb("ShowInputMessage",null==ua.k?null:ua.k.toString());sb("InputTitleFilled",null==ua.l?null:
ua.l.toString());sb("InputMessageFilled",null==ua.m?null:ua.m.toString());sb("ShowErrorAlert",null==ua.n?null:ua.n.toString());sb("AlertBlocking",null==ua.o?null:ua.o.toString());sb("AlertTitleFilled",null==ua.p?null:ua.p.toString());sb("AlertMessageFilled",null==ua.q?null:ua.q.toString());sb("StopWatchId",ua.r);break;case 49:le="DataValidationEditSubmitRule";sb("RuleType",ua.a);sb("ConditionType",ua.b);sb("LowerBoundaryFilled",null==ua.c?null:ua.c.toString());sb("UpperBoundaryFilled",null==ua.d?
null:ua.d.toString());sb("IgnoreBlank",null==ua.e?null:ua.e.toString());sb("InCellDropdown",null==ua.f?null:ua.f.toString());sb("ShowInputMessage",null==ua.g?null:ua.g.toString());sb("InputTitleFilled",null==ua.h?null:ua.h.toString());sb("InputMessageFilled",null==ua.i?null:ua.i.toString());sb("ShowErrorAlert",null==ua.j?null:ua.j.toString());sb("AlertBlocking",null==ua.k?null:ua.k.toString());sb("AlertTitleFilled",null==ua.l?null:ua.l.toString());sb("AlertMessageFilled",null==ua.m?null:ua.m.toString());
sb("ClearAllPressed",null==ua.n?null:ua.n.toString());sb("ActionStatus",ua.o);sb("Error",ua.p);sb("StopWatchId",ua.q);break;case 50:le="CustomSort";sb("RangeType",ua.a);sb("HasHeaders",null==ua.b?null:ua.b.toString());sb("SortTopToBottom",null==ua.c?null:ua.c.toString());sb("ColumnCount",null==ua.d?null:ua.d.toString());sb("RowCount",null==ua.e?null:ua.e.toString());sb("RangeLimitExceeded",null==ua.f?null:ua.f.toString());sb("CaseSensitive",null==ua.g?null:ua.g.toString());sb("GetSortInfoDuration",
null==ua.h?null:ua.h.toString());sb("LevelCount",null==ua.i?null:ua.i.toString());sb("SortOnValuesCount",null==ua.j?null:ua.j.toString());sb("SortOnCellColorCount",null==ua.k?null:ua.k.toString());sb("SortOnFontColorCount",null==ua.l?null:ua.l.toString());sb("SortOnIconCount",null==ua.m?null:ua.m.toString());sb("CustomOrderCount",null==ua.n?null:ua.n.toString());sb("AvgCellColorCount",null==ua.o?null:ua.o.toString());sb("MaxCellColorCount",null==ua.p?null:ua.p.toString());sb("AvgFontColorCount",null==
ua.q?null:ua.q.toString());sb("MaxFontColorCount",null==ua.r?null:ua.r.toString());sb("AvgIconsCount",null==ua.s?null:ua.s.toString());sb("MaxIconsCount",null==ua.t?null:ua.t.toString());sb("Executed",null==ua.u?null:ua.u.toString());break;case 51:le="NamedSheetViewUserAction";sb("UserSessionId",ua.a);sb("UserActionName",ua.b);sb("UserActionSource",null==ua.c?null:ua.c.toString());sb("UserActionData",ua.d);sb("OtherData",ua.e);break;case 52:le="NamedSheetViewTeachingCallout";sb("UserSessionId",ua.a);
sb("TeachingCalloutSequence",null==ua.b?null:ua.b.toString());sb("TeachingCalloutIndex",null==ua.c?null:ua.c.toString());sb("UserActionName",null==ua.d?null:ua.d.toString());sb("UserActionData",ua.e);sb("DurationInMs",null==ua.f?null:ua.f.toString());break;case 53:le="NamedSheetViewTeachingDialog";sb("UserSessionId",ua.a);sb("UserActionName",ua.b);sb("ButtonClicked",ua.c);sb("DurationInMs",null==ua.d?null:ua.d.toString());sb("IsNewTeachingDialog",null==ua.e?null:ua.e.toString());break;case 54:le=
"NamedSheetViewOptionsDialog";sb("UserSessionId",ua.a);sb("OptionsAction",null==ua.b?null:ua.b.toString());sb("OptionsActionData",ua.c);sb("OptionsOtherData",ua.d);sb("DurationInMs",null==ua.e?null:ua.e.toString());break;case 55:le="NamedSheetViewTempViewApplyDialog";sb("UserSessionId",ua.a);sb("TriggeredFrom",ua.b);sb("ButtonClicked",ua.c);sb("DurationInMs",null==ua.d?null:ua.d.toString());break;case 56:le="NamedSheetViewTempViewSaveDialog";sb("UserSessionId",ua.a);sb("TriggeredFrom",ua.b);sb("ButtonClicked",
ua.c);sb("NameUpdated",null==ua.d?null:ua.d.toString());sb("DurationInMs",null==ua.e?null:ua.e.toString());break;case 57:le="TemporaryViewStartedDataRestore";sb("UserSessionId",ua.a);sb("CountOfTempViews",null==ua.b?null:ua.b.toString());break;case 58:le="TemporaryViewFetchedVersion";sb("UserSessionId",ua.a);sb("NumberOfBytes",null==ua.b?null:ua.b.toString());break;case 59:le="RaiseEventsAndGenerateBlockRequests";sb("ReturnContentStatus",null==ua.a?null:ua.a.toString());sb("CacheState",null==ua.b?
null:ua.b.toString());sb("FromXhrCallback",null==ua.c?null:ua.c.toString());sb("AreGeneralErrorsPresent",null==ua.d?null:ua.d.toString());sb("BlockCacheItemHash",ua.e);sb("StopwatchId",ua.f);sb("BlockCacheItemProcessingStopwatchId",ua.g);sb("StateId",null==ua.h?null:ua.h.toString());sb("IsHighPriority",null==ua.i?null:ua.i.toString());sb("CalcComplete",null==ua.j?null:ua.j.toString());sb("EditedCellsUpdatedByCse",null==ua.k?null:ua.k.toString());sb("DependentCellsUpdatedByCse",null==ua.l?null:ua.l.toString());
sb("Revision",null==ua.m?null:ua.m.toString());sb("SheetProcessedDataVersion",null==ua.n?null:ua.n.toString());sb("RefCount",null==ua.o?null:ua.o.toString());sb("ExistsInView",null==ua.p?null:ua.p.toString());sb("ContentSource",null==ua.q?null:ua.q.toString());break;case 60:le="LaunchMakerCodeEditor",sb("SessionId",ua.a),sb("Command",ua.b),sb("IsPreviewGallery",null==ua.c?null:ua.c.toString()),sb("MenuItemId",ua.d),sb("ScriptId",ua.e),sb("ShareId",ua.f),sb("IsOwner",null==ua.g?null:ua.g.toString()),
sb("PublishedScriptCount",null==ua.h?null:ua.h.toString()),sb("RecentScriptCount",null==ua.i?null:ua.i.toString()),sb("WorkbookScriptCount",null==ua.j?null:ua.j.toString())}Ld.Table=le;return Sys.Serialization.JavaScriptSerializer.serialize(Ld)}function u(){this.Xpa=new C}function C(){}function r(Ca){var ua=Lh.call(this)||this;ua.$=Ca;ua.dc();return ua}function J(Ca){var ua=hi.call(this)||this;ua.Nnb=-1;ua.Bsd=0;ua.yxa=new Date(0);ua.GY=null;ua.tia={};ua.gua=new Fd.a;ua.L7a=!1;ua.DLd=!1;ua.$2a=null;
ua.W8a=0;ua.Jzc=0;ua.oLa=0;ua.isSynthetic=!1;ua.dWe=function(){var sb=new Date,Ld=sb.getMinutes(),le=sb.getSeconds();ua.DAb&&sb.getTime()-ua.DAb.getTime()>ua.rKj?(ua.stop(),ua.zbd(sb)):(Ld!==ua.Bsd&&(ua.zbd(sb),ua.Bsd=Ld),ua.L7a&&(ua.Fe.Di?ua.GY[le]=J.h6b:(ua.zIe(le),ua.L7a=!1,ua.gua.clear(),ua.tia={})),ua.GY[le]!==J.h6b&&(ua.GY[le]++,Ld=sb.getTime()-ua.yxa.getTime(),Ld>ua.Rnf&&ua.Mvi(ua.yxa,Ld)),ua.Nnb=window.requestAnimationFrame(ua.dWe),ua.yxa=sb)};ua.mW=function(){ua.L7a=!0};ua.Kuf=function(){ua.pause()};
ua.Muf=function(){ua.DLd&&ua.resume()};ua.Jg=function(){ua.Ca.HH()&&ua.vTj()};ua.DAb=new Date;ua.Fe=new T;ua.Fe.DFa(ua.mW);of.AFrameworkApplication.PUc(ua.Kuf);of.AFrameworkApplication.QUc(ua.Muf);ua.$=Ca;ua.Rnf=Ca.ya.LongFrameThresholdMs;ua.oxi="MoreThan_"+ua.Rnf.toString()+"_Ms";ua.qKj=Ca.ya.ThresholdToEndOperationTrackingSeconds;ua.rKj=Ca.ya.ThresholdToStopFPSTrackingMS;ua.Ca=ve.g(ua.$).Ca;of.AFrameworkApplication.Yb&&of.AFrameworkApplication.Yb.IsSynthetic&&(ua.isSynthetic=hf.a.compare(of.AFrameworkApplication.Yb[pg.a.isSynthetic],
"True",!0)?!1:!0);ua.Ca.Fp(ua.Jg);ua.ZKd();ua.Nvi=ua.$.Twa&&ee.EwaSettings.la(612);return ua}function v(Ca,ua,sb,Ld,le,nf,ug,Cf,Cg,Ag){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===Ca?null:Ca;this.count=void 0===ua?0:ua;this.start=void 0===sb?-1:sb;this.end=void 0===Ld?-1:Ld;this.Avg=void 0===le?0:le;this.Max=void 0===nf?-1:nf;this.Min=Qh.a.cjg;this.longFrameCount=void 0===
ug?0:ug;this.coauth=(void 0===Cf?-1:Cf)||1;this.tfAppInt=void 0===Cg?-1:Cg;this.Props=void 0===Ag?null:Ag;this.LFrame=null}function D(Ca,ua){this.duration=this.startSecond=0;this.startSecond=void 0===Ca?-1:Ca;this.duration=void 0===ua?-1:ua}function V(){this.f=null}function U(Ca){var ua=this;this.uCd={};this.fha=null;this.Zeb=function(sb,Ld){sb.longFramesOverThresholdOps++;sb.maxLongFrameDuration=Math.max(sb.maxLongFrameDuration,Ld)};this.lf=new Q;this.r8g();Ca.da.Za(276,function(){Vc.a(Ca).H9(ua.lf)})}
function Q(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}function la(Ca){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=new ba;this.l2FramePerformanceData=new ba;this.l3FramePerformanceData=new ba;this.name=Ca}function ba(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}function T(){var Ca=dh.call(this)||
this;Ca.eM=!1;Ca.K$d=null;Ca.L$d=null;Ca.bAd=function(){Ca.mYd()};Ca.DQi=function(){wf.a.Fa(Ca.hZ);wf.a.Fa(Ca.pk)};Ca.hZ=hh.a.instance.kta();Ca.pk=hh.a.instance.rE();Ca.hZ.ja("visibilitychange",Ca.bAd);Ca.pk.ja("pagehide",Ca.DQi);Ca.mYd();return Ca}function H(Ca){var ua=this;this.bHe=!1;this.dHe=null;this.nd=function(){ua.skj();ve.g(ua.$).ha&&ve.g(ua.$).ha.jL(ua.nd)};this.ii=function(sb,Ld){Ld.pa&&!ua.mVd.has(Ld.pa.name)&&(ua.mVd.add(Ld.pa.name),ve.g(ua.$).ha&&(ve.g(ua.$).ha.jL(ua.nd),ve.g(ua.$).ha.NG(ua.nd)))};
this.$=Ca;this.u9f=new Set;this.mVd=new Set;this.$.xa&&this.$.xa.pa&&this.mVd.add(this.$.xa.pa.name);ve.g(this.$).ha.NG(this.nd);this.$.xa.Qf(this.ii)}function S(Ca){ge.ULS.sendTraceTag(537151049,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: Starting RegisterCpuMeterTaskEvent");dd.TaskExtensions.Ba(Vf.a.Tq(Uc.a.instance.oc("Common.ICpuMeterProvider")),function(ua){ge.ULS.sendTraceTag(537151048,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeterProvider resolved");
dd.TaskExtensions.Ba(ua.result.Vl.task,function(sb){ge.ULS.sendTraceTag(537151047,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeter resolved");var Ld=new K(Ca);sb.result.hUc(0,Object(mc.a)(Ld,Ld.ZBh,"filterTaskEvent"),Object(mc.a)(Ld,Ld.KMj,"traceTaskEvent"))},Ca.ma,3)},Ca.ma,3)}function K(Ca){var ua=this;this.Fe=null;this.FVd=Ca.ya.TimeToReportOnLongWaitingTaskInMsAsWarning;this.EVd=Ca.ya.TimeToReportOnLongWaitingTaskInMsAsMedium;this.DVd=Ca.ya.TimeToReportOnLongRunningTaskInMsAsWarning;
this.CVd=Ca.ya.TimeToReportOnLongRunningTaskInMsAsMedium;this.ea=Ca.ea;Ca.da.Za(291,function(sb){ua.Fe=sb});ge.ULS.sendTraceTag(537151046,0,50,"TaskEventProcessor initialized with TimeToReportOnLongWaitingTaskInMsAsMedium = {0}, TimeToReportOnLongWaitingTaskInMsAsWarning = {1}, TimeToReportOnLongRunningTaskInMsAsMedium = {2}, TimeToReportOnLongRunningTaskInMsAsWarning = {3}",this.EVd,this.FVd,this.CVd,this.DVd)}function da(Ca){this.zsa=[];this.I_c=null;this.fBi=100;this.documentVisibilityObserver=
null;this.eBi=Ca}function fa(Ca,ua){this.G$c=0;this.WRe=this.startTime=Hd.HelperMethods.kc();this._name=Ca;this.VB=ua}function X(Ca,ua){this.stopped=!1;this.chainedCallsTracer=Ca;this.kmg=ua}function ca(Ca){var ua=this;this.yWc="AppUnloadInfo";this.pk=this.$=this.workbookHashedId=this.Ly=null;this.H1d=this.k5d=!1;this.wf=null;this.caf=0;this.yca=function(sb,Ld){ua.caf=Ld.Szc};this.mFf=function(sb,Ld){Ld.nZd.length&&ua.$.jF&&(ua.Ly.dataLossInfo=new ja(Ld),ua.Ly.wasDataLostDuringUnload=!0,ua.Ubb())};
this.Wg=function(){ua.bYf();ua.$.ea.Lq(ua.Wg)};this.yOa=function(){ua.Ly.wasUpdatedOnBeforeUnload=!0;ua.Ly.inactivityDurationBeforeUnloadSeconds=ua.wf.feb<ca.dAi?ua.caf:ua.wf.feb;ua.ceg()};this.tEb=function(){ua.Ly.wasUpdatedOnUnload=!0;ua.ceg();Sys.Application.remove_unload(ua.tEb)};this.wTi=function(){ua.Ly.lastSilentReopenStartTime=Df.a.Ra.Kb;ua.Ly.lastSilentReopenEndTime=null;ua.Ubb();ua.$.Qk(ua.bEf)};this.bEf=function(){ua.Ly.lastSilentReopenEndTime=Df.a.Ra.Kb;ua.Ubb();ua.$.pl(ua.bEf)};this.localStorage=
new Uf.a;this.uSf=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");this.localStorage.rg()&&(this.$=Ca,this.workbookHashedId=Ne.a(this.$),this.Ly=new ea(this.workbookHashedId,this.$.ya.UserSessionId),this.pk=hh.a.instance.rE(),this.pk.ja("beforeunload",this.yOa),this.$.userOperationManager.HHg(this.mFf),Ca.ea.Th?this.bYf():this.$.ea.Um(this.Wg),this.wf=this.$.ea.wf,this.wf.Qra(this.yca),Sys.Application.add_unload(this.tEb),ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5470513_trackSilentReopenUnloads")&&
this.$.ea.GVc(this.wTi))}function ja(Ca){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=Ca.rAe+Ca.Hbg;this.dataLossReason=Ca.wwe;this.ATg(Ca.nZd)}function ea(Ca,ua){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=
this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=Ca;this.wasUpdatedOnUnload=this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=ua}function qa(Ca){var ua=Rg.call(this)||
this;ua.qma=null;ua.Yma=null;ua.lGe=Array(1);ua.Tud=null;ua.RMc=null;ua.Nh=function(sb,Ld){ee.EwaSettings.la(41)&&(ua.Yma=ua.Yma||new Ja(ua.$,ua.zI,ua.Nla),ua.Yma.Nh(sb,Ld))};ua.Mn=function(sb,Ld){ee.EwaSettings.la(41)&&(ua.Yma=ua.Yma||new Ja(ua.$,ua.zI,ua.Nla),ua.Yma.Mn(sb,Ld))};ua.od=function(sb,Ld){ee.EwaSettings.la(41)&&ua.zI.od(sb,Ld)};ua.Wg=function(sb,Ld){ee.EwaSettings.la(41)&&ua.zI.Wg(sb,Ld)};ua.kic=function(sb,Ld){ee.EwaSettings.la(41)&&ua.zI.kic(sb,Ld)};ua.$=Ca;if(!ee.EwaSettings.la(41))return ua;
Ab.a.fai(ua.$);ua.wN=new Mb(ua.$);ua.H7g();ee.EwaSettings.la(613)&&ua.f8a&&(ua.Tud=new eb(ua.$,ua.f8a));ua.zI=new pa(ua.$);ua.Nla=new ob(ua.$);ua.$.vl(ua.od);ua.$.na.uq(ua.Nh);ua.$.na.Ky(ua.Mn);ua.$.ea.Vne(ua.kic);ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&ua.$.ea.Um(ua.Wg);return ua}function pa(Ca){this.dirtySessionOnLastRecordedRequest=this.iTd=!1;this.Ulf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=Ca;this.wmb={};this.vmb={};this.v5c={}}function Pa(Ca,
ua,sb,Ld,le,nf,ug,Cf){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=Ca;this.ocsCapable=ua;this.endedBySplashScreen=sb;this.dirtySessionOnLastRecordedRequest=Ld;this.loadOnDemandCount=le;this.maxCoauthorsCount=nf;this.everConnectedToOcs=ug;Ca=[];for(var Cg in Cf)ua=Cf[Cg],ua.Uad(),Ca.push(ua.data);this.requests=Ca}function Ha(Ca){this.data=new Xa;
this.data.requestName=Ca;this.data.totalCount=0;this.tbb=[];this.tWd=this.kWd=this.lWd=this.qWd=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=-1}function Xa(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=
this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=this.requestDurationPercentile25=0}function Na(Ca,ua){this.data=new db;this.data.operationName=Ca;this.data.isUserOperation=ua;this.data.totalCount=0;this.L6f=[];this.M6f=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles=
"";this.data.startToResponsePercentiles=""}function db(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}function Ja(Ca,ua,sb){this.$=Ca;this.zI=ua;this.Nla=sb}function jb(Ca,ua,sb,Ld,le,nf,ug,Cf,Cg,Ag,eh,jh,Pg,te,Fg,og,mh){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=
this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=Ca;this.isUserTriggeredRequest=
jb.zSh(Ca);this.isFullyLoggedKPIRequest=jb.vSh(Ca);this.isPromotedUTRRequest=jb.wSh(Ca);this.requestDuration=ua;this.totalOperationDuration=sb;this.requestTimeInQueue=Ld;this.requestInvokedTime=le;this.ecsOperationDuration=nf.EcsOperationDuration;this.EcsRequestDuration=nf.EcsRequestDuration;this.WfeRequestDuration=nf.WfeRequestDuration;this.TimeFromLastEcsFreeze=nf.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=nf.DuringLoadOnDemand;this.correlationID=ug;this.errors=jb.U1g(Cf);this.httpStatus=Cg;
this.requestResourceTiming=Ag;this.communicationErrorRetryCount=eh;this.successfulCall=jh;this.isDocumentHidden=Pg;this.coauthorsCount=te;this.responseSize=Fg;this.networkInfoData=og;this.responseToCallbackTime=mh}function hc(Ca,ua){this.messageIdName=null;this.errorCause=0;this.messageIdName=Ca;this.errorCause=ua}function ma(Ca,ua,sb,Ld){var le=this;this.framePerformanceTracker=this.BHb=this.R_=this.R0=null;this.Wfj=function(){le.sWc=-1;var nf=Hd.HelperMethods.kc();le.AUj(nf);ee.EwaSettings.la(379)&&
(le.OIb&&(ge.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),le.KNb(le.tE,nf),le.OIb=!1),le.Bgc&&(le.KNb(le.bD,nf),le.OIb||le.KNb(le.tE,nf)));window.setTimeout(le.svi,0)};this.svi=function(){for(var nf=new Fd.a,ug=le.$.ya.OperationToPrevOperationThreshold,Cf=0;Cf<le.tE.count;Cf++){var Cg=le.tE.oa(Cf);Cf<ug&&nf.add(Cg);le.bD.add(Cg)}ve.g(le.$)&&ve.g(le.$).Ca?((Cf=le.sessionStatisticsManager.ked(0))?ge.ULS.sendTraceTag(237798547,
1,50,"DOM count: ({0}, {1}, {2}), long tasks: {3}, operations count: {4}, operations: {5}",Cf.kBi,Cf.yNg,Cf.Qzi,le.qBb,le.tE.count,nf):ge.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),le.tE.count>ug&&ge.ULS.sendTraceTag(537153875,1,50,"More than {0} operations are in the operationsList. count: {1}",ug,le.tE.count),le.tE.clear(),le.qBb.clear()):ge.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.xnc=function(nf,ug){le.qxi(ug.DMe)};
this.$=Ca;this.zI=ua;this.mh=this.mh||Df.a.Ra;this.bD=new Fd.a;this.tE=new Fd.a;this.sWc=this.F7a=-1;this.qBb=new Fd.a;this.operationsGroupDetector=new Ka;this.OIb=this.Bgc=!1;this.jai();this.Q$h();this.P$h();this.sessionStatisticsManager=sb;this.wN=Ld;this.wN.goe(this.xnc);this.$.da.Za(263,function(nf){le.framePerformanceTracker=nf})}function Ka(){this.operationsGroups=null;this.O$h()}function Ta(Ca,ua,sb,Ld,le,nf,ug,Cf,Cg,Ag){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=
0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===Ca?"":Ca;this.startTime=void 0===ua?-1:ua;this.startToNextFrame=void 0===sb?-1:sb;this.startToResponseRenderEnd=void 0===Ld?-1:Ld;this.wasHidden=void 0===le?!1:le;this.isUserOperation=void 0===nf?!0:nf;this.isGroupBreaking=void 0===ug?!0:ug;this.operationThatLedToLogging=void 0===Cg?"":Cg;this.startToOperationThatLedToLogging=
void 0===Ag?-1:Ag;this.isPartOfGroup=void 0===Cf?!1:Cf}function ob(Ca){var ua=Ye.call(this)||this;ua.statusBarManager=null;ua.wUc=!1;ua.ftf=function(){ua.raiseEvent("NetworkInformation")};ua.$=Ca;if(!ee.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry"))return ua;ua.F_=ua.XWd("connection")||ua.XWd("mozConnection")||ua.XWd("webkitConnection");ua.F_&&ee.EwaSettings.la(490)&&Ca.da.Za(29,function(sb){ua.statusBarManager=sb;sb.xJ(ua);ua.F_.addEventListener("change",ua.ftf);
ua.wUc=!0});return ua}function Cb(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}function eb(Ca,ua){var sb=Tf.call(this)||this;sb.Fe=null;sb.statusBarManager=null;sb.uAf=function(Ld,le){le.Qud&&le.Qud.duration>=sb.sxi&&(sb.Unf++,sb.qkf=le.Qud.duration)};sb.$=Ca;sb.$.da.Za(29,function(Ld){sb.statusBarManager=Ld;Ld.xJ(sb)});sb.$.da.Za(291,function(Ld){sb.Fe=Ld});sb.Unf=0;sb.qkf=0;sb.sxi=Ca.ya.LongTaskThresholdMs;sb.f8a=ua;sb.f8a.PFg(sb.uAf);
return sb}function ya(Ca,ua){var sb=this;this.Ma=new Da.a;this.cNa=this.T5=this.QS=this.Fe=null;this.Vjf=this.oRd=this.jic=!1;this.MNa=null;this.maxUsersCount=0;this.xnc=function(Ld,le){Ld=le.DMe.getEntriesByType(pg.a.Pud);Ld=yl(Ld);for(le=Ld.next();!le.done;le=Ld.next())if(le=le.value,!sb.Fe.kF(le.duration)&&!of.AFrameworkApplication.e7a){sb.QS.bne(le.duration);sb.Ma.raiseEvent("lttek",new za(le));var nf={};nf.LongTaskDuration=le.duration;nf.LongTaskStartTime=le.startTime;ge.ULS.sendTraceTag(187982418,
0,50,JSON.stringify(nf))}};this.Wg=function(){sb.oRd=!0;sb.zyc()};this.kI=function(Ld,le){le&&(sb.maxUsersCount=Math.max(sb.maxUsersCount,le.oZd));sb.T5.maxUsersCount=sb.maxUsersCount};this.rd=function(){sb.zyc()};this.od=function(){sb.l7f()};this.tAf=function(Ld,le){le.Kec&&sb.zyc()};this.Lnf=function(){sb.QS.JUc(gf.getElapsedMilliseconds(sb.cNa,Df.a.Ra.Kb));sb.nTd(!0);var Ld=!1;sb.T5.postBootWindowData.activeSessionDuration?(!sb.Vjf&&ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&
(sb.Efg&&Db.b().LSf(2),hd.Health.instance.recordKpiUsage(Fe.a.longJsTask,0,Ff.a.Bqi,null),sb.Vjf=!0),!sb.T5.isVetoSession&&sb.QS.rpi(sb.ogg)&&(sb.T5.isVetoSession=!0,ee.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(sb.Efg&&Db.b().MSf(2,sb.pxi),hd.Health.instance.recordKpiFailure(Fe.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,null))),sb.T5.worstWindowData.Sud<=sb.QS.Sud&&(sb.T5.worstWindowData=sb.QS),sb.T5.entireSessionData.rDg(sb.QS)):(sb.T5.postBootWindowData=
new cb(sb.QS.activeSessionDuration,sb.QS.longTaskDuration),Ld=!0);var le={};le.LastWindowScore=sb.QS;le.postBootWindow=Ld;le.CoauthersNumber=sb.$.ea.km.length;Ld=JSON.stringify(le);ge.ULS.sendTraceTag(20779346,0,50,Ld);sb.QS=new cb};this.rmc=function(){sb.Fe.Di||of.AFrameworkApplication.e7a||sb.nTd(!1)};this.qmc=function(){sb.QS.JUc(gf.getElapsedMilliseconds(sb.cNa,Df.a.Ra.Kb));sb.cNa=null;sb.MNa.cancel()};this.$=Ca;this.ogg=Ca.ya.LongTaskPerformanceVetoThreshold;this.pxi="PercentageOver_"+this.ogg.toString();
this.Rud=Ca.ya.LongTaskPerformanceWindowDurationInMs;this.wN=ua;this.Efg=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.da.Za(291,function(Ld){sb.Fe=Ld;sb.zyc()});this.$.ea.Th?this.Wg(this,Sys.EventArgs.Empty):this.$.ea.Um(this.Wg);this.wN.OFg(this.tAf);this.$.Qk(this.rd);this.$.vl(this.od)}function za(Ca){var ua=he.call(this)||this;ua.Qud=Ca;return ua}function Ga(Ca,ua,sb,Ld,le){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=
null;this.maxUsersCount=0;this.isVetoSession=Ca;this.entireSessionData=ua;this.worstWindowData=sb;this.postBootWindowData=Ld;this.maxUsersCount=le}function cb(Ca,ua){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===Ca?0:Ca;this.longTaskDuration=void 0===ua?0:ua}function Mb(Ca){var ua=this;this.Ma=new Da.a;this.nKc=!1;this.Wg=function(){if(Ec.a.ep){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(ua.rxi)).observe(new ib([pg.a.Pud])),
ua.nKc=!0)}catch(sb){ua.nKc=!1,ge.ULS.sendTraceTag(537153885,0,10,"Exception related to PerformanceObserver: {0}",sb)}ua.Ma.raiseEvent("ltpoiek",new Dc(ua.Kec))}};this.rxi=function(sb){ua.Ma.raiseEvent("ltoek",new vb(sb))};this.$=Ca;this.$.ea.Th?this.Wg(this,Sys.EventArgs.Empty):this.$.ea.Um(this.Wg)}function Dc(Ca){var ua=Rd.call(this)||this;ua.Kec=Ca;return ua}function vb(Ca){var ua=nc.call(this)||this;ua.DMe=Ca;return ua}function ib(Ca,ua){this.entryTypes=null;this.buffered=!1;this.entryTypes=
Ca;this.buffered=void 0===ua?!1:ua}function ub(Ca,ua){var sb=Mc.call(this)||this;sb.JHb=!1;sb.ojd=!1;sb.J2f=!0;sb.Ma=new Da.a;sb.VGc=!1;sb.od=function(){var Ld=Vb.a(sb.$).qd.activityState,le=ud.a.yg(Ld,kb.a.sle);ud.a.yg(Ld,kb.a.Nmb)||le||sb.upload()};sb.$=Ca;sb.Xub=ua;sb.ea=Ca.ea;sb.$.vl(sb.od);sb.Pbg=new Ya;sb.lPa=new ec(Gd.a.MMd,Ca.ya.PageGenerationMetrics.TimeToCompleteFirstFlush);sb.lCc=new Eb(sb);return sb}function Eb(Ca){this.F2b=[];this.VJg=null;this.sqmManager=Ca}function Ya(){this.Mud=null;
this.B_g=Ya.r5g();this.LTf()}function tb(Ca,ua,sb){this.nRc=Ca.keyCode;this.sJb(Ca.ctrlKey,1);this.sJb(Ca.shiftKey,2);this.sJb(Ca.altKey,4);this.sJb(Ea.b(Ca),8);this.sJb(sb,16);this.nRc=this.Bdb|ua<<24}function ec(Ca,ua){this.AQb=null;this.q5b=this.tkd=!1;this.oge=this.pge=null;this.g5a=this.f5a=0;this.VWf=Ca;this.wde=ua}function Za(Ca){var ua=Ce.call(this)||this;ua.aV=Ca;return ua}function mb(Ca){var ua=vg.call(this)||this;ua.$=Ca;ua.dc();return ua}function sc(Ca){var ua=this;this.uJa=new Set;this.OLb=
null;this.b8f=!1;this.Wg=function(){ua.zui();ua.OLb=bf.a.instance.create(function(){ua.lBb()},sc.ZHj,Xf.a.lBb)};this.od=function(){ua.lBb()};this.FEb=function(sb,Ld){sb=ua.Pob.blockedActions.length;var le=Ld.details?Ld.actionName+"_"+Ld.details:Ld.actionName;Ld=Object.assign(new lc,{order:sb+1,name:le,componentName:Ld.componentName,timeFromNavigationStart:Ld.timeFromNavigationStart});Array.add(ua.Pob.blockedActions,Ld)};this.Pob=new Xb;this.Pob.hasBlockedActions=!1;this.Mdb=new pd;this.JBh();this.$=
Ca;this.$.ea.Um(this.Wg);this.$.vl(this.od)}function pd(){this.successfulActions=[]}function $b(){var Ca=lc.call(this)||this;Ca.inputMethod=null;Ca.isCommand=!1;return Ca}function Xb(){this.hasBlockedActions=!1;this.blockedActions=[]}function lc(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}function Oa(Ca){var ua=$e.call(this)||this;ua.$=Ca;ua.dc();return ua}function pb(Ca,ua){this.interactivityTrackerService=this.D6f=this.FFd=this.dab=this.GFd=this.FKf=this.GKf=
null;this.Z2i=new Set([1,0]);ge.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=Ca;this.interactivityTrackerService=ua;this.Ybi();this.Xbi();this.Cqi=this.$.ya.JsProfilingSampleIntervalInMs;this.profilingIntervalInMs=ee.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.vCe=ee.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",3E5);this.yGj()}function Ub(){this.shouldMakeSerializedCallTreesFullyReconstructible=
this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=this.shouldSendAllCallTreesFromProfileInASingleRequest=
this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=this.appName=null}function ic(){this.samplingIntervalInMs=
0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=null}function Jb(Ca,ua){this.ITi=Ca;this.KTi=ua}function cc(){}function Ob(){}function P(){this.customProperties=new Map}function Ba(Ca){this.tEj=Ca}function ra(Ca){var ua=af.call(this)||this;ua.$=Ca;ua.dc();return ua}function ta(Ca){var ua=this;this.sK=null;if(ta.pff)ge.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization.");else{if(ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker"))this.initialize(Ca);
else{var sb=Kc.GetServiceTaskFactory.Wa(Ca.da,283,284,1);dd.TaskExtensions.Ba(sb,function(){dd.TaskExtensions.Ba(Le.c(sb.result.Un.loadScript("interactivity")),function(){ge.ULS.sendTraceTag(537155544,0,50,"Interactivity slice is loaded");ua.initialize(Ca)},Ca.ma,3)},Ca.ma,3)}ta.pff=!0}}function Ia(){this.events=null;this.durationThresholdInMs=0;this.patchTaskScheduling=this.callbacks=null}function bb(Ca){this.$=Ca;this.Vji=this.getBooleanFeatureGate("Microsoft.Office.Excel.InteractivityTrackerCoauthCountFix",
!1)}function Va(){this.value=this.key=null}function lb(){this.appInfoProperties=this.coAuthCount=this.appState=null}function kc(Ca){var ua=ac.call(this)||this;ua.Jbf=0;ua.SUe=!1;ua.Dsd=Array(kc.z8a);ua.W4b=0;ua.$=Ca;ua.Yyb=ee.EwaSettings.la(79);ua.uif=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");ua.kli=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5893585_PageLoadEngagementInfo");ua.Nfi=ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AsyncLogInteractivityRecord",
!1);ua.D0j=bg.a.pVh();ua.d5={};kc.FXb||(kc.FXb=new Yd.a(If.a.Hk()),kc.mai(kc.FXb));zb.cbi();if(ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(Ca=0;Ca<kc.z8a;Ca++)ua.Dsd[Ca]="NA";return ua}function zb(){this.commandSurface=this.triggerMethod=bg.a.Oeb}function Sb(Ca,ua,sb){Ca=gb.call(this,Ca.operation,Ca.properties,Ca.correlations)||this;Ca.timeFromAppInteractive=0;Ca.timeFromNavigationStart=0;Ca.timeFromAppInteractive=ua;Ca.timeFromNavigationStart=sb;return Ca}
function gb(Ca,ua,sb){this.correlations=this.properties=this.operation=null;this.operation=Ca;this.properties=ua;this.correlations=sb}function Sa(Ca){var ua=je.call(this)||this;ua.DBe=!1;ua.$=Ca;return ua}function Kb(Ca,ua,sb){var Ld=ng.call(this,ua,sb)||this;Ld.Ma=new lf.a;Ld.q8h=function(le){if(ee.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){var nf=le.Values.m_Origin;of.AFrameworkApplication.wopiHostOriginFromPostMessage||(of.AFrameworkApplication.wopiHostOriginFromPostMessage=
nf)}switch(le.MessageId){case Rf.a.zkd:kf.a(Ld.$).$6e(le);break;case Rf.a.Ptd:Ed.a.ltas(null);break;case Rf.a.Udc:Ld.TNi();break;case Rf.a.Dkd:Ld.SNi(le)}};Ld.$=Ca;sb!==rf.a.W9&&Ld.vFa(sb);Ld.$bi();Ld.mbi();Ca=Ld.q8h;Ld.Kl(Rf.a.zkd,Ca);Ld.Kl(Rf.a.Ptd,Ca);Ld.Kl(Rf.a.Udc,Ca);Ld.Kl(Rf.a.Dkd,Ca);return Ld}function Gc(){}function Hb(){}function Lb(Ca){this.gx=[];this.iRb=[];this._count=void 0===Ca?1:Ca}function sa(Ca){this.shb=null;this.Vl=new Tc.a;this.$L=Ca}function Ua(Ca,ua,sb,Ld,le){this.UEa=0;this.DG=
null;this.xVb=this.Phe=0;this.age=!1;this.JVa=0;this.fjb=!1;this.Oqa=null;this.GSb=0;this.Tce=new lf.a;this.EWb=[];this.$L=Ca;this.SMc=ua;this.QIc=sb;this.bbe=Ld;of.AFrameworkApplication.ga&&of.AFrameworkApplication.ga.ra("WrapSetTimeoutForTelemetryIsEnabled")&&this.isd();this.Dog=le;this.RIc=new Ad(100);this.usg=jc.n3a(1,5,new Yb)}function Yb(Ca){Ca=void 0===Ca?null:Ca;this.Qm=null;this.reset();this.nlb=Ca}function jc(Ca,ua,sb,Ld,le,nf,ug){nf=void 0===nf?!0:nf;ug=void 0===ug?null:ug;this.RX=this.cie=
this.o$d=!1;this.me=null;if(!Ca)throw Hc.a.argument("taskManagerLazy");if(!le)throw Hc.a.argument("dataAggregator");this.uxg=Ca;this.WNc=ua;this._id=sb;this.L8d=6E4*Ld;this.aRb=le;this.ofe=nf;this.nlb=ug;md.F1h().xb(this._id.toString())&&(this.RX=!0)}function md(){}function jd(){}function Zc(){}function Qb(Ca){var ua=Ae.call(this)||this;ua.osf=Ca;return ua}function fd(){}function xd(){}function Ad(Ca,ua){var sb=this;this.dKc=!1;this.vDa={};this.zTb=void 0===Ca?0:Ca;this.JTb=void 0===ua?0:ua;this.wSc=
0;oc.a.addHandler(window.self,Yc.a.MIg,function(){sb.dKc=!0});oc.a.addHandler(window.self,Yc.a.NIg,function(){sb.dKc=!1})}function Me(){this.S=this.T=this.M=this.C=0}function Ue(){this.lVa=[];this.o4d=this.SGc=0;this.lfa=null;this.rb=new lf.a}function Jd(Ca,ua){var sb=Wc.call(this)||this;sb.sKj=Ca;sb.actualValue=ua;return sb}function Sd(){this.tb=null}function se(Ca,ua,sb,Ld,le){sb=void 0===sb?null:sb;Ld=void 0===Ld?null:Ld;le=void 0===le?100:le;this.zLc=!1;this.Vi=null;this.thb=0;this.rb=new lf.a;
this.zgb=null;this.mT=!1;this.Tie=0;this.me=Ca;this.S4d=0;this.VYd=this;this.BHc=new rb(sb);this.xu=ua;Ld&&(this.zgb=new Ke(null,Ld,le))}function oe(Ca){var ua=Wb.call(this)||this;ua.entries=Ca;return ua}function Ke(Ca,ua,sb){this.O1d=Ca;this.qWb=void 0===ua?null:ua;this.vgb={};this.hmg=void 0===sb?100:sb}function bc(Ca,ua){this.S$=null;this.jSc=Ca;this.behavior=ua;this.url=this.mu.name}function qd(Ca,ua,sb){this.ai=Ca;this.VYd=this;this.ypg=(void 0===ua?null:ua)||function(){return window.location.href};
this.BHc=new rb(void 0===sb?null:sb)}function zc(Ca,ua){function sb(nf,ug){null!=ug&&(Ld[nf]=ug)}var Ld={},le=null;switch(Ca){case 0:le="ResourceTiming";sb("Url",ua.a);sb("InitiatorType",ua.b);sb("RedirectStart",null==ua.c?null:ua.c.toString());sb("RedirectEnd",null==ua.d?null:ua.d.toString());sb("FetchStart",null==ua.e?null:ua.e.toString());sb("DomainLookupStart",null==ua.f?null:ua.f.toString());sb("DomainLookupEnd",null==ua.g?null:ua.g.toString());sb("ConnectStart",null==ua.h?null:ua.h.toString());
sb("ConnectEnd",null==ua.i?null:ua.i.toString());sb("SecureConnectionStart",null==ua.j?null:ua.j.toString());sb("RequestStart",null==ua.k?null:ua.k.toString());sb("ResponseStart",null==ua.l?null:ua.l.toString());sb("ResponseEnd",null==ua.m?null:ua.m.toString());sb("CustomText",ua.n);sb("DecodedBodySize",null==ua.o?null:ua.o.toString());sb("EncodedBodySize",null==ua.p?null:ua.p.toString());sb("TransferSize",null==ua.q?null:ua.q.toString());break;case 1:le="PerformanceTiming",sb("Url",ua.a),sb("NavigationStart",
null==ua.b?null:ua.b.toString()),sb("UnloadEventStart",null==ua.c?null:ua.c.toString()),sb("UnloadEventEnd",null==ua.d?null:ua.d.toString()),sb("RedirectStart",null==ua.e?null:ua.e.toString()),sb("RedirectEnd",null==ua.f?null:ua.f.toString()),sb("FetchStart",null==ua.g?null:ua.g.toString()),sb("DomainLookupStart",null==ua.h?null:ua.h.toString()),sb("DomainLookupEnd",null==ua.i?null:ua.i.toString()),sb("ConnectStart",null==ua.j?null:ua.j.toString()),sb("ConnectEnd",null==ua.k?null:ua.k.toString()),
sb("SecureConnectionStart",null==ua.l?null:ua.l.toString()),sb("RequestStart",null==ua.m?null:ua.m.toString()),sb("ResponseStart",null==ua.n?null:ua.n.toString()),sb("ResponseEnd",null==ua.o?null:ua.o.toString()),sb("DomLoading",null==ua.p?null:ua.p.toString()),sb("DomInteractive",null==ua.q?null:ua.q.toString()),sb("DomContentLoadedEventStart",null==ua.r?null:ua.r.toString()),sb("DomContentLoadedEventEnd",null==ua.s?null:ua.s.toString()),sb("DomComplete",null==ua.t?null:ua.t.toString()),sb("LoadEventStart",
null==ua.u?null:ua.u.toString()),sb("LoadEventEnd",null==ua.v?null:ua.v.toString()),sb("CustomText",ua.w)}Ld.Table=le;return Sys.Serialization.JavaScriptSerializer.serialize(Ld)}function ld(Ca,ua){this.S$=null;this.jSc=Ca;this.url=ua}function rb(Ca){this.EEc=Ca}function Wd(){}function rc(){}function nd(){this.Version=this.Name=null}function me(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=
this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}function be(Ca){Ca=Ca.replace(/-.*/g,function(){return""});Ca=Ud.get(Ca);return null!==Ca&&void 0!==
Ca?Ca:"other"}function sd(Ca){return Ca[0].toUpperCase()+Ca.slice(1).replace(/_[a-z]/g,function(ua){return ua[1].toUpperCase()})}function Qe(Ca){mf(Ca,Zd)}function Sf(Ca){mf(Ca,ie)}function mf(Ca,ua){var sb,Ld,le=null===(sb=null===Ca||void 0===Ca?void 0:Ca.actionProps)||void 0===sb?void 0:sb.name;Ca=null===(Ld=null===Ca||void 0===Ca?void 0:Ca.actionProps)||void 0===Ld?void 0:Ld.appState;if(le&&Ca){var nf=be(le);"other"!==nf&&"grid_menu"!==nf&&"steady"===Ca&&(ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InteractivityMetricKpiUseRequestIdleCallback",
!1)?window.requestIdleCallback(function(){ua(nf)},ce):ua(nf))}else ge.ULS.sendTraceTag(526463695,0,15,"InteractivityTrackerService.reportResponsivenessMetricKpi action or appState are undefined")}function Zd(Ca){hd.Health.instance.recordKpiFailure("NonResponsiveActions"+sd(Ca),"SlowAction",!1,!0,null)}function ie(Ca){hd.Health.instance.recordKpiUsage("NonResponsiveActions"+sd(Ca),0,"xloint",null)}b.r(F);var kd=b(0),ge=b(13);Object(kd.a)(me,"BrowserInfo",null,[]);Object(kd.a)(nd,"PluginInfo",null,
[]);var of=b(5),Ec=b(23);rc.Bvi=function(){if(of.AFrameworkApplication.ga.ra("LogBrowserInfoIsEnabled")){var Ca=rc.$Gh();try{var ua=JSON.stringify(Ca);ge.ULS.sendTraceTag(6903563,102,50,ua)}catch(sb){ge.ULS.sendTraceTag(6903564,102,15,sb.message)}}else ge.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")};rc.RVh=function(){var Ca=window.navigator.plugins;if(!Ca||!Ca.length)return null;for(var ua=[],sb=0;sb<Ca.length;sb++){var Ld=Ca[sb].name,le=Ca[sb].version;Array.add(ua,
Object.assign(new nd,{Name:Ld,Version:le}))}return ua};rc.$Gh=function(){var Ca=new me,ua=new Sys.StringBuilder;rc.Xs(function(sb){Ca.DocElemClientHeight=sb},function(){return document.documentElement.clientHeight},ua);rc.Xs(function(sb){Ca.DocElemClientWidth=sb},function(){return document.documentElement.clientWidth},ua);rc.Xs(function(sb){Ca.DocElemOffsetHeight=sb},function(){return document.documentElement.offsetHeight},ua);rc.Xs(function(sb){Ca.DocElemOffsetWidth=sb},function(){return document.documentElement.offsetWidth},
ua);rc.Xs(function(sb){Ca.ScreenAvailHeight=sb},function(){return window.screen.availHeight},ua);rc.Xs(function(sb){Ca.ScreenAvailWidth=sb},function(){return window.screen.availWidth},ua);rc.Xs(function(sb){Ca.ScreenWidth=sb},function(){return window.screen.width},ua);rc.Xs(function(sb){Ca.ScreenHeight=sb},function(){return window.screen.height},ua);rc.Xs(function(sb){Ca.ScreenLogicalXdpi=sb},function(){return window.screen.logicalXDPI},ua);rc.Xs(function(sb){Ca.ScreenLogicalYdpi=sb},function(){return window.screen.logicalYDPI},
ua);rc.Xs(function(sb){Ca.ScreenDeviceXdpi=sb},function(){return window.screen.deviceXDPI},ua);rc.Xs(function(sb){Ca.ScreenDeviceYdpi=sb},function(){return window.screen.deviceYDPI},ua);rc.Xs(function(sb){Ca.WinInnerHeight=sb},function(){return window.self.innerHeight},ua);rc.Xs(function(sb){Ca.WinInnerWidth=sb},function(){return window.self.innerWidth},ua);rc.Xs(function(sb){Ca.WinOuterHeight=sb},function(){return window.self.outerHeight},ua);rc.Xs(function(sb){Ca.WinOuterWidth=sb},function(){return window.self.outerWidth},
ua);rc.Xs(function(sb){Ca.WinOrientation=sb},function(){return window.self.orientation},ua);rc.Xs(function(sb){Ca.WinDevicePixelRatio=sb},function(){return window.self.devicePixelRatio},ua);rc.Xs(function(sb){Ca.SupportsTouch=sb},function(){return Ec.a.azc},ua);rc.Xs(function(sb){Ca.NavAppName=sb},function(){return window.navigator.appName},ua);rc.Xs(function(sb){Ca.NavAppVersion=sb},function(){return window.navigator.appVersion},ua);rc.Xs(function(sb){Ca.NavLanguage=sb},function(){return window.navigator.browserLanguage||
window.navigator.language},ua);rc.Xs(function(sb){Ca.NavUserAgent=sb},function(){return window.navigator.userAgent},ua);rc.Xs(function(sb){Ca.NavPlatform=sb},function(){return window.navigator.platform},ua);rc.Xs(function(sb){Ca.NavPlugins=sb},rc.RVh,ua);rc.Xs(function(sb){Ca.CalculatedDevicePixelRatio=sb},function(){return rc.devicePixelRatio},ua);Ca.Error=ua.toString();return Ca};rc.Xs=function(Ca,ua,sb){try{var Ld=ua();Ca(Ld)}catch(le){sb.isEmpty()||sb.append(" | "),sb.append(le.message||"null")}};
Sk.Object.defineProperties(rc,{devicePixelRatio:{configurable:!0,enumerable:!0,get:function(){var Ca=window.devicePixelRatio;return isNaN(Ca)?window.screen.deviceXDPI/window.screen.logicalXDPI:Ca}}});Object(kd.a)(rc,"BrowserInfoLogger",null,[]);var Cd=b(273);Wd.prototype.ji=function(){};Wd.prototype.init=function(){rc.Bvi()};Wd.prototype.dispose=function(){};Wd.main=function(){Cd.a.instance.sj(new Wd)};Sk.Object.defineProperties(Wd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.BrowserInfoLogger"}}});
Object(kd.a)(Wd,"BrowserInfoLoggerPackage",null,[4,5]);var Qd=b(78);rb.prototype.Pdf=function(Ca){if(!this.EEc)return!0;Ca=Qd.a.ofd(Ca);if(!Ca)return!1;Ca=Ca.toLowerCase();for(var ua=0;ua<this.EEc.length;ua++)if(Ca.endsWith(this.EEc[ua]))return!0;return!1};Object(kd.a)(rb,"DomainAllowListManager",null,[]);ld.prototype.SVd=function(){var Ca={},ua=this.mu;Ca.a=this.WYd;Ca.b=this.round(ua.navigationStart);Ca.c=this.round(ua.unloadEventStart);Ca.d=this.round(ua.unloadEventEnd);Ca.e=this.round(ua.redirectStart);
Ca.f=this.round(ua.redirectEnd);Ca.g=this.round(ua.fetchStart);Ca.h=this.round(ua.domainLookupStart);Ca.i=this.round(ua.domainLookupEnd);Ca.j=this.round(ua.connectStart);Ca.k=this.round(ua.connectEnd);Ca.l=void 0!==ua.secureConnectionStart&&null!==ua.secureConnectionStart?this.round(ua.secureConnectionStart):0;Ca.m=this.round(ua.requestStart);Ca.n=this.round(ua.responseStart);Ca.o=this.round(ua.responseEnd);Ca.q=this.round(ua.domInteractive);Ca.r=this.round(ua.domContentLoadedEventStart);Ca.s=this.round(ua.domContentLoadedEventEnd);
Ca.t=this.round(ua.domComplete);Ca.u=this.round(ua.loadEventStart);Ca.v=this.round(ua.loadEventEnd);Ca.w=this.S$;return Ca};ld.prototype.round=function(Ca){return Math.round(1E3*Ca)/1E3};Sk.Object.defineProperties(ld.prototype,{WYd:{configurable:!0,enumerable:!0,get:function(){return Qd.a.hda(this.url)}},mu:{configurable:!0,enumerable:!0,get:function(){return this.jSc}}});Object(kd.a)(ld,"PerformanceTimingEntry",null,[]);var od=b(51),ke=b(211),Re=b(314);qd.prototype.run=function(){if(qd.eQ(window.performance))try{var Ca=
this.ypg();if(qd.fyg.exec(Ca)&&this.BHc.Pdf(Ca)){var ua=new ld(window.performance.timing,Ca);Re.a.instance.K7i(ua.mu.fetchStart);Re.a.instance.L7i(ua.mu.navigationStart);Re.a.instance.QBb(od.a.VFh,"connectStart","requestStart");Re.a.instance.QBb(od.a.eGh,"requestStart","responseStart");Re.a.instance.QBb(od.a.hGh,"responseStart","responseEnd");this.VYd.Pe(1,ua.SVd());this.ai.Tm(od.a.Y2a,ua.mu.fetchStart);this.ai.Tm(od.a.aGh,ua.mu.domainLookupStart);this.ai.Tm(od.a.$Fh,ua.mu.domainLookupEnd);this.ai.Tm(od.a.XFh,
ua.mu.connectStart);this.ai.Tm(od.a.iGh,ua.mu.secureConnectionStart);this.ai.Tm(od.a.WFh,ua.mu.connectEnd);this.ai.Tm(od.a.fGh,ua.mu.requestStart);this.ai.Tm(od.a.wcd,ua.mu.responseStart);this.ai.Tm(od.a.bGh,ua.mu.responseEnd-ua.mu.responseStart);this.ai.Tm(od.a.gGh,ua.mu.responseStart-ua.mu.requestStart);var sb=0,Ld=0,le=0,nf=this.JOj(Ca);sb=nf.transferSize;Ld=nf.p8c;le=nf.V5c;nf.returnValue&&(this.ai.Tm(od.a.jGh,sb),this.ai.Tm(od.a.YFh,le),this.ai.Tm(od.a.cGh,Ld));this.ai.Tm(od.a.dGh,ua.mu.navigationStart)}}catch(ug){ge.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",ug)}};qd.prototype.JOj=function(Ca){var ua,sb;var Ld=sb=ua=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:ua,p8c:sb,V5c:Ld};Ca=window.performance.getEntriesByName(Ca,"navigation");if(void 0===Ca||null===Ca||1!==Ca.length)return{returnValue:!1,transferSize:ua,p8c:sb,V5c:Ld};Ca=Ca[0];var le=Ca.transferSize;void 0!==ua&&null!==ua&&(ua=le);le=Ca.decodedBodySize;
void 0!==le&&null!==le&&(Ld=le);Ca=Ca.encodedBodySize;void 0!==Ca&&null!==Ca&&(sb=Ca);return{returnValue:!0,transferSize:ua,p8c:sb,V5c:Ld}};qd.prototype.Pe=function(Ca,ua){ge.ULS.sendTraceTag(4551815,306,50,zc(Ca,ua))};qd.eQ=function(Ca){return!(void 0===Ca||null===Ca)&&!(void 0===Ca.timing||null===Ca.timing)};Sk.Object.defineProperties(qd,{instance:{configurable:!0,enumerable:!0,get:function(){return qd.Oa||(qd.Oa=new qd(ke.a.instance,null,of.AFrameworkApplication.ga.ra("PerfTimingLoggerFilterDomainsIsEnabled")?
of.AFrameworkApplication.ga.fw("ResourceLoggerDomainAllowList"):null))}}});qd.Oa=null;qd.fyg=RegExp("^https?://.*","i");Object(kd.a)(qd,"PerformanceTimingLogger",null,[382]);var lf=b(93),vc=b(84);bc.prototype.SVd=function(){var Ca={},ua=this.mu;Ca.a=this.WYd;Ca.b=ua.initiatorType;Ca.c=this.round(ua.redirectStart);Ca.d=this.round(ua.redirectEnd);Ca.e=this.round(ua.fetchStart);Ca.f=this.round(ua.domainLookupStart);Ca.g=this.round(ua.domainLookupEnd);Ca.h=this.round(ua.connectStart);Ca.i=this.round(ua.connectEnd);
Ca.j=void 0!==ua.secureConnectionStart&&null!==ua.secureConnectionStart?this.round(ua.secureConnectionStart):0;Ca.k=this.round(ua.requestStart);Ca.l=this.round(ua.responseStart);Ca.m=this.round(ua.responseEnd);Ca.o=this.round(bc.j4a(ua,"decodedBodySize"));Ca.p=this.round(bc.j4a(ua,"encodedBodySize"));Ca.q=this.round(bc.j4a(ua,"transferSize"));Ca.n=this.S$;return Ca};bc.prototype.round=function(Ca){return Math.round(1E3*Ca)/1E3};bc.j4a=function(Ca,ua){return Ca[ua]};Sk.Object.defineProperties(bc.prototype,
{WYd:{configurable:!0,enumerable:!0,get:function(){return 2===this.behavior?this.url:Qd.a.hda(this.url)}},mu:{configurable:!0,enumerable:!0,get:function(){return this.jSc}}});Object(kd.a)(bc,"ResourceTimingEntry",null,[542]);var hd=b(95),Ac=b(129),Vd=b(40),Bd=b(109),tf=b(338);Ke.prototype.cOj=function(Ca){var ua=Ca.name.toLowerCase(),sb=Qd.a.yva(ua);this.rij(sb,ua)&&(sb in this.vgb?ge.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",sb):(ua={},ua.fetchstart=
Ca.fetchStart,ua.responseend=Ca.responseEnd,ua.iscached=this.Hoi(Ca),ua.encodedsize=bc.j4a(Ca,"encodedBodySize"),ua.decodedsize=bc.j4a(Ca,"decodedBodySize"),this.vgb[sb]=ua))};Ke.prototype.rij=function(Ca,ua){if(this.O1d)return Array.contains(this.O1d,Ca);if(this.qWb)for(Ca=Qd.a.YM(ua),ua=0;ua<this.qWb.length;ua++)if(this.qWb[ua]&&Ca.endsWith(this.qWb[ua]))return!0;return!1};Ke.prototype.Hoi=function(Ca){try{var ua=bc.j4a(Ca,"transferSize");if(ua)return!ua;ge.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return Ca.responseEnd-Ca.fetchStart<this.hmg}catch(sb){ge.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",sb.message)}return!1};Ke.prototype.c8i=function(){if(Bd.a.oi(this.vgb))ge.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var Ca=of.AFrameworkApplication.PE?of.AFrameworkApplication.PE.split(";"):[],ua=Object.assign(new tf.a,{extendedProperties:Ac.a.Wr()});ua.extendedProperties.set("Flights",
Vd.c(Ca));this.Ivi(ua,this.vgb,hd.Health.instance)}};Ke.prototype.Ivi=function(Ca,ua,sb){if(ua){var Ld=0,le=0,nf=0,ug=0,Cf=0,Cg=0,Ag=0,eh=0,jh=0,Pg=0,te=0,Fg;for(Fg in ua){var og=ua[Fg];try{var mh=Object(vc.a)(Object,og);if(mh){var cg=mh.iscached?Boolean.parse(mh.iscached.toString()):!1,li=mh.fetchstart?this.parseFloat(mh.fetchstart.toString()):0,fh=(mh.responseend?this.parseFloat(mh.responseend.toString()):0)-li,pf=mh.encodedsize?this.parseFloat(mh.encodedsize.toString()):0,Qf=mh.decodedsize?this.parseFloat(mh.decodedsize.toString()):
0;Ld+=fh;ug+=pf;Ag+=Qf;Pg++;cg?(nf+=fh,Cg+=pf,jh+=Qf,te++):(le+=fh,Cf+=pf,eh+=Qf)}}catch($g){ge.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",$g.message)}}Ca.extendedProperties.set("StaticResources",Vd.c(ua));Ca.extendedProperties.set("TotalResourceDownloadLatency",Ld.toString());Ca.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",le.toString());Ca.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",nf.toString());
Ca.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",ug.toString());Ca.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",Cf.toString());Ca.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Cg.toString());Ca.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",Ag.toString());Ca.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",eh.toString());Ca.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",jh.toString());
Ca.extendedProperties.set("TotalNumberOfResourcesDownloaded",Pg.toString());Ca.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",te.toString());sb.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);sb.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",Ca)}};Ke.prototype.parseFloat=function(Ca){if(!Ca)return 0;Ca=parseFloat(Ca);return isNaN(Ca)?0:Ca};Object(kd.a)(Ke,"AppStaticResourceManager",null,[]);var Wb=Sys.EventArgs;vm(oe,Wb);
Object(kd.a)(oe,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var wc=b(108);se.prototype.PEg=function(Ca){this.rb.addHandler(se.S8c,Ca)};se.prototype.jcj=function(Ca){this.rb.removeHandler(se.S8c,Ca)};se.prototype.ji=function(Ca,ua){var sb=this.JVd!==Ca;this.Tie=Ca;this.isActive&&this.me&&sb&&(this.Np(),this.Zg());this.S4d=ua};se.prototype.activate=function(){!this.isActive&&this.Vue&&(this.Zg(),this.mT=!0)};se.prototype.deactivate=function(Ca){this.isActive&&(this.Np(),Ca&&this.flush(),this.mT=!1)};
se.prototype.flush=function(){if(this.isActive&&this.Vue)try{var Ca=window.performance.getEntriesByType("resource");0<Ca.length-this.thb&&ge.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",Ca.length-this.thb);var ua=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);ua&&(window.performance.clearResourceTimings(),this.thb=0);for(var sb=[],Ld=this.thb;Ld<Ca.length;Ld++)this.BHc.Pdf(Ca[Ld].name)&&
(this.zgb&&this.zgb.cOj(Ca[Ld]),sb.push(new bc(Ca[Ld],this.mch)));ua||(this.thb=Ca.length);this.rb.raiseEvent(se.S8c,new oe(sb));for(Ca=0;Ca<sb.length;Ca++)0!==sb[Ca].behavior&&2!==sb[Ca].behavior||this.VYd.Pe(0,sb[Ca].SVd());0<sb.length&&ge.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",sb.length)}catch(le){ge.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",le)}};se.prototype.Pe=function(Ca,
ua){ge.ULS.sendTraceTag(4310804,306,50,zc(Ca,ua))};se.prototype.J7i=function(){this.zgb.c8i()};se.prototype.Zg=function(){var Ca=this;this.me&&0<this.JVd&&(this.Vi=new wc.a(3,2,1E3*this.JVd,function(){Ca.flush()},5),this.me.Zg(this.Vi),this.zLc=!0)};se.prototype.Np=function(){this.zLc&&(this.me.Np(this.Vi),this.Vi=null,this.zLc=!1)};Sk.Object.defineProperties(se.prototype,{Vue:{configurable:!0,enumerable:!0,get:function(){try{return!(void 0===this.xu||null===this.xu)&&!(void 0===this.xu.getEntriesByType||
null===this.xu.getEntriesByType)}catch(Ca){return ge.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",Ca),!1}}},mch:{configurable:!0,enumerable:!0,get:function(){return this.S4d}},isActive:{configurable:!0,enumerable:!0,get:function(){return this.mT}},JVd:{configurable:!0,enumerable:!0,get:function(){return this.Tie}}});se.S8c="EntriesAvailable";Object(kd.a)(se,"ResourceTimingLogger",null,[372,382]);var yb=b(142);Sd.prototype.init=
function(){this.tb.resolve("Common.NetworkTiming.IResourceTimingLogger");qd.instance.run()};Sd.prototype.dispose=function(){};Sd.prototype.ji=function(Ca){this.tb=Ca;var ua=null;if(of.AFrameworkApplication.ga.ra("ResourceLoggerFilterDomainsIsEnabled"))try{ua=of.AFrameworkApplication.ga.fw("ResourceLoggerDomainAllowList")}catch(le){ge.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}var sb=[];sb.push(Qd.a.YM(yb.a.zL).toLowerCase());sb.push(Qd.a.YM(yb.a.Ncb).toLowerCase());
var Ld=of.AFrameworkApplication.ga.Ad("AppStaticResourceMonitorCacheThresholdInMs",100);Ca.register(372,"Common.NetworkTiming.IResourceTimingLogger").Bc().Lc(function(){return new se(of.AFrameworkApplication.hj,window.performance,ua,sb,Ld)})};Sd.main=function(){Cd.a.instance.sj(new Sd)};Sk.Object.defineProperties(Sd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.ResourceTiming"}}});Object(kd.a)(Sd,"ResourceTimingPackage",null,[4,5]);var mc=b(80),Wc=Sys.EventArgs;vm(Jd,
Wc);Object(kd.a)(Jd,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var Nd=b(167);Ue.prototype.init=function(Ca,ua,sb){this.lfa=Ca;this.SGc=ua;this.o4d=sb;this.lfa.ooe(Object(mc.a)(this,this.MJi,"onCpuMeterFrameAvailable"));this.eGg(Object(mc.a)(this,this.d4g,"cpuPercentThresholdExceeded"))};Ue.prototype.MJi=function(Ca,ua){ua.osf&&(Array.enqueue(this.lVa,ua.osf.CP),this.lVa.length>this.o4d&&(Array.dequeue(this.lVa),this.$Wg()))};Ue.prototype.$Wg=function(){for(var Ca=this.lVa.length,
ua=0,sb=0;sb<Ca;sb++){var Ld=Array.dequeue(this.lVa);ua+=Ld;Array.enqueue(this.lVa,Ld)}Ca=ua/Ca;Ca>this.SGc&&this.rb.raiseEvent("CPTTE",new Jd(this.SGc,Ca))};Ue.prototype.d4g=function(Ca,ua){Nd.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.e6g(ua.sKj,ua.actualValue))};Ue.prototype.eGg=function(Ca){this.rb.addHandler("CPTTE",Ca)};Ue.prototype.e6g=function(Ca,ua){var sb={};sb.ThresholdValue=Ca;sb.ActualValue=ua;return sb};Object(kd.a)(Ue,"CpuMeterMonitor",null,[560]);var Tc=
b(139);Object(kd.a)(Me,"ProfileInformation",null,[]);var Yc=b(12),oc=b(38),ze=b(258);Ad.prototype.Kpe=function(Ca,ua,sb){var Ld=Ad.generateKey(ua,sb);Ld in this.vDa?ua=this.vDa[Ld]:(ua=new Me,ua.S=sb?1:0,this.vDa[Ld]=ua,this.wSc++);ua.C++;ua.M=Ca>ua.M?Ca:ua.M;ua.T+=Ca};Ad.prototype.$Ya=function(Ca,ua){this.Kpe(Ca,ua,!1);this.dKc&&this.Kpe(Ca,ua,!0)};Ad.prototype.getData=function(){if(0<this.JTb&&this.wSc>this.JTb)return this.KNh();var Ca=0<this.zTb,ua={},sb=this.vDa,Ld;for(Ld in sb){var le=Ld,nf=
sb[Ld];this.ZUf(nf);Ca&&nf.T>=this.zTb&&(ua[le]=nf)}return Ca?Bd.a.oi(ua)?null:ua:this.vDa};Ad.prototype.KNh=function(){var Ca=0<this.zTb,ua=[],sb=this.vDa;for(nf in sb){var Ld={key:nf,value:sb[nf]},le=Ld.value;(!Ca||le.T>=this.zTb)&&Array.add(ua,Ld)}if(ua.length>this.JTb)ua.sort(function(ug,Cf){return Cf.value.T-ug.value.T}),ua=ua.slice(0,this.JTb);else if(!ua.length)return null;Ca={};ua=yl(ua);for(sb=ua.next();!sb.done;sb=ua.next()){sb=sb.value;var nf=sb.value;this.ZUf(nf);Ca[sb.key]=nf}return Ca};
Ad.prototype.ZUf=function(Ca){Ca.M=ze.a.t0(Ca.M,0);Ca.T=ze.a.t0(Ca.T,0)};Ad.prototype.reset=function(){this.vDa={};this.wSc=0};Ad.generateKey=function(Ca,ua){return ua?Ca+" [it]":Ca};Object(kd.a)(Ad,"FunctionCallAggregator",null,[200]);xd.TNg="BatchedOperation";xd.replication="Replication";xd.lPj="25";xd.Afj="9_"+xd.TNg+"_"+xd.replication;Object(kd.a)(xd,"CpuMeterConstants",null,[]);Object(kd.a)(fd,"CpuMeterFrame",null,[]);var Ae=Sys.EventArgs;vm(Qb,Ae);Object(kd.a)(Qb,"CpuMeterFrameAvailableEventArgs",
Sys.EventArgs,[]);Object(kd.a)(Zc,"MiniTaskItemInfo",null,[]);Object(kd.a)(jd,"TaskItemInfo",null,[]);var Ve=b(685),nb=b(100);md.F1h=function(){if(!md.PPb&&(md.PPb=new nb.a,of.AFrameworkApplication.ga&&of.AFrameworkApplication.ga.Ty("AggregatorIdDisabledList")))for(var Ca=of.AFrameworkApplication.ga.fw("AggregatorIdDisabledList"),ua=0;ua<Ca.length;ua++)md.PPb.ia(Ca[ua],!0);return md.PPb};md.PPb=null;Object(kd.a)(md,"DisabledAggregatorListStore",null,[]);var Hc=b(261);jc.prototype.track=function(Ca,
ua){ua=void 0===ua?null:ua;this.RX||(this.fmh(),this.Slj(),this.aRb.$Ya(Ca,ua))};jc.prototype.Slj=function(){!this.o$d&&0<this.L8d&&(this.o$d=!0,this.OWf())};jc.prototype.OWf=function(){var Ca=this,ua=new wc.a(5,1,this.L8d,function(){Ca.boj()},19,this._id.toString());this.taskManager.Zg(ua)};jc.prototype.boj=function(){!this.nlb||this.nlb.rxj()?this.VXf():this.ofe&&this.aRb.reset();this.OWf()};jc.prototype.VXf=function(){var Ca=this.aRb.getData();if(Ca){var ua=parseInt(String(Ca.length));if(isNaN(ua)||
0<ua)this.hvc(Ca),this.ofe&&this.aRb.reset()}};jc.prototype.hvc=function(Ca){var ua={};ge.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",(ua.ID=this._id.toString(),ua.Data=Ca,ua))};jc.prototype.fmh=function(){var Ca=this;this.cie||(this.WNc(function(){Ca.VXf()}),this.cie=!0)};jc.iV=function(Ca,ua,sb,Ld,le){return new jc(new Ve.a(function(){return of.AFrameworkApplication.hj}),of.AFrameworkApplication.MLb,Ca,ua,sb,Ld,le)};jc.n3a=function(Ca,ua,sb){return jc.iV(Ca,ua,sb,!0,null)};Sk.Object.defineProperties(jc.prototype,
{taskManager:{configurable:!0,enumerable:!0,get:function(){return this.me||(this.me=this.uxg.value)}}});Object(kd.a)(jc,"Aggregator",null,[218]);Yb.prototype.$Ya=function(Ca,ua){if(!this.nlb||this.nlb.rxj())ua in this.Qm||(this.Qm[ua]=[]),this.Qm[ua].push(Ca)};Yb.prototype.getData=function(){return Bd.a.count(this.Qm)?this.Qm:null};Yb.prototype.reset=function(){this.Qm={}};Object(kd.a)(Yb,"NamedValuesAggregator",null,[200]);var Cc=b(309);Ua.prototype.ooe=function(Ca){this.Tce.addHandler("OnCpuMeterFrameAvailable",
Ca)};Ua.prototype.cab=function(Ca,ua,sb,Ld){sb=(Ld=void 0===Ld?null:Ld)?Ld.priority:7;var le=this.$L();this.start(ua,sb);try{Ca()}finally{this.stop(ua,Ld),Ca=this.$L()-le,this.bbe.track(Ca,ua)}};Ua.prototype.I6=function(Ca,ua){var sb=this.$L();try{Ca()}finally{Ca=this.$L()-sb,this.QIc.$Ya(Ca,ua),0<this.UEa&&this.RIc.$Ya(Ca,ua),this.bbe.track(Ca,ua)}};Ua.prototype.VBd=function(Ca){var ua=new jd;ua.TN=Ca.akc;ua.TP=Ca.priority;this.kMf(1,ua)};Ua.prototype.w8a=function(Ca){this.GSb|=Ca};Ua.prototype.start=
function(Ca,ua){if(!this.UEa){this.RIc.reset();var sb=this.Sif(Ca);sb&&this.Rvd(1);this.DG=new jd;this.DG.TN=Ca;this.DG.TP=ua;this.DG.ST=(new Date).toISOString();this.DG.STS=ze.a.t0(this.$L(),2);sb?this.DG.UI=1:this.Kki(Ca)?this.DG.UI=2:this.DG.UI=0}this.UEa++};Ua.prototype.Rvd=function(Ca){this.JVa|=Ca};Ua.prototype.z0c=function(Ca,ua){this.JVa=void 0===Ca||Ca?0:this.JVa&~(void 0===ua?0:ua)};Ua.prototype.stop=function(Ca,ua){ua=void 0===ua?null:ua;this.UEa--;if(0>=this.UEa&&this.DG){var sb=this.$L()-
this.DG.STS;this.xVb+=sb;this.SMc.$Ya(sb,Ca);this.Sif(Ca)&&this.z0c(!1,1);this.DG.TRT=ze.a.t0(sb,2);ua&&(this.DG.TQT=ze.a.t0(ua.h4i,2),this.DG.TDT=ze.a.t0(ua.dkf,2));this.Dog&&(this.kMf(0,this.DG),this.ggj());this.UEa=0}0<=Ca.indexOf(xd.lPj)&&this.w8a(2);0<=Ca.indexOf(xd.Afj)&&this.w8a(4);1===(this.JVa&1)&&this.w8a(1);2===(this.JVa&2)&&this.w8a(8)};Ua.prototype.ggj=function(){var Ca=this.DG.TRT;if(750<Ca){var ua=this.RIc.getData();if(ua){var sb={},Ld;for(Ld in ua){var le=ua[Ld],nf=Ld;nf.startsWith("SiOp_")||
(sb[nf]=ze.a.t0(100*le.T/Ca,2))}ua=sb}Ca=Object.assign(new Zc,{T:Ca,S:ua});this.usg.track(Ca,this.DG.TN)}};Ua.prototype.JEj=function(){var Ca=this.$L()-this.Phe,ua=ze.a.t0(this.xVb/Ca*100,2);Ca=new fd;Ca.CP=ua;Ca.II=this.GSb;ua=this.SMc.getData();Bd.a.count(ua)&&(Ca.LRT=ua);ua=this.QIc.getData();Bd.a.count(ua)&&(Ca.FP=ua);this.Tce.raiseEvent("OnCpuMeterFrameAvailable",new Qb(Ca));this.w6f()};Ua.prototype.w6f=function(){this.SMc.reset();this.QIc.reset();this.xVb=this.UEa=0;this.Phe=this.$L();this.GSb=
0;this.DG=null};Ua.prototype.run=function(){this.age?this.JEj():(this.w6f(),this.age=!0);this.Oqa?this.Oqa(Object(mc.a)(this,this.run,"run"),1E3):window.setTimeout(Object(mc.a)(this,this.run,"run"),1E3)};Ua.prototype.hUc=function(Ca,ua,sb){var Ld=Array(2);Ld[0]=ua;Ld[1]=sb;this.EWb[Ca]||(this.EWb[Ca]=[]);this.EWb[Ca].push(Ld)};Ua.prototype.kMf=function(Ca,ua){Ca=this.EWb[Ca];if(!Cc.a.oi(Ca))for(var sb=0;sb<Ca.length;sb++){var Ld=Ca[sb],le=Ld[0];Ld=Ld[1];le&&!le(ua)||Ld(ua)}};Ua.prototype.isd=function(){if(!this.fjb){var Ca=
window.setTimeout;this.Oqa=function(ua,sb){return Ca(ua,sb)};this.fjb=!0}};Ua.prototype.Sif=function(Ca){return Ca.startsWith("key")||Ca.startsWith("input")};Ua.prototype.Kki=function(Ca){return Ca.startsWith("click")||Ca.startsWith("mouse")||Ca.startsWith("pointer")};Object(kd.a)(Ua,"CpuMeter",null,[60]);sa.prototype.initialize=function(Ca,ua,sb,Ld){this.shb||(this.shb=new Ua(this.$L,Ca,ua,sb,void 0===Ld?!1:Ld),this.Vl.setResult(this.shb));return this.shb};Object(kd.a)(sa,"CpuMeterProvider",null,
[559]);Lb.prototype.NCh=function(){for(var Ca=0,ua=0;ua<this.gx.length;ua++)this.gx[ua]<this.gx[Ca]&&(Ca=ua);return Ca};Lb.prototype.$Ya=function(Ca,ua){Ca=ze.a.t0(Ca,2);if(this.gx.length<this._count)Array.add(this.gx,Ca),Array.add(this.iRb,ua);else{var sb=this.NCh();Ca>this.gx[sb]&&(this.gx[sb]=Ca,this.iRb[sb]=ua)}};Lb.prototype.getData=function(){if(!this.gx.length)return null;var Ca={};return Ca.Vals=this.gx,Ca.Desc=this.iRb,Ca};Lb.prototype.reset=function(){this.gx=[];this.iRb=[]};Object(kd.a)(Lb,
"MaxDataAggregator",null,[200]);var Sc=b(47),Uc=b(86);Hb.prototype.ji=function(Ca){Ca.register(sa,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").Bc().Lc(function(){return new sa(Sc.a.we)});Ca.register(Ue,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").Bc().Lc(function(){return new Ue})};Hb.prototype.init=function(){var Ca=of.AFrameworkApplication.ga;if(Ca.ra("CpuMeterIsEnabled")){var ua=Uc.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");
Re.a.instance.Eqe.continueWith(function(){Hb.Oai(Ca,ua)})}};Hb.prototype.dispose=function(){};Hb.Oai=function(Ca,ua){var sb=jc.n3a(10,5,new Ad(Ca.Ad("TaskManagerLoggingThreshold",0),Ca.Ad("CpuMeterMaximumEntriesToLog",0)));ua=ua.initialize(new Lb(5),new Ad,sb,Ca.ra("CPUMeterExposeTaskDetailsIsEnabled"));ua.run();Ca.ra("CpuMeterMonitorIsEnabled")&&Uc.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(ua,Ca.iva("CpuMeterAverageCpuPercentThreshold",80),Ca.Ad("CpuMeterRollingAverageFramesCount",
15));Nd.a(16827671,306,50,"Initializing CpuMeter")};Hb.main=function(){Cd.a.instance.sj(new Hb)};Sk.Object.defineProperties(Hb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CpuMeter"}}});Object(kd.a)(Hb,"CpuMeterPackage",null,[4,5]);var ae=b(1080);Gc.prototype.ji=function(){};Gc.prototype.init=function(){ae.a.instance.init()};Gc.prototype.dispose=function(){};Gc.main=function(){Cd.a.instance.sj(new Gc)};Sk.Object.defineProperties(Gc.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return"Common.App.EventsCachePackage"}}});Object(kd.a)(Gc,"EventsCachePackage",null,[4,5]);var ue=b(10),Lf=b(214),xf=b(1247),Rf=b(170),dc=b(373),Oc=b(196),Ed=b(150),Gd=b(57),Ee=b(92),ee=b(1),hf=b(19),kf=b(166),rf=b(889),ng=xf.a;vm(Kb,ng);Kb.prototype.dispose=function(){this.$=null;ng.prototype.dispose.call(this)};Kb.prototype.$bi=function(){this.Zn(Rf.a.ywe);this.Zn(Rf.a.zkd);this.Zn(Rf.a.Udc);this.Zn(Rf.a.Dkd);this.$Tc(Rf.a.Ptd);this.Zn(Rf.a.Ckd)};Kb.prototype.mbi=function(){this.Rga(Rf.a.umb);
this.Rga(Rf.a.Qta);this.Rga("App_CloseTab");this.Rga(Rf.a.hUa);this.Rga(Rf.a.iUa);this.Rga(Rf.a.vkd);this.Rga(Rf.a.Rdc)};Kb.prototype.TNi=function(){var Ca={};Ca.hostMessageReceived=(new Date).getTime();ge.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");of.AFrameworkApplication.Pqd=!0;Ca.appUnloadStart=(new Date).getTime();Ca.sendBeaconFlight=of.AFrameworkApplication.ga.ra("SendBeaconOnShuttingDownRequestsEnabled");Ca.sendBeaconSupported=Gd.a.Lda();Gd.a.Nqe();Ca.appUnloadEnd=(new Date).getTime();
Ca.appMessageSent=(new Date).getTime();this.Sj(Rf.a.WJg,Ca)};Kb.prototype.SNi=function(Ca){ge.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");Ca.Values&&dc.a.Nxd in Ca.Values&&hf.a.equals(Ca.Values[dc.a.Nxd],Oc.a.edit,!0)&&!this.$.isEditMode&&(ge.ULS.sendTraceTag(537162881,0,50,"EwaHostMessenger.OnHostSwitchMode: Switching to {0}",Ca.Values[dc.a.Nxd]),Ca=new Ee.a(-8805455,0,1,0,null),this.$.Ka.Xb(Ca))};Object(kd.a)(Kb,"EwaHostMessenger",xf.a,[378,379,3]);var je=Lf.a;vm(Sa,je);
Sa.prototype.create=function(){var Ca=this,ua=this.$.da,sb=Uc.a.instance;if(!this.DBe){this.DBe=!0;var Ld=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.ya.DocumentHostInfo.PostMessageOrigin||rf.a.W9:of.AFrameworkApplication.eEd||rf.a.W9;sb.register(Kb,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").Bc().Lc(function(){return new Kb(Ca.$,window.parent,Ld,of.AFrameworkApplication.ga.ra("HostSendReadyToAcceptPostMessage"))})}this.Fb(ua.Aa(21)||
ua.Ha(21,sb.resolve("Postmessage.IHostPostmessenger")))};Object(kd.a)(Sa,"HostMessengerFactory",Lf.a,[]);var bg=b(116),ig=b(151),Yd=b(805),If=b(574),Pd=b(74),Ze=b(126),Yf=b(461),Xf=b(42),rg=b(378),uf=b(351),kg=b(354),qh=b(498),La=b(4),Db=b(48);gb.dAh=function(Ca,ua,sb){var Ld={},le=Db.b();switch(Ca.command){case -1537138325:Ld.Action=ua.LabelText;break;case -1104934572:Ld.PrevTab=le.ui(parseInt(ua.OldContextCommand,10));Ld.NextTab=le.ui(parseInt(ua.NewContextCommand,10));break;case 802602464:Ld.Origin=
ua[La.a.rZ];break;case -1027730316:case -1059615499:Ld.MenuType=ua.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5197543_AddColorPickerMenuSectionInfoToLogs")&&"SqmControlId"in ua&&(Ld.SqmControlId=ua.SqmControlId)}Ld.InputMethod=uf.a[Ca.method];Ld.Location=kg.a[Ca.af];Ld.Mode=qh.a[Ca.mode];Ld.IsSystemInitiated="IsSystemInitiated"in ua?ua.IsSystemInitiated:!1;Ld.NoReporting="NoReporting"in
ua?ua.NoReporting:!1;Ca=yl(Object.keys(sb));for(ua=Ca.next();!ua.done;ua=Ca.next())ua=ua.value,Ld[ua]=sb[ua];return Ld};Object(kd.a)(gb,"InteractivityRecord",null,[]);vm(Sb,gb);Object(kd.a)(Sb,"FirstUserInteractivityRecord",gb,[]);var uc=b(686);zb.cbi=function(){zb.I2a||(zb.I2a=new uc.a(If.a.Hk()),zb.I2a.add("InputMethod"),zb.I2a.add("Location"),zb.I2a.add("Mode"))};zb.I2a=null;Object(kd.a)(zb,"ExcelUserAction",null,[]);var Vc=b(207),yd=b(46),Md=b(432),qe=b(249),ac=Pd.a;vm(kc,ac);kc.prototype.dispose=
function(){this.$=this.d5=null;ac.prototype.dispose.call(this)};kc.prototype.tSf=function(Ca,ua,sb){if(this.Yyb){var Ld=Db.b().ui(Ca.command);Ld||ge.ULS.sendTraceTag(537155555,3,50,"InteractivityLogger.ReportCommand: command name is null or empty. commandName: {0}, command: {1}, commandInfo: {2}",Ld,Ca.command,Ca);ua=gb.dAh(Ca,ua,sb);sb=!!ua&&(!("IsSystemInitiated"in ua)||!ua.IsSystemInitiated);this.$&&this.$.ea.Th&&sb&&ae.a.instance.BNf("OtelUserAction",new Md.a(Ld,Ca.tabName,Date.now()));this.ISf(Ld,
ua,null,!0,!0)}};kc.prototype.ee=function(Ca,ua,sb,Ld){this.Yyb&&this.ISf(Ca,ua,void 0===sb?null:sb,!1,void 0===Ld?!1:Ld)};kc.prototype.ATd=function(Ca){if(this.Yyb)if(this.d5){++this.Jbf;this.d5[Ca]||(this.d5[Ca]=[]);var ua=this.Jbf.toString();this.d5[Ca].push(ua);ge.ULS.sendTraceTag(537155553,0,50,"StartInteractivityCorrellation - '{0}', correlation={1}",Ca,ua)}else ge.ULS.shipAssertTag(537155554,0,!1,"StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[{0}] == null",
Ca)};kc.prototype.OTd=function(Ca){if(this.Yyb)if(this.d5&&this.d5[Ca]){var ua=this.d5[Ca],sb=ua.pop().toString();ua.length||delete this.d5[Ca];ge.ULS.sendTraceTag(537155551,0,50,"StopInteractivityCorrellation - '{0}', correlation={1}",Ca,sb)}else ge.ULS.shipAssertTag(537155552,0,!1,"StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[{0}] == null",Ca)};kc.prototype.wQ=function(Ca,ua,sb){var Ld=this;sb=void 0===sb?!1:sb;return this.Yyb?rg.a(function(le){Ld.ee(Ca,
le(),void 0,sb)},kc.uKj,this.ma,Xf.a.aei,!1,!ua):null};kc.prototype.sKd=function(){for(var Ca="",ua=0;ua<kc.z8a;ua++)Ca+=this.Dsd[(this.W4b+kc.z8a-ua-1)%kc.z8a]+",";ge.ULS.sendTraceTag(557188890,0,15,"Last operations {0}",Ca)};kc.prototype.gTj=function(Ca){Ca&&(this.Dsd[this.W4b]=Ca,this.W4b=(this.W4b+1)%kc.z8a)};kc.prototype.Wmf=function(Ca,ua,sb){of.AFrameworkApplication.I7b();var Ld=Ca.operation,le=Ca.properties;void 0!==sb?Yf.a(this.$,432,433,0,function(nf){nf.d8i(Ld,le,sb)}):this.sPj(Ca);this.tPj(Ca);
this.MWi(ua,le,Ld)};kc.prototype.sPj=function(Ca){this.HDj(Ca)||(this.SUe=!0,Ca=new Sb(Ca,yd.PageLoadTrackingInfo.instance.Pja(new Date),yd.PageLoadTrackingInfo.aF()),Ca=Sys.Serialization.JavaScriptSerializer.serialize(Ca),ge.ULS.sendTraceTag(458261331,0,50,"{0}",Ca))};kc.prototype.HDj=function(Ca){var ua=Ca.properties;Ca=Ca.operation;return this.SUe||void 0===Ca||null===Ca||Ca===Ze.a.FTc||Ca===Ze.a.vNd||Ca===Ze.a.DEd||Gd.a.bqd(Ca)||!!ua&&"IsSystemInitiated"in ua&&ua.IsSystemInitiated};kc.prototype.tPj=
function(Ca){ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.gTj(Ca.operation);Ca=Sys.Serialization.JavaScriptSerializer.serialize(Ca);ge.ULS.sendTraceTag(21542793,0,50,"{0}",Ca)};kc.prototype.MWi=function(Ca,ua,sb){bg.a.cla()&&(ua?"NoReporting"in ua&&ua.NoReporting||"IsSystemInitiated"in ua&&ua.IsSystemInitiated||!Ca&&!this.uif||((Ca=bg.a.Rk(ua,kc.FXb,zb.I2a))?(ua=kc.kAh(ua))?ig.a.sendUserActionEvent(bg.a.x4b(sb,null,ua.triggerMethod,ua.commandSurface,
Ca)):ge.ULS.sendTraceTag(537155550,0,50,"user action was null"):ge.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):ge.ULS.sendTraceTag(537155548,0,50,"Not logging action telemetry because adction data was null, actionName: {0}",sb))};kc.prototype.ISf=function(Ca,ua,sb,Ld,le){var nf=this,ug=Vc.a(this.$);if(this.uif){var Cf=null;hf.a.equals(Ca,Ze.a.Vuc,!0)&&ua&&"InputMethod"in ua&&(Cf=Ze.a.PVe(Ca,ua.InputMethod));ug.HHb(Cf||Ca,sb)}else hf.a.equals(Ca,Ze.a.Vuc,!0)&&
ua&&"InputMethod"in ua&&(Ca=Ze.a.PVe(Ca,ua.InputMethod)),ug.HHb(Ca,sb);ua&&(ua.IsCommand=Ld);var Cg=void 0;this.kli&&(Cg="ActionRelativeTime"in ua?ua.ActionRelativeTime:yd.PageLoadTrackingInfo.aF());this.Nfi?Object(qe.b)(function(){var Ag=new gb(Ca,ua,nf.d5);nf.Wmf(Ag,le,Cg)},this.$.ma,50):(sb=new gb(Ca,ua,this.d5),this.Wmf(sb,le,Cg))};kc.kAh=function(Ca){if(!Ca)return null;var ua=new zb;"InputMethod"in Ca&&(ua.triggerMethod=Ca.InputMethod);"Location"in Ca&&(ua.commandSurface=Ca.Location);return ua};
kc.mai=function(Ca){Ca?(Ca.add("Origin",2),Ca.add("InputMethod",2),Ca.add("ButtonType",2),Ca.add("selectedRange",2),Ca.add("SelectedRanges",2),Ca.add("editRange",2),Ca.add("Location",2),Ca.add("Mode",2),Ca.add("CurrentSelectionMode",2),Ca.add("Action",2),Ca.add("type",2),Ca.add("floatingObjectType",2),Ca.add("PrevTab",2),Ca.add("NextTab",2),Ca.add("DialogName",2),Ca.add("dx",3),Ca.add("dy",3),Ca.add("NumberOfSelectedRanges",3),Ca.add("IsCommand",1),Ca.add("IsInFormulaBarEdit",1),Ca.add("isLink",1),
Ca.add("isSheetRef",1),Ca.add("isEmptyText",1),Ca.add("isFormula",1),Ca.add("IsResizingHiddenHeader",1)):ge.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")};kc.uKj=1E3;kc.z8a=40;kc.FXb=null;Object(kd.a)(kc,"InteractivityLogger",Pd.a,[12]);var Kc=b(56),dd=b(35);Object(kd.a)(lb,"CurrentAppInfo",null,[]);var Ud=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit active_cell_selection_change_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"active_cell_selection",actions:new Set(["active_cell_selection_change","cell_text_active_cell_selection_change","formulaBar_active_cell_selection_change"])}].forEach(function(Ca){Ca.actions.forEach(function(ua){Ud.set(ua,Ca.name)})});Object(kd.a)(Va,"AppInfoProperty",null,[]);bb.prototype.getAppState=function(){var Ca=yd.PageLoadTrackingInfo.instance.Pja(new Date);return-1===Ca?"boot":3E4>Ca?"postboot":"steady"};bb.prototype.isChangeGateEnabled=function(Ca){return ee.EwaSettings.isChangeGateEnabled(Ca)};
bb.prototype.getBooleanFeatureGate=function(Ca,ua){return ee.EwaSettings.getBooleanFeatureGate(Ca,ua)};bb.prototype.getCurrentAppInfo=function(){return Object.assign(new lb,this.Vji?{appState:this.getAppState(),appInfoProperties:[Object.assign(new Va,{key:"coauthCount",value:this.$.ea.km.length.toString()})]}:{appState:this.getAppState(),coAuthCount:this.$.ea.km.length})};bb.prototype.sendBeaconTraceTag=function(Ca,ua,sb,Ld){this.$.sendBeaconTraceTag(Ca,ua,sb,Ld)};bb.prototype.getActionBucket=function(Ca){return be(Ca)};
Object(kd.a)(bb,"InteractivityTrackerCallbacks",null,[546]);Object(kd.a)(Ia,"InteractivityTrackerOptions",null,[]);var Le=b(335),ce={timeout:2E3},Nf=b(240);ta.prototype.initialize=function(Ca){ge.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");if(this.sK=interactivity.InteractivityTrackerFactoryGlobal.create()){var ua=new Ia;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5738340_TrackDblClick")&&ta.j8f.push("dblclick");ua.events=ta.j8f;ua.durationThresholdInMs=
ta.durationThresholdInMs;ua.callbacks=new bb(Ca);ua.patchTaskScheduling=ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);Ca=this.sK.start(ua);Ca.started?ge.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):ge.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+Ca.failureReason);ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InteractivityMetricKpi",!1)&&
(this.sK.addEventListener(1,Qe),this.sK.addEventListener(0,Sf))}else ge.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")};ta.prototype.rTa=function(Ca,ua,sb){ee.EwaSettings.Owa()&&sb&&Object(Nf.a)(ua,sb);this.sK?this.sK.track(Ca,ua):ge.ULS.sendTraceTag(537155540,0,50,"InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: {0}",ua)};ta.prototype.qTa=function(Ca,ua,sb){ee.EwaSettings.Owa()&&sb&&(ua=
Object(Nf.a)(ua,sb));this.sK?this.sK.track(Ca,ua):ge.ULS.sendTraceTag(524326924,0,50,"InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: "+ua)};ta.prototype.qFe=function(){return this.sK?this.sK.createActionsRetriever():(ge.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)};ta.prototype.dispose=function(){this.sK&&(this.sK.stop(),this.sK=null,ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InteractivityMetricKpi",
!1)&&(this.sK.removeEventListener(1,Qe),this.sK.removeEventListener(0,Sf)))};ta.durationThresholdInMs=100;ta.j8f=["click","mousedown","contextmenu","keypress","keydown"];ta.pff=!1;Object(kd.a)(ta,"InteractivityTrackerService",null,[363]);var af=Lf.a;vm(ra,af);ra.prototype.create=function(){var Ca=this;if(ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")){var ua=Kc.GetServiceTaskFactory.Wa(this.$.da,283,284,this.ub);dd.TaskExtensions.Ba(ua,function(){dd.TaskExtensions.Ba(Le.c(ua.result.Un.loadScript("interactivity")),
function(){Ca.Fb(Ca.$.da.Aa(443)||new ta(Ca.$))},Ca.$.ma,3)},this.$.ma,3)}else this.Fb(this.$.da.Aa(443)||this.$.da.Ha(443,new ta(this.$)))};ra.ja=function(Ca){Ca.da.Ha(444,new ra(Ca))};Object(kd.a)(ra,"InteractivityTrackerServiceFactory",Lf.a,[]);var wf=b(88),vf=b(387),pg=b(8),bf=b(44),Bf=b(54);Ba.prototype.getCustomProperties=function(Ca){var ua=new Map;if(Ca.hasOwnProperty("startTimeInMs")&&Ca.hasOwnProperty("totalExecutionTimeInMs")){var sb=Ca.startTimeInMs;Ca=this.tEj.retrieveSlowActionsBetweenTimeRange(sb,
sb+Ca.totalExecutionTimeInMs);ua.set("actions",Bf.a.Kc(Ca))}return ua};Object(kd.a)(Ba,"CallTreeCustomPropertiesRetriever",null,[544]);P.prototype.addCustomProperty=function(Ca,ua){this.customProperties.set(Ca,ua)};P.prototype.getCustomProperties=function(){return this.customProperties};Object(kd.a)(P,"CustomPropertiesRetriever",null,[543]);Ob.prototype.isFeatureEnabled=function(Ca,ua){return ee.EwaSettings.getBooleanFeatureGate(Ca,ua)};Object(kd.a)(Ob,"ExcelFeatureChecker",null,[395]);cc.prototype.isProfilingEnabled=
function(){return!0};Object(kd.a)(cc,"ExcelProfilingFeatureChecker",null,[396]);Jb.prototype.onProfilerEvent=function(Ca){switch(Ca.eventId){case 1:this.ITi(ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.KeepOldCollectedActions",!1));break;case 0:this.KTi();break;default:ge.ULS.sendTraceTag(537155529,0,15,"JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId {0}",Ca.eventId)}};Object(kd.a)(Jb,"JSCPUProfilerObserver",null,[394]);Object(kd.a)(ic,"JSCPUProfilerInitOptions",
null,[]);Object(kd.a)(Ub,"JSCPUProfilingPackageInitOptions",null,[]);pb.prototype.dispose=function(){ge.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");wf.a.Fa(this.D6f);this.FFd=this.$=null;this.GFd.clear();this.dab.clear()};pb.prototype.PFj=function(){var Ca=this,ua=Math.random()*this.vCe;ge.ULS.sendTraceTag(537155526,0,50,"JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: {0}",ua);this.D6f=bf.a.instance.create(function(){Ca.igd("ExcelOnlineContinuousSessionProfiler",
2).start()},ua,Xf.a.Iwj,!0)};pb.prototype.aGj=function(){ge.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.igd("ExcelOnlineFullSessionProfiler",3).start()};pb.prototype.hGj=function(Ca){var ua=void 0===ua?1E4:ua;ge.ULS.sendTraceTag(537155524,0,50,"JsSelfProfilerManager.StartManualProfiler: Starting a new profiler");this.Ngf(Ca)?this.igd(Ca,0,ua).start():ge.ULS.shipAssertTag(537155523,0,!1,"JsSelfProfilerManager.StartManualProfiler: Profiler name is invalid.")};
pb.prototype.eHj=function(Ca){this.Ngf(Ca)?(Ca=this.w2e(Ca))&&Ca.stop():ge.ULS.shipAssertTag(537155522,0,!1,"JsSelfProfilerManager.StopManualProfiler: Profiler name is invalid.")};pb.prototype.EFd=function(Ca){return this.dab.has(Ca)};pb.prototype.yGj=function(){ee.EwaSettings.Y2e()||(ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.aGj():this.PFj())};pb.prototype.createProfiler=function(Ca,ua,sb,Ld,le,nf){ge.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");
var ug=new ic;ug.samplingIntervalInMs=ua;ug.maximumNumberOfSamplesToTake=sb;ug.idleIntervalInMs=Ld;ug.profilingIntervalInMs=le;return this.a9g(Ca,nf,ug)};pb.prototype.Xbi=function(){var Ca=new cc,ua=new Ub;ua.ulsInstance=new vf.a;ua.deObfuscationEndpoint="ProfilerReporting.ashx";ua.shouldCompressSerializedCallTrees=!1;ua.shouldKeepSamplesOutsideOfProfilingInterval=!1;ua.shouldSendAllCallTreesFromProfileInASingleRequest=!ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",
!1);ua.shouldUseSendBeaconForSendingCallTrees=ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",!1);ua.callTreeFilteringThresholdInMs=ee.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",50);ua.deObfuscationRequestQueryParamsRetriever=this.T5g();ua.deObfuscationRequestBodyPropertiesRetriever=this.S5g();ua.featureEnabledChecker=new Ob;ua.useMainEventLoopForProfilerTraceProcessing=!1;ua.profilerTraceProcessingWebWorkerSourceURL=
this.$.ya.JSProfilerProcessingWebWorkerJsScriptUrl;ua.shouldProcessProfileCapturedWhileUserIsIdle=ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldProcessProfileCapturedWhileUserIsIdle",!0);this.FFd=this.GKf.retrievePackage(Ca,ua).retrieveProfilerFactory()};pb.prototype.T5g=function(){var Ca=new P;Ca.addCustomProperty(pg.a.qLf,of.AFrameworkApplication.userType);Ca.addCustomProperty(of.AFrameworkApplication.lfb,of.AFrameworkApplication.userSessionId);Ca.addCustomProperty(pg.a.Esf,
this.$.ya.SkipAuthentication?pg.a.Fsf:null);Ca.addCustomProperty(pg.a.ZFd,this.$.ya.MachineCluster);return Ca};pb.prototype.S5g=function(){var Ca=new P;Ca.addCustomProperty("appName","Excel");Ca.addCustomProperty("buildVersion",of.AFrameworkApplication.buildVersion);Ca.addCustomProperty("shouldUseSourceMaps","true");ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5619353_profilerFilterSensitiveResources")&&Ca.addCustomProperty("shouldFilterSensitiveResources","true");ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5636639_UseNewDeobfForProfiler")&&
Ca.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator","true");return Ca};pb.prototype.a9g=function(Ca,ua,sb){var Ld=new P;Ld.addCustomProperty("ProfilerName",Ca);this.FKf.set(Ca,Ld);ua=this.FFd.createProfiler(ua,sb,Ld);this.dab.set(Ca,ua);ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5786153_JsProfilerAddSlowActionsRetriever")&&(Ca=this.t7g(Ca),ua.subscribeProfilerObserver(Ca,this.Z2i));return ua};pb.prototype.w2e=function(Ca){return this.EFd(Ca)?this.dab.get(Ca):(ge.ULS.shipAssertTag(537155520,
0,!1,"JsSelfProfilerManager.GetProfiler: Profiler with such name ({0}) does not exist",Ca),null)};pb.prototype.igd=function(Ca,ua,sb){sb=void 0===sb?null:sb;if(this.EFd(Ca))return this.w2e(Ca);var Ld=this.Cqi;return this.createProfiler(Ca,Ld,null!=sb&&0<Ld?sb/Ld:2E6,2===ua?this.vCe:null,0===ua?null:this.profilingIntervalInMs,ua)};pb.prototype.t7g=function(Ca){var ua=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?this.interactivityTrackerService:
Nf.b(this.$);if(ua){var sb=ua.qFe();if(sb){ua=this.dab.get(Ca);var Ld=new Ba(sb);ua.subscribeCallTreeCustomPropertiesRetriever(Ld);ua=new Jb(function(le){sb.startCollectingSlowActions(le)},Object(mc.a)(sb,sb.stopCollectingSlowActions,"stopCollectingSlowActions"));this.GFd.set(Ca,ua);return ua}ge.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}ge.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");
return null};pb.prototype.Ybi=function(){this.GKf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.FKf=new Map;this.GFd=new Map;this.dab=new Map};pb.prototype.Ngf=function(Ca){return!!Ca};Object(kd.a)(pb,"JsSelfProfilerManager",null,[381,3]);var $e=Lf.a;vm(Oa,$e);Oa.prototype.create=function(){var Ca=this;ge.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");var ua=Kc.GetServiceTaskFactory.Wa(this.$.da,283,284,this.ub);
dd.TaskExtensions.Ba(ua,function(){ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?Ca.$.da.Za(443,function(sb){Ca.tEe(ua.result,sb)}):Ca.tEe(ua.result)},this.$.ma,3)};Oa.prototype.tEe=function(Ca,ua){var sb=this;dd.TaskExtensions.Ba(Le.c(Ca.Un.loadScript("officeOnlineCpuProfiling")),function(){sb.Fb(sb.$.da.Aa(437)||new pb(sb.$,ua))},this.$.ma,3)};Oa.ja=function(Ca){Ca.da.Ha(438,new Oa(Ca))};Object(kd.a)(Oa,"JsSelfProfilerManagerFactory",Lf.a,
[]);Object(kd.a)(lc,"ActionData",null,[]);Object(kd.a)(Xb,"BlockedEngagementInfo",null,[]);vm($b,lc);Object(kd.a)($b,"SuccessfulActionData",lc,[]);Object(kd.a)(pd,"SuccessfulEngagementInfo",null,[]);var He=b(41);sc.prototype.dispose=function(){this.$.ea&&this.$.ea.Lq(this.Wg);this.$.sn(this.od);wf.a.Fa(this.OLb);this.$=this.OLb=null};sc.prototype.d8i=function(Ca,ua,sb){if(void 0!==Ca&&null!==Ca&&ua){var Ld=this.Mdb.successfulActions.length+1,le="InputMethod"in ua?ua.InputMethod:"",nf="IsCommand"in
ua&&ua.IsCommand;Ld>sc.Upf||!this.Yoi(Ca,ua,le,nf)||(Ca=Object.assign(new $b,{order:Ld,name:Ca,componentName:"Location"in ua?ua.Location:"",timeFromNavigationStart:sb,inputMethod:le,isCommand:nf}),Array.add(this.Mdb.successfulActions,Ca),1===Ld?this.mvi():Ld===sc.Upf&&this.lBb())}};sc.prototype.R7i=function(Ca){He.a(this.$).aZb(this.FEb);this.Pob.hasBlockedActions=!0;this.FEb(null,Ca)};sc.prototype.zui=function(){ge.ULS.sendTraceTag(254546634,0,50,"{0}",Vd.c(this.Pob))};sc.prototype.mvi=function(){yd.PageLoadTrackingInfo.instance.Pja(new Date)>
sc.VBh?ge.ULS.sendTraceTag(537154758,0,50,"First user interaction was filtered: {0}",Vd.c(this.Mdb.successfulActions[0])):ge.ULS.sendTraceTag(254563592,0,50,"{0}",Vd.c(this.Mdb.successfulActions[0]))};sc.prototype.lBb=function(){!this.b8f&&this.Mdb.successfulActions.length&&(this.b8f=!0,wf.a.Fa(this.OLb),this.OLb=null,this.$.sendBeaconTraceTag(254559496,50,!1,Vd.c(this.Mdb)))};sc.prototype.JBh=function(){this.uJa.add(Ze.a.FTc);this.uJa.add(Ze.a.vNd);this.uJa.add(Ze.a.DEd);this.uJa.add(Ze.a.gJf);this.uJa.add(Ze.a.iJf);
this.uJa.add(Ze.a.kJf)};sc.prototype.Yoi=function(Ca,ua,sb,Ld){sb=!sb||"unknown"===sb;var le="IsSystemInitiated"in ua&&ua.IsSystemInitiated;ua="NoReporting"in ua&&ua.NoReporting;var nf=this.uJa.has(Ca);Ca=hf.a.equals(Ca,Ze.a.Vuc,!0)&&sb;return!le&&!ua&&!nf&&!Ca&&!(Ld&&sb)};sc.Upf=10;sc.VBh=6E4;sc.ZHj=12E4;Object(kd.a)(sc,"PageLoadEngagementInfo",null,[380]);var vg=Lf.a;vm(mb,vg);mb.prototype.create=function(){this.Fb(this.$.da.Aa(432)||this.$.da.Ha(432,new sc(this.$)))};mb.ja=function(Ca){Ca.da.Ha(433,
new mb(Ca))};Object(kd.a)(mb,"PageLoadEngagementInfoFactory",Lf.a,[]);var ah=b(49),Ph=b(144),Pf=b(520),Da=b(36),Fb=b(73),Lc=b(376),ud=b(32),zd=b(224),Ce=Sys.EventArgs;vm(Za,Ce);Object(kd.a)(Za,"ErrorDataArgs",Sys.EventArgs,[]);var Ge=b(691),gf=b(107),Df=b(26);ec.prototype.$tj=function(Ca){this.q5b||(this.pge=Ca,this.oge=gf.toUtc(this.IIb))};ec.prototype.w8h=function(Ca){if(Ca.Values&&(!this.f5a||!this.g5a))try{dc.a.a$e in Ca.Values&&(this.f5a=parseInt(Ca.Values[dc.a.a$e].toString(),10));dc.a.b$e in
Ca.Values&&(this.g5a=parseInt(Ca.Values[dc.a.b$e].toString(),10));var ua=Re.a.instance;0<this.f5a&&(this.Umf(this.f5a,"PageLoadFromHostClick"),ua.f8i(this.f5a));0<this.g5a&&(this.Umf(this.g5a,"PageLoadFromHostFrameCreation"),ua.g8i(this.g5a));var sb=Ca.Values[dc.a.z8h]||0,Ld=Ca.Values[dc.a.x8h]||Ca.Values[dc.a.y8h]||0;0<Ld&&ua.T7i(Ld);ua.U7i(sb)}catch(le){}};ec.prototype.Khj=function(){this.VWf=this.Jze=Df.a.Ra.Kb;this.wde=0;this.tkd=this.q5b=!1};ec.prototype.rwe=function(Ca){var ua=this.Jze.getTime();
return ua>=Ca?0:Ca-ua+this.uGf};ec.prototype.Umf=function(Ca,ua){if(Ca){var sb=Db.b();sb.CLb("UserAction",ua,ua,Df.a.HBb(Ca),Ge.EcmaDateClock.instance.appStart);sb.Gsb(ua,gf.toTimestamp(this.IIb))}};Sk.Object.defineProperties(ec.prototype,{uGf:{configurable:!0,enumerable:!0,get:function(){return this.wde}},IIb:{configurable:!0,enumerable:!0,get:function(){return this.pge}},UWf:{configurable:!0,enumerable:!0,get:function(){return this.oge}},Aqi:{configurable:!0,enumerable:!0,get:function(){return this.rwe(this.VWf.getTime())}},
zXi:{configurable:!0,enumerable:!0,get:function(){return this.rwe(this.UWf.getTime())}},H2f:{configurable:!0,enumerable:!0,get:function(){return!(this.q5b||void 0===window.bsqmXLSPageLoadStartTime)}},Jze:{configurable:!0,enumerable:!0,get:function(){try{return this.AQb||(this.AQb=gf.toUtc(window.bsqmXLSPageLoadStartTime)),this.AQb}catch(Ca){return null}},set:function(Ca){this.AQb=Ca}}});Object(kd.a)(ec,"PageLoadPerfInfo",null,[]);var Ea=b(69);tb.prototype.sJb=function(Ca,ua){Ca&&(this.nRc=this.Bdb|
ua<<16)};Sk.Object.defineProperties(tb.prototype,{Bdb:{configurable:!0,enumerable:!0,get:function(){return this.nRc}},keyCode:{configurable:!0,enumerable:!0,get:function(){return this.Bdb&65535}}});Object(kd.a)(tb,"ShortcutSqmData",null,[]);Ya.prototype.sVg=function(Ca,ua,sb){0===sb&&(sb=this.B_g[ua.toString()]);return Ya.G2f(Ca,sb)&&(Ca=new tb(Ca,sb,Ec.a.isMac),!ud.a.yg(this.Mud,Ca.Bdb.toString()))?(this.Mud[Ca.Bdb.toString()]=!0,Ca):null};Ya.prototype.LTf=function(){this.Mud={}};Ya.r5g=function(){var Ca=
{};return Ca["0"]=0,Ca["1"]=1,Ca["2"]=2,Ca["4"]=3,Ca["8"]=4,Ca["16"]=5,Ca["32"]=6,Ca};Ya.eji=function(Ca){return 112<=Ca&&123>=Ca||61440<=Ca&&61451>=Ca};Ya.uki=function(Ca){return 17!==Ca&&18!==Ca&&16!==Ca&&91!==Ca&&93!==Ca};Ya.G2f=function(Ca,ua){var sb=Ca.ctrlKey||Ca.altKey||Ea.b(Ca);Ca=Ca.keyCode;sb=Ya.eji(Ca)||sb;sb=Ya.uki(Ca)&&sb;return 0!==ua&&sb};Object(kd.a)(Ya,"UnhandledShortcutLogger",null,[]);Eb.prototype.mYb=function(Ca){Array.add(this.F2b,Ca)};Eb.prototype.Yba=function(Ca,ua,sb){try{if(ua)ua.endTime=
sb,this.sqmManager.Nle(ua);else{ua=0;for(var Ld=this.F2b.length;ua<Ld;ua++){var le=this.F2b[ua];Ca?(le.endTime=le.startTime,le.RAe=0):le.endTime=sb;this.sqmManager.Nle(le)}}}catch(nf){}finally{Array.clear(this.F2b)}};Object(kd.a)(Eb,"UserInteractionPerfInfo",null,[]);var kb=b(33),Vb=b(65),Qc=b(223),Mc=Pd.a;vm(ub,Mc);ub.prototype.YUc=function(Ca){this.Ma.addHandler("EREK",Ca)};ub.prototype.kJd=function(Ca){this.Ma.removeHandler("EREK",Ca)};ub.prototype.dispose=function(){this.Oah&&of.AFrameworkApplication.Mm&&
of.AFrameworkApplication.Mm.disable();this.$&&this.$.sn(this.od);this.$=this.lCc=this.lPa=this.jU=null;Mc.prototype.dispose.call(this)};ub.prototype.$6e=function(Ca){this.lPa.w8h(Ca);this.vvi()};ub.prototype.eOd=function(Ca){this.setDw(9415,Ca)};ub.prototype.mYb=function(Ca){this.lCc.mYb(Ca)};ub.prototype.Yba=function(Ca,ua,sb){this.lCc.Yba(Ca,ua,sb)};ub.prototype.pud=function(Ca){if(this.Z2){var ua=this.ea.isNamedObjectViewMode&&1===this.workbookContext.NovMode;Ca=this.$.isEditMode||Ca&&this.ea.workbookContext.Options&
512?2:ua?9:this.ea.nc.inEmbedView?14:1;this.setDw(8721,Ca);this.QDh(Ca);this.VGc=!1}};ub.prototype.hnf=function(){var Ca=this.lPa;this.Z2&&Ca.H2f&&(this.setDw(9450,Ca.uGf),this.setDw(9085,Ca.Aqi))};ub.prototype.inf=function(Ca){if(!this.JHb){this.JHb=!0;var ua=this.lPa,sb=0;this.Z2&&ua.H2f?(ua.$tj(Ca),this.lCc.VJg=ua.UWf,this.setDw(9086,ua.zXi),ua.q5b=!0,sb=this.lPa.IIb.getTime()):sb=Ca.getTime();dd.TaskExtensions.Ba(this.Xub.value,function(Ld){var le={};Ld.result.Sj(Rf.a.OJg,(le[dc.a.PJg]=sb,le))},
this.ma,3)}};ub.prototype.Nle=function(Ca){this.Z2&&Ca&&1!==Ca.fea&&this.Xga(8327,zd.b(Ca),zd.n(Ca),zd.a(Ca),2,Ca.RAe,zd.o(Ca),zd.d(Ca),zd.e(Ca))};ub.prototype.pKd=function(Ca,ua){Ca&&Ca.MessageIdHash&&this.oKd(Ca.MessageIdHash,Ca.MessageIdName,Ca.MessageId,Ca.ErrorCause?Ca.ErrorCause:ah.a.KAc,!1,ua,Ca,null)};ub.prototype.oKd=function(Ca,ua,sb,Ld,le,nf,ug,Cf){ub.appEncounteredFirstError||(ub.appEncounteredFirstError=!0,Ph.a.get_instance().isCompleted(13)||(Ph.a.get_instance().Jw(13),ge.ULS.sendTraceTag(537151323,
0,50,"App encountered its first error so updating app init status")));Ca=this.Osb(Ca);var Cg=!!ug,Ag={};Ag.ErrorName=ua;Ag.ErrorHashCode=Ca.toString();Ag.ErrorId=sb.toString();Ag.ErrorCause=Ld.toString();Ag.ErrorType=0===nf?"ErrorDialog":"BusinessBar";Ag.BusinessBarEntryName=Cf||"null";Ag.ServerCorrelationId=Cg?ug.CorrelationId:"null";Ag.WebMethodName=Cg?ug.WebMethodName:"null";Ag.SessionHostingEcs=this.ea.workbookContext?this.ea.workbookContext.EcsServerName:"null";Ag.EcsServerId=Cg?ug.EcsServerId:
"null";Ag.WfeServerId=Cg?ug.WfeServerId:"null";ua=Bf.a.Kc(Ag);this.Ma.raiseEvent("EREK",new Za(Ag));ge.ULS.sendTraceTag(1881314,0,15,ua);this.Z2&&(Ac.a.DNf(Ca.toString()),this.Xga(9134,Ca,Ld,ah.a.tXd),this.ea.Vt||le||(this.setDw(10459,Ca),this.pud(!0),this.ojd=!0,this.upload(),this.Saf()))};ub.prototype.Osb=function(Ca){return 5439488|(Ca>>>16^Ca&65535)&65535};ub.prototype.Fud=function(Ca,ua,sb){Ca=this.Pbg.sVg(Ca,ua,sb);this.Z2&&Ca&&this.Xga(11007,Ca.Bdb)};ub.prototype.upload=function(){!this.Z2||
!this.JHb&&!this.ojd||Ec.a.Df&&of.AFrameworkApplication.Ig?Ec.a.Df&&of.AFrameworkApplication.Ig&&ge.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.jU.SNb(),this.VGc=!0);of.AFrameworkApplication.Mm=this.jU=null;this.lPa.Khj();this.JHb=!1;of.AFrameworkApplication.Mm=this.jU=this.dMe();this.Pbg.LTf()};ub.prototype.vvi=function(){var Ca=this.lPa;if(this.Z2&&!Ca.tkd){var ua=Ca.f5a,sb=Ca.g5a,Ld=Ca.IIb.getTime();of.AFrameworkApplication.HQ=Ca.IIb;ua&&this.setDw(10324,ua>
Ld?0:Ld-ua);sb&&this.setDw(10325,sb>Ld?0:Ld-sb);Ca.tkd=!0}};ub.prototype.Xga=function(Ca,ua){for(var sb=[],Ld=1;Ld<arguments.length;++Ld)sb[Ld-1]=arguments[Ld];this.Z2&&this.jU.Xga.apply(this.jU,[Ca].concat(Gl(sb)))};ub.prototype.setDw=function(Ca,ua){this.Z2&&this.jU.setDw(Ca,ua)};ub.prototype.dMe=function(){Lc.a.AMe(this.$.ya);return of.AFrameworkApplication.Mm};ub.prototype.QDh=function(Ca){try{var ua=Object(vc.a)(Object,Bf.a.pi(of.AFrameworkApplication.ga.appSettings.SessionStartInfoJson))}catch(le){ge.ULS.sendTraceTag(537151311,
0,15,"Couldn't parse SessionStartInfoJson. Message: {0}",le.message);return}if(ua){var sb=Object(vc.a)(String,ua.ApplicationModeExtended),Ld=Object(vc.a)(String,ua.ApplicationMode);sb&&Ld&&(sb=sb.toUpperCase(),2!==Ca&&16!==Ca||"VIEW"!==sb&&"UNIFIED"!==sb?1!==Ca||"EDIT"!==sb&&"UNIFIED"!==sb||(sb="VIEW",Ld="View"):(sb="EDIT",Ld="Edit"),ua.ApplicationModeExtended=sb,ua.ApplicationMode=Ld,of.AFrameworkApplication.ga.appSettings.SessionStartInfoJson=Bf.a.Kc(ua))}};ub.prototype.Saf=function(){var Ca=this.$.ya;
this.jU.WV=!0;this.jU.JNb(Ca.BWsaStartTime);this.setDw(59,83);this.JHb=!1;if(this.Z2){var ua=Ca.DocumentHostInfo;this.q$g();this.setDw(8491,this.$.RI);this.setDw(9236,Ca.RequestedUILcid);this.setDw(8473,Ca.WacHostId);this.setDw(9902,zd.c(ua.ClusterId));ee.EwaSettings.la(472)?this.jU.SZf(""):this.jU.SZf(Ca.FlightHolder?Ca.FlightHolder.FlightId:"");this.eOd(this.ea.nc.inEmbedView?1:0);this.ojd=!1;this.setDw(9104,zd.c(ua.FileSourceId));this.setDw(10309,this.Hdi);this.bwj();of.AFrameworkApplication.Gb.OOf(Pf.a.getInstance(!1))}};
ub.prototype.bwj=function(){Re.a.instance.sai(this.jU);if(this.J2f){var Ca=Re.a.instance;Ca.O7i();Ca.b8i();Ca.a8i();Ca.$7i();Ca.W7i();this.J2f=!1}};ub.prototype.q$g=function(){this.createStream(8327,1,Qc.a.Ich,Qc.a.i1a);this.createStream(9134,1,3,Qc.a.i1a);this.createStream(11007,1,1,Qc.a.i1a)};ub.prototype.createStream=function(Ca,ua,sb,Ld){this.jU.createStream(Ca,ua,sb,Ld)};Sk.Object.defineProperties(ub.prototype,{Oah:{configurable:!0,enumerable:!0,get:function(){return this.VGc}},Hdi:{configurable:!0,
enumerable:!0,get:function(){return this.$.frame.VV?pg.a.Jdi:pg.a.Idi}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},jU:{configurable:!0,enumerable:!0,get:function(){ub.Hgb||(ub.Hgb=this.dMe());ub.MYc||(ub.MYc=!0,this.Saf());return ub.Hgb},set:function(Ca){ub.Hgb=Ca;ub.Hgb||(ub.MYc=!1)}},Z2:{configurable:!0,enumerable:!0,get:function(){return Fb.a(this.$.ya,3)}}});ub.Hgb=null;ub.MYc=!1;ub.appEncounteredFirstError=!1;Object(kd.a)(ub,"SqmManager",Pd.a,
[167,309]);var Ab=b(880);Object(kd.a)(ib,"PerformanceObserverInit",null,[]);var nc=Sys.EventArgs;vm(vb,nc);Object(kd.a)(vb,"LongTaskObservedEventArgs",Sys.EventArgs,[]);var Rd=Sys.EventArgs;vm(Dc,Rd);Object(kd.a)(Dc,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);Mb.prototype.goe=function(Ca){this.Ma.addHandler("ltoek",Ca)};Mb.prototype.Ycj=function(Ca){this.Ma.removeHandler("ltoek",Ca)};Mb.prototype.OFg=function(Ca){this.Ma.addHandler("ltpoiek",Ca)};Mb.prototype.Zcj=function(Ca){this.Ma.removeHandler("ltpoiek",
Ca)};Mb.prototype.dispose=function(){this.$.ea.Lq(this.Wg);wf.a.Fa(this.Ma);this.$=this.Ma=null};Sk.Object.defineProperties(Mb.prototype,{Kec:{configurable:!0,enumerable:!0,get:function(){return this.nKc}}});Object(kd.a)(Mb,"LongTaskPerformanceObserver",null,[3]);var Je=b(185);cb.prototype.rpi=function(Ca){return 100*this.Sud>Ca};cb.prototype.rDg=function(Ca){this.bne(Ca.longTaskDuration);this.JUc(Ca.activeSessionDuration)};cb.prototype.bne=function(Ca){this.longTaskDuration+=Ca};cb.prototype.JUc=
function(Ca){this.activeSessionDuration+=Ca};Sk.Object.defineProperties(cb.prototype,{Sud:{configurable:!0,enumerable:!0,get:function(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}}});Object(kd.a)(cb,"LongTaskPerformanceData",null,[]);Sk.Object.defineProperties(Ga.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return"LongTaskPerformance"}}});Sk.Object.defineProperties(Ga,{Kkh:{configurable:!0,enumerable:!0,get:function(){return new Ga(!1,
new cb,new cb,new cb,0)}}});Object(kd.a)(Ga,"LongTaskPerformanceDataStatistics",null,[285]);var he=Sys.EventArgs;vm(za,he);Object(kd.a)(za,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var Ff=b(462),Fe=b(377);ya.prototype.PFg=function(Ca){this.Ma.addHandler("lttek",Ca)};ya.prototype.$cj=function(Ca){this.Ma.removeHandler("lttek",Ca)};ya.prototype.dispose=function(){this.oRd=!1;this.l7f();this.$.pl(this.rd);this.$.sn(this.od);this.wN.Zcj(this.tAf);wf.a.Fa(this.MNa);this.wN=this.$=this.MNa=null;void 0!==
this.Fe&&null!==this.Fe&&wf.a.Fa(this.Fe)};ya.prototype.zyc=function(){void 0===this.Fe||null===this.Fe?ge.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.wN.Kec?this.jic?ge.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.oRd?(this.jic=!0,this.T5=Ga.Kkh,this.QS=new cb,this.$.ea.bha(this.kI),
this.maxUsersCount=this.$.ea.km.length,this.wN.goe(this.xnc),this.Fe.DFa(this.qmc),this.Fe.nnb(this.rmc),of.AFrameworkApplication.PUc(this.qmc),of.AFrameworkApplication.QUc(this.rmc),this.MNa=bf.a.instance.create(this.Lnf,this.Rud,Xf.a.Zmf,!1),Vc.a(this.$).H9(this.T5),this.Fe.Di||of.AFrameworkApplication.e7a||this.nTd(!0),ge.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):ge.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):
ge.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")};ya.prototype.l7f=function(){this.jic&&(this.jic=!1,this.$.ea.Lq(this.Wg),this.wN.Ycj(this.xnc),this.$.ea.sda(this.kI),void 0!==this.Fe&&null!==this.Fe&&(this.Fe.Zab(this.qmc),this.Fe.fHb(this.rmc)),of.AFrameworkApplication.qQf(this.qmc),of.AFrameworkApplication.rQf(this.rmc),this.MNa.cancel(),this.cNa=this.QS=this.T5=null,
this.maxUsersCount=0)};ya.prototype.nTd=function(Ca){Ca||void 0===this.cNa||null===this.cNa?(this.cNa=Df.a.Ra.Kb,this.MNa=Je.AsyncMethodContext.v8g(this.Lnf,Ca?this.Rud:this.Rud-this.QS.activeSessionDuration,Xf.a.Zmf,this.MNa)):ge.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")};Object(kd.a)(ya,"LongTaskPerformanceTracker",null,[3]);var Tf=Da.a;vm(eb,
Tf);eb.prototype.tq=function(Ca){this.addHandler("LTSCEK",Ca)};eb.prototype.Mq=function(Ca){this.removeHandler("LTSCEK",Ca)};eb.prototype.vz=function(){this.kn("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")};eb.prototype.$r=function(Ca,ua){if("QueryLongTasksCount"!==Ca)return!1;this.V4h(ua);return!0};eb.prototype.kn=function(){return ee.EwaSettings.la(613)};eb.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.RF(this),this.statusBarManager=null);this.f8a.$cj(this.uAf);
Tf.prototype.dispose.call(this)};eb.prototype.V4h=function(Ca){Ca.Value=String.format("Long Tasks: {0} | Last Task Duration: {1}ms",this.Unf,Math.round(this.qkf))};Object(kd.a)(eb,"LongTasksStatusBarManager",Da.a,[3,185,186]);var Hd=b(9);Object(kd.a)(Cb,"NetworkInfoData",null,[]);var Ye=Da.a;vm(ob,Ye);ob.prototype.tq=function(Ca){this.addHandler("NetworkInformation",Ca)};ob.prototype.Mq=function(Ca){this.removeHandler("NetworkInformation",Ca)};ob.prototype.X3a=function(){return this.F_?Object.assign(new Cb,
{bandwidthMps:this.F_.downlink,rttMs:this.F_.rtt,connectionType:this.F_.type,effectiveConnection:this.F_.effectiveType,downlinkMaxMps:this.F_.downlinkMax}):null};ob.prototype.$r=function(Ca,ua){if("QueryNetworkInformation"!==Ca)return!1;this.W4h(ua);return!0};ob.prototype.kn=function(){return this.wUc};ob.prototype.dispose=function(){this.wUc&&(this.statusBarManager&&(this.statusBarManager.RF(this),this.statusBarManager=null),this.F_&&this.F_.removeEventListener("change",this.ftf));this.$=null;Ye.prototype.dispose.call(this)};
ob.prototype.XWd=function(Ca){return Hd.HelperMethods.im(window.navigator,Ca)?window.navigator[Ca]:null};ob.prototype.W4h=function(Ca){Ca.Value="Network: "+this.F_.downlink.toString()+" Mbps, "+this.F_.rtt.toString()+" ms"};Object(kd.a)(ob,"NetworkInformationManager",Da.a,[185,186]);var Fd=b(184),ve=b(20);Object(kd.a)(Ta,"OperationStatisticsData",null,[]);var jg=b(71);Ka.prototype.isGroup=function(Ca,ua,sb){var Ld=new Fd.a;Ld.addRange(Ca);Ld.addRange(ua);for(var le=0;le<this.operationsGroups.count;le++)if(this.Fli(this.operationsGroups.oa(le),
Ld,sb))return ge.ULS.sendTraceTag(595194768,1,50,"OperationsGroupDetector: Operation '{0}' is part of a group ( operationsList: {1} , frameOperationsList: {2})",sb,this.fGf(Ca),this.fGf(ua)),!0;ge.ULS.sendTraceTag(595194767,1,50,"OperationsGroupDetector: Operation '{0}' is NOT part of a group.",sb);return!1};Ka.prototype.Fli=function(Ca,ua,sb){for(var Ld=0,le=0;le<ua.count;le++)if(ua.oa(le).isGroupBreaking){if(Ca.count<=Ld||!hf.a.equals(ua.oa(le).name,Ca.oa(Ld),!0))return!1;Ld++}return Ca.count>Ld&&
hf.a.equals(sb,Ca.oa(Ld),!0)};Ka.prototype.fGf=function(Ca){Ca=jg.select(Ca,function(ua){return ua.name});return String.format("[{0}]",jg.toArray(Ca).join(", "))};Ka.prototype.O$h=function(){this.operationsGroups=new Fd.a;var Ca;this.wYa((Ca=new Fd.a,Ca.add("Paste"),Ca.add("SelectingRange_unknown"),Ca));var ua;this.wYa((ua=new Fd.a,ua.add("AutoSum"),ua.add("SelectingRange_unknown"),ua));var sb;this.wYa((sb=new Fd.a,sb.add("ChangeSheetDirection"),sb.add("ActiveItemChanged"),sb));var Ld;this.wYa((Ld=
new Fd.a,Ld.add("InsertSheet"),Ld.add("ActiveItemChanged"),Ld.add("SelectingRange_unknown"),Ld));var le;this.wYa((le=new Fd.a,le.add("DeleteSheet"),le.add("DialogButtonClick"),le.add("ActiveItemChanged"),le.add("SelectingRange_unknown"),le));var nf;this.wYa((nf=new Fd.a,nf.add("EditBoxEndEdit"),nf.add("SetCell"),nf.add("SelectingRange_keyboard"),nf.add("MoveDownWithinSelectionOrCommitEdit"),nf))};Ka.prototype.wYa=function(Ca){this.operationsGroups.add(Ca)};Object(kd.a)(Ka,"OperationsGroupDetector",
null,[]);var Kf=b(30);ma.prototype.HHb=function(Ca,ua){var sb=Hd.HelperMethods.kc(),Ld=ee.EwaSettings.la(379)?this.operationsGroupDetector.isGroup(this.bD,this.tE,Ca):!1;this.Bgc=this.pgf(Ca);ee.EwaSettings.la(379)?this.Bgc&&0<this.bD.count&&!Ld&&(this.FTj(),this.geg(Ca,sb),this.iVe()):0<this.bD.count&&this.pgf(Ca)&&(this.geg(Ca,sb),this.iVe());this.F7a=-1;if(ve.g(this.$)&&ve.g(this.$).Ca){var le=!this.R0.contains(Ca);sb=new Ta(Ca,sb,void 0,void 0,void 0,le,this.Bgc,Ld);this.tE.add(sb);this.framePerformanceTracker&&
this.framePerformanceTracker.pGj(sb.name,ua);ee.EwaSettings.la(379)&&!this.OIb&&this.BHb.contains(Ca)&&(this.OIb=!0);-1===this.sWc&&(this.sWc=window.requestAnimationFrame(this.Wfj))}else ge.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")};ma.prototype.htc=function(){this.F7a=Hd.HelperMethods.kc()};ma.prototype.otc=function(){this.bD.count||this.tE.count?(this.KNb(this.tE,this.F7a),this.KNb(this.bD,this.F7a)):ge.ULS.sendTraceTag(0,1,50,"ReportOnBlockCacheConsistant when no operations in the list. Last block render time: {0}",
this.F7a);this.F7a=-1};ma.prototype.pgf=function(Ca){return!this.R_.contains(Ca)&&!Ca.includes("Menu")&&!Ca.includes("TellMe")};ma.prototype.iVe=function(){for(var Ca=0;Ca<this.bD.count;Ca++){var ua=this.bD.oa(Ca);this.zI.rzg(ua);this.Yvi(ua)}this.bD.clear()};ma.prototype.AUj=function(Ca){for(var ua=0;ua<this.tE.count;ua++)this.tE.oa(ua).startToNextFrame=this.cgd(this.tE.oa(ua).startTime,Ca),this.tE.oa(ua).wasHidden=Ab.a.kF(this.tE.oa(ua).startToNextFrame)};ma.prototype.geg=function(Ca,ua){for(var sb=
0;sb<this.bD.count;sb++)-1===this.bD.oa(sb).startToResponseRenderEnd&&(this.bD.oa(sb).operationThatLedToLogging=Ca,this.bD.oa(sb).startToOperationThatLedToLogging=this.cgd(this.bD.oa(sb).startTime,ua))};ma.prototype.FTj=function(){for(var Ca=!1,ua=yl(this.bD),sb=ua.next();!sb.done;sb=ua.next())if(sb.value.isPartOfGroup){Ca=!0;break}if(Ca)for(Ca=0;Ca<this.bD.count;Ca++)this.bD.oa(Ca).isPartOfGroup=this.bD.oa(Ca).isGroupBreaking};ma.prototype.KNb=function(Ca,ua){for(var sb=0;sb<Ca.count;sb++)Ca.oa(sb).startToResponseRenderEnd=
this.cgd(Ca.oa(sb).startTime,ua),Ca.oa(sb).wasHidden=Ab.a.kF(Ca.oa(sb).startToResponseRenderEnd)};ma.prototype.Yvi=function(Ca){ge.ULS.sendTraceTag(2020372336,1,50,"{0}",Ca)};ma.prototype.cgd=function(Ca,ua){return-1===Ca?-1:-1===ua?-2:ua-Ca};ma.prototype.qxi=function(Ca){Ca=Ca.getEntriesByType(pg.a.Pud);for(var ua=0;ua<Ca.length;ua++)if(30>this.qBb.count)if(this.tE.count)this.qBb.add(this.fZi(Ca[ua]));else{var sb=Ca[ua];if(null===sb||void 0===sb?0:sb.attribution)void 0!==sb.attribution.containerSrc&&
null!==sb.attribution.containerSrc&&(sb.attribution.containerSrc=""),void 0!==sb.attribution.containerId&&null!==sb.attribution.containerId&&(sb.attribution.containerId=""),void 0!==sb.attribution.containerName&&null!==sb.attribution.containerName&&(sb.attribution.containerName="");ge.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty. {0}",sb)}else{ge.ULS.sendTraceTag(537153874,1,50,"More then {0} long tasks are in the longTaskList. entries length: {1} First long task: {2}",
30,Ca.length,this.qBb.oa(0));break}};ma.prototype.fZi=function(Ca){return String.format("name:{0}, startTime:{1}, duration:{2}",Ca.name,Ca.startTime,Ca.duration)};ma.prototype.jai=function(){this.R0||(this.R0=new uc.a(If.a.Hk()),this.R0.add("ActiveItemChanged"),this.R0.add(Db.b().ui(-1398645260)),this.R0.add(Db.b().ui(722290388)),this.R0.add(Db.b().ui(974713501)),this.R0.add(Kf.a.aR(Kf.a.t2b)),this.R0.add(Kf.a.aR(Kf.a.s2b)),this.R0.add(Kf.a.aR(Kf.a.jqb)),this.R0.add(Kf.a.aR(Kf.a.ZKf)),this.R0.add(Kf.a.aR(Kf.a.dna)))};
ma.prototype.Q$h=function(){this.R_||(this.R_=new uc.a(If.a.Hk()),this.R_.add("PromptEditInBrowser"),this.R_.add(Db.b().ui(-1398645260)),this.R_.add(Db.b().ui(722290388)),this.R_.add(Db.b().ui(974713501)),this.R_.add(Kf.a.aR(Kf.a.t2b)),this.R_.add(Kf.a.aR(Kf.a.s2b)),this.R_.add(Kf.a.aR(Kf.a.jqb)),this.R_.add(Kf.a.aR(Kf.a.ZKf)),this.R_.add(Kf.a.aR(Kf.a.dna)))};ma.prototype.P$h=function(){this.BHb||(this.BHb=new uc.a(If.a.Hk()),this.BHb.add("SelectingRange_keyboard"),this.BHb.add("SelectingRange_mouse"))};
Object(kd.a)(ma,"OperationStatistics",null,[]);var td=b(598);Object(kd.a)(hc,"RequestError",null,[]);jb.U1g=function(Ca){if(!Ca)return[];var ua=[];Ca=yl(Ca);for(var sb=Ca.next();!sb.done;sb=Ca.next())sb=sb.value,ua.push(new hc(sb.MessageIdName,sb.ErrorCause));return ua};jb.zSh=function(Ca){return!jb.nEi.contains(Ca)};jb.LUh=function(){var Ca=new uc.a(If.a.Hk());Ca.add("CheckPersistedContentUpdate");Ca.add("GetContentBundle");Ca.add("GetSessionStatus");Ca.add("GetStatusBarAggregates");Ca.add("PollSessionStatus");
Ca.add("UpdatePresenceUsers");Ca.add("UploadLatencyTelemetry");return Ca};jb.vSh=function(Ca){return jb.xGh.contains(Ca)};jb.wSh=function(Ca){return jb.d3i.contains(Ca)};jb.eRh=function(){var Ca=new uc.a(If.a.Hk());Ca.add("SetRichTextCell");Ca.add("Copy");Ca.add("FormatCells");Ca.add("PasteRange");Ca.add("FindCell");Ca.add("ApplyToRangesV2");Ca.add("ResizeRowsColumns");Ca.add("InsertDeleteCells");Ca.add("FillRange");Ca.add("PasteHtmlContent");Ca.add("ApplyFilter");Ca.add("PasteString");Ca.add("Undo");
Ca.add("LineageUpdateView");Ca.add("FindAll");Ca.add("ApplyHyperlink");Ca.add("AutoFit");Ca.add("GetPrintSettings");Ca.add("GetEdgeCell");Ca.add("Paste");Ca.add("MoveAndResizeFloatingObject");Ca.add("FindRange");Ca.add("SetCustomFilter");Ca.add("RenameSheet");Ca.add("ApplyThreadedComment");Ca.add("SortFilterColumn");Ca.add("InsertCopiedCutCells");Ca.add("InsertSheet");Ca.add("ToggleAutoFilter");Ca.add("ReorderSheets");Ca.add("SetOutlineLevel");Ca.add("RefreshAll");Ca.add("LineageOpenPaneOrChangeFilter");
Ca.add("ApplySlicerSelection");Ca.add("GetCardViewCardByCell");Ca.add("AutoSum");Ca.add("LineageClosePane");Ca.add("Sort");Ca.add("ClearAutoFilter");Ca.add("DeleteSheet");Ca.add("Redo");ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(Ca.add("RemovePageBreak"),Ca.add("InsertPageBreak"),Ca.add("SetPrintArea"),Ca.add("ClearPrintArea"));return Ca};jb.xSh=function(){var Ca=new uc.a(If.a.Hk());Ca.add("DeleteConditionalFormattingRules");Ca.add("GetConditionalFormattingRules");
Ca.add("AddConditionalFormattingRule");Ca.add("QuickEditConditionalFormattingRule");Ca.add("GetPrintSettings");Ca.add("UpdatePresenceUsers");Ca.add("GetThemeInfo");ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(Ca.add("LineageOpenPaneOrChangeFilter"),Ca.add("LineageUpdateView"),Ca.add("LineageRefreshView"),Ca.add("LineageLoadMore"));ee.EwaSettings.isChangeGateEnabled("OfficeVSO:6069680_UTR_xlreq_InsertCopiedCutCellsPasteRange")&&(Ca.add("InsertCopiedCutCells"),Ca.add("PasteRange"));
return Ca};jb.nEi=jb.LUh();jb.xGh=jb.eRh();jb.d3i=jb.xSh();Object(kd.a)(jb,"RequestStatisticsData",null,[]);Ja.prototype.stc=function(Ca,ua,sb,Ld,le,nf,ug,Cf,Cg,Ag,eh,jh,Pg,te){jh=td.a(jh);Ca=new jb(Ca,ua,sb,Ld,le,nf,ug,Cf,Cg,jh,Ag,eh,Ab.a.kF(ua),this.Efd(null),Pg,this.Nla.X3a(),te);this.FKd(Ca)};Ja.prototype.Nh=function(Ca,ua){Ca="UnknownMethodName";var sb=-1;void 0!==ua.context&&null!==ua.context&&(Ca=ua.context.methodName,sb=ua.context.communicationErrorRetryCount);var Ld={EcsOperationDuration:-1,
EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};if(ua.ud){var le=ua.ud.Errors||[];this.zI.Nfj(ua.ud.EditSessionIsDirty);void 0!==ua.ud.RequestTelemetryData&&null!==ua.ud.RequestTelemetryData&&(Ld=ua.ud.RequestTelemetryData)}else le=[];var nf=ua.duration,ug=td.a(ua.url);ua=new jb(Ca,nf,ua.totalOperationDuration,ua.yVd,ua.iF,Ld,ua.SNd,le,ua.httpStatus,ug,sb,!0,Ab.a.kF(nf),this.Efd(ua.ud),ua.responseSize,this.Nla.X3a(),ua.responseToCallbackTime);this.FKd(ua)};
Ja.prototype.Mn=function(Ca,ua){Ca="UnknownMethodName";var sb=-1;void 0!==ua.context&&null!==ua.context&&(Ca=ua.context.methodName,sb=ua.context.communicationErrorRetryCount);var Ld=ua.duration,le=td.a(ua.url);ua=new jb(Ca,Ld,ua.totalOperationDuration,ua.yVd,ua.iF,{EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},ua.SNd,ua.errors||[],ua.httpStatus,le,sb,!1,Ab.a.kF(Ld),this.Efd(null),-1,this.Nla.X3a(),ua.responseToCallbackTime);this.FKd(ua)};
Ja.prototype.FKd=function(Ca){this.zI.QIg(Ca);if(ee.EwaSettings.la(231)){var ua=Ca.requestName;if(ua!==pg.a.wKa&&"SetCell"!==ua&&"FindRange"!==ua&&"FindAll"!==ua&&"FindCell"!==ua)return}ua=ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===Ca.requestName||null===Ca.requestName)&&Ca.isPromotedUTRRequest;Ja.wih(Ca,ua);this.zI.szg(Ca)};Ja.prototype.Efd=function(Ca){var ua;if(null===(ua=null===Ca||void 0===Ca?void 0:Ca.CollaborationResult)||void 0===ua?0:ua.Users)return Ca.CollaborationResult.Users.length;
Ca=this.$.ea.km.length;return 0<Ca?Ca:1};Ja.wih=function(Ca,ua){ua?Db.b().ivc(388829456,0,15,Ca):(ua=Sys.Serialization.JavaScriptSerializer.serialize(Ca),ge.ULS.sendTraceTag(388829456,0,50,ua));if(ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==Ca.requestName&&null!==Ca.requestName&&Ca.isFullyLoggedKPIRequest){ua=new Map;ua.set("isUserTriggeredRequest",Ca.isUserTriggeredRequest.toString());ua.set("requestDuration",Ca.requestDuration.toString());ua.set("totalOperationDuration",
Ca.totalOperationDuration.toString());ua.set("requestTimeInQueue",Ca.requestTimeInQueue.toString());ua.set("requestInvokedTime",Ca.requestInvokedTime.toString());ua.set("ecsOperationDuration",Ca.ecsOperationDuration.toString());ua.set("ecsRequestDuration",Ca.EcsRequestDuration.toString());ua.set("wfeRequestDuration",Ca.WfeRequestDuration.toString());ua.set("timeFromLastEcsFreeze",Ca.TimeFromLastEcsFreeze.toString());ua.set("duringLoadOnDemand",Ca.DuringLoadOnDemand.toString());ua.set("correlationID",
Ca.correlationID);ua.set("errors",Ca.errors.toString());ua.set("httpStatus",Ca.httpStatus.toString());if(Ca.networkInfoData){var sb=Ca.networkInfoData;ua.set("networkInfoData_bandwidthMps",void 0===sb.bandwidthMps||null===sb.bandwidthMps?"NA":sb.bandwidthMps.toString());ua.set("networkInfoData_rttMs",void 0===sb.rttMs||null===sb.rttMs?"NA":sb.rttMs.toString());ua.set("networkInfoData_effectiveConnection",void 0===sb.effectiveConnection||null===sb.effectiveConnection?"NA":sb.effectiveConnection)}Ca.requestResourceTiming&&
(sb=Ca.requestResourceTiming,ua.set("requestResourceTiming_fetchStart",void 0===sb.downloadDuration||null===sb.downloadDuration?"NA":sb.downloadDuration.toString()));ua.set("communicationErrorRetryCount",Ca.communicationErrorRetryCount.toString());ua.set("successfulCall",Ca.successfulCall.toString());ua.set("isDocumentHidden",Ca.isDocumentHidden.toString());ua.set("coauthorsCount",Ca.coauthorsCount.toString());ua.set("responseSize",Ca.responseSize.toString());ua.set("responseToCallbackTime",Ca.responseToCallbackTime.toString());
Db.b().ptc(Ca.requestName,Ca.successfulCall,ua)}};Object(kd.a)(Ja,"RequestStatistics",null,[]);var qf=b(198),Ch=b(81),Uf=b(305);Object(kd.a)(db,"OperationTypeStatisticsData",null,[]);Na.prototype.ee=function(Ca){this.data.totalCount<Na.I7c&&(Array.add(this.L6f,Ca.startToNextFrame),Array.add(this.M6f,Ca.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<Ca.startToNextFrame&&(this.data.longestStartToNextFrame=Ca.startToNextFrame);this.data.longestStartToResponse<Ca.startToResponseRenderEnd&&
(this.data.longestStartToResponse=Ca.startToResponseRenderEnd)};Na.prototype.Uad=function(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=this.d2e(this.L6f),this.data.startToResponsePercentiles=this.d2e(this.M6f))};Na.prototype.d2e=function(Ca){Ca.sort(Hd.HelperMethods.WC);var ua="("+Ab.a.jva(Ca,25).toString();ua=ua+", "+Ab.a.jva(Ca,50).toString();ua=ua+", "+Ab.a.jva(Ca,75).toString();ua=ua+", "+Ab.a.jva(Ca,95).toString();return ua+")"};Na.I7c=1E3;Object(kd.a)(Na,"OperationTypeStatistics",
null,[]);Object(kd.a)(Xa,"RequestTypeStatisticsData",null,[]);Ha.prototype.tgj=function(Ca){this.data.totalCount<Ha.I7c&&Array.add(this.tbb,Ca.requestDuration);this.data.totalCount++;this.qWd+=Ca.requestDuration;this.lWd+=Ha.pdd(Ca.ecsOperationDuration);this.kWd+=Ha.pdd(Ca.EcsRequestDuration);this.tWd+=Ha.pdd(Ca.WfeRequestDuration);0<Ca.TimeFromLastEcsFreeze&&Ca.TimeFromLastEcsFreeze<Ha.nGh&&this.data.callsDuringEcsFreeze++;Ca.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;
Ca.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<Ca.requestDuration)this.data.longestRequest=Ca};Ha.prototype.Uad=function(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.qWd/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.lWd/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.kWd/
this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.tWd/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=0,this.data.averageWfeDuration=0),this.tbb.sort(Hd.HelperMethods.WC),this.data.requestDurationPercentile25=Ab.a.jva(this.tbb,25),this.data.requestDurationPercentile50=Ab.a.jva(this.tbb,50),this.data.requestDurationPercentile75=Ab.a.jva(this.tbb,75),this.data.requestDurationPercentile95=Ab.a.jva(this.tbb,95))};Ha.pdd=function(Ca){return 0>
Ca?0:Ca};Ha.nGh=3E3;Ha.I7c=1E3;Object(kd.a)(Ha,"RequestTypeStatistics",null,[]);Object(kd.a)(Pa,"SessionStatisticsData",null,[]);pa.prototype.od=function(){var Ca=this.pah();Gd.a.Lda()?this.$.rna(qf.a.iZj,{xlendJson:Ca},!1):Ch.qb(this.$.na.ta,Ca,null,null,null,null,null);Ca=this.qah();Gd.a.Lda()?this.$.rna(qf.a.jZj,{xlenoJson:Ca},!1):ge.ULS.sendTraceTag(388776782,0,50,Ca);ee.EwaSettings.la(70)&&(Ca=this.P5g(),Gd.a.Lda()?this.$.rna(qf.a.hZj,{xlencJson:Ca},!1):ge.ULS.sendTraceTag(388776770,0,50,Ca));
this.Zgj()};pa.prototype.kic=function(){this.everConnectedToOcs=this.$.ea.n7a||this.everConnectedToOcs;hd.Health.instance&&hd.Health.instance.addOrUpdatePartCDimension("IsOcsSession",this.everConnectedToOcs.toString())};pa.prototype.Wg=function(){var Ca=new Uf.a,ua="",sb=!this.$.isAnonymousUser(),Ld=Ca.rg();if(Ld){if(sb){Ca.bwc("UMI_Linkable","true");return}ua=Ca.S3a("UMI_Linkable")}sb||ge.ULS.sendTraceTag(537153870,0,50,"SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:{0}, UMIIsLinkable:{1}",
Ld,!!ua)};pa.prototype.pbb=function(){this.iTd=!0};pa.prototype.Nfj=function(Ca){this.dirtySessionOnLastRecordedRequest=Ca};pa.prototype.QIg=function(Ca){this.maxCoauthorsCount=Math.max(this.maxCoauthorsCount,Ca.coauthorsCount);hd.Health.instance&&hd.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())};pa.prototype.szg=function(Ca){if(!(Ca.requestName in this.wmb)){var ua=new Ha(Ca.requestName);this.wmb[Ca.requestName]=ua}this.wmb[Ca.requestName].tgj(Ca)};
pa.prototype.rzg=function(Ca){if(!(Ca.name in this.vmb)){var ua=new Na(Ca.name,Ca.isUserOperation);this.vmb[Ca.name]=ua}this.vmb[Ca.name].ee(Ca)};pa.prototype.H9=function(Ca){this.v5c[Ca.reportName]=Ca};pa.prototype.Zgj=function(){this.dirtySessionOnLastRecordedRequest=this.iTd=!1;this.Ulf=this.$.ea.Ltd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.wmb={};this.vmb={};this.v5c={}};pa.prototype.pah=function(){var Ca=new Pa(this.$.isEditMode?"edit":"view",this.$.ea.ocsCapable,this.iTd,this.dirtySessionOnLastRecordedRequest,
this.$.ea.Ltd-this.Ulf,this.maxCoauthorsCount,this.everConnectedToOcs,this.wmb);return Sys.Serialization.JavaScriptSerializer.serialize(Ca)};pa.prototype.qah=function(){var Ca=new Fd.a,ua=this.vmb,sb;for(sb in ua){var Ld=ua[sb];Ld.Uad();Ca.add(Ld.data)}Ca=Ca.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(Ca)};pa.prototype.P5g=function(){return Sys.Serialization.JavaScriptSerializer.serialize(this.v5c)};Object(kd.a)(pa,"SessionStatistics",null,[]);var Rg=Pd.a;vm(qa,Rg);qa.prototype.dispose=
function(){this.$&&ee.EwaSettings.la(41)&&(this.$.sn(this.od),this.$.na.yr(this.Nh),this.$.na.Ez(this.Mn),this.$.ea.VQf(this.kic),ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&this.$.ea.Lq(this.Wg));wf.a.Fa(this.Nla);wf.a.Fa(this.f8a);this.RMc=null;wf.a.Fa(this.wN);this.wN=null;wf.a.Fa(this.Tud);this.$=this.Tud=null;Rg.prototype.dispose.call(this)};qa.prototype.pbb=function(){ee.EwaSettings.la(41)&&this.zI.pbb()};qa.prototype.stc=function(Ca,ua,sb,Ld,le,nf,ug,Cf,Cg,Ag,eh,
jh,Pg,te){ee.EwaSettings.la(41)&&(this.Yma=this.Yma||new Ja(this.$,this.zI,this.Nla),this.Yma.stc(Ca,ua,sb,Ld,le,nf,ug,Cf,Cg,Ag,eh,jh,Pg,te))};qa.prototype.HHb=function(Ca,ua){ee.EwaSettings.la(41)&&(this.qma=this.qma||new ma(this.$,this.zI,this,this.wN),this.qma.HHb(Ca,ua))};qa.prototype.htc=function(){ee.EwaSettings.la(41)&&(this.qma=this.qma||new ma(this.$,this.zI,this,this.wN),this.qma.htc())};qa.prototype.otc=function(){ee.EwaSettings.la(41)&&(this.qma=this.qma||new ma(this.$,this.zI,this,this.wN),
this.qma.otc())};qa.prototype.H9=function(Ca){ee.EwaSettings.la(41)&&this.zI.H9(Ca)};qa.prototype.ked=function(Ca){return ee.EwaSettings.la(41)?this.lGe[Ca]:null};qa.prototype.AZf=function(Ca){Ca&&(this.lGe[Ca.type]=Ca)};qa.prototype.X3a=function(){return this.Nla.X3a()};qa.prototype.H7g=function(){Ec.a.ep&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.RMc=new ya(this.$,this.wN))};Sk.Object.defineProperties(qa.prototype,{f8a:{configurable:!0,enumerable:!0,get:function(){return this.RMc}}});
Object(kd.a)(qa,"SessionStatisticsManager",Pd.a,[303]);var Od=b(101),gh=b(1210),fi=b(113),hh=b(122);ea.prototype.ELj=function(){return Bf.a.Kc(this)};Object(kd.a)(ea,"AppUnloadInfo",null,[]);var ye=b(816),Dg=b(120),Jf=b(583);ja.prototype.ATg=function(Ca){var ua=new ye.a(Jf.a.iK()),sb=0,Ld=0;Ca=yl(Ca);for(var le=Ca.next();!le.done;le=Ca.next()){le=le.value;ua.xb(le)||ua.ia(le,0);var nf=ua.ia(le,ua.oa(le)+1);nf>sb&&(sb=nf,Ld=le)}sb>this.mostCommonOperationCount&&(this.mostCommonOperationName=Dg.a(Ld),
this.mostCommonOperationCount=sb)};Object(kd.a)(ja,"DataLossInfo",null,[]);var Ne=b(55);ca.prototype.dispose=function(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.yej(this.mFf);this.wf&&(this.wf.Pza(this.yca),this.wf=null);this.pk.IA();this.$=this.pk=null};ca.prototype.ceg=function(){this.Tuj();this.Ubb()};ca.prototype.Tuj=function(){this.Ly.wasOfflineDuringUnload=this.$.sf.QV;this.Ly.timeFromLastConnectivity=fi.a(Df.a.Ra,this.$.sf.Pkf);this.Ly.timeFromLastDisconnectionStart=
fi.a(Df.a.Ra,this.$.sf.jri);this.Ly.disconnectionSource=Enum.toString(gh.a,this.$.sf.disconnectionSource);this.uSf&&(this.Ly.hadConnectivityIssuesDuringUnload=this.$.sf.Hka,this.Ly.timeFromLastStatusCode0=fi.a(Df.a.Ra,this.$.sf.Okf))};ca.prototype.Ubb=function(){this.Ly.timestamp=Date.now();this.localStorage.bwc(this.yWc,this.Ly.ELj())};ca.prototype.bYf=function(){var Ca=this.localStorage.S3a(this.yWc);if(Ca)try{var ua=Bf.a.pi(Ca);this.localStorage.HId(this.yWc);var sb=this.Dyi(ua);ge.ULS.sendTraceTag(574677456,
0,50,sb)}catch(Ld){ge.ULS.sendTraceTag(537151056,0,15,"AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: {0}",Ld.message)}else ge.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")};ca.prototype.Dyi=function(Ca){var ua={};ua.WACSessionID=Ca.wacSessionId;ua.wasRefreshed=this.pXg(Ca,this.$.ya.MaxAppReloadDurationIndicatingRefresh);ua.closedWithDialogConfirmation=Ca.dialogPromptedOnUnload;ua.wasOfflineDuringUnload=
Ca.wasOfflineDuringUnload;ua.TimeFromLastConnectivityMs=Ca.timeFromLastConnectivity;ua.TimeFromLastDisconnectionStart=Ca.timeFromLastDisconnectionStart;ua.wasDataLostDuringUnload=Ca.wasDataLostDuringUnload;ua.DataLossInfo=Ca.dataLossInfo;ua.flushedOnUnload=Ca.wasUpdatedOnUnload;ua.flushedOnBeforeUnload=Ca.wasUpdatedOnBeforeUnload;ua.InactivityDurationBeforeUnload=Ca.inactivityDurationBeforeUnloadSeconds;ua.DisconnectionSource=Ca.disconnectionSource;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&
(ua.ApiBeforeCloseNotificationEnabledOnUnload=Ca.apiBeforeCloseNotificationEnabledOnUnload);this.uSf&&(ua.hadConnectivityIssuesDuringUnload=Ca.hadConnectivityIssuesDuringUnload,ua.TimeFromLastStatusCode0=Ca.timeFromLastStatusCode0);ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5470513_trackSilentReopenUnloads")&&(ua.LastSilentReopenStartTime=Ca.lastSilentReopenStartTime,ua.LastSilentReopenEndTime=Ca.lastSilentReopenEndTime);return Vd.c(ua)};ca.prototype.pXg=function(Ca,ua){var sb=window.performance.timing.navigationStart-
Ca.timestamp;(Ca=this.workbookHashedId===Ca.workbookHashedId&&sb<ua)&&ge.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return Ca};ca.ja=function(Ca){Ca.ea.nc.inWebPart||Ca.da.Ha(410,new ca(Ca))};Sk.Object.defineProperties(ca.prototype,{dialogPromptedOnUnload:{configurable:!0,enumerable:!0,get:function(){return this.k5d},set:function(Ca){this.k5d=Ca;this.Ly?(this.Ly.dialogPromptedOnUnload=Ca,this.Ubb()):this.localStorage.rg()&&ge.ULS.sendTraceTag(537151058,
0,10,"AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: {0}",this.localStorage.rg())}},apiBeforeCloseNotificationEnabledOnUnload:{configurable:!0,enumerable:!0,get:function(){return this.H1d},set:function(Ca){this.H1d=Ca;this.Ly?(this.Ly.apiBeforeCloseNotificationEnabledOnUnload=Ca,this.Ubb()):this.localStorage.rg()&&ge.ULS.sendTraceTag(537151057,0,10,"AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: {0}",
this.localStorage.rg())}}});ca.dAi=10;Object(kd.a)(ca,"AppUnloadTelemetryManager",null,[351,3]);var gi=b(178),kh=b(106);X.prototype.e7f=function(){ge.ULS.shipAssertTag(537151050,1,!this.stopped,"ChainedCallsTracer.CallMeasureContext.StopMeasuring: Calling stop after object was already stopped.");this.stopped||(this.stopped=!0,this.chainedCallsTracer.fHj(this))};X.prototype.dispose=function(){this.e7f()};Sk.Object.defineProperties(X.prototype,{call:{configurable:!0,enumerable:!0,get:function(){return this.kmg}}});
Object(kd.a)(X,"CallMeasureContext",null,[364,3]);fa.prototype.G2g=function(){this.WRe=Hd.HelperMethods.kc()};fa.prototype.b7f=function(){this.G$c+=Hd.HelperMethods.kc()-this.WRe};fa.prototype.eSh=function(){return Hd.HelperMethods.kc()-this.startTime};fa.prototype.ZGj=function(){this.b7f();return this.G$c};Sk.Object.defineProperties(fa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},type:{configurable:!0,enumerable:!0,get:function(){return this.VB}}});Object(kd.a)(fa,
"MeasuredCall",null,[]);da.prototype.A6f=function(Ca,ua){this.b8g();this.bHj();Ca=new fa(Ca,ua);this.zsa.push(Ca);return new X(this,Ca)};da.prototype.b8g=function(){0<this.zsa.length?ge.ULS.shipAssertTag(537151054,1,!!this.I_c,"ChainedCallsTracer.CreateNewChainIdIfNeeded: callsChain has items but chainId is null or empty."):this.I_c=gi.a.create().toString()};da.prototype.fHj=function(Ca){var ua=this.zsa.pop();if(Ca.call!==ua)ge.ULS.sendTraceTag(537151053,0,10,"ChainedCallsTracer.StopMeasuringCall: Popped call is not the same as the topmost call in the chain. Popped call ID: {0} Topmost in the chain: {1}",
Ca.call.name,ua?ua.name:"null"),this.zsa=[];else{Ca=ua.eSh();var sb=ua.ZGj();ge.ULS.shipAssertTag(537151052,1,!!this.documentVisibilityObserver,"ChainedCallsTracer.IsInProximityToDocumentHidden: documentVisibilityObserver is null");var Ld=this.documentVisibilityObserver?this.documentVisibilityObserver.kF(Ca+this.fBi):null;this.fvi(ua,Ca,sb,Ld);this.H2g()}};da.prototype.bHj=function(){var Ca=this.y0e();Ca&&Ca.b7f()};da.prototype.H2g=function(){var Ca=this.y0e();Ca&&Ca.G2g()};da.prototype.y0e=function(){return this.zsa.length?
this.zsa[this.zsa.length-1]:null};da.prototype.fvi=function(Ca,ua,sb,Ld){if(!(ua<this.eBi)){var le=kh.f(this.zsa,function(nf){return nf.name}).join();ge.ULS.sendTraceTag(537151051,0,50,"ChainedCallsTracer: Inclusive duration: {0} Exclusive duration: {1} Chain ID: {2} Call ID: {3} Type: {4} Document hidden: {5} Call chain: {6}",ua.toFixed(2),sb.toFixed(2),this.I_c,Ca.name,Ca.type,Ld,le)}};da.ja=function(Ca){if(ee.EwaSettings.la(711)){var ua=new da(Ca.ya.ChainedCallsTracerMinThresholdToLogInMs);Ca.da.Za(291,
function(sb){ua.documentVisibilityObserver=sb});Ca.da.Ha(425,ua);Da.a.lqj(ua)}};Object(kd.a)(da,"ChainedCallsTracer",null,[350]);var Vf=b(525);K.prototype.KMj=function(Ca){var ua={};ua=(ua.TaskName=Ca.TN,ua.TotalRunInMs=Ca.TRT,ua.TotalDelayInMs=Ca.TDT,ua.TotalQueueInMs=Ca.TQT,ua.TaskPriority=Ca.TP,ua.CoauthorsCount=this.ea.km.length,ua);Ca.TDT>this.FVd||Ca.TRT>this.DVd?ge.ULS.sendTraceTag(321938518,0,15,Bd.a.toJSON(ua)):(Ca.TDT>this.EVd||Ca.TRT>this.CVd)&&ge.ULS.sendTraceTag(321938508,0,50,Bd.a.toJSON(ua))};
K.prototype.ZBh=function(Ca){return this.Fe.kF(Ca.TRT+Ca.TQT+3E3)?!1:Ca.TDT>Math.min(this.EVd,this.FVd)||Ca.TRT>Math.min(this.CVd,this.DVd)};Object(kd.a)(K,"TaskEventProcessor",null,[]);var ti=b(14);H.prototype.dispose=function(){this.$=null};H.prototype.skj=function(){this.dHe||this.ITg();var Ca=ve.c(ve.g(this.$));if(!this.bHe){var ua=ti.a.instance.Va(279).split(",");Array.addRange(Ca,ua);this.bHe=!0}Ca=yl(Ca);for(ua=Ca.next();!ua.done;ua=Ca.next())(ua=ua.value)&&!this.u9f.has(ua)&&(this.pvi(ua),
this.u9f.add(ua))};H.prototype.pvi=function(Ca){this.FUg(Ca)};H.prototype.ITg=function(){this.dHe=H.L3a("monospace");H.L3a("sans-serif");H.L3a("serif")};H.prototype.FUg=function(Ca){H.L3a(String.format("{0},{1}",Ca,"monospace"));H.L3a(String.format("{0},{1}",Ca,"sans-serif"));H.L3a(String.format("{0},{1}",Ca,"serif"))};H.ja=function(Ca){if(ee.EwaSettings.la(63)){var ua=new H(Ca);Ca.da.Ha(210,ua)}};H.L3a=function(Ca){var ua=document.createElement("div"),sb=document.createElement("div");ua.style.cssText=
"position: absolute; overflow: auto; visibility: hidden;";H.Duj(sb,Ca);document.body.appendChild(ua);ua.appendChild(sb);sb.innerHTML="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";Ca=sb.offsetWidth+"x"+sb.offsetHeight;document.body.removeChild(sb.parentNode);return Ca};H.Duj=function(Ca,ua){Ca.style.cssText="display: inline; visibility: hidden;";Ca.style.fontSize="100px";Ca.style.fontWeight="normal";Ca.style.fontStyle="normal";Ca.style.letterSpacing="normal";Ca.style.lineHeight=
"normal";Ca.style.whiteSpace="nowrap";Ca.style.fontFamily=ua};Object(kd.a)(H,"FontTelemetryManager",null,[3]);var Kh=b(227),Jh=b(153),nh;(function(Ca){Ca[Ca.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";Ca[Ca.reactSingleLineRibbon=1]="reactSingleLineRibbon";Ca[Ca.reactMultiLineRibbon=2]="reactMultiLineRibbon";Ca[Ca.invalid=3]="invalid"})(nh||(nh={}));Object(kd.b)("RibbonMode",nh);var ih=b(103),dh=Da.a;vm(T,dh);T.prototype.DFa=function(Ca){this.addHandler("ekdh",Ca)};T.prototype.Zab=function(Ca){this.removeHandler("ekdh",
Ca)};T.prototype.nnb=function(Ca){this.addHandler("ekduh",Ca)};T.prototype.fHb=function(Ca){this.removeHandler("ekduh",Ca)};T.prototype.kF=function(Ca){return this.Di?!0:this.Pic?gf.getElapsedMilliseconds(this.Pic,Df.a.Ra.Kb)<Ca:!1};T.prototype.jFh=function(){this.mYd()};T.prototype.dispose=function(){wf.a.Fa(this.hZ);wf.a.Fa(this.pk);dh.prototype.dispose.call(this)};T.prototype.mYd=function(){this.eM="hidden"===window.document.visibilityState;this.Di?(this.raiseEvent("ekdh"),this.K$d=Df.a.Ra.Kb):
(this.raiseEvent("ekduh"),this.L$d=Df.a.Ra.Kb)};Sk.Object.defineProperties(T.prototype,{Di:{configurable:!0,enumerable:!0,get:function(){return this.eM}},ekf:{configurable:!0,enumerable:!0,get:function(){return this.K$d}},Pic:{configurable:!0,enumerable:!0,get:function(){return this.L$d}}});Object(kd.a)(T,"DocumentVisibilityObserver",Da.a,[362,3]);Object(kd.a)(ba,"FramePerformanceData",null,[]);Object(kd.a)(la,"FramePerformanceDataGroup",null,[]);Sk.Object.defineProperties(Q.prototype,{reportName:{configurable:!0,
enumerable:!0,get:function(){return this._reportName}}});Object(kd.a)(Q,"FramePerformanceSessionEndsReport",null,[285]);U.prototype.r8g=function(){this.fha=new la("AllGridOperationsData");this.lf.operationsGroups.push(this.fha);this.$qb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.$qb("DragScroll",["DragScroll"]);this.$qb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.$qb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.$qb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])};U.prototype.mgj=function(Ca,ua,sb,Ld){var le=this.aRh(Ca);le&&(kh.b(this.lf.operationsGroups,function(nf){return hf.a.equals(nf.name,le.name,!1)})||this.lf.operationsGroups.push(le),le.count++,this.FBc(ua,
le),this.BBc(sb,le),this.fha.count++,this.FBc(ua,this.fha),this.BBc(sb,this.fha),0<Ld&&this.nTj(Ld,le),0<=ua&&this.JSj(ua,le))};U.prototype.OTj=function(){for(var Ca=yl(this.lf.operationsGroups),ua=Ca.next();!ua.done;ua=Ca.next())U.PSj(ua.value)};U.prototype.$qb=function(Ca,ua){Ca=new la(Ca);ua=yl(ua);for(var sb=ua.next();!sb.done;sb=ua.next())this.uCd[sb.value]=Ca};U.prototype.aRh=function(Ca){return Ca in this.uCd?this.uCd[Ca]:null};U.prototype.JSj=function(Ca,ua){30>Ca&&this.PXd(function(sb){sb.l1FramePerformanceData.fpsUnderThresholdOps++},
ua);15>Ca&&this.PXd(function(sb){sb.l2FramePerformanceData.fpsUnderThresholdOps++},ua);5>Ca&&this.PXd(function(sb){sb.l3FramePerformanceData.fpsUnderThresholdOps++},ua)};U.prototype.nTj=function(Ca,ua){100<=Ca&&(this.$eb(ua.l1FramePerformanceData,Ca,this.Zeb),this.$eb(this.fha.l1FramePerformanceData,Ca,this.Zeb));300<=Ca&&(this.$eb(ua.l2FramePerformanceData,Ca,this.Zeb),this.$eb(this.fha.l2FramePerformanceData,Ca,this.Zeb));600<=Ca&&(this.$eb(ua.l3FramePerformanceData,Ca,this.Zeb),this.$eb(this.fha.l3FramePerformanceData,
Ca,this.Zeb))};U.prototype.PXd=function(Ca,ua){ua&&(Ca(ua),Ca(this.fha))};U.prototype.$eb=function(Ca,ua,sb){Ca&&sb(Ca,ua)};U.prototype.FBc=function(Ca,ua){ua.minFPS=-1===ua.minFPS?Ca:Math.min(ua.minFPS,Ca)};U.prototype.BBc=function(Ca,ua){ua.maxFPS=Math.max(ua.maxFPS,Ca)};U.PSj=function(Ca){U.qYd(Ca.l1FramePerformanceData,Ca.count);U.qYd(Ca.l2FramePerformanceData,Ca.count);U.qYd(Ca.l3FramePerformanceData,Ca.count)};U.qYd=function(Ca,ua){Ca.fpsUnderThresholdOpsPercentage=100*Ca.fpsUnderThresholdOps/
ua;Ca.longFramesOverThresholdOpsPercentage=100*Ca.longFramesOverThresholdOps/ua};Object(kd.a)(U,"FramePerformanceSessionEndsReportManager",null,[]);Object(kd.a)(V,"FpsDataWrapper",null,[]);Object(kd.a)(D,"LongFrameData",null,[]);var Qh=b(340);Object(kd.a)(v,"OperationFPSData",null,[]);var xh=b(34),Xg=b(276),Lg=b(925),hi=Pd.a;vm(J,hi);J.prototype.start=function(){this.DLd=!0;this.resume()};J.prototype.stop=function(){this.DLd=!1;this.pause()};J.prototype.dispose=function(){this.stop();this.Fe.Zab(this.mW);
of.AFrameworkApplication.qQf(this.Kuf);of.AFrameworkApplication.rQf(this.Muf);wf.a.Fa(this.Fe);this.Ca.Kq(this.Jg);hi.prototype.dispose.call(this)};J.prototype.pGj=function(Ca,ua){var sb=Ca in this.tia?this.tia[Ca]:null;this.DAb=new Date;this.start();var Ld=this.DAb.getSeconds(),le=Ld+this.qKj;sb&&Ld<=sb.end?(sb.count++,sb.end=le):(sb&&Ld>sb.end&&this.gua.add(sb),this.tia[Ca]=new v(Ca,1,Ld,le,void 0,void 0,void 0,this.$.ea.km.length,yd.PageLoadTrackingInfo.instance.Pja(this.DAb),ua))};J.prototype.M6g=
function(){this.$2a||(this.zbd(new Date),this.$2a=new U(this.$))};J.prototype.resume=function(){this.mef()||!this.Ca.XF||this.isSynthetic||(this.L7a=this.Fe.Di,this.yxa=new Date,this.Bsd=this.yxa.getMinutes(),this.ZKd(),this.zIe(this.yxa.getSeconds()),this.Nnb=window.requestAnimationFrame(this.dWe))};J.prototype.mef=function(){return 0<=this.Nnb};J.prototype.pause=function(){this.mef()&&(this.L7a||(this.AIe((new Date).getSeconds()),ge.ULS.sendTraceTag(21280654,0,50,"FPS : {0}",this.GY.toString())),
window.cancelAnimationFrame(this.Nnb),this.Nnb=-1)};J.prototype.zbd=function(Ca){if(Ca.getTime()-this.yxa.getTime()<J.cBi&&(this.L7a&&this.AIe(this.yxa.getSeconds()),this.blh(),0<this.gua.count&&(Ca={},Ca.NonEmptyCellsCount=this.W8a,Ca.TextCellsCount=this.Jzc,Ca.xlfpsJson=Object.assign(new V,{f:this.gua.toArray()}),Ca.memoryInfo=this.pAi(),Ca.zoom=xh.a(this.$)?xh.a(this.$).zoom:1,Ca.HtmlOverlayDomCount=this.oLa,Ca.RibbonMode=Jh.a(this.$)?nh[Jh.a(this.$).aX]:J.invalid,Ca.deviceMemory=navigator.deviceMemory||
0,Ca.hardwareConcurrency=navigator.hardwareConcurrency||0,Ca=JSON.stringify(Ca),ge.ULS.sendTraceTag(537151044,0,50,"FPS : {0}",this.GY.toString()),!this.isSynthetic))){Gd.a.Lda()?this.$.rna(qf.a.kZj,{xlfpsJson:Ca},!1):ge.ULS.sendTraceTag(388781010,0,50,"{0}",Ca);if(this.Nvi)for(var ua=yl(this.gua),sb=ua.next();!sb.done;sb=ua.next()){sb=sb.value;var Ld=1E3>=this.W8a?"0_1000":3E3>=this.W8a?"1000_3000":"3000_inf",le=new Map;le.set("Operation",sb.Op);le.set("BucketOfRenderedCells",Ld);hd.Health.instance.recordKpiUsage(Fe.a.longFrame,
0,Ff.a.canvas,le);0<sb.longFrameCount&&hd.Health.instance.recordKpiFailure(Fe.a.longFrame,"LongFrame",!1,!0,Object.assign(new Xg.a,{extendedProperties:le}));3E4<sb.tfAppInt&&(0<sb.longFrameCount?Db.b().JSf(0,this.oxi,le):Db.b().KSf(0,le))}ge.ULS.sendTraceTag(537151043,0,50,"Operations message length: {0}",Ca.length)}this.reset()};J.prototype.pAi=function(){var Ca={};if(window.performance){var ua=window.performance.memory;ua&&(Ca.jsHeapSizeLimit=ua.jsHeapSizeLimit,Ca.usedJSHeapSize=ua.usedJSHeapSize,
Ca.totalJSHeapSize=ua.totalJSHeapSize)}return Ca};J.prototype.reset=function(){this.gua.clear();this.tia={};this.ZKd()};J.prototype.blh=function(){var Ca=!0;Ca=void 0===Ca?!0:Ca;if(this.GY){for(var ua=yl(Lg.a(this.tia)),sb=ua.next();!sb.done;sb=ua.next())sb=this.tia[sb.value],sb.end=Math.min(this.GY.length-1,sb.end),this.gua.add(sb);this.UTg(this.gua,this.GY,Ca)}};J.prototype.UTg=function(Ca,ua,sb){sb=void 0===sb?!0:sb;Ca=yl(Ca);for(var Ld=Ca.next();!Ld.done;Ld=Ca.next()){Ld=Ld.value;var le=0,nf=
0;if(Ld.end<ua.length){for(var ug=Ld.start;ug<=Ld.end;ug++){var Cf=ua[ug];0<=Cf&&(Ld.Max=Math.round(Math.max(Ld.Max,Cf)),Ld.Min=Math.round(Math.min(Ld.Min,Cf)),le+=Cf,nf++)}0<nf&&(Ld.Avg=Math.round(le/nf));sb&&this.$2a&&this.$2a.mgj(Ld.Op,Ld.Min,Ld.Max,Ld.LFrame?Ld.LFrame.duration:-1);Ld.Props&&(this.IOj(Ld),Ld.Props=null)}}sb&&this.$2a&&this.$2a.OTj()};J.prototype.ZKd=function(){this.GY=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0]};J.prototype.zIe=function(Ca){Ca++;for(var ua=0;ua<Ca;ua++)this.GY[ua]=J.h6b};J.prototype.AIe=function(Ca){for(;60>Ca;Ca++)this.GY[Ca]=J.h6b};J.prototype.Mvi=function(Ca,ua){Ca=Ca.getSeconds();var sb=Lg.a(this.tia);if(0<sb.length){sb=yl(sb);for(var Ld=sb.next();!Ld.done;Ld=sb.next())if(Ld=this.tia[Ld.value],Ca>=Ld.start&&Ca<Ld.end)Ld.LFrame?Ld.LFrame.duration<ua&&(Ld.LFrame.startSecond=Ca,Ld.LFrame.duration=ua,Ld.longFrameCount++):(Ld.LFrame=new D(Ca,ua),Ld.longFrameCount++)}};J.prototype.vTj=
function(){this.oLa=this.Jzc=this.W8a=0;for(var Ca=yl(ve.g(this.$).nn),ua=Ca.next();!ua.done;ua=Ca.next()){ua=ua.value.QBa;for(var sb in ua){var Ld=this.Ca.Vk(ua[sb].hashCode);if(null===Ld||void 0===Ld?0:Ld.ik)this.W8a+=Ld.se.NonEmptyCellsCount,this.Jzc+=Ld.se.TextValueCellsCount,this.oLa+=Ld.oLa}}};J.prototype.IOj=function(Ca){var ua=Ca.Props;if(La.a.AKb in ua&&ua[La.a.AKb]&&La.a.pMb in ua){var sb;(sb=Object(vc.a)(Kh.a,ua[La.a.pMb]))&&sb.continueWith(function(Ld){ih.TextEditorTelemetry.instance.DBg(Ca.Op,
Ca.Min,!!Ca.LFrame,Ca.LFrame?Ca.LFrame.duration:0,Ld.result)})}};J.h6b=-1;J.cBi=6E4;J.invalid="Invalid";Object(kd.a)(J,"FramePerformanceTracker",Pd.a,[361,3]);var Lh=Lf.a;vm(r,Lh);r.prototype.create=function(){var Ca=this.$.da.Aa(263);Ca||(Ca=this.$.da.Ha(263,new J(this.$)));this.Fb(Ca)};r.ja=function(Ca){Ca.da.Ha(264,new r(Ca))};Object(kd.a)(r,"FramePerformanceTrackerFactory",Lf.a,[]);var Kg=b(1263),ai=b(1068);C.prototype.Wh=function(Ca,ua){return new ai.a(Ca,ua)};C.prototype.Hc=function(Ca,ua){Ca=
this.Wh(Ca,ua);Ca.start();return Ca};Object(kd.a)(C,"DefaultStopwatchBuilder",null,[168]);u.prototype.Wh=function(Ca,ua){return this.Xpa.Wh(Ca,ua)};u.prototype.Hc=function(Ca,ua){return this.Xpa.Hc(Ca,ua)};Object(kd.a)(u,"StopwatchBuilder",null,[168]);var Fh=b(411),Sg=b(927),zg=b(1054),wh;(function(Ca){Ca[Ca.actions=0]="actions";Ca[Ca.correlationStart=1]="correlationStart";Ca[Ca.reorderSheetOp=2]="reorderSheetOp";Ca[Ca.formatCellOp=3]="formatCellOp";Ca[Ca.copyOp=4]="copyOp";Ca[Ca.pasteOp=5]="pasteOp";
Ca[Ca.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";Ca[Ca.instantaneousSetData=7]="instantaneousSetData";Ca[Ca.immediateSetData=8]="immediateSetData";Ca[Ca.dependentCellsCalc=9]="dependentCellsCalc";Ca[Ca.dependentCellsGraphStat=10]="dependentCellsGraphStat";Ca[Ca.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";Ca[Ca.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";Ca[Ca.gridBlockUpdates=13]="gridBlockUpdates";Ca[Ca.browserAppStart=14]="browserAppStart";
Ca[Ca.linkedObjects=15]="linkedObjects";Ca[Ca.longFrames=16]="longFrames";Ca[Ca.task=17]="task";Ca[Ca.conflictInEditing=18]="conflictInEditing";Ca[Ca.incomingPresenceData=19]="incomingPresenceData";Ca[Ca.editorTableDelay=20]="editorTableDelay";Ca[Ca.presenceStartup=21]="presenceStartup";Ca[Ca.presenceDelete=22]="presenceDelete";Ca[Ca.editorEvent=23]="editorEvent";Ca[Ca.editorTime=24]="editorTime";Ca[Ca.gridScreenReaderOps=25]="gridScreenReaderOps";Ca[Ca.sendPresenceToService=26]="sendPresenceToService";
Ca[Ca.IME=27]="IME";Ca[Ca.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";Ca[Ca.customizeStatusBar=29]="customizeStatusBar";Ca[Ca.clientWebRequests=30]="clientWebRequests";Ca[Ca.showCommentTaskPane=31]="showCommentTaskPane";Ca[Ca.applyThreadedCommentChange=32]="applyThreadedCommentChange";Ca[Ca.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";Ca[Ca.findNextOrPreviousComment=34]="findNextOrPreviousComment";Ca[Ca.goto=35]="goto";Ca[Ca.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";
Ca[Ca.richApiInvocation=37]="richApiInvocation";Ca[Ca.fxLibrary=38]="fxLibrary";Ca[Ca.embeddedApiSession=39]="embeddedApiSession";Ca[Ca.numberFormattingCalculator=40]="numberFormattingCalculator";Ca[Ca.requestDataAfterSend=41]="requestDataAfterSend";Ca[Ca.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";Ca[Ca.copy=43]="copy";Ca[Ca.paste=44]="paste";Ca[Ca.dragDrop=45]="dragDrop";Ca[Ca.clearCopyState=46]="clearCopyState";Ca[Ca.webWorkerRecalcStats=47]="webWorkerRecalcStats";Ca[Ca.dataValidationEditOpenDialog=
48]="dataValidationEditOpenDialog";Ca[Ca.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";Ca[Ca.customSort=50]="customSort";Ca[Ca.namedSheetViewUserAction=51]="namedSheetViewUserAction";Ca[Ca.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";Ca[Ca.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";Ca[Ca.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";Ca[Ca.namedSheetViewTempViewApplyDialog=55]="namedSheetViewTempViewApplyDialog";Ca[Ca.namedSheetViewTempViewSaveDialog=
56]="namedSheetViewTempViewSaveDialog";Ca[Ca.temporaryViewStartedDataRestore=57]="temporaryViewStartedDataRestore";Ca[Ca.temporaryViewFetchedVersion=58]="temporaryViewFetchedVersion";Ca[Ca.raiseEventsAndGenerateBlockRequests=59]="raiseEventsAndGenerateBlockRequests";Ca[Ca.launchMakerCodeEditor=60]="launchMakerCodeEditor"})(wh||(wh={}));Object(kd.b)("UsageTable",wh);var ch=b(418),Bg=b(478),Ah=b(644),eg=b(693),Mh=b(262),pi=Sys.EventArgs;vm(B,pi);Object(kd.a)(B,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,
[]);t.prototype.t_g=function(Ca){return new t(this.total+Ca.total,this.rMd+Ca.rMd)};t.UQg=function(Ca,ua){return String.format("{0}_{1}",Ca,ua)};Sk.Object.defineProperties(t.prototype,{average:{configurable:!0,enumerable:!0,get:function(){return this.total/this.rMd}}});Object(kd.a)(t,"StopwatchAverage",null,[]);var mg;(function(Ca){Ca[Ca.longFrame=0]="longFrame";Ca[Ca.longGetRange=1]="longGetRange";Ca[Ca.longJsTask=2]="longJsTask";Ca[Ca.viewportCalculationLoops=3]="viewportCalculationLoops"})(mg||
(mg={}));Object(kd.b)("UtrKpiVeto",mg);y.q4a=function(Ca){return Enum.toString(mg,Ca)};y.YTa="UTR";Object(kd.a)(y,"KpiConstants",null,[]);x.Lfg="UTRVetoName";x.Dfg="UTRErrorName";x.UVj="UTROperationName";x.sZd="UTRDuration";x.VVj="UTREndedInPhase";x.Ifg="UTRMessage";x.Kfg="UtrUnavailabilityType";x.operationName="OperationName";x.duration="Duration";x.message="Message";Object(kd.a)(x,"UtrAdditionalData",null,[]);f.dXj="VetoLike";f.cjh="E2EOperationPerf";f.Pgj="RequestPerf";f.APj="UnavailabilityDurations";
Object(kd.a)(f,"UtrTypes",null,[]);m.prototype.GHb=function(Ca,ua,sb){sb=void 0===sb?null:sb;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(sb=sb?Object.assign(new Xg.a,{extendedProperties:sb}):null,Ca=y.q4a(Ca),hd.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+Ca,ua,!1,!0,"",sb))};m.prototype.jJb=function(Ca,ua,sb,Ld,le,nf){nf[y.YTa]=f.dXj;nf[x.Lfg]=y.q4a(Ld);nf[x.Dfg]=le;ge.ULS.sendTraceTag(Ca,ua,sb,Bf.a.Kc(nf));delete nf[y.YTa];delete nf[x.Lfg];delete nf[x.Dfg]};
Object(kd.a)(m,"UtrKpiVetoReporter",null,[]);n.prototype.DKd=function(Ca,ua){ua=void 0===ua?null:ua;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||hd.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+y.q4a(Ca),0,"",ua)};n.prototype.GHb=function(Ca,ua,sb){sb=void 0===sb?null:sb;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ca=y.q4a(Ca),hd.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+Ca,ua,!1,!0,this.r3c(sb)))};n.prototype.$fj=function(Ca,
ua){ua=void 0===ua?null:ua;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||hd.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+y.q4a(Ca),"",this.r3c(ua))};n.prototype.Zfj=function(Ca,ua,sb){sb=void 0===sb?null:sb;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ca=y.q4a(Ca),hd.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+Ca,ua,!1,!0,"",this.r3c(sb)))};n.prototype.r3c=function(Ca){return Ca?Object.assign(new Xg.a,{extendedProperties:Ca}):
null};Object(kd.a)(n,"UtrKpiVetoUsageReporter",null,[]);l.prototype.itc=function(Ca,ua,sb){sb=void 0===sb?null:sb;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||hd.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+Ca,"",Object.assign(new Xg.a,{extendedProperties:sb,durationMs:ua}))};l.prototype.ptc=function(Ca,ua,sb){sb=void 0===sb?null:sb;ee.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(ua?hd.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+
Ca,"",Object.assign(new Xg.a,{extendedProperties:sb})):hd.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+Ca,"",!1,!1,"",Object.assign(new Xg.a,{extendedProperties:sb})))};l.prototype.gJb=function(Ca,ua,sb,Ld,le,nf,ug,Cf){for(var Cg=[],Ag=7;Ag<arguments.length;++Ag)Cg[Ag-7]=arguments[Ag];Cg=String.format.apply(null,[ug].concat(Cg));Ag={};Ag[y.YTa]=f.cjh;Ag[x.UVj]=Ld;Ag[x.VVj]=le;Ag[x.sZd]=nf;Ag[x.Ifg]=Cg;ge.ULS.sendTraceTag(Ca,ua,sb,Bf.a.Kc(Ag))};l.prototype.iJb=function(Ca,ua,sb,Ld,le,
nf){this.M0f(nf,Ld,le);ge.ULS.sendTraceTag(Ca,ua,sb,Bf.a.Kc(nf));this.zdh(nf)};l.prototype.hJb=function(Ca,ua,sb,Ld,le,nf,ug){for(var Cf=[],Cg=6;Cg<arguments.length;++Cg)Cf[Cg-6]=arguments[Cg];Cf=String.format.apply(null,[nf].concat(Cf));Cg={};this.M0f(Cg,Ld,le,Cf);ge.ULS.sendTraceTag(Ca,ua,sb,Bf.a.Kc(Cg))};l.prototype.ivc=function(Ca,ua,sb,Ld){Ld[y.YTa]=f.Pgj;ge.ULS.sendTraceTag(Ca,ua,sb,Bf.a.Kc(Ld));delete Ld[y.YTa]};l.prototype.M0f=function(Ca,ua,sb,Ld){Ld=void 0===Ld?null:Ld;Ca[y.YTa]=f.APj;Ca[x.Kfg]=
ua;Ca[x.sZd]=sb;Ld&&(Ca[x.Ifg]=Ld)};l.prototype.zdh=function(Ca){delete Ca[y.YTa];delete Ca[x.Kfg];delete Ca[x.sZd]};Object(kd.a)(l,"UtrOperationPerfReporter",null,[]);var si=Da.a;vm(e,si);e.prototype.CTd=function(Ca,ua,sb){this.CLb(Ca,ua,sb,Df.a.HBb(Df.a.Ra.Kb.getTime()))};e.prototype.CLb=function(Ca,ua,sb,Ld,le){le=void 0===le?null:le;if(this.H7[sb])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.H7[sb]=this.tFe(Ca,ua,sb,Ld,le)};e.prototype.y8c=function(Ca){this.Gsb(Ca,
Df.a.HBb(Df.a.Ra.Kb.getTime()))};e.prototype.Gsb=function(Ca,ua){var sb=this.H7[Ca];sb&&(this.ABe(sb,ua),this.oRj(sb),delete this.H7[Ca])};e.prototype.eQf=function(Ca){delete this.H7[Ca]};e.prototype.N6f=function(Ca,ua){this.ifb||this.C6f(Ca,ua)};e.prototype.x6f=function(){this.N6f(e.Bid,this.mh.he)};e.prototype.ULe=function(Ca,ua){ua=void 0===ua?!1:ua;if(this.ifb){if(this.SCa===e.PCd||this.SCa===e.Bid){var sb=Re.a.instance;sb.userSessionId=this.userSessionId;if(this.SCa===e.PCd){this.wue||(this.Zba(Ca.m,
Object(mc.a)(sb,sb.N7i,"recordContentFetchEnd")),this.wue=!0);if(ua){this.rHf||(this.Zba(Ca.m,Object(mc.a)(sb,sb.X7i,"recordPerceivedContentDisplayed")),this.rHf=!0);return}this.Zba(Ca.m,Object(mc.a)(sb,sb.M7i,"recordContentDisplayed"))}else this.SCa===e.Bid&&(ua=this.H7[this.UNb])&&this.Zba(Mh.a(Ca,ua.s),Object(mc.a)(sb,sb.V7i,"recordInteractivityContentDisplayed"),!1)}this.Gsb(this.UNb,Ca);this.UNb=this.SCa=this.ifb=null}};e.prototype.Zba=function(Ca,ua,sb){sb=void 0===sb?!0:sb;Re.a.eQ&&Object(Fh.a)(eg.PerformanceClock,
Df.a.Ra)&&sb&&(Ca+=window.performance.timing.navigationStart);ua(Ca)};e.prototype.ui=function(Ca){return ch.a(Ca)};e.prototype.Pe=function(Ca,ua,sb){sb=void 0===sb?!1:sb;try{this.Pnf[wh[Ca]]=!0,sb&&ge.ULS.sendTraceTag(3704927,0,50,z(Ca,ua))}catch(Ld){ge.ULS.sendTraceTag(3704928,0,10,"Error when serializing usage table: {0} exception: {1}",Ca,Ld)}};e.prototype.w8c=function(Ca,ua,sb){if(this.zpc){var Ld=this.YWa[Ca+ua];Ld&&(Ld.e=sb,this.Vad(Ld));delete this.YWa[Ca+ua]}};e.prototype.$td=function(Ca,
ua){wh[Ca]in this.Pnf||this.Pe(Ca,ua)};e.prototype.pZi=function(){this.mh.appStart&&this.C6f(e.PCd,this.mh.appStart)};e.prototype.Twi=function(Ca){var ua={};ua.a=Ca.i;ua.b=Ca.o;ua.c=Ca.t;ua.d=Mh.a(Ca.s,Ca.p||this.mh.appStart);ua.e=Mh.a(Ca.e,Ca.s);ua.f=Ca.c;ua.g=Ca.a;ua.h=Ca.h;this.Pe(0,ua,this.gli(ua.b,ua.c))};e.prototype.gli=function(Ca,ua){return Array.contains(["CommandTask","QueuedTask","Task"],Ca)&&!Array.contains(this.azh,ua)?!1:!0};e.prototype.XB=function(Ca,ua,sb,Ld,le){if(Ca&&ua){var nf=
{};nf.a=Ca;nf.b=ua;nf.c=sb.toString();nf.d=Ld.toString();this.Pe(15,nf,void 0===le?!0:le)}};e.prototype.Cnf=function(Ca,ua,sb,Ld){var le={};Ca&&(le.c=Mh.a(Ca,this.mh.appStart));le.b=ua;le.a=sb;le.d=Ld;this.Pe(17,le)};e.prototype.dispose=function(){var Ca=this;this.IQa.execute(function(ua){ua.deactivate(!0);ua.jcj(Ca.ACf)});this.Fe&&this.Fe.Zab(this.mW);this.na&&this.na.tda(this.g8);si.prototype.dispose.call(this)};e.prototype.b5e=function(){return this.Dgg=this.Dgg||new u};e.prototype.tFe=function(Ca,
ua,sb,Ld,le){var nf={};nf.o=Ca;nf.t=ua;nf.p=void 0===le?null:le;nf.s=(void 0===Ld?null:Ld)||this.mh.he;this.cmd(nf,void 0===sb?null:sb);return nf};e.prototype.ABe=function(Ca,ua){Ca&&(Ca.e=(void 0===ua?null:ua)||this.mh.he,Ca.i=Ca.i||this.z0a.t8a(),Ca.c=Ca.c||this.ZFe,Ca.a=Ca.a||this.fGe,Ca.h=void 0!==Ca.h&&null!==Ca.h?Ca.h:this.Fe?this.Fe.Di:!1,this.Vad(Ca))};e.prototype.Knf=function(Ca){var ua=Ca.context;Ca.duration>e.Dih&&(ua.methodName===pg.a.Gvb||ua.methodName===pg.a.wKa)&&this.mtc(1,e.TWh);
if("GetSessionStatus"!==ua.methodName){var sb={};sb.a=ua.methodName;sb.b=ua.stopwatch.id;sb.c=Ca.xtc;sb.d=Ca.responseSize;sb.e=ua.k2b;sb.f=Ca.ud?Ca.ud.StateId:pg.a.pXd;this.Pe(30,sb,!0);this.XB(sb.b,Ca.ud.ServerCorrelationId,"clientWebRequests","ServerActions")}};e.prototype.o7f=function(){if(this.zpc){var Ca=this.YWa.LoadingUIShownSplashScreen;Ca&&yd.PageLoadTrackingInfo.instance.ysj(Ca.s)}};e.prototype.mtc=function(Ca,ua){this.Ffg.GHb(Ca,ua,null)};e.prototype.KSf=function(Ca,ua){this.oCc.$fj(Ca,
void 0===ua?null:ua)};e.prototype.JSf=function(Ca,ua,sb){this.oCc.Zfj(Ca,ua,void 0===sb?null:sb)};e.prototype.LSf=function(Ca){this.oCc.DKd(Ca,null)};e.prototype.MSf=function(Ca,ua){this.oCc.GHb(Ca,ua,null)};e.prototype.itc=function(Ca,ua,sb){this.mfb.itc(Ca,ua,void 0===sb?null:sb)};e.prototype.ptc=function(Ca,ua,sb){this.mfb.ptc(Ca,ua,void 0===sb?null:sb)};e.prototype.sendDNMTraceTag=function(Ca,ua,sb,Ld,le){for(var nf=[],ug=4;ug<arguments.length;++ug)nf[ug-4]=arguments[ug];ee.EwaSettings.la(219)&&
ge.ULS.sendTraceTag.apply(null,[Ca,ua,sb,Ld].concat(nf))};e.prototype.gJb=function(Ca,ua,sb,Ld,le,nf,ug,Cf){for(var Cg=[],Ag=7;Ag<arguments.length;++Ag)Cg[Ag-7]=arguments[Ag];var eh;(eh=this.mfb).gJb.apply(eh,[Ca,ua,sb,Ld,le,nf,ug].concat(Cg))};e.prototype.iJb=function(Ca,ua,sb,Ld,le,nf){this.mfb.iJb(Ca,ua,sb,Ld,le,nf)};e.prototype.hJb=function(Ca,ua,sb,Ld,le,nf,ug){for(var Cf=[],Cg=6;Cg<arguments.length;++Cg)Cf[Cg-6]=arguments[Cg];var Ag;(Ag=this.mfb).hJb.apply(Ag,[Ca,ua,sb,Ld,le,nf].concat(Cf))};
e.prototype.jJb=function(Ca,ua,sb,Ld,le,nf){this.Ffg.jJb(Ca,ua,sb,Ld,le,nf)};e.prototype.ivc=function(Ca,ua,sb,Ld){this.mfb.ivc(Ca,ua,sb,Ld)};e.prototype.Vad=function(Ca){this.mHj.Twi(Ca)};e.prototype.qZi=function(){if(this.zpc){Stw.swpc=null;var Ca=this.zpc,ua;for(ua in Ca)this.cmd(Ca[ua])}};e.prototype.gCh=function(){var Ca=this,ua=window[Bg.a.namespace];if(ua){var sb=ua[Bg.a.GAe];sb&&(delete ua[Bg.a.GAe],sb.forEach(function(Ld){Ca.cmd(Ld);Ca.Vad(Ld)}))}};e.prototype.vmi=function(Ca,ua){if("about:blank"===
Ca||"renamehandler.ashx"===ua&&"2"===Qd.a.DC(Ca,"u"))return!0;for(Ca=0;Ca<this.NKd.length;Ca++)if(ua.endsWith(this.NKd[Ca]))return!0;return!1};e.prototype.Aui=function(){var Ca=this;this.IQa.execute(function(ua){ua.ji(e.kNg,0);ua.PEg(Ca.ACf);ua.activate()})};e.prototype.sui=function(){var Ca={};Ca.a=new Date(Ge.EcmaDateClock.instance.appStart.m);Ca.b=this.userSessionId;Ca.c=this.mh.i$f;Ca.d=e.nch*rc.devicePixelRatio;Ca.e=Df.a.Ra.appStart.m;this.Pe(14,Ca,!0);this.Zba(Df.a.Ra.appStart.m,Object(mc.a)(Re.a.instance,
Re.a.instance.F7i,"recordAppInitStart"))};e.prototype.C6f=function(Ca,ua){this.ifb=this.z0a.t8a();this.UNb=this.z0a.t8a();this.SCa=Ca;this.CLb("UserAction",Ca,this.UNb,ua);this.Gmf(Ca,this.ifb)};e.prototype.tJj=function(){var Ca=this,ua=window[Bg.a.namespace];ua&&!e.PDe&&(ua[Bg.a.jGj]=function(sb,Ld){return Ca.tFe(sb,Ld)},ua[Bg.a.dlh]=function(sb){Ca.ABe(sb)},e.PDe=!0)};e.prototype.oRj=function(Ca){var ua=t.UQg(Ca.o,Ca.t),sb=new t(Mh.a(Ca.e,Ca.s)),Ld=ua in this.TTd?this.TTd[ua].t_g(sb):sb;this.TTd[ua]=
Ld;if(sb===Ld||sb.average!==Ld.average)Ca=Object.assign(new B,{operation:Ca.o,target:Ca.t,GDi:Ld.average,sender:this}),this.raiseEvent(ua,Ca)};e.prototype.Gmf=function(Ca,ua){var sb={};sb.a=ua;sb.b=this.userSessionId;sb.c=Ca;this.Pe(1,sb,!0)};e.prototype.Zai=function(){this.NKd=["RemoteUls.ashx","GetSessionStatus",pg.a.wKa,"Collector/3.0/","CheckCollabServiceContentUpdate","UpdatePresenceUsers","GetNumberFormatCategory","GetObjectMetadata","SetCell","GetSheetProcessedData","UploadLatencyTelemetry",
"PollSessionStatus","GetStatusBarAggregates","GetRichValueFieldListContextList","GetInstantaneousSupportInformation"]};e.prototype.cmd=function(Ca,ua){Ca.i=(void 0===ua?null:ua)||this.z0a.t8a();Ca.a=this.fGe;Ca.c=this.ZFe;Ca.h=this.Fe?this.Fe.Di:!1};e.ja=function(Ca){var ua=new T;Ca.da.Ha(291,ua);ua=new e(Ca.ya.UserSessionId,void 0,void 0,void 0,ua,!0,Ca.na);ua.Gmf(e.Dsf,ua.WGe);ge.ULS.sendTraceTag(19481687,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");ua.Aui();ua.tJj();
ua.pZi();ua.sui();ua.gCh();ua.qZi();ua.Zai();e.sqj(Ca);Od.a.Zi.Ha(41,ua)};e.sqj=function(Ca){var ua=rc.devicePixelRatio;1<ua&&Ca.nc.Kw(!0,2<=ua?8388608:4194304)};Sk.Object.defineProperties(e.prototype,{H7:{configurable:!0,enumerable:!0,get:function(){return this.Whe||(this.Whe={})}},ZFe:{configurable:!0,enumerable:!0,get:function(){return this.ifb||this.WGe}},fGe:{configurable:!0,enumerable:!0,get:function(){return this.SCa||e.Dsf}},TTd:{configurable:!0,enumerable:!0,get:function(){return this.Hte=
this.Hte||{}}},zpc:{configurable:!0,enumerable:!0,get:function(){return this.YWa||"undefined"===typeof Stw?this.YWa:this.YWa=Stw.swpc}},Pnf:{configurable:!0,enumerable:!0,get:function(){return this.Rae=this.Rae||{}}},IQa:{configurable:!0,enumerable:!0,get:function(){return this.hlb||(this.hlb=Uc.a.instance.oc("Common.NetworkTiming.IResourceTimingLogger"))}},Ffg:{configurable:!0,enumerable:!0,get:function(){return this.Gfg||(this.Gfg=new m)}},mfb:{configurable:!0,enumerable:!0,get:function(){return this.Jfg||
(this.Jfg=new l)}},oCc:{configurable:!0,enumerable:!0,get:function(){return this.Hfg||(this.Hfg=new n)}}});e.Dsf="UnassignedUserAction";e.PCd="PageLoad";e.Bid="GridUpdateOperation";e.Dih=5E3;e.TWh="MoreThan_5000_Ms";e.nch=96;e.kNg=30;e.PDe=!1;Object(kd.a)(e,"TelemetryManager",Da.a,[345,346,347,348]);var Wh=b(187),qg=b(102);Object(kd.a)(c,"Validation",null,[]);a.prototype.qUc=function(Ca,ua,sb,Ld,le){if(Ca&&Ld){var nf=Wh.a.Yy(ua,sb);this.qYb(function(){return!!qg.a(Ca).Up(nf)},Ld.StateId,le)}};a.prototype.qYb=
function(Ca,ua,sb){this.BDg(this.$Ue,Ca,ua,sb)};a.prototype.BDg=function(Ca,ua,sb,Ld){Ca&&ua&&sb!==pg.a.Te&&Ca.add(new c(ua,sb,Ld))};a.prototype.wHf=function(Ca){if(Ca){for(var ua=new Fd.a,sb=yl(Ca),Ld=sb.next();!Ld.done;Ld=sb.next()){Ld=Ld.value;if(Ld.eV===this.$.ea.uf)try{Ld.IWj()||ge.ULS.sendTraceTag(537151010,0,15,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [{0}]",Ld.name)}catch(le){ge.ULS.sendTraceTag(537151009,0,10,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [{0}]. Exception: [{1}]",
Ld.name,le)}ua.add(Ld)}ua=yl(ua);for(Ld=ua.next();!Ld.done;Ld=ua.next())Ca.remove(Ld.value)}else ge.ULS.shipAssertTag(537151011,0,!!Ca,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")};a.prototype.dispose=function(){ve.g(this.$)&&ve.g(this.$).Ca&&(ve.g(this.$).Ca.Kq(this.Jg),ve.g(this.$).Ca.bJd(this.i9a));this.$=null};a.ja=function(Ca){var ua=new a(Ca);Ca.da.Ha(277,ua)};Object(kd.a)(a,"ValidationTelemetryManager",null,[294,3]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");
Wd.main();Type.registerNamespace("CNT");Sd.main();Type.registerNamespace("CACPU");Hb.main();Type.registerNamespace("Common.App.EventsCacheManager");Gc.main();(function(){ue.a.Ga(function(Ca){Ca.da.Ha(137,new Sa(Ca))})})();(function(){ue.a.Ga(function(Ca){Ca.da.Ha(37,new kc(Ca))})})();(function(){ue.a.Ga(function(Ca){ra.ja(Ca)})})();(function(){ue.a.Ga(function(Ca){Oa.ja(Ca)})})();(function(){ue.a.Ga(function(Ca){mb.ja(Ca)})})();(function(){ue.a.Ga(function(Ca){Ca.da.Ha(40,new ub(Ca,new Ve.a(function(){return Kc.GetServiceTaskFactory.create(Ca.da,
137,Ca.ma,1)})))})})();(function(){ue.a.Ga(function(Ca){Ca.da.Ha(276,new qa(Ca))})})();(function(){ue.a.Ga(function(Ca){Od.a.Zi.Za(135,function(){e.ja(Ca);H.ja(Ca);a.ja(Ca);r.ja(Ca);ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnregisterCpuMeter",!1)||S(Ca);ca.ja(Ca);da.ja(Ca);ee.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RenderingFidelityMetric",!1)&&Kg.RenderingFidelityTracker.ja(Ca)})})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.tm.js.map/70ec3821655afaf3e3f52d50fa02dffd/EwaDS.tm.js.map