(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[23],{1132:function(A,F,b){function a(n,m){n=l.call(this,n,m)||this;m!==e.a.W9&&n.vFa(m);n.Rga(a.iterateNext);n.Rga(a.pxa);n.$Tc(c.a.hUa);n.$Tc(c.a.iUa);return n}b.d(F,"a",function(){return a});A=b(0);var c=b(170);F=b(1247);var e=b(889),l=F.a;vm(a,l);a.iterateNext="IterateNext";a.pxa="IteratePrevious";a.HMb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.ZOa=
"OnVHDiffReady";Object(A.a)(a,"VersionHistoryMessenger",F.a,[])},1250:function(A,F,b){function a(K,da,fa,X){var ca=this;this.authorColor=this.m2=this.Iea=null;this.f7a=!1;this.R$f=0;this.X0a=-1;this.i5c=0;this.hIa=100;this.fla=-1;this.KZd=null;this.Iob=x.a.XWj;this.UGe=x.a.YWj;this.Nh=function(ja){(ja=r.a(ja)?null:ja.Result)?ja.OperationWaitingForFileDownload?20>ca.i5c?(ca.hIa*=2,S.Task.delay(ca.hIa).continueWith(function(){ca.UWd()})):(ca.wBc(),e.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
ja.ActivityList?(ca.initialize(ja.ActivityList,ja.VersionAuthors),J.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?ca.ZOa():ca.Exc(!0),ca.KZd.stop(),e.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",ca.KZd.Dc.toString())):(ca.wBc(),e.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(ca.hIa*=2,S.Task.delay(ca.hIa).continueWith(function(){ca.UWd()}),
e.ULS.sendTraceTag(537150408,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.Pya=function(){ca.wBc();e.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.Rrd=function(ja){e.ULS.sendTraceTag(537150400,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",ja.MessageId);switch(ja.MessageId){case ba.a.iterateNext:ca.iterateNext();ca.fla=(ca.fla+1)%ca.xS.length;ca.bJb(ba.a.setCurrentChangeCount,
ca.fla+1);break;case ba.a.pxa:ca.pxa();ca.fla=0>ca.fla?0:ca.fla;ca.fla=(ca.fla+ca.xS.length-1)%ca.xS.length;ca.bJb(ba.a.setCurrentChangeCount,ca.fla+1);break;case ba.a.HMb:ca.Exc(ja.Values.ToggleValue)}};this.G0g=function(ja,ea){return ca.M2b(ja.zm,ea.zm)};this.F0g=function(ja,ea){return ca.M2b(ja.zm,ea)};this.nd=function(){ca.N5b()};this.lp=function(){ca.N5b()};this.fj=function(){ca.N5b()};e.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=K;this.ariaLiveNotifier=
X;this.gridView=Q.g(this.$);this.gridView.ha.OG(this.nd);this.gridView.cE(this.lp);this.gridView.yc.Yl(this.fj);this.VSj();da&&(this.KZd=K.Vb.Hc("UserAction","VersionHistoryDiffManagerStopWatch"),this.UWd());if(this.gs=fa)K=l.a.Saa(this.$.ya.VersionHistoryActionUrl)||H.a.W9,K!==H.a.W9&&this.gs.vFa(K),this.gs.Zn(ba.a.iterateNext),this.gs.Zn(ba.a.pxa),this.gs.Zn(ba.a.HMb),this.gs.Kl(ba.a.iterateNext,this.Rrd),this.gs.Kl(ba.a.pxa,this.Rrd),this.gs.Kl(ba.a.HMb,this.Rrd)}function c(K,da,fa){this.sFa=K;
this.zm=da;this.hCc=fa}A=b(0);var e=b(13),l=b(78),n=b(961),m=b(84),f=b(184),x=b(8),y=b(203),t=b(61),B=b(43),z=b(521),u=b(164),C=b(106),r=b(303),J=b(1),v=b(9),D=b(94),V=b(14),U=b(272);b(105);var Q=b(20),la=b(336);Object(A.a)(c,"UserActivityLocation",null,[]);var ba=b(1132),T=b(81),H=b(889),S=b(52);b.d(F,"a",function(){return a});a.prototype.dispose=function(){this.Jza();this.Iea=this.m2=null;this.gridView&&(this.gridView.ha&&this.gridView.ha.WF(this.nd),this.gridView.UF(this.lp),this.gridView.yc&&
this.gridView.yc.ol(this.fj),this.gs&&(this.gs.Aoa(ba.a.pxa),this.gs.Aoa(ba.a.iterateNext),this.gs.Aoa(ba.a.HMb)))};a.prototype.initialize=function(K,da){K?(this.Jza(),this.X0a=-1,this.Iea=[],this.f7a=!1,this.m2={},this.authorColor={},this.$yi(da),this.P4c(K)):e.ULS.shipAssertTag(537150410,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.UWd=function(){function K(fa,X,ca){var ja=da.$.na.ta;fa=U.b(fa,da.Nh);X=U.a(X,da.Pya);var ea=ja.Na(1,null);return T.i(ja,
"GetVersionHistoryHighlightActivitiesData",ea,fa,X,ca,null,4)}var da=this;e.ULS.sendTraceTag(537150409,0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.i5c.toString(),this.hIa.toString());this.i5c++;J.EwaSettings.sc()?this.$.userOperationManager.hc(new u.a(537,0,K,80),null):this.$.userOperationManager.hc(new z.a(537,0,K,16),null)};a.prototype.Exc=function(K){var da=this.m2,fa;for(fa in da){var X=fa,ca=da[fa];ca?ca.YKb(K):e.ULS.shipAssertTag(537150404,
0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+X+"view was Null")}};a.prototype.Jza=function(){var K=this.m2,da;for(da in K){var fa=da,X=K[da];X?X.Jaj():e.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+fa+"view was Null")}this.Iea=this.m2=null};a.prototype.xXf=function(K){var da=this.KUh(K,this.X0a);var fa=da.maf;K=da.sfg;da.returnValue&&(e.ULS.shipAssertTag(537150402,0,!!K,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),
this.N5b(),K.sFa.toString()in this.m2?(this.m2[K.sFa.toString()].nnj(K.zm),da=B.D(K.zm),this.ariaLiveNotifier.setEnabled(!1),this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(V.a.instance.Cb(157),fa+1,this.xS.length,da.FC(!1),K.hCc.DisplayName)),this.X0a=fa):e.ULS.shipAssertTag(537150401,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",K.sFa.toString())))};a.prototype.bJb=function(K,da){if(J.EwaSettings.la(329))if(this.gs){var fa=
{};fa.count=da;K=new n.a(K);K.Values=fa;this.gs.send(K)}else e.ULS.sendTraceTag(537150370,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");else e.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.KUh=function(K,da){var fa=!1;var X=null;for(var ca=0;!fa&&ca<this.xS.length;){da=K?this.BUh(da):this.kWh(da);X=this.xS[da];var ja=Object(m.a)(D.a,this.$.xa.getItemByName(X.zm.SheetName));
if(!ja)return e.ULS.shipAssertTag(537150369,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),{returnValue:!1,maf:da,sfg:X};ja.visible&&(fa=!0);ca++}return{returnValue:fa,maf:da,sfg:X}};a.prototype.BUh=function(K){return-1===K?this.n1e():(K+1)%this.xS.length};a.prototype.kWh=function(K){-1===K&&(K=this.n1e());return K=(K+this.xS.length-1)%this.xS.length};a.prototype.P4c=function(K){this.aah(K);
this.u4c()};a.prototype.G0h=function(K,da){var fa=[];if(!K.RangeList)return e.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),fa;K=yl(K.RangeList);for(var X=K.next();!X.done;X=K.next())(X=X.value)&&this.$.xa.zj(X.SheetName)?(X=new c(0,X,da),fa.push(X)):e.ULS.shipAssertTag(537150367,0,!1," Inavlid sheet name"+X.SheetName);return fa};a.prototype.aah=function(K){K=yl(K);for(var da=K.next();!da.done;da=
K.next())if(da=da.value,!da||C.e(da.LocationList))e.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(var fa=yl(da.LocationList),X=fa.next();!X.done;X=fa.next())if(X=X.value)switch(X.Type){case 0:this.Iea.push.apply(this.Iea,Gl(this.G0h(X,da.Person)));break;default:e.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else e.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};
a.prototype.u4c=function(){for(var K={},da=new f.a,fa=[],X=yl(this.Iea),ca=X.next();!ca.done;ca=X.next())if(ca=ca.value,da.contains(ca.hCc)||da.add(ca.hCc),0===ca.sFa){var ja=new la.a(B.D(ca.zm),t.d(this.$.xa.getItemByName(ca.zm.SheetName))),ea=a.Hwc(ja);ea in K||fa.push(ja);K[ea]=this.DMh(ca.hCc)}e.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",
this.Iea.length,fa.length,da.count,this.R$f);this.wBc();0<fa.length&&(K=new (b(1343).RangeVersionHistoryHighlightView)(this.$,fa,K,this.Iob),this.m2["0"]=K)};a.prototype.wBc=function(){var K=this.Iea?this.xS.length:0;this.bJb(ba.a.setCurrentChangeCount,0);this.bJb(ba.a.setTotalChangesCount,K)};a.prototype.ZOa=function(){this.bJb(ba.a.ZOa,0)};a.prototype.$yi=function(K){if(K){this.R$f=K.length;for(var da=0;da<K.length;++da)if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&
!K[da].InitialsColor)e.ULS.sendTraceTag(537150362,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var fa=K[da].EmailAddress;var X=K[da].UserName;var ca=null;if(K[da].LoginName){var ja=K[da].LoginName.split("|");3===ja.length&&(ca=ja[2])}ca?this.authorColor[ca]=K[da].InitialsColor:fa?(e.ULS.sendTraceTag(537150361,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.authorColor[fa]=K[da].InitialsColor):
X?(e.ULS.sendTraceTag(537150360,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),this.authorColor[X]=K[da].InitialsColor):e.ULS.sendTraceTag(537150359,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}}else e.ULS.sendTraceTag(537150363,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.VSj=function(){if(this.$.ya.VersionHistoryHighlightsSettings)for(var K=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?
Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):null,da=0;da<K.length;da++){var fa=K[da],X=fa.key?fa.key:fa.Key?fa.Key:"";fa=fa.value?fa.value:fa.Value?fa.Value:"";"DefaultColor"===X?this.UGe=fa:"InitialTint"===X?this.Iob=fa:e.ULS.sendTraceTag(537150357,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}else e.ULS.sendTraceTag(537150358,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"))};
a.prototype.DMh=function(K){if(K.Email in this.authorColor)return this.authorColor[K.Email];if(K.DisplayName in this.authorColor)return this.authorColor[K.DisplayName];e.ULS.sendTraceTag(537150356,0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary"));return this.UGe};a.prototype.M2b=function(K,da){var fa=Object(m.a)(D.a,this.$.xa.getItemByName(K.SheetName)),X=Object(m.a)(D.a,this.$.xa.getItemByName(da.SheetName));return fa&&
X?(fa=(fa=v.HelperMethods.WC(fa.index,X.index))||v.HelperMethods.WC(K.FirstRow,da.FirstRow))||v.HelperMethods.WC(K.FirstColumn,da.FirstColumn):(e.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),0)};a.prototype.n1e=function(){var K=B.m(this.gridView.ha.va.activeRange,this.$.xa.pa);if(!K)return e.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;K=
v.HelperMethods.nx(new y.a(this.xS),0,this.xS.length,K,this.F0g);0>K&&(K=~K);return K%this.xS.length};a.prototype.N5b=function(){if(this.VIb){if(!(this.VIb.sFa.toString()in this.m2)){e.ULS.shipAssertTag(537150353,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",this.VIb.sFa.toString()));return}this.m2[this.VIb.sFa.toString()].Kdh(this.VIb.zm)}this.X0a=-1};a.prototype.iterateNext=function(){this.xXf(!0)};a.prototype.pxa=function(){this.xXf(!1)};
a.Hwc=function(K){return String.format("{0}{1}",K.range,K.sheetId)};Sk.Object.defineProperties(a.prototype,{wfb:{configurable:!0,enumerable:!0,get:function(){return this.m2}},VIb:{configurable:!0,enumerable:!0,get:function(){return-1===this.X0a?null:this.xS[this.X0a]}},xS:{configurable:!0,enumerable:!0,get:function(){this.f7a||(this.Iea.sort(this.G0g),this.f7a=!0);return this.Iea}}});Object(A.a)(a,"VersionHistoryHighlightManager",null,[407,3])},1343:function(A,F,b){function a(z,u,C,r){this.Eib=null;
this.$=z;this.Zvg=u;this.WRa=C;this.XRa={};this.Iob=r;this.ici()}function c(){}b.r(F);A=b(0);var e=b(13),l=b(8);c.juh="ewa-vhr-rectinnerborder";Object(A.a)(c,"CssClassNames",null,[]);var n=b(61),m=b(43),f=b(215),x=b(105),y=b(20),t=b(336),B=b(1250);b.d(F,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.YKb=function(z){z?this.Nb.ys(this.BH):this.Nb.ll(this.BH)};a.prototype.Jaj=function(){this.YKb(!1);this.Nb.NJb(new t.a(null,n.d(this.$.pa)),this.BH)};a.prototype.nnj=function(z){if(this.WRa){var u=
new t.a(m.D(z),n.d(this.$.xa.getItemByName(z.SheetName))),C=B.a.Hwc(u);if(C in this.WRa)if(C in this.XRa){u=f.a.Tp(this.WRa[C]);C=this.XRa[C];for(var r in C)C[r].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",u.r,u.g,u.b,l.a.ZWj);y.g(this.$).ha.Pa.bH(null);y.g(this.$).Q5e(z,60,!0,x.a.N5i)}else e.ULS.sendTraceTag(537150426,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+C);else e.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+
C)}else e.ULS.sendTraceTag(537150428,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};a.prototype.Kdh=function(z){z=new t.a(m.D(z),n.d(this.$.xa.getItemByName(z.SheetName)));var u=B.a.Hwc(z);if(u in this.XRa)if(u in this.WRa){z=f.a.Tp(this.WRa[u]);u=this.XRa[u];for(var C in u)u[C].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",z.r,z.g,z.b,this.Iob)}else e.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+
u);else e.ULS.sendTraceTag(537150425,0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+u)};a.prototype.ici=function(){var z=this;this.Nb.ry(this.Zvg,[a.X4],!1,function(u,C){if(u&&u.range&&u.sheetId&&C){var r=new t.a(u.range,u.sheetId);r=B.a.Hwc(r);r in z.XRa||(z.XRa[r]={});z.XRa[r][u.paneType.toString()]=C;r in z.WRa?(u=z.WRa[r],r=f.a.Tp(u),C.style.borderColor=u,C.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",r.r,r.g,r.b,z.Iob),u=document.createElement("div"),
u.className=c.juh,C.appendChild(u)):e.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+r)}else e.ULS.shipAssertTag(537150423,0,!!u,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),e.ULS.shipAssertTag(537150422,0,!u||!!u.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),e.ULS.shipAssertTag(537150421,0,!u||!!u.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),
e.ULS.shipAssertTag(537150420,0,!!C,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};Sk.Object.defineProperties(a.prototype,{BH:{configurable:!0,enumerable:!0,get:function(){return[a.X4]}},Nb:{configurable:!0,enumerable:!0,get:function(){return this.Eib||(this.Eib=y.g(this.$).Nb)}}});a.X4=23;Object(A.a)(a,"RangeVersionHistoryHighlightView",null,[450])},1381:function(A,F,b){function a(ac){var Kc=qe.call(this)||this;Kc.$=ac;Kc.dc();return Kc}function c(ac,Kc,dd,Ud){var Le=this;
dd=void 0===dd?null:dd;Ud=void 0===Ud?null:Ud;this.OGa=null;this.U7e=!1;this.GFf=function(ce){Le.B_a.Ipj();Le.B_a.Exc(!0);If.a.oi(ce.wywaActivities)||2===ce.wywaActivities[0].type||Le.B_a.e8h(ce.wywaActivities[0])};this.$=ac;this.B_a=new U(this.$);this.d3d=new fa(bb.AFrameworkApplication.Gb,se.EwaSettings.la(470));ac=Pd.a.ILj(Re.a.instance.oc("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.xlf=Ud;this.Axe=new y(this.$,ac,this.v6a());this.zxe=new V(this.$,bb.AFrameworkApplication.Gb);this.emptyCatchUpBehaviorManager=
new x(this.$);this.lti(function(ce){Le.gIi(ce)},Kc);this.hvi();Kc=null;dd||(Kc=Re.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=dd||new n(Kc);this.flyoutFocus=new m(this.$,this.flyoutRibbonButton)}function e(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=this.activityNavigationManager=
this.activityContentManager=null}function l(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}function n(ac){this.buttonClickedCallback=null;this.cjb=this.Iyb=!1;this.IEh=new Date;this.cVe=ac}function m(ac,Kc){this.$=ac;this.flyoutRibbonButton=void 0===
Kc?null:Kc;qd.a(this.$).Rg(this);this.hasFocus=!1}function f(ac){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+ac)}function x(ac){this.$=ac}function y(ac,Kc,dd){dd=void 0===dd?!1:dd;this.$=ac;this.Bxe=Kc;this.gFb=Re.a.instance.resolve("Common.App.People.IPeopleColorUtils");this.Eqc=Re.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.v6a=dd}function t(){var ac=r.call(this)||this;ac.relationship=0;return ac}function B(){this.color=
this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}function z(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function u(){this.activityFeedItems=null}function C(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}function r(){this.activityFeedItemId=this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=
this.relevancy=this.displayTimestamp=this.location=this.actors=null}function J(ac,Kc,dd,Ud,Le,ce,Nf){Nf=ac.Na(1,void 0===Nf?null:Nf);Nf.getRelevantActivitiesDataRequest=Kc;return oc.i(ac,"GetRelevantActivitiesData",Nf,dd,Ud,Le,ce,0)}function v(ac,Kc,dd,Ud,Le,ce){ce=ac.Na(1,void 0===ce?null:ce);return oc.i(ac,"GetLineageWywaAuthors",ce,Kc,dd,Ud,Le,4)}function D(){}function V(ac,Kc){this.$=ac;this.Gi=Kc}function U(ac){var Kc=this;this.kRa=this.w3b=this.cfa=null;this.W4={};this.hDa=null;this.lkd=!1;
this.BDb=function(dd,Ud){switch(Ud.state){case 0:case 1:3===Ud.eFd&&(Kc.w7h(),Kc.kRa=null);break;case 2:break;case 3:Kc.x6c();Kc.kRa=Ud.activityId;Kc.IAj();break;default:lb.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+Ud.state)}};this.$k=function(){Kc.Orb()};this.nd=function(){Kc.Orb()};this.lp=function(){Kc.Orb()};this.fj=function(){Kc.Orb()};this.x3f=function(dd,Ud){Kc.cfa&&Ud.AH!==Kc.jka&&(Ud.isSticky&&Kc.j6b(!0),
(dd=Kc.qOj(Ud.AH))?(Kc.cfa.createActivityIndicatorTooltip(Object.assign(new ba,{target:Ud.AH,container:dd,activityIds:[Ud.activityId],isSticky:Ud.isSticky,dirHint:Kc.gridView.rtl?12:9})),Ud.isSticky?(Kc.jka=Ud.AH,lb.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(Kc.Kdc=Ud.AH,lb.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),
Kc.jgc||(Kc.gridView.view.Ms(Kc.$Ac),Kc.gridView.ar(Kc.$Ac),Kc.jgc=!0)):lb.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};this.MIe=function(dd,Ud){Kc.j6b(Ud.Tfh)};this.$Ac=function(){Kc.cfa?(Kc.jka&&Kc.cfa.updateActivityIndicatorTooltip(Object.assign(new Q,{target:Kc.jka,isSticky:!0})),Kc.Kdc&&Kc.cfa.updateActivityIndicatorTooltip(Object.assign(new Q,{target:Kc.jka,isSticky:!1}))):lb.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};
this.$=ac;this.gridView=Tc.g(this.$);this.ha=this.gridView.ha;this.Ya=this.gridView.yc;this.ha.NYb(this.$k);this.ha.OG(this.nd);this.gridView.cE(this.lp);this.Ya.Yl(this.fj);this.jka=this.Kdc=null;this.jgc=!1;this.Bbd={}}function Q(){this.target=null;this.isSticky=!1}function la(){this.clearSticky=!1}function ba(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function T(){this.h2c=[];this.lKb={};this.ele={}}function H(ac,Kc,dd,Ud,Le){ac=S.call(this,ac,Kc,dd,Ud)||
this;ac.ranges=Le;ac.f7a=!1;return ac}function S(ac,Kc,dd,Ud){var Le=Db.call(this)||this;Le.$=ac;Le.u1d=Kc;Le.Dkg=dd;Le.VB=Ud;Le.state=0;return Le}function K(ac,Kc,dd){dd=qh.call(this,ac,Kc,dd)||this;dd.gridView=Tc.g(ac);dd.Kma=Kc;return dd}function da(ac){var Kc=this;this.BDb=function(){switch(Kc.Tu.model.state){case 1:Kc.z4f(!0);break;case 0:Kc.YKb(!1);break;case 2:case 3:Kc.YKb(!0);break;default:lb.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+
Kc.Tu.model.state)}};this.hqg=ac;this.Tu.sne(this.BDb);this.gN=[]}function fa(ac){this.Gi=ac}function X(ac){return Yd.call(this,ac)||this}function ca(ac,Kc){this.$=ac;this.catchUpActivityManager=Kc}function ja(){this.tb=null}function ea(ac){this.xu=ac}function qa(ac){this.Qtg=ac}function pa(ac){this.GXa=ac;this.Oae=new je.a}function Pa(ac,Kc,dd){this.Vsg=ac;this.RUa=Kc;this.gVa=dd}function Ha(ac,Kc){return rf.call(this,ac,Kc)||this}function Xa(ac,Kc){this.Tg=ac;this.xu=Kc}function Na(ac){var Kc=Ee.call(this)||
this;Kc.$=ac;Kc.dc();return Kc}function db(ac,Kc){var dd=this;this.hqd=!1;this.Mf=function(){dd.wag()};this.$=ac;se.EwaSettings.la(639)&&this.$.ea.W7a&&!db.Gwb&&(Kc&&!Kc.rdb||this.PWj(),db.W7e?lb.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):Kc&&!Kc.rdb||this.VWj());lb.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}function Ja(ac){var Kc=Gd.call(this)||this;
Kc.xi=null;Kc.eh=null;Kc.$=ac;Kc.dc();return Kc}function jb(ac,Kc,dd){var Ud=Ed.call(this,ac)||this;Ud.oe=null;Ud.bAe=null;Ud.FDb=null;Ud.Jpd=!0;Ud.Er=0;Ud.xp=!1;Ud.od=function(Le,ce){ce.Ng||Ud.k1c()};Ud.ak=function(){Ud.k1c();return!0};Ud.$=Kc;Ud.taskPaneManager=dd;Ud.$.vl(Ud.od);qd.a(Ud.$).Rg(Ud);ke.a.Kd(Ud.$)&&(Ud.isVisible=!1);return Ud}function hc(ac){var Kc=Ve.call(this)||this;Kc.lineageTaskPane=null;Kc.w7=null;Kc.$=ac;Kc.dc();return Kc}function ma(ac,Kc,dd,Ud){var Le=this;this.rtb=this.vF=
null;this.YD=this.xtd=0;this.FDb=function(){Le.w7&&(Le.w7.stop(),Le.w7=null);Le.OKb.start();Le.vF.createLineagePane(Le.std,Le.rtb)};this.lineageOpenPaneOrChangeFilterRequest=function(ce,Nf){function af(bf,Bf,$e){var He=Le.$.na.ta,vg=pg;bf=Wc.b(bf,Le.Gfd("LineageOpenPaneOrChangeFilter"));Bf=Wc.a(Bf,wf);var ah=He.Na(1,null);ah.clientParams=vf;ah.lineageFilter=vg;return oc.i(He,"LineageOpenPaneOrChangeFilter",ah,bf,Bf,$e,null,0)}function wf(bf){bf=wc.a.og(bf.data);lb.ULS.sendTraceTag(537155481,0,50,
"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",Sd.a.Tc(bf))}Le.OKb.stop();Yc.b(Le.$).ee(Vd.a.cPi,{});Le.$Cj();var vf=Object.assign(new ib,{ClientViewCapacity:ce.clientViewCapacity}),pg=null;Nf&&(pg=Object.assign(new vb,{FilterSheetMultiRange:Le.kNj(Nf.filterSheetMultiRange)}));se.EwaSettings.sc()?Le.$.userOperationManager.hc(new Wb.a(1010,0,af,80),null):Le.$.userOperationManager.hc(new tf.a(1010,0,af,16),null)};this.lineageLoadMoreRequest=function(ce){function Nf(wf,
vf,pg){var bf=Le.$.na.ta;wf=Wc.b(wf,Le.Gfd("LineageLoadMore"));vf=Wc.a(vf,af);var Bf=bf.Na(1,null);Bf.fetchFromBelow=ce;return oc.i(bf,"LineageLoadMore",Bf,wf,vf,pg,null,0)}function af(wf){wf=wc.a.og(wf.data);lb.ULS.sendTraceTag(537155480,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",Sd.a.Tc(wf))}Yc.b(Le.$).ee(Vd.a.bPi,{});se.EwaSettings.sc()?Le.$.userOperationManager.hc(new Wb.a(1011,0,Nf,80),null):Le.$.userOperationManager.hc(new tf.a(1011,0,Nf,16),null)};this.lineageRefreshViewRequest=
function(){function ce(af,wf,vf){var pg=Le.$.na.ta;af=Wc.b(af,Le.Gfd("LineageRefreshView"));wf=Wc.a(wf,Nf);var bf=pg.Na(1,null);return oc.i(pg,"LineageRefreshView",bf,af,wf,vf,null,0)}function Nf(af){af=wc.a.og(af.data);lb.ULS.sendTraceTag(537155479,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",Sd.a.Tc(af))}Yc.b(Le.$).ee(Vd.a.dPi,{});se.EwaSettings.sc()?Le.$.userOperationManager.hc(new Wb.a(1012,0,ce,80),null):Le.$.userOperationManager.hc(new tf.a(1012,0,ce,16),null)};
this.lineageUpdateViewRequest=function(){Dc(Le.$.na.ta,function(ce){if(ce=mc.a(ce)?null:ce.Result){var Nf={};Nf=(Nf.CountOfUpdatedActivities=ce.LineageActivitiesResponse.ActivityList.length,Nf);Yc.b(Le.$).ee(Vd.a.ePi,Nf);ce=Object.assign(new Ga,{activityList:Le.xFd(ce.LineageActivitiesResponse.ActivityList),latestActivityId:ce.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:ce.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:ce.LineageActivitiesResponse.LineageResponseCode,
lastSearchedActivityTimestamp:new Date(ce.LineageActivitiesResponse.EcmaLastSearchedDate),hasNewActivities:ce.HasNewActivities,filterSheetMultiRange:Le.aNj(ce.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:ce.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:ce.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:ce.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:ce.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(ce.LineageActivitiesResponse.EolDateHideHistory),
eolPersonHideHistory:Le.Bvb(ce.LineageActivitiesResponse.EolPersonHideHistory)});Le.vF.onLineageActivitiesUpdateResponse(ce)}else lb.ULS.shipAssertTag(537155475,0,!!ce,"LineageManager.LineageUpdateView returned null response.")},function(ce){ce=wc.a.og(ce.data);lb.ULS.sendTraceTag(537155474,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",Sd.a.Tc(ce))},null,null)};this.onCardSelected=function(ce,Nf){if(ce=ce.rangeHighlightLocation){if(Nf){var af=Bd.Z(Nf,null);var wf=af.range;
if(af.returnValue){Le.I9e(ce.sheetName,Le.Ivb([Bd.j(wf)]));return}lb.ULS.shipAssertTag(537155472,0,!1,"The produced subCellLocation string "+Nf+" is not valid.")}ce.rangeList.length?Le.I9e(ce.sheetName,ce.rangeList):Le.f8h(ce.sheetName)}};this.onLearnMoreLinkClicked=function(){if(se.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var ce=new Jd.a(-859308420,Ac.a.$b,Le.$.gd,12,null),Nf={};Nf=(Nf[Ac.a.Ug]="HelpID=XLO_LineageTS",Nf.InputMethod=Ac.a.$b,Nf[Ac.a.ld]=Zd.a.MZ,
Nf.ShouldCanvasTakeFocus=!0,Nf);Le.$.Ka.Xb(ce,Nf)}};this.onVersionHistoryButtonClicked=function(ce){Le.$.Ka.Xb(new Jd.a(-1112508866,ce,Le.$.gd,12,null))};this.isFeatureEnabled=function(){return!1};this.Mf=function(){var ce=Le.$.ea.Dm.LineageVersion;ce!==Le.xtd&&(lb.ULS.sendTraceTag(537155470,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",ce,Le.xtd),Le.xtd=ce,Le.E8i())};this.$c=function(ce,Nf){Le.vF&&!Le.lineageTaskPane.Egc&&Nf.FH&&(lb.ULS.sendTraceTag(587220563,
0,15,"LineageManager::SessionIdChanged detected."),Le.onStaleActivitiesDetected())};this.Hq=function(){Le.vF&&!Le.lineageTaskPane.Egc&&(lb.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),Le.onStaleActivitiesDetected())};this.ZC=function(){var ce=Le.n4a();Le.vF.onFilterableSheetListChange(ce)};this.Lya=function(){var ce=Le.n4a();Le.vF.onFilterableSheetListChange(ce)};this.noc=function(){var ce=Le.n4a();Le.vF.onFilterableSheetListChange(ce)};this.onPaneClosed=function(){Le.vF.onPaneClosed();
Mb(Le.$.na.ta,null,function(ce){ce=wc.a.og(ce.data);lb.ULS.sendTraceTag(537155469,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",Sd.a.Tc(ce))},null,null)};this.onRangeFilterInputEnabled=function(ce){ce?Le.gridView.ha.J2(Le.nd):Le.gridView.ha.qda(Le.nd)};this.nd=function(){var ce=Bd.q(Le.gridView.ha.va.activeRange,Le.$);ce=Object.assign(new ob,{rangeList:Le.Ivb(ce.Ranges),sheetName:ce.SheetName});Le.vF.onSelectedRangeUpdated(ce)};this.tryParseRangeInfo=function(ce){var Nf=
Bd.Z(ce,Le.$.xa);var af=Nf.sheetName;ce=Nf.range;return Nf.returnValue?(af||(af=Le.$.xa.pa.sheetName),Nf=[],Nf.push(ce),ce=Bd.u(af,null,Nf),Object.assign(new ob,{rangeList:Le.Ivb(ce.Ranges),sheetName:ce.SheetName})):null};this.zz=function(){var ce=Le.YD!==Le.$.ea.uf;Le.vF&&Le.lineageTaskPane.isVisible&&ce&&(Le.YD=Le.$.ea.uf,Le.vF.onRefreshRequired())};this.$=ac;Kc.Ha(366,this);this.gridView=Tc.g(this.$);this.lineageTaskPane=dd;this.std=this.lineageTaskPane.HM();this.batchSize=50;this.w7=Ud;this.OKb=
this.$.Vb.Wh("UserAction","LineagePaneLoadingShimmerStopWatch");this.Eqc=Re.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.Gbi();this.fBg()}function Ka(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}function Ta(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=
null;this.degradedCardTypeBits=0}function ob(){this.sheetName=this.rangeList=null}function Cb(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function eb(){this.logger=this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}function ya(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}function za(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=
this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=null}function Ga(){var ac=cb.call(this)||this;ac.hasNewActivities=!1;ac.filterSheetMultiRange=null;return ac}function cb(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;
this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function Mb(ac,Kc,dd,Ud,Le,ce){ce=ac.Na(1,void 0===ce?null:ce);return oc.i(ac,"LineageClosePane",ce,Kc,dd,Ud,Le,0)}function Dc(ac,Kc,dd,Ud,Le,ce){ce=ac.Na(1,void 0===ce?null:ce);return oc.i(ac,"LineageUpdateView",ce,Kc,dd,Ud,Le,0)}function vb(){}function ib(){}function ub(ac){var Kc=Qd.call(this)||this;Kc.$=ac;Kc.dc();return Kc}function Eb(ac){this.rdb=!0;Eb.Xcf()?Eb.edf()?(lb.ULS.sendTraceTag(526434368,0,50,"LineageCatchUpExperimentManager is running in hybrid mode. TUI exhausted: {0}",
!ac),this.rdb=ac):this.rdb=!1:this.rdb=!0}function Ya(ac){return Cd.call(this,ac)||this}function tb(ac,Kc){this.$=ac;this.lineageManager=Kc;ac=[new of.a(Sa.a.utd,1038647878,0,0,2175),new of.a(Sa.a.idle,1038647878,0,1)];rc.a(this.$).LHd(new Ec.a(Sa.a.ttd,Sa.a.idle,ac),new ec(Sa.a.utd,Sa.a.idle,Kc))}function ec(ac,Kc,dd){ac=ge.call(this,ac,Kc)||this;ac.lineageManager=dd;return ac}function Za(ac){var Kc=Sf.call(this)||this;Kc.$=ac;Kc.dc();return Kc}function mb(ac){return sd.call(this,ac)||this}function sc(ac){var Kc=
this;this.baseVersionInfo=this.C3=this.Ooa=this.nm=this.ewaAccessibilityManager=this.dNb=null;this.gId=this.Gsf=!1;this.eGe=!0;this.dialog=this.FB=this.TUe=this.rD=this.NZd=this.LZd=this.MZd=null;this.BCf=function(dd){lb.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(Kc.Szj()){var Ud=function(ce){zb.c(2138207060,!1);Kc.nm.setRestoreFailedAtServer(ce)};Kc.rD&&Kc.rD.startTimer(sc.a$f);var Le=function(){Kc.rD.endTimer(sc.a$f);Kc.txe(Kc.rD)};
Kc.nm.setRestoreInProgress();oe.a(Kc.$).kt(new Ke.a(Sa.a.fz,5,function(){var ce=rc.a(Kc.$).qd.activityState;ce[Wd.a.Yq]=Sa.a.lAe;ce[rb.a.tY]=!0;ce[rb.a.NT]=0;ce[ra.lgg]=dd;ce[ra.Mqc]=bb.AFrameworkApplication.mj;ce[ra.Gud]=Le;ce[P.S4f]=Ud}))}else zb.c(2138207060,!1)};this.nFf=function(dd){Kc.dNb.then(function(Ud){Ud.enterFocusTrapZone();return null});lb.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");Kc.rD.endTimer(sc.AVd);Kc.rD.incrementCounter(sc.b4g);lb.ULS.sendTraceTag(537150348,
0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",Kc.rD.getTimerDuration(sc.AVd));Kc.ahj(dd.containerDiv);dd.versions&&0<dd.versions.length&&(Kc.TUe=sc.bF(dd.versions[dd.versions.length-1]));Kc.C3&&Kc.Ooa&&Kc.nNd(Kc.C3);lb.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};this.onVersionSelected=function(dd){lb.ULS.sendTraceTag(537150345,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",
sc.bF(dd.currentVersion),sc.bF(Kc.C3));Kc.rD.incrementCounter(sc.a4g);Kc.C3=dd.currentVersion;Kc.baseVersionInfo=dd.baseVersion;Kc.Gsf=dd.noBaseToCompareTo;Kc.Ooa&&Kc.tWj()&&(Kc.nNd(dd.currentVersion),lb.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.fxf=function(dd){lb.ULS.sendTraceTag(537150337,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",(null===dd||void 0===dd?0:dd.versionSelected)?
sc.bF(dd.versionSelected.currentVersion):null,(null===dd||void 0===dd?0:dd.updatedVersions)?dd.updatedVersions.length:0,sc.bF(Kc.C3));Kc.rD.incrementCounter(sc.$3g);if(Kc.baseVersionInfo){if((null===dd||void 0===dd?0:dd.updatedVersions)&&2<=dd.updatedVersions.length){var Ud=null,Le=null,ce=sc.bF(Kc.C3),Nf=sc.bF(Kc.baseVersionInfo);dd=yl(dd.updatedVersions);for(var af=dd.next();!af.done;af=dd.next()){af=af.value;var wf=sc.bF(af);ce===wf?Ud=af:Nf===wf&&(Le=af);if(Ud&&Le)break}Ud&&Le?(Kc.C3=Ud,Kc.baseVersionInfo=
Le,lb.ULS.sendTraceTag(537150307,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",sc.bF(Kc.C3),sc.bF(Kc.baseVersionInfo)),Kc.nNd(Kc.C3)):lb.ULS.sendTraceTag(537150306,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",ce,Nf)}else lb.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");
lb.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else lb.ULS.sendTraceTag(537150336,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};this.fwf=function(){lb.ULS.sendTraceTag(537150303,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");Kc.PZg();var dd=new Jd.a(1470556788,0,Kc.$.gd,0,null);Kc.$.Ka.Xb(dd)};this.SCf=function(dd){lb.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");
var Ud=new Jd.a(-1244760097,0,Kc.$.gd,0,null);Kc.$.jg.get(51)&&(lb.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),Ud=new Jd.a(-309686558,0,Kc.$.gd,0,null));zb.c(1604651619,!0);var Le={};Kc.$.Ka.Xb(Ud,(Le.FileDownloadUrl=dd,Le))};this.gxf=function(dd){lb.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");dd=new Zc.QueryStringBuilder(dd);dd.Hi("fn",bb.AFrameworkApplication.fileName);lb.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+
dd.toString().length);8===Kc.$.frame.N8a(dd.toString(),!0)?(lb.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),zb.c(1316171850,!1)):zb.c(1316171850,!0)};this.Juf=function(dd){Kc.nm.setFullAppErrorCode(dd)};this.vyf=function(dd){switch(dd){case 101:dd="VHFailedToGetDownloadToken";break;case 100:dd="VHFailedToLoadVersionList";break;case 104:dd="VHVersioningNotEnabled";break;case 105:dd="VHFileNotFound";break;case 106:dd="VHVersionTooOld";break;default:dd="None"}Kc.rD.addEvent("OnFullAppError",
dd);lb.ULS.sendTraceTag(537150291,0,10,"FullApp Error Event: {0}",dd)};this.OBd=function(dd){Kc.eGe=dd;lb.ULS.sendTraceTag(537150290,0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",dd.toString());var Ud={};Kc.KNd(bc.a.HMb,(Ud.ToggleValue=dd,Ud))};this.Nzf=function(dd){lb.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",dd);zb.c(1488635506,!0);var Ud={};dd?Kc.KNd(bc.a.iterateNext,Ud):Kc.KNd(bc.a.pxa,Ud)};this.qGb=function(dd){switch(dd.MessageId){case Qb.a.hUa:lb.ULS.sendTraceTag(537150289,
0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");se.EwaSettings.la(436)&&Kc.nm.setVersionLoadComplete();break;case Qb.a.iUa:lb.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case bc.a.setCurrentChangeCount:dd=dd.Values.count;lb.ULS.sendTraceTag(537150288,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",dd);Kc.nm.setCurrentChangeCount(dd);break;case bc.a.setTotalChangesCount:dd=
dd.Values.count;lb.ULS.sendTraceTag(537150287,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",dd);Kc.nm.setTotalChangesCount(dd);break;case bc.a.ZOa:Kc.OBd(Kc.eGe);break;default:lb.ULS.sendTraceTag(537150286,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",dd.MessageId)}};this.$=ac;this.B8b=this.$.Ib+sc.Zyh;this.fId=!1;se.EwaSettings.la(397)&&this.eah();this.HAb="";this.Msd=0;this.perfTelemetryInfos=[]}function pd(){this.perfTelemetryInfos=
this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function $b(){this.appName=0;this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.disabledChangeGates=null;this.wdEnableDeleteVersions=
this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=null}function Xb(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=null}function lc(){this.rootDiv=this.appBootSettings=null}function Oa(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}function pb(ac){this.zw=ac}function Ub(ac){this.zw=ac}function ic(ac){this.zw=ac}function Jb(){}function cc(ac,Kc){this.$=ac;this.bXj=Kc}function Ob(ac,Kc){var dd=
Hb.call(this)||this;dd.activityName=ac;dd.JM=Kc;dd.dc();return dd}function P(ac,Kc){return Gc.call(this,ac,Kc)||this}function Ba(ac,Kc,dd){var Ud=Kb.call(this)||this;Ud.activityName=ac;Ud.JM=Kc;Ud.VJ=dd;Ud.dc();return Ud}function ra(ac,Kc,dd,Ud,Le){var ce=gb.call(this,ac,Kc)||this;ce.zi=null;ce.retryCount=0;ce.SRi=function(Nf){var af=ce.sOj(Nf);Nf=af.yLd;af.returnValue?Nf.Success?(zb.c(2138207060,!0),lb.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):
(zb.c(2138207060,!1),lb.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",Nf.Output),ce.vh(ce.VJ)):(zb.c(2138207060,!1),ce.vh(ce.VJ));(Nf=ce.zi.activityState[ra.Gud])&&Nf();ce.jp();ce.zi.JJ()};ce.QRi=function(){if(0<ce.retryCount)lb.ULS.sendTraceTag(537150418,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",ce.retryCount),ce.retryCount--,ce.tUf();else{lb.ULS.sendTraceTag(42287320,
0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");zb.c(2138207060,!1);ce.vh(ce.VJ);var Nf=ce.zi.activityState[ra.Gud];Nf&&Nf();ce.jp();ce.zi.JJ()}};ce.VJ=dd;ce.i3=Ud;ce.baseUrl=Le;return ce}b.r(F);var ta=b(10),Ia=b(0),bb=b(5),Va=b(214),lb=b(13),kc=b(110),zb=b(176),Sb=b(40),gb=kc.a;vm(ra,gb);ra.prototype.execute=function(ac){this.zi=ac;this.retryCount=3;this.tUf();return 1};ra.prototype.tUf=function(){var ac=this.zi.activityState[ra.Mqc],Kc=this.zi.activityState[ra.lgg],
dd=String.format("{0}{1}",this.baseUrl,"restoreversion.ashx");ac=Sb.c({VersionId:Kc,QuerySignature:ac});this.i3.Xl(dd,2,ac,{"Content-Type":"application/json; charset=utf-8"},!1,2,this.SRi,this.QRi,null)};ra.prototype.sOj=function(ac){var Kc=null;ac=ac?ac.data?ac.data.ie:null:null;if(!ac||!ac.length)return lb.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,yLd:Kc};ac=Sb.d(ac);Kc=ac.Ju;return ac.returnValue?
{returnValue:!0,yLd:Kc}:(lb.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),{returnValue:!1,yLd:Kc})};ra.lgg="RVAvi";ra.Mqc="RVAqs";ra.Gud="RVlvrt";Object(Ia.a)(ra,"RestoreVersionActivity",kc.a,[]);var Sa=b(6),Kb=Va.a;vm(Ba,Kb);Ba.prototype.create=function(){this.Fb(new ra(this.activityName,this.JM,this.VJ,bb.AFrameworkApplication.Jd,bb.AFrameworkApplication.sa.Qa.jW))};Ba.ja=function(ac){ac.da.Ha(320,new Ba(Sa.a.BLd,
Sa.a.rj,Sa.a.CLd))};Object(Ia.a)(Ba,"RestoreVersionActivityFactory",Va.a,[]);var Gc=kc.a;vm(P,Gc);P.prototype.execute=function(ac){var Kc=this;(0,ac.activityState[P.S4f])(function(){Kc.jp();ac.JJ()});return 1};P.S4f="RVEAssea";Object(Ia.a)(P,"RestoreVersionErrorActivity",kc.a,[]);var Hb=Va.a;vm(Ob,Hb);Ob.prototype.create=function(){this.Fb(new P(this.activityName,this.JM))};Ob.ja=function(ac){ac.da.Ha(321,new Ob(Sa.a.CLd,Sa.a.rj))};Object(Ia.a)(Ob,"RestoreVersionErrorActivityFactory",Va.a,[]);var Lb=
b(78),sa=b(817),Ua=b(56),Yb=b(35),jc=b(175),md=b(372),jd=b(52);cc.prototype.Yc=function(){return bb.AFrameworkApplication.ga.ra("IsAnonymousUser")?(lb.ULS.sendTraceTag(537150415,0,15,"Verison History Command Handler: Anonymous user."),!0):!1};cc.prototype.executeCommand=function(ac,Kc){lb.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");ac=!1;switch(Kc.command){case -1112508866:md.a(this.$)&&this.$.da.Aa(423).Fxc(!1),ac=this.bXj.lDj()}lb.ULS.sendTraceTag(537150413,
0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",ac);return ac?jd.Task.Ta(ac):jc.a(Kc.command)};cc.prototype.Jc=function(ac,Kc){return-1112508866===Kc.command&&this.$.isVersionHistoryEnabled()};cc.prototype.fd=function(){return!1};Object(Ia.a)(cc,"VersionHistoryCommandHandler",null,[188]);var Zc=b(277),Qb=b(170),fd=b(387),xd=b(23);Jb.addAppPLTEventToLog=function(ac){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(ac)}catch(Kc){}};Jb.setIsPageLoadForFirstTime=
function(ac){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(ac)}catch(Kc){}};Object(Ia.a)(Jb,"VersionHistoryLogConnector",null,[]);var Ad=b(961),Me=b(1247),Ue=b(148),Jd=b(92),Sd=b(27),se=b(1),oe=b(41),Ke=b(245),bc=b(1132),qd=b(255),zc=b(244),ld=b(11);ic.prototype.Rg=function(){qd.a(this.zw.$).aN(this.Zd)||qd.a(this.zw.$).Rg(this)};ic.prototype.Y7=function(){qd.a(this.zw.$).aN(this.Zd)&&qd.a(this.zw.$).Dz(this)};ic.prototype.Yf=function(ac){return ld.DOMElementExtensions.Oe(this.Jb,
ac)};ic.prototype.gi=function(){this.zw.$.frame.Se.ek(this.zw.$.frame.Se.zE)};ic.prototype.Qh=function(){};ic.prototype.Ne=function(ac,Kc){Kc||this.zw.dNb.then(function(dd){dd.enterHeaderFocusTrapZone();return null});return!Kc};Sk.Object.defineProperties(ic.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return zc.a.igg}},Jb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});
Object(Ia.a)(ic,"VersionHistoryHeader",null,[112]);Ub.prototype.Rg=function(){qd.a(this.zw.$).aN(this.Zd)||qd.a(this.zw.$).Rg(this)};Ub.prototype.Y7=function(){qd.a(this.zw.$).aN(this.Zd)&&qd.a(this.zw.$).Dz(this)};Ub.prototype.Yf=function(ac){return ld.DOMElementExtensions.Oe(this.Jb,ac)};Ub.prototype.gi=function(){this.zw.$.frame.Se.ek(this.zw.$.frame.Se.zE)};Ub.prototype.Qh=function(){};Ub.prototype.Ne=function(ac,Kc){Kc||this.zw.dNb.then(function(dd){dd.enterFocusTrapZone();return null});return!Kc};
Sk.Object.defineProperties(Ub.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return zc.a.jgg}},Jb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Ia.a)(Ub,"VersionHistoryPane",null,[112]);pb.prototype.Rg=function(){qd.a(this.zw.$).aN(this.Zd)||qd.a(this.zw.$).Rg(this)};pb.prototype.Y7=function(){qd.a(this.zw.$).aN(this.Zd)&&qd.a(this.zw.$).Dz(this)};
pb.prototype.Yf=function(ac){return ld.DOMElementExtensions.Oe(this.Jb,ac)};pb.prototype.gi=function(){this.zw.$.frame.Se.ek(this.zw.$.frame.Se.zE)};pb.prototype.Qh=function(){};pb.prototype.Ne=function(ac,Kc){Kc||this.zw.dNb.then(function(dd){dd.enterViewerFocusTrapZone();return null});return!Kc};Sk.Object.defineProperties(pb.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return zc.a.kgg}},Jb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Ia.a)(pb,"VersionHistoryViewer",null,[112]);var rb=b(136),Wd=b(247),rc=b(65),nd=b(417),me=b(889);Object(Ia.a)(Oa,"AppBootSettings",null,[]);Object(Ia.a)(lc,"AppVersionControllerFactoryParameters",null,[]);Object(Ia.a)(Xb,"OnVersionSelectedParams",null,[]);Object(Ia.a)($b,"AppSettings",null,[]);Object(Ia.a)(pd,"ControllerFactoryParameters",null,[]);sc.prototype.dispose=function(){this.bze()};sc.prototype.O_i=function(){var ac=
this;this.$.da.Za(15,function(Kc){ac.ewaAccessibilityManager=Kc;ac.ewaAccessibilityManager.mode=2})};sc.prototype.eah=function(){this.MZd=new Ub(this);this.LZd=new ic(this);this.NZd=new pb(this)};sc.prototype.lDj=function(){var ac=this;lb.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");bb.AFrameworkApplication.CK("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");bb.AFrameworkApplication.CK("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");
bb.AFrameworkApplication.CK("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");this.rD=excelVersionHistory.FactoryGlobal.getTelemetryCollector();this.perfTelemetryInfos=[];this.rD.startTimer(sc.$9f);if(!this.nm&&(nd.a(function(){ac.nm=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new pd,{ulsLogger:new fd.a,docId:bb.AFrameworkApplication.mj,appSettings:Object.assign(new $b,{appName:120,userSessionId:bb.AFrameworkApplication.userSessionId,
wdEnableSaveACopy:se.EwaSettings.la(365),wdEnableDownloadTokens:se.EwaSettings.la(360),wacCluster:bb.AFrameworkApplication.Jd.PS,uiLocale:bb.AFrameworkApplication.uiCulture||"en-us",wdEnableRestore:se.EwaSettings.la(331)&&ac.$.isEditMode,wdEnableIterator:se.EwaSettings.la(328)&&se.EwaSettings.la(329),useXhr:xd.a.mN,wdEnableHiddenButtonsUntilVersionLoadComplete:se.EwaSettings.la(436),disableSaveACopy:ac.r2f(),wdEnableShowVersionChanges:se.EwaSettings.la(328)&&se.EwaSettings.la(330),disabledChangeGates:ac.$.ya.VHSDisabledChangeGates,
wdEnableSaveACopyOverFlowMenu:se.EwaSettings.la(566),isRtl:bb.AFrameworkApplication.isRtl}),perfTelemetryInfos:ac.perfTelemetryInfos}))}),!this.nm))return lb.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),zb.c(429638140,!1),!1;this.mDj();this.rD.endTimer(sc.$9f);this.rD.startTimer(sc.c$f);lb.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");zb.c(429638140,
!0);return!0};sc.prototype.mDj=function(){this.cl();if(!document.getElementById(this.B8b)){var ac=document.createElement("div");ac.id=this.B8b;ac.style.width="100%";ac.style.height="100%";ac.style.zIndex="998";ac.style.display="block";ac.style.position="absolute";this.$.dr.insertBefore(ac,this.$.dr.firstChild);this.dNb=this.nm.createVersionHistoryDialog(ac)}document.getElementById(this.B8b).style.display="block";this.YHd();this.rD.startTimer(sc.AVd);this.nm.getVersions("")};sc.prototype.YHd=function(){se.EwaSettings.la(397)&&
(this.MZd.Rg(),this.LZd.Rg(),this.NZd.Rg(),this.O_i())};sc.prototype.CXd=function(){se.EwaSettings.la(397)&&(this.MZd.Y7(),this.LZd.Y7(),this.NZd.Y7(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};sc.prototype.cl=function(){this.nm.getVersionsReadyEvent().addListener(this.nFf);this.nm.getVersionSelectedEvent().addListener(this.onVersionSelected);this.nm.getCloseSelectedEvent().addListener(this.fwf);this.nm.getFullAppErrorEvent().addListener(this.vyf);this.nm.getIteratorSelectedEvent().addListener(this.Nzf);
this.nm.getShowVersionChangesToggledEvent().addListener(this.OBd);se.EwaSettings.la(360)&&(this.nm.getDownloadTokenReadyEvent().addListener(this.fxf),this.fId=!0);se.EwaSettings.la(365)&&(this.nm.getSaveACopySelectedEvent().addListener(this.SCf),this.nm.getDownloadVersionSelectedEvent().addListener(this.gxf));se.EwaSettings.la(331)&&this.$.isEditMode&&(this.nm.getRestoreVersionSelectedEvent().addListener(this.BCf),this.gId=!0);this.Ooa&&this.Ooa.getAppErrorEvent().addListener(this.Juf)};sc.prototype.un=
function(){this.nm.getVersionsReadyEvent().removeListener(this.nFf);this.nm.getVersionSelectedEvent().removeListener(this.onVersionSelected);this.nm.getCloseSelectedEvent().removeListener(this.fwf);this.nm.getFullAppErrorEvent().removeListener(this.vyf);this.nm.getIteratorSelectedEvent().removeListener(this.Nzf);this.nm.getShowVersionChangesToggledEvent().removeListener(this.OBd);se.EwaSettings.la(365)&&(this.nm.getSaveACopySelectedEvent().removeListener(this.SCf),this.nm.getDownloadVersionSelectedEvent().removeListener(this.gxf));
this.fId&&(this.nm.getDownloadTokenReadyEvent().removeListener(this.fxf),this.fId=!1);this.gId&&(this.nm.getRestoreVersionSelectedEvent().removeListener(this.BCf),this.gId=!1);this.Ooa&&this.Ooa.getAppErrorEvent().removeListener(this.Juf)};sc.prototype.Szj=function(){var ac=!0;if(se.EwaSettings.la(633)&&!this.$.iR)return lb.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+this.$.ea.amIAlone.toString()),!0;if(!this.$.ea.amIAlone&&!se.EwaSettings.la(327)){this.Fui();
this.nm.setCoauthRestoreError();ac=!1;var Kc=new Jd.a(-729359593,0,this.$.gd,0,null);this.$.Ka.Xb(Kc)}this.$.iR&&(lb.ULS.sendTraceTag(42522439,0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),ac&&(ac=!1,this.kDj()));return ac};sc.prototype.kDj=function(){var ac=Sd.a.hd(1,0,1851,1850,0,-1603358883,"RestoreVersionUnsavedChangesError");ac=this.dialog||new Ue.ErrorDialog(this.$,ac);ac.initialize();ac.mf()};sc.prototype.tWj=function(){lb.ULS.sendTraceTag(537150343,
0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.baseVersionInfo?sc.bF(this.baseVersionInfo):"");if(sc.bF(this.C3)===this.TUe)return lb.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(se.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.Gsf)return lb.ULS.sendTraceTag(537150341,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),
!0;if(!this.baseVersionInfo)return lb.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),!1;var ac=sc.$Oh(this.baseVersionInfo);lb.ULS.sendTraceTag(537150339,0,50,"downloadURL length {0}",ac?ac.length:0);return ac?!0:(lb.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)};sc.prototype.r2f=function(){return!this.$.Gka};sc.prototype.PZg=function(){document.getElementById(this.B8b).style.display=
"none";var ac=new Jd.a(-1423792966,0,this.$.gd,0,null);this.$.Ka.Xb(ac);this.bze()};sc.prototype.bze=function(){this.rD&&(this.rD.endTimer(sc.c$f),this.txe(this.rD),this.rD=null);this.un();this.CXd();this.perfTelemetryInfos&&(lb.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.FB&&(this.FB.Aoa(Qb.a.hUa),this.FB.Aoa(Qb.a.iUa),this.FB.Aoa(bc.a.setCurrentChangeCount),this.FB.Aoa(bc.a.setTotalChangesCount),se.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&
this.FB.Aoa(bc.a.ZOa),this.FB.dispose(),this.FB=null)};sc.prototype.ahj=function(ac){var Kc=this;try{this.Ooa?Jb.setIsPageLoadForFirstTime(!1):(Jb.setIsPageLoadForFirstTime(!0),nd.a(function(){var dd=new Oa;dd.ulsLogger=new fd.a;dd.actionUrl=Kc.$.ya.VersionHistoryActionUrl;dd.hideEmbedFooter=!0;dd.useFetch=se.EwaSettings.la(428)&&!xd.a.Vu;Kc.Ooa=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object.assign(new lc,{appBootSettings:dd,rootDiv:ac}))}))}catch(dd){lb.ULS.sendTraceTag(41239239,
0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",dd)}};sc.prototype.nNd=function(ac){lb.ULS.sendTraceTag(537150298,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",sc.bF(ac),this.HAb);if(ac)if(sc.bF(ac).length){var Kc=(new Date).getTime();if(sc.bF(ac)===this.HAb&&1E3>Kc-this.Msd)lb.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");else{sc.bF(ac)!==this.HAb&&(lb.ULS.sendTraceTag(537150294,
0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),this.nm.setTotalChangesCount(-1),this.nm.setCurrentChangeCount(-1));var dd=excelVersionHistory.FactoryGlobal.getTelemetryCollector();dd.addEvent("SelectVersion",sc.bF(ac));try{this.dZj(dd);this.Msd=Kc;this.HAb=sc.bF(ac);var Ud=new Xb;Ud.selectedVersionInfo=this.C3;Ud.baseVersionInfo=this.baseVersionInfo;Ud.telemetryCollector=dd;this.Ooa.onVersionSelectedWithParams(Ud);this.nm&&se.EwaSettings.la(365)&&this.nm.setDisableSaveACopy(this.r2f());
var Le=document.getElementById(sc.Yyh);Le&&!this.FB&&(lb.ULS.sendTraceTag(537150293,0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.FB=new bc.a(Le.contentWindow,Lb.a.Saa(this.$.ya.VersionHistoryActionUrl)||me.a.W9),this.FB.Kl(Qb.a.hUa,this.qGb),this.FB.Kl(Qb.a.iUa,this.qGb),this.FB.Zn(bc.a.setCurrentChangeCount),this.FB.Zn(bc.a.setTotalChangesCount),se.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.FB.Zn(bc.a.ZOa),
this.FB.Kl(bc.a.setCurrentChangeCount,this.qGb),this.FB.Kl(bc.a.setTotalChangesCount,this.qGb),se.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.FB.Kl(bc.a.ZOa,this.qGb))}catch(ce){this.Msd=0,this.HAb="",dd.addEvent("Exception",ce.toString()),lb.ULS.sendTraceTag(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",ce)}finally{lb.ULS.sendTraceTag(537150292,0,50,dd?dd.getJsonForLogging():"")}}}else lb.ULS.sendTraceTag(537150296,
0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");else lb.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};sc.prototype.dZj=function(ac){for(var Kc=yl(this.perfTelemetryInfos),dd=Kc.next();!dd.done;dd=Kc.next()){var Ud=dd.value;dd=Ud.TelemetryEventKey?Ud.TelemetryEventKey:Ud.telemetryEventKey?Ud.telemetryEventKey:"";Ud=Ud.TelemetryEventData?Ud.TelemetryEventData:Ud.telemetryEventData?Ud.telemetryEventData:"";dd&&Ud&&ac.addEvent(dd,
Ud)}Array.clear(this.perfTelemetryInfos)};sc.prototype.txe=function(ac){lb.ULS.sendTraceTag(42553886,0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",ac?ac.getJsonForLogging():"")};sc.prototype.Fui=function(){for(var ac=this.$.ea.km,Kc={},dd=null,Ud=yl(ac),Le=Ud.next();!Le.done;Le=Ud.next())Le=Le.value,Le.UserEmail&&(Kc[Le.UserEmail]=Le.UserEmail in Kc?Kc[Le.UserEmail]+1:1),Le.User.UserID===this.$.ea.clientId&&(dd=Le.UserEmail);lb.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",
ac.length,dd?Kc[dd]:-1)};sc.prototype.KNd=function(ac,Kc){lb.ULS.sendTraceTag(537150285,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",ac);if(this.FB){ac=new Ad.a(ac);ac.Values[Me.a.e5c]=this.$.ya.UserSessionId;if(Kc)for(var dd in Kc)ac.Values[dd]=Kc[dd];this.FB.send(ac)}else lb.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};sc.bF=function(ac){return ac?ac.RevisionID?ac.RevisionID:ac.revisionID?
ac.revisionID:"":""};sc.$Oh=function(ac){return ac?ac.DownloadUrl?ac.DownloadUrl:ac.downloadUrl?ac.downloadUrl:"":""};sc.Zyh="_excelVersionHistoryOverlay";sc.Yyh="vhs_frame";sc.$9f="TimeTakenShowVersionHistoryDialogAction";sc.c$f="TimeTillVersionHistoryDialogWasOpenMs";sc.AVd="TimeTakenGetVersionsToOnVersionsReady";sc.a4g="CountOnVersionSelectedCalledinOneVHSession";sc.b4g="CountOnVersionsReadyCalledinOneVHSession";sc.$3g="CountOnDownloadTokenReadyCalledinOneVHSession";sc.a$f="TimeTakenVersionRestore";
Object(Ia.a)(sc,"VersionHistoryPaneActor",null,[3]);var be=b(335),sd=sa.a;vm(mb,sd);mb.prototype.Od=function(){var ac=this,Kc=this.Qti(),dd=Ua.GetServiceTaskFactory.Wa(this.$.da,21,137,this.ub);Yb.TaskExtensions.Ba(Yb.TaskExtensions.ve([Kc,dd],this.ma,3),function(){var Ud=dd.result,Le=Lb.a.Saa(ac.$.ya.VersionHistoryActionUrl);Le!==me.a.W9&&Ud.vFa(Le);Ud=new sc(ac.$);ac.Fd([new cc(ac.$,Ud)])},this.ma,3)};mb.prototype.Qti=function(){var ac=Ua.GetServiceTaskFactory.Abc(this.$.da,283,284,this.ub).then(function(Kc){return Kc.Un.loadScript("excelVersionHistory")},
function(Kc){lb.ULS.sendTraceTag(537150412,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",Kc);return Promise.reject(Kc)});return be.c(ac)};mb.ja=function(ac){sa.a.fe(304,new mb(ac))};Object(Ia.a)(mb,"VersionHistoryCommandHandlerFactory",sa.a,[]);var Qe=b(1250),Sf=Va.a;vm(Za,Sf);Za.prototype.create=function(){var ac=this,Kc=Ua.GetServiceTaskFactory.Wa(this.$.da,211,212,this.ub),dd=Ua.GetServiceTaskFactory.Wa(this.$.da,21,137,this.ub);Yb.TaskExtensions.Ba(Yb.TaskExtensions.ve([Kc,
dd],this.$.ma),function(){ac.Fb(ac.$.da.Aa(305)||new Qe.a(ac.$,!0,dd.result,Kc.result))},this.$.ma,3)};Za.ja=function(ac){ac.da.Ha(306,new Za(ac))};Object(Ia.a)(Za,"VersionHistoryHighlightManagerFactory",Va.a,[]);var mf=b(516),Zd=b(4),ie=b(153),kd=b(14),ge=kc.a;vm(ec,ge);ec.prototype.execute=function(ac){this.lineageManager.lineageHidePreviousHistory();return ge.prototype.execute.call(this,ac)};Object(Ia.a)(ec,"LineageClearHistoryConfirmedActivity",kc.a,[]);var of=b(15),Ec=b(133);tb.prototype.Yc=
function(){return!1};tb.prototype.executeCommand=function(ac,Kc,dd){ac=!1;switch(Kc.command){case 1834994092:9===Kc.af&&this.FIj();this.FAj(Kc,dd);ac=!0;break;case -409942531:this.HAj(),ac=!0}return ac?jd.Task.Ta(!0):jc.a(Kc.command)};tb.prototype.Jc=function(ac,Kc){return 1834994092===Kc.command||-409942531===Kc.command};tb.prototype.fd=function(){return!1};tb.prototype.FAj=function(ac,Kc){lb.ULS.sendTraceTag(537155483,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",Kc.MenuItemId||
ac.af);this.lineageManager.n4f(19===ac.af&&!!Kc.MenuItemId,Kc.MenuItemId,ac.af)};tb.prototype.FIj=function(){var ac=Zd.a.brc;ac!==ie.a(this.$).Im.Do&&ie.a(this.$).Im.activateRibbonTab(ac)};tb.prototype.HAj=function(){var ac=this;oe.a(this.$).kt(new Ke.a(Sa.a.ttd,5,function(){var Kc=rc.a(ac.$).qd,dd=Sd.a.hd(3,1,2172,2173,2174,1038647878,"LineageConfirmClearHistory");dd.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";dd.HelpDescription=kd.a.instance.fa(1276);Kc.At([dd])}))};Object(Ia.a)(tb,"LineageActivityCommandHandler",
null,[188]);var Cd=sa.a;vm(Ya,Cd);Ya.prototype.Od=function(){var ac=this;Yb.TaskExtensions.Ba(Ua.GetServiceTaskFactory.Wa(this.$.da,366,367,this.ub),function(Kc){ac.Fd([new tb(ac.$,Kc.result)])},this.ma,3)};Ya.ja=function(ac){sa.a.fe(363,new Ya(ac))};Object(Ia.a)(Ya,"LineageActivityCommandHandlerFactory",sa.a,[]);Eb.prototype.v6a=function(){return!this.rdb};Eb.edf=function(){return Eb.Xcf()&&se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)};Eb.Xcf=function(){return se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)};Object(Ia.a)(Eb,"LineageCatchUpExperimentManager",null,[608]);var Qd=Va.a;vm(ub,Qd);ub.prototype.create=function(){var ac=this;Eb.edf()?Yb.TaskExtensions.Ba(Ua.GetServiceTaskFactory.Wa(this.$.da,456,457,this.ub),function(Kc){Yb.TaskExtensions.Ba(Kc.result.izj(),function(dd){ac.bEe(dd.result)},ac.$.ma,3)},this.$.ma,3):this.bEe(!0)};ub.prototype.bEe=function(ac){this.Fb(this.$.da.Aa(458)||
this.$.da.Ha(458,new Eb(ac)))};ub.ja=function(ac){ac.da.Ha(459,new ub(ac))};Object(Ia.a)(ub,"LineageCatchUpExperimentManagerFactory",Va.a,[]);var od=b(412),ke=b(39),Re=b(86),lf=b(151),vc=b(116);Object(Ia.a)(ib,"LineageClientParams",null,[]);Object(Ia.a)(vb,"LineageFilter",null,[]);var hd=b(61),Ac=b(77),Vd=b(126),Bd=b(43),tf=b(521),Wb=b(164),wc=b(114),yb=b(106),mc=b(303),Wc=b(272),Nd=b(105),Tc=b(20),Yc=b(127),oc=b(81),ze=b(48),Ae=b(337);Object(Ia.a)(cb,"LineageActivitiesResponseDTO",null,[]);vm(Ga,
cb);Object(Ia.a)(Ga,"LineageActivitiesUpdateResponseDTO",cb,[]);Object(Ia.a)(za,"LineageAppCallbacks",null,[]);Object(Ia.a)(ya,"LineageAuthorDTO",null,[]);Object(Ia.a)(eb,"LineageControllerFactoryParams",null,[]);Object(Ia.a)(Cb,"LineageSharedRangeDTO",null,[]);Object(Ia.a)(ob,"LineageSheetMultiRangeDTO",null,[]);Object(Ia.a)(Ta,"LineageUserActivityDTO",null,[]);Object(Ia.a)(Ka,"LineageValueChangeDTO",null,[]);ma.prototype.dispose=function(){this.yaj();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.lO(this.onPaneClosed),
this.lineageTaskPane.nD(this.zz),this.lineageTaskPane=null);this.OKb=this.Eqc=this.rtb=this.std=this.vF=null};ma.prototype.n4f=function(ac,Kc,dd){if(this.lineageTaskPane.isVisible){if(9===dd){lb.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!ac&&16!==dd&&18!==dd){this.lineageTaskPane.k1c();return}}ke.a.Kd(this.$)||(this.OKb.start(),this.w7&&(ze.b().XB(this.OKb.id,this.w7.id,"actions","actions"),this.w7.stop(),this.w7=
null));this.lineageTaskPane.Egc||lb.ULS.sendTraceTag(537155482,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",ac?Kc:dd);this.YD=this.$.ea.uf;this.rtb=null;ac&&(ac=Bd.r(this.gridView.ha.va.selectedRanges,this.$),this.rtb=Object.assign(new ob,{rangeList:Kc.toString()===Zd.a.H3f?this.Ivb(ac.Ranges):null,sheetName:ac.SheetName}));ke.a.Kd(this.$)&&this.lineageTaskPane.Egc?this.lineageTaskPane.wsj(this.FDb):this.vF.createLineagePane(this.std,this.rtb);this.lineageTaskPane.Nf(!0);
this.$.xe(-71295319,-1,0,null)};ma.prototype.lineageHidePreviousHistory=function(){function ac(Ud,Le,ce){var Nf=Kc.$.na.ta,af=Nf.Na(1,null);return oc.i(Nf,"LineageHidePreviousHistory",af,Ud,Le,ce,null,0)}var Kc=this,dd={};dd=(dd.paneVisible=this.lineageTaskPane.isVisible,dd);lf.a.sendTelemetryEvent(Object.assign(new Ae.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:vc.a.Rk(dd)}));se.EwaSettings.sc()?this.$.userOperationManager.hc(new Wb.a(1018,0,ac,64),null):this.$.userOperationManager.hc(new tf.a(1018,
0,ac,0),null);this.lineageTaskPane.isVisible||this.n4f(!1,null,4)};ma.prototype.Gbi=function(){var ac=this,Kc=Object.assign(new za,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,
lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest});nd.a(function(){ac.vF=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object.assign(new eb,{clientBatchSize:ac.batchSize,filterableSheetList:ac.n4a(),uiCulture:ac.$.ya.UICultureTag,dataCulture:ac.$.ya.DataCultureTag,logger:new fd.a,lineageAppCallbacks:Kc}))})};ma.prototype.Gfd=function(ac){var Kc=this;return function(dd){if(dd=mc.a(dd)?null:dd.Result){var Ud=
{};Ud=(Ud.CountOfActivities=dd.ActivityList.length,Ud);Ud.WebRequestName=ac;Yc.b(Kc.$).ee(Vd.a.EMi,Ud);dd=Object.assign(new cb,{activityList:Kc.xFd(dd.ActivityList),latestActivityId:dd.LastSearchedActivityId,oldestActivityId:dd.FirstSearchedActivityId,serverMessageCode:dd.LineageResponseCode,lastSearchedActivityTimestamp:new Date(dd.EcmaLastSearchedDate),serverFirstActivityId:dd.ServerFirstActivityId,serverLastActivityId:dd.ServerLastActivityId,showLoadPrevious:dd.ShowLoadPrevious,eolCorrelationId:dd.EolCorrelationId,
eolDateHideHistory:new Date(dd.EolDateHideHistory),eolPersonHideHistory:Kc.Bvb(dd.EolPersonHideHistory)});Kc.vF.onLineageActivitiesResponse(dd)}else lb.ULS.shipAssertTag(537155477,0,!!dd,"LineageManager."+ac+" returned null response.")}};ma.prototype.aNj=function(ac){return yb.e(ac.Ranges)&&!ac.SheetName?null:Object.assign(new ob,{rangeList:this.Ivb(ac.Ranges),sheetName:ac.SheetName})};ma.prototype.Ivb=function(ac){var Kc=[];ac=yl(ac);for(var dd=ac.next();!dd.done;dd=ac.next())dd=dd.value,dd=Object.assign(new Cb,
{firstCol:dd.FirstColumn,firstRow:dd.FirstRow,lastRow:dd.LastRow,lastCol:dd.LastColumn}),Kc.push(dd);return Kc};ma.prototype.kNj=function(ac){if(!ac)return null;var Kc={};Kc.Ranges=this.Fgd(ac.rangeList);Kc.SheetName=ac.sheetName;return Kc};ma.prototype.Fgd=function(ac){var Kc=[];if(yb.e(ac))return Kc;ac=yl(ac);for(var dd=ac.next();!dd.done;dd=ac.next()){dd=dd.value;var Ud={};Ud.FirstColumn=dd.firstCol;Ud.FirstRow=dd.firstRow;Ud.LastRow=dd.lastRow;Ud.LastColumn=dd.lastCol;Kc.push(Ud)}return Kc};ma.prototype.f8h=
function(ac){(ac=this.$.xa.getItemByName(ac))&&ac.visible&&ac.activate(!0)};ma.prototype.I9e=function(ac,Kc){var dd=[];Kc=yl(Kc);for(var Ud=Kc.next();!Ud.done;Ud=Kc.next()){Ud=Ud.value;var Le={};Le.FirstColumn=Ud.firstCol;Le.FirstRow=Ud.firstRow;Le.LastRow=Ud.lastRow;Le.LastColumn=Ud.lastCol;dd.push(Bd.D(Le))}Kc=dd.length-1;Ud=dd[Kc].topLeft;Tc.g(this.$).wV(dd,Kc,ac,null,Ud,null,null,3,Nd.a.Usi,void 0,void 0,void 0,!0)};ma.prototype.E8i=function(){this.vF&&this.lineageTaskPane.isVisible&&(this.YD=
this.$.ea.uf,this.vF.onRefreshRequired())};ma.prototype.fBg=function(){this.lineageTaskPane.qM(this.onPaneClosed);this.lineageTaskPane.YB(this.zz);this.$.ea.Dt(this.Mf);this.$.ea.Uj(this.$c);this.$.ea.RP(this.Hq);var ac=this.$.xa;ac.vY(this.ZC);ac.$ga(this.noc);ac.EFa(this.Lya);ac.JYa(this.noc)};ma.prototype.yaj=function(){this.$.ea.Ew(this.Mf);this.gridView.ha.qda(this.nd);this.$.ea.lk(this.$c);this.$.ea.QW(this.Hq);var ac=this.$.xa;ac.a7(this.ZC);ac.Tma(this.noc);ac.vQa(this.Lya);ac.mHb(this.noc)};
ma.prototype.onStaleActivitiesDetected=function(){this.vF.onStaleActivitiesDetected()};ma.prototype.n4a=function(){for(var ac=[],Kc=yl(this.$.xa.items),dd=Kc.next();!dd.done;dd=Kc.next())dd=dd.value,dd.visible&&!hd.e(dd)&&ac.push(dd.sheetName);return ac};ma.prototype.$Cj=function(){if(se.EwaSettings.la(639)){var ac=this.$.da.Aa(403);ac&&ac.disable();ac=new Jd.a(-847286761,Ac.a.$b,this.$.gd,0,Zd.a.g0);var Kc={};Kc=(Kc.InputMethod=Ac.a.$b,Kc);Kc.CalloutName=5;this.$.Ka.Xb(ac,Kc)}};ma.prototype.xFd=
function(ac){var Kc=[];ac=yl(ac);for(var dd=ac.next();!dd.done;dd=ac.next())dd=dd.value,dd=Object.assign(new Ta,{activityId:Number.parseLocale(dd.UserActivity.Id),activityGuid:dd.Uid,activityType:dd.UserActivity.Type,author:this.Bvb(dd.UserActivity.Person),sheetName:dd.SheetName,displayTimestamp:new Date(dd.UserActivity.DisplayTimestamp),gridLocation:dd.DisplayLocation,valueChanges:this.W2i(dd.LineageValueChangeList),isBulkEditOverflow:dd.IsBulkEditOverFlow,rangeHighlightLocation:this.K2i(dd.UserActivity.LocationList,
dd.UserActivity.Type),nestedActivityList:this.D2i(dd.NestedActivityList),degradedCardTypeBits:dd.DegradedCardTypeBits}),Kc.push(dd);return Kc};ma.prototype.K2i=function(ac,Kc){if(!ac)return lb.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!ac.length)return lb.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var dd=[],Ud=[],Le="";21===Kc?Ud.push(ac[0]):Ud=ac;ac=yl(Ud);for(Ud=
ac.next();!Ud.done;Ud=ac.next())switch(Ud=Ud.value,Ud.Type){case 1:break;case 2:Le=Ud.SheetName;break;case 0:if(!Ud.RangeList){lb.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}Le=Ud.RangeList[0].SheetName;var ce=[];21===Kc?ce.push(Ud.RangeList[0]):ce=Ud.RangeList;Ud=yl(ce);for(ce=Ud.next();!ce.done;ce=Ud.next())ce=ce.value,ce=Object.assign(new Cb,{firstCol:ce.FirstColumn,firstRow:ce.FirstRow,lastRow:ce.LastRow,lastCol:ce.LastColumn}),
dd.push(ce);break;default:lb.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",Ud.Type)}return Object.assign(new ob,{sheetName:Le,rangeList:dd})};ma.prototype.W2i=function(ac){var Kc=[];ac=yl(ac);for(var dd=ac.next();!dd.done;dd=ac.next())dd=dd.value,dd=Object.assign(new Ka,{hasNewValue:dd.HasNewValue,hasOldValue:dd.HasOldValue,newValue:dd.HasNewValue?dd.NewValue:null,oldValue:dd.HasOldValue?dd.OldValue:null,cellLocation:dd.CellLocation}),
Kc.push(dd);return Kc};ma.prototype.D2i=function(ac){return ac?this.xFd(ac):null};ma.prototype.Bvb=function(ac){if(!ac)return null;var Kc=null;se.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&bb.AFrameworkApplication.ga.ra("IsUserProfilePictureResolutionEnabled")&&(Kc=this.Eqc.KHa(ac.Email,ac.Provider,bb.AFrameworkApplication.mj,0));return Object.assign(new ya,{id:ac.Id,provider:ac.Provider,displayName:ac.DisplayName,email:ac.Email,imageUrl:Kc})};
Object(Ia.a)(ma,"LineageManager",null,[610,3]);var Ve=Va.a;vm(hc,Ve);hc.prototype.Ati=function(ac){var Kc=this;Yb.TaskExtensions.Ba(ac,function(){Kc.Fb(Kc.$.da.Aa(366)||new ma(Kc.$,Kc.$.da,Kc.lineageTaskPane,Kc.w7))},this.$.ma,3)};hc.prototype.create=function(){var ac=this;this.w7=this.$.Vb.Hc("UserAction","LineagePaneSeenStopwatch");this.w7.start();var Kc=Ua.GetServiceTaskFactory.Wa(this.$.da,365,364,this.ub),dd=od.a(this.$),Ud=Ua.GetServiceTaskFactory.Wa(this.$.da,283,284,this.ub);Yb.TaskExtensions.Ba(Yb.TaskExtensions.ve([Kc,
dd,Ud],this.$.ma),function(){ac.lineageTaskPane=Kc.result;ke.a.Kd(ac.$)||dd.result.gR(ac.lineageTaskPane);ac.Ati(be.c(Ud.result.Un.loadScript("cellLineage")))},this.$.ma,3)};hc.ja=function(ac){ac.da.Ha(367,new hc(ac))};Object(Ia.a)(hc,"LineageManagerFactory",Va.a,[]);var nb=b(923),Hc=b(275),Cc=b(12),Sc=b(117),Uc=b(274),ae=b(91),ue=b(230),Lf=b(16),xf=b(826),Rf=b(63),dc=Zd.a.wzc+"LineageActivityPaneTitle",Oc=Zd.a.Tdb+"LineageActivityCloseButton",Ed=ue.a;vm(jb,Ed);jb.prototype.MG=function(ac){this.get_events().addHandler("LineageTaskPaneRemove",
ac)};jb.prototype.pI=function(ac){this.get_events().removeHandler("LineageTaskPaneRemove",ac)};jb.prototype.YB=function(ac){this.addHandler("LineageTaskPaneVisibilityChanged",ac)};jb.prototype.nD=function(ac){this.removeHandler("LineageTaskPaneVisibilityChanged",ac)};jb.prototype.qM=function(ac){this.get_events().addHandler("LineageTaskPaneClose",ac)};jb.prototype.lO=function(ac){this.get_events().removeHandler("LineageTaskPaneClose",ac)};jb.prototype.kw=function(){};jb.prototype.qC=function(){};
jb.prototype.jn=function(){return this.xp};jb.prototype.Wp=function(){return this.xp};jb.prototype.JF=function(){};jb.prototype.xH=function(){return!1};jb.prototype.gi=function(){};jb.prototype.Qh=function(){};jb.prototype.dispose=function(){this.$&&(this.$.sn(this.od),qd.a(this.$).Dz(this));this.oe&&(Hc.a.instance.za(Cc.a.click,this.oe,this.ak),Sc.KeyInputManager.instance.vv(this.oe,this.bAe));this.oe=this.taskPaneManager=this.$=null;Ed.prototype.dispose.call(this)};jb.prototype.Ne=function(ac,Kc){if(!Kc){ac=
ld.DOMElementExtensions.getElementById(this.domElement,"LineagePaneFilterButton");if(!ac)return!1;ld.DOMElementExtensions.setFocus(ac)}return!Kc};jb.prototype.Yf=function(ac){return ld.DOMElementExtensions.Oe(this.Jb,ac)};jb.prototype.Nf=function(ac){this.xp=ac;var Kc=this.taskPaneManager;if(this.isVisible=ac)this.$.frame.Se.Rj("LineagePane"),this.Jpd=!1;if(ke.a.Kd(this.$))ac?Kc.aS("LineageTaskPane",this.JI):Kc.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.rp();var dd=!!this.taskPaneManager.Bg&&
15===this.taskPaneManager.Bg.taskPane.wg;ac&&0<Kc.Lz.length&&(!dd||Kc.isCollapsed)&&Kc.oD(this,!0)}this.$.If()};jb.prototype.HM=function(){var ac=this.$.Ib;ac=ke.a.Kd(this.$)?this.domElement:document.getElementById(ac+Zd.a.wtd);var Kc=this.YG();ac.appendChild(Kc);Kc=xf.b("div","LineagePaneBodyId","LineageActivityBody");ac.appendChild(Kc);this.xsj();return Kc};jb.prototype.k1c=function(){this.$.frame.Se.Rj(this.$.frame.Se.zE||Uc.AFrame.dU);this.Jpd=!0;this.Nf(!1);this.raiseEvent("LineageTaskPaneClose")};
jb.prototype.wsj=function(ac){this.FDb=ac};jb.prototype.xsj=function(){this.$.frame.Se.ek("LineagePane");var ac=this.$.frame.Se.Bi("LineagePane");ac.parent=Uc.AFrame.dU;ac.yR=!0};jb.prototype.YG=function(){var ac=xf.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),Kc=xf.b("h1","LineagePaneTitleId",dc);Kc.innerText=this.titleText;this.oe=nb.a.Bb("LineagePaneCloseButtonId",Oc,kd.a.instance.fa(10),"ClosePaneGlyph_16x16x32",!1);this.oe.classList.add(bb.AFrameworkApplication.isRtl?Zd.a.Caa:Zd.a.Daa);
Hc.a.instance.qa(Cc.a.click,this.oe,this.ak);this.bAe=Sc.KeyInputManager.instance.ps(this.oe,this.ak,ae.a.$h);ac.appendChild(Kc);ac.appendChild(this.oe);return ac};jb.ja=function(ac,Kc){var dd=ac.Ib,Ud=document.getElementById(dd+Zd.a.wtd);Ud||(Ud=document.createElement("div"),Ud.id=ac.Ib+Zd.a.wtd,Ud.classList.add("LineageActivityPane"),ke.a.Kd(ac)||document.getElementById(dd+Zd.a.VR).appendChild(Ud));return ac.da.Aa(365)||ac.da.Ha(365,new jb(Ud,ac,Kc))};Sk.Object.defineProperties(jb.prototype,{isVisible:{configurable:!0,
enumerable:!0,get:function(){return Object(Rf.a)(jb.prototype,this,"isVisible")},set:function(ac){Object(Rf.a)(jb.prototype,this,"isVisible")!==ac&&(Object(Rf.b)(jb.prototype,this,"isVisible",ac),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},Egc:{configurable:!0,enumerable:!0,get:function(){return this.Jpd}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},wg:{configurable:!0,enumerable:!0,get:function(){return 15}},Zd:{configurable:!0,enumerable:!0,get:function(){return zc.a.Vsi}},
Nj:{configurable:!0,enumerable:!0,get:function(){return Lf.a.lwh}},JC:{configurable:!0,enumerable:!0,get:function(){return kd.a.instance.fa(1030)}},Hl:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.BL.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return kd.a.instance.fa(1251)}},
JI:{configurable:!0,enumerable:!0,get:function(){var ac=this;return this.taskPaneManager.Wua(this.Jb,this.titleText,this.Hl,this.isResizable,function(){ac.isVisible=!0;ac.FDb?ac.FDb():lb.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set.")},function(){ac.isVisible=!1},function(){ac.isVisible=!0},function(){ac.isVisible=!1},this.Hl)}}});Object(Ia.a)(jb,"LineageTaskPane",ue.a,[609,3,253,112]);var Gd=Va.a;vm(Ja,Gd);Ja.prototype.create=function(){var ac=this,Kc=Ua.GetServiceTaskFactory.create(this.$.da,
203,this.ma,this.ub),dd=Ua.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub);Yb.TaskExtensions.Ba(Yb.TaskExtensions.ts(Yb.TaskExtensions.ve([Kc,dd],this.ma),function(){return ac.cD},this.ma),function(){ac.Fb(ac.eh)},this.ma,3)};Ja.prototype.dispose=function(){this.eh=this.xi=this.$=null;Gd.prototype.dispose.call(this)};Ja.ja=function(ac){ac.da.Ha(364,new Ja(ac))};Sk.Object.defineProperties(Ja.prototype,{cD:{configurable:!0,enumerable:!0,get:function(){var ac=this;this.xi||(this.xi=Yb.TaskExtensions.Ba(od.a(this.$),
function(Kc){ac.eh=jb.ja(ac.$,Kc.result)},this.ma,3));return this.xi}}});Object(Ia.a)(Ja,"LineageTaskPaneFactory",Va.a,[]);db.prototype.dispose=function(){this.KId();this.$=null;lb.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};db.prototype.disable=function(){db.Gwb||(db.Gwb=!0,lb.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.KId()};db.prototype.VWj=function(){var ac=this;se.EwaSettings.la(635)&&
!this.$.isAnonymousUser()&&oc.l(this.$.na.ta,function(Kc){ac.$?(Kc=Kc.Result,lb.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",Kc),db.W7e=!0,Kc&&ac.lag(0)):lb.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){lb.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)};db.prototype.PWj=function(){se.EwaSettings.la(634)&&
!this.wag()&&(this.$.ea.Dt(this.Mf),this.hqd=!0)};db.prototype.wag=function(){return this.$.ea&&this.$.ea.Dm&&this.$.ea.Dm.ShouldTriggerLineageCalloutOnMerge?(lb.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.lag(1),!0):!1};db.prototype.lag=function(ac){if(db.Gwb)lb.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(db.Gwb=!0,lb.ULS.sendTraceTag(578557776,
0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",ac),this.KId(),se.EwaSettings.la(501)){ac=new Jd.a(-847286761,Ac.a.$b,this.$.gd,0,Zd.a.g0);var Kc={};Kc=(Kc.CalloutName=4,Kc);this.$.Ka.Xb(ac,Kc)}};db.prototype.KId=function(){this.hqd&&(this.hqd=!1,this.$.ea.Ew(this.Mf))};db.Gwb=!1;db.W7e=!1;Object(Ia.a)(db,"LineageTeachingCalloutTriggerManager",null,[606,3]);var Ee=Va.a;vm(Na,Ee);Na.prototype.create=function(){var ac=this;Yb.TaskExtensions.Ba(Ua.GetServiceTaskFactory.Wa(this.$.da,
458,459,this.ub),function(Kc){Kc=new db(ac.$,Kc.result);ac.Fb(Kc)},this.$.ma,3)};Na.ja=function(ac){ac.da.Ha(402,new Na(ac))};Object(Ia.a)(Na,"LineageTeachingCalloutTriggerManagerFactory",Va.a,[]);var ee=b(1020),hf=b(71);Xa.prototype.fX=function(ac,Kc,dd,Ud){var Le=this;return this.qhh(ac,void 0===Ud?null:Ud,function(ce){return Le.Tg.CYb(ce,2,dd,Kc,void 0,void 0,void 0,void 0,void 0,"2")})};Xa.prototype.qhh=function(ac,Kc,dd){var Ud=this,Le=!!Kc&&""!==Kc,ce=ac;Le&&(ce=Lb.a.VT(ac,"perfTag",Kc));var Nf=
new Date;return ee.a.then(dd(ce),function(af){var wf=+new Date-+Nf;if(!af||!af.Bh||!af.Bh.data)return af;Le&&af.Bh.data.request&&Ud.Aoj(af.Bh.data.request.getResolvedUrl(),Kc,wf);return af})};Xa.prototype.Aoj=function(ac,Kc,dd){ac=this.xu.JXh(ac);if(ac.count&&(ac=hf.last(ac))){var Ud={Message:"Request durations for activities calls."};Ud.PerfTag=Kc;Ud.CustomDuration=dd;Ud.PerformanceDuration=ac.duration;lb.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Ud))}};Object(Ia.a)(Xa,"CatchUpNetworkingWrapper",
null,[688]);var kf=b(242),rf=kf.a;vm(Ha,rf);Ha.prototype.wja=function(){return 6};Object(Ia.a)(Ha,"GetActivityFeedRequest",kf.a,[]);var ng=b(388);Pa.prototype.getActivityFeed=function(ac){return this.zJh(ac)};Pa.prototype.zJh=function(ac){var Kc=this;return ee.a.then(this.gVa.execute(new Ha(this.RUa(),null),function(dd,Ud,Le){return Kc.Vsg.fX(dd,Ud,Le,"ActivityFeed")},ac),function(dd){if(!dd)return lb.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeed: Response is null"),null;if(!dd.Bh)return lb.ULS.sendTraceTag(572846938,
3012,10,"GetActivityFeed: Response.Args is null"),null;if(!dd.Bh.data)return lb.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeed: Response.Args.Data is null"),null;if(!dd.Bh.data.ie)return lb.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeed: Response.Args.Data.ResponseData is null"),null;dd=ng.a.jIa(dd.Bh.data.ie);return dd?dd:(lb.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeed: Deserialized response is null"),null)})};Object(Ia.a)(Pa,"CatchUpRequestHandler",null,[689]);var je=b(476);pa.prototype.Dui=
function(){this.nvi()};pa.prototype.nvi=function(){var ac=this;this.GXa?this.GXa.execute(function(Kc){window.setTimeout(function(){ac.Oae.contains("CatchUpChangesFeedback")||(ac.Oae.add("CatchUpChangesFeedback"),Kc.logActivity("CatchUpChangesFeedback",null))},2E4)}):lb.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};Object(Ia.a)(pa,"FloodgateEventLogger",null,[]);var bg=b(184);Sk.Object.defineProperties(qa.prototype,{duration:{configurable:!0,
enumerable:!0,get:function(){return this.Qtg.duration}}});Object(Ia.a)(qa,"PerformanceResourceTimingWrapper",null,[]);ea.prototype.JXh=function(ac){var Kc=new bg.a;if(!this.xu)return Kc;ac=this.xu.getEntriesByName(ac,"resource");if(!ac)return Kc;ac=yl(ac);for(var dd=ac.next();!dd.done;dd=ac.next())Kc.add(new qa(dd.value));return Kc};Object(Ia.a)(ea,"PerformanceWrapper",null,[]);var ig=b(273);ja.prototype.ji=function(ac){var Kc=this;this.tb=ac;this.tb.register(Xa,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").Bc().Lc(function(){return new Xa(bb.AFrameworkApplication.Jd,
new ea(window.performance))});this.tb.register(Pa,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").Bc().Lc(function(){return new Pa(Kc.tb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),function(){return bb.AFrameworkApplication.mj},new ng.a)});this.tb.register(pa,"Common.App.CatchUpActivity.FloodgateEventLogger").Bc().Lc(function(){return new pa(Kc.tb.oc("Common.ISystemInitiatedFeedback"))})};ja.prototype.init=function(){this.tb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");
this.tb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};ja.prototype.dispose=function(){};ja.main=function(){ig.a.instance.sj(new ja)};Sk.Object.defineProperties(ja.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});Object(Ia.a)(ja,"CatchUpActivityPackage",null,[4,5]);ca.prototype.Yc=function(ac,Kc){return this.catchUpActivityManager?-876699925===Kc?!this.catchUpActivityManager.Wcf:!1:!0};ca.prototype.executeCommand=function(ac,Kc){ac=
!1;switch(Kc.command){case -876699925:ac=this.catchUpActivityManager.CUi()}return ac?jd.Task.Ta(!0):jc.a(Kc.command)};ca.prototype.Jc=function(ac,Kc){return se.EwaSettings.la(452)&&-876699925===Kc.command?!0:!1};ca.prototype.fd=function(){return!1};Object(Ia.a)(ca,"CatchUpActivityCommandHandler",null,[188]);var Yd=sa.a;vm(X,Yd);X.prototype.Od=function(){var ac=this;this.$.da.Za(286,function(Kc){ac.Fd([new ca(ac.$,Kc)])})};X.ja=function(ac){sa.a.fe(285,new X(ac))};Object(Ia.a)(X,"CatchUpActivityCommandHandlerFactory",
sa.a,[]);var If=b(309),Pd=b(525),Ze=b(88),Yf=b(84),Xf=b(30);fa.prototype.doesContentExist=function(ac){if(!ac)return lb.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(ac.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!ac.navigationId)return lb.ULS.sendTraceTag(537168065,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var Kc={};Kc.NavigationId=atob(ac.navigationId);return 32===this.Gi.Ce(Xf.a.BIa,2,
Kc);default:return!1}};Object(Ia.a)(fa,"CatchUpActivityContentManager",null,[597]);var rg=b(962),uf=b(1245);da.prototype.dispose=function(){this.Tu.wQf(this.BDb);this.gN=null};da.prototype.Xrj=function(ac){this.gN.push(ac)};da.prototype.PYg=function(){Array.clear(this.gN)};da.prototype.z4f=function(ac){for(var Kc=yl(this.gN),dd=Kc.next();!dd.done;dd=Kc.next())dd=dd.value,dd.className=rg.a.GVg,dd=document.getElementById(String.format("{0}-{1}",dd.id,Zd.a.yxe)),ld.DOMElementExtensions.setVisible(dd,
ac)};da.prototype.YKb=function(ac){for(var Kc=yl(this.gN),dd=Kc.next();!dd.done;dd=Kc.next())if(dd=dd.value)ac?dd.className=2===this.Tu.model.state?rg.a.D5i:rg.a.E5i:this.z4f(!1)};Sk.Object.defineProperties(da.prototype,{Tu:{configurable:!0,enumerable:!0,get:function(){return this.hqg}}});Object(Ia.a)(da,"RangeCatchUpActivityView",null,[722,3]);var kg=b(19),qh=uf.a;vm(K,qh);K.prototype.dispose=function(){this.gridView=null;qh.prototype.dispose.call(this)};K.prototype.CDg=function(ac){var Kc=this.wfb[0];
Kc?Kc.Xrj(ac):lb.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.Kma.activityId)};K.prototype.Ohj=function(){var ac=this.wfb[0];ac&&ac.PYg()};K.prototype.QBg=function(ac){this.Kma.addRange(ac)};K.prototype.TMh=function(){if(3!==this.Kma.activityType)return null;lb.ULS.shipAssertTag(537168003,0,1===this.Kma.wLb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");
return Bd.D(this.Kma.wLb[0])};K.prototype.RIb=function(ac){if(ac){if(!this.Kma)return;this.rxd(this.Uij())}qh.prototype.RIb.call(this,ac)};K.prototype.P4c=function(){var ac=this.u4c();Array.add(this.wfb,ac)};K.prototype.u4c=function(){return new da(this)};K.prototype.rxd=function(ac){ac?ac.SheetName?(this.gridView.ha.Pa.bH(null),this.gridView.focus(),this.gridView.Q5e(ac,3,!1,Nd.a.C5i)):lb.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):
lb.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};K.prototype.Uij=function(){if(yb.e(this.Kma.wLb))return lb.ULS.shipAssertTag(537167971,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null;var ac=this.$.xa.pa;lb.ULS.shipAssertTag(537167970,0,!!ac,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");
ac=this.dOj(ac.sheetName,this.Kma.wLb);if(!ac&&(ac=this.k1h(this.Kma.wLb),!ac))return null;var Kc={};Kc.SheetName=ac.SheetName;Kc.FirstColumn=ac.FirstColumn;Kc.FirstRow=ac.FirstRow;Kc.LastColumn=ac.FirstColumn;Kc.LastRow=ac.FirstRow;return Kc};K.prototype.k1h=function(ac){if(yb.e(ac))return null;for(var Kc=null,dd=0;dd<ac.length;dd++){var Ud=ac[dd].SheetName;if(!kg.a.equals(Ud,Kc,!1)&&(Kc=Ud,Ud=this.$.xa.getItemByName(Ud),null===Ud||void 0===Ud?0:Ud.visible))return ac[dd]}return null};K.prototype.dOj=
function(ac,Kc){if(Kc){Kc=yl(Kc);for(var dd=Kc.next();!dd.done;dd=Kc.next())if(dd=dd.value,kg.a.equals(dd.SheetName,ac,!1))return dd}return null};Object(Ia.a)(K,"RangeCatchUpActivityHighlightController",uf.a,[]);var La=b(74),Db=La.a;vm(S,Db);S.prototype.dispose=function(){this.u1d=null;Db.prototype.dispose.call(this)};Sk.Object.defineProperties(S.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.VB}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.u1d}},
activityType:{configurable:!0,enumerable:!0,get:function(){return this.Dkg}}});Object(Ia.a)(S,"CatchUpActivityHighlightModelBase",La.a,[]);vm(H,S);H.prototype.addRange=function(ac){ac=yl(ac);for(var Kc=ac.next();!Kc.done;Kc=ac.next())this.ranges.push(Kc.value)};H.prototype.dispose=function(){this.ranges=null;S.prototype.dispose.call(this)};H.M2b=function(ac,Kc){if(!ac.SheetName||!Kc.SheetName)return lb.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),
0;var dd=ac.SheetName.localeCompare(Kc.SheetName);return dd?dd:ac.FirstColumn<Kc.FirstColumn||ac.FirstColumn===Kc.FirstColumn&&ac.FirstRow<Kc.FirstRow?-1:ac.FirstColumn===Kc.FirstColumn&&ac.FirstRow===Kc.FirstRow?0:1};Sk.Object.defineProperties(H.prototype,{wLb:{configurable:!0,enumerable:!0,get:function(){this.f7a||(this.ranges.sort(H.M2b),this.f7a=!0);return this.ranges}}});Object(Ia.a)(H,"RangeCatchUpActivityHighlightModel",S,[]);var uc=b(336);T.prototype.dispose=function(){this.ele=this.lKb=this.h2c=
null};T.prototype.Lej=function(ac){Tc.g(ac).Nb.ys([24])};T.prototype.K5g=function(ac,Kc,dd){var Ud={};Kc=yl(Kc);for(var Le=Kc.next();!Le.done;Le=Kc.next())if((Le=Le.value)&&!yb.e(Le.LocationList)){for(var ce=[],Nf={},af=[],wf=yl(Le.LocationList),vf=wf.next();!vf.done;vf=wf.next()){vf=vf.value;if(!vf){lb.ULS.shipAssertTag(537168013,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+Le.Id);break}switch(vf.Type){case 0:var pg=vf;"0"in Nf?
(vf=Nf["0"],vf.QBg(pg.RangeList)):(vf=new K(ac,new H(ac,Le.Id,Le.Type,0,pg.RangeList),dd),ce.push(vf),Nf["0"]=vf);pg=yl(pg.RangeList);for(var bf=pg.next();!bf.done;bf=pg.next()){bf=bf.value;bf=new uc.a(Bd.D(bf),hd.d(ac.xa.getItemByName(bf.SheetName)));if(this.Gwc(bf)in this.lKb)this.lKb[this.Gwc(bf)].push(vf);else{var Bf=[];Bf.push(vf);this.lKb[this.Gwc(bf)]=Bf}af.push(bf);this.h2c.push(bf)}break;default:lb.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}lb.ULS.shipAssertTag(537168011,
0,!(Le.Id in Ud),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+Le.Id);this.ele[Le.Id]=af;Ud[Le.Id]=ce}this.e7g(ac,this.h2c,this.lKb);return Ud};T.prototype.IYg=function(ac){for(var Kc in ac)for(var dd=yl(ac[Kc]),Ud=dd.next();!Ud.done;Ud=dd.next())Ud.value.Ohj()};T.prototype.Gwc=function(ac){return String.format("{0}-{1}",ac.range,ac.sheetId)};T.prototype.e7g=function(ac,Kc,dd){var Ud=this;this.IYg(dd);Tc.g(ac).Nb.ry(Kc,[24],!0,function(Le,
ce){var Nf=new uc.a(Le.range,Le.sheetId);Nf=Ud.Gwc(Nf);var af=dd[Nf];if(af)for(Nf=yl(af),af=Nf.next();!af.done;af=Nf.next())af=af.value,af.CDg(ce),Le.metadata=af;else lb.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+Nf)})};Object(Ia.a)(T,"CatchUpHighlightControllersCreator",null,[]);Object(Ia.a)(ba,"CreateIndicatorTooltipParameters",null,[]);Object(Ia.a)(la,"DismissIndicatorTooltipParameters",null,
[]);Object(Ia.a)(Q,"UpdateIndicatorTooltipParameters",null,[]);U.prototype.dispose=function(){this.ha.xsc(this.$k);this.ha.WF(this.nd);this.gridView.UF(this.lp);this.Ya.ol(this.fj);this.SHe();this.Bbd=this.jka=this.Kdc=this.kRa=this.Ya=this.ha=this.gridView=null};U.prototype.Ipj=function(){var ac=[];this.SHe();if(!yb.e(ac)){lb.ULS.sendTraceTag(537168035,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.W4=this.v3b.K5g(this.$,ac,this)){ac=this.W4;for(var Kc in ac)for(var dd=
yl(ac[Kc]),Ud=dd.next();!Ud.done;Ud=dd.next())this.dMg(Ud.value)}this.v3b.Lej(this.$)}};U.prototype.Exc=function(ac){if(ac&&this.lkd)lb.ULS.shipAssertTag(537168034,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(ac||this.Orb(),this.W4){var Kc=this.W4,dd;for(dd in Kc)for(var Ud=yl(Kc[dd]),Le=Ud.next();!Le.done;Le=Ud.next())Le.value.hCj(ac)}};U.prototype.e8h=function(ac){this.jka&&this.j6b(!0);this.x6c();if(ac=this.W4[ac.activityId]){ac=
yl(ac);for(var Kc=ac.next();!Kc.done;Kc=ac.next())Kc.value.RIb(!0)}else lb.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};U.prototype.SHe=function(){if(this.W4){var ac=this.W4,Kc;for(Kc in ac)for(var dd=yl(ac[Kc]),Ud=dd.next();!Ud.done;Ud=dd.next())Ud=Ud.value,this.zaj(Ud),Ud.dispose()}this.W4={};this.v3b.dispose();this.v3b=null};U.prototype.IAj=function(){if(this.excelCommentManager){var ac=this.W4[this.kRa];ac&&0<ac.length&&
3===ac[0].model.activityType&&((ac=ac[0])?this.excelCommentManager.kBj(ac.TMh()):lb.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};U.prototype.w7h=function(){this.excelCommentManager&&this.excelCommentManager.Lsb()};U.prototype.x6c=function(){if(this.kRa){var ac=this.W4[this.kRa];if(ac){ac=yl(ac);for(var Kc=ac.next();!Kc.done;Kc=ac.next())Kc.value.RIb(!1);this.kRa=null}else lb.ULS.sendTraceTag(537168028,
0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};U.prototype.Orb=function(){this.x6c();this.j6b(!0)};U.prototype.qOj=function(ac){if(!ac)return lb.ULS.shipAssertTag(537168026,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;ac=String.format("{0}-{1}",ac.id,Zd.a.EVg);var Kc=this.Bbd[ac];if(!Kc){if(!this.gridView.domElement)return lb.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),
null;Kc=document.createElement("Div");Kc.className=rg.a.FVg;Kc.id=ac;this.gridView.domElement.appendChild(Kc);this.Bbd[ac]=Kc}return Kc};U.prototype.j6b=function(ac){this.cfa&&(this.cfa.dismissActivityIndicatorTooltips(Object.assign(new la,{clearSticky:ac})),this.Kdc=null,ac&&(this.jka=null),this.jgc&&!this.jka&&(this.gridView.view.Nq(this.$Ac),this.gridView.pt(this.$Ac),this.jgc=!1))};U.prototype.dMg=function(ac){ac.sne(this.BDb);ac.hEg(this.x3f);ac.gEg(this.MIe)};U.prototype.zaj=function(ac){ac.wQf(this.BDb);
ac.Gbj(this.x3f);ac.Fbj(this.MIe)};Sk.Object.defineProperties(U.prototype,{$zg:{configurable:!0,enumerable:!0,get:function(){return this.cfa},set:function(ac){this.cfa=ac}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.hDa||(this.hDa=this.$.da.Aa(65));return this.hDa}},v3b:{configurable:!0,enumerable:!0,get:function(){this.w3b||(this.w3b=new T);return this.w3b},set:function(ac){this.w3b=ac}}});Object(Ia.a)(U,"CatchUpActivityHighlightManager",null,[680,3]);V.prototype.navigateToActivity=
function(ac){if(ac.fromSummaryString){var Kc=new Jd.a(1834994092,Ac.a.$b,this.$.gd,18,null);this.$.Ka.Xb(Kc);return this.oUa(1)}ac=ac.activity;if(!this.pfi(ac))return this.oUa(4);if(!this.doi(ac))return this.oUa(7);var dd={};try{Kc=window.self.atob(ac.navigationId);if(!Kc)return this.oUa(5);dd.NavigationId=Kc}catch(Ud){return lb.ULS.sendTraceTag(537168023,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",Ud),this.oUa(5)}if(8===this.Gi.Ce(Xf.a.BIa,2,dd))return this.Gi.processAction(Xf.a.Z8a,
2),this.oUa(2);Kc=32===this.Gi.Ce(Xf.a.h0a,2,dd)?1:6;return this.oUa(Kc)};V.prototype.pfi=function(ac){return ac&&ac.navigationId?!0:!1};V.prototype.doi=function(ac){switch(ac.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};V.prototype.oUa=function(ac){return Promise.resolve(ac)};Object(Ia.a)(V,"CatchUpActivityNavigationManager",null,[598]);var Vc=b(444);Object(Ia.a)(D,"GetRelevantActivitiesDataRequest",null,[]);Object(Ia.a)(r,"Activity",null,[]);Object(Ia.a)(C,"ActivityFeedItem",
null,[]);Object(Ia.a)(u,"ActivityFeedPayload",null,[]);Object(Ia.a)(z,"ActivityRequestPayload",null,[]);Object(Ia.a)(B,"Person",null,[]);vm(t,r);Object(Ia.a)(t,"TaskActivity",r,[]);y.prototype.requestWYWAActivities=function(){var ac=this;return this.v6a?new Promise(function(Kc,dd){v(ac.$.na.ta,function(Ud){Ud=mc.a(Ud)?null:Ud.Result;Ud=Object.assign(new z,{activities:[],actors:Ud?ac.rgd(Ud.WywaAuthors):null,hasMore:!1,highWaterline:y.h1a,lowWaterline:y.h1a,wywaWaterline:y.h1a});Kc(Ud)},function(){lb.ULS.sendTraceTag(537168022,
0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");dd(null)},null,null)}):Promise.resolve(y.A5b)};y.prototype.requestActivities=function(){return Promise.resolve(y.A5b)};y.prototype.requestRelevantActivities=function(){var ac=this;if(!this.$.ea.qc||this.$.ea.T4a)return lb.ULS.sendTraceTag(537168021,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.$.ea.qc,this.$.ea.T4a),
Promise.resolve(y.A5b);var Kc=Object.assign(new D,{SetDaysBack:bb.AFrameworkApplication.ga.Ad("AppWaterlineOverrideDaysValue",0),SetTimestamp:bb.AFrameworkApplication.ga.Ad("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(dd,Ud){J(ac.$.na.ta,Kc,function(Le){var ce=y.A5b;Le?mc.a(Le)?lb.ULS.sendTraceTag(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",Sd.a.Tc(Le.Errors)):ce=ac.rXh(Le.Result):lb.ULS.sendTraceTag(537168020,
3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");dd(ce)},function(Le){Le=wc.a.og(Le.data);lb.ULS.sendTraceTag(537168019,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",Sd.a.Tc(Le));Ud(null)},null,null)})};y.prototype.requestActivityFeed=function(){var ac=this;return be.b(this.getActivityFeed()).then(function(Kc){return Object.assign(new u,{activityFeedItems:ac.ZMj(Kc)})})};y.prototype.getActivityFeed=
function(){return this.Bxe?ee.a.vVd(this.Bxe,function(ac){return ac.getActivityFeed(null)}):jd.Task.Ta([])};y.prototype.rXh=function(ac){if(!ac)return lb.ULS.sendTraceTag(537168018,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object.assign(new z,{activities:[]});var Kc=this.gag(ac.NewActivities,2);ac=this.gag(ac.OutstandingActivities,3);ac=yl(ac);for(var dd=ac.next();!dd.done;dd=ac.next())Kc.push(dd.value);return Object.assign(new z,{activities:Kc})};
y.prototype.gag=function(ac,Kc){Kc=void 0===Kc?1:Kc;var dd=[];if(!ac||!ac.length)return dd;ac=yl(ac);for(var Ud=ac.next();!Ud.done;Ud=ac.next())if(Ud=Ud.value){var Le=y.fNj(Ud.Type);6===Le||7===Le||9===Le||8===Le?dd.push(Object.assign(new t,{activityId:Ud.Id,type:Le,displayTimestamp:new Date(Ud.DisplayTimestamp),navigationId:Ud.NavigationId,actors:this.rgd(Ud.People),relevancy:Kc,relationship:this.eNj(Ud.Relationship)})):dd.push(Object.assign(new r,{activityId:Ud.Id,type:Le,displayTimestamp:new Date(Ud.DisplayTimestamp),
navigationId:Ud.NavigationId,actors:this.rgd(Ud.People),relevancy:Kc}))}else lb.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return dd};y.prototype.eNj=function(ac){switch(ac){case 1:return 1;case 2:return 2;case 3:return 3}lb.ULS.sendTraceTag(537168016,0,10,"Unexpected Relationship.");return 1};y.prototype.ZMj=function(ac){var Kc=[];ac=yl(ac);for(var dd=ac.next();!dd.done;dd=ac.next())dd=dd.value,dd=Object.assign(new C,
{id:dd.id,type:dd.type,collectionId:dd.collectionId,activityState:dd.activityState,activityFeedItemPayload:dd.activityFeedItemPayload,timestamp:dd.timestamp}),Kc.push(dd);return Kc};y.prototype.rgd=function(ac){var Kc=[];if(!ac||!ac.length)return Kc;ac=yl(ac);for(var dd=ac.next();!dd.done;dd=ac.next())(dd=dd.value)&&Kc.push(this.Bvb(dd));return Kc};y.prototype.Bvb=function(ac){return Object.assign(new B,{id:ac.Id,provider:ac.Provider,displayName:ac.DisplayName,email:ac.Email,imageUrl:this.Eqc.KHa(ac.Email,
ac.Provider,bb.AFrameworkApplication.mj,0),color:this.gFb.Phd(new Vc.a(null,void 0,ac.DisplayName),6)})};y.fNj=function(ac){switch(ac){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return lb.ULS.shipAssertTag(537168015,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}};y.h1a="<WywaWaterline>DefaultWaterline</WywaWaterline>";y.A5b=Object.assign(new z,{activities:[],
actors:[],hasMore:!1,highWaterline:y.h1a,lowWaterline:y.h1a,wywaWaterline:y.h1a});Object(Ia.a)(y,"CatchUpActivityRequestManager",null,[599]);x.prototype.shouldShowEmptyExperienceButton=function(){if(!this.$.ea.W7a)return!1;if(!se.EwaSettings.isChangeGateEnabled("OfficeVSO:5892442_CatchupEmptyExperienceNewContract")){var ac=this.$.da.Aa(365);return!ac||!ac.isVisible}return!0};x.prototype.onButtonClick=function(){var ac={};ac=(ac.InputMethod=Ac.a.$b,ac);this.$.Ka.Xb(new Jd.a(1834994092,Ac.a.$b,this.$.gd,
16,null),ac)};x.prototype.getExplanationText=function(){var ac=this.$.da.Aa(365);return kd.a.instance.Va(ac&&ac.isVisible?644:643)};x.prototype.getCommandName=function(){return kd.a.instance.fa(436)};Object(Ia.a)(x,"CatchUpEmptyExperienceBehaviorManager",null,[600]);m.prototype.dispose=function(){qd.a(this.$).Dz(this)};m.prototype.Ne=function(ac,Kc){if(Kc)return!1;ac=document.getElementById("flyoutItem0");if(!ac)return lb.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),
!1;ac.focus();this.Yfh(ac);return!0};m.prototype.Yf=function(ac){return this.Jb?ld.DOMElementExtensions.Oe(this.Jb,ac):!1};m.prototype.gi=function(){this.hasFocus=!0};m.prototype.Qh=function(){this.hasFocus=!1};m.prototype.Yfh=function(ac){if(Sys.Browser.agent===Sys.Browser.Firefox){var Kc=document.createEvent("KeyboardEvent");Kc.initKeyEvent(Cc.a.Sb,!0,!0,window.self,!1,!1,!1,!1,ae.a.pCc,0);ac.dispatchEvent(Kc)}else Kc=document.createEvent("Events"),Kc.initEvent(Cc.a.Sb,!0,!0),Kc.keyCode=ae.a.pCc,
Kc.which=ae.a.pCc,ac.dispatchEvent(Kc)};Sk.Object.defineProperties(m.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Def&&!this.hasFocus}},Zd:{configurable:!0,enumerable:!0,get:function(){return zc.a.z_c}}});Object(Ia.a)(m,"FlyoutFocus",null,[112,3]);var yd=b(376);n.prototype.dispose=function(){this.cjb=this.Iyb=!1};n.prototype.registerButtonClickedEvent=
function(ac){this.buttonClickedCallback&&lb.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=ac.buttonClickedCallback};n.prototype.onFlyoutInitialized=function(){this.Iyb&&lb.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");var ac=(new Date).getTime()-this.IEh.getTime();lb.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",
ac);zb.c(Xf.a.IVg,!0,zb.e,0,0,ac);this.Iyb=!0;yd.a.Iy&&yd.a.Iy.updateCommandUI(!0)};n.prototype.logFlightTriggers=function(){};n.prototype.toggleCatchUpFlyout=function(){this.Iyb?this.buttonClickedCallback?this.buttonClickedCallback():lb.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):lb.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};n.prototype.onFlyoutVisibilityChanged=
function(ac){this.cjb!==ac.flyoutIsVisible&&(this.cjb=ac.flyoutIsVisible,yd.a.Iy&&yd.a.Iy.updateCommandUI(!0),this.cjb||this.cVe&&this.cVe.Dui())};Sk.Object.defineProperties(n.prototype,{Def:{configurable:!0,enumerable:!0,get:function(){return this.cjb}}});Object(Ia.a)(n,"FlyoutRibbonButton",null,[679]);var Md=b(529);Object(Ia.a)(l,"CatchUpConfiguration",null,[]);Object(Ia.a)(e,"SharedControllerFactoryParameters",null,[]);c.prototype.dispose=function(){this.OGa&&this.OGa.getWywaEvent().removeListener(this.GFf);
this.OGa=this.$=null;Ze.a.Fa(this.B_a);this.flyoutRibbonButton=this.flyoutFocus=this.d3d=this.zxe=this.Axe=this.B_a=null};c.prototype.CUi=function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};c.prototype.hvi=function(){lb.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");this.ycf()&&lb.ULS.sendTraceTag(526718752,3012,50,"ActivityFeedData is enabled")};c.prototype.lti=function(ac,Kc){f("ScriptDownload");Yb.TaskExtensions.Ba(Ua.GetServiceTaskFactory.Wa(this.$.da,
283,284,Kc),function(dd){ac(be.c(dd.result.Un.loadScript("catchUpActivity")))},this.$.da.ma,3)};c.prototype.v6a=function(){return!!this.xlf&&this.xlf.v6a()&&this.$.ea.W7a};c.prototype.ycf=function(){return se.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ActivityFeedIsEnabled",!1)};c.prototype.gIi=function(ac){var Kc=this;Yb.TaskExtensions.Ba(ac,function(){nd.a(function(){Kc.OGa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object.assign(new e,{activityContentManager:Object(Yf.a)(597,
Kc.d3d),activityNavigationManager:Object(Yf.a)(598,Kc.zxe),activityRequestManager:Object(Yf.a)(599,Kc.Axe),dataCulture:Kc.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(Yf.a)(n,Kc.flyoutRibbonButton),uiCulture:Kc.$.ya.UICultureTag,ulsLogger:new fd.a,emptyCatchUpBehaviorManager:Object(Yf.a)(600,Kc.emptyCatchUpBehaviorManager)}))});Kc.B_a.$zg=Kc.OGa.getActivityIndicatorTooltipManager();Md.a(Kc.$);Kc.OGa.getWywaEvent().addListener(Kc.GFf);f("InitializeCatchUpApp");Kc.OGa.initialize(Object.assign(new l,
{featuredActivityGroupsEnabled:!1,summaryStringEnabled:Kc.v6a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:se.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel"),activityFeedDataEnabled:Kc.ycf()}))},this.$.ma,3)};Sk.Object.defineProperties(c.prototype,{Wcf:{configurable:!0,enumerable:!0,get:function(){var ac=this.flyoutRibbonButton.Iyb;ac&&!this.U7e&&(lb.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),this.U7e=!0);
return ac}},wgi:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.Def}}});Object(Ia.a)(c,"CatchUpActivityManager",null,[601,3]);var qe=Va.a;vm(a,qe);a.prototype.create=function(){var ac=this;Yb.TaskExtensions.Ba(Ua.GetServiceTaskFactory.Wa(this.$.da,458,459,this.ub),function(Kc){Kc=Kc.result;ac.Fb(ac.$.da.Aa(286)||new c(ac.$,ac.ub,null,Kc))},this.$.ma,3)};a.ja=function(ac){ac.da.Ha(287,new a(ac))};Object(Ia.a)(a,"CatchUpActivityManagerFactory",Va.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");ta.a.Ga(mb.ja);ta.a.Ga(Za.ja);ta.a.Ga(Ob.ja);ta.a.Ga(Ba.ja);mf.a.$i('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){ta.a.Ga(function(ac){Ja.ja(ac);hc.ja(ac);ub.ja(ac);Na.ja(ac);Ya.ja(ac)})})();Type.registerNamespace("Common.App.CatchUpActivity");ja.main();(function(){ta.a.Ga(function(ac){f("Begin");a.ja(ac);X.ja(ac)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.catchup.js.map/ba880e6c85313852da0bb0ee3ae8a6c6/EwaDS.catchup.js.map