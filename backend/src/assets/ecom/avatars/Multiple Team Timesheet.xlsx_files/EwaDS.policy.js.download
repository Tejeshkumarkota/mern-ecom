(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[32],{1386:function(A,F,b){function a(yb){return wc.call(this,yb)||this}function c(yb){this.$=yb}function e(yb){var mc=Bd.call(this)||this;mc.$=yb;mc.dc();return mc}function l(yb,mc,Wc,Nd,Tc){var Yc=Vd.call(this)||this;Yc.statusBarManager=null;Yc.AYc=!1;Yc.g$=null;Yc.SBc=!1;Yc.TNd=null;Yc.Uxa=null;Yc.KDd=!1;Yc.so=!1;Yc.Dp=null;Yc.aee=null;Yc.Tfa=null;Yc.Vce=null;Yc.TDa=null;Yc.xLe=function(){ma.ULS.sendTraceTag(537154520,306,
50,"PolicyManagerWrapper::EnableAutoLabellingInDocument - Triggered EnableAutoLabellingInDocument");var oc=Yc.BOf(1);ma.ULS.sendTraceTag(537154519,306,50,"PolicyManagerWrapper::EnableAutoLabellingInDocument - Annotation registration result: {0}.",oc)};Yc.bSd=function(oc,ze){ze?(Yc.Dp=ze.title,Yc.aee=ze.Npc,Yc.Tfa=ze.buttonText,Yc.Vce=ze.svf,Yc.hE.ig(27,null),ma.ULS.sendTraceTag(537154509,306,50,"Add entry to BusinessBar succeeded. Message is shown to user.")):ma.ULS.sendTraceTag(537154510,306,15,
"ShowPolicyBusinessBar is called but PolicyTipventArgs is null.")};Yc.T4f=function(oc,ze){var Ae=Object(oe.a)(la,ze);Ae?Ae.r4f?Yc.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CommonBusinessBarEntryForSensitivityLabelError",!1)?(ma.ULS.sendTraceTag(537154508,306,15,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure because of {0}",Ae.errorType),Yc.hE.OCj(Ae.title,Ae.message,Ae.buttonText,function(Ve){Ae.EY&&(Yc.hE.dC(52)&&Yc.hE.removeEntry(52),Ae.EY(Ve))})):1===Ae.errorType?
(ma.ULS.sendTraceTag(537154507,306,15,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure because of File too large"),Yc.hE.ig(47,null)):2===Ae.errorType?Yc.hE.ig(48,null):3===Ae.errorType?Yc.hE.ig(49,null):4===Ae.errorType?Yc.hE.ig(50,null):5===Ae.errorType?Yc.hE.PCj(Ae.title,Ae.message,Ae.buttonText,function(Ve){Yc.hE.dC(51)&&Yc.hE.removeEntry(51);Ae.EY(Ve)}):Yc.hE.ig(46,null):ma.ULS.sendTraceTag(537154506,306,50,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure ShowMessage is false"):
(ma.ULS.sendTraceTag(537154505,306,10,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure args is null"),Yc.hE.ig(46,null))};Yc.nYd=function(oc,ze){Yc.E6&&(ma.ULS.sendTraceTag(537154504,306,50,"PolicyManagerWrapper: UpdateLabelInfo called"),Yc.E6.b0f(),Yc.E6.t_f(),Yc.E6.cLf(),Yc.$.Hd&64&&(ze.onSuccess&&Yc.Uxa?Yc.IKg():Yc.E6.oag()));Yc.ga.ra("SupportsOfficeClientCoauthoring")&&(oc=Yc.vr.wn,Yc.TDa=oc.AppliedPolicyId,"null"===Yc.labelId&&(Yc.TDa=""),Yc.SBc&&(oc=oc.PolicyLabelAssignmentMethod&&
Xb.c(oc.PolicyLabelAssignmentMethod)===Xb.c("standard")?4:2,Yc.applyPolicyLabel(Yc.labelId,oc,!0,Yc.TNd)));Yc.hSe();Yc.vz()};Yc.Qyf=function(){Yc.KDd=!0;Yc.hSe()};Yc.DDf=function(oc,ze){ma.ULS.sendTraceTag(42322116,306,50,"PolicyManagerWrapper.OnSetLabelSucceeded: Applying outcomes for change in policy label. ProtectedFile = {0}, ApplyLabelFlag = {1}",eb.AFrameworkApplication.protectedFile,ze.WP);Yc.applyPolicyLabel(ze.Mpc,ze.WP,!1,null)};Yc.rHi=function(oc,ze){Yc.TDa=ze.Mpc;if(rb.a.er(oc.Errors)){var Ae=
rb.a.paa(oc.Errors,[2045508683]);0<Ae.length&&(oc.Errors=rb.a.SF(oc.Errors,[2045508683],"PolicyManagerWrapper: OnApplyManualPolicyLabelSuccessCallback"),Yc.$.ea.np(oc.Errors));Ae=rb.a.paa(oc.Errors,[2046680228]);0<Ae.length&&(4===ze.WP||1===ze.WP)&&(oc.Errors=rb.a.SF(oc.Errors,[2046680228],"PolicyManagerWrapper: OnApplyManualPolicyLabelSuccessCallback"),Yc.$.ea.np(oc.Errors));Ae=oc=null;for(var Ve=yl(Yc.vr.wn.SensitivityLabels),nb=Ve.next();!nb.done;nb=Ve.next())nb=nb.value,nd.a.equals(Yc.labelId,
nb.Id,!1)&&(oc=nb),nd.a.equals(ze.uYf,nb.Id,!1)&&(Ae=nb);Ve={};Ve.ApplyLabelFlag=ze.WP;oc?(Ve.currentLabel="Set",Ve.currentLabelEnabled=oc.Enabled,Ve.currentLabelName=oc.Name?"Set":"NotSet",Ve.currentLabelParentId=oc.ParentId?"Set":"NotSet"):Ve.currentLabel="NotSet";Ae?(Ve.serverLabel="Set",Ve.serverLabelEnabled=Ae.Enabled,Ve.serverLabelName=Ae.Name?"Set":"NotSet",Ve.serverLabelParentId=Ae.ParentId?"Set":"NotSet"):Ve.serverLabel="NotSet";ma.ULS.sendTraceTag(541638850,306,15,"PolicyManagerWrapper.OnApplyManualPolicyLabelSuccessCallback Failed. DiagnosticInfo : {0}",
JSON.stringify(Ve))}};Yc.MOg=function(oc,ze){if(!Yc.$.workbookContext.HasRoundTrippedHFPart)return!1;var Ae=Yc.vr.wn;if(!Ae)return ma.ULS.sendTraceTag(537154502,306,15,"PolicyManagerWrapper.BlockSetSensitivityCall: policyLabelsData is null."),!1;var Ve=null;Ae=yl(Ae.SensitivityLabels);for(var nb=Ae.next();!nb.done;nb=Ae.next())nb=nb.value,nd.a.equals(nb.Id,oc,!1)&&(Ve=nb);return Ve&&Yc.S6h(Ve)?(ma.ULS.sendTraceTag(50341186,306,50,"PolicyManagerWrapper.BlockSetSensitivityCall: selectedSensitivityLabel has watermark label action."),
Yc.uAj(ze),!0):!1};Yc.efi=function(){var oc=!1;!Yc.$.ya.IsNewWorkbook||Yc.labelId&&Yc.labelId.length||(oc=!0);ma.ULS.sendTraceTag(537154501,306,50,"PolicyManagerWrapper.IsANewFile: is this a new file : {0}",oc);return oc};Yc.Apf=function(oc,ze){1===ze.Gqe?Yc.$.isEditMode?(ma.ULS.sendTraceTag(537154500,306,50,"MandatoryLabellingHandler : Swtiching to view-mode."),Yc.$.Ka.Xb(new ld.a(-723527778,0,Yc.$.gd,10,null))):ma.ULS.sendTraceTag(537154499,306,50,"MandatoryLabellingHandler : App is already in view-mode."):
(Yc.Uxa=ze.Uxa,Yc.$.ea.K9(Yc.Tre),Yc.$.Reb(),ma.ULS.sendTraceTag(537154498,306,50,"MandatoryLabellingHandler : Swtiching to edit-mode."),Yc.$.Ka.Xb(new ld.a(-8805455,0,Yc.$.gd,10,null)))};Yc.ome=function(oc,ze){ze?(oc=!!(Yc.$.Hd&64),ma.ULS.sendTraceTag(537154496,306,50,"AddMandatoryLabellingBusinessBar User has edit permission : {0}",oc),oc&&(Yc.$.Reb(),Yc.hE.UBj(ze.title,ze.message,ze.buttonText,function(Ae){ze.EY(Ae)}))):ma.ULS.sendTraceTag(537154497,306,15,"AddMandatoryLabellingBusinessBar is called but MandatoryLabellingAppHandlerEventArgs is null.")};
Yc.SPf=function(){Yc.hE.dC(40)&&Yc.hE.removeEntry(40)};Yc.Abg=function(oc,ze){ze.Dyj&&(ma.ULS.sendTraceTag(527716803,306,50,"PolicyManagerWrapper.udpLabelingAppHandler: Open the document in the client when the applied label is a UDP label."),se.TaskExtensions.Ba(Sd.GetServiceTaskFactory.Wa(Yc.$.da,55,56,0),function(Ae){Ae.result.L2c()},Yc.$.ma,3))};Yc.Tre=function(){Yc.Uxa&&Yc.$.isEditMode?(Yc.$.ea.Z6(Yc.Tre),Yc.D3a()):ma.ULS.sendTraceTag(537154467,306,15,"ApplyMandatoryLabelOnEditMode : mandatoryPolicyId empty {0} , edit mode : {1}.",
!Yc.Uxa,Yc.$.isEditMode)};Yc.oNj=function(){Yc.$.isEditMode?(Yc.$.ea.Z6(Yc.oNj),Yc.D3a()):ma.ULS.sendTraceTag(537154466,306,15,"TriggerDefaultLabelingOnModeChanged is not expected in View-mode. Mode.")};Yc.eka=function(){var oc=Yc.$.ea.Dm;oc&&!nd.a.equals(oc.AppliedPolicyLabelId,Yc.labelId,!1)&&(ma.ULS.sendTraceTag(537154464,306,50,"PolicyManagerWrapper.HandleWorkbookMetadataChanged: Calling GetPolicyLabels to update statusbar and ribbon control."),ma.ULS.shipAssertTag(537154463,306,Yc.$.isEditMode,
"PolicyManagerWrapper.HandleWorkbookMetadataChanged policyId cannot change in read-only mode, this can happen if right policy id is not read from server."),Yc.ga.ra("SupportsOfficeClientCoauthoring")&&Yc.$.isEditMode&&(Yc.SBc=!0,Yc.TNd=oc.AppliedPolicyLabelId),Yc.TDa=oc.AppliedPolicyLabelId,Yc.D3a())};Yc.kod=function(){var oc=!0;if(!Yc.$.ea.amIAlone)for(var ze=yl(Yc.$.ea.km),Ae=ze.next();!Ae.done;Ae=ze.next())if(!Ae.value.SupportsClientIsMipTrusted){oc=!1;break}ma.ULS.sendTraceTag(537154462,306,50,
"PolicyManagerWrapper.IsEveryCoauthorInSessionClientMipTrusted : {0}",oc);return oc};Yc.Vzf=function(){ma.ULS.sendTraceTag(537154461,306,50,"PolicyManagerWrapper.OnLabelUpdate: RTC notification received");Yc.SBc=!0;Yc.D3a()};Yc.$=Nd;Yc.vr=yb;Yc.hE=Wc;Yc.ga=Tc;Yc.vr.xoe(Yc.bSd);Yc.E6=mc;return Yc}function n(yb){return Ac.call(this,yb,n.YQ(yb))||this}function m(yb,mc,Wc,Nd,Tc){var Yc=Re.call(this)||this;Yc.Mpf=3;Yc.augmentationLoopManager=null;Yc.rA=null;Yc.EZa=!1;Yc.e$a=[];Yc.Bkf=new be.a(sd.a.iK());
Yc.XEd=0;Yc.bFd=null;Yc.T3b=function(oc,ze){oc=Object.assign(new Cd.a,{parentPath:["session","doc","security"],items:[Object.assign(new Qd.a,{id:"clp",body:Object.assign(new y,{existingLabelPriority:ze.existingLabelPriority,partialDocSITs:ze.oAe,fullDocSITs:ze.nAe})})]});Yc.e$a.push(oc);Yc.Exb()};Yc.Pcg=function(oc,ze){oc=Object.assign(new od.a,{parentPath:["session","doc","security"],items:[Object.assign(new Qd.a,{id:"clp",body:Object.assign(new y,{existingLabelPriority:ze.existingLabelPriority})})]});
Yc.e$a.push(oc);Yc.Exb()};Yc.Qcg=function(oc,ze){oc=Object.assign(new od.a,{parentPath:["session","doc","security"],items:[Object.assign(new Qd.a,{id:"clp",body:Object.assign(new y,{partialDocSITs:ze.oAe,fullDocSITs:ze.nAe})})]});Yc.e$a.push(oc);Yc.Exb()};Yc.m6=function(){ma.ULS.sendTraceTag(537154588,306,50,"AutoPolicyManager::OnApplicationModeChanged - isEditMode:{0}.",Yc.$.isEditMode);Yc.$.isEditMode?rc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?Yc.Exb():
Yc.raf():(Yc.businessBar.removeEntry(39),Yc.businessBar.removeEntry(38),Yc.Vbh())};Yc.umc=function(){ma.ULS.sendTraceTag(537154587,306,50,"AutoPolicyManager::OnAugmentationLoopSessionClose called.");Yc.KHe();Yc.augmentationLoopManager=null};Yc.fri=function(oc,ze){var Ae,Ve,nb,Hc,Cc;ma.ULS.sendTraceTag(537154586,306,50,"AutoPolicyManager::LabellingAnnotationHandler called.");if(3===ze.operationType)ma.ULS.sendTraceTag(537154585,306,50,"AutoPolicyManager::LabellingAnnotationHandler Ignoring delete operation.");
else{var Sc=oc=null,Uc=null;if(Yc.Wmd()){var ae=ze.SP;if(!ae){ma.ULS.sendTraceTag(537154584,306,50,"AutoPolicyManager::LabellingAnnotationHandler LabellingAnnotation is null.");return}if(null===(Ae=ae.automatic)||void 0===Ae?0:Ae.id)oc=ae.automatic.id;if(null===(Ve=ae.recommended)||void 0===Ve?0:Ve.id)Sc=ae.recommended.id,ae.recommended.policyTip&&(Uc=ae.recommended.policyTip)}else{Ae=ze.SP;if(!Ae){ma.ULS.sendTraceTag(537154583,306,50,"AutoPolicyManager::LabellingAnnotationHandler LabellingAnnotation is null.");
return}if(null===(nb=null===(ae=Ae.automatic)||void 0===ae?void 0:ae.sensitivityLabel)||void 0===nb?0:nb.id)oc=Ae.automatic.sensitivityLabel.id;if(null===(Cc=null===(Hc=Ae.recommended)||void 0===Hc?void 0:Hc.sensitivityLabel)||void 0===Cc?0:Cc.id)Sc=Ae.recommended.sensitivityLabel.id,Ae.recommended.sensitivityLabel.policyTip&&(Uc=Ae.recommended.sensitivityLabel.policyTip)}Yc.applyPolicyLabel(oc,Sc,Uc,1)}};Yc.Ysi=function(oc,ze){ma.ULS.sendTraceTag(537154582,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Handler called.");
3===ze.operationType?ma.ULS.sendTraceTag(537154581,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Received delete operation."):(oc=ze.SP)?(oc=oc.classificationId,Yc.applyPolicyLabel(oc,oc,null,2)):ma.ULS.sendTraceTag(537154580,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Received an empty annotation.")};Yc.uPf=function(oc,ze){ze?ze.szb&&Yc.businessBar.dC(39)?(Yc.businessBar.removeEntry(39),ma.ULS.sendTraceTag(537154562,306,50,"Remove entry to RecommendedSensitivityLabelBusinessBarEntry succeeded.")):
!ze.szb&&Yc.businessBar.dC(38)&&(Yc.businessBar.removeEntry(38),ma.ULS.sendTraceTag(537154561,306,50,"Remove entry to AutomaticSensitivityLabelBusinessBarEntry succeeded.")):ma.ULS.sendTraceTag(537154563,306,15,"RemoveAutoPolicyBusinessBar is called but AddAutoPolicyBusinessBarEntryEventArgs is null.")};Yc.C3f=function(oc,ze){ze?ze.szb?(Yc.businessBar.FCj(ze.title,ze.message,ze.buttonText,function(Ae){ze.EY(Ae);Yc.businessBar.dC(39)&&Yc.businessBar.removeEntry(39)}),ma.ULS.sendTraceTag(537154531,
306,50,"Add entry to RecommendedSensitivityLabelBusinessBarEntry succeeded. Message is shown to user.")):(Yc.businessBar.sAj(ze.title,ze.message,ze.buttonText,function(Ae){ze.EY(Ae);Yc.businessBar.dC(38)&&Yc.businessBar.removeEntry(38)}),ma.ULS.sendTraceTag(537154530,306,50,"Add entry to AutomaticSensitivityLabelBusinessBarEntry succeeded. Message is shown to user.")):ma.ULS.sendTraceTag(537154560,306,15,"ShowAutoPolicyBusinessBar is called but AddAutoPolicyBusinessBarEntryEventArgs is null.")};Yc.JDd=
yb;Yc.policyManager=mc;Yc.$=Wc;Yc.ga=Nd;Yc.businessBar=Tc;Yc.l$h();Yc.R8i();Yc.disposed=!1;return Yc}function f(){var yb=ke.call(this)||this;yb.classificationId=null;yb.H_=Object.assign(new ie.a,{T_:f.getTypeName(),B_:f.re()});return yb}function x(){var yb=Ec.call(this)||this;yb.recommended=null;yb.automatic=null;yb.source=null;yb.H_=Object.assign(new ie.a,{T_:x.getTypeName(),B_:x.re()});return yb}function y(){var yb=t.call(this)||this;yb.existingLabelPriority=null;yb.H_=Object.assign(new ie.a,{T_:y.getTypeName(),
B_:y.re()});return yb}function t(){var yb=of.call(this)||this;yb.partialDocSITs=null;yb.fullDocSITs=null;yb.H_=Object.assign(new ie.a,{T_:t.getTypeName(),B_:t.re()});return yb}function B(){var yb=kd.call(this)||this;yb.recommended=null;yb.automatic=null;yb.source=null;yb.H_=Object.assign(new ie.a,{T_:B.getTypeName(),B_:B.re()});return yb}function z(yb,mc,Wc,Nd,Tc,Yc,oc){oc=yb.Na(1,void 0===oc?null:oc);oc.tenantId=mc;return mf.i(yb,"GetPolicyApplicationMethod",oc,Wc,Nd,Tc,Yc,4)}function u(yb,mc,Wc,
Nd,Tc,Yc,oc){oc=yb.Na(1,void 0===oc?null:oc);oc.tenantId=mc;return mf.i(yb,"GetPolicyLabelId",oc,Wc,Nd,Tc,Yc,4)}function C(){this.gZa=this.annotationType=null;this.NLa=this.oF=!1}function r(){this.Mpc=this.uYf=null;this.WP=0}function J(){this.v1=this.ZWa=this.tb=this.ih=null}function v(yb,mc,Wc,Nd,Tc){Nd=void 0===Nd?0:Nd;Tc=void 0===Tc?null:Tc;this.gHc=this.N5d=null;this.qra=this.zib=this.Bib=0;this.o8="";this.NEa=this.ZEc=this.b9d=this.opa=this.HMc=null;this.D9d=!1;this.tCa=null;this.JJc=0;this.GUb=
this.PEa=this.wDa=this.FUb=null;this.rb=new Ob.a;this.SJb=this.Dvb=this.KEa=null;this.vKc=!1;this.LAb=null;this.wb=yb;this.Tg=mc;this.Ah=Wc;this.HTb=Nd;this.wn=new fa;this.Zde=this.wb.Ua("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.nP=Tc;this.eyb=yb.ra("WacApplyManualPolicyLabelIsEnabled");this.Afc=yb.ra("CoAuthForProtectedFilesIsEnabled");this.supportsOfficeClientCoauthoring=yb.ra("SupportsOfficeClientCoauthoring");this.tni=!1;this.mtj=3E4;this.me=sa.a.instance;yb.ra("SupportsPolicies")&&
tb.a("MipSupportsPolicies");this.Afc&&this.supportsOfficeClientCoauthoring&&tb.a("MipSupportsOfficeClientCoauthoring")}function D(){}function V(yb,mc,Wc,Nd,Tc,Yc,oc,ze,Ae,Ve,nb,Hc,Cc,Sc,Uc,ae,ue,Lf,xf,Rf,dc){this.url=yb;this.MWj=mc;this.body=Wc;this.headers=Nd;this.$cb=Tc;this.priority=Yc;this.state=oc;this.Mgg=void 0===ze?null:ze;this.mL=void 0===Ae?null:Ae;this.WV=void 0===Ve?!1:Ve;this.i4i=void 0===nb?null:nb;this.Yoj=void 0===Hc?null:Hc;this.name=void 0===Cc?null:Cc;this.PEb=void 0===Sc?null:
Sc;this.dcd=void 0===Uc?!1:Uc;this.sGf=void 0===ae?null:ae;this.Q8b=void 0===ue?null:ue;this.dfc=void 0===Lf?null:Lf;this.Hbb=void 0===xf?null:xf;this.m8h=void 0===Rf?null:Rf;this.responseType=void 0===dc?null:dc}function U(yb){var mc=Hb.call(this)||this;mc.Dyj=yb;return mc}function Q(yb){var mc=Gc.call(this)||this;mc.HKg=yb;return mc}function la(yb,mc,Wc,Nd,Tc,Yc,oc){Nd=void 0===Nd?null:Nd;Tc=void 0===Tc?null:Tc;Yc=void 0===Yc?null:Yc;oc=void 0===oc?null:oc;var ze=Kb.call(this)||this;ze.errorType=
yb;ze.HKg=mc;ze.r4f=Wc;ze.title=Nd;ze.message=Tc;ze.buttonText=Yc;ze.EY=oc;return ze}function ba(yb,mc){var Wc=Sa.call(this)||this;Wc.Mpc=yb;Wc.WP=mc;return Wc}function T(){return gb.call(this)||this}function H(yb,mc){var Wc=Sb.call(this)||this;Wc.epb=yb;Wc.szb=mc;return Wc}function S(yb,mc,Wc,Nd){var Tc=zb.call(this)||this;Tc.title=yb;Tc.Npc=mc;Tc.buttonText=Wc;Tc.svf=Nd;return Tc}function K(yb,mc){var Wc=kc.call(this)||this;Wc.Uxa=yb;Wc.Gqe=mc;return Wc}function da(yb){yb=void 0===yb?!1:yb;var mc=
lb.call(this)||this;mc.onSuccess=yb;return mc}function fa(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelId=null;this.AreLabelsAvailable=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelId="";this.SensitivityLabels=
[];this.MandatoryLabelingEnforced=!1;this.CustomUrl=""}function X(){return Va.call(this)||this}function ca(yb){var mc=bb.call(this)||this;mc.a0j=yb;return mc}function ja(yb,mc,Wc){var Nd=Ia.call(this)||this;Nd.oAe=yb;Nd.nAe=mc;Nd.existingLabelPriority=Wc;return Nd}function ea(yb,mc,Wc,Nd,Tc){var Yc=ra.call(this)||this;Yc.epb=yb;Yc.title=mc;Yc.message=Wc;Yc.buttonText=Nd;Yc.EY=Tc;return Yc}function qa(yb,mc,Wc,Nd,Tc,Yc){var oc=Ba.call(this)||this;oc.epb=yb;oc.title=mc;oc.message=Wc;oc.buttonText=Nd;
oc.EY=Tc;oc.szb=Yc;return oc}function pa(yb,mc,Wc,Nd){this.ULc=this.VLc=null;this.lLc=this.ELc=this.jjb=this.cbe=this.kHc=!1;this.mVa=this.nfa=this.iga=this.rpa=this.kTb=this.Dv=this.j9=this.yh=null;this.fFc=0;this.C6d=this.BLc=this.pFc=null;this.La=yb;this.gf=mc;this.wb=Wc;this.ih=Nd;this.Ujb={};this.$de={};this.dbe={};this.eyb=Wc.ra("WacApplyManualPolicyLabelIsEnabled");this.ih.value.Noe(Object(Ka.a)(this,this.uFd,"processAutoSensitivityLabel"));this.ih.value.DVc(Object(Ka.a)(this,this.uFd,"processAutoSensitivityLabel"));
this.ih.value.jVc(Object(Ka.a)(this,this.RUi,"onUpdateLabelInfo"));eb.AFrameworkApplication.sa&&eb.AFrameworkApplication.sa.UFg(Object(Ka.a)(this,this.y8i,"refreshDocumentPolicyLabelsOnModeChange"));Wc.ra("SupportsPolicies")&&Wc.Ua("AppliedPolicyId")&&(this.VLc=Wc.Ua("IrmPolicyTitle"),this.ULc=Wc.Ua("IrmPolicyDescription"));this.$Oc=Wc.ra("ProtectedFile");this.Dlg=this.wb.Ad("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.Elg=this.wb.Ad("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}
function Pa(){}function Ha(){this.gjb=!!eb.AFrameworkApplication.sa&&eb.AFrameworkApplication.sa.Qa.rw}function Xa(yb,mc,Wc){var Nd=Dc.call(this,!1,!1,!0)||this;if(!yb||!Wc)return ma.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs"),Nd;var Tc={};Tc=(Tc.id="MandatoryLabellingDialog",Tc);Nd.Rng=Wc;Nd.uMc=mc;if(!eb.AFrameworkApplication.ga.ra("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||Nd.uMc&&""!==Nd.uMc)mc={},mc=(mc.href=Nd.uMc,mc.target="_blank",
mc),Wc={},Tc.learnMoreLink=(Wc.type="AppLinkProps",Wc.id="mandatoryLabellingLearnMoreLink",Wc.text=CommonUIStrings.l_LearnMore,Wc.handler=mc,Wc.customTooltip=CommonUIStrings.L_LearnMoreTooltip,Wc);mc={};yb=(mc.id="mandatoryLabellingFlyoutMenuSection",mc.controls=yb,mc);mc={};mc=(mc.sections=[],mc.shouldAutoOpen=!1,mc);Array.add(mc.sections,yb);yb={};Tc.labelFlyout=(yb.type="AppFlyoutAnchorProps",yb.id="mandatoryLabellingFyout",yb.label="Pick a label",yb.hideLabel=!1,yb.hideChevron=!1,yb.hideIcon=
!0,yb.menuDefinition=mc,yb);yb={};yb=(yb.id="MandatoryLabellingDialog",yb.bodyControls=Tc,yb);Tc.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;Tc.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;Nd.initializeAndShow(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(Ka.a)(Nd,Nd.Zyi,"mandatoryLabellingDialogHandler"),yb);return Nd}function Na(yb,mc){var Wc=Mb.call(this,!1,!1,Na.wy)||this;Wc.pqa=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,
CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];Wc.RUb=null;Wc.QUb=!1;Wc.Dge=yb;Wc.cJ=mc;Wc.eg=Wc.BQg();Wc.jc=1;Wc.Ue=Na.id;Wc.Fc(1,CommonUIStrings.l_DialogChange);Wc.vL(1,!1);Wc.xna(0);return Wc}function db(){}function Ja(yb,mc){this.WP=yb;this.displayName=mc}function jb(yb,mc,Wc){Wc=void 0===Wc?null:Wc;this.id=yb.Id;Wc||(Wc="");this.B7i=Wc;this.sensitivityLabel=yb}b.r(F);var hc=b(0),ma=b(13),Ka=b(80),Ta=b(988),ob=b(184);Object(hc.a)(jb,"AutoPolicyLabelData",
null,[]);Object(hc.a)(Ja,"PolicyLabelRequestState",null,[]);var Cb=b(140),eb=b(5),ya=b(370),za=b(12),Ga=b(38),cb=b(29);Sk.Object.defineProperties(db,{hsd:{configurable:!0,enumerable:!0,get:function(){return db.Iqi}}});db.Iqi="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(hc.a)(db,"JustificationDialogHtml",null,[]);var Mb=Cb.a;vm(Na,Mb);Na.prototype.SRd=function(){if(Na.wy)this.initializeAndShow(CommonUIStrings.l_SensitivityJustificationTitle,Object(Ka.a)(this,this.PMf,"reactJustificationDialogHandler"),this.H2e(this.QUb));else{for(var yb={},mc=0;mc<this.pqa.length;mc++)yb[Na.bGd+mc]=!1;yb[Na.oMb]="";this.initializeAndShow(CommonUIStrings.l_SensitivityJustificationTitle,Object(Ka.a)(this,this.Hqi,"justificationDialogHandler"),yb);this.p9i();Ga.a.addHandler($get(Na.oMb),
za.a.input,Object(Ka.a)(this,this.UJj,"textAreaHandler"))}};Na.prototype.validate=function(){if(Na.wy)return this.Rfg(this.RUb);var yb=$get(Na.oMb);return yb.disabled?!0:this.Rfg(yb.value)};Na.prototype.Rfg=function(yb){var mc=2>yb.length,Wc=500<yb.length,Nd=RegExp("[{|}|;|\\\\]").test(yb);yb=""===cb.a.Urc(yb);return!mc&&!Wc&&!Nd&&!yb};Na.prototype.Hqi=function(yb,mc){var Wc="";if(1===yb)for(var Nd=0;Nd<this.pqa.length;Nd++)if(mc[Na.bGd+Nd]){Wc=Nd===this.pqa.length-1?mc[Na.oMb]:this.pqa[Nd];break}this.cJ(yb,
this.Dge,Wc)};Na.prototype.PMf=function(yb){var mc="";1===yb&&this.RUb&&(mc=this.RUb);this.cJ(yb,this.Dge,mc)};Na.prototype.HOi=function(yb){this.RUb=yb;yb=this.validate();this.QUb!==yb&&(this.QUb=yb,this.pBc(CommonUIStrings.l_SensitivityJustificationTitle,Object(Ka.a)(this,this.PMf,"reactJustificationDialogHandler"),this.H2e(this.QUb)))};Na.prototype.H2e=function(yb){var mc={},Wc={},Nd={},Tc={};return Tc.id=this.Ue,Tc.bodyControls=(Wc.choiceGroupProps={},Wc.textAreaProps=(mc.placeholder=CommonUIStrings.l_SensitivityJustificationPlaceholder,
mc),Wc),Tc.actionButtonProps=(Nd.label=CommonUIStrings.l_DialogChange,Nd.disabled=!yb,Nd),Tc.infoMessage=CommonUIStrings.l_SensitivityJustificationMessage,Tc.justificationIrrelevantLabel=CommonUIStrings.l_SensitivityJustificationNoLongerApplies,Tc.justificationIncorrectLabel=CommonUIStrings.l_SensitivityJustificationIncorrect,Tc.justificationOtherLabel=CommonUIStrings.l_SensitivityJustificationOther,Tc.onJustificationUpdated=Object(Ka.a)(this,this.HOi,"onJustificationUpdated"),Tc};Na.prototype.UJj=
function(yb){yb.target&&this.vL(1,this.validate())};Na.prototype.BQg=function(){return Cb.a.Cn(Na.hsd,eb.AFrameworkApplication.KC,ya.getImageClass(Na.iconName),CommonUIStrings.l_SensitivityJustificationMessage,this.pqa[0],this.pqa[1],this.pqa[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)};Na.prototype.p9i=function(){for(var yb=document.getElementsByName(Na.ati),mc=0;mc<yb.length;mc++)Ga.a.addHandler(yb[mc],za.a.focus,Object(Ka.a)(this,this.xLf,"radioButtonFocusHandler")),Ga.a.addHandler(yb[mc],
za.a.click,Object(Ka.a)(this,this.xLf,"radioButtonFocusHandler"))};Na.prototype.xLf=function(yb){if(yb=yb.target){yb.checked=!0;var mc=$get(Na.oMb);yb.id===Na.bGd+(this.pqa.length-1)?(mc.disabled=!1,Sys.UI.DomElement.setVisible(mc,!0),mc.focus()):(mc.disabled=!0,yb.focus());this.vL(1,this.validate())}};Sk.Object.defineProperties(Na,{wy:{configurable:!0,enumerable:!0,get:function(){return eb.AFrameworkApplication.sa.Qa.rw&&eb.AFrameworkApplication.sa.Qa.ahf}}});Na.hsd=db.hsd;Na.ati="ListRadioBox";
Na.bGd="radiobox";Na.oMb="txtJustification";Na.iconName="Info_32x32x32";Na.id="JustificationDialog";Object(hc.a)(Na,"JustificationDialog",Cb.a,[]);var Dc=Cb.a;vm(Xa,Dc);Xa.prototype.Zyi=function(yb,mc){1===yb&&mc.selectedLabel&&(yb=mc.selectedLabel,""!==yb&&this.Rng(yb))};Object(hc.a)(Xa,"MandatoryLabellingDialog",Cb.a,[]);Ha.prototype.K7g=function(yb,mc,Wc){this.gjb&&new Xa(yb,mc,Wc)};Sk.Object.defineProperties(Ha,{instance:{configurable:!0,enumerable:!0,get:function(){return Ha.Oa||(Ha.Oa=new Ha)}}});
Ha.Oa=null;Object(hc.a)(Ha,"MandatoryLabellingDialogFactory",null,[884]);Pa.WGj="sbProtectForm14";Pa.YGj="SBStatusBarMarkAsReadOnly14";Pa.msi="Info_16x16x32";Pa.Ppb="QuickSearchCompletedToday_16x16x32";Pa.CGd="CommonControlCheckboxCheck_16";Pa.u$f="On";Pa.visible="Visible";Pa.AEh="ImageIsVisible";Pa.CI="SourceControlId";Pa.menuItemId="MenuItemId";Pa.menu="Menu";Pa.vWc="AppLockId";Pa.value="Value";Pa.Ei="LabelText";Pa.alt="Alt";Pa.Q$e="Image16by16";Pa.s5a="Image16by16Class";Pa.VGj="SBProtectForm_16";
Pa.XGj="SBStatusBarMarkAsReadOnly_16";Pa.icon="Icon";Pa.iconColor="IconColor";Pa.customTooltip="CustomTooltip";Pa.D6i="MipTagDynamicFillWithOutline_20";Pa.E6i="MipTagLockDynamicFillWithOutline_20";Pa.C6i="MipTagErrorOutline_20";Pa.F6i="MipTagQuestionOutline_20";Pa.CWd="transparent";Object(hc.a)(Pa,"PolicyConstants",null,[]);var vb=b(995),ib=b(844),ub=b(823),Eb=b(914),Ya=b(95),tb=b(176),ec=b(892),Za=b(865),mb=b(168),sc=b(948),pd=b(128),$b=b(89),Xb=b(192),lc=b(808),Oa=b(86),pb=b(104),Ub=b(30),ic=b(52);
pa.prototype.Qg=function(){this.La.fc(Ub.a.QFf,pb.a.frame,Object(Ka.a)(this,this.BJe,"documentLabelPaneHandler"));this.La.ef(Ub.a.kab,pb.a.frame,Object(Ka.a)(this,this.kab,"queryPolicyLabel"),96);this.La.fc(Ub.a.hTa,pb.a.frame,Object(Ka.a)(this,this.hTa,"toggleSensitivity"));this.La.fc(Ub.a.gza,pb.a.frame,Object(Ka.a)(this,this.gza,"populateSensitivityFlyout"));this.La.fc(Ub.a.setSensitivity,pb.a.frame,Object(Ka.a)(this,this.setSensitivity,"setSensitivity"));this.La.ef(Ub.a.lab,pb.a.frame,Object(Ka.a)(this,
this.lab,"querySensitivity"),96);this.La.fc(Ub.a.L6,pb.a.frame,Object(Ka.a)(this,this.L6,"querySensitivityToggleButton"));this.La.fc(Ub.a.K6,pb.a.frame,Object(Ka.a)(this,this.K6,"querySensitivitySubFlyout"));this.ymb(Ub.a.hTa)||this.La.mcb(Ub.a.hTa,4);this.ymb(Ub.a.gza)||this.La.mcb(Ub.a.gza,4);this.ymb(Ub.a.setSensitivity)||this.La.mcb(Ub.a.setSensitivity,4);this.ymb(Ub.a.L6)||this.La.mcb(Ub.a.L6,4);this.ymb(Ub.a.K6)||this.La.mcb(Ub.a.K6,4);this.gf.updateCommandUI()};pa.prototype.kNb=function(){this.La.lD(Ub.a.QFf,
pb.a.frame,Object(Ka.a)(this,this.BJe,"documentLabelPaneHandler"));this.La.lD(Ub.a.kab,pb.a.frame,Object(Ka.a)(this,this.kab,"queryPolicyLabel"));this.La.lD(Ub.a.hTa,pb.a.frame,Object(Ka.a)(this,this.hTa,"toggleSensitivity"));this.La.lD(Ub.a.gza,pb.a.frame,Object(Ka.a)(this,this.gza,"populateSensitivityFlyout"));this.La.lD(Ub.a.setSensitivity,pb.a.frame,Object(Ka.a)(this,this.setSensitivity,"setSensitivity"));this.La.lD(Ub.a.lab,pb.a.frame,Object(Ka.a)(this,this.lab,"querySensitivity"));this.La.lD(Ub.a.L6,
pb.a.frame,Object(Ka.a)(this,this.L6,"querySensitivityToggleButton"));this.La.lD(Ub.a.K6,pb.a.frame,Object(Ka.a)(this,this.K6,"querySensitivitySubFlyout"))};pa.prototype.hTa=function(){return 32};pa.prototype.PXe=function(yb){var mc="mandatoryLabelling_"+yb.Id;this.dbe[mc]=yb.Id;var Wc={};return Wc.type="AppToggleButtonProps",Wc.id=mc,Wc.label=yb.DisplayName,Wc.hideLabel=!1,Wc.customTooltip=yb.Tooltip,Wc};pa.prototype.GTh=function(){var yb=[],mc=this.j9,Wc;for(Wc in mc){var Nd=mc[Wc],Tc=this.Dv[Wc];
if(Tc&&Tc.Enabled)if(Nd.count){var Yc={};Yc=(Yc.sections=[],Yc.shouldAutoOpen=!1,Yc);var oc={};oc=(oc.id="mandatoryLabelling_flyoutMenuSection_"+Tc.Id,oc.controls=[],oc);Nd=yl(Nd);for(var ze=Nd.next();!ze.done;ze=Nd.next())(ze=this.Dv[ze.value])&&ze.Enabled&&Array.add(oc.controls,this.PXe(ze));Array.add(Yc.sections,oc);oc={};Tc=(oc.type="AppFlyoutAnchorProps",oc.id="mandatoryLabelling_"+Tc.Id,oc.label=Tc.DisplayName,oc.hideLabel=!1,oc.hideChevron=!1,oc.hideIcon=!1,oc.menuDefinition=Yc,oc);Array.add(yb,
Tc)}else Array.add(yb,this.PXe(Tc))}return yb};pa.prototype.gza=function(yb,mc,Wc,Nd,Tc){if(1===Wc||!this.ih.value.kha(!0))return 32;Tc.MenuItems=Object.assign(new ec.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(Tc.MenuItems.MenuSectionList,this.Mc(!this.isReactRibbonEnabled()));this.yh.CustomUrl&&Array.add(Tc.MenuItems.MenuSectionList,this.B7g(this.isReactRibbonEnabled()?this.yh.CustomUrl:cb.a.xf(this.yh.CustomUrl)));this.isReactRibbonEnabled()||(Tc.PopulationXML=ub.s(Tc.MenuItems));
return 32};pa.prototype.lab=function(yb,mc,Wc,Nd,Tc){if(1===Wc||!Tc||!this.eyb)return 32;this.yh=this.ih.value.wn;if(this.ih.value.kha(!0)&&(Tc[Pa.visible]=!0,tb.a("MipLabelsAvailable"),this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&this.yh&&this.yh.AreLabelsAvailable&&(yb=Oa.a.instance.oc("Common.ISystemInitiatedFeedback")))){var Yc=pa.oi(this.yh.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";yb.execute(function(oc){oc.logActivity(Yc,
null)})}return 32};pa.prototype.L6=function(yb,mc,Wc,Nd,Tc){if(1===Wc||!Tc)return 32;var Yc,oc;Tc[Pa.u$f]=!!(Yc=Tc[Pa.menuItemId])&&!!(oc=this.Ujb[Yc])&&oc===this.yh.AppliedPolicyId;return 32};pa.prototype.K6=function(yb,mc,Wc,Nd,Tc){if(1===Wc||!Tc)return 32;var Yc,oc,ze;yb=!!(Yc=Tc[Pa.CI])&&!!(oc=this.Ujb[Yc])&&!!(ze=this.j9[oc])&&ze.contains(this.yh.AppliedPolicyId);Tc[Pa.AEh]=yb;Tc[Pa.u$f]=yb;return 32};pa.prototype.setSensitivity=function(yb,mc,Wc,Nd,Tc){return 1!==Wc&&Tc?this.Dcb(this.Ujb[Tc[Pa.CI]],
Tc,2):32};pa.prototype.Ufc=function(){return!!eb.AFrameworkApplication.sa&&1===eb.AFrameworkApplication.sa.mode};pa.prototype.y8i=function(){this.lLc&&!this.Ufc()&&(this.lLc=!1,this.ih.value.x8i())};pa.prototype.oag=function(){this.yh.DefaultLabelId&&this.yh.MandatoryLabelingEnforced?this.kHc||this.Ufc()?this.yh.AppliedPolicyId?this.d9c(""):(this.ih.value.Emi(this.ih.value.LAb)||this.Ufc())&&this.WLe():this.CZf():this.yh.DefaultLabelId?this.CZf():this.yh.MandatoryLabelingEnforced&&(this.yh.AppliedPolicyId?
this.d9c(""):this.WLe())};pa.prototype.Mff=function(){return this.yh.MandatoryLabelingEnforced?this.yh&&this.yh.AreLabelsAvailable?this.wb.ra("TestOverrideIsReactDialogEnabled")||this.gf&&this.gf.Qa&&this.gf.Qa.rw?!0:(ma.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(ma.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(ma.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),
!1)};pa.prototype.WLe=function(){var yb=this;!this.Mff()||eb.AFrameworkApplication.q5||this.cbe||(this.cbe=eb.AFrameworkApplication.q5=!0,ma.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.ih.value.QLf("",1),this.ih.value.tUc(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,function(){yb.Xyi()}))};pa.prototype.d9c=function(yb){this.Mff()&&
eb.AFrameworkApplication.q5&&(eb.AFrameworkApplication.q5=!1,ma.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.ih.value.LId(),this.ih.value.QLf(yb,2))};pa.prototype.Xyi=function(){Ha.instance.K7g(this.GTh(),this.yh.CustomUrl,Object(Ka.a)(this,this.Yyi,"mandatoryLabellingDialogCallback"))};pa.prototype.Yyi=function(yb){this.d9c(this.dbe[yb])};pa.prototype.Ite=function(){return this.wb.ra("CoAuthForProtectedFilesEnabled")&&this.wb.ra("SupportsOfficeClientCoauthoring")&&
this.wb.ra("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.C6d&&this.fzb};pa.prototype.Dcb=function(yb,mc,Wc){var Nd=this;this.ih.value.l5i(Wc);var Tc=32,Yc=!1,oc=!0,ze=2===Wc||8===Wc||16===Wc,Ae=yb===this.yh.AppliedPolicyId;if(this.pFc&&this.pFc(yb,ze))ma.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",Wc),this.gf.updateCommandUI();else if(mc&&Pa.vWc in mc&&this.ih.value.zsj(mc[Pa.vWc]),yb)if(this.ih.value.Rhf()||
this.Ite()&&this.ELc)ma.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",Wc),this.gf.updateCommandUI(),ze&&this.MZb(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.wb.ra("HasDocumentEditRights"))if(this.ih.value.QUg(yb))if(this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelHasUDPEnabled",!1)&&this.Dv[yb]&&this.Dv[yb].HasUserDefinedPermissions&&
!Ae)ma.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",Wc),1!==Wc&&4!==Wc&&this.SIg();else if(ze&&this.yh.MandatoryLabelingEnforced&&Ae)ma.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",Wc),this.MZb(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);else{if(ze&&this.wb.ra("WacLabelingJustificationDialogIsEnabled")&&
this.yh.RequiredDowngradeJustification&&(Ae||this.Dv[yb].RequiredDowngradeJustification)&&!this.kTb)return ma.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",Wc),this.SRd(yb),Tc;if(this.Ite()&&!this.C6d())this.fFc<this.Dlg?(ma.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.fFc,Wc),this.ELc=!0,this.fFc++,ic.Task.delay(this.Elg).continueWith(function(){Nd.ELc=!1;Nd.Dcb(yb,mc,
Wc)})):(ma.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",Wc),Yc=1!==Wc,oc=!1,Tc=8);else{if(this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacBlockParentLabelSetLabel",!1)&&this.pli(yb)&&(ma.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",Wc),1===Wc||8===Wc||4===Wc))return Tc;ma.ULS.sendTraceTag(570972056,
306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",Wc);this.setPolicyLabel(Ae?"":yb,this.kTb,Wc);return Tc}}else ma.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",Wc),this.gf.updateCommandUI(),ze&&this.MZb(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else ma.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",
Wc),this.gf.updateCommandUI(),ze&&this.MZb(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else ma.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",Wc),this.gf.updateCommandUI(),Yc=ze,oc=!1,Tc=8;this.ih.value.pGd(0,Wc,Yc,oc);return Tc};pa.prototype.lZa=function(yb,mc,Wc,Nd){Wc=void 0===Wc?null:Wc;Nd=void 0===Nd?!1:Nd;Ya.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",
0,"wordclpfc",null);this.wb.ra("SupportsOfficeClientCoauthoring")&&this.wb.ra("CoAuthForProtectedFilesIsEnabled")?(this.jjb=!1,(this.yh=this.ih.value.wn)&&!this.yh.AppliedPolicyId?this.jjb=!0:this.yh&&this.yh.PolicyLabelAssignmentMethod&&(this.jjb=Xb.c(this.yh.PolicyLabelAssignmentMethod)===Xb.c("standard"))):this.jjb=Nd;yb=pa.oi(yb)?null:this.Dv[yb];(mc=pa.oi(mc)?null:this.Dv[mc])?this.iga=new jb(mc,!0,Wc):(this.ih.value.jda(29),this.nfa=null);yb?this.rpa=new jb(yb,!1):this.mVa=null;this.uFd(null,
null);return 32};pa.prototype.JKg=function(yb){""!==this.yh.AppliedPolicyId?this.ih.value.pGd(4,16,!0):this.Dcb(yb,null,16)};pa.prototype.t_f=function(){this.Dv={};if(this.yh=this.ih.value.wn)for(var yb=yl(this.yh.SensitivityLabels),mc=yb.next();!mc.done;mc=yb.next())mc=mc.value,this.Dv[mc.Id]=mc};pa.prototype.pli=function(yb){if(this.j9&&yb in this.j9){yb=yl(this.j9[yb]);for(var mc=yb.next();!mc.done;mc=yb.next())if((mc=this.Dv[mc.value])&&mc.Enabled)return!0}return!1};pa.prototype.b0f=function(){this.j9=
{};if(this.yh=this.ih.value.wn){for(var yb=yl(this.yh.SensitivityLabels),mc=yb.next();!mc.done;mc=yb.next())mc=mc.value,mc.ParentId||(this.j9[mc.Id]=new ob.a);yb=yl(this.yh.SensitivityLabels);for(mc=yb.next();!mc.done;mc=yb.next())mc=mc.value,mc.ParentId&&mc.ParentId in this.j9&&this.j9[mc.ParentId].add(mc.Id)}};pa.prototype.cLf=function(){if(this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)){this.yh=this.ih.value.wn;var yb=this.eyb&&this.isReactRibbonEnabled()&&
this.ih.value.kha();pa.yQa(yb)}else this.eyb&&this.isReactRibbonEnabled()?(this.yh=this.ih.value.wn,this.ih.value.kha()?(pa.yQa(!0),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!1))):pa.yQa(!1)):pa.yQa(!1)};pa.prototype.T8i=function(yb){this.pFc=yb};pa.prototype.L9i=function(yb){this.BLc=yb};pa.prototype.CZf=function(){this.wb.ra("WacApplyDefaultPolicyLabelIsEnabled")&&(this.Ufc()?this.lLc=!0:this.kHc||(this.kHc=!0,(this.yh=this.ih.value.wn)&&this.yh.DefaultLabelId&&
!this.yh.AppliedPolicyId&&(ma.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.yh.DefaultLabelId),this.Dcb(this.yh.DefaultLabelId,null,1))))};pa.prototype.uFd=function(){var yb=this;if(!this.ih.value.Rhf()){var mc=this.Dv[this.ih.value.wn.AppliedPolicyId];this.jjb&&this.rpa&&this.mVa!==this.rpa.id&&(!mc||mc.Order<this.rpa.sensitivityLabel.Order)&&(mc=this.Dcb(this.rpa.id,{},4),32!==mc?ma.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+
mc):(this.mVa=this.rpa.id,this.nfa&&(mc=this.Dv[this.nfa])&&mc.Order<=this.rpa.sensitivityLabel.Order&&(this.ih.value.jda(29),this.nfa=null)));mc=this.Dv[this.ih.value.wn.AppliedPolicyId];if(this.iga&&this.nfa!==this.iga.id&&(!mc||mc.Order<this.iga.sensitivityLabel.Order)){var Wc=this.iga.id;this.ih.value.jda(29);this.ih.value.kYb(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.pgd(this.iga.sensitivityLabel))+" "+this.iga.B7i,CommonUIStrings.l_PolicyLabelRecommendationButton,
function(){yb.Dcb(Wc,{},8)});this.nfa=this.iga.id}this.iga=this.rpa=null}};pa.prototype.setPolicyLabel=function(yb,mc,Wc){Wc=void 0===Wc?2:Wc;this.kTb=mc;this.ih.value.setPolicyLabel(yb);this.gf.updateCommandUI();mc=new Ja(Wc,this.pgd(this.Dv[yb]));this.ih.value.cPd(yb,this.kTb,mc)};pa.prototype.L2g=function(yb,mc,Wc){1===yb?this.setPolicyLabel(mc===this.yh.AppliedPolicyId?"":mc,Wc):this.gf.updateCommandUI()};pa.prototype.SRd=function(yb){(new Na(yb,Object(Ka.a)(this,this.L2g,"continueToSetPolicyLabel"))).SRd()};
pa.prototype.MZb=function(yb,mc){yb=void 0===yb?"":yb;mc=void 0===mc?"":mc;var Wc=new pd.StandardDialog;Wc.Su=eb.AFrameworkApplication.kyb;Wc.jc=0;Wc.Fc(1,CommonUIStrings.l_DialogClose);Wc.mX(yb,mc,null)};pa.prototype.OOg=function(yb){1===yb&&this.ih.value.p5i()};pa.prototype.SIg=function(){var yb=new pd.StandardDialog;yb.Su=eb.AFrameworkApplication.kyb;yb.jc=1;yb.Fc(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);yb.Fc(0,CommonUIStrings.l_DialogClose);yb.mX(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,
CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,Object(Ka.a)(this,this.OOg,"blockUDPSetLabelHandler"))};pa.prototype.isReactRibbonEnabled=function(){return!!this.gf&&!!this.gf.Qa&&this.gf.Qa.Oi};pa.prototype.whc=function(){return this.gf&&this.gf.Qa?this.gf.Qa.whc:!1};pa.prototype.BJe=function(){return 32};pa.prototype.kab=function(yb,mc,Wc,Nd,Tc){if(1===Wc)return 32;this.yh=this.ih.value.wn;if(!this.yh||!Tc)return 32;Tc[Pa.value]="";Tc[Pa.Ei]="";Tc[Pa.alt]=null;Tc[Pa.Q$e]=null;Tc[Pa.s5a]=null;
Tc[Pa.customTooltip]="";Tc[Pa.visible]=!1;Tc[Pa.iconColor]="";Wc=mc=yb=Tc[Pa.icon]="";if(!this.yh.AreLabelsAvailable){if(!this.VLc)return 32;yb=this.VLc;Wc=Pa.CWd;this.ULc&&(mc=this.ULc)}else if(this.yh.AppliedPolicyId){Nd=null;for(var Yc=yl(this.yh.SensitivityLabels),oc=Yc.next();!oc.done;oc=Yc.next())if(oc=oc.value,oc.Id.toLowerCase()===this.yh.AppliedPolicyId.toLowerCase()){Nd=oc;break}Nd&&(yb=this.pgd(Nd),mc=Nd.Tooltip,this.$Oc=eb.AFrameworkApplication.protectedFile=Nd.IsEndpointProtectionEnabled,
Wc=this.PYe(Nd))}this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(yb?(Tc[Pa.value]=yb,Tc[Pa.Ei]=yb,Tc[Pa.customTooltip]=mc,this.E_f(Wc,this.$Oc,Tc)):this.wb.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ClpUseOutlineImageForNoLabel")?(Tc[Pa.iconColor]=Pa.CWd,this.yh.MandatoryLabelingEnforced?(Tc[Pa.value]=Tc[Pa.Ei]=HeaderStrings.SelectASensitivityLabel,Tc[Pa.icon]=Pa.C6i):(Tc[Pa.value]=Tc[Pa.Ei]=HeaderStrings.NoSensitivityLabel,Tc[Pa.icon]=Pa.F6i)):
(Tc[Pa.iconColor]="#000000",this.yh.MandatoryLabelingEnforced?(Tc[Pa.value]=Tc[Pa.Ei]=HeaderStrings.SelectASensitivityLabel,Tc[Pa.icon]="MipTagErrorDynamicColor_20"):(Tc[Pa.value]=Tc[Pa.Ei]=HeaderStrings.NoSensitivityLabel,Tc[Pa.icon]="MipTagQuestionDynamicColor_20")),Tc[Pa.visible]=!0):yb&&(Tc[Pa.value]=yb,Tc[Pa.Ei]=yb,this.whc()?Tc[Pa.customTooltip]=mc:Tc[Pa.alt]=mc,this.E_f(Wc,this.$Oc,Tc),Tc[Pa.visible]=!0);return 32};pa.prototype.pgd=function(yb){return yb?this.Dv?yb.ParentId&&this.Dv[yb.ParentId]?
this.Dv[yb.ParentId].DisplayName+"\\"+yb.DisplayName:yb.DisplayName:(ma.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),yb.DisplayName):""};pa.prototype.E_f=function(yb,mc,Wc){this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(Wc[Pa.icon]=this.l4e(mc),Wc[Pa.iconColor]=this.m4e(yb)):this.whc()?Wc[Pa.icon]=mc?Pa.VGj:Pa.XGj:(Wc[Pa.Q$e]=eb.AFrameworkApplication.KC,Wc[Pa.s5a]=mc?ya.getImageClass(Pa.WGj):ya.getImageClass(Pa.YGj))};
pa.prototype.B7g=function(yb){var mc=this.AU("LearnMoreSection",!0);yb=Object.assign(new ib.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:yb,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:eb.AFrameworkApplication.KC,Image16by16Class:ya.getImageClass(Pa.msi),Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(mc.ControlList,yb);return mc};pa.prototype.CFe=function(yb,mc,Wc){Wc=void 0===Wc?!1:Wc;var Nd="Toggle_"+yb.Id;Nd="Sensitivity_"+
Nd;var Tc=yb.DisplayName,Yc=yb.Tooltip,oc=yb.Id===this.yh.AppliedPolicyId,ze=Wc?cb.a.xf(Nd):Nd;this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(oc=this.PYe(yb),mc=Object.assign(new sc.a,{Id:ze,ExternalId:ze,LabelText:Wc?cb.a.xf(Tc):Tc,Command:"2935633379",MenuItemId:ze,QueryCommand:"991261903",Visible:!0,Alt:Wc?cb.a.xf(Yc):Yc,AriaLabel:$b.a.x_b,IconColor:this.m4e(oc),KeyTip:mc}),mc.ExternalImageId=this.l4e(yb.IsEndpointProtectionEnabled)):(ze=Object.assign(new vb.a,
{Id:ze,ExternalId:ze,LabelText:Wc?cb.a.xf(Tc):Tc,Command:"2935633379",MenuItemId:ze,QueryCommand:"991261903",CheckedImage:eb.AFrameworkApplication.KC,Visible:!0,Alt:Wc?cb.a.xf(Yc):Yc,IsChecked:oc,AriaLabel:$b.a.x_b,KeyTip:mc}),this.isReactRibbonEnabled()?(ze.CheckedImageClass=ya.getImageClass(Pa.CGd),ze.ExternalImageId=Pa.CGd):ze.CheckedImageClass=ya.getImageClass(Pa.Ppb),mc=ze);ze=Nd;this.Ujb[ze]=yb.Id;this.$de[yb.Id]=ze;return mc};pa.prototype.AU=function(yb,mc){mc=void 0===mc?!1:mc;return Object.assign(new Za.a,
{Title:"",Id:yb,DisplayMode:Pa.menu,ShowMenuSectionSeparator:mc,ControlsId:"Ctrl_"+yb,ControlList:[]})};pa.prototype.w$g=function(yb,mc,Wc){yb=this.AU(yb+"Sub");var Nd=1;mc=yl(mc);for(var Tc=mc.next();!Tc.done;Tc=mc.next())(Tc=this.Dv[Tc.value])&&Tc.Enabled&&(Array.add(yb.ControlList,this.CFe(Tc,Nd.toString(),Wc)),Nd++);return yb};pa.prototype.Mc=function(yb){yb=void 0===yb?!1:yb;var mc=this.AU("SensitivitySection"),Wc=1,Nd=this.j9,Tc;for(Tc in Nd){var Yc=Nd[Tc],oc=this.Dv[Tc];if(oc&&oc.Enabled){if(Yc.count){var ze=
"Sensitivity_"+oc.Name,Ae=yb?cb.a.xf(ze):ze;Ae=Object.assign(new Eb.a,{Id:Ae,ExternalId:Ae,LabelText:yb?cb.a.xf(oc.DisplayName):oc.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new ec.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:$b.a.x_b,KeyTip:Wc.toString()});this.isReactRibbonEnabled()?Ae.ExternalImageId=Pa.CGd:(Ae.Image16by16=eb.AFrameworkApplication.KC,Ae.Image16by16Class=ya.getImageClass(Pa.Ppb));
Array.add(Ae.Menu.MenuSectionList,this.w$g(ze,Yc,yb));Array.add(mc.ControlList,Ae);this.Ujb[Ae.Id]=oc.Id;this.$de[oc.Id]=Ae.Id}else Array.add(mc.ControlList,this.CFe(oc,Wc.toString(),yb));Wc++}}return mc};pa.prototype.ymb=function(yb){return!!this.La.u4(yb)&&!!this.La.u4(yb).flags&&!!this.La.u4(yb).flags.length};pa.prototype.RUi=function(yb,mc){mc.onSuccess&&this.Dv&&(yb=this.Dv[this.ih.value.wn.AppliedPolicyId])&&(this.nfa&&(mc=this.Dv[this.nfa])&&mc.Order<=yb.Order&&(this.ih.value.jda(29),this.nfa=
null),this.mVa&&this.mVa!==yb.Id&&(this.ih.value.jda(28),this.mVa=null))};pa.prototype.l4e=function(yb){return yb?Pa.E6i:Pa.D6i};pa.prototype.m4e=function(yb){return yb?yb:Pa.CWd};pa.prototype.PYe=function(yb){if(yb.Color||!yb.ParentId)return yb.Color;var mc=this.Dv[yb.ParentId];return mc?mc.Color:yb.Color};pa.yQa=function(yb){eb.AFrameworkApplication.ga&&eb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(yb?(lc.a.yyd("ribbon","sensitivity"),
lc.a.uyd("ribbon","sensitivity")):lc.a.xyd("ribbon","sensitivity"));eb.AFrameworkApplication.ga&&eb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&mb.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!yb))};pa.oi=function(yb){return yb&&yb.length?!1:!0};Sk.Object.defineProperties(pa.prototype,{fzb:{configurable:!0,enumerable:!0,get:function(){return eb.AFrameworkApplication.fzb||!!this.BLc&&this.BLc()}}});
Object(hc.a)(pa,"PolicyActor",null,[856]);var Jb=b(686),cc=b(574),Ob=b(93),P;(function(yb){yb[yb.unknown=0]="unknown";yb[yb.boot=1]="boot";yb[yb.refresh=2]="refresh";yb[yb.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(P||(P={}));Object(hc.b)("GetPolicyLabelsReason",P);var Ba=Sys.EventArgs;vm(qa,Ba);Object(hc.a)(qa,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);var ra=Sys.EventArgs;vm(ea,ra);Object(hc.a)(ea,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var ta;(function(yb){yb[yb.none=
0]="none";yb[yb.reasonDefaultLabel=1]="reasonDefaultLabel";yb[yb.reasonManual=2]="reasonManual";yb[yb.reasonAutomatic=4]="reasonAutomatic";yb[yb.reasonRecommended=8]="reasonRecommended";yb[yb.reasonMandatory=16]="reasonMandatory"})(ta||(ta={}));Object(hc.b)("ApplyLabelFlags",ta);var Ia=Sys.EventArgs;vm(ja,Ia);Object(hc.a)(ja,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);var bb=Sys.EventArgs;vm(ca,bb);Object(hc.a)(ca,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);var Va=Sys.EventArgs;vm(X,Va);Object(hc.a)(X,
"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);Object(hc.a)(fa,"GetPolicyLabelsData",null,[]);var lb=Sys.EventArgs;vm(da,lb);Object(hc.a)(da,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);var kc=Sys.EventArgs;vm(K,kc);Object(hc.a)(K,"MandatoryLabellingAppHandlerEventArgs",Sys.EventArgs,[]);var zb=Sys.EventArgs;vm(S,zb);Object(hc.a)(S,"PolicyTipEventArgs",Sys.EventArgs,[]);var Sb=Sys.EventArgs;vm(H,Sb);Object(hc.a)(H,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);var gb=Sys.EventArgs;
vm(T,gb);Object(hc.a)(T,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var Sa=Sys.EventArgs;vm(ba,Sa);Object(hc.a)(ba,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);var Kb=Sys.EventArgs;vm(la,Kb);Object(hc.a)(la,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);var Gc=Sys.EventArgs;vm(Q,Gc);Object(hc.a)(Q,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);var Hb=Sys.EventArgs;vm(U,Hb);Object(hc.a)(U,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var Lb=b(108),sa=b(98),Ua=
b(40),Yb=b(78),jc=b(47);Object(hc.a)(V,"ClientRequest",null,[]);var md=b(419),jd=b(309);D.irj=function(yb,mc){if(!yb||!mc||yb.count!==mc.count)return!1;yb=yl(yb);for(var Wc=yb.next();!Wc.done;Wc=yb.next())if(!mc.contains(Wc.value))return!1;return!0};D.toArray=function(yb){if(!yb)return null;var mc=Array(yb.count),Wc=0;yb=yl(yb);for(var Nd=yb.next();!Nd.done;Nd=yb.next())mc[Wc]=Nd.value,Wc++;return mc};Object(hc.a)(D,"HashSetUtils",null,[]);var Zc=b(271),Qb=b(75),fd=b(338);v.prototype.xoe=function(yb){this.rb.addHandler("PolicyTipEvent",
yb)};v.prototype.jVc=function(yb){this.rb.addHandler("LabelInfoUpdateEvent",yb)};v.prototype.Noe=function(yb){this.rb.addHandler("SetPolicyLabelEventKey",yb)};v.prototype.eej=function(yb){this.rb.removeHandler("SetPolicyLabelEventKey",yb)};v.prototype.DVc=function(yb){this.rb.addHandler("SetPolicyLabelFailureEventKey",yb)};v.prototype.dej=function(yb){this.rb.removeHandler("SetPolicyLabelFailureEventKey",yb)};v.prototype.iFg=function(yb){this.rb.addHandler("GetPolicyLabelEventKey",yb)};v.prototype.hFg=
function(yb){this.rb.addHandler("GetPolicyLabelFailureEventKey",yb)};v.prototype.fFg=function(yb){this.rb.addHandler("GetAutoPolicyLabelEventKey",yb);this.$md&&(ma.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),this.fGd(new ca(0)))};v.prototype.xcj=function(yb){this.rb.removeHandler("GetAutoPolicyLabelEventKey",yb)};v.prototype.CEg=function(yb){this.rb.addHandler("CreateAutoCLPSecurityNodesEventKey",yb)};v.prototype.Zbj=
function(yb){this.rb.removeHandler("CreateAutoCLPSecurityNodesEventKey",yb)};v.prototype.BHg=function(yb){this.rb.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",yb)};v.prototype.vej=function(yb){this.rb.removeHandler("UpdateAutoCLPLabelPriorityNodeEventKey",yb)};v.prototype.CHg=function(yb){this.rb.addHandler("UpdateAutoCLPSITNodesEventKey",yb)};v.prototype.wej=function(yb){this.rb.removeHandler("UpdateAutoCLPSITNodesEventKey",yb)};v.prototype.mne=function(yb){this.rb.addHandler("AddAutoPolicyBusinessBarEntryEventKey",
yb)};v.prototype.rbj=function(yb){this.rb.removeHandler("AddAutoPolicyBusinessBarEntryEventKey",yb)};v.prototype.Aoe=function(yb){this.rb.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",yb)};v.prototype.Ndj=function(yb){this.rb.removeHandler("RemoveAutoPolicyBusinessBarEntryEventKey",yb)};v.prototype.nne=function(yb){this.rb.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",yb)};v.prototype.tbj=function(yb){this.rb.removeHandler("AddMandatoryLabellingBusinessBarEntryEventKey",yb)};
v.prototype.Boe=function(yb){this.rb.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",yb)};v.prototype.Odj=function(yb){this.rb.removeHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",yb)};v.prototype.QFg=function(yb){this.rb.addHandler("MandatoryLabellingAppHandlerEventKey",yb)};v.prototype.adj=function(yb){this.rb.removeHandler("MandatoryLabellingAppHandlerEventKey",yb)};v.prototype.zHg=function(yb){this.rb.addHandler("UDPLabelingAppHandlerEventKey",yb)};v.prototype.uej=function(yb){this.rb.removeHandler("UDPLabelingAppHandlerEventKey",
yb)};v.prototype.lXg=function(){return eb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsClpBlockedByAppSpecificScenarioEnabled",!1)?this.b9d?this.b9d():!1:!1};v.prototype.P8i=function(yb){this.ZEc=yb};v.prototype.ew=function(){return(new Date).getTime()};v.prototype.Fac=function(){this.Ah&&(this.FUb=this.Ah.Hc("WebServiceCall","Call Get Policy Endpoint On Server"));var yb=Zc.a.oia(1,1);this.wb.ra("SendHostAttributionInfoForPolicyLabelEnabled")?(yb=new V(this.d4a("datalosspolicy"),
1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,yb),this.Tg.send(yb).MHd(Object(Ka.a)(this,this.Qwf,"onDataLossPolicySuccessCallback"),Object(Ka.a)(this,this.Pwf,"onDataLossPolicyFailureCallback"))):this.Tg.Xl(this.d4a("datalosspolicy"),1,null,null,!0,2,Object(Ka.a)(this,this.Qwf,"onDataLossPolicySuccessCallback"),Object(Ka.a)(this,this.Pwf,"onDataLossPolicyFailureCallback"),null);this.Bib++;ma.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",
this.Zde,this.Bib)};v.prototype.x8i=function(){this.sed(this.o8,2,this.opa)};v.prototype.sed=function(yb,mc,Wc,Nd){mc=void 0===mc?0:mc;Wc=void 0===Wc?null:Wc;Nd=void 0===Nd?!1:Nd;Ya.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.Ced(void 0,mc));this.Dvb=this.ew();var Tc=this.Y3c(mc);this.Eac(yb,Tc,Wc,Nd,mc)};v.prototype.Qwf=function(yb){this.$Hf();var mc=this.ZWd(yb);yb=mc.data;mc.returnValue&&(ma.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),
this.Bib=0,this.Ah&&(this.GUb=this.Ah.Hc("Task","Parse and Handle Get Policy Response")),this.XXi(yb),this.GUb&&(this.GUb.stop(),this.GUb=null))};v.prototype.Pwf=function(yb){this.$Hf();this.Bib<=this.HTb?this.Fac():(ma.ULS.sendTraceTag(25565154,306,15,"Request to get DataLossPrevention policy failed with error response: {0}.",yb?yb.data?yb.data.KQa:null:null),this.Bib=0)};v.prototype.Rhf=function(){return 0<this.qra};v.prototype.setPolicyLabel=function(yb){this.wn.AppliedPolicyId=yb};v.prototype.cPd=
function(yb,mc,Wc){Wc=void 0===Wc?null:Wc;var Nd=this.f7g(Wc);this.ltj(yb,mc,Nd,Wc)};v.prototype.FDf=function(yb){this.PEa&&(this.PEa.stop(),this.PEa=null);var mc=this.t3e(yb);var Wc=mc.EXf;mc=mc.i0f;var Nd=yb.data.state,Tc=Nd?Nd.WP:2,Yc=this.ZWd(yb);yb=Yc.data;Yc.returnValue?(ma.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",Tc),this.qra=0,this.oYi(yb,Wc,mc,Nd)):this.LLd(Tc)};v.prototype.l5i=function(yb){Ya.Health.instance.recordKpiUsage("MipSetPolicyLabel",
0,"officewebclp",this.Ced(yb));this.SJb=this.ew();ma.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.rb.raiseEvent("SetPolicyLabelTriggeredEventKey",new Q(yb))};v.prototype.MEi=function(){this.Afc&&this.supportsOfficeClientCoauthoring&&this.Pmi&&this.KEa.Nda(12,null,!0)};v.prototype.EDf=function(yb){this.PEa&&(this.PEa.stop(),this.PEa=null);var mc=this.t3e(yb);var Wc=mc.EXf;mc=mc.i0f;this.qra<=this.HTb?this.cPd(Wc,mc):(Wc=(Wc=yb.data.state)?Wc.WP:2,ma.ULS.sendTraceTag(41799708,
306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",yb?yb.data?yb.data.KQa:null:null,Wc),this.LAb="WACServerConnectionFailed",this.qra=0,this.LLd(Wc))};v.prototype.Emi=function(yb){if(yb&&("LabelNotSupported"===yb||"LabelErrorRetryLater"===yb||"CoherencyFailure"===yb||"LabelIdNotFound"===yb||"LabelDisabled"===yb))return ma.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",yb),!0;ma.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",
yb);return!1};v.prototype.QUg=function(yb){if(!yb)return!1;for(var mc=null,Wc=null,Nd=yl(this.wn.SensitivityLabels),Tc=Nd.next();!Tc.done;Tc=Nd.next())Tc=Tc.value,Tc.Id===yb&&(mc=Tc),Tc.Id===this.o8&&(Wc=Tc);if(!mc)return!1;if(this.Afc&&this.supportsOfficeClientCoauthoring){if(this.ZEc&&this.ZEc()||this.kod)return!0}else if(eb.AFrameworkApplication.Ry&&eb.AFrameworkApplication.Ry.rub||this.opa&&this.opa())return!0;return mc.IsEndpointProtectionEnabled===(!!Wc&&Wc.IsEndpointProtectionEnabled)};v.prototype.kYb=
function(yb,mc,Wc,Nd,Tc){28===yb?this.zLf(new qa(yb,mc,Wc,Nd,Tc,!1)):this.zLf(new qa(yb,mc,Wc,Nd,Tc,!0))};v.prototype.jda=function(yb){28===yb?this.aMf(new H(yb,!1)):this.aMf(new H(yb,!0))};v.prototype.x4i=function(yb,mc,Wc){ma.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");this.rb.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new ja(yb,mc,Wc))};v.prototype.q5i=function(yb){ma.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");
this.rb.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new ja(null,null,yb))};v.prototype.r5i=function(yb,mc){ma.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.rb.raiseEvent("UpdateAutoCLPSITNodesEventKey",new ja(yb,mc,null))};v.prototype.QLf=function(yb,mc){ma.ULS.sendTraceTag(572650527,306,50,"Raising a mandatory labelling"+(1===mc?"Reading":"Edit")+" switch event.");this.rb.raiseEvent("MandatoryLabellingAppHandlerEventKey",new K(yb,mc))};v.prototype.tUc=function(yb,
mc,Wc,Nd,Tc){37===yb&&this.n4i(new ea(37,mc,Wc,Nd,Tc))};v.prototype.LId=function(){this.f5i(new T)};v.prototype.p5i=function(){ma.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.rb.raiseEvent("UDPLabelingAppHandlerEventKey",new U(!0))};v.prototype.kha=function(yb){yb=void 0===yb?!1:yb;var mc=!!this.wn&&this.wn.AreLabelsAvailable&&!!this.wn.SensitivityLabels&&0<this.wn.SensitivityLabels.length&&jd.a.any(this.wn.SensitivityLabels,function(Wc){return!!Wc&&Wc.Enabled});mc||yb||
pa.yQa(!1);return mc};v.prototype.Syf=function(yb){this.wDa&&(this.wDa.stop(),this.wDa=null);var mc=this.ZWd(yb);var Wc=mc.data;mc.returnValue?(ma.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.zib=0,Wc=this.fYi(Wc),yb=this.p2e(yb.data),Ya.Health.instance.recordKpiSuccess("MipGetPolicyLabel",this.M$b(void 0,yb,this.Dvb)),this.Dvb=null,yb=new ca(yb),this.I4i(yb),this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?Wc&&this.oxj()?
this.$md?this.mRj():(this.T3b(),this.fGd(yb),this.vKc=!0):Wc||this.Rqc():!this.$md&&Wc&&this.wb.ra("WacApplyManualPolicyLabelIsEnabled")&&this.dse()?(this.fGd(yb),this.vKc=!0):Wc||this.Rqc()):this.Rqc()};v.prototype.oxj=function(){if(!this.wb.ra("WacApplyManualPolicyLabelIsEnabled"))return ma.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),!1;if(!this.dse())return!1;if(""===this.o8)return ma.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),
!0;if(this.tCa===this.JJc)return ma.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;ma.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0};v.prototype.T3b=function(){this.Rcg();ma.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.NEa.count,this.tCa);var yb=D.toArray(this.NEa);
this.x4i(yb,yb,this.tCa)};v.prototype.mRj=function(){var yb=this.NEa;this.Rcg();D.irj(yb,this.NEa)||(ma.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.NEa.count),yb=D.toArray(this.NEa),this.r5i(yb,yb));this.D9d&&(ma.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",this.tCa),this.q5i(this.tCa))};v.prototype.Rcg=function(){for(var yb=new Jb.a(cc.a.Hk()),mc=yl(this.wn.SensitivityLabels),Wc=mc.next();!Wc.done;Wc=mc.next())if((Wc=
Wc.value)&&Wc.AutoLabelingSensitiveTypeIds&&0<Wc.AutoLabelingSensitiveTypeIds.length){Wc=yl(Wc.AutoLabelingSensitiveTypeIds);for(var Nd=Wc.next();!Nd.done;Nd=Wc.next())(Nd=Nd.value)&&yb.add(Nd)}this.NEa=yb};v.prototype.Ryf=function(yb){var mc=this.p2e(yb.data);Ya.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",!1,!1,this.M$b(void 0,mc,this.Dvb));this.Dvb=null;this.wDa&&(this.wDa.stop(),this.wDa=null);if(this.zib<=this.HTb){if(this.wb.ra("SendHostAttributionInfoForPolicyLabelEnabled")){var Wc=
yb.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in Wc&&Wc[Zc.a.FMd]&&"HostAttributionInfo.ScenarioTypeParamName"in Wc&&Wc[Zc.a.GMd]){yb.data.request.get_headers();yb.data.request.get_headers();yb=this.Y3c(mc);this.Eac(this.o8,yb,this.opa,void 0,mc);return}}this.sed(this.o8,mc,this.opa)}else ma.ULS.sendTraceTag(34996494,306,15,"Request to get label policy failed with error response: {0}.",yb?yb.data?yb.data.KQa:null:null),this.Rqc(),this.zib=0};v.prototype.p2e=function(yb){return yb.state?
yb.state:0};v.prototype.d4a=function(yb,mc){mc=void 0===mc?!1:mc;var Wc=String.format("{0}{1}?action={2}&{3}",this.wb.Ua("PolicyHandlerWebServiceBase")||eb.AFrameworkApplication.sa.Qa.jW,this.Zde,yb,eb.AFrameworkApplication.mj);"setpolicylabel"===yb&&eb.AFrameworkApplication.Ry&&eb.AFrameworkApplication.Ry.pef&&(Wc=Yb.a.il(Wc,"sl","1"));mc&&(Wc=Yb.a.il(Wc,"cbd","1"));return Wc};v.prototype.t3e=function(yb){var mc;var Wc=mc=null;yb&&yb.data&&yb.data.request&&yb.data.request.get_headers()&&(Wc=yb.data.request.get_headers()[md.a.FXf],
mc=yb.data.request.get_headers()[md.a.j0f]);return{EXf:Wc,i0f:mc}};v.prototype.ZWd=function(yb){yb=yb?yb.data?yb.data.ie:null:null;return yb&&yb.length&&!this.oni(yb)?{returnValue:!0,data:yb}:(ma.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:yb})};v.prototype.XXi=function(yb){try{var mc=Ua.b(yb)}catch(Wc){ma.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(mc)if(mc.IsPolicyTipAvailable)switch(mc.IsPolicyTipAvailable.toLowerCase()){case "false":ma.ULS.sendTraceTag(26007261,
306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":ma.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.gHc=mc.NavigateUrl;this.rCj(mc.GeneralText,Object(Ka.a)(this,this.XJi,"onDataLossPolicyOverrideButtonClick"));break;default:ma.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",mc.IsPolicyTipAvailable)}else ma.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");
else ma.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")};v.prototype.oYi=function(yb,mc,Wc,Nd){var Tc=this,Yc=Nd?Nd.WP:2,oc=0,ze="",Ae;if(function(){var nb=Ua.d(yb);Ae=nb.Ju;return nb}().returnValue)if(Ae){ze="Success";var Ve=this.Y3c(3);if(Ae.IsSuccessful){Ya.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.M$b(Yc,void 0,this.SJb));this.LAb=this.SJb=null;ma.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",
Yc);2===Yc&&this.jda(29);this.luj(mc,Yc);this.MEi();this.jda(28);Nd&&4===Yc&&this.kYb(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,Nd.displayName),CommonUIStrings.l_DialogOk,function(){});tb.a("MipAppliedLabels",void 0,void 0,[Object.assign(new Qb.a,{name:"SetPolicyLabelApplyFlag",string:ta[Yc]})]);this.Eac(mc,Ve,this.opa,void 0,3);return}ma.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",
Yc,Ae.FailureReason);this.LAb=Ae.FailureReason;"FileTooLarge"===Ae.FailureReason?oc=1:"LabelNotSupported"===Ae.FailureReason?oc=2:"LabelDisabled"===Ae.FailureReason?oc=3:"MinorVersionLimitExceeded"===Ae.FailureReason&&(oc=5);this.tni&&0<=Ae.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(Nd=new Lb.a(2,1,this.mtj,function(){ma.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",Tc.qra);Tc.qra<=Tc.HTb&&Tc.cPd(mc,
Wc)}),this.me.Zg(Nd));this.Afc&&this.supportsOfficeClientCoauthoring&&this.Eac(this.wn.AppliedPolicyId,Ve,this.opa,!0,3)}else ze="setPolicyLabelData null.",ma.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",Yc);else ze="TryDeserialize failed.",ma.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",Yc);this.LLd(Yc,oc);Yc=this.M$b(Yc,void 0,this.SJb);this.SJb=
null;Yc.extendedProperties.set("SetPolicyLabelDataFailureReason",this.LAb);Yc.extendedProperties.set("SetPolicyLabelDataParseStatus",ze.toString());Ya.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,Yc)};v.prototype.LLd=function(yb,mc){mc=void 0===mc?0:mc;this.setPolicyLabel(this.o8);this.OLf(new da);this.pGd(mc,yb,2===yb||8===yb||16===yb,!1)};v.prototype.luj=function(yb,mc){this.setPolicyLabel(this.o8=yb);if(""===yb)eb.AFrameworkApplication.protectedFile=!1,eb.AFrameworkApplication.enableMacrosForProtectedFile=
!1;else for(var Wc=yl(this.wn.SensitivityLabels),Nd=Wc.next();!Nd.done;Nd=Wc.next())if(Nd=Nd.value,Nd.Id===yb){eb.AFrameworkApplication.protectedFile=Nd.IsEndpointProtectionEnabled;break}this.k5i(new ba(yb,mc))};v.prototype.eTj=function(){for(var yb=yl(this.wn.SensitivityLabels),mc=yb.next();!mc.done;mc=yb.next())(mc=mc.value)&&mc.Enabled&&(mc.Id===this.o8&&(this.D9d=this.tCa!==mc.Order,this.tCa=mc.Order),mc.Order>this.JJc&&(this.JJc=mc.Order))};v.prototype.fYi=function(yb){var mc=Ua.d(yb);yb=mc.Ju;
if(!mc.returnValue)return ma.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!yb)return ma.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!yb.AreLabelsAvailable)return!1;this.wn=yb;this.o8=yb.AppliedPolicyId;this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.eTj();this.kha()&&ma.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");
this.OLf(new da(!0));return!0};v.prototype.dse=function(){if(!this.kha())return ma.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(var yb=yl(this.wn.SensitivityLabels),mc=yb.next();!mc.done;mc=yb.next())if((mc=mc.value)&&mc.AutoLabelingSensitiveTypeIds&&0<mc.AutoLabelingSensitiveTypeIds.length)return!0;ma.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1};
v.prototype.OLf=function(yb){ma.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.rb.raiseEvent("LabelInfoUpdateEvent",yb)};v.prototype.I4i=function(yb){ma.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.rb.raiseEvent("GetPolicyLabelEventKey",yb)};v.prototype.Rqc=function(){pa.yQa(!1);this.rb.raiseEvent("GetPolicyLabelFailureEventKey",new X)};v.prototype.fGd=function(yb){var mc=this;this.nP&&this.nP.execute(function(Wc){Wc=[Wc.isFeatureEnabled("MsoClpSpTwo",
!0),Wc.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(Wc).then(function(Nd){jd.a.any(Nd,function(Tc){return Tc})&&(ma.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),mc.rb.raiseEvent("GetAutoPolicyLabelEventKey",yb),tb.a("MipAutoClassificationEnabled"));return null})})};v.prototype.Ced=function(yb,mc){yb=void 0===yb?null:yb;mc=void 0===mc?null:mc;var Wc=new Map;Wc.set("ClpCoauth",this.supportsOfficeClientCoauthoring.toString());null!=yb&&Wc.set("ApplyLabelFlags",ta[yb]);
null!=mc&&Wc.set("GetPolicyLabelsReason",P[mc]);return Wc};v.prototype.M$b=function(yb,mc,Wc){yb=void 0===yb?null:yb;mc=void 0===mc?null:mc;Wc=void 0===Wc?null:Wc;var Nd=new fd.a;Nd.extendedProperties=this.Ced(yb,mc);null!=Wc&&(Nd.durationMs=this.ew()-Wc);return Nd};v.prototype.k5i=function(yb){ma.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.rb.raiseEvent("SetPolicyLabelEventKey",yb)};v.prototype.zLf=function(yb){ma.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");
yb&&yb.szb&&tb.a("MipRecommendations");this.rb.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",yb)};v.prototype.aMf=function(yb){ma.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.rb.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",yb)};v.prototype.n4i=function(yb){ma.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.rb.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",yb)};v.prototype.f5i=
function(yb){ma.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");this.rb.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",yb)};v.prototype.rCj=function(yb,mc){mc=void 0===mc?null:mc;ma.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.rb.raiseEvent("PolicyTipEvent",new S(CommonUIStrings.l_PolicyBusinessBarTitle,yb,CommonUIStrings.l_PolicyOverrideButton,mc))};v.prototype.pGd=function(yb,mc,Wc,Nd){var Tc=this;ma.ULS.sendTraceTag(42074656,
306,void 0===Nd||Nd?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",mc);if(this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CommonBusinessBarEntryForSensitivityLabelError",!1)){Nd=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;var Yc=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,oc=null,ze=null;switch(yb){case 1:Nd=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;Yc=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;
break;case 2:Nd=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;Yc=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 3:Nd=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;Yc=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 4:Nd=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;Yc=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;
break;case 5:Nd=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,Yc=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,oc=CommonUIStrings.l_LearnMore,ze=function(){Tc.k0f()}}yb=new la(yb,mc,Wc,Nd,Yc,oc,ze)}else yb=5===yb?new la(yb,mc,Wc,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,CommonUIStrings.l_LearnMore,
function(){Tc.k0f()}):new la(yb,mc,Wc);this.rb.raiseEvent("SetPolicyLabelFailureEventKey",yb)};v.prototype.zsj=function(yb){this.HMc=yb};v.prototype.XJi=function(){this.gHc?(ma.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),jc.a.fV(this.gHc)):ma.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")};v.prototype.oni=function(yb){if(!yb.startsWith("<")||-1===yb.indexOf("Error")&&-1===yb.indexOf("Unavailable"))return!1;ma.ULS.sendTraceTag(25565189,
306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0};v.prototype.$Hf=function(){this.FUb&&(this.FUb.stop(),this.FUb=null)};v.prototype.oJh=function(yb){if(!yb)return"manual";switch(yb.WP){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}};v.prototype.vKh=function(yb){if(!yb)return"privileged";
yb=yb.WP;var mc="privileged";if(4===yb||1===yb)mc="standard";return mc};v.prototype.Eac=function(yb,mc,Wc,Nd,Tc){Wc=void 0===Wc?null:Wc;Nd=void 0===Nd?!1:Nd;Tc=void 0===Tc?0:Tc;this.wb.ra("WacLabelingGetPolicyLabelsIsEnabled")&&(this.o8=yb,this.opa=Wc,this.Ah&&(this.wDa=this.Ah.Hc("WebServiceCall","Call Get Policy Endpoint On Server")),Wc={},Wc[md.a.yKg]=yb,this.wb.ra("SendHostAttributionInfoForPolicyLabelEnabled")?(yb=new V(this.d4a("getpolicylabels",Nd),1,null,Wc,!0,2,Tc,void 0,void 0,void 0,void 0,
void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,mc),this.Tg.send(yb).MHd(Object(Ka.a)(this,this.Syf,"onGetPolicyLabelsSuccessCallback"),Object(Ka.a)(this,this.Ryf,"onGetPolicyLabelsFailureCallback"))):this.Tg.Xl(this.d4a("getpolicylabels",Nd),1,null,Wc,!0,2,Object(Ka.a)(this,this.Syf,"onGetPolicyLabelsSuccessCallback"),Object(Ka.a)(this,this.Ryf,"onGetPolicyLabelsFailureCallback"),Tc,void 0,void 0,void 0,void 0,"22"),this.zib++,ma.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",
this.zib))};v.prototype.ltj=function(yb,mc,Wc,Nd){Nd=void 0===Nd?null:Nd;if(this.eyb){this.Ah&&(this.PEa=this.Ah.Hc("WebServiceCall","Call Set Policy Endpoint On Server"));var Tc={};Tc[md.a.FXf]=yb;mc&&(Tc[md.a.j0f]=encodeURIComponent(mc));this.HMc&&(Tc[md.a.QJg]=this.HMc);Nd?(Tc[md.a.g0f]=this.oJh(Nd),Tc[md.a.h0f]=this.vKh(Nd)):(Tc[md.a.g0f]="manual",Tc[md.a.h0f]="privileged");this.supportsOfficeClientCoauthoring&&this.wn&&(Tc[md.a.ZZi]=this.wn.PolicyLabelVersionToken);this.wb.ra("SendHostAttributionInfoForPolicyLabelEnabled")?
(yb=new V(this.d4a("setpolicylabel",!0),1,null,Tc,!0,2,Nd,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,Wc),this.Tg.send(yb).MHd(Object(Ka.a)(this,this.FDf,"onSetPolicyLabelSuccessCallback"),Object(Ka.a)(this,this.EDf,"onSetPolicyLabelFailureCallback"))):this.Tg.Xl(this.d4a("setpolicylabel",!0),1,null,Tc,!0,2,Object(Ka.a)(this,this.FDf,"onSetPolicyLabelSuccessCallback"),Object(Ka.a)(this,this.EDf,"onSetPolicyLabelFailureCallback"),Nd,void 0,void 0,void 0,void 0,
"32");this.qra++;ma.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.qra)}else ma.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")};v.prototype.k0f=function(){var yb=new pd.StandardDialog,mc=this.wb.Ua("BreadcrumbFolderUrl");mc?(yb.jc=11,yb.Fc(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),yb.Fc(2,CommonUIStrings.l_DialogOk)):(yb.jc=
0,yb.Fc(1,CommonUIStrings.l_DialogOk));yb.jme(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");yb.Caj();yb.mX(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,function(Wc){1===Wc&&mc&&jc.a.vf(mc,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})};v.prototype.Y3c=function(yb){switch(yb){case 1:return Zc.a.oia(1,
1);case 2:return Zc.a.oia(7,1);case 3:return Zc.a.oia(8,1);default:return Zc.a.oia(7,0)}};v.prototype.f7g=function(yb){yb=void 0===yb?null:yb;if(!yb)return Zc.a.oia(8,0);switch(yb.WP){case 1:case 16:return Zc.a.oia(1,1);case 4:case 2:case 8:return Zc.a.oia(8,1);default:return Zc.a.oia(8,0)}};Sk.Object.defineProperties(v.prototype,{$md:{configurable:!0,enumerable:!0,get:function(){return this.vKc}},kod:{configurable:!0,enumerable:!0,get:function(){if(!this.N5d)return!1;for(var yb=yl(this.N5d.Z_j()),
mc=yb.next();!mc.done;mc=yb.next())if(mc=mc.value,!mc.Capabilities||!mc.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}},Pmi:{configurable:!0,enumerable:!0,get:function(){return!!this.KEa}}});Object(hc.a)(v,"PolicyManager",null,[855]);var xd=b(144),Ad=b(273);J.prototype.init=function(){var yb=this;eb.AFrameworkApplication.ga.ra("ShouldInitCommonPolicyPackage")&&(eb.AFrameworkApplication.ga.ra("IsDataLossPreventionEnabledForUser")&&eb.AFrameworkApplication.sa&&(this.ih=this.tb.resolve("Common.App.Policy.Contracts.IPolicyManager"),
this.ih.xoe(Object(Ka.a)(this,this.bSd,"showPolicyBusinessBar")),ma.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),xd.a.get_instance().kl(6,function(){yb.ih.Fac()})),eb.AFrameworkApplication.ga.ra("WacLabelingPoliciesIsEnabled")&&eb.AFrameworkApplication.ga.ra("SupportsPolicies")?xd.a.get_instance().kl(6,Object(Ka.a)(this,this.gHi,"onAfterRibbonBehaviorAttached")):pa.yQa(!1))};J.prototype.dispose=function(){};J.prototype.ji=function(yb){yb.register(855,"Common.App.Policy.Contracts.IPolicyManager").Bc().Lc(function(){return new v(eb.AFrameworkApplication.ga,
eb.AFrameworkApplication.Jd,eb.AFrameworkApplication.sa.xD,eb.AFrameworkApplication.ga.Ad("MaxGetPolicyRetries",1),yb.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),eb.AFrameworkApplication.sa.Qa.Pj)});yb.register(pa,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").Bc().Lc(function(){return new pa(eb.AFrameworkApplication.Gb,eb.AFrameworkApplication.sa,eb.AFrameworkApplication.ga,yb.rLd("Common.App.Policy.Contracts.IPolicyManager"))});this.tb=yb};
J.prototype.gHi=function(){this.ZWa=this.tb.resolve("Common.App.Policy.PolicyActor");this.ZWa.Qg();this.v1=this.tb.Oh("CommonUI.BusinessBar");this.ih||(this.ih=this.tb.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.ih.jVc(Object(Ka.a)(this,this.nYd,"updateLabelInfo"));eb.AFrameworkApplication.ga.ra("WacApplyManualPolicyLabelIsEnabled")&&(this.ih.DVc(Object(Ka.a)(this,this.r5h,"handleSetPolicyLabelFailure")),this.ih.mne(Object(Ka.a)(this,this.kYb,"addAutoPolicyBusinessBarEntry")),this.ih.Aoe(Object(Ka.a)(this,
this.jda,"removeAutoPolicyBusinessBarEntry")),this.ih.nne(Object(Ka.a)(this,this.tUc,"addMandatoryLabellingBusinessBarEntry")),this.ih.Boe(Object(Ka.a)(this,this.LId,"removeMandatoryLabellingBusinessBarEntry")))};J.prototype.nYd=function(){this.ZWa.b0f();this.ZWa.t_f();this.ZWa.cLf();var yb=this.ih.lXg();eb.AFrameworkApplication.ga.ra("HasDocumentEditRights")&&!yb?this.ZWa.oag():ma.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",
eb.AFrameworkApplication.ga.ra("HasDocumentEditRights"),yb);eb.AFrameworkApplication.sa.updateCommandUI()};J.prototype.bSd=function(yb,mc){this.n2e(mc.title,mc.Npc,38,mc.svf,mc.buttonText);ma.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")};J.prototype.r5h=function(yb,mc){if(mc.r4f){yb=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;var Wc=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,Nd=null,Tc=null;
eb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CommonBusinessBarEntryForSensitivityLabelError",!1)?(yb=mc.title,Wc=mc.message,Nd=mc.buttonText,Tc=mc.EY):1===mc.errorType?(yb=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle,Wc=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage):2===mc.errorType?(yb=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle,Wc=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage):
eb.AFrameworkApplication.ga.ra("ClpLabelDisabledErrorCodeIsEnabled")&&3===mc.errorType?(yb=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle,Wc=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage):4===mc.errorType?(yb=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle,Wc=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage):5===mc.errorType&&(yb=mc.title,Wc=mc.message,Nd=mc.buttonText,Tc=mc.EY);this.n2e(yb,Wc,21,null,
null,Tc,Nd);ma.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user.")}};J.prototype.jda=function(){};J.prototype.kYb=function(yb,mc){this.v1&&(this.ih.jda(mc.epb),yb=new Ta.a(mc.title,mc.message,null),yb.id=mc.epb,yb.closeable=!0,yb.image=3,yb.addButton(mc.buttonText,mc.EY,mc.buttonText,!0),this.v1.$D(yb,!1))};J.prototype.tUc=function(yb,mc){this.v1&&(yb=new Ta.a(mc.title,mc.message,null),yb.id=mc.epb,yb.closeable=!1,yb.image=3,yb.addButton(mc.buttonText,
mc.EY,mc.buttonText,!1),this.v1.$D(yb,!1))};J.prototype.LId=function(){};J.prototype.n2e=function(yb,mc,Wc,Nd,Tc,Yc,oc){Nd=void 0===Nd?null:Nd;Tc=void 0===Tc?null:Tc;Yc=void 0===Yc?null:Yc;oc=void 0===oc?null:oc;yb=new Ta.a(yb,mc,null);yb.id=Wc;yb.closeable=!0;Nd&&yb.GBg(Tc,Nd);Yc&&yb.addButton(oc,Yc,oc)};J.main=function(){Ad.a.instance.sj(new J)};Sk.Object.defineProperties(J.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.Policy"}}});Object(hc.a)(J,"PackageManager",
null,[4,5]);var Me=b(10),Ue=b(685),Jd=b(214),Sd=b(56),se=b(35),oe=b(84),Ke=b(36),bc=b(307),qd=b(369),zc=b(164),ld=b(92),rb=b(27),Wd=b(303),rc=b(1),nd=b(19),me=b(272);Object(hc.a)(r,"ApplyPolicyContextParameters",null,[]);var be=b(816),sd=b(583),Qe=b(44),Sf=b(42);Object(hc.a)(C,"AnnotationActivationOptions",null,[]);var mf=b(81),Zd=b(847),ie=b(821),kd=Zd.a;vm(B,kd);B.getTypeName=function(){return"AugLoop_SecurityClp_LabellingAnnotation"};B.re=function(){return["AugLoop_Core_Annotation"]};Object(hc.a)(B,
"LabellingAnnotation",Zd.a,[]);var ge=b(848),of=ge.a;vm(t,of);t.getTypeName=function(){return"AugLoop_SecurityShared_SecurityShared"};t.re=function(){return[]};Object(hc.a)(t,"SecurityShared",ge.a,[]);vm(y,t);y.getTypeName=function(){return"AugLoop_SecurityShared_CLP"};y.re=function(){return["AugLoop_SecurityShared_SecurityShared"]};Object(hc.a)(y,"CLP",t,[]);var Ec=Zd.a;vm(x,Ec);x.getTypeName=function(){return"AugLoop_Automatic_Clp_LabellingAnnotation"};x.re=function(){return["AugLoop_Core_Annotation"]};
Object(hc.a)(x,"LabellingAnnotation",Zd.a,[]);var Cd=b(1121),Qd=b(1013),od=b(1123),ke=Zd.a;vm(f,ke);f.getTypeName=function(){return"AugLoop_LinkedDataType_LinkedDataTypeAnnotation"};f.re=function(){return["AugLoop_Core_Annotation"]};Object(hc.a)(f,"LinkedDataTypeAnnotation",Zd.a,[]);var Re=Ke.a;vm(m,Re);m.prototype.dispose=function(){this.disposed||(this.disposed=!0,this.Fdh(),this.KHe(),this.JDd=this.policyManager=this.augmentationLoopManager=null,Re.prototype.dispose.call(this))};m.prototype.lZa=
function(yb,mc,Wc,Nd,Tc){Tc=void 0===Tc?!1:Tc;ma.ULS.sendTraceTag(537154642,306,50,"AutoPolicyManager: ApplyAutoPolicyLabel called for LabellingSource {0} with AutoLabelPresent: {1}, RecommendedLabelPresent: {2}, isStandard: {3}.",Nd,!!yb,!!mc,Tc);this.qc?this.JDd&&(this.RUg(mc,Nd)?(this.bFd=mc,this.XEd=Nd,this.Bkf.ia(Nd,mc)):mc=this.bFd,yb=this.JDd.lZa(yb,mc,Wc,Tc),ma.ULS.sendTraceTag(537154640,306,50,"AutoPolicyManager::ApplyAutoPolicyLabel - policyActor.ApplyAutoPolicyLabel returned {0}.",yb)):
ma.ULS.sendTraceTag(537154641,306,15,"AutoPolicyManager: ApplyAutoPolicyLabel failing because IsDisposed: {0}, IsSessionActive: {1}.",this.disposed,this.$.ea.qc)};m.prototype.RUg=function(yb,mc){if(!this.policyManager.kha())return ma.ULS.sendTraceTag(537154639,306,15,"CanShowRecommendedSensitivityLabel - Labels are not available."),!1;var Wc=this.policyManager.wn;var Nd=this.Bkf.Gc(this.XEd).value;var Tc=null,Yc=null,oc=null;Wc=yl(Wc.SensitivityLabels);for(var ze=Wc.next();!ze.done;ze=Wc.next())ze=
ze.value,ze.Id===yb&&(Tc=ze),ze.Id===Nd&&(Yc=ze),ze.Id===this.bFd&&(oc=ze);return Yc&&Yc.Id===yb?(ma.ULS.sendTraceTag(537154638,306,50,"AutoPolicyManager: CanShowRecommendedSensitivityLabel - Suppressing the recommendation since it is same as last recommendation from current source."),!1):this.businessBar.dC(39)&&this.XEd!==mc&&oc&&(!Tc||oc.Order>=Tc.Order)?(ma.ULS.sendTraceTag(537154637,306,50,"AutoPolicyManager: CanShowRecommendedSensitivityLabel - Suppressing the recommendation since current label priority is lower than last label priority."),
!1):!0};m.prototype.Wmd=function(){return rc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)};m.prototype.R8i=function(){this.policyManager.mne(this.C3f);this.policyManager.Aoe(this.uPf);this.$.ea.K9(this.m6);this.Wmd()&&(this.policyManager.CEg(this.T3b),this.policyManager.BHg(this.Pcg),this.policyManager.CHg(this.Qcg))};m.prototype.Fdh=function(){this.businessBar.removeEntry(39);this.businessBar.removeEntry(38);this.policyManager.rbj(this.C3f);this.policyManager.Ndj(this.uPf);
this.$.ea.Z6(this.m6);rc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(this.policyManager.Zbj(this.T3b),this.policyManager.vej(this.Pcg),this.policyManager.wej(this.Qcg))};m.prototype.l$h=function(){this.rA=new be.a(sd.a.iK());var yb=this.Wmd()?B.getTypeName():x.getTypeName();this.rA.add(1,Object.assign(new C,{annotationType:yb,gZa:this.fri,oF:!1,NLa:!1}));this.rA.add(2,Object.assign(new C,{annotationType:f.getTypeName(),gZa:this.Ysi,oF:!1,NLa:!1}))};
m.prototype.P7f=function(){for(var yb=yl(this.e$a),mc=yb.next();!mc.done;mc=yb.next())this.augmentationLoopManager.submitOperation(mc.value);this.e$a=[]};m.prototype.M8i=function(yb){if(!this.rA.xb(yb))return ma.ULS.sendTraceTag(537154636,306,15,"AutoPolicyManager::RegisterAnnotation - AnnotationActivationOptions not available for LabellingSource {0}.",yb),!1;if(this.rA.oa(yb).oF)return ma.ULS.sendTraceTag(537154635,306,15,"AutoPolicyManager::RegisterAnnotation - Annotations already registered for LabellingSource {0}.",
yb),!0;this.rA.oa(yb).oF=!0;ma.ULS.sendTraceTag(537154634,306,50,"AutoPolicyManager::RegisterAnnotation - Annotations registered for LabellingSource {0}.",yb);if(!this.$.isEditMode)return ma.ULS.sendTraceTag(537154633,306,50,"AutoPolicyManager::RegisterAnnotation - Skipping AugmentationLoop initialization in view mode."),!0;rc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?this.Exb():this.raf();return!0};m.prototype.raf=function(){for(var yb=this,mc=!1,Wc=
yl(this.rA),Nd=Wc.next();!Nd.done&&!(mc=Nd.value.value.oF||mc);Nd=Wc.next());mc?this.augmentationLoopManager?(ma.ULS.sendTraceTag(537154631,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - AugmentationLoop already initialized."),this.IXb()):this.EZa?ma.ULS.sendTraceTag(537154630,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - AugmentationLoop initialization in-progress."):(this.EZa=!0,mc=this.$.ya.FlightingSettings.AutoCLPStartUpDelay,
ma.ULS.sendTraceTag(537154629,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - Initializing AugmentationLoop in {0} milliseconds.",mc),Qe.a.instance.create(function(){yb.n$h()},mc,Sf.a.Ate,!0,!0)):ma.ULS.sendTraceTag(537154632,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - no registered annotations.")};m.prototype.Exb=function(){var yb=this,mc=0<this.e$a.length;if(!mc)for(var Wc=yl(this.rA),Nd=Wc.next();!Nd.done&&!(mc=Nd.value.value.oF||
mc);Nd=Wc.next());mc?this.augmentationLoopManager?(ma.ULS.sendTraceTag(537154627,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessary - AugmentationLoop already initialized."),this.IXb(),this.P7f()):this.EZa?ma.ULS.sendTraceTag(537154626,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessary - AugmentationLoop initialization in-progress."):(this.EZa=!0,mc=this.$.ya.FlightingSettings.AutoCLPStartUpDelay,ma.ULS.sendTraceTag(537154625,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessary - Initializing AugmentationLoop in {0} milliseconds.",
mc),Qe.a.instance.create(function(){yb.o$h()},mc,Sf.a.Ate,!0,!0)):ma.ULS.sendTraceTag(537154628,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessary - no registered annotations and operations.")};m.prototype.o$h=function(){var yb=this;se.TaskExtensions.Ba(Sd.GetServiceTaskFactory.Wa(this.$.da,328,327,1),function(mc){yb.augmentationLoopManager=mc.result;yb.EZa=!1;yb.augmentationLoopManager?(ma.ULS.sendTraceTag(537154595,306,50,"AutoPolicyManager::InitAugmentationLoop - AugmentationLoopManager instantiated."),
yb.augmentationLoopManager.eUc(yb.umc),yb.$.isEditMode?(yb.IXb(),yb.P7f()):ma.ULS.sendTraceTag(537154594,306,50,"AutoPolicyManager::InitAugmentationLoop - Skipping annotation activation in view mode.")):ma.ULS.sendTraceTag(537154624,306,10,"AutoPolicyManager::InitAugmentationLoop - Failed to instantiate AugmentationLoopManager.")},this.ma,3)};m.prototype.n$h=function(){var yb=this;se.TaskExtensions.Ba(Sd.GetServiceTaskFactory.Wa(this.$.da,328,327,1),function(mc){yb.augmentationLoopManager=mc.result;
yb.EZa=!1;yb.augmentationLoopManager?(ma.ULS.sendTraceTag(571479120,306,50,"AutoPolicyManager::InitAugmentationLoop - AugmentationLoopManager instantiated."),yb.augmentationLoopManager.eUc(yb.umc),yb.$.isEditMode?yb.IXb():ma.ULS.sendTraceTag(537154592,306,50,"AutoPolicyManager::InitAugmentationLoop - Skipping annotation activation in view mode.")):ma.ULS.sendTraceTag(537154593,306,10,"AutoPolicyManager::InitAugmentationLoop - Failed to instantiate AugmentationLoopManager.")},this.ma,3)};m.prototype.KHe=
function(){for(var yb=yl(this.rA),mc=yb.next();!mc.done;mc=yb.next())mc=mc.value,mc.value.oF&&this.Edh(mc.key)};m.prototype.Edh=function(yb){this.rA.oa(yb).NLa&&this.IGe(yb);this.rA.oa(yb).oF=!1;ma.ULS.sendTraceTag(537154591,306,50,"AutoPolicyManager::DeregisterAnnotation completed for LabellingSource {0}.",yb)};m.prototype.IXb=function(){for(var yb=yl(this.rA),mc=yb.next();!mc.done;mc=yb.next())mc=mc.value,mc.value.oF&&!mc.value.NLa&&this.activateAnnotation(mc.key)};m.prototype.activateAnnotation=
function(yb){this.augmentationLoopManager.activateAnnotation(this.rA.oa(yb).annotationType);this.augmentationLoopManager.OT(this.rA.oa(yb).annotationType,this.rA.oa(yb).gZa);this.rA.oa(yb).NLa=!0;ma.ULS.sendTraceTag(537154590,306,50,"AutoPolicyManager::ActivateAnnotation completed for LabellingSource {0}.",yb)};m.prototype.Vbh=function(){for(var yb=yl(this.rA),mc=yb.next();!mc.done;mc=yb.next())mc=mc.value,mc.value.NLa&&this.IGe(mc.key)};m.prototype.IGe=function(yb){this.augmentationLoopManager.oQa(this.rA.oa(yb).annotationType,
this.rA.oa(yb).gZa);this.rA.oa(yb).NLa=!1;ma.ULS.sendTraceTag(537154589,306,50,"AutoPolicyManager::DeactivateAnnotation completed for LabellingSource {0}.",yb)};m.prototype.applyPolicyLabel=function(yb,mc,Wc,Nd){var Tc=this;if(this.ga.ra("SupportsOfficeClientCoauthoring"))ma.ULS.sendTraceTag(537154579,306,50,"AutoPolicyManager::ApplyPolicyLabel - SupportsOfficeClientCoauthoring is enabled."),this.lZa(yb,mc,Wc,Nd);else{ma.ULS.sendTraceTag(537154578,306,50,"AutoPolicyManager::ApplyPolicyLabel - SupportsOfficeClientCoauthoring is disabled.");
var Yc=function(oc){Tc.lZa(yb,mc,Wc,Nd,0===oc||1===oc||4===oc)};this.vgd(Yc,function(){Yc(2)},this.Mpf)}};m.prototype.DXc=function(yb,mc){var Wc=this.abg(yb);yb=Wc.sensitivityLabel;var Nd=Wc.gGa;if(!Wc.returnValue)return ma.ULS.sendTraceTag(537154577,306,15,"AutoApplyOrRecommendPolicyLabel - Failed to set the sensitivity labels."),!1;if(Nd&&Nd.Order>=yb.Order)return ma.ULS.sendTraceTag(537154576,306,50,"AutoApplyOrRecommendPolicyLabel - The applied label has a higher sensitivty."),!1;this.applyPolicyLabel(yb.Id,
yb.Id,null,mc);return!0};m.prototype.EXc=function(yb,mc){var Wc=this;mc=!1;var Nd=null,Tc=null;if(!function(){var ze=Wc.abg(yb);Nd=ze.sensitivityLabel;Tc=ze.gGa;return ze}().returnValue)return ma.ULS.sendTraceTag(537154575,306,15,"AutoApplyOrRecommendPowerBILabel - Failed to set the sensitivity labels."),{returnValue:!1,lMa:mc};if(Tc&&Tc.ParentId&&Nd.ParentId&&Tc.ParentId===Nd.ParentId)return ma.ULS.sendTraceTag(537154574,306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - Label has a common parent with AppliedLabel."),
{returnValue:!1,lMa:mc};if(Tc&&Tc.Order>=Nd.Order)return ma.ULS.sendTraceTag(537154573,306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - Label does not have a higher priority than AppliedLabel."),{returnValue:!1,lMa:mc};if(this.ga.ra("SupportsOfficeClientCoauthoring")){ma.ULS.sendTraceTag(537154572,306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - SupportsOfficeClientCoauthoring is enabled.");var Yc=this.policyManager.wn;Yc=!Yc.AppliedPolicyId||!Yc.PolicyLabelAssignmentMethod||
Xb.c(Yc.PolicyLabelAssignmentMethod)===Xb.c("standard");this.Yre(Nd.Id,Yc)}else{ma.ULS.sendTraceTag(537154571,306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - SupportsOfficeClientCoauthoring is disabled.");var oc=function(ze){Wc.Yre(Nd.Id,0===ze||1===ze||4===ze)};this.vgd(oc,function(){oc(2)},this.Mpf)}return{returnValue:!0,lMa:mc}};m.prototype.vgd=function(yb,mc,Wc,Nd){var Tc=this;Nd=void 0===Nd?0:Nd;if(this.qc){var Yc=this.$.na.ta.Zb();z(this.$.na.ta,this.$.ya.DocumentHostInfo.TenantId,
function(oc){Tc.UVh(oc,yb)},function(){Tc.TVh(yb,mc,Wc,Nd)},null,null,Yc)}else ma.ULS.sendTraceTag(537154570,306,15,"AutoPolicyManager: GetPolicyApplicationMethod failing because IsDisposed: {0}, IsSessionActive: {1}.",this.disposed,this.$.ea.qc)};m.prototype.UVh=function(yb,mc){ma.ULS.sendTraceTag(537154569,306,50,"AutoPolicyManager: GetPolicyApplicationMethod web service call was successful.");this.qc?!yb||Wd.a(yb)?ma.ULS.sendTraceTag(537154567,306,15,yb?"AutoPolicyManager: GetPolicyApplicationMethod result has non-status message.":
"AutoPolicyManager: GetPolicyApplicationMethod result is null"):mc(yb.Result):ma.ULS.sendTraceTag(537154568,306,50,"AutoPolicyManager: GetPolicyApplicationMethodSuccessCallback failing because IsDisposed: {0}, IsSessionActive: {1}.",this.disposed,this.$.ea.qc)};m.prototype.TVh=function(yb,mc,Wc,Nd){ma.ULS.sendTraceTag(537154566,306,15,"AutoPolicyManager: GetPolicyApplicationMethod web service call failed. Trying again");this.qc?Nd>=Wc?(ma.ULS.sendTraceTag(537154564,306,15,"AutoPolicyManager: GetPolicyApplicationMethod max retries exhausted."),
mc()):this.vgd(yb,mc,Wc,Nd+1):ma.ULS.sendTraceTag(537154565,306,50,"AutoPolicyManager: GetPolicyApplicationMethodFailureCallback failing because IsDisposed: {0}, IsSessionActive: {1}.",this.disposed,this.$.ea.qc)};m.prototype.Yre=function(yb,mc){mc?this.lZa(yb,null,null,3,!0):this.lZa(null,yb,null,3,!1)};m.prototype.abg=function(yb){var mc;var Wc=mc=null;if(!this.$.isEditMode)return{returnValue:!1,sensitivityLabel:mc,gGa:Wc};if(!this.policyManager.kha())return ma.ULS.sendTraceTag(537154529,306,15,
"TryGettingSensitivityLabels - Labels are not available."),{returnValue:!1,sensitivityLabel:mc,gGa:Wc};var Nd=this.policyManager.wn;if(!Nd)return ma.ULS.sendTraceTag(537154528,306,15,"TryGettingSensitivityLabels - GetPolicyLabelsData returned an invalid result."),{returnValue:!1,sensitivityLabel:mc,gGa:Wc};if(jd.a.oi(Nd.SensitivityLabels))return ma.ULS.sendTraceTag(537154527,306,15,"TryGettingSensitivityLabels - Attempting to apply labels when there are no sensitivity labels available."),{returnValue:!1,
sensitivityLabel:mc,gGa:Wc};var Tc=Nd.AppliedPolicyId;yb=yl(yb);for(var Yc=yb.next();!Yc.done;Yc=yb.next()){Yc=Yc.value;for(var oc=yl(Nd.SensitivityLabels),ze=oc.next();!ze.done;ze=oc.next())ze=ze.value,ze.Id===Yc&&(!mc||mc.Order<ze.Order)&&(mc=ze),ze.Id===Tc&&(Wc=ze)}return mc?{returnValue:!0,sensitivityLabel:mc,gGa:Wc}:(ma.ULS.sendTraceTag(537154526,306,10,"TryGettingSensitivityLabels - None of the sensitivity labels matched."),{returnValue:!1,sensitivityLabel:mc,gGa:Wc})};Sk.Object.defineProperties(m.prototype,
{qc:{configurable:!0,enumerable:!0,get:function(){return!this.disposed&&this.$.ea.qc}}});Object(hc.a)(m,"AutoPolicyManager",Ke.a,[3]);var lf=b(148),vc=b(11),hd=b(14),Ac=lf.ErrorDialog;vm(n,Ac);n.prototype.mm=function(){var yb=this;Ac.prototype.mm.call(this);if(this.error.Appearance&1&&this.$.Hd&2){var mc=this.getButton(0);vc.DOMElementExtensions.zOd(mc.get_element(),hd.a.instance.fa(1272));this.QP(function(){0===yb.returnValue&&yb.$.Hd&2&&(ma.ULS.sendTraceTag(50373725,306,50,"BlockSenitivityLabelActionDialog : Opening the book in excel desktop."),
se.TaskExtensions.Ba(Sd.GetServiceTaskFactory.Wa(yb.$.da,55,56,0),function(Wc){Wc.result.L2c()},yb.$.ma,3))})}};n.YQ=function(yb){return yb.Hd&2?rb.a.hd(3,1,0,1915,0,-1237306487,"SensitivityLabelBlockApplyLabelOpenInDesktop"):rb.a.hd(1,1,0,1916,0,-313914360,"SensitivityLabelBlockApplyLabel")};Object(hc.a)(n,"BlockSenitivityLabelActionDialog",lf.ErrorDialog,[]);var Vd=Ke.a;vm(l,Vd);l.prototype.initialize=function(){var yb=this;this.ga.ra("SupportsPolicies")?(this.TDa=this.ga.Ua("AppliedPolicyId"),
this.E6.Qg(),this.$.da.Za(29,function(mc){yb.statusBarManager=mc;mc.xJ(yb)}),this.vz(),nd.a.oi(this.ga.Ua("HostUserId"))||this.$Zi(),this.E6.T8i(this.MOg),this.E6.L9i(this.efi),this.vr.P8i(this.kod),this.so=rc.EwaSettings.getBooleanFeatureGate(bc.a.JPa,!1)):rc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&mb.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!0));!nd.a.oi(this.ga.Ua("HostUserId"))&&rc.EwaSettings.la(170)&&
this.$.ea.oh.get(45)&&(ma.ULS.sendTraceTag(537154524,306,50,"DataLossPrevention feature is Enabled and launched on Excel."),this.ZOh())};l.prototype.tq=function(yb){this.addHandler("LabelInfoChangedKey",yb)};l.prototype.Mq=function(yb){this.removeHandler("LabelInfoChangedKey",yb)};l.prototype.kn=function(){return!0};l.prototype.$r=function(yb,mc){if("QueryPolicyLabel"!==yb)return!1;if(this.$Ra())return mc.Visible=!1,!0;mc.Visible=!0;return 32===eb.AFrameworkApplication.Gb.Ce(Ub.a.kab,2,mc)};l.prototype.dispose=
function(){this.statusBarManager&&(this.statusBarManager.RF(this),this.statusBarManager=null);this.E6.kNb();this.AYc=!1;this.vr.dej(this.T4f);this.vr.eej(this.DDf);this.$.ea.Ew(this.eka);if(this.ga.ra("SupportsOfficeClientCoauthoring")){var yb=this.$.da.Aa(292);yb&&yb.Qcj(this.Vzf)}this.vr.tbj(this.ome);this.vr.Odj(this.SPf);this.vr.adj(this.Apf);this.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelHasUDPEnabled",!1)&&this.vr.uej(this.Abg);rc.EwaSettings.la(296)&&this.vr.xcj(this.xLe);
this.g$&&(this.g$.dispose(),this.g$=null);Vd.prototype.dispose.call(this)};l.prototype.DXc=function(yb,mc){if(!this.ga.ra("SupportsPolicies"))return ma.ULS.sendTraceTag(537154523,306,15,"AutoApplyOrRecommendPolicyLabel - Called when SupportPolicies is disabled."),!1;if(!this.KDd)return ma.ULS.sendTraceTag(537154522,306,15,"AutoApplyOrRecommendPolicyLabel - PolicyData hasn't been received yet."),!1;if(jd.a.oi(yb))return!1;this.g$||this.Cld();return this.g$.DXc(yb,mc)};l.prototype.vz=function(){this.raiseEvent("LabelInfoChangedKey")};
l.prototype.ZOh=function(){var yb=this;rc.EwaSettings.isChangeGateEnabled("OfficeVSO:6000793_RibbonDisplayedDependencyInDataLossPolicyCall")?xd.a.get_instance().kl(10,function(){yb.vr.Fac()}):this.vr.Fac()};l.prototype.$Zi=function(){var yb=this;xd.a.get_instance().kl(10,function(){yb.vr.jVc(yb.nYd);yb.vr.iFg(yb.Qyf);yb.vr.hFg(yb.Qyf);yb.vr.DVc(yb.T4f);yb.vr.Noe(yb.DDf);yb.$.ea.Dt(yb.eka);yb.vr.nne(yb.ome);yb.vr.Boe(yb.SPf);yb.vr.QFg(yb.Apf);yb.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelHasUDPEnabled",
!1)&&yb.vr.zHg(yb.Abg);if(yb.ga.ra("SupportsOfficeClientCoauthoring")){var mc=yb.$.da.Aa(292);mc&&mc.GFg(yb.Vzf)}rc.EwaSettings.la(296)&&(ma.ULS.sendTraceTag(537154521,306,50,"PolicyManagerWrapper: ApplyAutomaticPolicyLabel enabled and registered GetAutoPolicyLabelHandler"),yb.vr.fFg(yb.xLe));yb.RAh()})};l.prototype.RAh=function(){this.ga.ra("SupportsOfficeClientCoauthoring")||this.labelId&&this.labelId.length?this.D3a():this.oKh(this.$.ya.DocumentHostInfo.TenantId)};l.prototype.Cld=function(){this.g$=
new m(this.E6,this.vr,this.$,this.ga,this.hE)};l.prototype.BOf=function(yb){if(!this.ga.ra("SupportsPolicies"))return ma.ULS.sendTraceTag(537154518,306,10,"PolicyManagerWrapper::RegisterAugmentationLoopAnnotations called when CLP is disabled."),!1;this.g$||this.Cld();return this.g$.M8i(yb)};l.prototype.EXc=function(yb,mc){if(rc.EwaSettings.isChangeGateEnabled("OfficeVSO:5697254_ApplyPowerBiLabel")){if(!this.ga.ra("SupportsPolicies"))return ma.ULS.sendTraceTag(537154517,306,10,"PolicyManagerWrapper::AutoApplyOrRecommendPowerBILabel called when CLP is disabled."),
{returnValue:!1,lMa:!1};if(!this.KDd)return ma.ULS.sendTraceTag(537154516,306,15,"PolicyManagerWrapper::AutoApplyOrRecommendPowerBILabel called before PolicyData fetch is complete."),{returnValue:!1,lMa:!0};this.g$||this.Cld();return this.g$.EXc(yb,mc)}ma.ULS.sendTraceTag(537154515,306,10,"PolicyManagerWrapper::AutoApplyOrRecommendPowerBILabel called when BRS ApplyPowerBiLabel is disabled.");return{returnValue:!1,lMa:!1}};l.prototype.oKh=function(yb){var mc=this;ma.ULS.sendTraceTag(537154514,306,
50,"PolicyManagerWrapper: Doing GetPolicyLabelId web service call with tenantId length {0}",yb.length);var Wc=this.$.na.ta.Zb();u(this.$.na.ta,yb,function(Nd){mc.XHj(Nd)},null,null,null,Wc)};l.prototype.XHj=function(yb){ma.ULS.sendTraceTag(537154513,306,50,"PolicyManagerWrapper: GetPolicyLabelId web service call was successful");yb&&!Wd.a(yb)&&(this.TDa=yb.Result);this.D3a();this.labelId?ma.ULS.sendTraceTag(537154512,306,50,"PolicyManagerWrapper: Fetched LabelId length from custom.xml is {0}",this.labelId.length):
ma.ULS.sendTraceTag(537154511,306,50,"PolicyManagerWrapper: LabelId is invalid")};l.prototype.D3a=function(){this.vr.sed(this.labelId,void 0,void 0,!1)};l.prototype.hSe=function(){if(!this.AYc){this.$.If();this.AYc=!0;this.hE.h7e();var yb={};yb.hasLabel=!!this.labelId&&0<this.labelId.length;yb.isProtectedFile=this.ga.ra("ProtectedFile");yb.SupportsPolicies=this.ga.ra("SupportsPolicies");yb.AreLabelsAvailableForDisplay=this.vr.kha();yb.SupportsOfficeClientCoauthoring=this.ga.ra("SupportsOfficeClientCoauthoring");
yb.IsAnonymousUser=this.ga.ra("IsAnonymousUser");ma.ULS.sendTraceTag(51238051,306,50,"CLPUsage : {0}",JSON.stringify(yb))}};l.prototype.IKg=function(){this.E6.JKg(this.Uxa);this.Uxa=null};l.prototype.S6h=function(yb){yb=yl(yb.LabelActions);for(var mc=yb.next();!mc.done;mc=yb.next())if(nd.a.equals(mc.value.Name,"ApplyWatermark",!1))return!0;return!1};l.prototype.uAj=function(yb){yb?(new n(this.$)).mf():ma.ULS.sendTraceTag(537154465,306,50,"PolicyManagerWrapper.showBlockApplyLabelDialogDialog: Watermark Dialog box called with showDialog set to false from autoapply.")};
l.prototype.applyPolicyLabel=function(yb,mc,Wc,Nd){var Tc=this,Yc=Ua.c(this.vr.wn);if(void 0===yb||null===yb)yb="";var oc=new r;oc.Mpc=yb;oc.uYf=Nd;oc.WP=mc;var ze=this.$.na.ta;qd.a(this.$.userOperationManager,function(Ae,Ve,nb){Ve=yb;var Hc=Tc.$.ya.DocumentHostInfo.TenantId;Ae=me.b.call(null,Tc.rHi,Ae);var Cc=ze.Na(41,null);Cc.labelsInfoJson=Yc;Cc.appliedLabelId=Ve;Cc.tenantId=Hc;Cc.applyLabelFlag=mc;Cc.skipApplyOutcomes=Wc;return mf.i(ze,"ApplyPolicyLabel",Cc,Ae,null,nb,oc,0)},function(Ae){return new zc.a(222,
0,Ae)},null);this.SBc=!1;this.TNd=null};l.prototype.$Ra=function(){var yb=this.$.da.Aa(478);return this.so&&yb?yb.so():!1};Sk.Object.defineProperties(l.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.Dp}},Npc:{configurable:!0,enumerable:!0,get:function(){return this.aee}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.Tfa}},fPi:{configurable:!0,enumerable:!0,get:function(){return this.Vce}},labelId:{configurable:!0,enumerable:!0,get:function(){return this.TDa}}});
Object(hc.a)(l,"PolicyManagerWrapper",Ke.a,[185,186,852]);var Bd=Jd.a;vm(e,Bd);e.prototype.create=function(){var yb=this,mc=Sd.GetServiceTaskFactory.Wa(this.$.da,5,4,this.ub),Wc=eb.AFrameworkApplication.Jd,Nd=eb.AFrameworkApplication.ga;se.TaskExtensions.Ba(mc,function(){try{var Tc=new Ue.a(function(){return new v(Nd,Wc,eb.AFrameworkApplication.sa.xD,yb.$.ya.MaxGetPolicyRetries,Oa.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))}),Yc=new Ue.a(function(){return new pa(eb.AFrameworkApplication.Gb,
eb.AFrameworkApplication.sa,eb.AFrameworkApplication.ga,Tc)}),oc=yb.$.da.Aa(274);oc||(oc=new l(Tc.value,Yc.value,mc.result,yb.$,eb.AFrameworkApplication.ga),oc.initialize());yb.Fb(oc)}catch(ze){throw ma.ULS.sendTraceTag(537154525,306,10,"PolicyManager was not created successfully [Exception: {0}]",ze.toString()),ze;}},this.ma,3)};e.ja=function(yb){yb.da.Ha(275,new e(yb))};Object(hc.a)(e,"PolicyManagerFactory",Jd.a,[]);var tf=b(817),Wb=b(175);c.prototype.Yc=function(){return!1};c.prototype.executeCommand=
function(yb,mc,Wc){switch(mc.command){case Ub.a.setSensitivity:return this.$.workbookContext.FileCoauthorable||(Wc[Pa.vWc]=this.$.workbookContext.ExclusiveLockId),yb=eb.AFrameworkApplication.Gb.Ce(Ub.a.setSensitivity,2,Wc),ic.Task.Ta(32===yb);case Ub.a.K6:return yb=eb.AFrameworkApplication.Gb.Ce(Ub.a.K6,2,Wc),ic.Task.Ta(32===yb);case Ub.a.L6:return yb=eb.AFrameworkApplication.Gb.Ce(Ub.a.L6,2,Wc),ic.Task.Ta(32===yb);default:return Wb.a(mc.command)}};c.prototype.Jc=function(yb,mc){switch(mc.command){case Ub.a.setSensitivity:case Ub.a.K6:case Ub.a.L6:return!0;
default:return!1}};c.prototype.fd=function(yb,mc,Wc){switch(mc){case "PopulateSensitivityFlyout":return 32===eb.AFrameworkApplication.Gb.Ce(Ub.a.gza,2,Wc);default:return!1}};Object(hc.a)(c,"SensitivityCommandHandler",null,[188]);var wc=tf.a;vm(a,wc);a.prototype.Od=function(){this.Fd([new c(this.$)])};a.ja=function(yb){tf.a.fe(316,new a(yb))};Object(hc.a)(a,"SensitivityCommandHandlerFactory",tf.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");
J.main();(function(){Me.a.Ga(function(yb){e.ja(yb);a.ja(yb)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.policy.js.map/3788164dcedddfc3b8209e77788bd026/EwaDS.policy.js.map