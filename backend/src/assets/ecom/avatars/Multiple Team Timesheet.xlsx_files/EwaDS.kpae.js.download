(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1043:function(A,F,b){function a(f,x){var y=m.call(this,x.textBox.domElement)||this;y.GXc=null;y.BHi=function(){y.pzd()};y.wxf=function(t,B){y.Kg(t,B)};y.Cxf=function(t,B){y.fj(t,B)};y.vb=f;y.eJ=x;x.BY&&(x.BY.add(y),x.Yl(y.Cxf),x.Mo(y.wxf));return y}b.d(F,"a",function(){return a});A=b(0);var c=b(88);F=b(83);var e=b(44),l=b(42),n=b(69),m=F.a;vm(a,m);a.prototype.dispose=function(){var f=this.eJ;if(null===f||void 0===f?0:f.BY)f.BY.remove(this),
f.ol(this.Cxf),f.Pn(this.wxf);c.a.Fa(this.GXc);this.eJ=null;m.prototype.dispose.call(this)};a.prototype.Rh=function(f,x){switch(x){case -1470715894:case -1231471547:this.tU(!1);break;default:if(this.LFd(f,x))return n.g(f),!0;a.Uki(x)||this.tU(!1)}return!1};a.prototype.tU=function(){c.a.Fa(this.GXc);this.GXc=e.a.instance.create(this.BHi,10,l.a.Zsi)};a.prototype.fj=function(){this.tU(!1)};a.Uki=function(f){switch(f){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};Sk.Object.defineProperties(a.prototype,
{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.eJ}}});Object(A.a)(a,"ListAutoCompleteBehavior",F.a,[798,3])},1187:function(A,F,b){function a(t){var B=y.call(this,document.createElement("div"))||this;B.qIa=!1;B.rIa=!1;B.pIa=!1;B.nIa=!1;B.oIa=!1;B.BR=!1;B.eJ=null;B.fnc=function(z,u){B.it(z,u)};B.uLa=function(){B.Ya.textBox.pK=!0};B.Jya=function(){B.My(!0)};B.$uf=function(){B.Ya.textBox.focus()};B.Mh=function(){m.g(B.$).inRangePicker||
(B.isListVisible=!1)};B.$=t;m.g(t)&&m.g(t).ha&&m.g(B.$).ha.JG(B.Mh);B.rba=e.a.iN(t)&&l.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");return B}b.d(F,"a",function(){return a});A=b(0);F=b(230);var c=b(4),e=b(39),l=b(1),n=b(9),m=b(20),f=b(34),x=b(5),y=F.a;vm(a,y);a.prototype.it=function(){this.DBa(!1);this.Gt.it()};a.prototype.dispose=function(){this.$&&m.g(this.$)&&m.g(this.$).ha&&m.g(this.$).ha.jO(this.Mh);this.$=null;y.prototype.dispose.call(this)};a.prototype.Rh=
function(t,B,z){t=!1;if((this.O0a||(void 0===z?0:z))&&!this.Pwa()&&this.get_visible()&&this.isListVisible)switch(this.rba&&this.dBc(B),B){case 1872288872:this.isListVisible=!1;t=!0;break;case -798660877:this.Gt.jB(1);t=!0;break;case 137938150:this.Gt.jB(-1);t=!0;break;case 2091832999:this.Gt.jB(this.bI-1);t=!0;break;case 742457698:this.Gt.jB(-(this.bI-1));t=!0;break;case 125627505:t=this.My(!1);break;case 267796030:l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",
!1)&&(t=this.My(!1))}return t};a.prototype.DBa=function(t){if(this.isListVisible||t){var B=m.g(this.$);t=B.domElement;var z=this.eJ.textBox.domElement,u=f.a(this.$).Ii(z.offsetHeight),C=f.a(this.$).Ii(z.offsetTop),r=f.a(this.$).Ii(z.offsetWidth);z=f.a(this.$).Ii(z.offsetLeft);B=B.Dj;var J=x.AFrameworkApplication.sa&&x.AFrameworkApplication.sa.Qa.ph,v=$get(this.$.Ib+c.a.S_a,this.$.domElement);J&&(v=document.getElementById("EditorContainer"));var D=new Sys.UI.Point(B?this.Gt.n$b:0,B?this.OFh:a.U2h);
u=v.offsetTop+D.y+(e.a.oN(this.$)&&B?0:u+C);this.$.m5||(C=$get(c.a.eGa,this.$.domElement),u+=C&&!J?C.offsetHeight:0);C=this.domElement;C.style.top=n.HelperMethods.Qb(u);z=v.offsetLeft+z+D.x;!e.a.oN(this.$)&&this.$.isChromeRtl?C.style.right=n.HelperMethods.Qb(B?this.Gt.n$b:t.offsetLeft+t.offsetWidth-z-r):C.style.left=n.HelperMethods.Qb(z)}};a.prototype.NSa=function(t){this.Gt&&(t&&!this.BR?(this.Gt.L9(this.$uf),this.Gt.TYb(this.uLa),this.Gt.Bnb(this.Jya),this.BR=!0):this.BR&&(this.Gt.nda(this.$uf),
this.Gt.Esc(this.uLa),this.Gt.vHb(this.Jya),this.BR=!1))};a.prototype.dBc=function(t){switch(t){case -798660877:case 137938150:case 2091832999:case 742457698:this.qIa=!0;break;case 125627505:this.pIa=!0;break;case 267796030:l.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.nIa=!0)}};Sk.Object.defineProperties(a.prototype,{bI:{configurable:!0,enumerable:!0,get:function(){return this.Gt.bI}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Gt.isListVisible},
set:function(t){this.Gt.isListVisible=t}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.eJ},set:function(t){(this.eJ=t)&&this.eJ.rOb.add(this)}},OFh:{configurable:!0,enumerable:!0,get:function(){return e.a.oN(this.$)?-5:-40}}});a.n$b=0;a.U2h=1;Object(A.a)(a,"AutoCompleteControl",F.a,[754])},1188:function(A,F,b){function a(e,l,n,m){l=void 0===l?0:l;n=void 0===n?"":n;m=void 0===m?"":m;var f=c.call(this)||this;f.length=e;f.selectedIndex=l;f.xI=n;f.description=m;return f}b.d(F,"a",function(){return a});
A=b(0);var c=Sys.EventArgs;vm(a,c);Object(A.a)(a,"ListEventArgs",Sys.EventArgs,[])},1189:function(A,F,b){function a(C,r){C=u.call(this,C,r,new z.a(l.a.listItem,l.a.YAb,l.a.aBb,l.a.bBb))||this;C.Fcc=!1;C.cs=null;C.vlb=null;C.$Ve=!1;C.WAa(!0);C.$Ve=y.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");return C}b.d(F,"a",function(){return a});A=b(0);var c=b(13),e=b(23);F=b(977);var l=b(902),n=b(4),m=b(77),f=b(39),x=b(11),y=b(1),t=b(118),B=b(20),z=b(1042),u=F.a;vm(a,u);a.prototype.bya=
function(){var C=460,r=B.g(this.$),J=r.domElement,v=this.jTa.style,D=this.gg.offsetTop+this.Mk.offsetHeight*this.Mk.sectionRowIndex-this.gg.scrollTop;v.width="auto";v.whiteSpace="nowrap";v.position=e.a.Agc?"relative":"absolute";var V=J.offsetLeft+J.offsetWidth-(this.domElement.offsetLeft+this.gg.offsetLeft+this.gg.offsetWidth+3);J=this.domElement.offsetLeft-3-(J.offsetLeft+this.n$b);C=Math.min(this.jTa.offsetWidth,C,Math.max(V,J));x.DOMElementExtensions.Uq(this.jTa,C);v.whiteSpace="";v.position="absolute";
D+3>this.gg.offsetTop+this.gg.offsetHeight||D<this.gg.offsetTop||(C=this.gg.offsetLeft-3-this.jTa.offsetWidth,v=this.gg.offsetLeft+this.gg.offsetWidth+3,x.DOMElementExtensions.updatePosition(this.jTa,J>V!==r.rtl?C:v,D,!1))};a.prototype.jB=function(C){u.prototype.jB.call(this,C);this.bya()};a.prototype.it=function(){this.bya()};a.prototype.Rra=function(){var C=this.Jn,r=this.gg,J=3===m.a.$b||e.a.Xp,v=J?this.MBb:this.bI;this.isListVisible=!0;r.style.height="auto";this.oGa.set_visible(!0);this.enb(C,
J);this.cs.length>v?(x.DOMElementExtensions.pG(r,Math.floor(r.offsetHeight*v/this.cs.length)),r.style.overflowY="auto"):(r.style.height="auto",r.style.overflowY="hidden");x.DOMElementExtensions.Uq(r,C.offsetWidth+(this.cs.length>v?t.a.gq:0))};Sk.Object.defineProperties(a.prototype,{n$b:{configurable:!0,enumerable:!0,get:function(){if(f.a.oN(this.$)){var C=document.getElementById(this.$.Ib+n.a.ZVe);return!this.$Ve||C?x.DOMElementExtensions.getBoundingClientRect(C).x:0}C=y.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",
!1)?document.getElementById(n.a.jxd):document.getElementById(this.$.Ib+n.a.jxd+"-"+n.a.Prf);c.ULS.shipAssertTag(537170323,0,!!C||this.$.rR,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return C?C.offsetWidth:0}},qe:{configurable:!0,enumerable:!0,get:function(){return this.vlb},set:function(C){this.vlb=C}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return x.DOMElementExtensions.isVisible(this.gg)&&0<this.cs.length},set:function(C){x.DOMElementExtensions.setVisible(this.gg,
C);x.DOMElementExtensions.setVisible(this.jTa,C);var r=B.g(this.$).view;C?this.Fcc||(r.Ms(this.oGa.fnc),this.Fcc=!0):(Array.clear(this.cs),this.Fcc&&(r.Nq(this.oGa.fnc),this.Fcc=!1))}}});Object(A.a)(a,"AutoCompleteListBox",F.a,[])},1238:function(A,F,b){function a($b,Xb,lc,Oa){var pb=pd.call(this,$b,"PopulateGridContextMenu",1247109494,-2064931494,a.G2h,!0,!1,a.gIb,Xb,lc,!0,Oa)||this;pb.JAa=!1;pb.awa=!1;pb.oZ=!1;pb.refresh=!1;pb.expandCollapse=!1;pb.dic=!1;pb.BEe=!0;pb.grid=db.g($b);pb.Rkc=!0;pb.Cnd=
Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1);if(pb.Cnd){var Ub=hc.GetServiceTaskFactory.Wa(pb.$.da,309,310,3),ic=hc.GetServiceTaskFactory.create(pb.$.da,18,pb.ma,3);pa.TaskExtensions.Ba(pa.TaskExtensions.ve([Ub,ic],pb.ma),function(){pb.$.da.Za(268,function(Jb){pb.y4a=new c($b,Ub.result,ic.result,Jb)})},pb.ma,3)}return pb}function c($b,Xb,lc,Oa){this.IWc=this.jeb=this.leb=0;this.$=$b;this.gridView=db.g(this.$);this.namedSheetViewPublic=Xb;this.Gh=lc;
this.instantaneousSupportInformationManager=Oa;this.FMa=Ya.a.Ymd()}function e($b){this.ranges=null;this.ranges=$b}function l($b,Xb,lc,Oa,pb,Ub,ic,Jb){this.$=Xb;this.Sa=lc;this.lm=Oa;this.selectedRanges=pb;this.grid=Ub;this.vB=Jb;this.nba=ic;this.Wra=y.a.all(pb,function(cc){return cc.isRow});this.Vra=y.a.all(pb,function(cc){return cc.Sh});this.zCb=y.a.all(pb,function(cc){return!cc.isRow&&!cc.Sh});Xb=Ub.Rb.uhd(pb);this.n4b=!!Xb;this.oSf=!!Xb&&Xb.hasActiveFilter;this.menuSection=lc.Mc();Array.add($b.zc,
this.menuSection);this.xka=this.Wra||this.Vra?this.menuSection:lc.Mc();this.Hta=this.Wra||this.Vra?this.menuSection:lc.Mc()}b.r(F);A=b(0);var n=b(13),m=b(268),f=b(97),x=b(47),y=b(309),t=b(571),B=b(5),z=b(84),u=b(411),C=b(842),r=b(8),J=b(28),v=b(16),D=b(58),V=b(4),U=b(922),Q=b(1169),la=b(976),ba=b(14);l.prototype.Pcd=function(){this.KHh();this.pHh();var $b=this.vB.W6a(this.selectedRanges,this.grid);Array.add(this.menuSection.buttons,this.Sa.Bb($b?149:148))};l.prototype.PHh=function(){var $b=0;this.n4b?
this.nba.Hn(942362098)?$b=this.vB.Hn(this.lm,942362098,this.selectedRanges,this.grid)?161:169:this.oSf&&($b=this.vB.Hn(this.lm,-1113896058,this.selectedRanges,this.grid)?177:181):this.nba.Hn(-1113896058)&&($b=this.Wra?this.vB.Hn(this.lm,-1113896058,this.selectedRanges,this.grid)?49:116:this.vB.Hn(this.lm,-1113896058,this.selectedRanges,this.grid)?177:181);0!==$b&&Array.add(this.xka.buttons,this.Sa.Bb($b))};l.prototype.LHh=function(){var $b=0;this.n4b?this.nba.Hn(622604322)&&($b=this.grid.rtl?this.vB.Hn(this.lm,
622604322,this.selectedRanges,this.grid)?191:192:this.vB.Hn(this.lm,622604322,this.selectedRanges,this.grid)?162:170):this.nba.Hn(1415868706)&&($b=this.Vra?this.vB.Hn(this.lm,1415868706,this.selectedRanges,this.grid)?50:117:this.vB.Hn(this.lm,1415868706,this.selectedRanges,this.grid)?178:182);0!==$b&&Array.add(this.xka.buttons,this.Sa.Bb($b))};l.prototype.JHh=function(){this.nba.Hn(1035996630)&&(this.vB.Hn(this.lm,1035996630,this.selectedRanges,this.grid)?(Array.add(this.xka.buttons,this.Sa.Bb(this.grid.rtl?
187:165)),Array.add(this.xka.buttons,this.Sa.Bb(166))):(Array.add(this.xka.buttons,this.Sa.Bb(this.grid.rtl?188:173)),Array.add(this.xka.buttons,this.Sa.Bb(174))))};l.prototype.KHh=function(){var $b=b(1238).GridContextMenu,Xb=null;this.zCb&&(Xb=this.Sa.Wv("ContextMenu.InsertCells",null,ba.a.instance.fa(346),1896159024),Array.add(Xb.menu.zc,this.xka));$b.MHh(this.xka,this.Sa,this.$);this.PHh();this.LHh();this.JHh();Xb&&0<this.xka.buttons.length&&Array.add(this.menuSection.buttons,Xb)};l.prototype.rHh=
function(){var $b=0;this.n4b?this.nba.Hn(1405456548)?$b=this.vB.Hn(this.lm,1405456548,this.selectedRanges,this.grid)?163:171:this.oSf&&($b=this.vB.Hn(this.lm,1554436520,this.selectedRanges,this.grid)?179:183):this.nba.Hn(1554436520)&&($b=this.Wra?this.vB.Hn(this.lm,1554436520,this.selectedRanges,this.grid)?51:118:this.vB.Hn(this.lm,1554436520,this.selectedRanges,this.grid)?179:183);0!==$b&&Array.add(this.Hta.buttons,this.Sa.Bb($b))};l.prototype.qHh=function(){var $b=0;this.n4b?this.nba.Hn(284490184)&&
($b=this.vB.Hn(this.lm,284490184,this.selectedRanges,this.grid)?164:172):this.nba.Hn(674605324)&&($b=this.Vra?this.vB.Hn(this.lm,674605324,this.selectedRanges,this.grid)?52:119:this.vB.Hn(this.lm,674605324,this.selectedRanges,this.grid)?180:184);0!==$b&&Array.add(this.Hta.buttons,this.Sa.Bb($b))};l.prototype.oHh=function(){this.nba.Hn(1035996630)&&(this.vB.Hn(this.lm,1035996630,this.selectedRanges,this.grid)?(Array.add(this.Hta.buttons,this.Sa.Bb(this.grid.rtl?189:167)),Array.add(this.Hta.buttons,
this.Sa.Bb(168))):(Array.add(this.Hta.buttons,this.Sa.Bb(this.grid.rtl?190:175)),Array.add(this.Hta.buttons,this.Sa.Bb(176))))};l.prototype.pHh=function(){var $b=null;this.zCb&&($b=this.Sa.Wv("ContextMenu.DeleteCells",null,ba.a.instance.fa(406),-1554384558),Array.add($b.menu.zc,this.Hta));this.rHh();this.qHh();this.oHh();$b&&0<this.Hta.buttons.length&&Array.add(this.menuSection.buttons,$b)};Object(A.a)(l,"CellsContextMenuGenerator",null,[]);Object(A.a)(e,"MacroRecorderRangeHyperlinkRemovedPayload",
null,[147]);var T=b(552),H=b(24),S=b(96),K=b(77),da=b(73),fa=b(43),X=b(164),ca=b(81),ja=b(650),ea=b(39),qa=b(141),pa=b(35),Pa=b(575),Ha=b(578),Xa=b(1),Na=b(175),db=b(20),Ja=b(372),jb=b(34),hc=b(56),ma=b(236),Ka=b(19),Ta=b(29),ob=b(1180),Cb=b(1041),eb=b(126),ya=b(521),za=b(369),Ga=b(154),cb=b(148),Mb=b(339),Dc=b(92),vb=b(27),ib=b(303),ub=b(272),Eb=b(127),Ya=b(900),tb=b(901),ec=b(135),Za=b(40),mb=b(52),sc;(function($b){$b[$b.none=0]="none";$b[$b.once=1]="once";$b[$b.twice=2]="twice"})(sc||(sc={}));
Object(A.b)("ToggleState",sc);c.prototype.Zgh=function(){var $b=this.jV(),Xb={};$b=(Xb.CommandValueId=Za.c($b),Xb);Xb=new Dc.a(-2058042992,2,this.$.gd,19,null);n.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Xb(Xb,$b)};c.prototype.phh=function(){var $b=new Dc.a(644342024,2,this.$.gd,19,null);n.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");
return this.$.Ka.Xb($b)};c.prototype.ehh=function(){var $b=this.gridView.ha.va.activeCell,Xb=this.$.da.Aa(66).Mg;return Xb?this.ghh(Xb,$b):this.fhh($b)};c.prototype.ghh=function($b,Xb){if(this.QWg($b,Xb))return n.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),mb.Task.Ta(!1);if($b.hasAutoFilter)return this.leb=sc.none,this.GWc();this.leb=sc.once;return this.J6b(sc.once)};c.prototype.fhh=function($b){var Xb=fa.v(this.gridView.ha.va.Sd,
this.$);Xb=this.gridView.$.xa.getItemByName(Xb.SheetName);var lc=fa.D(Xb.I0);if(this.PWg(lc,$b))return n.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),mb.Task.Ta(!1);if(Xb.hasAutoFilter){if(lc&&lc.contains(this.gridView.ha.va.activeCell))return this.leb=sc.none,this.GWc();this.leb=sc.twice;return this.J6b(sc.twice)}this.leb=sc.once;return this.J6b(sc.once)};c.prototype.J6b=function($b){function Xb(Jb){ib.a(Jb)?
n.ULS.sendTraceTag(527500297,0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}",vb.a.Tc(Jb.Errors)):(n.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),$b===sc.twice?Oa.J6b(sc.once):Oa.GWc())}function lc(){return new ob.a(pb)}var Oa=this,pb=fa.v(this.gridView.ha.va.Sd,this.$);if(!pb)return mb.Task.Ta(!1);this.jeb||(this.jeb=Date.now());var Ub=new Dc.a(368460465,2,this.$.gd,19,null),ic=this.$.na.ta.Zb();return Xa.EwaSettings.sc()?
za.a(this.$.userOperationManager,function(Jb,cc,Ob){return ca.kb(Oa.$.na.ta,pb,ub.b(Jb,Xb),cc,Ob,null,ic)},function(Jb){return new X.a(516,0,Jb,64,lc)},Ub):za.a(this.$.userOperationManager,function(Jb,cc,Ob){return ca.kb(Oa.$.na.ta,pb,ub.b(Jb,Xb),cc,Ob,null,ic)},function(Jb){return new ya.a(516,0,Jb,void 0,lc)},Ub)};c.prototype.QWg=function($b,Xb){return Ga.d($b)&&Xb.top===$b.usedRange.top?(this.Qqc(this.$,224),!0):Ga.g($b)&&Xb.top===$b.usedRange.bottom?(this.Qqc(this.$,225),!0):!1};c.prototype.PWg=
function($b,Xb){if($b&&$b.contains(Xb)&&Xb.top===$b.top||!$b&&this.RVg(Xb.top,Xb.left))return this.Qqc(this.$,226),!0;$b=new H.Range(Xb.top,Xb.left,Xb.top+1,Xb.left+1,!1,!1);return this.gridView.Rb.uhc($b)?(this.Qqc(this.$,227),!0):!1};c.prototype.Qqc=function($b,Xb){Xb=vb.a.hd(1,1,738,Xb,0,147079615,"ContextMenuFilterByCellValueError");Xa.EwaSettings.oz()?new Mb.a($b,Xb):($b=new cb.ErrorDialog($b,Xb),$b.initialize(),$b.mf())};c.prototype.GWc=function(){function $b(Jb){var cc={};cc=(cc.ToggleFilterOperationCount=
Xb.leb,cc.ApplyFilterTime=Xb.IWc?Date.now()-Xb.IWc:-1,cc.ToggleAndApplyFilterTime=Xb.jeb?Date.now()-Xb.jeb:-1,cc.FilterByValueType=Oa.AutoFilterType,cc);n.ULS.sendTraceTag(527500295,0,50,"GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : {0}",JSON.stringify(cc));Xb.jeb&&(Xb.jeb=0);Ya.a.exc(Jb)&&(cc=Ya.a.T$b(Jb),Xb.FMa?Ya.a.zQa(tb.a.filterByCellValue,cc.MessageIdName,ec.a.ksa,!0,Ya.a.isSessionEndingError(cc.MessageId)):n.ULS.sendTraceTag(527500294,0,10,"GridContextMenuFilter::ApplyFilterByValue failed with FilterException -{0}",
cc.MessageIdName));ib.a(Jb)?n.ULS.sendTraceTag(527500292,0,50,"GridContextMenuFilter::ApplyFilterByValue service call failed with errors : {}",vb.a.Tc(Jb.Errors)):(n.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),Eb.b(Xb.$).ee(eb.a.Byf,Xb.gm(),void 0,!0),Jb={},Jb.FirstRow=Xb.gQh(),Jb.FirstColumn=Oa.Column,-1!==Jb.FirstRow&&(Jb=fa.C(Jb),Xb.JL(Jb)))}var Xb=this;this.IWc=Date.now();var lc=this.a1h();if(!lc)return n.ULS.sendTraceTag(527500296,0,50,
"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),mb.Task.Ta(!1);var Oa=this.jV(),pb={FirstRow:0};pb.FirstColumn=Oa.Column;pb.SheetName=Oa.SheetName;Eb.b(this.$).ee(eb.a.Puf,this.gm(),void 0,!0);var Ub=this.x3c(Oa,pb),ic=new X.a(208,0,function(Jb,cc,Ob){return ca.a(Xb.$.na.ta,Ub,lc,ub.b(Jb,$b),cc,Ob,null,null)},6,function(){return new Cb.a(lc,Ub)});this.namedSheetViewPublic?this.namedSheetViewPublic.LAa().continueWith(function(Jb){Jb.result&&Xb.$.userOperationManager.hc(ic,
null)}):this.$.userOperationManager.hc(ic,null);return mb.Task.Ta(!0)};c.prototype.JL=function($b){(Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:6063473_PTPSDisableLive")?ea.a.Rka(this.$):Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1))&&pa.TaskExtensions.Ba(hc.GetServiceTaskFactory.Wa(this.$.da,430,431,1),function(Xb){Xb.result.yea($b);n.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},
this.$.ma,3)};c.prototype.gm=function(){var $b={};return $b.Location="contextMenu",$b};c.prototype.jV=function(){var $b=0,Xb=this.$.da.Aa(66).Mg;if(Xb){var lc="Table";$b=Xb.objectId}else lc="Sheet";var Oa=this.gridView.ha.va.activeCell.left;Xb={};Xb.AutoFilterType=lc;Xb.Column=Oa;Xb.Id=$b;lc={};this.$.Cj(lc);lc.FirstRow=0;lc.FirstColumn=Xb.Column;$b=this.$.ea.isNamedObjectViewMode;Xb.NamedObjectView=$b;Xb.SheetName=$b?lc.NamedObjectName:lc.SheetName;Xb.ItemListOptions=null;return Xb};c.prototype.RVg=
function($b,Xb){$b=H.Range.kd($b,Xb);return this.gridView.Ca.i$($b,this.$.pa.name)&&($b=this.gridView.Ca.W3a($b))&&$b.autoFilterMenu?!0:!1};c.prototype.a1h=function(){var $b=null,Xb=this.gridView.uc(this.gridView.ha.va.activeCell);if(!Xb)return null;var lc=Xb.cell.oTd;var Oa=this.instantaneousSupportInformationManager.Geb(lc,!1).category;if(1===Xb.WI.type)if(3===Oa){if(!Xb.cell.b9a)return n.ULS.sendTraceTag(527500290,0,15,"GridContextMenuFilter::GetValueForFilter() for category : {0}. NumFmt is null. ",
Oa),null;$b=(Xb.cell.b9a.Start+Xb.cell.b9a.End).trim()}else if(!Oa&&(Ka.a.t0a(Xb.WI.value,"E")||Ka.a.t0a(Xb.originalText,"E"))){$b=this.Gh.tFh(Xb.WI.value,lc,Xb.cell.qia);if(!$b.success)return n.ULS.sendTraceTag(527500289,0,50,"GridContextMenuFilter::GetValueForFilter() for category : {0}. Failed to acquire formatted value",Oa),null;$b=$b.ZJ}$b||($b=Xb.originalText);return Ta.a.i0c($b)?["[Blanks]"]:["i"+$b.trim()]};c.prototype.gQh=function(){var $b=this.$.da.Aa(66).Mg;if($b)return $b.usedRange.top;
$b=this.$.xa.getItemByName(this.$.pa.sheetName);return($b=fa.D($b.I0))&&$b.contains(this.gridView.ha.va.activeCell)?$b.top:-1};c.prototype.x3c=function($b,Xb){var lc={};lc.Location=Xb;lc.FieldId=$b.Id.toString();lc.DataSourceIndex=-1;lc.FilterType=$b.AutoFilterType;lc.AnchorType=0;lc.ChartId=null;lc.AnchorValue1=-1;lc.AnchorValue2=-1;lc.Property=$b.RichProperty;return lc};Object(A.a)(c,"GridContextMenuFilter",null,[]);b.d(F,"GridContextMenu",function(){return a});var pd=C.a;vm(a,pd);a.prototype.dispose=
function(){pd.prototype.dispose.call(this);this.grid=null};a.prototype.Yc=function($b,Xb){$b=!this.pqd($b,Xb);if(!$b)switch(Xb){case -1977666927:$b=null==this.y4a||this.Kxj();break;case 1549396389:$b=null==this.y4a||this.Qxj();break;case 1803952894:$b=null==this.y4a||!this.$.isEditMode&&!this.xgi()}return $b};a.prototype.pqd=function($b,Xb){var lc=this.grid.ha.va.selectedRanges;return(new qa.a(this.$.xa)).Hn($b,Xb,lc,this.grid)};a.prototype.executeCommand=function($b,Xb,lc){var Oa=Xb.command;$b=null;
switch(Oa){case -1396319072:if(Xb=this.grid.uc(null))m.a.instance.ZZc(!0),f.EventHandlerManager.instance.bcd(),a.YVi(Xb);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.va.selectedRanges,Xb);break;case 324156914:$b=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(lc);break;case -1977666927:$b=this.y4a.Zgh();break;case 1549396389:$b=this.y4a.phh();break;case 1803952894:$b=this.y4a.ehh();break;default:$b=Na.a(Oa)}return $b||pa.TaskExtensions.H4()};a.prototype.Jc=
function($b,Xb,lc){$b=!1;switch(Xb.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:$b=!0;break;case 1441131127:$b=!!lc}return $b};a.prototype.YY=function($b){$b=void 0===$b?!1:$b;var Xb=!1,lc=!1,Oa=0;Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Oa=x.a.we());var pb=this.Sa.Lp(this.menuId),Ub=this.grid.ha.va,ic=Ub.qh,Jb=ic&&Ub.Sd.Sh,cc=ic&&Ub.Sd.isRow;Ub=Ub.selectedRanges;var Ob=y.a.all(Ub,
function(ta){return ta.Sh}),P=y.a.all(Ub,function(ta){return ta.isRow}),Ba=fa.O(Ub),ra=fa.P(Ub);this.Egf(Jb,cc)?(Xb=!0,this.rIh(pb)):this.$.isEditMode?Ja.a(this.$)?this.sIh(pb,Jb,cc):(this.sHh(pb,!(cc||Jb||!this.dic)),this.NHh(pb,Ub,$b),this.DHh(pb,Ob,P,Ba,ra),this.hXe(pb,ic,Jb,cc),this.KIh(pb),this.JWe(pb,Jb,cc),this.iIh(pb,ic,Jb,cc,Ub),this.vHh(pb),this.tHh(pb,Ub),this.UHh(pb),this.FIh(pb,ic),Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.HHh(pb)):(lc=!0,
Ja.a(this.$)?this.bXe(pb):this.$Ih(pb,ic,Jb,cc,Ub));Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&($b=x.a.we()-Oa,n.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",$b,Xb,lc,this.BEe));this.BEe=!1;return pb};a.prototype.jKa=function($b){var Xb=[];if(Ja.a(this.$))return Xb;if(3===$b){$b=this.grid.ha.va;var lc=$b.qh,Oa=lc&&$b.Sd.Sh,pb=lc&&$b.Sd.isRow,Ub=
!1,ic=!1,Jb=!1;this.$.isMobileMode&&(ic=$b.selectedRanges,Ub=fa.O(ic),ic=fa.P(ic));if(lc){var cc=db.e(this.grid);cc&&cc.range.contains($b.Sd)&&this.OV(cc)&&(Jb=!0)}this.$.isEditMode?this.Egf(Oa,pb)?Array.addRange(Xb,[la.a.NHf,la.a.PHf]):Oa||pb?(Array.add(Xb,la.a.clipboard),pb?Array.add(Xb,la.a.Xjj):Oa&&Array.add(Xb,la.a.o_g)):(Array.addRange(Xb,[la.a.edit,la.a.clipboard]),Jb?Array.add(Xb,la.a.hyperlink):Array.add(Xb,la.a.color),lc&&Array.add(Xb,la.a.cNg)):(Array.add(Xb,la.a.copy),Jb&&Array.add(Xb,
la.a.openHyperlink),!pb||this.$.isMobileMode&&ic?!Oa||this.$.isMobileMode&&Ub||Array.add(Xb,la.a.lXj):Array.add(Xb,la.a.mXj));Array.add(Xb,la.a.x2h)}else 2===$b&&Array.add(Xb,la.a.Jxe);return Xb};a.prototype.Egf=function($b,Xb){return(this.JAa||this.awa||this.oZ||this.refresh||this.expandCollapse)&&!($b||Xb)};a.prototype.showGridContextMenu=function($b){this.expandCollapse=this.refresh=this.oZ=this.awa=this.JAa=!1;var Xb=this.$,lc=Pa.a(Xb).xKa(),Oa=this.grid.ha.va,pb=Oa.qh,Ub=pb&&Oa.Sd.Sh;Oa=pb&&
Oa.Sd.isRow;if(lc&&!Ub&&!Oa){Ub=Ha.a(Xb);if(null===Ub||void 0===Ub?0:Ub.HQd)this.JAa=Ub=S.f(Xb.lg),this.awa=!Ub;Ub=Xb.nc;this.oZ=lc.supportsBIExplore&&!!U.a(Xb)&&Ub.L2(32768);Ub.allowInteractivity&&(Xb=this.grid.uc(null),(null===Xb||void 0===Xb?0:Xb.cell)&&(Xb.cell.OZc||Xb.cell.f3f)&&(this.expandCollapse=!0),Ub.allowManualDataRefresh&&(this.refresh=!0))}Xb=null;lc=1;Ub=Object(z.a)(t.a,$b.eventArgs);$b=Object(z.a)(Q.a,$b.creationParams);Oa=this.kNh();$b?(Xb=$b.clientPoint,lc=$b.inputMethod):Ub&&1!==
Ub.yb?(Xb=new Sys.UI.Point(Ub.clientPoint.x,Ub.clientPoint.y),lc=Ub.yb):Oa&&(Xb=new Sys.UI.Point(Oa.x+(this.$.isChromeRtl?0:Oa.width),Oa.y+Oa.height));K.a.$b=lc;this.dic=3===lc;$b=J.a.gtb;this.Eo(Xb,!Ub||Ub.Ea.target.className!==$b,lc)};a.prototype.removeHyperlinksFromRange=function($b,Xb){var lc=this;if(!Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.Ns($b,!0)){var Oa=fa.r($b,this.$),pb=this.$.na.ta.Zb();this.$.userOperationManager.hc(new X.a(125,
0,function(Ub,ic,Jb){lc.$.oy();return ca.c(lc.$.na.ta,Oa,"","",!0,!1,127,Ub,ic,Jb,null,pb)},void 0,function(){return new e(Oa)}),Xb);this.grid.Hh.XG(!1)}};a.prototype.kNh=function(){var $b=this.grid.uc(null);if((null===$b||void 0===$b?0:$b.cell.ik)&&this.Pff($b))return this.grid.getCellBounds($b.cell);$b=this.grid.ha.va.activeCell;return($b=this.B9b(new H.Range($b.top,$b.left,r.a.Lh,$b.left,!1,!1),2,!0)||this.B9b(new H.Range(1,$b.left,$b.top,$b.left,!1,!1),2,!1)||this.B9b(new H.Range($b.top,$b.right,
$b.top,r.a.Xh,!1,!1),1,!0)||this.B9b(new H.Range($b.top,1,$b.top,$b.right,!1,!1),1,!1)||null)&&$b.ik?this.grid.getCellBounds($b):Sys.UI.DomElement.getBounds(this.grid.Z4a.Jb)};a.prototype.Pff=function($b){var Xb=this.grid.rtl,lc=this.$.isChromeRtl;$b=$b.cell;var Oa=db.g(this.$).aK($b);return Oa?(Oa=Oa.topLeft,Xb=Oa.x+=Xb===lc?$b.offsetWidth:0,lc=Oa.y+=$b.offsetHeight,this.grid.view.visibleArea.contains(new D.a(Xb,lc,0,0))):!1};a.prototype.B9b=function($b,Xb,lc){$b=this.grid.xl("GridContextMenu.FindFirstCellInViewportArea",
$b,Xb,lc);try{for($b.$$rst();$b.$$mn();){var Oa=$b.$$cu();if(Oa&&this.Pff(Oa))return Oa.cell}}finally{$b&&$b.dispose()}return null};a.prototype.rIh=function($b){var Xb=this.Sa,lc=Xb.Mc();this.refresh&&Array.add(lc.buttons,Xb.Bb(100));this.oZ&&Array.add(lc.buttons,Xb.Bb(99));this.JAa?Array.add(lc.buttons,Xb.Bb(59)):this.awa&&Array.add(lc.buttons,Xb.Bb(58));if(this.expandCollapse){var Oa=Xb.Wv("ContextMenu.PivotExpandCollapse",null,ba.a.instance.fa(1120),589118293);var pb=Xb.Mc();Array.add(pb.buttons,
Xb.Bb(243));Array.add(pb.buttons,Xb.Bb(244));Array.add(pb.buttons,Xb.Bb(245));Array.add(pb.buttons,Xb.Bb(246));Array.add(Oa.menu.zc,pb);Oa&&0<pb.buttons.length&&Array.add(lc.buttons,Oa)}Array.add($b.zc,lc)};a.prototype.hXe=function($b,Xb,lc,Oa){if(Xb&&!lc&&!Oa){Xb=this.Sa.Mc();this.Cnd&&!this.$.rR&&this.RWe(Xb);this.$cd(Xb);this.OIh(Xb);if(Xa.EwaSettings.la(500)&&db.g(this.$).ha.va.tK()&&db.g(this.$).ha.va.h_)switch(Xa.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",
0)){case 1:Array.add(Xb.buttons,this.Sa.Bb(237));break;case 2:Array.add(Xb.buttons,this.Sa.Bb(238));break;default:Array.add(Xb.buttons,this.Sa.Bb(236))}Array.add($b.zc,Xb)}};a.prototype.$cd=function($b){if(!Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||!this.$.isMobileMode||(new qa.a(this.$.xa)).te(2048)){var Xb=this.Sa.Mc();Array.add(Xb.buttons,this.Sa.Bb(223));Array.add(Xb.buttons,this.Sa.Bb(224));this.$.isMobileMode||Array.add(Xb.buttons,this.Sa.Bb(225));
var lc=this.Sa.Wv("ContextMenu.sort",null,ba.a.instance.fa(228),-864298118);Array.add(lc.menu.zc,Xb);Array.add($b.buttons,lc)}};a.prototype.RWe=function($b){var Xb=this.Sa.Wv("ContextMenu.filter",null,ba.a.instance.fa(1910),2045563128),lc=this.Sa.Mc(),Oa=this.JRh(),pb=this.Sa.Bb(234);pb.label=Oa;Array.add(lc.buttons,pb);Array.add(lc.buttons,this.Sa.Bb(235));Oa=this.Sa.Mc();Array.add(Oa.buttons,this.Sa.Bb(233));Array.add(Xb.menu.zc,lc);Array.add(Xb.menu.zc,Oa);Array.add($b.buttons,Xb)};a.prototype.OIh=
function($b){if(db.g(this.$).ha.va.tK()){var Xb=this.Sa.Mc();Array.add(Xb.buttons,this.Sa.Bb(232));Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",!1)&&(Array.add(Xb.buttons,this.Sa.Bb(285)),Array.add(Xb.buttons,this.Sa.Bb(286)));var lc=this.Sa.Wv("ContextMenu.table",null,ba.a.instance.fa(1909),-697806646);Array.add(lc.menu.zc,Xb);Array.add($b.buttons,lc)}};a.prototype.WWe=function($b,Xb,lc,Oa,pb){if(Xb){var Ub=fa.K(pb),ic=db.e(this.grid);if(ic&&!lc&&!Oa){lc=
new qa.a(this.$.xa);if(ic.range.contains(Ub)&&this.OV(ic)){(Xb=!ic.sMa&&!lc.Oj)&&this.$.isEditMode&&Array.add($b.buttons,this.Sa.Bb(45));ic.bba&&Array.add($b.buttons,this.Sa.Bb(53));Xb&&this.$.isEditMode&&Array.add($b.buttons,this.Sa.Bb(47));return}!ic.sMa&&this.$.isEditMode&&(ic=lc.te(128),Array.add($b.buttons,this.Sa.Bb(ic?46:121)))}}this.H5i(pb)&&Array.add($b.buttons,this.Sa.Bb(48));Xb&&Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode&&
!this.$.isMobileMode&&(Xb=fa.K(pb),this.G5i(Xb)?Array.add($b.buttons,this.Sa.Bb(276)):Xb.Sh||Xb.isRow||Array.add($b.buttons,this.Sa.Bb(275)))};a.prototype.H5i=function($b){$b=yl($b);for(var Xb=$b.next();!Xb.done;Xb=$b.next()){Xb=this.grid.getRangeInformation(Xb.value);for(var lc=0;lc<Xb.length;lc++)if(Object(u.a)(T.HyperlinkRange,Xb[lc])){var Oa=this.grid.uc(Xb[lc]);if(Oa&&this.OV(Oa)&&!Oa.sMa)return!0}}return!1};a.prototype.G5i=function($b){if(db.g(this.$).ha.va.tK()){var Xb=db.g(this.$).Rb.Xj($b);
if(Xb&&Xb.usedRange.equals($b))return!0}return!1};a.prototype.JWe=function($b,Xb,lc){var Oa,pb;if(1===db.g(this.$).ha.Ve&&!Xb&&!lc){Xb=Ja.a(this.$);lc=this.Sa;var Ub=lc.Mc(),ic=this.$.da.Aa(65);(null===(Oa=null===ic||void 0===ic?void 0:ic.Ln)||void 0===Oa?0:Oa.cF)&&!Xb&&Array.add(Ub.buttons,lc.Bb(227));ic&&ic.isCommentOperationEnabled(3)&&Array.add(Ub.buttons,lc.Bb(221));(null===(pb=null===ic||void 0===ic?void 0:ic.Ln)||void 0===pb?0:pb.v8e)&&!Xb&&Array.add(Ub.buttons,lc.Bb(228));(null===ic||void 0===
ic?0:ic.hasCommentAtActiveCell)?ic.gC.isResolved||Array.add(Ub.buttons,lc.Bb(159)):ic&&ic.hasCommentAtActiveCell||(ic&&ic.Ln&&ic.Ln.cF?Xb||(Array.add(Ub.buttons,lc.Bb(229)),Array.add(Ub.buttons,lc.Bb(230))):(Array.add(Ub.buttons,lc.Bb(160)),Xb||Array.add(Ub.buttons,lc.Bb(226))));Array.add($b.zc,Ub)}};a.prototype.KIh=function($b){if(Xa.EwaSettings.la(135)){var Xb=this.Sa,lc=Xb.Mc();Array.add(lc.buttons,Xb.Bb(250));Array.add($b.zc,lc)}};a.prototype.NHh=function($b,Xb,lc){if(!lc){lc=this.$.Ka.pH();var Oa=
new qa.a(this.$.xa),pb=new ja.a(lc,Xb,this.grid);(new l($b,this.$,this.Sa,lc,Xb,this.grid,pb,Oa)).Pcd()}};a.prototype.DHh=function($b,Xb,lc,Oa,pb){var Ub=(new qa.a(this.$.xa)).te(8),ic=this.Sa,Jb=ic.Mc();Xb&&Array.add(Jb.buttons,ic.Bb(Ub?152:153));lc&&Array.add(Jb.buttons,ic.Bb(Ub?150:151));Xb&&(Oa||Array.add(Jb.buttons,ic.Bb(Ub?109:155)),Array.add(Jb.buttons,ic.Bb(Ub?111:157)));lc&&(pb||Array.add(Jb.buttons,ic.Bb(Ub?108:154)),Array.add(Jb.buttons,ic.Bb(Ub?110:156)));Array.add($b.zc,Jb)};a.prototype.sHh=
function($b,Xb){var lc=this.Sa,Oa=lc.Mc();Array.add($b.zc,Oa);Xb&&Array.add(Oa.buttons,lc.Bb(102));Array.add(Oa.buttons,lc.Bb(42));Array.add(Oa.buttons,lc.Bb(43));Xb=this.oIh(lc);Array.add($b.zc,Xb)};a.prototype.oIh=function($b){var Xb=$b.Mc();Xb.title=ba.a.instance.fa(1100);Xb.f5f=!1;Xb.e5f=!1;Xb.k$f=!1;var lc=5,Oa=ea.a.Jrd(this.$);Oa&&(lc=6);$b=$b.GA("PasteOptionsGallery",lc,"Size24by24",Xb.title);Array.add(Xb.buttons,$b);$b.Bt("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",
1101,void 0,"Paste_24",1,v.a.Suh);$b.Bt("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1102,void 0,"PasteValues_24",1,v.a.Xuh);$b.Bt("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",1103,void 0,"PasteFormulas_24",1,v.a.Uuh);$b.Bt("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1104,void 0,"PasteTranspose_24",1,v.a.Wuh);$b.Bt("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",
1105,void 0,"PasteFormatting_24",1,v.a.Tuh);Oa&&$b.Bt("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1106,void 0,"PasteLink_24",1,v.a.Vuh);return Xb};a.prototype.$Ih=function($b,Xb,lc,Oa,pb){var Ub,ic=this.Sa,Jb=ic.Mc();Array.add(Jb.buttons,ic.Bb(43));Array.add($b.zc,Jb);this.Cnd&&!this.$.rR&&(Jb=this.Sa.Mc(),this.RWe(Jb),Array.add($b.zc,Jb));Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.ea.nc.isMobileMode&&this.$.ea.nc.isReadOnlyEditMode&&
!this.$.ya.IsMeetingLiveSession||(Jb=this.Sa.Mc(),this.$cd(Jb),Array.add($b.zc,Jb),n.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));Jb=this.$.da.Aa(65);if(null===(Ub=null===Jb||void 0===Jb?void 0:Jb.Ln)||void 0===Ub?0:Ub.cF)Ub=this.Sa.Mc(),Array.add(Ub.buttons,ic.Bb(229)),Array.add($b.zc,Ub);Ub=this.Sa.Mc();this.WWe(Ub,Xb,lc,Oa,pb);Array.add($b.zc,Ub);B.AFrameworkApplication.isMobileMode&&
!da.a(this.$.ya,30)&&(Xb=ic.Mc(),Array.add(Xb.buttons,ic.Bb(272)),Array.add($b.zc,Xb))};a.prototype.iIh=function($b,Xb,lc,Oa,pb){var Ub=this.Sa.Mc();this.jIh(Ub);this.WWe(Ub,Xb,lc,Oa,pb);0<Ub.buttons.length&&Array.add($b.zc,Ub)};a.prototype.jIh=function($b){Array.add($b.buttons,this.Sa.Bb(135))};a.prototype.HHh=function($b){var Xb=this.Sa.Mc();Array.add(Xb.buttons,this.Sa.Bb(185));Array.add($b.zc,Xb)};a.prototype.FIh=function($b,Xb){Xa.EwaSettings.la(501)&&Xb&&(Xb=this.Sa.Mc(),Array.add(Xb.buttons,
this.Sa.Bb(262)),Array.add($b.zc,Xb))};a.prototype.UHh=function($b){var Xb=this.grid.ha.va.selectedRanges;if(Xb&&Xb.length){for(var lc=!1,Oa=0;Oa<Xb.length;Oa++)if(this.grid.Rb.KMa(Xb[Oa])){lc=!0;break}if(lc){var pb=this.Sa;lc=pb.Mc();Oa=pb.Mc();for(var Ub=1===Xb.length&&(Xb[0].isSingle||this.grid.Rb.Ezb(Xb[0])),ic=!1,Jb=!1,cc=!1,Ob=!1,P=0;P<Xb.length&&!(ic&&cc&&Jb&&Ob);P++)!ic&&this.grid.Rb.Yki(Xb[P])&&(ic=!0),!cc&&this.grid.Rb.Hff(Xb[P],!1)&&(cc=!0),!Jb&&this.grid.Rb.gqd(Xb[P])&&(Jb=!0),!Ob&&this.grid.Rb.zgi(Xb[P])&&
(Ob=!0);Xa.EwaSettings.la(105)&&Ub&&!this.grid.Rb.hfc(Xb[0])&&(Ob?Array.add(lc.buttons,pb.Bb(217)):Array.add(lc.buttons,pb.Bb(216)));Ob=ic;Ob=!(new qa.a(this.$.xa)).Oj&&Ob;cc&&(Xa.EwaSettings.la(131)&&S.l(this.$.lg)&&(Xa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1)&&(Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?Array.add(Oa.buttons,pb.Bb(220)):Array.add(Oa.buttons,pb.Bb(Ob?220:271))),Jb&&Array.add(Oa.buttons,
pb.Bb(Ob?218:269)),Ub&&(this.grid.Rb.gqd(Xb[0])||this.grid.Rb.hfc(Xb[0]))&&Array.add(Oa.buttons,pb.Bb(Ob?219:270))),Array.add(Oa.buttons,pb.Bb(Ob?215:268)));0<Oa.buttons.length&&(Xb=pb.Wv(ic?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,ba.a.instance.fa(1733),798637440),Array.add(Xb.menu.zc,Oa),Array.add(lc.buttons,Xb));0<lc.buttons.length&&Array.add($b.zc,lc)}}};a.prototype.tHh=function($b,Xb){this.grid.Rb.cef(Xb)&&(Xb=this.Sa.Mc(),this.grid.ha.va.jxa()?
(Array.add(Xb.buttons,this.Sa.Bb(241)),Array.add(Xb.buttons,this.Sa.Bb(239))):Array.add(Xb.buttons,this.Sa.Bb(240)),Array.add($b.zc,Xb))};a.prototype.OV=function($b){return $b.cell.hasHyperlink};a.prototype.bXe=function($b){this.tIh($b);var Xb=this.Sa.Mc();this.$cd(Xb);Array.add($b.zc,Xb)};a.prototype.sIh=function($b,Xb,lc){this.bXe($b);this.JWe($b,Xb,lc)};a.prototype.tIh=function($b){if(this.grid.ha.va.qh&&!this.grid.$a.aj){var Xb=this.Sa,lc=Xb.Mc();jb.a(this.$).lRd()?Array.add(lc.buttons,Xb.Bb(265)):
Array.add(lc.buttons,Xb.Bb(264));Array.add($b.zc,lc)}};a.YVi=function($b){var Xb=$b.oKa(a.Lkd);Xb&&Xb.Bmd&a.Lkd&&$b.invoke(a.Lkd,null)};a.MHh=function($b,Xb,lc){if(Xa.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(lc=lc.da.Aa(254),!lc){n.ULS.sendTraceTag(537167044,0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(lc=lc.da.Aa(254,!0),!lc)return;lc.Wod()&&lc.xkf()&&Array.add($b.buttons,
Xb.Bb(212));lc.Wod()&&lc.Yic()&&Array.add($b.buttons,Xb.Bb(213))};a.prototype.Kxj=function(){var $b=this.grid.ha.va.activeCell;return ma.c(this.$,$b)||!this.ygi($b)};a.prototype.ygi=function($b){var Xb=$b.left,lc=this.h4e();if(null!=lc&&null!=lc.UTe&&Array.contains(lc.UTe,Xb-1))return!0;lc=this.chd();return null!=lc&&fa.D(lc).contains($b)&&null!=lc.FilteredColumns&&Array.contains(lc.FilteredColumns,Xb-1)?!0:!1};a.prototype.Qxj=function(){var $b=this.$.da.Aa(66).Mg;if(null!=$b)return!$b.hasAutoFilter||
!$b.Cob;$b=this.$.xa.getItemByName(this.$.pa.sheetName);return!$b.hasAutoFilter||!$b.Cob};a.prototype.xgi=function(){if(null!=this.h4e())return!0;var $b=fa.D(this.chd());return null!=$b&&$b.contains(this.grid.ha.va.activeCell)?!0:!1};a.prototype.h4e=function(){var $b=this.$.da.Aa(66);$b.En(this.grid.ha.va.activeCell);return $b.XXe(this.grid.ha.va.activeCell)};a.prototype.chd=function(){return this.$.xa.getItemByName(this.$.pa.sheetName).I0};a.prototype.JRh=function(){var $b=this.grid.ha.va.activeCell,
Xb=0,lc=!1,Oa=this.$.da.Aa(66).Mg;null!=Oa?(Xb=Oa.usedRange.top,lc=!0):(Oa=this.chd(),null!=Oa&&fa.D(Oa).contains($b)&&(Xb=Oa.FirstRow+1,lc=!0));return lc?($b=$b.left,Xb=H.Range.kd(Xb,$b),Xb=this.grid.uc(Xb),lc="",null!=Xb&&(lc=Xb.text),this.oQg(lc,$b)):ba.a.instance.fa(221)};a.prototype.oQg=function($b,Xb){null==$b||Ka.a.oi($b.trim())?$b=String.format(ba.a.instance.Cb(156),H.Range.vU(Xb)):$b.length>a.L0d?($b=$b.substring(0,a.L0d),$b=String.format(ba.a.instance.Cb(154),$b)):$b=String.format(ba.a.instance.Cb(155),
$b);return $b};Sk.Object.defineProperties(a.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return V.a.OMf}}});a.gIb="GridContextMenuRootName";a.G2h=V.a.rCe;a.Lkd=192;a.L0d=26;Object(A.a)(a,"GridContextMenu",C.a,[])},1239:function(A,F,b){function a(Ha,Xa){var Na=Pa.call(this,Ha)||this;Na.PCa=null;Na.C_c=[];Na.P4d=null;Na.ewa=!1;Na.Mdc=!1;Na.lq=null;Na.Aae=null;Na.lKe=function(){Na.LY.sJa(Na.items,Na.PCa);
Na.raiseEvent("ACLBUpdated",new z.a(Na.items.length));Na.show()};Na.tableManager=Xa;Na.domElement.className=t.a.iNe;Na.domElement.innerHTML=pa;ba.DOMElementExtensions.setVisible(Na.domElement,!1);qa.d(Na.style,Na.$.isChromeRtl);Na.Exe=$get(n.g8f,Na.domElement);Na.LY=new c(Na.$,Na.Exe);Na.NSa(!0);Na.$.domElement.appendChild(Na.domElement);Na.tob(Ha,X.a(Ha));Na.tob(Ha,U.g(Ha).yc);Na.$.da.Ha(1,Na);Na.Egi=D.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeHandleKeyDownConditionOrder",!1);
return Na}function c(Ha,Xa){Ha=K.call(this,Ha,Xa)||this;Ha.cellAutoCompleteControl=null;Ha.ora=null;Ha.cs=[];return Ha}function e(Ha,Xa){var Na=Q.call(this,Ha,Xa)||this;Na.f3d=null;Na.Uic=0;Na.P7a=null;Na.U0=null;Na.XLa=!1;Na.p6=function(db,Ja){if(db=Na.cellAutoCompleteControl.items)if(1===db.length&&Na.cellAutoCompleteControl.O0a.length<db[0].jsa.length&&Na.cellAutoCompleteControl.ewa&&V.a.yL(db[0].jsa,Na.cellAutoCompleteControl.O0a)&&(Ja.newValue=db[0].jsa),Na.Ya&&D.EwaSettings.la(136)){var jb=
-1;1<db.length?jb=Na.cellAutoCompleteControl.Xbc(Na.Ya.text,!0):1===db.length&&(Na.cellAutoCompleteControl.ewa||Na.cellAutoCompleteControl.Mdc)&&(jb=0);if(0<=jb&&db.length>jb&&db[jb].FXc){var hc=v.C(db[jb].FXc);hc&&U.g(Na.$).Rb.KMa(hc)&&(Ja.Zcf=!0,Ja.Fxe=db[jb].FXc)}}};Na.oEb=function(){Na.XLa&&(Na.cellAutoCompleteControl.ewa=!1)};Na.Ya.FYa(Na.p6);Na.XLa=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");Na.XLa&&(Na.U0=Na.Pd.Dd(Na.Ya.textBox.domElement),Na.U0.ja("mousedown",
Na.oEb));return Na}function l(Ha,Xa){this.Blg=Ha;this.Alg=Xa}function n(){}b.r(F);A=b(0);var m=b(13),f=b(88),x=b(1187),y=b(8),t=b(902);n.g8f="suggested_cells_list_box";Object(A.a)(n,"CssElementIds",null,[]);var B=b(4),z=b(1188);Sk.Object.defineProperties(l.prototype,{jsa:{configurable:!0,enumerable:!0,get:function(){return this.Blg}},FXc:{configurable:!0,enumerable:!0,get:function(){return this.Alg}}});Object(A.a)(l,"CellAutoCompleteItem",null,[799]);var u=b(5),C=b(84),r=b(1043),J=b(384),v=b(43),
D=b(1),V=b(19),U=b(20),Q=r.a;vm(e,Q);e.prototype.dispose=function(){this.Ya.dHb(this.p6);Q.prototype.dispose.call(this)};e.prototype.tU=function(Ha){Ha&&!this.cellAutoCompleteControl.isListVisible||Q.prototype.tU.call(this,Ha)};e.prototype.Rh=function(Ha,Xa){this.cellAutoCompleteControl.Ya=this.Ya;this.Uic=Ha.keyCode;if(this.Ya.isEditing){var Na=this.Ya.text;V.a.equals(this.P7a,Na,!1)||(this.P7a=Na)}else this.P7a=null;if(237279923===Xa)return this.cellAutoCompleteControl.isListVisible=!1;D.EwaSettings.la(136)&&
17===this.Uic&&this.cellAutoCompleteControl.ewa&&(this.cellAutoCompleteControl.Mdc=!0);return Q.prototype.Rh.call(this,Ha,Xa)};e.prototype.pzd=function(){var Ha;if(!D.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")||!u.AFrameworkApplication.Ig)if(this.cellAutoCompleteControl.Ya=this.Ya,this.cellAutoCompleteControl.ewa=!1,this.Ya.isEditing){var Xa=!V.a.equals(this.P7a,this.Ya.text,!0),Na=this.Ya.Ynd;(D.EwaSettings.hif()?Na||!Xa&&229!==this.Uic:
!Xa)?Na&&(this.cellAutoCompleteControl.isListVisible&&(this.cellAutoCompleteControl.isListVisible=!1),null===(Ha=this.cellAutoCompleteControl.yNa)||void 0===Ha?void 0:Ha.cancel()):this.cellAutoCompleteControl.RLg(this.Uic)}else this.P7a=null};e.prototype.fj=function(){};e.prototype.Kg=function(){this.TV=!1;this.cellAutoCompleteControl.set_visible(!1);this.P7a=null;this.cellAutoCompleteControl.ewa=!1;this.cellAutoCompleteControl.Mdc=!1;this.cellAutoCompleteControl.yNa&&this.cellAutoCompleteControl.yNa.cancel()};
e.prototype.LFd=function(Ha,Xa){return this.cellAutoCompleteControl.Rh(Ha,Xa)};Sk.Object.defineProperties(e.prototype,{tyb:{configurable:!0,enumerable:!0,get:function(){return!1}},TV:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(Ha){this.cellAutoCompleteControl.isListVisible=Ha}},yLa:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return J.a.D_c}},cellAutoCompleteControl:{configurable:!0,
enumerable:!0,get:function(){var Ha=b(1239).CellAutoCompleteControl;return this.f3d||(this.f3d=Object(C.a)(Ha,this.$.da.Aa(1)))}}});Object(A.a)(e,"CellAutoCompleteListAutoCompleteBehavior",r.a,[]);var la=b(29);r=b(1189);var ba=b(11),T=b(9),H=b(118),S=b(63),K=r.a;vm(c,K);c.prototype.dispose=function(){K.prototype.dispose.call(this);this.ora=null};c.prototype.fzc=function(Ha){this.J7(!1);var Xa=""+String.format("<table class='{0}' aria-live='polite'><tbody>",this.Wba);for(var Na=0,db=this.cs.length;Na<
db;Na++){var Ja=la.a.Lf(Ha[this.cs[Na]].jsa);Ja=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",this.p_,c.E_c,B.a.cqe,Ja,la.a.y7b(Ja));Xa+=Ja}this.gg.innerHTML=Xa+"</tbody></table>";this.Jn=ba.DOMElementExtensions.Bj(this.domElement,this.Wba);this.J7(!0);this.Rra()};c.prototype.sJa=function(Ha,Xa){if(Ha&&Ha.length){var Na=[];if(Xa)for(var db=0,Ja=Ha.length;db<Ja;db++)V.a.yL(Ha[db].jsa,Xa)&&Array.add(Na,db);this.cs=Na;this.fzc(Ha)}else this.isListVisible=!1,this.ora=
null};c.prototype.bya=function(){};c.prototype.CTg=function(Ha,Xa,Na){var db=Math.min(Ha,Math.max(200,Na));Xa&&Ha<Na&&(db+=H.a.gq);ba.DOMElementExtensions.Uq(this.gg,db);Xa&&(db-=H.a.gq);return db};c.prototype.Rra=function(){K.prototype.Rra.call(this);var Ha=ba.DOMElementExtensions.Bj(this.get_element(),this.Wba),Xa=this.cs.length>this.bI,Na=U.g(this.$);if(Na=Na.uc(Na.ha.va.activeCell))for(Ha=this.CTg(Ha.offsetWidth,Xa,Na.width),Xa=this.gg.getElementsByClassName(c.E_c),Na=0;Na<Xa.length;Na++)Xa[Na].style.maxWidth=
T.HelperMethods.Qb(Ha);else m.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};c.prototype.onc=function(Ha){if(Ha=K.prototype.onc.call(this,Ha)){var Xa=U.g(this.$);Xa.Rq(!1);Xa.focus()}return Ha};Sk.Object.defineProperties(c.prototype,{Mk:{configurable:!0,enumerable:!0,get:function(){return this.ora},set:function(Ha){this.oBa(this.Mk);this.ora=Ha;var Xa=this.oBa(this.Mk);this.qe=Ha?Xa.innerText:null;this.Cuc(Ha)}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(S.a)(c.prototype,this,"isListVisible")},set:function(Ha){Object(S.b)(c.prototype,this,"isListVisible",Ha);Ha||(this.Mk=null)}},jTa:{configurable:!0,enumerable:!0,get:function(){return null}},oGa:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.Aa(1))}}});c.E_c=t.a.cuh;Object(A.a)(c,"CellAutoCompleteListBox",r.a,[]);var da=b(24),fa=b(61),X=b(119),ca=b(185),
ja=b(42),ea=b(32),qa=b(246);r=b(16);b.d(F,"CellAutoCompleteControl",function(){return a});var pa="<div id='"+n.g8f+"' class='"+t.a.C9c+" "+r.a.Tk+"' ></div>",Pa=x.a;vm(a,Pa);a.prototype.kVc=function(Ha){this.addHandler("ACLBUpdated",Ha)};a.prototype.uJd=function(Ha){this.removeHandler("ACLBUpdated",Ha)};a.prototype.G2=function(Ha){this.addHandler("ACLBSelectionChanged",Ha)};a.prototype.pda=function(Ha){this.removeHandler("ACLBSelectionChanged",Ha)};a.prototype.BFg=function(Ha){this.addHandler("ACLBMatchedItem",
Ha)};a.prototype.Lcj=function(Ha){this.removeHandler("ACLBMatchedItem",Ha)};a.prototype.s7f=function(Ha){for(var Xa=0;Xa<Ha.length;Xa++){var Na=Ha.charCodeAt(Xa);if(D.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?V.a.isLetter(Na):V.a.fpd(Na))return!0}return!1};a.prototype.Pwa=function(){return!this.items};a.prototype.dispose=function(){if(this.$){this.NSa(!1);var Ha=U.g(this.$);Ha&&Ha.view.Nq(this.fnc)}f.a.rc([this.LY,this.yNa]);f.a.rc(this.C_c);
this.C_c=this.Exe=this.LY=this.Ya=null;Pa.prototype.dispose.call(this)};a.prototype.Rh=function(Ha,Xa){var Na=!1,db=D.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");if(this.gyj(db,Xa))switch(Xa){case -798660877:if(1===this.items.length&&this.qe)break;this.Gt.jB(1);this.raiseEvent("ACLBSelectionChanged",new z.a(this.items.length,this.Xbc(this.qe),this.qe));Na=this.My(!1);break;case 137938150:if(1===this.items.length&&this.qe)break;this.Gt.jB(-1);this.raiseEvent("ACLBSelectionChanged",
new z.a(this.items.length,this.Xbc(this.qe),this.qe));Na=this.My(!1);break;case 2091832999:this.Gt.jB(this.bI-1);Na=this.My(!1);break;case 742457698:this.Gt.jB(-(this.bI-1));Na=this.My(!1);break;case 125627505:this.Ya.textBox.caretPosition=this.Ya.text.length;this.isListVisible=!1;Na=!0;break;case 267796030:db||1!==this.items.length?this.My(!0):this.mec(!0);break;default:Na=Pa.prototype.Rh.call(this,Ha,Xa)}return Na};a.prototype.show=function(){this.items&&this.items.length&&(this.LY.Mk=this.qe?this.Gt.Jn.rows[this.Xbc(this.qe)]:
null,this.isListVisible=0<this.LY.cs.length,this.DBa(!0),this.LY.bya())};a.prototype.RLg=function(Ha){var Xa=!!this.Ya&&!fa.f(this.$.pa);this.Mdc=this.ewa=!1;this.Ya&&!this.Ya.isEditing?this.set_visible(!1):Xa&&!this.Bbh(this.activeCell)&&this.OBj(Ha)};a.prototype.Bbh=function(Ha){return!!this.dataValidationControl&&this.dataValidationControl.p7c(Ha)};a.prototype.My=function(Ha){if(!this.Ya||!this.isListVisible)return!1;var Xa=this.PCa;if(this.qe){var Na=ba.DOMElementExtensions.CZ(ba.DOMElementExtensions.Bj(this.LY.Mk,
c.E_c),B.a.cqe,""),db=Na.substring(Xa.length,Na.length);Ha?this.Ya.text=Na:this.Ya.insertTextAt(db,Xa.length,this.Ya.text.length)}Na=U.g(this.$);Na.Dj&&(Na=Na.yc,Na.text=this.Ya.text,Na.setCaretPosition(this.Ya.textBox.caretPosition));Ha?this.isListVisible=!1:this.Ya.textBox.selectRange(Xa.length,this.Ya.text.length);return!0};a.prototype.Xbc=function(Ha,Xa){Xa=void 0===Xa?!1:Xa;if(!this.LY.Jn)return-1;for(var Na=this.LY.Jn.children[0],db=Na.children.length,Ja,jb=0;jb<db;++jb)if(Ja=Na.children[jb],
V.a.equals(Ja.innerText.trim(),Ha,Xa))return jb;return-1};a.prototype.HAg=function(Ha,Xa,Na,db,Ja,jb,hc){var ma=Na.originalText.replace(a.Nsf,String.fromCharCode(32)),Ka=new da.Range(Ha.top-1,Ha.left,Ha.bottom-1,Ha.right,!1,!1),Ta=hc?hc.En(Na.range):null;(!Na.NH||Na.range.left===Ha.left)&&1<ma.length&&!db.xb(ma.toUpperCase())&&V.a.yL(ma,Xa)&&!V.a.equals(ma,Xa,!0)&&!a.HUe(Xa)&&this.s7f(ma)&&(!Ja&&!Ta||!Ja&&Ta.equals(hc.En(Ka))||Ja&&Na.range.Qd(jb)&&Na.range.top!==jb.top)&&(Ha=Na.formulaBarText,V.a.equals(Ha,
Na.text,!1)||!Ha)&&(Ha={},Ha.FirstRow=Na.range.top-1,Ha.FirstColumn=Na.range.left-1,Na=new l(ma,Ha),db.add(ma.toUpperCase(),Na))};a.prototype.OBj=function(Ha){this.lq=this.$Zh();this.yNa&&this.yNa.cancel();0<this.Ya.text.length&&(D.EwaSettings.hif()||229!==Ha)&&0!==Ha?this.items&&((1<this.items.length||this.isListVisible)&&this.oih(),8!==Ha&&127!==Ha&&46!==Ha&&(1===this.items.length?this.mec(!1):this.LY.Mk&&this.My(!1))):this.isListVisible=!1};a.prototype.oih=function(){this.isListVisible?this.lKe():
this.Aae=ca.AsyncMethodContext.Zy(this.lKe,500,ja.a.PVg,this.yNa)};a.prototype.mec=function(Ha){m.ULS.shipAssertTag(537167966,0,!this.Pwa()&&1===this.items.length,"Invalid Items");var Xa=this.items[0].jsa,Na=this.Ya.text,db=Xa.substring(Na.length,Xa.length);if(Ha&&!db.length)this.Ya.text=Xa;else if(!Ha&&0<db.length)this.Ya.appendText(db),this.Ya.textBox.selectRange(Na.length,this.Ya.text.length);else return;this.raiseEvent("ACLBMatchedItem",new z.a(this.items.length,0,Xa));this.ewa=!0};a.prototype.$Zh=
function(){this.lq=null;var Ha=new ea.a(!1),Xa=this.activeCell;this.PCa=this.Ya.text.replace(a.Nsf,String.fromCharCode(32));var Na=this.tableManager.En(Xa),db=Xa.Qd(Na);if(a.HUe(this.PCa)||!this.s7f(this.PCa))return this.items;var Ja=new da.Range(1,Xa.left,Xa.top-1,Xa.left,!1,!1),jb=new da.Range(Xa.top+1,Xa.left,y.a.Lh,Xa.left,!1,!1),hc=U.g(this.$);jb=hc.xl("CellAutoCompleteControl.GetSuggestedCells",jb);try{var ma=hc.xl("CellAutoCompleteControl.GetSuggestedCells2",Ja);try{for(var Ka=yl([ma,jb]),
Ta=Ka.next();!Ta.done;Ta=Ka.next())for(var ob=Ta.value;ob.$$mn();){var Cb=ob.$$cu();this.HAg(Xa,this.PCa,Cb,Ha,db,Na,this.tableManager)}}finally{ma&&ma.dispose()}}finally{jb&&jb.dispose()}this.lq=Array(Ha.values.length);for(Xa=0;Xa<this.items.length;Xa++)this.items[Xa]=Ha.values[Xa];this.items.sort(function(eb,ya){return eb.jsa.localeCompare(ya.jsa)});return this.items};a.prototype.tob=function(Ha,Xa){Ha&&Xa&&Array.add(this.C_c,new e(Ha,Xa))};a.prototype.gyj=function(Ha,Xa){return this.Egi?Ha||267796030!==
Xa?this.O0a&&!this.Pwa()&&this.isListVisible?this.get_visible():!1:!0:this.O0a&&!this.Pwa()&&this.get_visible()&&this.isListVisible||!Ha&&267796030===Xa};a.HUe=function(Ha){Ha=0<Ha.length?Ha.charCodeAt(0):-1;return 35===Ha||61===Ha||43===Ha||45===Ha||64===Ha};Sk.Object.defineProperties(a.prototype,{Gt:{configurable:!0,enumerable:!0,get:function(){return this.LY}},O0a:{configurable:!0,enumerable:!0,get:function(){return this.PCa}},qe:{configurable:!0,enumerable:!0,get:function(){return this.LY.qe}},
items:{configurable:!0,enumerable:!0,get:function(){return this.lq}},yNa:{configurable:!0,enumerable:!0,get:function(){return this.Aae}},activeCell:{configurable:!0,enumerable:!0,get:function(){return U.g(this.$).ha.va.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.P4d||(this.P4d=this.$.da.Aa(14))}}});Sk.Object.defineProperties(a,{Nsf:{configurable:!0,enumerable:!0,get:function(){return a.ice||(a.ice=new RegExp(String.fromCharCode(160),"g"))}}});a.ice=
null;Object(A.a)(a,"CellAutoCompleteControl",x.a,[759,754,760,3])},1373:function(A,F,b){function a(){this.tb=null;this.Ww=!1}function c(d,w){var I=ka.call(this)||this;I.jqa=ql.a.cJh;I.NOc=!!window.PointerEvent;I.Zie=window.hasOwnProperty("ontouchstart");I.okb=null;I.WVa=null;I.P8=!1;I.qT=new We.a;I.Kkb=new We.a;I.upg=new W.a;I.Fpa=null;I.lmb=!1;I.r3d=!1;I.pfe=!1;I.IMc=!1;I.ZFc=!1;I.l3d=!1;I.dJc=!1;I.$Ua=!1;I.Pjb=-1;I.wRc=null;I.session=null;I.handlers=null;I.element=null;I.curRecognizer=null;I.Vd=
Rh.EventHandlerManager.instance;I.NOc?(Fd.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),I.okb=Object(Sg.a)(I,I.Tnc,"onPointerEvent"),I.WVa=sg.a.eJh):I.Zie?(Fd.ULS.sendTraceTag(593893140,310,50,"Using touch events"),I.okb=Object(Sg.a)(I,I.Nya,"onTouchEvent"),I.WVa=sg.a.touchEvents):(Fd.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),I.okb=Object(Sg.a)(I,I.Enc,"onMouseEvent"),I.WVa=sg.a.dJh);I.Ah=w;I.vfa=d;zg.AFrameworkApplication.ga&&(I.lmb=zg.AFrameworkApplication.ga.ra("UsePointerCaptureIsEnabled"),
I.r3d=zg.AFrameworkApplication.ga.ra("ClearCacheOnPrimaryPointerIsEnabled"),I.pfe=zg.AFrameworkApplication.ga.ra("ResetHandledBeforeInputHandlerIsEnabled"),I.IMc=zg.AFrameworkApplication.ga.ra("LogCoalescedEventsIsEnabled"),I.ZFc=zg.AFrameworkApplication.ga.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),I.l3d=zg.AFrameworkApplication.ga.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),I.dJc=zg.AFrameworkApplication.ga.ra("HammerJsPerformanceTimersIsEnabled"),I.$Ua=I.lmb&&zg.AFrameworkApplication.ga.ra("CancelDragFromGestureInputManagerIsEnabled")&&
zg.AFrameworkApplication.ga.ra("UseGestureInputManagerPointerCacheIsEnabled"));return I}function e(){}function l(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function n(d,
w,I,ha,wa,$a,Tb,Ic,pc){d=Yk.call(this,d,I,ha,$a)||this;d.ahb=w;d.wga=Tb;d.OX=Ic;d.j_j=pc;d.tpg=wa;return d}function m(){this.pHc=null}function f(){this.bda=this.oXe=null}function x(d){var w=hl.call(this)||this;w.$=d;w.dc();return w}function y(d,w,I,ha,wa){var $a=Xk.call(this)||this;$a.cP=null;$a.s0=null;$a.pFa=null;$a.Juc=null;$a.HNc=null;$a.AXa=null;$a.Bee=0;$a.yEc=!1;$a.Yh=function(){$a.zwa&&($a.gridView?1===$a.gridView.ha.Ve?($a.gridView.ha.va.activeCell.equals($a.pFa)||$a.rN||$a.Mx(),$a.oob.Pq()):
$a.Mx():Fd.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};$a.fj=function(){$a.Mx()};$a.rd=function(){$a.jX()};$a.od=function(){$a.Mx()};$a.Zc=function(){$a.showCallout()};$a.wya=function(){if($a.nh.Ek&&$a.nh.Ek.length)if($a.cZc)$a.nh.Tti||($a.yEc=$a.nh.Ek[0].BlockingDataForExpand),$a.nh.WPh&&Fd.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),$a.Bee=$a.nh.h5c&&$a.nh.lWe<$a.nh.h5c.left-1?$a.nh.h5c.left-1-$a.nh.lWe:
-1,$a.showCallout();else if($a.gridView.ha.va.qh){var Tb=$a.gridView.ha.va.activeCell;if(Tb&&$a.s0){var Ic=$a.tableManager.En(Tb);$a.xLc=!!Ic;var pc=$a.gridView.ha.va.Sd;Ic=$a.rN&&$a.s0.Qd(Ic);var vd=$a.Aid&&!$a.rN&&pc.equals($a.selectedRange);Ic||vd?(Fd.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),$a.f9b=!0,ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!$a.rN&&$a.tableManager.vKa(Tb)?Fd.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):
(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?$a.rN?$a.Uh.IAa($a.s0,$a.rN):$a.Uh.IAa(pc,$a.rN):$a.Uh.IAa($a.s0,$a.rN),$a.ytc())):Fd.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};$a.ej=function(){$a.B6a()&&$a.Uh.hide();1===$a.gridView.ha.Ve&&$a.jX()};$a.WR=function(){var Tb=$a.gridView.ha.Ve;$a.gridView.ha.va.activeCell&&1===Tb&&$a.jX()};$a.it=function(){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if($a.rN){if($a.s0&&
$a.pFa){var Tb=$a.tableManager.En($a.pFa);Tb&&1<Tb.bottom-Tb.top&&(--Tb.bottom,$a.gridView.e_(Tb)&&$a.oob.Pq())}}else $a.gridView.ha.va.qh&&$a.gridView.e_($a.gridView.ha.va.Sd)&&$a.oob.Pq();else $a.s0&&$a.pFa&&$a.rN&&(Tb=$a.tableManager.En($a.pFa))&&1<Tb.bottom-Tb.top&&(--Tb.bottom,$a.gridView.e_(Tb)&&$a.oob.Pq())};$a.jX=function(){if($a.$&&$a.gridView){if($a.f9b&&$a.rN){var Tb=$a.gridView.ha.va.activeCell;$a.s0=$a.pUe();var Ic=!!$a.Juc&&$a.Juc.contains(Tb);if($a.s0&&(Tb.equals($a.pFa)||Ic)){$a.Uh.IAa($a.s0,
$a.rN);return}}$a.f9b=!1;$a.s0=$a.pUe();$a.s0&&$a.kya&&$a.gridView&&$a.gridView.Ca.es($a.kya)?($a.cZc=!1,$a.DZ()):($a.nh.a_c(),$a.nh.h1b());$a.f9b||$a.Uh.hide()}};$a.$=d;$a.tableManager=I;$a.contextMenuManager=ha;$a.Uh=new t(d,$a.Zc,w,wa);$a.nh=w.M3c(d,I);$a.cZc=!1;$a.f9b=!1;$a.Aid=ye.EwaSettings.la(136);$a.xLc=!0;$a.gridView=Ne.g($a.$);$a.gridView.yc.Yl($a.fj);$a.gridView.ar($a.WR);$a.$.Qk($a.rd);$a.$.vl($a.od);$a.$.nA($a.ej);$a.gridView.view.Ms($a.it);$a.gridView.ha.J2($a.Yh);$a.oob=zi.a.instance.create($a.jX,
250,Ei.a.p3i);Fd.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");$a.nh.RYb($a.wya);$a.jX();d.da.Ha(261,$a);return $a}function t(d,w,I,ha){var wa=wk.call(this)||this;wa.isMac=Ci.a.isMac;wa.$=d;wa.ariaLiveNotifier=ha;wa.Jp=I.p4b(d,null,w,N.a.evh,Eg.a.Ee(9),te.a.instance.fa(1691),"PulloutPointerDown");return wa}function B(d){var w=ll.call(this)||this;w.r4b=null;w.$=d;w.dc();return w}function z(d){var w=pl.call(this)||this;w.$=d;return w}function u(){}function C(d,w,I,ha,wa){I=void 0===
I?null:I;ha=void 0===ha?null:ha;wa=void 0===wa?0:wa;d=J.call(this,d,w)||this;d.DNa=null;d.lec=I||Eg.a.current.ro(82);d.lmf=wa;d.l5c=ha;d.IBg();return d}function r(d,w,I,ha){d=J.call(this,d,w)||this;d.gBb=null;d.Vng=I;d.t7h=ha;d.JBg();return d}function J(d,w){d=kl.call(this,d)||this;d.hBb=null;d.f$h=Math.max(1,w);return d}function v(d,w,I,ha,wa,$a,Tb,Ic){Ic=void 0===Ic?"":Ic;var pc=Rk.call(this)||this;pc.qwa=null;pc.g$e=!1;pc.llc=null;pc.klc=null;pc.buttons={};pc.ZMe={};pc.$=d;pc.svgIconProvider=w;
pc.PIi=I;pc.dld=ha;pc.cld=wa;pc.altText=$a;pc.qFb=Tb;pc.buttonText=Ic;return pc}function D(d,w,I,ha,wa,$a,Tb,Ic){function pc(ne){jh.g(ne)}var vd=Lk.call(this,document.createElement("div"))||this;vd.wkf=null;vd.wSd=!1;vd.nSa=null;vd.nMb=null;vd.EF=function(){vd.raiseEvent("OnObjectButtonMouseOver")};vd.jI=function(){vd.raiseEvent("OnObjectButtonMouseOut")};vd.qDj=function(){vd.Mke()};vd.Zc=function(ne){vd.raiseEvent(vd.qFb,ne);vd.oFb();return!0};vd.Zzd=function(ne){100<wj.a(sh.a.Ra,vd.wkf)&&vd.$id(new Sys.UI.Point(Math.round(ne.clientX),
Math.round(ne.clientY)))};vd.QN=function(ne){jh.g(ne.Ea,!1);return!1};vd.hZ=vd.Pd.kta();vd.set_visible(!1);vd.Rhc=wa;vd.qFb=$a;vd.Qlc=d;vd.f2b=w;vd.Rhc&&(vd.nSa=zi.a.instance.create(vd.qDj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));d&&vd.domElement.classList.add(d);vd.h_a=document.createElement("div");vd.domElement.appendChild(vd.h_a);I&&vd.h_a.classList.add(I);ha&&(vd.h_a.innerHTML=ha);Tb&&(vd.nMb=document.createElement("div"),vd.domElement.appendChild(vd.nMb),vd.nMb.classList.add(Ic),vd.nMb.innerText=
Tb,vd.domElement.style.padding="3px",Qj.a.instance.qa(sg.a.pointerDown,vd.domElement,vd.QN));vd.ZZa=new Qk.a(vd.domElement,7);Yh.a.instance.qa(sg.a.click,vd.domElement,vd.Zc);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&Qj.a.instance.qa(sg.a.pointerDown,vd.domElement,vd.QN);vd.wc.ja("mouseup",pc);vd.wc.ja("click",pc);vd.wc.ja("dblclick",pc);return vd}function V(){}function U(d,w,I,ha){var wa=Q.call(this,d,w)||this;wa.M1a=null;wa.Wxf=function(){wa.Csc(wa.Wxf);
if(wa.Ek&&wa.Ek.length&&wa.contextMenuManager){var $a=wa.contextMenuManager.bed("autoFilterRichFieldList"),Tb=window.document.getElementById(wa.M1a);$a.HO(null,Tb,wa,null,!0)}};wa.Clg=I;wa.contextMenuManager=ha;return wa}function Q(d,w){var I=vk.call(this)||this;I.wP=null;I.Zub=null;I.Fed=null;I.XHb=null;I.tTb=!1;I.B4d=null;I.jMi=function(ha,wa,$a){Fd.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+$a);I.XHb&&I.XHb.stop();I.wP=null;I.raiseEvent("GetFieldInfoListContextOperationFailed")};
I.kMi=function(ha){xh.a(ha)||(I.XHb&&I.XHb.stop(),I.tTb=!1,I.wP=ha.Result,I.wP&&0<I.wP.length&&Fd.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",I.wP.length),I.ajb=!0,I.eGd())};I.ajb=!1;I.vb=d;I.fSb=-1;I.tableManager=w;return I}function la(d){var w=Fi.call(this)||this;w.firstElement=null;w.to=null;w.mMa=!1;w.Cs=null;w.jxj=Ci.a.Df||Ci.a.cB;w.Yzf=function(I){var ha=I.Ea.keyCode;return ha===Td.a.$h?w.PKi():ha===Td.a.AD&&I.Ea.shiftKey?w.yzh(w.firstElement):
!1};w.BFf=function(I){if(!w.mMa||I.Ea.keyCode!==Td.a.LL)return!1;la.G9e();Vf.Task.delay(1).CWRCC(function(){w.to.focus();return!0},w.ma);return!0};w.EVi=function(){document.activeElement&&document.activeElement.id===w.to.id||(la.G9e(),Vf.Task.delay(1).CWRCC(function(){w.to.focus();return!0},w.ma))};w.cyf=function(){w.cag(w.to)};w.Xzf=function(I){I.stopPropagation();I.preventDefault();w.mMa&&(w.mMa=!1)};w.$=d;(d=w.$.ea.nc)&&Fd.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",
d.E$,d.inWebPart?"Classic":"Non Classic",d.inEmbedView?"True (+Modern)":"False (not Modern)");d&&(d.inWebPart||d.inEmbedView)?Fd.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",d.inWebPart?"Classic":"Non Classic",d.inEmbedView?"True (+Modern)":"False (not Modern)"):(w.B6g(),w.y7g(),di.KeyInputManager.instance.qa(sg.a.Sb,w.$.domElement,w.BFf));w.$.da.Ha(238,
w);return w}function ba(d,w,I,ha,wa){wa=void 0===wa?null:wa;var $a=Bj.call(this)||this;$a.Inb=null;$a.$Oa=null;$a.gZc=0;$a.Joc=null;$a.eSi=function(){var Tb=$a.$Oa.TZe();Fd.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",$a.xla,Tb);$a.Joc=zi.a.instance.create($a.mma,Math.max($a.Nve-Tb,0),Ei.a.yke)};$a.mma=function(){Fd.ULS.sendTraceTag(537153860,0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",
$a.xla,$a.$Oa.TZe(),$a.M5a);$a.gZc++;$a.gZc>$a.Mve&&Fd.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",$a.xla);$a.$Oa.qx.C();$a.yUe()};$a.vya=function(){$a.M5a&&Fd.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",$a.xla,$a.MLa,$a.M5a);$a.Emd()};$a.wzg=d;$a.xzg=w;$a.documentVisibilityObserver=I;$a.xla=ha;$a.TO=wa;I&&$a.documentVisibilityObserver.nnb($a.vya);
$a.fZc=!!I&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);$a.Mve=ye.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);w=ye.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);$a.Nve=d.I$b(w);d=ye.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);$a.QSg=Math.max($a.Nve-w,0)+d;return $a}
function T(){this.startTime=sh.a.Ra.Kb;this.qx=new Ri.a}function H(d){var w=Wg.call(this)||this;w.$=d;w.dc();return w}function S(d,w,I,ha,wa,$a){var Tb=this;this.$=d;this.functionInfoManager=w;this.calcManager=I;this.pluginScheduler=ha;this.formulaAssistanceUIControl=wa;this.nh=$a;this.aSa=!0;this.jNa=null;this.iNa=-1;this.Mh=function(){Ne.g(Tb.$).isEditing||Ne.g(Tb.$).Ci||Tb.CCb()};this.onFunctionInfoLoaded=function(){Tb.functionInfoManager.kHb(Tb.onFunctionInfoLoaded);Tb.gUj();Tb.wda()};this.Ruf=
function(){Tb.aSa=!1};this.Zuf=function(Ic,pc){var vd=Tb.Ya;Ic=vd.text;vd=vd.textBox.caretPosition;ra.instance.D7(["argumentAssistanceComputation"]);pc.shouldRequestAutocompleteOnCommit?Tb.SXf(Ic,vd):Tb.pluginScheduler.requester().argumentAssistance({content:Ic,caretPosition:vd}).then(function(ne){0===ne.kind&&Tb.l6e(ne.payload)})};this.Kg=function(){Tb.aSa=!0;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6103891_dismissControlOnEditEnded")&&Tb.OIe()};this.p6=function(Ic,pc){Tb.kMd(pc.newValue)};
this.Jg=function(){Tb.pdg()};this.pdg=function(){Tb.pluginScheduler.notifier().setDefinedNamesInfo(Tb.F5b.tHe)};this.$=d;this.functionInfoManager=w;this.formulaAssistanceUIControl=wa;this.pluginScheduler=ha;ra.instance.$=d;this.dgf=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");this.qba=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.pyd=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");
this.dgf&&(this.F5b=new ec(d),Ne.g(this.$).Ca.Fp(this.Jg),this.pdg());this.sDa=new X(this.$,this.formulaAssistanceUIControl);this.dqa=new fa(this.$,this.formulaAssistanceUIControl);d.da.Ha(464,this);this.calcManager=I;yg.a.a_()&&this.emd();this.qba&&(Ne.g(this.$).pc.Mo(this.Kg),this.sDa.IEg(this.Ruf));this.Q5a=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache")}function K(d,w){var I=this;this.nh=d;this.$=w;this.wya=function(){I.e9b.resolve(I.nh.Ek);I.Ibg();
I.xxf||(Ne.g(I.$).pc.Mo(I.Kg),I.xxf=!0)};this.Gyf=function(){I.e9b.reject(null);I.Ibg()};this.Kg=function(){I.nh.zbb();Ne.g(I.$).pc.Pn(I.Kg);I.xxf=!1}}function da(){var d=this;this.promise=new Promise(function(w,I){d.dvg=w;d.Mug=I})}function fa(d,w){var I=gg.call(this,fa.TJa())||this;I.Ya=null;I.kr=null;I.qIa=!1;I.rIa=!1;I.pIa=!1;I.nIa=!1;I.oIa=!1;I.Nv=null;I.A0=0;I.Oq=null;I.Kv=!1;I.Ofa=!1;I.PAa=!1;I.wSa=!1;I.qLb=!1;I.gNb=Be.Dismissed;I.dismiss=function(){I.Kv=!1;I.rba&&I.Ytd();I.lN&&I.Ya.isEditing&&
I.kda();I.Oq=null;I.formulaAssistanceUIControl&&(I.formulaAssistanceUIControl.dismiss(I.domElement),I.Dka&&(I.kr.canReceiveFocus=!1),I.gNb=Be.Dismissed)};I.Gid=function(){I.oMa&&I.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};I.pKi=function(){I.dismiss();Ne.g(I.$).yj.textBox.focus()};I.oRa=function(){var ha={};I.MFf?ha[Ca.a.rZ]="SmartSuggestionsCard":ha[Ca.a.rZ]="FunctionAndSmartSuggestionsCard";I.$.xe(802602464,0,8,ha)};I.Kg=function(){I.Nyb&&I.OIg()};I.Qzd=function(ha,wa){I.cfb(wa);I.rba&&(I.rIa=
!0)};I.nd=function(){I.visible=!1};I.Pzd=function(ha){I.rba&&(I.oIa=!0);I.l0a(ha)};I.ii=function(){I.dismiss()};I.it=function(){void 0!==I.Oq&&null!==I.Oq&&I.Oq()};I.$=d;I.formulaAssistanceUIControl=w;I.Dka=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");I.Dka&&(I.kr=new ub(I.$,I.formulaAssistanceUIControl,1,ki.a.mcd,I.Gid));Ne.g(I.$).view.Ms(I.it);Ne.g(I.$).ha.OG(I.nd);I.$.xa.Qf(I.ii);I.iN=yg.a.iN(I.$);I.Nyb=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");
I.god=I.iN&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5543855_EnterCommitsSmartSuggestions");I.rba=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");I.oMa=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");I.Qnd=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6018145_AutoCompleteDismissFocus");I.nMa=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout");I.Nyb&&Ne.g(I.$).pc.Mo(I.Kg);return I}
function X(d,w){var I=$d.call(this,X.TJa())||this;I.O2=0;I.kr=null;I.Oq=null;I.nla=null;I.Kv=!1;I.lR=!1;I.nd=function(){I.visible=!1};I.onCardModeChange=function(ha){I.qNb(ha);1===ha?ra.instance.Iaa.argumentAssistanceCollapseCounter++:ra.instance.Iaa.argumentAssistanceExpandCounter++};I.oRa=function(ha){var wa={};wa[Ca.a.rZ]="ArgumentAssistanceCard";var $a={};$a.FunctionName=ha.functionName;wa[Ca.a.lad]=$a;I.$.xe(802602464,0,8,wa)};I.it=function(){void 0!==I.Oq&&null!==I.Oq&&I.Oq()};I.onDismissClick=
function(){ra.instance.Iaa.argumentAssistanceDismissCounter++;I.dismiss();I.raiseEvent("DC");I.lR&&I.cH.clear();ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&0===I.O2&&I.qNb(1)};I.Kg=function(){I.lR&&I.cH.clear()};I.$=d;I.formulaAssistanceUIControl=w;I.Vm=yg.a.iN(d);I.qba=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);I.NOd();I.kr=new ub(I.$,I.formulaAssistanceUIControl,0,ki.a.icd);Ne.g(I.$).view.Ms(I.it);
Ne.g(I.$).ha.OG(I.nd);I.lR=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1);I.lR&&(I.cH=new ya(I.formulaAssistanceUIControl),Ne.g(I.$).pc.Mo(I.Kg));return I}function ca(d,w,I,ha,wa,$a,Tb,Ic){var pc=rd.call(this,d)||this;pc.sdc=!1;pc.kr=null;pc.pGa=null;pc.Mg=null;pc.ZV=null;pc.Prd=null;pc.G5=null;pc.d3a=0;pc.v$b=0;pc.T3=0;pc.KJe=0;pc.hsb=0;pc.Sdb=0;pc.V4b=0;pc.cxc=!1;
pc.Zia=null;pc.ppc=null;pc.columnName="";pc.p6c=!1;pc.$we=!1;pc.HJa=[];pc.AQ=null;pc.vSa=[];pc.Oq=null;pc.Lcd=null;pc.p8=null;pc.Ofa=!1;pc.PAa=!1;pc.wSa=!1;pc.qLb=!1;pc.jNa=null;pc.iNa=0;pc.X1d=null;pc.Xmd=!1;pc.Gid=function(){pc.oMa&&pc.raiseEvent(ca.Nbd,null)};pc.LTe=function(){pc.Zia=!1;pc.ZV=pc.Ya.text;pc.Kf.sJa(pc.Nv,pc.ZV,!0,pc.columnName,void 0,!1);1===pc.Kf.cs.length&&1===pc.Kf.DW.length?(pc.set_visible(!1),pc.$we||pc.mec()):pc.show()};pc.uNi=function(vd){if(xh.a(vd))-315732528!==vd.Errors[0].MessageId&&
Fd.ULS.sendTraceTag(537162013,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",hh.a.Tc(vd.Errors));else if((vd=vd.Result)&&vd.length){pc.Mg.QO||(pc.Mg.QO={},pc.Mg.QO.HeadersList=[]);pc.Mg.QO.IsFullTableHeaders=!0;for(var ne=0;ne<vd.length;++ne)pc.Mg.QO.HeadersList[ne]={},pc.Mg.QO.HeadersList[ne].Index=ne,pc.Mg.QO.HeadersList[ne].Name=vd[ne];pc.tIf(!0);pc.ZV=pc.g4e();pc.Kf.sJa(pc.Nv,pc.ZV,!0,void 0,void 0,!0);pc.show()}else Fd.ULS.sendTraceTag(537162012,
0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};pc.tNi=function(vd){vd=Cg.a.og(vd.data);Fd.ULS.sendTraceTag(537162011,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",hh.a.Tc(vd))};pc.gzd=function(){Ne.g(pc.$).isEditing||Ne.g(pc.$).Ci||pc.CCb()};pc.p6=function(vd,ne){pc.kMd(ne.newValue)};pc.nd=function(){(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",
!1)||pc.Vm)&&pc.set_visible(!1)};pc.yyf=function(){pc.pGa=null;pc.p8=null};pc.ii=function(){pc.Vm&&pc.w1a()};pc.onFunctionInfoLoaded=function(){pc.lob()};pc.wya=function(){pc.qka?(pc.p8=null,pc.pGa=null,pc.lob()):pc.nh.Ek&&pc.Gse()};pc.uca=function(){pc.AQ&&Ba(pc.$,pc.AQ.HelpId,pc.AQ.IsDynamicUdf);return!0};pc.w1a=function(){pc.rba&&pc.Ytd();pc.lN&&pc.Ya.isEditing&&pc.kda();pc.Oq=null;pc.formulaAssistanceUIControl&&(pc.formulaAssistanceUIControl.dismiss(pc.domElement),pc.Dka&&(pc.kr.canReceiveFocus=
!1));pc.Xmd=!1};pc.pDf=function(){pc.lN&&pc.kda();pc.K4f();1===pc.CXf.type&&ye.EwaSettings.Ehc()&&!pc.Ya.text.includes("\n")&&pc.JEd(pc.CXf)};pc.onDismiss=function(){pc.isListVisible=!1;Ne.g(pc.$).yj.textBox.focus()};pc.oRa=function(){var vd={};pc.Kf.Qhc?vd[Ca.a.rZ]="SmartSuggestionsCard":vd[Ca.a.rZ]="FunctionAndSmartSuggestionsCard";pc.$.xe(802602464,0,8,vd)};pc.Qzd=function(vd,ne){pc.Kf.zeg(ne);pc.rba&&(pc.rIa=!0)};pc.Pzd=function(vd){pc.rba&&(pc.oIa=!0);pc.lN?(pc.kBe(),Ne.g(pc.$).yj.endEdit(!0,
"FormulaAssistanceControl.OnCompletionItemClicked",0)):vd.textEdit?pc.l0a(vd.textEdit):pc.My(!0)};pc.gridView=Ne.g(d);pc.functionInfoManager=w;pc.domElement.className=vh.a.iNe;pc.nh=$a.M3c(d,I);pc.F5b=new ec(d);pc.qxg=I;pc.formulaAssistanceUIControl=Tb;pc.pluginScheduler=Ic;ra.instance.$=d;pc.Vm=yg.a.iN(d);ca.Hkd||(ca.Hkd=ca.TJa());pc.domElement.innerHTML=ca.Hkd;pc.Oyd=RegExp("\\d+");zf.d(pc.style,pc.$.isChromeRtl);pc.mja=new eb(pc.$,pc.domElement,pc.functionInfoManager,pc.formulaAssistanceUIControl,
pc.pluginScheduler);w=$get(gb.Icd,pc.domElement);I=$get(gb.Dcd,pc.domElement);$a=$get(gb.Kcd,pc.domElement);pc.ipg=new Ja(pc.$,w,$a,I,pc);pc.nh.RYb(pc.wya);pc.functionInfoManager.snb(pc.onFunctionInfoLoaded);pc.functionInfoManager.eFg(pc.yyf);pc.Vm&&(pc.$.xa.Qf(pc.ii),pc.Kf.Hoe(pc.pDf));pc.NSa(!0);pc.V7f(!0);pc.$.domElement.appendChild(pc.domElement);pc.sQc=0;(I=Bk.a(d))&&Array.add(pc.HJa,new ob(d,I,pc));Array.add(pc.HJa,new ob(d,pc.gridView.yc,pc));pc.Ztb=pc.HJa[0];pc.Fpb=pc.HJa[pc.HJa.length-1];
d.da.Ha(221,pc);pc.calcManager=ha;pc.instantaneousSupportInformationManager=wa;pc.instantaneousSupportInformationManager||pc.$.da.Za(268,function(vd){pc.instantaneousSupportInformationManager=vd});pc.TSe=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);pc.OAa=yg.a.Cod();pc.fyc=yg.a.Wqd();pc.pyd=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");pc.Qnd=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6018145_AutoCompleteDismissFocus");
yg.a.a_()&&pc.emd();yg.a.oN(pc.$)&&w.classList.add("ewa-fb-refactor");pc.Vm?Ne.g(pc.$).ha.OG(pc.nd):Ne.g(pc.$).ha.J2(pc.nd);pc.Dka=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");pc.Dka&&(pc.kr=new ub(pc.$,pc.formulaAssistanceUIControl,1,ki.a.mcd,pc.Gid));pc.oMa=pc.Vm&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");pc.nMa=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout");return pc}function ja(){}
function ea(){this.caretPosition=this.content=null}function qa(){this.rowIndex=this.colIndex=0;this.builtIn=this.formatString=this.docName=this.docPath=this.sheetIndex=null}function pa(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function Pa(){this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function Ha(){this.y9=this._name=null}function Xa(){this._name=null}function Na(){this._name=null}function db(){this.y9=this._name=null}function Ja(d,
w,I,ha,wa){w=Rb.call(this,d,w)||this;w.ora=null;w.Uuc=0;w.pLb=0;w.k2c=null;w.uWe=I;w.eub=ha;w.formulaAssistanceControl=wa;w.cs=[];w.DW=[];w.Vm=yg.a.iN(d);w.fgf=w.Vm&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");return w}function jb(){this.textEdit=this.label=null;this.kind=0;this.shouldRequestAutocompleteOnCommit=this.data=this.isPrefixed=this.detail=this.type=null}function hc(d,w){this.$=d;this.items=w}function ma(d,w){this.A1i=d;this.qsf=w}function Ka(){}function Ta(d){this.index=
d}function ob(d,w,I){var ha=Kk.call(this,d,w)||this;ha.LFf=!1;ha.eSa=null;ha.old=0;ha.OFc=null;ha.VHa=null;ha.BQ=0;ha.formulaAssistanceControl=I;ha.xob=w.textBox;ha.Q5a=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache");ha.Vm=yg.a.iN(d);ha.Haj=ye.EwaSettings.KH();return ha}function Cb(){this.Zha=this.Qsa=this.Rsa=!1;this.YFf=40;this.fAe=41;this.V_a=this.DCd=this.ECd=this.VEb=0;this.Lwf=!0;this.iBd=!1;this.IUe=this.aNd=-1}function eb(d,w,I,ha,wa){var $a=
ok.call(this,eb.TJa(yg.a.iN(d)))||this;$a.H1a=null;$a.O2=0;$a.kr=null;$a.VWc=!1;$a.Oq=null;$a.nla=null;$a.aSa=!0;$a.lR=!1;$a.onCardModeChange=function(Tb){$a.qNb(Tb);1===Tb?ra.instance.Iaa.argumentAssistanceCollapseCounter++:ra.instance.Iaa.argumentAssistanceExpandCounter++};$a.oRa=function(Tb){var Ic={};Ic[Ca.a.rZ]="ArgumentAssistanceCard";var pc={};pc.FunctionName=Tb.functionName;Ic[Ca.a.lad]=pc;$a.$.xe(802602464,0,8,Ic)};$a.onDismissClick=function(){ra.instance.Iaa.argumentAssistanceDismissCounter++;
$a.aSa=!1;$a.Wrb();$a.lR&&$a.cH.clear();ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&0===$a.O2&&$a.qNb(1)};$a.Kg=function(){$a.aSa=!0;$a.lR&&$a.cH.clear()};$a.KLi=function(Tb){Tb.button===Sys.UI.MouseButton.leftButton&&Tb.target&&(jh.g(Tb),$a.H1a&&$a.H1a.Zna(Tb))};$a.it=function(){void 0!==$a.Oq&&null!==$a.Oq&&$a.Oq()};$a.$=d;$a.xj=w;$a.functionInfoManager=I;$a.formulaAssistanceUIControl=ha;$a.pluginScheduler=wa;$a.Vm=yg.a.iN(d);
$a.qba=$a.Vm&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);$a.Vm?($a.NOd(),$a.kr=new ub($a.$,$a.formulaAssistanceUIControl,0,ki.a.icd),$a.qba&&Ne.g($a.$).pc.Mo($a.Kg),$a.lR=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!$a.formulaAssistanceUIControl,$a.lR&&($a.cH=new ya($a.formulaAssistanceUIControl))):($a.H1a=new vb($a.domElement,
$a.$.Qy,void 0,yg.a.oN($a.$)),$a.wc.ja("mousedown",$a.KLi),d=$get(gb.Icd,$a.xj),$a.xj.insertBefore($a.domElement,d));Ne.g($a.$).view.Ms($a.it);return $a}function ya(d){this.hn=!1;var w={};this.usageCount=(w[Mj.Drag]=0,w[Mj.Move]=0,w);this.l$b=d;this.TCc=this.l$b.getWindowEdgeBuffer()+1;this.lrf=new Ga(this);this.ZJe=new za(this)}function za(d){this.cH=d;this.hn=!1}function Ga(d){var w=this;this.cH=d;this.PZ=this.LQd=this.hn=!1;this.onKeyDown=function(I){if(!w.PZ&&I.keyCode===Td.a.Noa&&I.altKey&&I.ctrlKey)return w.P7b(),
I.stopPropagation(),I.preventDefault(),!0};this.aNa=function(I){if(!w.PZ)return!1;if(I.eventName===sg.a.Sb){var ha=I.Ea.ctrlKey?1:I.Ea.shiftKey?50:10;switch(I.Ea.keyCode){case Td.a.ZTa:w.Z5(0,-ha);break;case Td.a.Loa:w.Z5(0,ha);break;case Td.a.Moa:w.Z5(-ha,0);break;case Td.a.ofb:w.Z5(ha,0);break;case Td.a.LL:case Td.a.$h:w.LQd=!0;break;default:return!1}}I.eventName===sg.a.Wd&&w.LQd&&w.k4(!0);I.Ea.preventDefault();return!0};this.pFb=function(I){if(!w.PZ)return!1;I.Ea.preventDefault();w.k4();return!0};
this.onBlur=function(){if(!w.PZ)return!1;w.k4();return!0};this.qr=di.KeyInputManager.instance;this.pointerInputManager=Qj.a.instance}function cb(){this.content=null;this.caretPosition=0}function Mb(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}function Dc(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function vb(d,w,I,ha){ha=void 0===ha?!1:ha;w=sj.call(this,d,w,!1,void 0===I?null:I)||this;w.LRa(ha);w.kj=k.a.equals("rtl",d.dir,!0);return w}function ib(d,
w){var I=nj.call(this)||this;I.opg=[];I.Mcd={};I.xWe={};I.kT=null;I.O8=[];I.PJa={};I.Nyf=function(ha,wa){Fd.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");I.zyf(ha,!!wa&&1!==wa.FilterType,!0)};I.Myf=function(){Fd.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");I.kT=null};I.wyf=function(ha){Fd.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");
I.xHd(ha.sja,!0,!1)};I.Lyf=function(ha){Fd.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");I.zyf(ha,!0,!1)};I.TKc=!1;I.RKc=!1;I.vb=d;I.pluginScheduler=w;I.$.da.Ha(19,I);return I}function ub(d,w,I,ha,wa){this.RZc=!1;this.$=d;this.formulaAssistanceUIControl=w;this.VVe=I;this.Ymj=ha;this.N6e=void 0===wa?null:wa}function Eb(d,w,I){var ha=Wk.call(this)||this;ha.Jcd=d;ha.pNd=w;ha.IXi=I;return ha}function Ya(d){var w=Pk.call(this)||this;w.pNd=d;return w}function tb(d,
w){var I=Tj.call(this)||this;I.functionName=d;I.Jcd=w;return I}function ec(d){this.uHe={};this.$=d}function Za(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}function mb(){this.oT=0;this.e9d=!1;this.VVa=this.C$d=null;this.j$d=!1;this.textEdit=null}function sc(d){var w=this;this.prb=this.Hha=this.calcManager=this.Ya=null;this.s9a=function(){w.c5a(!1,!1)};this.$=d;this.Ytb=new $b(d);this.j$b=new lc(d);this.k$b=new pd(this);Ne.g(d).yc.Mo(this.s9a);this.$.da.Ha(317,this)}function pd(d){this.P7=
0;this.kcd=d}function $b(d){this.xqa=this.PSa=this.f2a=this.rQ=this.H$=this.Ya=null;this.xjd=!1;this.Oc=d}function Xb(){}function lc(d){var w=this;this.Lzi=30;this.calcManager=null;this.Md=!1;this.aPa=this.fFb=this.B$a=null;this.$C=function(){w.Jha.SZ()};this.$=d;this.Jha=new pb;this.pTf=-1;this.$.ea.LG(this.$C)}function Oa(d,w,I,ha,wa,$a,Tb){Tb=d.Na(1,void 0===Tb?null:Tb);Tb.getPartialCalcResultsParameters=w;return jg.i(d,"GetPartialCalcResults",Tb,I,ha,wa,$a,4)}function pb(){this.MQa={}}function Ub(d){var w=
Ui.call(this)||this;w.$=d;w.dc();return w}function ic(d,w){var I=this;this.OJa=this.Oua=this.nja=null;this.gCf=function(ha,wa){I.J6i(wa.functionName,wa.Jcd)};this.iCf=function(ha,wa){I.I6i(wa.Jcd,wa.pNd,wa.IXi)};this.hCf=function(ha,wa){ha=[];wa=yl(wa.pNd);for(var $a=wa.next();!$a.done;$a=wa.next())$a=$a.value,(!I.P5a||void 0!==$a&&null!==$a)&&($a=$a.trim())&&Array.add(ha,$a);if(!I.P5a||ha.length){wa="";for($a=0;$a<ha.length;$a++){var Tb=I.XYc(ha[$a]),Ic=ic.$Dd($a,ha.length);wa+=Tb+Ic;Ic&&(wa+=I.ariaLiveNotifier.Lxa)}I.ariaLiveNotifier.readText(wa)}};
this.jCf=function(ha,wa){I.ariaLiveNotifier.L6i(wa.xI,wa.description,wa.selectedIndex.toString(),wa.length.toString(),I.nMa)};this.cCf=function(ha,wa){I.ariaLiveNotifier.dNf(wa.description,wa.length)};this.syf=function(){I.ariaLiveNotifier.wab(te.a.instance.fa(865),Ca.a.uZa)};this.lyf=function(){I.ariaLiveNotifier.readText(te.a.instance.fa(866))};this.oyf=function(){I.ariaLiveNotifier.readText(te.a.instance.fa(867))};this.$=w;this.ariaLiveNotifier=d;this.$.da.Ha(219,this);this.P5a=yg.a.iN(w);this.oMa=
yg.a.iN(w)&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");this.nMa=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout")}function Jb(d){return ci.call(this,d)||this}function cc(d,w,I){var ha=this;this.EGh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=function(){ha.menuId&&Array.contains(ha.EGh,
ha.menuId)&&ha.frame.Pw(ha.menuId)};this.$=d;this.functionInfoManager=I;this.Sa=w;if(this.mF=yg.a.mF(this.$))this.formulaAssistanceManager=this.$.da.Aa(464);this.wM={};this.frame=this.$.frame;this.functionInfoManager.snb(this.onFunctionInfoLoaded)}function Ob(d,w){var I=Zg.call(this,d,te.a.instance.fa(1003),void 0,void 0,void 0,ye.EwaSettings.la(407))||this;I.NJa=null;I.rja=null;I.MJa=null;I.gub=null;I.rWe=null;I.qja=null;I.sWe=null;I.vWe=null;I.nmf=null;I.fub=null;I.Hjd=!1;I.q1b=null;I.a6=null;I.Swb=
null;I.onFunctionInfoLoaded=function(){if(!I.MJa.count){for(var ha=I.functionInfoManager.mWe,wa=0,$a=ha.length;wa<$a;++wa)I.MJa.oM(ha[wa],ha[wa],!1).className=wd.a.Aoh;I.MJa.selectedIndex=0;eg.a.rc([I.q1b,I.a6,I.Swb]);I.q1b=I.Pd.Dd(I.NJa);I.a6=I.Pd.Dd(I.rja);I.Swb=I.Pd.Dd(I.fub);I.q1b.ja("change",I.xyf);I.a6.ja("change",I.LLi);I.a6.ja("dblclick",I.MLi);I.Swb.ja("click",I.uca);I.Swb.ja("keyup",I.ONi);Rc.DOMElementExtensions.setVisible(I.rja,!0);Rc.DOMElementExtensions.setVisible(I.rWe,!1);I.$.C5c&&
Rc.DOMElementExtensions.setVisible(I.nmf,!0)}I.xyf(null);I.getButton(0).get_element().disabled=!1;I.NJa.disabled=!1;I.JJb();I.Hjd=!0};I.uca=function(){I.P$&&Ba(I.$,I.P$.HelpId,I.P$.IsDynamicUdf)};I.ONi=function(ha){13!==ha.keyCode&&32!==ha.keyCode||I.uca(ha)};I.xyf=function(){var ha=I.functionInfoManager.G_e(I.MJa.qe.value);I.Vua(ha);I.rja.scrollTop=0;I.wZf()};I.LLi=function(){I.wZf()};I.MLi=function(ha){I.P$&&(jh.g(ha),I.close(0))};I.$c=function(ha,wa){Kd.b(wa)&&I.Du()};I.functionInfoManager=d.da.Aa(19);
I.formulaAssistanceControl=d.da.Aa(221);I.lcd=yg.a.mF(I.$);I.lcd&&(I.formulaAssistanceManager=d.da.Aa(464));I.KIa=w;I.v_c=w.textBox.caretPosition;return I}function P(d){var w=xe.a.ica,I=d.da.Aa(368);I&&!Ne.g(d).Dj&&(w=I.zoom);return w}function Ba(d,w,I){if(d)if(ra.instance.Iaa.argumentAssistanceLearnMoreCounter++,I){if(w&&(!w||w.startsWith("http://")||w.startsWith("https://"))){if(d.la(157)&&(d=d.da.Aa(269))&&d.xBa(w))return;qb.HelperMethods.vf(w,"_blank",lg.a)}}else{I=new eh.a(-859308420,Kf.a.$b,
d.gd,0,null);var ha={};w=(ha[Kf.a.ld]=Ca.a.MZ,ha[Kf.a.Ug]="HelpID="+w,ha);d.Ka.Xb(I,w)}}function ra(){var d=this;this.Iaa=new Sb;this.KJa=new zb;this.R2=new kc;this.Dob=new lb;this.vb=null;this.rvc=new Va;this.od=function(){d.nuj();d.vb.sendBeaconTraceTag(88392384,50,!1,"{0}",d.getJsonForLogging())};this.C$a=new We.a}function ta(d){var w=this;this.Sqf=d;this.U_=new bb;this.e7b=[];this.Pkc=-1;(this.Rqf=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&d&&(this.U_.countAboveThresholds=
{},d.forEach(function(I){return w.U_.countAboveThresholds[I]=0}))}function Ia(){this.P95=this.P75=this.median=this.max=this.average=0}function bb(){this.firstAction=this.failedCount=this.count=0;this.excludingFirstAction=this.includingFirstAction=null}function Va(){this.smartFormulaBarAutoCompleteFlight=this.autoCompleteUIFlight=this.argumentAssistanceFlight=null}function lb(){this.formulaAssistanceRequestOptimizedCounter=this.formulaAssistanceRequestAttemptedCounter=0}function kc(){this.commitByMouseClickCounter=
this.commitByEnterKeyCounter=this.commitByTabKeyCounter=this.selectByMouseHoverCounter=this.selectByArrowKeyCounter=0}function zb(){this.smartSuggestionCommittedCounter=this.smartSuggestionSelectedCounter=this.smartSuggestionShownCounter=0}function Sb(){this.argumentAssistanceCardInitialMode=null;this.argumentAssistanceMoveTotalCounter=this.argumentAssistanceMoveCounter=this.argumentAssistanceDragTotalCounter=this.argumentAssistanceDragCounter=this.argumentAssistanceDismissCounter=this.argumentAssistanceLearnMoreCounter=
this.argumentAssistanceExpandCounter=this.argumentAssistanceCollapseCounter=0}function gb(){}function Sa(d){var w=Pc.call(this)||this;w.$=d;w.dc();return w}function Kb(d){var w=Nc.call(this,document.createElement("div"))||this;w.BR=!1;w.dR=!1;w.F0b=!1;w.Jh=null;w.Vh=null;w.zhi=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationConditionalHideAll",!1);w.Ahi=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationConstButtonWidth",!1);w.ski=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5862418_LogDataValidationButtonWidth");
w.vpi=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.VisibilityOptimizationOnTaggedElements",!1);w.hpd=!1;w.$pd=!1;w.hnd=!1;w.r5b=[];w.Mh=function(){w.S3f(!1)};w.NOa=function(ha,wa){w.show(w.qR,!w.isListVisible,!0,Ci.a.Xp||3===wa.yb||3===Kf.a.$b);w.Vzd(null,null)};w.Vzd=function(){w.gridView.setFocus()};w.uLa=function(){w.Ya.textBox.pK=!0};w.it=function(){w.eeg()};w.onContentReady=function(){w.S3f(w.isListVisible)};w.od=function(){w.Mx()};w.Jya=function(){w.xRa()};w.uxf=function(){w.eeg()};
w.$=d;w.gridView=Ne.g(w.$);w.eJ=w.gridView.yc;var I="<div id='dv_reader_description' class='"+Dk.a.wOe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+Yb.Ooh+" "+N.a.Xo+"'></div>\r\n<div id='dv_list_box' class='"+Yb.Vnh+" "+N.a.Tk+" "+N.a.Xo+"'></div>\r\n<div id='dv_prompt_box' class='"+Yb.Moh+" "+N.a.Xo+"'></div>";w.domElement.className=Yb.Noh;w.domElement.innerHTML=I;zf.d(w.style,w.isGridRtl);w.gg=$get("dv_list_box",w.domElement);w.GW=$get("dv_prompt_box",w.domElement);
w.Eha=$get("dv_list_button",w.domElement);w.Z7a=$get("dv_reader_description",w.domElement);w.vpi&&(w.domElement.setAttribute(xa.a.IZa,"true"),w.gg.setAttribute(xa.a.IZa,"true"),w.GW.setAttribute(xa.a.IZa,"true"),w.Eha.setAttribute(xa.a.IZa,"true"),w.Z7a.setAttribute(xa.a.IZa,"true"));(I=Bk.a(d))&&Array.add(w.r5b,new Lb(d,I,w));Array.add(w.r5b,new Lb(d,w.gridView.yc,w));w.gridView.ha.JG(w.Mh);w.gridView.ar(w.onContentReady);w.gridView.pc.MEg(w.uxf);w.$.vl(w.od);I=w.gridView.xj;I.insertBefore(w.domElement,
I.firstChild);w.onContentReady(null,null);d.da.Ha(14,w);return w}function Gc(d,w,I,ha,wa,$a,Tb,Ic,pc,vd){var ne=Z.call(this,document.createElement("a"))||this;ne.tl=!1;ne.Zc=function(Pe){ne.raiseEvent("ClickButton",Pe);return!0};ne.onKeyDown=function(Pe){ne.raiseEvent("KeyDown",Pe);return!1};ne.xw=function(){ne.hovered=!0;ne.raiseEvent("PointerOver");return!1};ne.YN=function(){ne.hovered=!1;ne.raiseEvent("PointerOut");return!1};ne.onBlur=function(Pe){jh.g(Pe);ne.focused=!1;ne.raiseEvent("Blur")};
ne.onFocus=function(Pe){jh.g(Pe);ne.focused=!0;ne.raiseEvent("Focus")};ne.Xkh=Ic;ne.Hfh=pc;ne.kJ=Gc.Bb(ne.domElement,w,I,ha,wa,$a,Tb,vd);ne.wc.ja("contextmenu",function(Pe){jh.g(Pe)});ne.enable();ne.hovered=!1;ne.focused=!1;d.appendChild(ne.domElement);return ne}function Hb(d,w,I){d=Yi.call(this,d,w,new dl.a(Yb.listItem,Yb.YAb,Yb.aBb,Yb.bBb))||this;d.wlb=null;d.qe=null;d.Hda=null;d.dW=null;d.$Ha=null;d.Exa=0;d.KEb=[];d.udg=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateDvListHeightUsingItemHeight",
!1);d.Xui=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5858877_logDvListBoxHeight");d.Z7a=I;return d}function Lb(d,w,I){d=Fk.call(this,d,w)||this;d.dataValidationControl=I;return d}function sa(d,w,I){var ha=gk.call(this,d)||this;ha.W$=null;ha.aV=null;ha.phf=!1;ha.errorMessage=null;ha.c9e=null;ha.xm=null;ha.jea=null;ha.BGe=function(wa){var $a=ha.$,Tb=ha.phf;ha.hide();var Ic=Ne.g($a);Ic.isEditing&&Ic.yc.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===wa&&Tb&&Od.TaskExtensions.Ba(Ic.startEdit(!1,
1),function(){var vd=Ic.yc.textBox;vd.text&&vd.selectRange(0,vd.text.length)},ha.ma,11,Xe.a.current);if(1===wa&&!Tb){if(Tb=Ic.uc(null)){Ic.Ca.NV();var pc=Object.assign(new gc.a,{Text:ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5785565_FixDataValidationErrorDialogHandlerBug")?Tb.cell.userInput:Tb.originalText});Ic.setCell(pc,Tb.range,0,63,null)}$a.xe(-798660877,Kf.a.$b,8,null)}2===wa&&Od.TaskExtensions.Ba(Ic.startEdit(!1,0),function(){var vd=Ic.yc.textBox;vd.text&&vd.selectRange(0,vd.text.length)},
ha.ma,11,Xe.a.current)};ha.u9a=function(){qb.HelperMethods.Bca(ha.$.RI,ha.error.HelpTopicId,ha.$.AX)};ha.GNi=function(){ha.cxb();ha.$.xe(802602464,2,8,ha.aV)};ha.cMi=function(){Fd.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};ha.dMi=function(wa){!wa||xh.a(wa)?Fd.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):
(wa=ha.eYh(wa.Result),ha.W$.errorInformation=wa,ha.pBc(ha.VIa,ha.Ogd(ha.BGe),ha.W$))};ha.kAd=function(){ha.show(ha.qRb)};ha.NMe=I;ha.sqmManager=cl.a(ha.$);ha.error=sa.YQ(w,d,I);ha.Ab.Mp=ha;d=d.da.Aa(14);ha.Hu=d.A3a(ha.NMe);ha.VIa=ha.Hu&&ha.Hu.VIa?ha.Hu.VIa:te.a.instance.fa(1687);ha.Tqj();ha.initializeAndShow(ha.VIa,ha.BGe,ha.W$);return ha}function Ua(d,w,I){var ha=nk.call(this,d,Ua.YQ(w,d,I))||this;ha.nd=function(){ha.setFocus()};Ne.g(ha.$).ha.OG(ha.nd);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5780477_datavalidationListRule")&&
(d=d.da.Aa(14).A3a(I))&&d.options&1&&Fd.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");return ha}function Yb(){}function jc(d){var w=xi.call(this)||this;w.$=d;w.dc();return w}function md(d,w){var I=this;this.FZa=null;this.dCf=function(ha,wa){1<wa.length&&(ha=te.a.instance.fa(840),I.ariaLiveNotifier.dNf(ha,wa.length))};this.eCf=function(ha,wa){Fd.ULS.shipAssertTag(537167961,0,0<=wa.selectedIndex&&
0<=wa.length&&wa.selectedIndex<wa.length,"Invalid ListEventArgs: SelectedIndex/Length");Fd.ULS.shipAssertTag(537167960,0,!!wa.xI,"ListEventArgs: SelectedValue should not be null");I.ariaLiveNotifier.K6i(wa.xI,wa.selectedIndex+1,wa.length)};this.fCf=function(ha,wa){I.ariaLiveNotifier.YPa(wa.xI)};this.ariaLiveNotifier=d;w.Ha(213,this)}function jd(d){var w=tk.call(this)||this;w.$=d;w.dc();return w}function Zc(d){var w=Jk.call(this)||this;w.$=d;w.dc();return w}function Qb(d,w){var I=this;this.lNa=1;this.Mga=
[];this.active=!1;this.yw=function(){var ha=I.gridView.Jhd();if(!(0>=ha||ha===I.lNa||I.gridView.Qq)){for(var wa=!1,$a=[],Tb=[],Ic=I.Mga.length-1;0<=Ic;Ic--){var pc=I.Mga[Ic];if(I.Ihd(pc)>ha||pc.bottom<ha)Array.add($a,pc),Array.removeAt(I.Mga,Ic),wa=!0}for(Ic=I.tableManager.rangeList.length-1;0<=Ic;Ic--){pc=I.tableManager.rangeList[Ic];var vd=I.Ihd(pc);vd<=ha&&pc.bottom>=ha&&!(vd<=I.lNa&&pc.bottom>=I.lNa)&&pc.Xva&&(Array.add(Tb,pc),wa=!0)}if(wa)for(pc=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",
!1)?I.gridView.epc:[I.gridView.k3],Ic=yl(pc),pc=Ic.next();!pc.done;pc=Ic.next())for(vd=yl(pc.value),pc=vd.next();!pc.done;pc=vd.next()){var ne=yl(pc.value);for(pc=ne.next();!pc.done;pc=ne.next()){for(var Pe=pc.value,Af=Pe.Fn,Wf=Wj.a(Pe.T4),Of=$a.length-1;0<=Of;Of--)pc=$a[Of],I.aAc(pc,!1,Wf,Af)&&Array.removeAt($a,Of);for(Of=Tb.length-1;0<=Of;Of--)pc=Tb[Of],I.aAc(pc,!0,Wf,Af)&&Array.add(I.Mga,pc);wa&&Pe.LOd(Wf)}}else Fd.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");
I.lNa=ha}};this.nzf=function(ha,wa){wa.isRow||wa.JVc(I.aLa)};this.ozf=function(ha,wa){wa.isRow||(I.tableManager.rangeList.length||I.deactivate(),wa.SJd(I.aLa))};this.aLa=function(ha,wa){if(I.te())I.activate();else if(ha=I.active,I.deactivate(),!ha){Fd.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(wa=wa.jw)&&I.S5f(wa.Fn[0],wa.Fn[wa.Fn.length-1],wa.T4,wa.Fn)};this.YBf=function(ha,wa){!I.gridView.Qq&&(I.te()?I.activate():
(ha=I.active,I.deactivate(),ha||Fd.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),wa=wa.jw)&&(ha=Wj.a(wa.T4),I.S5f(wa.Fn[0],wa.Fn[wa.Fn.length-1],ha,wa.Fn)&&wa.LOd(ha))};this.Qe=function(){I.gridView.$a.P4?I.deactivate():I.activate()};this.tableManager=d;this.gridView=w;this.$=w.$;d.yoe(this.YBf);w.kFg(this.nzf);w.lFg(this.ozf);this.$.xa.Qf(this.Qe);this.$.zb.Qf(this.Qe);this.Vre(function(ha){ha.JVc(I.aLa)});this.te()&&(this.activate(),
this.yw(this,null));this.$.da.Ha(68,this)}function fd(d){return Uk.call(this,d)||this}function xd(d,w,I,ha,wa,$a){var Tb=this;this.vA=null;this.o_a=1461300262;this.cx=this.k_a=this.D8a=this.i$b=null;this.oOi=function(Ic,pc){if(!xh.a(Ic)&&pc){var vd=!!Ic&&!!Ic.RequestTelemetryData;Ne.g(Tb.$).Mi.Bla(pc,Ic.StateId,vd?Ic.RequestTelemetryData.EcsOperationDuration:0,vd?Ic.RequestTelemetryData.EcsRequestDuration:0,vd?Ic.RequestTelemetryData.WfeRequestDuration:0)}};this.Zpb=function(){if(Tb.gridView.j6a){var Ic=
Tb.$.da.Aa(254,!0);Ic&&Ic.tdj(Tb.Zpb);Tb.gridView.j6a=!1;Tb.gridView.Hh.hu(Ca.a.Zaa);Tb.gridView.ha.m0(Tb.hcd);Ne.g(Tb.$).$.If()}};this.hcd=function(){var Ic=Tb.i$b;Tb.i$b=ef.d(Tb.$.xa.pa);if(Ic===Tb.i$b)if(Tb.gridView.ha.m0(Tb.hcd),(Ic=Tb.$.da.Aa(254,!0))&&Ic.QZc(36,Ne.g(Tb.$).ha.va.selectedRanges)){Ic=new eh.a(1804571062,2,2,0,null);var pc={};Tb.$.Ka.Xb(Ic,(pc[Ca.a.skipClipboardAccess]=!0,pc[Ca.a.w0c]=!0,pc[Ca.a.isFormatPainter]=!0,pc)).continueWith(function(){Tb.Zpb()})}else Tb.gridView.Hh.XG(!1)};
this.$=d;this.gridView=w;this.Gh=I;this.pB=ha;this.borderFormatManager=wa;this.moreColorsHelper=$a;this.Sbd=new bc(this.$);this.Dg=ye.EwaSettings.Dg();this.Ykc=new Ad(this.$,I);this.RC=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);this.ln=ye.EwaSettings.ln()}function Ad(d,w){this.$=d;this.Gh=w;this.gE=new ie(Ne.g(this.$).Ca,this.$);this.Tgf=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.oyb=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");
this.mpd=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.Kgc=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand");this.Yef=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6013788_MergeCellHighGetRangeNumbersTelemetry");this.qhi=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6100978_MergeCellCSEIsCsePossibleForWrapTextWrongValueForUnmergeCommandFix")}function Me(){this.scenario=0;this.Baa=null}function Ue(){this.SQa=
this.wGa=this.tNa=this.mTa=0}function Jd(d,w,I,ha){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=d;this.targetSheetRange=w;this.fillRangeType=I;this.fillRangeDirection=ha}function Sd(d,w,I){var ha=gj.call(this,d)||this;ha.io=null;ha.L6c=0;ha.$ci=function(wa,$a){if(0===wa)Fd.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel");else{wa={};var Tb="",Ic=1035996630;switch($a.selectedKey){case 0:Tb=
1896159024===ha.qp?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:Tb=1896159024===ha.qp?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===ha.qp?(Tb="InsertRows",Ic=-1113896058):(Tb="DeleteRows",Ic=1554436520);break;case 3:1896159024===ha.qp?(Tb="InsertColumns",Ic=1415868706):(Tb="DeleteColumns",Ic=674605324)}Fd.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",Tb);$a=new eh.a(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5933270_RespectProtectionSettingsInInsertDeleteDialog")?
Ic:1035996630,1,2,8,null);wa[Kf.a.ld]=Tb;ha.$.Ka.Xb($a,wa)}};ha.qp=w;ha.selectedRanges=I;d=Object(qc.a)($f.a,ha.$.xa.pa);ha.isRtl=d.displayRtl;return ha}function se(d,w,I,ha,wa,$a){var Tb=this;this.k0d=!1;this.l0d=null;this.wDc=0;this.jj=null;this._state=0;this.moveNext=function(){try{for(Tb._state=1;1===Tb._state;)Tb.wu=Tb.wu()}catch(Ic){Tb.dispose(),Tb._state=3}};this.Bf=d;this.eCa=w;this.dCa=this.Z_d=wa;this.KOb=$a;this.wu=this.TL;this.moveNext()}function oe(d,w,I,ha,wa,$a,Tb,Ic){var pc=this;this.tDc=
0;this.n0d=this.xDc=!1;this.jj=this.p0d=null;this._state=0;this.moveNext=function(){try{for(pc._state=1;1===pc._state;)pc.wu=pc.wu()}catch(vd){pc.dispose(),pc._state=3}};this.Bf=d;this.eCa=w;this.Lhg=wa;this.dCa=this.Z_d=$a;this.KOb=Tb;this.Y_d=Ic;this.wu=this.TL;this.moveNext()}function Ke(d,w,I,ha,wa){this.CVe=0;this.gpg=d;this.hpg=w;this.bxg=I;this.lWb=ha;this.CVe=void 0===wa?0:wa}function bc(d){var w=this;this.vBi="+mn-lt";this.ryi="+mj-lt";this.$qf="MinorThemeFont";this.vpf="MajorThemeFont";
this.XQi=function(I){w.Hgf=!0;w.yTg=null;w.$.$E(function(ha){ha.BPa("FontName_New")});Fd.ULS.sendTraceTag(537159511,1,15,String.format("PreviewFont Status is {0}",I))};this.$=d;this.jgi=!!String.fromCodePoint&&!Ci.a.Af&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Hgf=!1;this.yTg=null;this.ln=ye.EwaSettings.ln()}function qd(d){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=d}function zc(d){var w=lk.call(this)||this;w.$=d;
w.dc();return w}function ld(d){return Ii.call(this,d)||this}function rb(d,w){var I=this;this.q$b=this.IFd=null;this.tyf=function(){ye.EwaSettings.la(689)||I.Btc();if(I.q$b){var ha=Oj.a(sh.a.Ra.he,I.q$b);Fd.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",ha);I.q$b=null}I.bGf()};this.$=d;this.gridView=Ne.g(d);this.wF=w.H0a(this.$.domElement,500,null,null);this.QKa=this.PKa=-1}function Wd(d){this.freezeOptions=
null;this.freezeOptions=d}function rc(){}function nd(d){var w=qj.call(this)||this;w.emj="formulaAssistance";w.$=d;w.dc();return w}function me(){this.isFeedbackAllowed=!1;this.zoomLevel=0}function be(d){var w=qi.call(this)||this;w.$=d;w.dc();return w}function sd(d){var w=this;this.gE=this.calcManager=this.Dl=this.qSa=null;this.ELi=function(I,ha){if(I&&!xh.a(I)&&ha){var wa=!!I&&!!I.RequestTelemetryData;Ne.g(w.$).Mi.Bla(ha.toString(),I.StateId,wa?I.RequestTelemetryData.EcsOperationDuration:0,wa?I.RequestTelemetryData.EcsRequestDuration:
0,wa?I.RequestTelemetryData.WfeRequestDuration:0)}};this.$=d;this.$.da.Za(268,function(I){w.Dl=I});this.nFh=new Zd(Ne.g(this.$).Ca,this.$);this.Y2=new ge(this.$,Ne.g(this.$),this);this.$.da.Za(266,function(I){w.calcManager=I});this.Dg=ye.EwaSettings.nod();this.ln=ye.EwaSettings.ln()}function Qe(d,w){this.success=d;this.ZJ=w}function Sf(){this.Zfg=this.$Xj=!1;this.source=0;this.GLa=this.qhc=!1}function mf(d,w,I,ha,wa){I=void 0===I?null:I;ha=void 0===ha?null:ha;wa=void 0===wa?null:wa;Fd.ULS.shipAssertTag(537162128,
0,!!(!!(null!=I^!(void 0===ha||null===ha))^!(void 0===wa||null===wa))&&!(null!=I&&void 0!==ha&&null!==ha&&void 0!==wa&&null!==wa),"NumberFormatHolder: holder must contain either an ifmt or a format string!");null!=I&&0>I&&(Fd.ULS.sendTraceTag(537162127,0,50,"NumberFormatHolder: ifmt is negative, setting it to null..."),I=null);this.Dl=d;this.cq=w;this.fpg=I;this.d9a=ha;this.Mqa=wa}function Zd(d,w){this.gE=null;this.Ca=d;this.w2a=w}function ie(d,w){this.Ca=d;this.w2a=w}function kd(d,w,I){this.success=
d;this.bmc=void 0===w?null:w;this.reason=void 0===I?"":I}function ge(d,w,I){var ha=this;this.$ca=[];this.calcManager=this.Yyc=this.lastSetCellInstantaneousOperation=null;this.$=d;this.grid=w;this.Gh=I;this.Uca=ge.iHe;this.$.da.Za(268,function(wa){ha.Yyc=wa});this.$.da.Za(266,function(wa){ha.calcManager=wa})}function of(d,w,I,ha){this.rangeDelta=d;this.stateId=w;this.isFinished=I;this.priorityGroup=ha}function Ec(d,w,I,ha,wa,$a,Tb,Ic,pc,vd,ne,Pe,Af,Wf,Of,xg,oi,Sh,mj,tj,Cj,pj,fk,Zk,Zi){this.numberOfDependentRecalcedCellsInBatch=
this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=
!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;this.totalNumberOfCellsInBatch=void 0===d?0:d;this.numberOfNonUpdatedCells=void 0===w?0:w;this.numberOfUpdatedCells=void 0===I?0:I;this.numberOfCellsUpdatedAlreadyByServer=void 0===
ha?0:ha;this.numberOfCellsSkippedDueToTimeout=void 0===wa?0:wa;this.numberOfCellsWithNoFormattedCell=void 0===$a?0:$a;this.numberOfUnsupportedErrorCellTypes=void 0===Tb?0:Tb;this.numberOfUnsupportedBlankCellTypes=void 0===Ic?0:Ic;this.numberOfUnsupportedRichCellTypes=void 0===pc?0:pc;this.numberOfSkippedCellsDueToMissingLocaleInfo=void 0===vd?0:vd;this.totalExecutionTime=void 0===ne?0:ne;this.originalProcessingTimeLimit=void 0===Pe?0:Pe;this.newProcessingTimeLimit=void 0===Af?0:Af;this.numberOfEditedRecalcedCellsInBatch=
void 0===Wf?0:Wf;this.numberOfDependentRecalcedCellsInBatch=void 0===Of?0:Of;this.isNewTask=void 0===xg?!1:xg;this.lastSetCellInstantaneousOperation=void 0===oi?"":oi;this.taskId=void 0===Sh?0:Sh;this.isNewNumberFormatter=void 0===mj?null:mj;this.numberOfRecalcedCellsWithFormattedValue=void 0===tj?null:tj;this.numberOfRecalcedCellsWithoutFormattedValue=void 0===Cj?null:Cj;this.totalNumberFormatterTime=void 0===pj?null:pj;this.newNumberFormatterFinalizeFailures=void 0===fk?null:fk;this.numberOfMeasureTextWidthCalls=
void 0===Zk?null:Zk;this.numberOfHashFormattedValues=void 0===Zi?null:Zi}function Cd(){}function Qd(d,w,I,ha,wa){this.qU=void 0===d?0:d;this.cellValue=void 0===w?"":w;this.ifmt=void 0===I?0:I;this.priorityGroup=void 0===ha?"":ha;this.ZJ=void 0===wa?"":wa}function od(d){d=ke(d);if(0===d)return 1;if(1===d)return 2;Fd.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!");return 0}function ke(d){if(d.priorityGroup===Bd.editCell)return 0;if(d.priorityGroup===
Bd.dependentCell)return 1;Fd.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}function Re(d,w){var I=ke(w),ha=!(void 0===w.rangeDelta.data.format||null===w.rangeDelta.data.format);Fd.ULS.shipAssertTag(537162187,0,0===I||!ha,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",w.priorityGroup);d=Math.max(d.cell.Em,0);ha&&(ha=excelOnlineCalc.calc.getCellFormatKind(w.rangeDelta.data.format.format),
"number"===ha?d=w.rangeDelta.data.format.format:"string"===ha?Fd.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===ha?Fd.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):Fd.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return d}function lf(d){var w=d.value;switch(d.type){case 2:return void 0===w||null===w?"":w;case 1:return d=
parseFloat(w),isNaN(d)?null:d;case 3:return d=parseFloat(w),isNaN(d)?null:1===d;case 4:return d=parseFloat(w),isNaN(d)?null:excelOnlineCalc.calc.errorValue(d);default:return excelOnlineCalc.calc.blankValue}}function vc(d){d=excelOnlineCalc.calc.getCellValueKind(d.rangeDelta.data.value);var w=0;switch(d){case "number":w=1;break;case "string":w=2;break;case "boolean":w=3;break;case "Error":w=4;break;case "Blank":w=0;break;default:Fd.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",
d)}return w}function hd(d,w){d=excelOnlineCalc.calc.getCellValueKind(d.rangeDelta.data.value);switch(d){case "number":case "string":case "boolean":return!0;case "Blank":if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;w.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;w.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return w.numberOfUnsupportedRichCellTypes++,
!1;default:return Fd.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",d),!1}}function Ac(d){if(d=d.color){if("String"===Object.getType(d).getName())return Xc.a.Tp(d);if("Number"===Object.getType(d).getName())return null}else return null;Fd.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}function Vd(d){switch(d.alignment){case "Center":return 2;case "Left":return 1;
case "Right":return 3;default:return Fd.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}function Bd(){}function tf(d,w,I,ha,wa,$a,Tb,Ic,pc,vd,ne,Pe,Af){Pe=void 0===Pe?null:Pe;Af=void 0===Af?null:Af;Ic=Gb.call(this,11,0,Ic,ne)||this;Ic.mFh=d;Ic.gcd=w;Ic.format=ha;Ic.activeCell=I;Ic.Qre=wa;Ic.THf=$a;Ic.OHf=Tb;Ic.eFa=pc;Ic.clientCorrelationId=vd;Ic.Slb=Pe;Ic.gib=Af;return Ic}function Wb(){}function wc(d){var w=Bh.call(this)||
this;w.RRb=null;w.$=d;w.dc();return w}function yb(d){var w=yj.call(this)||this;w.DJf=0;w.gH=null;w.d_g=function(I,ha){if(1===I&&w.gH.FileCollectionErrorStateId){I=w.$.na.ta;var wa=w.gH.MessageId,$a=w.gH.OriginalEcsServerId,Tb=w.gH.FileCollectionErrorStateId,Ic=I.Na(0);Ic.errorMessageId=wa;Ic.ecsServerId=$a;Ic.fileCollectionErrorStateId=Tb;Ic.userComment=ha;I.JZc("CollectFile",Ic,null,null,null,null,0)}w.raiseEvent("fileCollectionComplete",null,w)};w.$=d;return w}function mc(d){var w=vj.call(this,
!1,!1,mc.wy)||this;w.pvd=!1;w.fpf=!0;w.wof=0;w.jc=1;w.Fc(1,CommonUIStrings.l_Send);w.Fc(0,CommonUIStrings.l_NoThanks);w.eg=Wc.mjg;w.pof=d;w.Ue=mc.$Sg;return w}function Wc(){}function Nd(d){return jk.call(this,d)||this}function Tc(){}function Yc(d,w,I,ha){var wa=ui.call(this,d)||this;wa.lCb=null;wa.alc=null;wa.Mec=null;wa.r3=null;wa.Fka=!1;wa.disposed=!1;wa.ZMa=!1;wa.gh=null;wa.Uzd=function($a){Fd.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(wa.disposed)Fd.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(xh.a($a)){Fd.ULS.sendTraceTag(537163267,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",$a?hh.a.Tc($a.Errors):null);if($a.Errors&&1===$a.Errors.length){var Tb=$a.Errors[0].MessageId,Ic=wa.led(Tb);if(Ic){wa.Rzj(Tb)?wa.cvj(Ic):wa.nv(Ic);wa.tla("OkInvalidByServer",
$a.Errors[0].MessageIdName);return}}Fd.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",hh.a.Tc($a.Errors))}wa.tla("OkValid","None");wa.hide()}};wa.D5c=function($a){wa.UW($a);2!==$a&&(wa.gh=wa.$.Vb.Hc("UserAction","DataValidationEditTimeToDialogTryClose"));1===$a?wa.L9a():2===$a?wa.tya():wa.Zla()};wa.vca=function(){wa.JRj();wa.ZMa?wa.Aze():wa.x0c();return wa.Fka=!1};wa.selectedRanges=w;wa.pRb=I;wa.command=
ha;3===ha&&(wa.Fka=!0);wa.jc=2;wa.Cv=!1;wa.eg=Sc.eg;return wa}function oc(d,w){this.options=this.cellRange=null;this.cellRange=d;this.options=w}function ze(d,w){var I=ik.call(this,d)||this;I.R9=null;I.wha=null;I.jUa=null;I.T9=null;I.S9=null;I.lnc=function(){I.R9.checked?(I.wha.disabled=!1,I.jUa.disabled=!1,I.T9.disabled=!1,I.S9.disabled=!1):(I.wha.disabled=!0,I.jUa.disabled=!0,I.T9.disabled=!0,I.S9.disabled=!0);return!1};I.get_visible=I.Yja;I.set_visible=I.Hna;I.wk=w;I.ska();return I}function Ae(d,
w){var I=ck.call(this,d)||this;I.jba=null;I.qbf=null;I.lba=null;I.kba=null;I.mnc=function(){I.jba.checked?(I.lba.disabled=!1,I.kba.disabled=!1):(I.lba.disabled=!0,I.kba.disabled=!0);return!1};I.get_visible=I.Yja;I.set_visible=I.Hna;I.wk=w;I.ska();return I}function Ve(){}function nb(d,w,I,ha){var wa=Nj.call(this,d)||this;wa.ztb=null;wa.cNd=null;wa.Fka=!1;wa.disposed=!1;wa.ZMa=!1;wa.gh=null;wa.sWj=function($a,Tb){wa.Dac($a);var Ic=wa.yZd();$a=Ic.errorString;var pc=Ic.xq;if(Ic.returnValue)return wa.L5a(121,
wa.hOh(wa.$,Tb),0,wa.yba,!1),"";wa.tla("OkInvalidByClient",pc);return $a};wa.D5c=function($a){wa.UW($a);wa.gh=wa.$.Vb.Hc("UserAction","DataValidationEditTimeToDialogTryClose");0===$a&&wa.Zla()};wa.selectedRanges=w;wa.pRb=I;wa.command=ha;3===ha&&(wa.Fka=!0);wa.jc=2;wa.Cv=!1;return wa}function Hc(d,w,I,ha,wa,$a,Tb,Ic){Ic=d.Na(9,void 0===Ic?null:Ic);Ic.selectedRanges=w;Ic.ruleOptions=I;return jg.i(d,"CreateOrEditDataValidation",Ic,ha,wa,$a,Tb,0)}function Cc(d,w,I){var ha=Ej.call(this,w)||this;ha.lwa=
null;ha.nec=null;ha.cU=null;ha.WK=null;ha.Rya=null;ha.Sya=null;ha.w5a=null;ha.zNa=null;ha.h$a=null;ha.gPa=null;ha.Moc=null;ha.wCd=null;ha.CDh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];ha.Omj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];ha.knc=function(wa){var $a=!1;(null===wa||void 0===wa?0:wa.Ea)&&(wa.Ea.keyCode===Td.a.Noa||wa.Ea.keyCode===Td.a.$h)&&($a=ha.vca(wa),ha.cU.blur(),
ha.WK.blur());return $a};ha.vca=function(){var wa=ha.cU.selectedIndex,$a=ha.WK.selectedIndex;ha.Moc.innerText=ha.$ub(wa,$a);ha.wCd.innerText=ha.Tgd(wa,$a);switch(wa){case 0:return ha.WK.disabled=!0,Rc.DOMElementExtensions.setVisible(ha.h$a,!1),Rc.DOMElementExtensions.setVisible(ha.gPa,!1),Rc.DOMElementExtensions.setVisible(ha.w5a,!1),Rc.DOMElementExtensions.setVisible(ha.zNa,!1),ha.lwa.disabled=!0,!1;case 3:return ha.WK.disabled=!0,Rc.DOMElementExtensions.setVisible(ha.h$a,!0),Rc.DOMElementExtensions.setVisible(ha.gPa,
!1),Rc.DOMElementExtensions.setVisible(ha.w5a,!0),Rc.DOMElementExtensions.setVisible(ha.zNa,!0),ha.lwa.disabled=!1;case 7:return ha.WK.disabled=!0,Rc.DOMElementExtensions.setVisible(ha.h$a,!0),Rc.DOMElementExtensions.setVisible(ha.gPa,!1),Rc.DOMElementExtensions.setVisible(ha.w5a,!1),Rc.DOMElementExtensions.setVisible(ha.zNa,!1),ha.lwa.disabled=!1;default:ha.lwa.disabled=!1,Rc.DOMElementExtensions.setVisible(ha.h$a,!0),Rc.DOMElementExtensions.setVisible(ha.zNa,!1)}switch($a){case 0:case 1:Rc.DOMElementExtensions.setVisible(ha.gPa,
!0);break;default:Rc.DOMElementExtensions.setVisible(ha.gPa,!1)}ha.WK.disabled=!1;ha.Moc.disabled=!1;Rc.DOMElementExtensions.setVisible(ha.w5a,!1);Rc.DOMElementExtensions.setVisible(ha.zNa,!1);return!1};ha.get_visible=ha.Yja;ha.set_visible=ha.Hna;ha.zR=new W.a;ha.zR.add(te.a.instance.fa(1627));ha.zR.add(te.a.instance.fa(1628));ha.zR.add(te.a.instance.fa(1631));ha.zR.add(te.a.instance.fa(1629));ha.zR.add(te.a.instance.fa(1630));ha.zR.add(te.a.instance.fa(1632));ha.zR.add(te.a.instance.fa(1633));ha.zR.add(te.a.instance.fa(1634));
ha.zR.add(te.a.instance.fa(1635));ha.zR.add(te.a.instance.fa(1636));ha.zR.add(te.a.instance.fa(1637));ha.zR.add(te.a.instance.fa(1638));ha.zR.add("");ha.$=d;ha.wk=I;ha.ska();return ha}function Sc(){}function Uc(d,w){var I=this;this.EB=this.c1a=this.selectedRanges=null;this.tKe=!1;this.gh=null;this.bMi=function(ha){Fd.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!ha||xh.a(ha)?Fd.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):
(I.c1a=ha.Result,I.l1i())};this.Czh=function(ha){I.UW("DataValidationEdit.ExpandExisitngDialog",ha);I.EB.c=Uc.yia(ha);1===ha?I.AHa(new ae(I.c1a)):2===ha?I.AHa(new ae):I.Inf()};this.oXi=function(ha){I.UW("DataValidationEdit.OverrideExisitngDialog",ha);I.EB.c=Uc.yia(ha);1===ha?I.AHa(new ae):I.Inf()};this.$=d;this.E5c=w}function ae(d){this.n5=(d=void 0===d?null:d)?d.IsIgnoreBlank:!0;this.o5=d?d.IsInCellDropDown:!0;this.aO=d?d.LowerBoundary:"";this.bO=d?d.UpperBoundary:"";this.tB=d?d.ConditionType:0;
this.ruleType=d?d.RuleType:0;this.VZ=d?d.IsAlertBlocking:!0;this.bU=d?d.AlertTitle:"";this.aU=d?d.AlertMessage:"";this.JV=d?d.InputMessage:"";this.gF=d?d.InputTitle:"";this.y5=d?d.IsShowErrorAlert:!0;this.z5=d?d.IsShowInputMessage:!0}function ue(d){switch(d){case 0:d="AnyValue";break;case 1:d="WholeNumber";break;case 2:d="Decimal";break;case 3:d="List";break;case 4:d="Date";break;case 5:d="Time";break;case 6:d="TextLength";break;case 7:d="Custom";break;default:d="Unknown"}return d}function Lf(d){switch(d){case 0:d=
"Between";break;case 1:d="NotBetween";break;case 2:d="Equal";break;case 3:d="NotEqual";break;case 4:d="GreaterThan";break;case 5:d="LessThan";break;case 6:d="GreaterThanOrEqual";break;case 7:d="LessThanOrEqual";break;default:d="Unknown"}return d}function xf(d){var w=ph.call(this)||this;w.$=d;w.dc();return w}function Rf(d,w,I){var ha=this;this.Wxc={};this.Md=!1;this.$k=function(wa,$a){ha.showContextMenu(void 0===$a?null:$a)};this.Hwf=function(wa,$a){$a.KAi===Rf.y2h&&Ne.g(ha.$).focus()};this.J_=function(wa,
$a){wa=ha.$.Ka.Maa($a.ae.command);(null===wa||void 0===wa?0:wa.dismissesContextualUI)&&ha.L3()};this.m6=function(){ha.$.da.OU(342);Od.TaskExtensions.Ba(Rg.GetServiceTaskFactory.create(ha.$.da,338,ha.$.ma,3),function(wa){wa=wa.result;for(var $a=yl(ha.Wxc),Tb=$a.next();!Tb.done;Tb=$a.next())Tb.value.EOf(wa)},ha.$.ma)};this.$=d;this.contextMenuController=I;this.F6d=new dc(this.$);d.da.Ha(8,this);for(I=0;I<w.length;I++)this.Wxc[Rf.D2g[I]]=w[I];this.ha=Ne.g(d).ha;this.ha.NYb(this.$k);this.$.Ka.FFa(this.Hwf);
bj.a.instance.suj();ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.CFa(this.J_);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.K9(this.m6)}function dc(d){this.QTe=null;this.$=d;this.B8a=new Gd;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.QTe=new Oc(this.$))}function Oc(d){var w=
this;this.GZa=null;this.XQd=!1;this.PAb=0;this.k9c=1;this.bNe=0;this.xDb=function(I){w.uLf(I.domElement,I.hashCode)};this.TOf=function(I){for(var ha=0;window.performance.now()-I<w.Omh&&0<w.GZa.length;)w.Dme(w.GZa.shift()),ha++;Fd.ULS.sendTraceTag(537167052,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",w.k9c,ha,w.GZa.length);0<w.GZa.length?w.PAb=window.requestAnimationFrame(w.TOf):(Fd.ULS.sendTraceTag(537167051,
1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",w.k9c,window.performance.now()-w.bNe),w.k9c++,w.PAb=0)};this.onPointerDown=function(I){Th.a.slim(I.Ea.rawEvent);return!1};this.$=d;this.gridView=Ne.g(this.$);this.x$h();this.Omh=this.$.ya.AutoFilterEventRegistrationTimeLimit}function Ed(){this.Xd=this.xte=this.cell=null}function Gd(){this.odc={}}function Ee(){this.menuModel=null;this.LFe=0}function ee(){this.dictionary=this.ae=null}function hf(d){var w=
Uh.call(this)||this;w.Haf=!1;w.Ild=function(){var I;(I=w.$.da.Aa(342))?w.Fb(I):w.$.$E(function(ha){ha.Hld().then(function(wa){(I=w.$.da.Aa(342))?w.Fb(I):(I=new kf(w.$,wa),w.Fb(w.$.da.Ha(342,I)))})})};w.$=d;w.dc();return w}function kf(d,w){this.Kqb=w;this.$=d}function rf(d){return fg.call(this,d)||this}function ng(d,w,I,ha){d=de.call(this,d,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,ng.SKj,!0,!1,ng.gIb,w,I,!1,ha)||this;d.S0a=0;d.Fsa=null;d.qKa=null;d.JKe=null;return d}function je(d,w,I){this.type=
d;this.y2g=w;this.qp=I}function bg(d,w,I,ha){return Uj.call(this,d,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",w,I,!0,ha)||this}function ig(d,w,I,ha){d=ji.call(this,d,"PopulateSheetOpsContextMenu",274207288,-1497523576,th,!0,!1,"SheetTabContextMenuRootName",w,I,!1,ha)||this;d.sgc=!1;d.Shc=!1;return d}function Yd(d,w,I,ha){w=hg.call(this,d,"PopulateRichTextContextMenu",679816325,1151222423,sf,!0,!1,sf,w,I,!0,ha)||this;w.grid=Ne.g(d);return w}
function If(d,w,I,ha){w=fe.call(this,d,"PopulateTableFieldListContextMenu",-751848458,-1085236154,Id,!0,!1,"TableFieldListContextMenuRoot",w,I,!1,ha)||this;w.S4b=null;w.Gyd=0;w.MUb=null;w.grid=Ne.g(d);return w}function Pd(){}function Ze(d,w,I,ha){var wa=Bc.call(this,d,"PopulatePivotTableContextMenu",-1475408662,1114549926,Mg,!0,!1,"PivotTableContextMenuRootName",w,I,!0,ha)||this;wa.Uc=null;wa.activeCell=null;wa.RCc=null;wa.dic=!1;wa.sod=!1;wa.expandCollapse=!1;wa.refresh=!1;wa.oZ=!1;wa.ag=null;wa.Pz=
null;wa.w0a=null;wa.Db=null;wa.T$a=null;wa.xba=!1;wa.VMi=function($a){$a&&!hh.a.lh($a.Errors)&&wa.Uc&&(wa.Uc.Qo=$a.Result,wa.wJb());wa.showPivotTableContextMenu()};wa.UMi=function(){};wa.KQi=function(){wa.ybb()};wa.JQi=function(){wa.ybb()};wa.AHi=function(){wa.ybb()};wa.zHi=function(){wa.ybb()};wa.$t=function(){wa.HXd();wa.xba=!1};wa.ht=function(){if(wa.xba){Fd.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
var $a=wa.Uc;wa.grid.Rb.$o(wa.grid.ha.va.activeCell)!==$a&&(wa.ybb(),wa.K7h())}};wa.Khh=new DOMParser;wa.Cxj=!0;wa.grid=Ne.g(d);wa.Rkc=!0;return wa}function Yf(d,w,I,ha){return Ud.call(this,d,"PopulatePivotContextMenu",2123758504,912277356,w,I,ha)||this}function Xf(d,w,I,ha){d=Jg.call(this,d,"PopulateFieldWellContextMenu",1374696078,495005930,dg,!0,!1,dg,w,I,!1,ha)||this;d.cell=null;d.mo=null;d.zo=null;d.externalSourceIndex=-1;d.N_d=-1;d.zSa=0;d.kyc=-1;d.ML=null;d.isOlap=!1;d.QH=!1;d.y2a=!1;return d}
function rg(d,w,I,ha,wa,$a,Tb,Ic,pc){var vd=Zf.call(this,wa,te.a.instance.Cb(60),!0,2,!0)||this;vd.w3f=!0;vd.Kje=null;vd.mSa=null;vd.Yfa=null;vd.Crb=null;vd.z5c=null;vd.FRc=null;vd.uHi=function(ne){ih.a.any(ne.Errors,function(Pe){return-103190598===Pe.MessageId})&&vd.RSa.Cij()};vd.ENi=function(ne){ne&&!xh.a(ne)&&(ne=ne.Result,vd.z5c.innerHTML=te.a.instance.fa(1054)+Ng.a.Lf(ne.ValueFieldSourceName),vd.isOlap&&!vd.QH?(vd.RSa.enabled=!1,vd.Yfa.activeTab=vd.Yfa.izc-1):(vd.RSa.enabled=!0,vd.Yfa.activeTab=
0),vd.RSa.itj(ne.PivotValueFieldSettingsSummarizeValueByInfo),vd.mSa.jtj(ne.PivotValueFieldShowValueAsInitialInfo),vd.mf())};vd.cell=d;vd.zo=w;vd.externalSourceIndex=I;vd.Vfg=ha;vd.ae=$a;vd.kia=Tb;vd.isOlap=Ic;vd.QH=pc;return vd}function uf(d,w,I){I=void 0===I?null:I;this.Vlb=this.emb=null;this.r1=-1;this.di=d;this.lY=(void 0===w?null:w)||new W.a;this.oxg=I||new La;this.WEa=new W.a;d=0;w=yl(this.lY);for(I=w.next();!I.done;I=w.next()){I=I.value;this.Brd(this.r1)||(this.r1=d);var ha=d++;this.WEa.add(new kg(document.createElement("li"),
I.title,this.q6g(ha)))}}function kg(d,w,I){this.di=d;this.Dp=w;this.gGc=I;this.Lfa=document.createElement("a");Oe.a.Ovc(this.Lfa,this.Dp);Sys.UI.DomElement.addCssClass(this.Lfa,qh.ZIj);Sys.UI.DomElement.addCssClass(this.di,qh.YIj);this.di.appendChild(this.Lfa);this.Lfa.tabIndex=0;this.cBc();Dd.a.addHandler(this.di,"click",this.gGc);Dd.a.addHandler(this.di,"keyup",Object(Sg.a)(this,this.W9a,"onTitleKeyUp"))}function qh(){}function La(){}function Db(d){d=xb.call(this,d)||this;d.Ude=null;d.get_visible=
d.Yja;d.set_visible=d.Hna;d.ska();return d}function uc(){}function Vc(d,w,I,ha,wa,$a,Tb,Ic){var pc=Y.call(this,d)||this;pc.wF=null;pc.p5b=null;pc.$_b=null;pc.i2d=null;pc.j2d=null;pc.M4d=null;pc.Owf=function(){var vd=parseInt(pc.E3.qe.value,10);pc.PUg(vd)?(pc.gU.Rn.disabled=!0,pc.$P.Rn.disabled=!0,pc.$P.clear(),Vc.Ncf(vd)?(pc.gU.Rn.disabled=!1,pc.oNb(!0)):Vc.Ocf(vd)?(pc.gU.Rn.disabled=!1,pc.$P.Rn.disabled=!1,pc.oNb(!0),pc.Nlf()):pc.oNb(!1)):(vd=hh.a.hd(1,0,0,1084,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),
Ki.a(pc.$).nv([vd]),pc.E3.Gij())};pc.FHi=function(){0>pc.gU.selectedIndex||pc.$P.Rn.disabled||(pc.oNb(!0),pc.Nlf())};pc.FNi=function(vd){pc.wF.JSa();pc.$P.Rn.style.overflowY="scroll";if(vd&&!xh.a(vd)){vd=vd.Result;pc.$P.clear();for(var ne=yl(vd.BaseItems),Pe=ne.next();!Pe.done;Pe=ne.next())Pe=Pe.value,pc.$P.oM(Pe.DisplayString,Pe.Id.toString(),Pe.Id===vd.SelectedBaseItem);pc.oNb(!1)}};pc.get_visible=pc.Yja;pc.set_visible=pc.Hna;pc.$=w;pc.cell=I;pc.zo=ha;pc.externalSourceIndex=wa;pc.ae=$a;pc.kia=Tb;
pc.Tki=Ic;pc.wTj=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");pc.ska();return pc}function yd(){}function Md(d,w,I,ha,wa){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=d;this.activeCell=w;this.pivotFieldTitle=I;this.summarizeBy=ha;this.showAsValueParameters=wa}function qe(d,w,I){this.baseItemIndex=this.baseFieldIndex=this.dataFormat=0;this.dataFormat=
d;this.baseFieldIndex=w;this.baseItemIndex=I}function ac(){}function Kc(){}function dd(d,w,I,ha){return Ud.call(this,d,"PopulateFieldListPivotMenu",-1793121409,1378457149,w,I,ha,Qg)||this}function Ud(d,w,I,ha,wa,$a,Tb,Ic){Ic=void 0===Ic?rh:Ic;var pc=Eh.call(this,d,w,I,ha,Ic,!0,!1,"PivotFilterMenuRootName",wa,$a,!1,Tb)||this;pc.N4b=null;pc.fkf=null;pc.tmb=null;pc.pivotData=null;pc.Qyd=null;pc.imc=null;pc.NCb=0;pc.I1b=0;pc.yY=0;pc.T0a=null;pc.IMi=function(vd,ne){if(ne)if(xh.a(vd))pc.Qvd(ne,!1);else if(vd=
vd.Result){pc.$rb=ce.Mfd(ne,pc.$,pc.pivotData.cell,pc.yY);var Pe=pc.rwd(vd.MenuModel.Sections);pc.T0a=Pe;Ud.AN.set(pc.pivotData.cell,ne,Pe,pc.yY);yf.a(pc.$).pHj(vd);pc.Qvd(ne,!0)}};pc.HMi=function(vd,ne){pc.Qvd(ne,!1)};pc.Re=function(vd,ne){Ud.AN.a7b(ne.dd.hash)};pc.Fm=function(vd,ne){Ud.AN.a7b(ne.dd.hash)};pc.Zca=null;pc.Ryd=pc.NCb=-1;pc.hye=pc.I1b=-1;pc.hqe=pc.yY=0;pc.qw=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");Ud.AN||(Ud.AN=new ce(pc.$),Ne.g(pc.$).Ca.sq(pc.Re),Ne.g(pc.$).Ca.KG(pc.Fm),
Ne.g(pc.$).Ca.Yga(pc.Re));return pc}function Le(){this.cell=null;this.dataSourceIndex=0;this.zo=this.pivotName=null}function ce(d){this.$=d;this.AN={}}function Nf(d,w,I,ha){d=pe.call(this,d,"PopulateFieldListContextMenu",-1045020714,-170383950,Xd,!0,!1,Xd,w,I,!1,ha)||this;d.mo=null;d.ML=null;d.WZ=!1;d.QH=!1;d.isOlap=!1;d.tUd=!1;return d}function af(d,w,I,ha){d=wf.call(this,d,w,I,ha,"PopulateChartContextMenu",-498523270,1640762262,gd)||this;d.JAa=!1;d.awa=!1;d.oZ=!1;d.refresh=!1;d.isPivotChart=!1;
return d}function wf(d,w,I,ha,wa,$a,Tb,Ic,pc,vd){Ic=void 0===Ic?Ca.a.w2g:Ic;d=ad.call(this,d,void 0===wa?"PopulateFloatingObjectContextMenu":wa,void 0===$a?-2017893763:$a,void 0===Tb?1350204367:Tb,Ic,void 0===pc?!0:pc,void 0===vd?!1:vd,Ic,w,I,!0,ha)||this;d.floatingObject=null;d.yb=0;d.Rkc=!0;return d}function vf(d,w,I,ha){d=M.call(this,d,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,vf.TAh,!0,!1,vf.gIb,w,I,!1,ha)||this;d.fm=null;return d}function pg(){}function bf(){}function Bf(d,
w){d=$e.call(this,d,2,0,null)||this;d.wte=w;return d}function $e(d,w,I,ha){this.Isg=d;this.sng=w;this.wng=I;this.hxg=ha}function He(){}function vg(d,w,I,ha){var wa=h.call(this,d,"PopulateAutoFilterContextMenu",1675506831,1651433993,lh,!0,!1,"AutoFilterContextMenuRoot",w,I,!1,ha)||this;wa.T0a=null;wa.sheetName=null;wa.nTa=null;wa.HWc=null;wa.imf=!1;wa.B2a=!1;wa.dEd=null;wa.sLb=null;wa.C$c=null;wa.Cbc=null;wa.rPa=null;wa.bGe=null;wa.w$a=null;wa.W4c=null;wa.NN=function(){wa.iyc();wa.$.ea.Lq(wa.NN)};
wa.qMi=function($a){function Tb(Wf,Of,xg){wa.W4c=jg.t(wa.$.na.ta,vd,Jf.b(Wf,ne),wa.B2a?Jf.a(Of,Pe):Of,xg,null,Af);return wa.W4c}wa.B2a||og.b(wa.$).ee(nf.a.Hyf,wa.gm(),void 0,!0);var Ic={};wa.$.Cj(Ic);var pc=wa.$.ea.isNamedObjectViewMode,vd=Ld.a.pi(wa.HWc);vd.SheetName=pc?Ic.NamedObjectName:Ic.SheetName;vd.NamedObjectView=pc;Ic=!!$a.searchText;pc=586;wa.B2a&&(Ic&&(vd.ItemListOptions=wa.$4g($a.searchText),pc=597),$a={},og.b(wa.$).ee(nf.a.Hyf,($a.UserOperation=pc.toString(),$a),void 0,!0));var ne=wa.vAd(Ic),
Pe=wa.rMi(),Af=wa.$.na.ta.Zb();wa.bGe=Af.RequestId;wa.B2a&&wa.Cbc&&!wa.Cbc.dequeueUtcTime&&(wa.$.userOperationManager.iIa(wa.Cbc),wa.aVg());$a=ye.EwaSettings.sc()?new Uf.a(pc,0,Tb,80):new qf.a(pc,0,Tb,16);wa.Cbc=wa.$.userOperationManager.hc($a,null);wa.w$a=wa.W4c;wa.rPa=wa.bGe};wa.onMenuItemClick=function($a,Tb,Ic){og.b(wa.$).ee(nf.a.nRi,wa.gm(),void 0,!0);var pc={};Tb=(pc.CommandValueId=Tb,pc.MenuItemId=Tb,pc.InputMethod=Ic,pc.TopCellAddress=wa.nTa,pc);pc=new eh.a($a,Ic,wa.$.isEditMode?2:1,19,null);
wa.$.Ka.Xb(pc,Tb);Fd.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",$a,Ic)};wa.qHi=function($a){if($a.checkedItems&&$a.checkedItems.length){og.b(wa.$).ee(nf.a.Puf,wa.gm(),void 0,!0);var Tb=Ld.a.pi(wa.HWc),Ic={};wa.$.Cj(Ic);Ic.FirstRow=0;Ic.FirstColumn=Tb.Column;var pc=wa.$.ea.isNamedObjectViewMode;Tb.NamedObjectView=pc;Tb.SheetName=pc?Ic.NamedObjectName:Ic.SheetName;var vd=function(Af){if(mh.a.exc(Af)){var Wf=mh.a.T$b(Af);wa.FMa?mh.a.zQa(cg.a.applyItemFilter,Wf.MessageIdName,
li.a.ksa,!0,mh.a.isSessionEndingError(Wf.MessageId)):Fd.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",Wf.MessageIdName)}xh.a(Af)||(Fd.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),og.b(wa.$).ee(nf.a.Byf,wa.gm(),void 0,!0),Af=Object.assign(new ud,{isSuccess:!0}),wa.sLb.onApplyFilterByValueFinish(Af),wa.JL(wa.nTa))},ne=wa.x3c(Tb,Ic),Pe=new Uf.a(208,0,function(Af,Wf,Of){return jg.a(wa.$.na.ta,
ne,$a.checkedItems,Jf.b(Af,vd),Wf,Of,null,null)},6,function(){return new le.a($a.checkedItems,ne)});wa.u4f(function(){wa.$.userOperationManager.hc(Pe,null)})}else Fd.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};wa.RKg=function($a){var Tb=td.o(wa.nTa,wa.$),Ic=td.v(wa.nTa,wa.$),pc=Object.assign(new Df,{SortConditionType:$a.type,RowColOffset:Tb.FirstColumn-Ic.FirstColumn,SortColor:$a.color,SortIconSet:$a.icon.IconSet,SortIcon:$a.icon.Icon,
IsAscending:!0}),vd={SortOptions:Object.assign(new gf,{OperationType:1,ActiveCell:Tb,SelectedRange:Ic,SortConditions:[pc],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),SelectedRange:Ic,OriginalActiveCell:Tb,ShouldRestoreSelection:!1};Fd.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",$a.type);wa.u4f(function(){var ne={};wa.$.xe(1659552324,Kf.a.$b,19,(ne.CustomSortCommandData=vd,ne))})};wa.FMa=mh.a.Ymd();wa.qw=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
return wa}function ah(){this.top=this.left=0}function Ph(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function Pf(){this.autoFilterMenu=this.targetPoint=null}function Da(){this.filterByValueItems=null;this.hasMoreRecords=!1;this.searchText=null}function Fb(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=
null}function Lc(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function ud(){this.isSuccess=!1}function zd(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function Ce(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function Ge(){this.Sections=this.Id=null}function gf(){this.ActiveCell=this.SelectedRange=
null;this.SortTopToBottom=this.IsCaseSensitive=this.GuessHeader=this.HasHeader=this.IsAscending=!1;this.SortInfoMode=this.OperationType=0;this.ExpandSortSelection=this.SortConditions=null;this.ExpandSortSelectionSupported=!1}function Df(){this.RowColOffset=0;this.IsAscending=!1;this.CustomOrder=null;this.SortColor=this.SortConditionType=0;this.FillGradient=null;this.SortIcon=this.SortIconSet=0;this.RichProperty=null}function Ea(){}function kb(d,w,I,ha){var wa=this;this.G2d=this.v1=this.Vi=this.LD=
this.s8=null;this.jWb=d;this.mwg=ha;this.jWb.ULa&&(this.Vi=new Bg.a(3,2,5E3,Object(Sg.a)(this,this.VMg,"authenticationCheckTask"),2),zg.AFrameworkApplication.hj.Zg(this.Vi),this.Qg(w,I));this.jWb.inb(function(){wa.Xuf()});this.jWb.DYa(function(){wa.Yuf()})}function Vb(){}function Qc(d){return hi.call(this,d)||this}function Mc(d,w,I){var ha=Lg.call(this)||this;ha.IIi=function(wa,$a){if(!xh.a(wa)&&$a){var Tb=!!wa&&!!wa.RequestTelemetryData;Ne.g(ha.$).Mi.Bla($a.toString(),wa.StateId,Tb?wa.RequestTelemetryData.EcsOperationDuration:
0,Tb?wa.RequestTelemetryData.EcsRequestDuration:0,Tb?wa.RequestTelemetryData.WfeRequestDuration:0)}};ha.$=d;ha.tableManager=w;ha.Gh=I;return ha}function Ab(d,w){this.command=0;this.selectedRanges=null;this.command=d;this.selectedRanges=w}function nc(d){return Kh.call(this,d)||this}function Rd(d){var w=ti.call(this)||this;w.avf=function(I){var ha=Ne.g(w.$);if(I=I.Result){var wa=td.D(I.NewSelection),$a=td.D(I.NewActiveCell);if(wa&&$a)if(!I.Committed&&I.AutoSumFormula){var Tb=ha.uc($a);Tb&&(ha.ha.updateSelection(wa,
$a,60),wa=$a=td.D(I.MarkedArea),ha.wC=2,he(ha.pc,Tb,I.AutoSumFormula,!!wa,I.FormulaMarkStart,I.FormulaMarkEnd),wa&&$a&&ha.ha.updateSelection(wa,$a,0),ha.pc.Zpd=!1,Od.TaskExtensions.Ba(Rg.GetServiceTaskFactory.create(w.$.da,153,w.ma,0),function(Ic){Ic.result.Isb(null)},w.ma,3))}else ha.ha.updateSelection(wa,$a,60)}};w.$=d;return w}function Je(d,w){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=d;this.type=w}function he(d,w,I,ha,wa,$a){if(w){var Tb=d.textBox;d.isEditing||d.startEdit(w,
!0);d.Zpd=!0;d.text=I;Tb.caretPosition=wa;wa<$a&&(ha&&d.SAa(),Tb.selectRange(0,$a+1),Tb.selectRange(wa,$a))}}function Ff(d,w,I,ha,wa,$a,Tb,Ic,pc,vd){vd=d.Na(9,vd);vd.selectedRange=w;vd.activeCell=I;vd.autoSumType=ha;vd.topLeftCell=wa;return jg.i(d,"AutoSum",vd,$a,Tb,Ic,pc,0)}function Fe(d,w,I,ha,wa,$a){if(0===ha)return Object(ff.a)(Zh.UnsupportedZeroResize);if(0>ha||0===I.length)return Object(ff.a)(Zh.InvalidInput);if(d.J6h())return Object(ff.a)(Zh.UnsupportedSkeletonInView);var Tb=d.rf;if(!Tb)return Object(ff.a)(Zh.NullSPD);
var Ic=Tb.X_e(I);if(Ic&&0<Ic.length)return Object(ff.a)(Ic.length.toString()+" "+Zh.UnsupportedHiddenInRange);a:{Ic=yl(I);for(var pc=Ic.next();!pc.done;pc=Ic.next())pc=pc.value,wa?pc.right=xe.a.Xh:pc.bottom=xe.a.Lh;Ic=d.N$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",I);try{for(Ic.$$rst();Ic.$$mn();)if(Ic.ho.fFj){var vd=!0;break a}}finally{Ic&&Ic.dispose()}vd=!1}if(vd)return Object(ff.a)(Zh.UnsupportedMergeCell);if(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",
!1)&&!wa&&"undefined"!==typeof gridRenderer)for(vd=yl(I),Ic=vd.next();!Ic.done;Ic=vd.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(Ic.value.left);d=d.Ca;vd=nh.a.create().toString();Tb.veg(I,ha,wa);$a=d.Wcg(wa,$a);w.m8i(I,wa);d.CLf($a,vd);return Object(ff.d)(ha)}b.r(F);var Tf=b(516),Hd=b(0),Ye=b(817),Fd=b(13),ve=b(194),jg=b(81),Kf=b(77);Je.prototype.l4a=function(){return this.sharedSheetRange};Object(Hd.a)(Je,"MacroRecorderAutoSumPayload",null,[147]);var td=b(43),qf=b(521),Ch=b(369),
Uf=b(164),Rg=b(56),Od=b(35),gh=b(148),fi=b(339),hh=b(27),ye=b(1),Dg=b(175),Jf=b(272),Ne=b(20),gi=b(155),kh=b(584),Vf=b(52),ti=ve.a;vm(Rd,ti);Rd.prototype.Yc=function(){return!1};Rd.prototype.executeCommand=function(d,w,I){d=w.command;switch(d){case 1220954656:w=this.rJe(0,w);break;case -1537138325:w=this.rJe(parseInt(I[Kf.a.ld].toString(),10),w);break;default:w=Dg.a(d)}return w};Rd.prototype.Jc=function(d,w){if(d=1===d)switch(w.command){case 1220954656:case -1537138325:break;default:d=!1}return d};
Rd.prototype.fd=function(){return!1};Rd.prototype.rJe=function(d,w){function I(){return new Je(Tb,d)}var ha=this,wa=Ne.g(this.$);wa.Hh.XG(!1);if(!Ne.g(this.$).ha.va.qh)return Fd.ULS.sendTraceTag(537170308,0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",d,Ne.g(this.$).ha.va.TK),this.hza(),Vf.Task.Ta(!1);var $a=wa.tH();if(!$a)return null;var Tb=td.v(wa.ha.va.Sd,this.$),Ic=td.o(wa.ha.va.activeCell,this.$),pc=td.o($a,
this.$),vd=this.$.na.ta.Zb();return this.$.Ns(wa.ha.va.selectedRanges,!0)?ye.EwaSettings.sc()?Ch.a(this.$.userOperationManager,function(ne,Pe,Af){return Ff(ha.$.na.ta,Tb,Ic,d,pc,Jf.b(ne,ha.avf),Pe,Af,d,vd)},function(ne){return new Uf.a(502,0,ne,64,I)},w):Ch.a(this.$.userOperationManager,function(ne,Pe,Af){return Ff(ha.$.na.ta,Tb,Ic,d,pc,Jf.b(ne,ha.avf),Pe,Af,d,vd)},function(ne){return new qf.a(502,0,ne,void 0,I)},w):Vf.Task.Ta(!1)};Rd.prototype.hza=function(){kh.a(gi.a.discontinuousSelectionBlocking,
["OtherICE"],!0,!0,!1,!1,null);var d=hh.a.hd(1,1,738,2128,0,371863010,"DiscontinuousSelectionBlocking");ye.EwaSettings.oz()?new fi.a(this.$,d):(d=new gh.ErrorDialog(this.$,d),d.initialize(),d.mf())};Object(Hd.a)(Rd,"AutoSumCommandHandler",ve.a,[188]);var Kh=Ye.a;vm(nc,Kh);nc.prototype.Od=function(){this.Fd([new Rd(this.$)])};nc.ja=function(d){Ye.a.fe(96,new nc(d))};Object(Hd.a)(nc,"AutoSumCommandHandlerFactory",Ye.a,[]);var Jh=b(10),nh=b(178),ih=b(309),dh=b(36),Qh=b(319);Ab.prototype.Qt=function(){return this.command};
Object(Hd.a)(Ab,"MacroRecorderRangeOperationAppliedPayload",null,[147]);var xh=b(303),Xg=b(67),Lg=dh.a;vm(Mc,Lg);Mc.prototype.kEg=function(d){this.addHandler("ekcvc",d)};Mc.prototype.Jbj=function(d){this.removeHandler("ekcvc",d)};Mc.prototype.Yc=function(){return!1};Mc.prototype.executeCommand=function(d,w){d=w.command;switch(d){case -730106152:w=this.Kid(w,3);break;case -1228228458:w=this.Kid(w,4);break;case -848953656:case 2045211913:if(this.Ili()){w=Vf.Task.Ta(!0);break}w=this.Kid(w,1);break;default:w=
Dg.a(d)}return w};Mc.prototype.Jc=function(d,w){if(d=1===d)switch(w.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:d=!1}return d};Mc.prototype.fd=function(){return!1};Mc.prototype.Kid=function(d,w){function I(){return new Ab(w,vd)}function ha(Pe,Af,Wf){wa.$.oy();return jg.f(wa.$.na.ta,w,vd,!1,Jf.b(Pe,wa.IIi),Af,Wf,pc,ne)}var wa=this,$a=Ne.g(this.$),Tb=$a.ha.va.selectedRanges,Ic=d.command,pc=nh.a.create().toString();if(!this.$.Ns(Tb,!0)&&-730106152!==Ic)return Vf.Task.Ta(!0);
var vd=td.r(Tb,this.$);this.GBj(Ic,$a,Tb,pc);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.s4i();var ne=this.$.na.ta.Zb(!0);return ye.EwaSettings.sc()?Ch.a(this.$.userOperationManager,ha,function(Pe){return new Uf.a(508,0,Pe,67,I)},d):Ch.a(this.$.userOperationManager,ha,function(Pe){return new qf.a(508,0,Pe,3,I)},d)};Mc.prototype.GBj=function(d,w,I,ha){var wa=this;if(-848953656!==d&&2045211913!==d&&-730106152!==d&&-1228228458!==d)Fd.ULS.sendTraceTag(537167938,
0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",d);else if(!ih.a.any(I,function(Tb){return 0<w.getRangeInformation(Tb).length})){var $a=ih.a.any(I,function(Tb){return wa.tableManager.hrd(Tb)});if(-730106152!==d&&-1228228458!==d||!$a)this.NFj(w,d,ha,I),-730106152!==d&&-1228228458!==d||this.Gh.$da(w,-730106152,{}),-1228228458!==d&&2045211913!==d&&-848953656!==d||this.Gh.JYg(I,ha),w.Mi.O0(ha,Xg.BasicTelemetryCalculator.hR)}};Mc.prototype.NFj=function(d,w,I,ha){var wa="";switch(w){case -1228228458:wa=
"ClearAll";break;case 2045211913:case -848953656:wa="ClearContent";break;case -730106152:wa="ClearFormat";break;default:Fd.ULS.sendTraceTag(537167937,0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",w)}w=ha.length;ha=td.b(ha);d.Mi.C7(15,I,wa+(", ranges to clear: "+w+", cells to clear: "+ha))};Mc.prototype.s4i=function(){this.raiseEvent("ekcvc",new Qh.a)};Mc.prototype.Ili=function(){if(Ne.g(this.$).kz){var d=this.$.da.Aa(296);return!!d&&d.UU.dB}return!1};Object(Hd.a)(Mc,
"ClearCommandHandler",dh.a,[188,778]);var hi=Ye.a;vm(Qc,hi);Qc.prototype.Od=function(){var d=this,w=Rg.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.ub),I=Rg.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.ub);Od.TaskExtensions.Ba(Od.TaskExtensions.ve([w,I],this.ma),function(){var ha=new Mc(d.$,w.result,I.result);d.Fd([ha]);d.$.da.Ha(313,ha)},this.ma,3)};Qc.ja=function(d){Ye.a.fe(101,new Qc(d))};Object(Hd.a)(Qc,"ClearCommandHandlerFactory",Ye.a,[]);var Lh=b(914),Kg=b(892),ai=b(865),
Fh=b(1145);Vb.prototype.c9g=function(d,w){if(d&&!(1>d.length)&&w){var I=Object.assign(new ai.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.F6g(d,I.ControlList);w.push(I)}};Vb.prototype.F6g=function(d,w){var I=Object.assign(new Lh.a,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new Kg.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(w,I);w=Object.assign(new ai.a,{Title:"",ControlList:[]});
Array.add(I.Menu.MenuSectionList,w);this.J8g(d,w.ControlList)};Vb.prototype.J8g=function(d,w){for(var I=0;I<d.length;I++){var ha=Object.assign(new Fh.a,{ExternalId:String.format("CoauthorPersona_{0}",I),Command:"336231556",DisplayName:d[I].userName,LabelText:d[I].userName,ImageBackColor:d[I].color,PersonaId:d[I].email,IsAnonymous:d[I].isAnonymous});Array.add(w,ha)}};Object(Hd.a)(Vb,"PresenceContextMenuSectionBuilder",null,[782]);var Sg=b(80),zg=b(5),wh=b(171),ch=b(581),Bg=b(108),Ah=b(128),eg=b(88),
Mh=b(86),pi=b(104),mg=b(30);kb.prototype.Qg=function(d,w){var I=zg.AFrameworkApplication.Gb;I.ef(mg.a.authenticationLost,pi.a.frame,d,96);I.ef(mg.a.pte,pi.a.frame,w,96);I.fc(mg.a.jxe,pi.a.frame,wh.ActionManager.i7c);I.fc(mg.a.kxe,pi.a.frame,wh.ActionManager.i7c);I.fc(mg.a.ctd,pi.a.frame,wh.ActionManager.i7c)};kb.prototype.Xuf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);zg.AFrameworkApplication.Gb.processAction(mg.a.authenticationLost,2)};kb.prototype.Yuf=function(){this.DJj();
zg.AFrameworkApplication.Gb.processAction(mg.a.pte,2)};kb.prototype.VMg=function(){this.jWb.authenticationCheck()};kb.prototype.DJj=function(){this.LD&&(this.LD.hide(),this.LD.dispose(),this.LD=null);this.s8&&this.businessBar&&(zg.AFrameworkApplication.Ig||this.businessBar.removeEntry(this.s8),this.s8.dispose(),this.s8=null)};kb.prototype.showDialog=function(d){eg.a.Fa(this.LD);this.LD=new Ah.StandardDialog;this.mwg||(this.LD.Su=!1,this.LD.jc=0);this.LD.Fc(1,CommonUIStrings.l_SignIn);this.LD.mX(CommonUIStrings.l_DefaultDialogTitle,
d,Object(Sg.a)(this,this.$v,"dialogHandler"))};kb.prototype.$v=function(d){1===d?(ch.a.D6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),zg.AFrameworkApplication.Gb.processAction(mg.a.ctd,2)):(this.yRd(),zg.AFrameworkApplication.Gb.processAction(mg.a.kxe,2))};kb.prototype.yRd=function(){this.businessBar&&this.Ave&&(this.s8=this.Ave.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.s8.closeable=!0,this.s8.addButton(CommonUIStrings.l_SignIn,
kb.uSg,""),this.s8.w$=Object(Sg.a)(this,this.xSg,"businessBarEntryCloseHandler"),this.businessBar.$D(this.s8,!1))};kb.prototype.xSg=function(){this.Ffh();zg.AFrameworkApplication.Gb.processAction(mg.a.jxe,2)};kb.prototype.Ffh=function(){this.Vi&&(zg.AFrameworkApplication.hj.Np(this.Vi),this.Vi=null)};kb.prototype.dispose=function(){this.Vi=this.LD=this.s8=null};kb.uSg=function(){ch.a.D6();zg.AFrameworkApplication.Gb.processAction(mg.a.ctd,2)};Sk.Object.defineProperties(kb.prototype,{businessBar:{configurable:!0,
enumerable:!0,get:function(){return this.v1||(this.v1=Mh.a.instance.Oh("CommonUI.IBusinessBar"))}},Ave:{configurable:!0,enumerable:!0,get:function(){return this.G2d||(this.G2d=Mh.a.instance.Oh("CommonUI.IBusinessBarEntryFactory"))}}});Object(Hd.a)(kb,"SignOutResponseUI",null,[3]);var si=b(273);Ea.prototype.ji=function(d){d.register(Vb,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").Bc()};Ea.prototype.init=function(){};Ea.prototype.dispose=
function(){eg.a.Fa(Ea.f2);Ea.f2=null};Ea.main=function(){si.a.instance.sj(new Ea)};Sk.Object.defineProperties(Ea.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});Ea.f2=null;Object(Hd.a)(Ea,"CommonAppUIPackage",null,[4,5]);var Wh=b(143);Object(Hd.a)(Df,"SharedSortCondition",null,[]);Object(Hd.a)(gf,"SharedSortOptions",null,[]);var qg=b(842),Ca=b(4),ua=b(465),sb=b(589),Ld=b(54),le=b(1041),nf=b(126),ug=b(877),Cf=b(141),Cg=b(114),Ag=b(201),eh=b(92),jh=b(69),Pg=b(32),
te=b(14),Fg=b(62),og=b(127),mh=b(900),cg=b(901),li=b(135),fh=b(48),pf=b(34),Qf=b(417);Object(Hd.a)(Ge,"AutoFilterMenu",null,[]);Object(Hd.a)(Ce,"MenuItem",null,[]);Object(Hd.a)(zd,"MenuSection",null,[]);Object(Hd.a)(ud,"ApplyFilterByValueResponse",null,[]);Object(Hd.a)(Lc,"FilterByValueItem",null,[]);Object(Hd.a)(Fb,"GetColorsAndIconsResponse",null,[]);Object(Hd.a)(Da,"GetFilterByValueItemsResponse",null,[]);Object(Hd.a)(Pf,"ShowSortFilterMenuParams",null,[]);Object(Hd.a)(Ph,"SortFilterControllerFactoryParams",
null,[]);Object(Hd.a)(ah,"TargetPoint",null,[]);var $g=b(335),yg=b(39),lh=Ca.a.q2g,h=qg.a;vm(vg,h);vg.prototype.executeCommand=function(d,w,I){var ha=this;d=w.command;switch(d){case 1701016594:qg.a.gzh(I);break;case 966232027:var wa=I.domEvent;if(jh.e(wa.rawEvent)&&jh.e(wa.rawEvent)&&(jh.g(wa),wa.target&&(d=new Cf.a(this.$.xa),d.te(4096)||d.te(2048)))){var $a=Ld.a.pi(I[Kf.a.Ug]);this.V2f($a)&&(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")?this.imf?this.$sc(wa,wa.target,
$a,w):(this.dEd=function(){ha.V2f($a)&&(ha.kci(),ha.$sc(wa,wa.target,$a,w),ha.B2a=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",!1),ha.imf=!0)},this.iyc()):this.HO(wa,wa.target,$a,w,!0))}break;default:return Dg.a(d)}return Vf.Task.Ta(!0)};vg.prototype.Jc=function(d,w,I){if(d=!!I)switch(w.command){case 1701016594:case 966232027:ua.a(this.$)||(d=!1,Fd.ULS.sendTraceTag(537167137,0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",
fh.b().ui(w.command)));break;default:d=!1}return d};vg.prototype.HO=function(d,w,I){Fd.ULS.shipAssertTag(537167136,0,!!I,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");this.T0a=this.EKh(I);this.qw&&!I.IsHeaderSnapped?(!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||qg.a.Ffc(this.$,I.Cell))&&this.Eo(qg.a.uac(this.$,I.Cell,!0),!0):h.prototype.HO.call(this,d,w,I,null,!0)};vg.prototype.QDd=function(d){Array.addRange(d.MenuSectionList,
this.T0a)};vg.prototype.kci=function(){var d=this;Qf.a(function(){d.sLb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object.assign(new Ph,{getFilterByValueItemsRequest:d.qMi,applyFilterByValueRequest:d.qHi,onMenuItemClick:d.onMenuItemClick,autoFilterMenuWidth:vg.vte,applySortByColorOrIconRequest:d.RKg}))});this.C$c=Mh.a.instance.Oh("Common.IExternalUICommandDefinitionMapping")||new sb.a(this.$.Ib,this.$)};vg.prototype.$sc=function(d,w,I){og.b(this.$).ee(nf.a.$sc,this.gm(),
void 0,!0);Fd.ULS.shipAssertTag(537167135,0,!!I,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");d=this.DKh(I);var ha=Sys.UI.DomElement.getBounds(w),wa=ha.x+ha.width;ha=ha.y;if(this.qw&&!I.IsHeaderSnapped){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!qg.a.Ffc(this.$,I.Cell))return;I=qg.a.uac(this.$,I.Cell,!0);wa=I.x;ha=I.y}I=Ne.g(this.$).rtl?new Sys.UI.Point(wa-pf.a(this.$).TFa(vg.vte),ha):new Sys.UI.Point(wa,ha);this.ITa(I,w);
I=pf.a(this.$).Oja(I);w=Object.assign(new Pf,{targetPoint:Object.assign(new ah,{left:I.x,top:I.y}),autoFilterMenu:d});this.sLb.showSortFilterMenu(w);this.$.xe(-544117314,-1,0,null)};vg.prototype.V2f=function(d){return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")&&d.Cell.SheetName?Ne.g(this.$).r5?d.Cell.SheetName===this.$.pa.name:d.Cell.SheetName===this.$.pa.sheetName:!0};vg.prototype.DKh=function(d){return(d=this.WXe(d))?this.nKf(d):null};vg.prototype.nKf=
function(d){for(var w=[],I=yl(d.Sections),ha=I.next();!ha.done;ha=I.next())ha=this.o2i(ha.value),Array.add(w,ha);return Object.assign(new Ge,{Id:d.Id,Sections:w})};vg.prototype.o2i=function(d){for(var w=[],I=yl(d.MenuItems),ha=I.next();!ha.done;ha=I.next())if(ha=ha.value,2===ha.Identifier)this.HWc=ha.CommandData;else switch(ha.Type){case 3:case 2:Array.add(w,this.m2i(ha,2===ha.Type));break;case 1:Array.add(w,this.n2i(ha))}return Object.assign(new zd,{MenuItems:w,DisplayType:d.DisplayType,Id:this.dIh(d)})};
vg.prototype.n2i=function(d){var w=this.cXe(d);var I=w.label;var ha=w.rLa;w=this.nKf(d.SubMenu);var wa=this.SWe(d);ha=this.C$c.Pac(ha);I=I||d.Label;return Object.assign(new Ce,{Disabled:d.Disabled,Type:d.Type,Identifier:d.Identifier,Id:wa,CommandData:d.CommandData,Label:I,SubMenu:w,IsChecked:d.IsChecked,IconName:"MissingIcon_20"===ha?null:ha})};vg.prototype.m2i=function(d,w){var I=this.C$b(d,w&&d.IsChecked);w=I.label;var ha=I.rLa;I=I.qp;var wa=this.Ucd(d,w);ha=this.C$c.Pac(ha);return Object.assign(new Ce,
{Disabled:d.Disabled,Type:d.Type,Identifier:d.Identifier,Id:wa,RibbonCommand:I,CommandData:d.CommandData,Label:w||d.Label,SubMenu:null,IsChecked:d.IsChecked,IconName:"MissingIcon_20"===ha?null:ha})};vg.prototype.WXe=function(d){var w;this.nTa=w=td.C(d.Cell);this.sheetName=this.$.pa.sheetName;if(d.IsHeaderSnapped)w=ua.a(this.$).r9b.LRh(w);else{var I=Ne.g(this.$).Ca.W3a(w);if(!I)return this.FMa?mh.a.zQa(cg.a.FMf,gi.a.H2h,li.a.HZa,!0,!1):Fd.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",
w,Ne.g(this.$).view.visibleArea),null;w=I.autoFilterMenu}if(!w)return this.FMa?mh.a.zQa(cg.a.FMf,gi.a.FAi,li.a.HZa,!0,!1):Fd.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.$rb=d.Cell.FirstRow+"_"+d.Cell.FirstColumn;return w};vg.prototype.EKh=function(d){return(d=this.WXe(d))?this.rwd(d.Sections):null};vg.prototype.iyc=function(){var d=this;if(this.$.ea.Th){var w=Rg.GetServiceTaskFactory.Wa(this.$.da,
283,284,1);Od.TaskExtensions.Ba(w,function(){d.FMa?w.result.Un.loadScript("sortFilter").then(function(){d.dEd()},function(I){Fg.a.ql(I,"AutoFilterContextMenu.SortFilterScriptLoad");mh.a.zQa(cg.a.iyc,gi.a.PEj,li.a.HZa,!1,!1)}):Od.TaskExtensions.Ba($g.c(w.result.Un.loadScript("sortFilter")),function(){d.dEd()},d.$.ma,3)},this.$.ma,3)}else this.$.ea.Um(this.NN)};vg.prototype.$4g=function(d){var w={};w.SearchText=d;w.Page=1;w.DateNodeType=-1;return w};vg.prototype.aVg=function(){this.rPa&&(Fd.ULS.sendTraceTag(537167132,
0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",this.rPa),jg.j(this.$.na.ta,this.rPa,null,null,null),this.rPa=null);this.w$a&&(zg.AFrameworkApplication.Jd.ou(this.w$a.Ft),this.w$a=null)};vg.prototype.vAd=function(d){var w=this;return function(I){w.rPa=null;w.w$a=null;if(mh.a.exc(I)){var ha=mh.a.T$b(I);w.FMa?mh.a.zQa(d?cg.a.searchAutoFilterItemList:cg.a.getAutoFilterItemList,ha.MessageIdName,li.a.HZa,!0,!0):Fd.ULS.sendTraceTag(537167127,
0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",ha.MessageIdName)}if(!xh.a(I)){Fd.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");I=I.Result;ha=new Pg.a(!0);var wa=I.AutoFilterDateNodes?!0:!1;I.AutoFilterItems&&ha.add("AutoFilterItemsCount",I.AutoFilterItems.length);wa&&ha.add("AutoFilterDateItemsCount",I.AutoFilterDateNodes.length);ha.add("Location","contextMenu");og.b(w.$).ee(nf.a.vAd,
ha.Yu,void 0,!0);ha=w.B2a?Object.assign(new Da,{filterByValueItems:w.FCe(I),hasMoreRecords:I.ItemListMaxExceeded,searchText:I.SearchText}):Object.assign(new Da,{filterByValueItems:w.FCe(I),hasMoreRecords:I.ItemListMaxExceeded});w.sLb.onGetFilterByValueItemsFinish(ha);!d&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SortByColor",!1)&&(Fd.ULS.shipAssertTag(529063959,0,null!==I.FontColors&&null!==I.CellColors&&null!==I.Icons&&null!==I.SelectedSortFontColors&&null!==I.SelectedSortCellColors&&
null!==I.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),I=Object.assign(new Fb,{fontColors:I.FontColors,cellColors:I.CellColors,icons:I.Icons,selectedSortFontColor:0<I.SelectedSortFontColors.length?I.SelectedSortFontColors[0]:null,selectedSortCellColor:0<I.SelectedSortCellColors.length?I.SelectedSortCellColors[0]:null,selectedSortIcon:0<I.SelectedSortIcons.length?I.SelectedSortIcons[0]:null,getColorName:w.getColorName}),w.sLb.onGetColorsAndIconsFinish(I))}}};
vg.prototype.rMi=function(){var d=this;return function(w){d.rPa=null;d.w$a=null;w=Cg.a.og(w.data);Fd.ULS.sendTraceTag(537167125,0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",hh.a.Tc(w))}};vg.prototype.FCe=function(d){var w=this.S2g(d),I=this.Z2g(d.AutoFilterItems),ha=[],wa=0;d.HasBlanks&&(d=vg.N3c(te.a.instance.fa(765),d.IsBlanksSelected?1:0,Ca.a.ute),ha[wa++]=d);w=yl(w);for(d=w.next();!d.done;d=w.next())d=d.value,ha[wa++]=d;I=yl(I);for(d=I.next();!d.done;d=I.next())w=
d.value,ha[wa++]=w;return ha};vg.prototype.S2g=function(d){var w=[];if(!d.AutoFilterDateNodes||!d.AutoFilterDateNodes.length)return w;for(var I=[this.T3a(d.YearKeys,d.YearValues),this.T3a(d.MonthKeys,d.MonthValues),this.T3a(d.DayKeys,d.DayValues),this.T3a(d.HourKeys,d.HourValues),this.T3a(d.MinuteKeys,d.MinuteValues),this.T3a(d.SecondKeys,d.SecondValues)],ha=!1,wa=!1,$a=0,Tb=null,Ic=Array(6),pc=null,vd=yl(d.AutoFilterDateNodes),ne=vd.next();!ne.done;ne=vd.next()){ne=ne.value;Ic[0]&&(pc.Year!==ne.Year?
(ha=!0,$a=0,Tb=null):pc.Month!==ne.Month?(wa=!0,$a=1,Tb=Ic[0]):pc.Day!==ne.Day?($a=2,Tb=Ic[1]):d.ShowTime&&(pc.Hour!==ne.Hour?($a=3,Tb=Ic[2]):pc.Minute!==ne.Minute?($a=4,Tb=Ic[3]):($a=5,Tb=Ic[4])));for(;6>$a;){switch($a){case 0:var Pe=ne.Year;pc=I[0].getItem(Pe.toString());break;case 1:Pe=ne.Month;pc=I[1].getItem(Pe.toString());break;case 2:Pe=ne.Day;pc=I[2].getItem(Pe.toString());break;case 3:Pe=ne.Hour;pc=I[3].getItem(Pe.toString());break;case 4:Pe=ne.Minute;pc=I[4].getItem(Pe.toString());break;
case 5:Pe=ne.Second;pc=I[5].getItem(Pe.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}pc=vg.N3c(pc,-1!==ne.NodeType&&$a>=ne.NodeType?1:0,Tb?Tb.key+";"+Pe:Ca.a.IXc+Pe,!1,[]);Tb=Tb?Tb.children:w;Tb=Tb[Tb.length]=pc;Ic[$a]=pc;switch($a){case 5:$a=6;break;case 2:$a=d.ShowTime?$a+1:6;break;default:$a++}}pc=ne}ha||(Ic[0].expanded=!0,wa||(Ic[1].expanded=!0));return w};vg.prototype.Z2g=function(d){var w=[];if(!d)return w;var I=0;d=yl(d);for(var ha=d.next();!ha.done;ha=
d.next())ha=ha.value,w[I++]=vg.N3c(ha.DisplayString,ha.Selected?1:0,Ca.a.JXc+ha.DisplayString);return w};vg.prototype.T3a=function(d,w){var I=new Pg.a(!0);if(!d||!w)return I;for(var ha=d.length<w.length?d.length:w.length,wa=0;wa<ha;wa++)I.add(d[wa].toString(),w[wa]);return I};vg.prototype.x3c=function(d,w){var I={};I.Location=w;I.FieldId=d.Id.toString();I.DataSourceIndex=-1;I.FilterType=d.AutoFilterType;I.AnchorType=0;I.ChartId=null;I.AnchorValue1=-1;I.AnchorValue2=-1;I.Property=d.RichProperty;return I};
vg.prototype.JL=function(d){(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6063473_PTPSDisableLive")?yg.a.Rka(this.$):ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1))&&Od.TaskExtensions.Ba(Rg.GetServiceTaskFactory.Wa(this.$.da,430,431,1),function(w){w.result.yea(d);Fd.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},this.$.ma,3)};vg.prototype.gm=function(){var d={};return d.Location=
"contextMenu",d};vg.prototype.getColorName=function(d){return ug.a.rKa(Ag.a.kH(d))};vg.prototype.u4f=function(d){Od.TaskExtensions.Ba(Rg.GetServiceTaskFactory.Wa(this.$.da,309,310,3),function(w){w.result.LAa().continueWith(function(I){I.result&&d()})},this.$.ma,3)};vg.N3c=function(d,w,I,ha,wa){d=void 0===d?null:d;w=void 0===w?0:w;I=void 0===I?null:I;ha=void 0===ha?!1:ha;wa=void 0===wa?null:wa;return Object.assign(new Lc,{displayText:d?qg.a.ym(d):d,state:w,key:I,parent:null,children:wa,indentationLevel:0,
expanded:ha})};Sk.Object.defineProperties(vg.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.DMf}}});vg.vte=268;Object(Hd.a)(vg,"AutoFilterContextMenu",qg.a,[]);var Bb=b(849),qc=b(84),W=b(184),va=b(64),N=b(16);He.MTe=26;He.Qad=[229,230,0,98,0,94,93];Object(Hd.a)(He,"Constants",null,[]);Sk.Object.defineProperties($e.prototype,{Aki:{configurable:!0,enumerable:!0,get:function(){return 3===
this.A4b}},aoi:{configurable:!0,enumerable:!0,get:function(){return 4===this.A4b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.hxg}},Dqf:{configurable:!0,enumerable:!0,get:function(){return this.Isg}},A4b:{configurable:!0,enumerable:!0,get:function(){return this.sng}},m5c:{configurable:!0,enumerable:!0,get:function(){return this.wng}}});Object(Hd.a)($e,"FiltersMenuData",null,[]);vm(Bf,$e);Object(Hd.a)(Bf,"AutoFilterFiltersMenuData",$e,[]);bf.TJj=[new $e(99,2,
0,null),new $e(100,2,1,null),new $e(0,3,0,null),new $e(171,2,2,null),new $e(173,2,4,null),new $e(0,3,0,null),new $e(175,2,6,null),new $e(176,2,7,null),new $e(0,3,0,null),new $e(107,0,0,null)];bf.KFi=[new $e(99,2,0,null),new $e(100,2,1,null),new $e(0,3,0,null),new $e(101,2,8,null),new $e(102,2,10,null),new $e(103,2,12,null),new $e(0,3,0,null),new $e(104,1,0,null),new Bf(105,1),new Bf(106,2),new $e(0,3,0,null),new $e(107,0,0,null)];bf.Gbh=[new $e(99,2,0,null),new $e(0,3,0,null),new $e(111,2,10,null),
new $e(112,2,8,null),new $e(103,2,12,null),new $e(0,3,0,null),new Bf(109,8),new Bf(108,9),new Bf(110,10),new $e(0,3,0,null),new Bf(114,11),new Bf(113,12),new Bf(115,13),new $e(0,3,0,null),new Bf(116,14),new Bf(117,15),new Bf(118,16),new $e(0,3,0,null),new Bf(119,17),new Bf(120,18),new Bf(121,19),new $e(0,3,0,null),new Bf(122,20),new Bf(123,21),new Bf(124,22),new $e(0,3,0,null),new Bf(125,23),new $e(126,2,12,[new Bf(127,24),new Bf(128,25),new Bf(129,26),new Bf(130,27),new $e(0,3,0,null),new Bf(131,
28),new Bf(132,29),new Bf(133,30),new Bf(134,31),new Bf(135,32),new Bf(136,33),new Bf(137,34),new Bf(138,35),new Bf(139,36),new Bf(140,37),new Bf(141,38),new Bf(142,39)]),new $e(0,3,0,null),new $e(107,0,0,null)];Object(Hd.a)(bf,"Constants",null,[]);var k=b(19);pg.prototype.compare=function(d,w){return k.a.compare(d,w,!0)};Object(Hd.a)(pg,"IgnoreCaseComparer",null,[790]);var E=b(71),M=qg.a;vm(vf,M);vf.prototype.executeCommand=function(d,w,I){d=w.command;switch(d){case -699941697:this.applyAutoFilterFieldList(w,
I);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");break;case -1494291901:break;default:return Dg.a(d)}return Vf.Task.Ta(!0)};vf.prototype.Tdd=function(d,w){return!d||d.length<=w?(Fd.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(d[w],10)};vf.prototype.vFd=function(d,w,I,ha,wa,$a){var Tb=this.Tdd(wa,$a);0>Tb&&Fd.ULS.sendTraceTag(537167116,0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");
switch(He.Qad[Tb]){case 98:d=new eh.a(-2058042992,w.method,w.mode,w.af,w.tabName);this.fm.QG.ktb(this.$,ha,0,d);break;case 229:d=new eh.a(504133448,w.method,w.mode,w.af,w.tabName);this.fm.QG.ktb(this.$,ha,0,d);break;case 230:d=new eh.a(-798968736,w.method,w.mode,w.af,w.tabName);this.fm.QG.ktb(this.$,ha,0,d);break;case 231:d=new eh.a(-1677817820,w.method,w.mode,w.af,w.tabName);this.fm.QG.ktb(this.$,ha,0,d);break;case 94:this.CKf(d,w,ha,I,wa,$a+1);break;case 93:this.fm.QG.Pri(this.$,ha)}};vf.prototype.CKf=
function(d,w,I,ha,wa,$a){var Tb=this.Tdd(wa,$a);0>Tb&&Fd.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!ha||Tb>=ha.length)Fd.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(ha=ha[Tb],ha.A4b){case 1:this.fm.QG.hsi(this.$,I);break;case 2:(wa=Object(qc.a)(Bf,ha))?(d=new eh.a(-2058042992,w.method,w.mode,w.af,w.tabName),this.fm.QG.ktb(this.$,I,wa.wte,d)):this.fm.QG.Zkf(this.$,
d,I,ha.m5c);break;case 0:this.fm.QG.Zkf(this.$,d,I,ha.m5c);break;case 4:this.CKf(d,w,I,ha.subMenu,wa,$a+1)}};vf.prototype.applyAutoFilterFieldList=function(d,w){var I=w[Bb.a.CI];if(I)if(I=I.split(va.a.TU),3>I.length)Fd.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var ha=this.Tdd(I,1),wa=this.iKa(ha),$a=this.xqf(ha).returnValue;$a?this.vFd(w,d,$a,wa,I,2):Fd.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+
ha.toString()+va.a.TU)}else Fd.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};vf.prototype.Jc=function(d,w){if(d=this.$.isEditMode)switch(w.command){case 216058793:break;case -699941697:break;case -1494291901:d=!0;break;default:d=!1}return d};vf.prototype.HO=function(d,w,I){this.$.isEditMode&&((this.fm=Object(qc.a)(783,I))||Fd.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),
this.YY(),M.prototype.HO.call(this,d,w,null,null,!0))};vf.prototype.G3c=function(){if(!this.fm||!this.fm.Ek||1!==this.fm.Ek.length)return Fd.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;var d=this.fm.Ek[0],w=new W.a;w.add(te.a.instance.fa(247));w=E.OBc(E.concat(w,E.select(E.asEnumerable(d.FieldInfoDataList),function(I){return I.Name})),function(I){return I},new pg);return E.toArray(w)};vf.prototype.fieldIndex=function(d){if(!this.fm||
!this.fm.Ek||1!==this.fm.Ek.length||!this.fm.Ek[0].FieldInfoDataList)return-1;for(var w=0;w<this.fm.Ek[0].FieldInfoDataList.length;++w)if(this.fm.Ek[0].FieldInfoDataList[w].Name===d)return w;return-1};vf.prototype.iKa=function(d){return 0>d||!this.fm||!this.fm.Ek||1!==this.fm.Ek.length||!this.fm.Ek[0].FieldInfoDataList||this.fm.Ek[0].FieldInfoDataList.length<d?null:this.fm.Ek[0].FieldInfoDataList[d].Name};vf.prototype.YY=function(){var d=this,w=this.G3c();if(!w||!w.length)return null;for(var I=this.Sa,
ha=I.Mc(),wa={},$a=0;$a<w.length;wa={Vfb:wa.Vfb},++$a){var Tb=w[$a];wa.Vfb=0<$a?this.fieldIndex(Tb):-1;for(var Ic=vf.X5f+wa.Vfb.toString()+va.a.TU,pc=null,vd=this.fm.QG.o6h(0<$a?Tb:null),ne=this.Q3c(I,vd,vf.X5f+wa.Vfb.toString(),Tb),Pe={},Af=0;Af<He.Qad.length;Pe={UOb:Pe.UOb,Ufb:Pe.Ufb},++Af){var Wf=He.Qad[Af],Of=Ic+Af.toString();pc||(pc=I.Mc());switch(Wf){case 229:Array.add(pc.buttons,I.ed(223,Of,-699941697,this.fm.QG.Nni(0<$a?Tb:null)?N.a.rua:N.a.h4,8,229,!1,null));break;case 230:Array.add(pc.buttons,
I.ed(224,Of,-699941697,this.fm.QG.Oni(0<$a?Tb:null)?N.a.sua:N.a.i4,8,230,!1,null));break;case 231:Array.add(pc.buttons,I.ed(225,Of,-699941697,N.a.o8b,1,231,!1,null));break;case 98:Wf=this.uRg(Tb);Of=I.zHa(Of+(vd?".enabled":".disabled"),Wf,-699941697,null,"None",null,!vd,void 0,!0);Of.tS("Image16by16",8,N.a.m2a);Array.add(pc.buttons,Of);break;case 94:Pe.UOb=void 0;Pe.Ufb=void 0;var xg=function(oi,Sh){return function(){var mj=d.xqf(oi.Vfb);Sh.UOb=mj.VTe;Sh.Ufb=mj.isChecked;return mj}}(wa,Pe)().returnValue;
if(!xg)return null;Wf=this.Q3c(I,Pe.Ufb&&vd,Of,Pe.UOb);Of=this.iXe(Wf.menu,I,Of+va.a.TU,xg,Pe.Ufb&&vd);Array.add(Wf.menu.zc,Of);Array.add(pc.buttons,Wf);break;case 0:pc&&(Array.add(ne.menu.zc,pc),pc=null);break;default:Of=I.zHa(Of,te.a.instance.fa(Wf),-699941697,null,"None",null,!1,void 0,!0),this.hZf(Of,vd&&93===Wf&&this.fm.QG.filter(),te.a.instance.fa(Wf)),Array.add(pc.buttons,Of)}}Array.add(ne.menu.zc,pc);Array.add(ha.buttons,ne)}w=I.Lp(this.menuId);Array.add(w.zc,ha);return w};vf.prototype.iXe=
function(d,w,I,ha,wa){for(var $a=null,Tb=0;Tb<ha.length;++Tb){var Ic=ha[Tb],pc=I+Tb.toString(),vd=!1;switch(Ic.A4b){case 1:vd=wa&&this.fm.QG.Ph.IsTop10;break;case 2:vd=Object(qc.a)(Bf,Ic);vd=wa&&this.fm.QG.nhi(vd?vd.wte:0,Ic.m5c);break;case 0:vd=wa&&this.fm.QG.Ph.IsCustomSupportedAndNotPresent}$a||($a=w.Mc());if(Ic.Aki)$a&&(Array.add(d.zc,$a),$a=null);else if(Ic.aoi){var ne=te.a.instance.fa(Ic.Dqf);ne=this.Q3c(w,vd,pc,ne);Array.add(ne.menu.zc,this.iXe(ne.menu,w,pc+va.a.TU,Ic.subMenu,vd));Array.add($a.buttons,
ne)}else Ic=te.a.instance.fa(Ic.Dqf),pc=w.zHa(pc,Ic,-699941697,null,"None",null,!1,void 0,!0),this.hZf(pc,vd,Ic),Array.add($a.buttons,pc)}return $a};vf.prototype.hZf=function(d,w,I){w?d.tS("Image16by16",8,N.a.jaa):d.tS("None",0,null);d.rS(I);d.label=I};vf.prototype.Q3c=function(d,w,I,ha){return w?d.I3c(I,this.menuId,ha,798637440,8,N.a.jaa):d.Wv(I,this.menuId,ha,798637440)};vf.prototype.oi=function(d){return!d||!d.length};vf.prototype.xqf=function(d){var w=0>d?0:this.fm.Ek[0].FieldInfoDataList[d].MajorityDataTypeForField;
var I=null;d=this.fm.QG.n6h(w);switch(w){case 0:I=95;w=bf.TJj;break;case 1:I=94;w=bf.KFi;break;case 2:I=96;w=bf.Gbh;break;default:return Fd.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,VTe:I,isChecked:d}}I=te.a.instance.fa(I);return{returnValue:w,VTe:I,isChecked:d}};vf.prototype.uRg=function(d){!d||this.oi(d.trim())?d=te.a.instance.fa(97):d.length>He.MTe?(d=d.substring(0,He.MTe),d=String.format(te.a.instance.Cb(154),
d)):d=String.format(te.a.instance.Cb(155),d);return d};Sk.Object.defineProperties(vf.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.EMf}}});vf.TAh=Ca.a.p2g;vf.gIb="AutoFilterFieldListContextMenuRoot";vf.X5f="ApplyAutoFilterFieldList.";Object(Hd.a)(vf,"AutoFilterFieldListContextMenu",qg.a,[]);var aa=b(571),na=b(976),qb=b(9),Pb=b(115),Jc=b(372),ad=qg.a;vm(wf,ad);wf.prototype.executeCommand=
function(d,w,I){d=Object(qc.a)(aa.a,I.eventArgs);switch(w.command){case -1372040782:I=Ne.g(this.$).ha.Pa.lc;Fd.ULS.shipAssertTag(537167048,0,!!I);I&&(this.floatingObject=I.floatingObject,this.yb=w.method,w=this.tac(d),this.Eo(w,!0,d.yb));break;case 848910589:d&&(w=[na.a.w1f],d=new Sys.UI.Point(d.Ea.clientX,d.Ea.clientY),this.showFloatie(w,new Sys.UI.Bounds(d.x,d.y,0,0),2))}return Vf.Task.Ta(!0)};wf.prototype.Jc=function(d,w,I){switch(w.command){case -1372040782:return!!I&&this.kif(d);case 848910589:return d=
Ne.g(this.$).ha.Pa.lc,!!I&&!!d&&d.isEditing;default:return!1}};wf.prototype.kif=function(d){switch(d){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};wf.prototype.fUc=function(d,w,I){Jc.a(this.$)?Ne.g(this.$).$a.aj||(pf.a(this.$).lRd()?Array.add(I.buttons,d.Bb(265)):Array.add(I.buttons,d.Bb(264))):(this.$.isEditMode&&3===this.yb&&!this.U9b()&&Array.add(I.buttons,d.Bb(101)),5!==this.floatingObject.type||Pb.a.IH(this.floatingObject.Hb)||this.floatingObject.Hb.IsGroup||(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&
this.zqd()?Array.add(I.buttons,d.Bb(186)):Array.add(I.buttons,d.Bb(147))),this.U9b()||this.zqd()||Array.add(I.buttons,d.Bb(146)),ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.fHh(I),this.DIh(I)),ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&0===this.floatingObject.type&&Array.add(I.buttons,d.Bb(287)),ye.EwaSettings.la(167)&&0===this.floatingObject.type&&Array.add(I.buttons,d.Bb(249)),5===this.floatingObject.type&&Ne.g(this.$).ha.Pa.lc.w5()&&
this.$.Qka&&this.$.lha&&Array.add(I.buttons,d.Bb(273)))};wf.prototype.jKa=function(d){var w=[];if(Jc.a(this.$))return w;3===d?(d=!!this.$.jg.get(5)&&this.floatingObject.rUd(),this.U9b()||(this.$.isEditMode?(d&&Array.add(w,na.a.bEh),5===Ne.g(this.$).ha.Pa.pC.floatingObject.type&&Array.add(w,na.a.kwj)):d&&Array.add(w,na.a.copy)),Array.add(w,na.a.cEh)):2===d&&(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?Ne.g(this.$).ha.Pa.lc&&this.a1e(Ne.g(this.$).ha.Pa.lc,
w):this.a1e(Ne.g(this.$).ha.Pa.pC,w));return w};wf.prototype.YY=function(){var d=this.Sa,w=d.Lp(this.menuId),I=Jc.a(this.$);if(this.$.isEditMode){var ha=d.Mc();this.fUc(d,w,ha);Array.add(w.zc,ha)}this.$.jg.get(5)&&this.floatingObject.rUd()&&!this.U9b()&&!I&&(ha=d.Mc(),this.WAg(d,ha),Array.add(w.zc,ha));!ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||0!==this.floatingObject.type||this.$.ea.isNamedObjectViewMode||I||this.$.isMobileMode||(I=d.Mc(),this.QCg(d,I),
Array.add(w.zc,I));return w};wf.prototype.tac=function(d){var w=Ne.g(this.$).ha.Pa.lc;d=d&&1!==d.yb&&d.clientPoint?d.clientPoint:Sys.UI.DomElement.getLocation(w.domElement);var I=this.$.domElement,ha=Ne.g(this.$).rtl;(w=qb.HelperMethods.YA(w.Eg.domElement,I,ha))?(d.y=Math.max(d.y,w.y),d.x=Math.max(d.x,w.x)):Fd.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",zg.AFrameworkApplication.Ig);
return d};wf.prototype.zqd=function(){var d=Ne.g(this.$).ha.Pa.lc;return!!d&&d.isEditing};wf.prototype.WAg=function(d,w){if(this.$.isEditMode){Array.add(w.buttons,d.Bb(42));Array.add(w.buttons,d.Bb(43));var I=this.$.da.Aa(254,!0);(I&&2===I.CAb()||ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.zqd())&&Array.add(w.buttons,d.Bb(44))}else Array.add(w.buttons,d.Bb(43))};wf.prototype.QCg=function(d,w){Array.add(w.buttons,d.Bb(274))};wf.prototype.U9b=function(){return ye.EwaSettings.la(486)&&
!!Ne.g(this.$).ha.Pa.Fo};wf.prototype.a1e=function(d,w){5===d.floatingObject.type?ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&d.isEditing?Array.add(w,na.a.w1f):Array.add(w,na.a.gwj):Array.add(w,qg.a.YUe)};wf.prototype.fHh=function(d){var w=this.Sa.Mc();Array.add(w.buttons,this.Sa.Bb(282));Array.add(w.buttons,this.Sa.Bb(281));var I=this.Sa.Wv("BringToFront","BringToFrontMenuId",te.a.instance.fa(805),-1777747317);Array.add(I.menu.zc,w);Array.add(d.buttons,I)};wf.prototype.DIh=
function(d){var w=this.Sa.Mc();Array.add(w.buttons,this.Sa.Bb(284));Array.add(w.buttons,this.Sa.Bb(283));var I=this.Sa.Wv("SendToBack","SendToBackMenuId",te.a.instance.fa(806),-1777747317);Array.add(I.menu.zc,w);Array.add(d.buttons,I)};Sk.Object.defineProperties(wf.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.MMf}}});Object(Hd.a)(wf,"FloatingObjectContextMenu",qg.a,[]);var ia=b(922),
Qa=b(96),Nb=b(578),tc=b(523),gd=Ca.a.s2g;vm(af,wf);af.prototype.executeCommand=function(d,w,I){var ha=this.$;this.yb=w.method;w=I[af.V_c];if(!(d&68)){if(!w){if(8===d)w=tc.a(ha).Xc;else{var wa=Ne.g(ha).ha.Pa.lc;if(null===wa||void 0===wa?0:wa.floatingObject)w=wa.floatingObject.Xc}if(!w)return Vf.Task.Ta(!0)}this.isPivotChart=!!(w.Attributes&4)}if(this.isPivotChart||ha.isEditMode)if(this.refresh=this.oZ=this.awa=this.JAa=!1,wa=Ne.g(this.$).ha.Pa.lc,Fd.ULS.shipAssertTag(537167107,0,!!wa),wa){this.floatingObject=
wa.floatingObject;wa=Nb.a(ha);if(null===wa||void 0===wa?0:wa.HQd)this.JAa=wa=Qa.f(ha.lg),this.awa=!wa;wa=ha.nc;this.oZ=!!ia.a(ha)&&!!w&&!!(w.Attributes&512)&&!(d&8)&&wa.L2(32768);wa.allowManualDataRefresh&&wa.allowInteractivity&&(this.refresh=!0);d=this.tac(Object(qc.a)(aa.a,I.eventArgs));this.Eo(d,!0)}return Vf.Task.Ta(!0)};af.prototype.Jc=function(d,w,I){return-149612405===w.command&&!!I&&this.kif(d)};af.prototype.fUc=function(d,w,I){this.isPivotChart&&(this.refresh&&Array.add(I.buttons,d.Bb(100)),
this.oZ&&Array.add(I.buttons,d.Bb(99)),this.JAa?Array.add(I.buttons,d.Bb(59)):this.awa&&Array.add(I.buttons,d.Bb(58)));wf.prototype.fUc.call(this,d,w,I)};Sk.Object.defineProperties(af.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.GMf}}});Sk.Object.defineProperties(af,{V_c:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(Hd.a)(af,"ChartContextMenu",wf,[]);var Rc=
b(11),Xd=Ca.a.u2g,pe=qg.a;vm(Nf,pe);Nf.prototype.executeCommand=function(d,w,I){d=w.command;switch(d){case 330754562:w=I.domElement;this.isOlap=I.isOlap;this.ML=I.versionkey;this.mo=I.fieldItem;this.WZ=I.isChart;this.QH=I.isPpm;this.tUd="supportsImplicitMeasures"in I?I.supportsImplicitMeasures:!1;Ne.g(this.$).Rq(!0);d=Rc.DOMElementExtensions.getBounds(w);d=new Sys.UI.Point(d.x+d.width,d.y+d.height/2);this.ITa(d,w);"isKeyboardInput"in I&&I.isKeyboardInput?this.Eo(d,!1,1):this.Eo(d,!1);break;case 926905850:this.tUd&&
this.mo&&5===this.mo.TypeTag&&!this.mo.IsCollapsible&&Fd.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");Nb.a(this.$).dH(this.mo,8,-1,this.ML,w);break;case -67292059:Nb.a(this.$).dH(this.mo,1,-1,this.ML,w);break;case 745182485:Nb.a(this.$).dH(this.mo,2,-1,this.ML,w);break;case 359279088:Nb.a(this.$).dH(this.mo,4,-1,this.ML,w);break;case 547535945:Nb.a(this.$).$5i(this.mo);break;default:return Dg.a(d)}return Vf.Task.Ta(!0)};Nf.prototype.Jc=function(d,w,I){d=!1;switch(w.command){case 330754562:d=
!!I;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:d=!0}return d};Nf.prototype.YY=function(){var d=this.Sa.Lp(this.menuId);this.K_i(d);this.WZ||this.isOlap||this.J_i(d);return d};Nf.prototype.K_i=function(d){var w=this.Sa,I=w.Mc(),ha=!1;ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(ha=this.isOlap&&!this.QH&&this.tUd&&5===this.mo.TypeTag&&!this.mo.IsCollapsible);3!==this.mo.TypeTag&&37!==this.mo.TypeTag||this.mo.IsSet?17===
this.mo.TypeTag||this.QH?(Array.add(I.buttons,w.Bb(79)),Array.add(I.buttons,w.Bb(this.WZ?91:80)),Array.add(I.buttons,w.Bb(this.WZ?92:81)),Array.add(I.buttons,w.Bb(82))):13===this.mo.TypeTag||this.mo.IsSet?(Array.add(I.buttons,w.Bb(83)),Array.add(I.buttons,w.Bb(this.WZ?91:80)),Array.add(I.buttons,w.Bb(this.WZ?92:81)),Array.add(I.buttons,w.Bb(86))):(Array.add(I.buttons,w.Bb(79)),Array.add(I.buttons,w.Bb(this.WZ?91:80)),Array.add(I.buttons,w.Bb(this.WZ?92:81)),Array.add(I.buttons,w.Bb(ha?82:86))):(Array.add(I.buttons,
w.Bb(83)),Array.add(I.buttons,w.Bb(this.WZ?93:84)),Array.add(I.buttons,w.Bb(this.WZ?94:85)),Array.add(I.buttons,w.Bb(82)));Array.add(d.zc,I)};Nf.prototype.J_i=function(d){var w=this.Sa.Mc();Array.add(w.buttons,this.Sa.Bb(78));Array.add(d.zc,w)};Sk.Object.defineProperties(Nf.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.EGd}}});Object(Hd.a)(Nf,"FieldListContextMenu",qg.a,[]);var cf=b(411),
ef=b(61);ce.prototype.get=function(d,w,I){var ha=this.Rag(d,"PivotFilterContextMenuCache.Get");return ha&&this.AN[ha]?this.AN[ha][ce.Mfd(w,this.$,d,I)]:null};ce.prototype.set=function(d,w,I,ha){var wa=this.Rag(d,"PivotFilterContextMenuCache.Set");wa&&(this.AN[wa]||(this.AN[wa]={}),this.AN[wa][ce.Mfd(w,this.$,d,ha)]=I)};ce.prototype.a7b=function(d){d in this.AN&&this.AN[d]&&(this.AN[d]=null)};ce.prototype.Rag=function(d,w){return ef.f(this.$.pa)?this.$.activeItemName:(d=this.mOj(d,w))?d.Xd:null};ce.prototype.mOj=
function(d,w){d=td.C(d);d=Ne.g(this.$).Ca.qva(d,this.$.activeItemName);Fd.ULS.shipAssertTag(537167008,0,!!d,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",w);return d};ce.Mfd=function(d,w,I,ha){return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&0===ha?w.pa.index+"_"+d.id+"_"+I.FirstRow.toString()+"_"+I.FirstColumn.toString():w.pa.index+"_"+d.id};Object(Hd.a)(ce,
"PivotFilterContextMenuCache",null,[]);Object(Hd.a)(Le,"ShowPivotFilterData",null,[]);var jf=b(575),yf=b(1273),Eg=b(53),rh=Ca.a.sCe,Eh=qg.a;vm(Ud,Eh);Ud.prototype.L$c=function(d,w){var I=this,ha=d.rawEvent,wa=d.cell,$a=d.requiresConfirmation;jf.a(this.$).Eu($a,function(Tb){if(Tb){Tb=ha?new Sys.UI.DomEvent(ha):null;I.pivotData=new Le;I.pivotData.pivotName=d.pivotName;I.pivotData.dataSourceIndex=d.dataSourceIndex;I.pivotData.cell=wa;I.pivotData.zo=d.optionalPivotMenuAnchorParameter;if(I.pivotData.zo&&
0<I.pivotData.zo.AnchorType){I.imc=d.objectId;I.NCb=d.objectVersion;var Ic=I.pivotData.zo.AnchorType;if(4===Ic||5===Ic||6===Ic||11===Ic||9===Ic||10===Ic||8===Ic)I.tmb=d.location}else I.Qyd=I.imc=null,I.Ryd=I.NCb=-1;Ne.g(I.$).Rq(!0);I.$.Cj(wa);I.HO(Tb,Tb?Tb.target:d.domElement,I.pivotData,w,I.dMa())}});return!0};Ud.prototype.HO=function(d,w,I,ha){var wa=this;if(Object(cf.a)(Le,I)){this.pivotData=I;this.N4b=w;this.fkf=d;this.I1b=this.pivotData.zo?this.pivotData.zo.AnchorValue1:-1;this.yY=this.pivotData.zo?
this.pivotData.zo.AnchorType:0;var $a=!1,Tb=null;Tb=Ud.AN.get(this.pivotData.cell,w,this.yY);$a=!!Tb;var Ic=!0;switch(this.yY){case 4:case 5:case 6:this.Zca=new Sys.UI.Point(this.tmb.x,this.tmb.y);Ic=!1;break;case 7:var pc=Sys.UI.DomElement.getBounds(w);Ic=pc.x+(0<=pc.x?0:pc.width);pc=pc.y+(0<=pc.y?0:pc.height);this.Zca=new Sys.UI.Point(0<=Ic?Ic:0,0<=pc?pc:0);Ic=!1;break;case 8:case 10:case 9:case 11:this.Zca=new Sys.UI.Point(this.tmb.x,this.tmb.y);break;default:this.Zca=null}$a&&this.imc===this.Qyd&&
this.NCb===this.Ryd&&this.I1b===this.hye&&this.yY===this.hqe?(Fd.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.T0a=Tb,this.Zca?(this.ITa(this.Zca,w),this.Eo(this.Zca,this.dMa())):this.qw?(!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")||qg.a.Ffc(this.$,this.pivotData.cell))&&this.Eo(qg.a.uac(this.$,this.pivotData.cell,!1),this.dMa()):Eh.prototype.HO.call(this,d,w,I,ha,this.dMa())):
1!==Ud.VPh(w)&&(Ic&&(w.parentNode.menuFetchStates=1,this.Dqj(w),this.QYf(!0)),this.$.userOperationManager.hc(new Uf.a(126,0,function(vd,ne,Pe){var Af=wa.$;return jg.A(Af.na.ta,wa.pivotData.cell,wa.pivotData.dataSourceIndex,wa.pivotData.pivotName,Af.domElement.id,Af.isChromeRtl,Af.workbookContext.NovMode,Jf.b(vd,wa.IMi),Jf.a(ne,wa.HMi),Pe,w,wa.pivotData.zo)},16),ha))}};Ud.prototype.QDd=function(d){Array.addRange(d.MenuSectionList,this.T0a)};Ud.prototype.Qvd=function(d,w){d.parentNode.menuFetchStates=
2;this.QYf(!1);if(w){if(this.N4b!==d||this.GAi())this.ITa(this.Zca,d),this.Eo(this.Zca,this.dMa());else if(this.qw&&!this.Zca){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6053383_EnsureContextMenuCellInView")&&!qg.a.Ffc(this.$,this.pivotData.cell))return;this.Eo(qg.a.uac(this.$,this.pivotData.cell,!1),this.dMa())}else Eh.prototype.HO.call(this,this.fkf,d,null,null,this.dMa());this.Qyd=this.imc;this.Ryd=this.NCb;this.hqe=this.yY;this.hye=this.I1b}};Ud.prototype.dMa=function(){return 8!==this.yY&&
9!==this.yY&&10!==this.yY&&11!==this.yY};Ud.prototype.GAi=function(){switch(this.pivotData.zo?this.pivotData.zo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};Ud.prototype.QYf=function(d){var w=this.N4b;if(w){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var I=Rc.DOMElementExtensions.CZ(w,"ewaprevsrc","");I=!!I&&"null"!==I}else I=!!Rc.DOMElementExtensions.CZ(w,"ewaprevsrc","");d&&I||!d&&!I||(d?(w.setAttribute("ewaprevsrc",
w.src),w.src=Eg.a.current.ro(77)):(d=Rc.DOMElementExtensions.CZ(w,"ewaprevsrc",""),w.src=d,w.setAttribute("ewaprevsrc",null)))}};Ud.prototype.Dqj=function(d){this.N4b=d};Ud.VPh=function(d){var w=d.parentNode.menuFetchStates;void 0===w&&(d.parentNode.menuFetchStates=0);return w};Ud.AN=null;Object(Hd.a)(Ud,"PivotFilterContextMenuBase",qg.a,[]);var Qg="FieldList"+Ca.a.sCe;vm(dd,Ud);dd.prototype.executeCommand=function(d,w,I){return this.L$c(I,w)?Vf.Task.Ta(!0):Dg.a(w.command)};dd.prototype.Jc=function(d,
w,I){return-1065117584===w.command&&!!I};Sk.Object.defineProperties(dd.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.KMf}}});Object(Hd.a)(dd,"FieldListPivotContextMenu",Ud,[]);var Ng=b(29),Hh=b(851);Object(Hd.a)(Kc,"PivotValueFieldSettingsApplyData",null,[]);ac.mbh="dataFieldCustomLabel";ac.tGe="dataFieldSourceLabel";ac.vSd="showValueAsSelect";ac.tSd="showValueAsBaseFieldSelect";ac.uSd=
"showValueAsBaseItemSelect";ac.DZd="valueFieldsSettingsFieldName";ac.Wfg="valueFieldSettingTabs";Object(Hd.a)(ac,"CssElementIds",null,[]);var Tg=b(112);Object(Hd.a)(qe,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);Md.prototype.getActiveCell=function(){return this.activeCell};Object(Hd.a)(Md,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[147]);var tg=b(230);Object(Hd.a)(yd,"PivotValueFieldShowValueAsApplyData",null,[]);var ii=b(852),Ki=b(41),$i="<div id='showValueAsControlBody'><label for='"+
ac.vSd+"' class='"+Tg.a.ko+" valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='"+ac.vSd+"' class='"+Tg.a.xC+"'></select></div><div class='showValueAsControlSelectRegion'><label for='"+ac.tSd+"'>{1}</label><div><select size=6 id='"+ac.tSd+"' class='"+Tg.a.xC+"'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='"+ac.uSd+"'>{2}</label><div><select size=6 id='"+ac.uSd+"' class='"+Tg.a.xC+"'></select></div></div></div>",
Y=tg.a;vm(Vc,Y);Vc.prototype.Yja=function(){return this.isVisible};Vc.prototype.Hna=function(d){return this.isVisible=d};Vc.prototype.setFocus=function(){Rc.DOMElementExtensions.setFocus(this.E3.Rn)};Vc.prototype.render=function(d){d.appendChild(this.domElement)};Vc.prototype.dispose=function(){eg.a.rc([this.E3,this.gU,this.$P,this.p5b,this.$_b]);Y.prototype.dispose.call(this)};Vc.prototype.jtj=function(d){eg.a.rc([this.p5b,this.$_b]);this.E3.clear();for(var w=yl(d.DataFormatTypes),I=w.next();!I.done;I=
w.next())I=I.value,this.E3.oM(Vc.gOh(I),I.toString(),I===d.SelectedDataFormat);this.p5b=this.Pd.Dd(this.E3.domElement);this.p5b.ja("change",this.Owf);this.gU.clear();w=yl(d.BaseFieldList);for(I=w.next();!I.done;I=w.next())I=I.value,this.gU.oM(I.DisplayString,I.Id.toString(),I.Id===d.SelectedBaseField);this.$_b=this.Pd.Dd(this.E3.domElement);this.$_b.ja("change",this.FHi);this.wF=this.kia.H0a(this.$P.Rn.parentNode,1E3,null,"",723);this.Owf(null)};Vc.prototype.eR=function(d){this.E3.eR(d);this.gU.eR(d);
this.$P.eR(d)};Vc.prototype.ska=function(){this.domElement.innerHTML=String.format($i,te.a.instance.fa(1073),te.a.instance.fa(1074),te.a.instance.fa(1075));this.M4d=new ii.a(Rc.DOMElementExtensions.getElementById(this.domElement,ac.vSd),!1);this.i2d=new ii.a(Rc.DOMElementExtensions.getElementById(this.domElement,ac.tSd),!1);this.j2d=new ii.a(Rc.DOMElementExtensions.getElementById(this.domElement,ac.uSd),!1)};Vc.prototype.PUg=function(d){return this.Tki||!Vc.Ncf(d)&&!Vc.Ocf(d)?!0:!!this.gU.count};
Vc.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var d=this;this.$.userOperationManager.hc(new Uf.a(108,0,function(w,I,ha){var wa=d.$.na.ta,$a=parseInt(d.gU.qe.value,10);w=Jf.b.call(null,w,d.FNi);var Tb=jg.nb(wa,d.cell,d.externalSourceIndex,d.zo);Tb.selectedBaseField=$a;return jg.i(wa,"GetPivotValueFieldSettingsShowValueAsBaseItems",Tb,w,I,ha,null,4)},16),this.ae)};Vc.prototype.Nlf=function(){this.$P.clear();this.gU.qe&&(this.wF.RAa(),this.$P.Rn.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};
Vc.prototype.oNb=function(d){var w=document.getElementById("WACDialogActionButton");this.wTj&&w&&(w.disabled=d)};Vc.gOh=function(d){switch(d){case 0:return te.a.instance.fa(1076);case 1:return te.a.instance.fa(1077);case 2:return te.a.instance.fa(1078);case 3:return te.a.instance.fa(1079);case 4:return te.a.instance.fa(1080);case 5:return te.a.instance.fa(1081);case 6:return te.a.instance.fa(1082);case 7:return te.a.instance.fa(1083);case 8:return te.a.instance.fa(1085);case 9:return te.a.instance.fa(1086);
case 10:return te.a.instance.fa(1087);case 11:return te.a.instance.fa(1088);case 12:return te.a.instance.fa(1089);case 13:return te.a.instance.fa(1090);case 14:return te.a.instance.fa(1091);default:return""}};Vc.Ncf=function(d){return 11===d||12===d||14===d||13===d||4===d};Vc.Ocf=function(d){return 1===d||3===d||2===d};Sk.Object.defineProperties(Vc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return te.a.instance.fa(1072)}},Cvb:{configurable:!0,enumerable:!0,get:function(){var d=
this.E3.qe?parseInt(this.E3.qe.value,10):-1,w=this.gU.qe?parseInt(this.gU.qe.value,10):-1,I=this.$P.qe?parseInt(this.$P.qe.value,10):-1;return Object.assign(new yd,{SelectedDataFormat:0<=d?d:-1,SelectedBaseField:w,SelectedBaseItem:I})}},gU:{configurable:!0,enumerable:!0,get:function(){return this.i2d}},$P:{configurable:!0,enumerable:!0,get:function(){return this.j2d}},E3:{configurable:!0,enumerable:!0,get:function(){return this.M4d}}});Object(Hd.a)(Vc,"ShowValueAsControl",tg.a,[802,3]);Object(Hd.a)(uc,
"PivotValueFieldSummarizeValueByApplyData",null,[]);var Ra="<div id='summarizeValuesByControlBody'><label class='"+(Tg.a.ko+" valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='")+(Tg.a.ko+" summarizeValuesByControlDescription'>{1}</div><div><select class='")+(Tg.a.xC+"' size=6 id='pivotDataFieldSelect' style='width: 100%' "+Ca.a.BJ+"='pivotDataFieldSelectDescription'></select></div></div>"),xb=tg.a;vm(Db,xb);Db.prototype.Yja=function(){return this.isVisible};
Db.prototype.Hna=function(d){return this.isVisible=d};Db.prototype.setFocus=function(){Rc.DOMElementExtensions.setFocus(this.al.Rn)};Db.prototype.render=function(d){d.appendChild(this.domElement)};Db.prototype.dispose=function(){eg.a.Fa(this.al);xb.prototype.dispose.call(this)};Db.prototype.focus=function(){Rc.DOMElementExtensions.setFocus(this.al.Rn)};Db.prototype.itj=function(d){this.al.rTd();for(var w=yl(d.AggregationTypes),I=w.next();!I.done;I=w.next()){I=I.value;var ha=I===d.SelectedAggregation;
this.al.cUc(Db.PJh(I),I.toString(),ha,"")}this.al.q8c();this.al.Rn.disabled=d.AggregationsDisabled};Db.prototype.Cij=function(){this.al.Dij()};Db.prototype.ska=function(){this.domElement.innerHTML=String.format(Ra,te.a.instance.fa(1056),te.a.instance.fa(1057));this.Ude=new ii.a(Rc.DOMElementExtensions.getElementById(this.domElement,Db.JHf),!1)};Db.PJh=function(d){switch(d){case 0:return te.a.instance.fa(1059);case 1:return te.a.instance.fa(1060);case 2:return te.a.instance.fa(1061);case 3:return te.a.instance.fa(1062);
case 4:return te.a.instance.fa(1063);case 5:return te.a.instance.fa(1064);case 6:return te.a.instance.fa(1065);case 7:return te.a.instance.fa(1066);case 8:return te.a.instance.fa(1067);case 9:return te.a.instance.fa(1068);case 10:return te.a.instance.fa(1069);case 11:return te.a.instance.fa(1070);default:return""}};Sk.Object.defineProperties(Db.prototype,{Cvb:{configurable:!0,enumerable:!0,get:function(){var d=this.al.qe?parseInt(this.al.qe.value,10):-1;return Object.assign(new uc,{Aggregation:0<=
d?d:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return te.a.instance.fa(1071)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.al.Rn.disabled},set:function(d){this.al.Rn.disabled=!d}},al:{configurable:!0,enumerable:!0,get:function(){return this.Ude}}});Db.JHf="pivotDataFieldSelect";Object(Hd.a)(Db,"SummarizeValuesByControl",tg.a,[802,3]);var fc=b(202),bd=b(463);La.prototype.EIj=function(d,w){d.set_visible(!1);w.set_visible(!0)};Object(Hd.a)(La,"DefaultTabSwitchBehaviour",
null,[821]);qh.qJj="TabsContainer";qh.$Ij="TabTitlesContainer";qh.YIj="TabTitle";qh.ZIj="TabTitleText";qh.QUd="TabTitleActive";Object(Hd.a)(qh,"MultitabControlStyles",null,[]);var Dd=b(38),Td=b(91),we=b(89),Oe=b(87);kg.prototype.dispose=function(){Dd.a.removeHandler(this.di,"keyup",Object(Sg.a)(this,this.W9a,"onTitleKeyUp"));Dd.a.removeHandler(this.di,"click",this.gGc);this.di=this.Lfa=null};kg.prototype.setActive=function(d){d?Sys.UI.DomElement.addCssClass(this.di,qh.QUd):Sys.UI.DomElement.removeCssClass(this.di,
qh.QUd);this.Lfa&&this.Lfa.setAttribute(we.a.nha,d)};kg.prototype.W9a=function(d){d.keyCode!==Td.a.$h&&d.keyCode!==Td.a.Noa||this.gGc(d)};kg.prototype.cBc=function(){this.di.setAttribute(we.a.Td,we.a.Rr);this.Lfa.setAttribute(we.a.Et,this.Dp);this.Lfa.setAttribute(we.a.Td,we.a.gob)};Sk.Object.defineProperties(kg.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return this.di}},title:{configurable:!0,enumerable:!0,get:function(){return this.Dp}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.di,
qh.QUd)},set:function(d){this.setActive(d)}}});Object(Hd.a)(kg,"TabTitleControl",null,[3]);var Te=b(47);uf.prototype.MRf=function(){this.emb=document.createElement("ul");this.emb.className=qh.$Ij;this.Vlb=document.createElement("div");this.Vlb.className=qh.qJj;for(var d=0;d<this.izc;++d){var w=this.lY.oa(d),I=this.WEa.oa(d);w.set_visible(!1);I.isActive=!1;var ha=document.createElement("div");w.render(ha);this.Vlb.appendChild(ha);this.emb.appendChild(I.Jb)}this.Jb.appendChild(this.emb);this.Jb.appendChild(this.Vlb);
this.Brd(this.r1)&&(this.WEa.oa(this.r1).isActive=!0,this.lY.oa(this.r1).set_visible(!0))};uf.prototype.dispose=function(){for(var d=0;d<this.izc;++d)this.lY.oa(d).dispose(),this.WEa.oa(d).dispose();this.WEa=this.lY=this.di=this.Vlb=this.emb=null};uf.prototype.setFocus=function(){this.lY.oa(this.r1).setFocus()};uf.prototype.Brd=function(d){return 0<=d&&d<this.izc};uf.prototype.D8f=function(d){this.r1!==d&&this.Brd(d)&&(this.oxg.EIj(this.lY.oa(this.r1),this.lY.oa(d)),this.WEa.oa(this.r1).isActive=
!1,this.WEa.oa(d).isActive=!0,this.r1=d,this.setFocus())};uf.prototype.q6g=function(d){var w=this;return function(){w.D8f(d)}};Sk.Object.defineProperties(uf.prototype,{izc:{configurable:!0,enumerable:!0,get:function(){return this.lY.count}},activeTab:{configurable:!0,enumerable:!0,get:function(){return this.r1},set:function(d){this.D8f(d)}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.di}},visible:{configurable:!0,enumerable:!0,get:function(){return Te.a.isVisible(this.di)},set:function(d){this.di.style.visibility=
d?"visible":"hidden"}}});Object(Hd.a)(uf,"MultitabControl",null,[801,3]);var Zf=Hh.a;vm(rg,Zf);rg.prototype.dispose=function(){this.z5c=this.Crb=this.mSa=this.FRc=null;eg.a.Fa(this.Yfa);this.Yfa=null;Zf.prototype.dispose.call(this)};rg.prototype.initialize=function(){var d="<div id='"+ac.tGe+"' class='"+Tg.a.ko+"'></div><div id='"+ac.mbh+"' class='"+Tg.a.ko+"'><label for='"+ac.DZd+"'>{0}</label><input type='text' id='"+ac.DZd+"' value='{1}' class='"+Tg.a.xC+" UIFont' /></div><div id='"+ac.Wfg+"'></div>";
d=String.format(d,te.a.instance.fa(1055),Ng.a.Lf(this.Vfg));this.Ob.innerHTML=d;this.Me||(this.C2(),this.Wk());this.Kje=[-103190598];this.$0h();Zf.prototype.initialize.call(this)};rg.prototype.close=function(d){1===d&&(this.w3f=!1);Zf.prototype.close.call(this,d)};rg.prototype.xIe=function(d){this.kR=d;this.domElement.disabled=d;for(var w=["input","option","select"],I=0,ha=w.length;I<ha;++I)for(var wa=this.domElement.getElementsByTagName(w[I]),$a=0;$a<wa.length;++$a)wa[$a].disabled=d};rg.prototype.Wk=
function(){this.Crb=document.getElementById(ac.DZd);this.z5c=Rc.DOMElementExtensions.getElementById(this.Ob,ac.tGe);var d=Rc.DOMElementExtensions.getElementById(this.Ob,ac.Wfg);this.FRc=new Db(document.createElement("div"));this.mSa=new Vc(document.createElement("div"),this.$,this.cell,this.zo,this.externalSourceIndex,this.ae,this.kia,!this.isOlap);var w;this.Yfa=new uf(d,(w=new W.a,w.add(this.RSa),w.add(this.mSa),w));this.Yfa.MRf()};rg.prototype.Vpc=function(){var d=new rg(this.cell,this.zo,this.externalSourceIndex,
this.Vfg,this.$,this.ae,this.kia,this.isOlap,this.QH);d.initialize();d.mf()};rg.prototype.$Ta=function(){var d=new bd.a;if(!this.w3f)return d.isValid=!0,d;this.Crb.value.length?d.isValid=!0:(this.xIe(!0),d.error=hh.a.hd(1,0,738,753,0,1783218700,"PivotTableValueFieldNoBlank"),this.kR=!0,this.Me||(this.tx.disabled=!0),d.isValid=!1);return d};rg.prototype.C6e=function(){this.kR=!1;this.Me||(this.tx.disabled=!1);this.xIe(!1)};rg.prototype.tya=function(d){var w=new eh.a(2105621672,0,this.$.gd,30,null);
this.$.Ka.Xb(w);this.UW(5,d.yb,"Number Format");return!0};rg.prototype.mm=function(){this.nBa=String.format(te.a.instance.Cb(60),null);Zf.prototype.mm.call(this)};rg.prototype.setFocus=function(){if(this.Me){var d=Rc.DOMElementExtensions.getElementById(this.Ob,Db.JHf);fc.a.CAc(d)}else this.Yfa.setFocus()};rg.prototype.Zl=function(){var d=this,w=this.mSa.Cvb,I=new qe(w.SelectedDataFormat,w.SelectedBaseField,w.SelectedBaseItem);return function(){return new Md(d.externalSourceIndex,d.cell,d.Crb.value,
d.RSa.Cvb.Aggregation,I)}};rg.prototype.ox=function(){var d=this,w=Object.assign(new Kc,{PivotValueFieldSummarizeValueByApplyData:this.RSa.Cvb,PivotValueFieldShowValueAsApplyData:this.mSa.Cvb,PivotValueFieldTitle:this.Crb.value});return function(I,ha,wa){var $a=d.$.na.ta;I=Jf.b(I,d.uHi);var Tb=jg.nb($a,d.cell,d.externalSourceIndex,d.zo);Tb.pivotValueFieldSettingsApplyData=w;return jg.i($a,"ApplyPivotValueFieldSettings",Tb,I,ha,wa,null,0)}};rg.prototype.eR=function(d){var w=this;this.$.da.Za(40,function(){w.mSa.eR(d)})};
rg.prototype.$0h=function(){var d=this;this.$.userOperationManager.hc(new Uf.a(123,0,function(w,I,ha){var wa=d.$.na.ta;w=Jf.b.call(null,w,d.ENi);var $a=jg.nb(wa,d.cell,d.externalSourceIndex,d.zo);return jg.i(wa,"GetPivotValueFieldSettingsInitial",$a,w,I,ha,null,4)},16),this.ae)};Sk.Object.defineProperties(rg.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},Mea:{configurable:!0,enumerable:!0,get:function(){return this.Kje}},lCb:{configurable:!0,enumerable:!0,
get:function(){return this.Yfa}},RSa:{configurable:!0,enumerable:!0,get:function(){return this.FRc}},Rw:{configurable:!0,enumerable:!0,get:function(){return 560}}});Object(Hd.a)(rg,"ValueFieldSettingsDialog",Hh.a,[]);var dg=Ca.a.v2g,Jg=qg.a;vm(Xf,Jg);Xf.prototype.executeCommand=function(d,w,I,ha){var wa=this;d=w.command;switch(d){case -1453503574:ha=I.domElement;this.mo=I.fieldItem;this.N_d=I.zoneCount;this.zSa=I.sourceAxis;this.kyc=I.sourceAxisPos;this.zo=I.optionalPivotMenuAnchorParameter;this.ML=
I.versionkey;this.isOlap=I.isOlap;this.QH=I.isPpm;this.y2a="fieldItemsupportsImplicitMeasures"in I?I.fieldItemsupportsImplicitMeasures:!1;this.cell=I.cell;this.externalSourceIndex=I.externalSourceIndex;Ne.g(this.$).Rq(!0);d=Rc.DOMElementExtensions.getBounds(ha);var $a=new Sys.UI.Point(d.x,d.y+d.height);this.$.isChromeRtl&&($a.x+=d.width);this.ITa($a,ha);"isKeyboardInput"in I&&I.isKeyboardInput?this.Eo($a,!1,1):this.Eo($a,!1);break;case 495005930:Nb.a(this.$).ufh();break;case -1170196828:Nb.a(this.$).dH(this.mo,
this.zSa,this.kyc-1,this.ML,w);break;case -889576107:Nb.a(this.$).dH(this.mo,this.zSa,this.kyc+2,this.ML,w);break;case 2033235475:Nb.a(this.$).dH(this.mo,this.zSa,this.N_d,this.ML,w);break;case 389774337:Nb.a(this.$).dH(this.mo,this.zSa,0,this.ML,w);break;case -96230454:Nb.a(this.$).dH(this.mo,4,-1,this.ML,w);break;case 74086617:Nb.a(this.$).dH(this.mo,1,-1,this.ML,w);break;case 1529312473:Nb.a(this.$).dH(this.mo,2,-1,this.ML,w);break;case 563292088:this.y2a&&Fd.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");
Nb.a(this.$).dH(this.mo,8,-1,this.ML,w);break;case -1092351914:Nb.a(this.$).dH(this.mo,0,-1,this.ML,w);break;case -2141589616:var Tb=Rg.GetServiceTaskFactory.Wa(this.$.da,12,477,ha.Rja());return Od.TaskExtensions.Ba(Tb,function(){(new rg(wa.cell,wa.zo,wa.externalSourceIndex,wa.mo.Name,wa.$,w,Tb.result,wa.isOlap,wa.QH)).initialize()},this.ma);default:return Dg.a(d)}return Vf.Task.Ta(!0)};Xf.prototype.Jc=function(d,w,I){d=!1;switch(w.command){case -1453503574:d=!!I;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:d=
!0}return d};Xf.prototype.YY=function(){var d=this.Sa.Lp(this.menuId);this.P_i(d,this.kyc,this.N_d);this.Q_i(d,this.zSa);this.R_i(d);8===this.zSa&&this.N_i(d);return d};Xf.prototype.P_i=function(d,w,I){var ha=this.Sa,wa=ha.Mc();w||w!==I-1?!w&&w<I-1?(Array.add(wa.buttons,ha.Bb(64)),Array.add(wa.buttons,ha.Bb(61)),Array.add(wa.buttons,ha.Bb(66)),Array.add(wa.buttons,ha.Bb(63))):0<w&&w<I-1?(Array.add(wa.buttons,ha.Bb(60)),Array.add(wa.buttons,ha.Bb(61)),Array.add(wa.buttons,ha.Bb(62)),Array.add(wa.buttons,
ha.Bb(63))):0<w&&w===I-1&&(Array.add(wa.buttons,ha.Bb(60)),Array.add(wa.buttons,ha.Bb(65)),Array.add(wa.buttons,ha.Bb(62)),Array.add(wa.buttons,ha.Bb(67))):(Array.add(wa.buttons,ha.Bb(64)),Array.add(wa.buttons,ha.Bb(65)),Array.add(wa.buttons,ha.Bb(66)),Array.add(wa.buttons,ha.Bb(67)));Array.add(d.zc,wa)};Xf.prototype.Q_i=function(d,w){var I=this.Sa,ha=I.Mc(),wa=1!==w&&(!this.isOlap||this.QH||8!==w||this.y2a),$a=2!==w&&(!this.isOlap||this.QH||8!==w||this.y2a),Tb=8!==w&&-2!==this.mo.PivotTableIndex&&
(!this.isOlap||this.QH||this.y2a);Array.add(ha.buttons,I.Bb(4===w||this.mo.IsSet||-2===this.mo.PivotTableIndex||this.isOlap&&!this.QH&&8===w&&!this.y2a?72:68));8===this.zo.AnchorType||10===this.zo.AnchorType?(Array.add(ha.buttons,I.Bb(wa?95:97)),Array.add(ha.buttons,I.Bb($a?96:98))):(Array.add(ha.buttons,I.Bb(wa?69:73)),Array.add(ha.buttons,I.Bb($a?70:74)));Array.add(ha.buttons,I.Bb(Tb?71:75));Array.add(d.zc,ha)};Xf.prototype.R_i=function(d){var w=this.Sa.Mc();Array.add(w.buttons,this.Sa.Bb(76));
Array.add(d.zc,w)};Xf.prototype.N_i=function(d){var w=this.Sa.Mc();Array.add(w.buttons,this.Sa.Bb(77));Array.add(d.zc,w)};Sk.Object.defineProperties(Xf.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.FGd}}});Object(Hd.a)(Xf,"FieldWellContextMenu",qg.a,[]);var Ug=b(1238);vm(Yf,Ud);Yf.prototype.executeCommand=function(d,w,I){var ha=!1,wa=w.command;switch(wa){case 37023044:ha=this.L$c(I,w);
break;case 541421805:case -569786022:ha=this.ijd(d,w)}return ha?Vf.Task.Ta(!0):Dg.a(wa)};Yf.prototype.Jc=function(d,w,I){d=!1;switch(w.command){case 37023044:d=!!I;break;case 541421805:case -569786022:d=!0}return d};Yf.prototype.ijd=function(d,w){var I=8===d,ha=this.$,wa=tc.a(ha),$a=Ne.g(ha).ha.Pa.lc,Tb=d=null;I&&wa?(d=wa.chartId,Tb=wa.Xc):!I&&$a&&(d=$a.floatingObject.id,Tb=$a.floatingObject.Xc);return Yf.ese(Tb,260)?(I={},ha.Cj(I),I.FirstColumn=I.FirstRow=-1,ha={},Tb=(ha.rawEvent=null,ha.pivotName=
null,ha.cell=I,ha.requiresConfirmation=Yf.ese(Tb,64),ha.dataSourceIndex=Tb.ExternalSourceIndex,ha),$a?(wa=$a.floatingObject,Tb.domElement=$a.domElement,Tb.objectId=wa.id,Tb.objectVersion=wa.version):wa&&(Tb.domElement=wa.Yj,Tb.objectId=wa.chartId,Tb.objectVersion=wa.jye),$a={AnchorType:7},$a.ChartId=d,$a.AnchorValue1=-1,$a.AnchorValue2=-1,Tb.optionalPivotMenuAnchorParameter=$a,this.L$c(Tb,w)):!1};Yf.ese=function(d,w){return(d.Attributes&w)===w};Sk.Object.defineProperties(Yf.prototype,{au:{configurable:!0,
enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.QMf}}});Object(Hd.a)(Yf,"PivotFilterContextMenu",Ud,[]);var Xh=b(1271),Ef=b(975),Th=b(150),sh=b(26),Mg=Ca.a.z2g,Hi=Mg+".RemoveField",R=Mg+".Subtotal",Aa=Mg+".ClearFilter",hb=Mg+".LayoutSameColumn",Ib=Mg+".LayoutNextColumn",Bc=qg.a;vm(Ze,Bc);Ze.prototype.executeCommand=function(d,w,I){w=w.command;d=null;this.grid=Ne.g(this.$);this.activeCell=td.o(this.grid.ha.va.activeCell,this.$);
if(this.$.isEditMode&&(this.Uc=this.grid.Rb.$o(this.grid.ha.va.activeCell),!this.Uc))return Fd.ULS.sendTraceTag(537167007,0,10,"No PivotTable range found."),Od.TaskExtensions.H4();this.RCc=this.$.na.ta;this.w0a=Object(qc.a)(aa.a,I.eventArgs);switch(w){case 671488277:!this.$.isEditMode||this.Uc.bgc||this.Uc.Vgc()&&!this.v2f(!1)?(this.ybb(),this.showPivotTableContextMenu()):this.LVh();break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,
6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,
10);break;case -771066011:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.ORa(0,0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.ORa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.ORa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.ORa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.ORa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;
case -1067664355:this.ORa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;case -2031744961:I=Number.parseInvariant(I.MenuItemId.split(".")[2]);this.ORa(11,I);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.xe(-1556797033,Kf.a.$b,8,null);break;case 1514686611:this.Wri();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:I=Number.parseInvariant(I.MenuItemId);
this.GYg(I);break;case 1778578888:I=Number.parseInvariant(I.MenuItemId);this.CKg(I);break;default:d=Dg.a(w)}return d||Od.TaskExtensions.H4()};Ze.prototype.Jc=function(d,w){d=!1;switch(w.command){case 671488277:d=Ef.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:d=!0;break;case 1600778266:d=!0;break;case -556893687:d=!0;break;case -1966978671:d=!0;break;case -1951357930:d=!0;break;case -1390365353:case -1457478532:d=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:d=
!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:d=!0;break;case -1007663920:case 234234584:case 1194992911:d=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:d=!0}return d};Ze.prototype.Yc=function(d,w){var I=!1;switch(w){case -249874296:case -1128612833:case 1801458190:case -1951357930:case -1390365353:case -1457478532:case 1600778266:case -556893687:case -1966978671:case 1514686611:case 1778578888:I=
this.vS();break;case -1007663920:case 234234584:I=this.Sxj()||this.vS();break;case 1194992911:I=this.Txj()||this.vS();break;case 1217404289:I=!Xh.j(this.Db.LabelOrDateFilterType)||this.vS();break;case -743135194:I=!Xh.m(this.Db.ValueFilterType)&&!Xh.l(this.Db.ValueFilterType)||this.vS();break;case 771421327:I=0===this.Db.LabelOrDateFilterType&&0===this.Db.ValueFilterType&&!this.Db.HasManualFilter||this.vS();break;case 1015867427:I=!Xh.i(this.Db.LabelOrDateFilterType)||this.vS();break;case 1105960559:I=
!Xh.k(this.Db.LabelOrDateFilterType)||this.vS()}return I||Bc.prototype.Yc.call(this,d,w)};Ze.prototype.ybb=function(){this.T$a=this.Db=this.ag=null};Ze.prototype.cUd=function(){this.grid.XT(this.ht);this.$.Ka.FFa(this.$t)};Ze.prototype.HXd=function(){this.grid.kO(this.ht);this.$.Ka.cbb(this.$t)};Ze.prototype.wJb=function(){if(this.Uc&&this.Uc.Qo){this.ag=this.Uc.Qo;this.Db=this.Uc.yac();if(this.i3f()){var d=this.Uc.qL[4===this.ag.CellType?this.Uc.B5c-1:this.ag.CurrentFieldIndex-1];d&&(this.T$a=-2===
d.Index?this.Uc.yGe:d.Caption)}this.pai();this.Db&&8===this.ag.CellArea&&(this.Pz.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.Db.DataFieldAggregationType,this.Pz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.Db.DataFieldFormatType,this.Pz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.Db.BaseFieldIndex,this.Pz.PivotValueFieldTitle=this.Db.Caption)}};Ze.prototype.v2f=function(d){if(!this.Uc)return!1;d=this.Uc.isOlap&&!this.Uc.m7a(!d);return ye.EwaSettings.la(605)&&
d};Ze.prototype.$xj=function(){var d=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.Db.MeasureType&&(!this.Uc.ghf||d&&2===this.Db.MeasureType)};Ze.prototype.YY=function(){var d=this.Sa.Lp(this.menuId),w=this.Sa.Mc();if(this.Uc)this.ag&&this.Uc.Qo&&this.ag!==this.Uc.Qo&&Fd.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.Db&&this.Db!==this.Uc.yac()&&Fd.ULS.shipAssertTag(537167005,0,
!1,"CurrentField is out of sync with field from PivotTable Range");else return d;this.iHh(d);if(this.$.isEditMode){this.refresh&&this.wIh(d);if(this.ag&&this.Db){var I=this.Sa.Mc();this.LIh(I);this.xHh(I);Array.add(d.zc,I)}this.oZ&&Array.add(w.buttons,this.Sa.Bb(99));this.ag&&this.Db&&this.THh(d);if(this.expandCollapse){I=this.Sa.Wv("ContextMenu.PivotExpandCollapse",null,te.a.instance.fa(1120),589118293);var ha=this.Sa.Mc();Array.add(ha.buttons,this.Sa.Bb(243));Array.add(ha.buttons,this.Sa.Bb(244));
Array.add(ha.buttons,this.Sa.Bb(245));Array.add(ha.buttons,this.Sa.Bb(246));Array.add(I.menu.zc,ha);I&&0<ha.buttons.length&&Array.add(w.buttons,I)}this.ag&&this.xIh(d);this.ag&&this.Db&&8===this.ag.CellArea&&8!==this.ag.CellType&&(I=this.Sa.Mc(),this.$xj()&&this.NIh(I),3!==this.ag.CellType&&this.IIh(I),Array.add(d.zc,I));!this.Uc.Vgc()&&this.ag&&0===this.ag.CellType&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.HIh(d);ye.EwaSettings.la(325)&&(this.Bli()?
Array.add(w.buttons,this.Sa.Bb(257)):Array.add(w.buttons,this.Sa.Bb(258)));this.sod?Array.add(w.buttons,this.Sa.Bb(59)):Array.add(w.buttons,this.Sa.Bb(58))}Array.add(d.zc,w);return d};Ze.prototype.pRd=function(){return this.Db&&this.Db.Caption?20<this.Db.Caption.length:!1};Ze.prototype.Ged=function(d){return this.Db&&this.Db.Caption?d?this.Db.Caption.substring(0,20)+"...":this.Db.Caption:""};Ze.prototype.rva=function(d){return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?
k.a.hashCode(d).toString():d};Ze.prototype.LIh=function(d){if(this.ag&&this.Db&&4!==this.ag.CellArea){var w=this.Uua(this.oH("PivotTableContextMenu.Sort",this.rva(this.Db.Caption)),-1777747317,0,0!==this.Db.SortInfo,te.a.instance.fa(228)),I=this.Sa.Mc();Array.add(I.buttons,this.de("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.Db.SortInfo,te.a.instance.fa(229)));Array.add(I.buttons,this.de("PivotTableContextMenu.SortDescending",234234584,0,2===this.Db.SortInfo,te.a.instance.fa(230)));
1!==this.ag.CellArea&&2!==this.ag.CellArea||Array.add(I.buttons,this.de("PivotTableContextMenu.SortByValue",1194992911,0,3===this.Db.SortInfo||4===this.Db.SortInfo,te.a.instance.fa(155)));Array.add(w.menu.zc,I);w&&0<I.buttons.length&&Array.add(d.buttons,w)}};Ze.prototype.xHh=function(d){if(this.ag&&this.Db&&(1===this.ag.CellArea||2===this.ag.CellArea)){var w=this.ozj(),I=this.Uua(this.oH("PivotTableContextMenu.Filter",this.rva(this.Db.Caption)),-1777747317,0,w,te.a.instance.fa(644)),ha=this.Sa.Mc(),
wa="",$a=this.pRd(),Tb=String.format(te.a.instance.Cb(155),this.Ged($a));$a&&(wa=String.format(te.a.instance.Cb(155),this.Db.Caption));w=this.rva(this.Db.Caption)+"."+(w?"enabled":"disabled");wa=this.de(this.oH(Aa,w),771421327,0,!1,Tb,"0",wa,8,N.a.m2a);w=this.rva(this.Db.Caption)+"."+this.Db.LabelOrDateFilterType.toString();this.Db.IsDateField?(Tb=this.Uua(this.oH("PivotTableContextMenu.DateFilter",w),-1777747317,0,0!==this.Db.LabelOrDateFilterType,te.a.instance.fa(96)),this.lHh(Tb.menu)):(Tb=this.Uua(this.oH("PivotTableContextMenu.LabelFilter",
w),-1777747317,0,0!==this.Db.LabelOrDateFilterType,te.a.instance.fa(642)),this.SHh(Tb.menu));w=this.rva(this.Db.Caption)+"."+this.Db.ValueFilterType.toString();w=this.Uua(this.oH("PivotTableContextMenu.ValueFilter",w),-1777747317,0,0!==this.Db.ValueFilterType,te.a.instance.fa(643));this.ZIh(w.menu);$a=this.Sa.Mc();Array.add($a.buttons,this.de("PivotTableContextMenu.ManualFilter",1514686611,0,this.Db.HasManualFilter,te.a.instance.fa(93)));Array.add(ha.buttons,wa);Array.add(ha.buttons,Tb);Array.add(ha.buttons,
w);Array.add(I.menu.zc,ha);Array.add(I.menu.zc,$a);I&&0<ha.buttons.length&&Array.add(d.buttons,I)}};Ze.prototype.lHh=function(d){Array.add(d.zc,this.Vac(!0,!1));Array.add(d.zc,this.kOh());Array.add(d.zc,this.jOh());Array.add(d.zc,this.$Ph());Array.add(d.zc,this.cQh());Array.add(d.zc,this.aQh());Array.add(d.zc,this.bQh());Array.add(d.zc,this.dQh());Array.add(d.zc,this.eQh());Array.add(d.zc,this.YNh())};Ze.prototype.cHh=function(d){Array.add(d.zc,this.Vac(!0,!0));Array.add(d.zc,this.GWh());Array.add(d.zc,
this.bUh())};Ze.prototype.SHh=function(d){Array.add(d.zc,this.Vac(!0,!1));Array.add(d.zc,this.ZZe(!0));Array.add(d.zc,this.JKh());Array.add(d.zc,this.gNh());Array.add(d.zc,this.ZYe(!0));Array.add(d.zc,this.eYe(!0))};Ze.prototype.ZIh=function(d){Array.add(d.zc,this.Vac(!1,!1));Array.add(d.zc,this.ZZe(!1));Array.add(d.zc,this.ZYe(!1));Array.add(d.zc,this.eYe(!1));Array.add(d.zc,this.X_h())};Ze.prototype.X_h=function(){var d=this.Sa.Mc();Array.add(d.buttons,this.de("PivotTableContextMenu.Top10",-1611233597,
0,Xh.l(this.Db.ValueFilterType),te.a.instance.fa(104)));return d};Ze.prototype.gNh=function(){var d=this.Sa.Mc();this.Db&&(Array.add(d.buttons,this.de("PivotTableContextMenu.Contains",786260386,0,10===this.Db.LabelOrDateFilterType,te.a.instance.fa(645),"10")),Array.add(d.buttons,this.de("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.Db.LabelOrDateFilterType,te.a.instance.fa(646),"11")));return d};Ze.prototype.JKh=function(){var d=this.Sa.Mc();this.Db&&(Array.add(d.buttons,this.de("PivotTableContextMenu.BeginsWith",
786260386,0,6===this.Db.LabelOrDateFilterType,te.a.instance.fa(647),"6")),Array.add(d.buttons,this.de("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.Db.LabelOrDateFilterType,te.a.instance.fa(648),"7")),Array.add(d.buttons,this.de("PivotTableContextMenu.EndsWith",786260386,0,8===this.Db.LabelOrDateFilterType,te.a.instance.fa(649),"8")),Array.add(d.buttons,this.de("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.Db.LabelOrDateFilterType,te.a.instance.fa(650),"9")));return d};
Ze.prototype.ZZe=function(d){var w=this.Sa.Mc();if(this.Db){var I=d?Xh.c:Xh.f;Array.add(w.buttons,this.de(this.oH("PivotTableContextMenu.Equals",I),786260386,0,d?4===this.Db.LabelOrDateFilterType:18===this.Db.ValueFilterType,te.a.instance.fa(99),d?"4":"18"));Array.add(w.buttons,this.de(this.oH("PivotTableContextMenu.DoesNotEqual",I),786260386,0,d?5===this.Db.LabelOrDateFilterType:19===this.Db.ValueFilterType,te.a.instance.fa(100),d?"5":"19"))}return w};Ze.prototype.ZYe=function(d){var w=this.Sa.Mc();
if(this.Db){var I=d?Xh.c:Xh.f;Array.add(w.buttons,this.de(this.oH("PivotTableContextMenu.GreaterThan",I),786260386,0,d?12===this.Db.LabelOrDateFilterType:20===this.Db.ValueFilterType,te.a.instance.fa(101),d?"12":"20"));Array.add(w.buttons,this.de(this.oH("PivotTableContextMenu.GreaterThanOrEqualTo",I),786260386,0,d?13===this.Db.LabelOrDateFilterType:21===this.Db.ValueFilterType,te.a.instance.fa(651),d?"13":"21"));Array.add(w.buttons,this.de(this.oH("PivotTableContextMenu.LessThan",I),786260386,0,
d?14===this.Db.LabelOrDateFilterType:22===this.Db.ValueFilterType,te.a.instance.fa(102),d?"14":"22"));Array.add(w.buttons,this.de(this.oH("PivotTableContextMenu.LessThanOrEqualTo",I),786260386,0,d?15===this.Db.LabelOrDateFilterType:23===this.Db.ValueFilterType,te.a.instance.fa(652),d?"15":"23"))}return w};Ze.prototype.eYe=function(d){var w=this.Sa.Mc();if(this.Db){var I=d?Xh.c:Xh.f;Array.add(w.buttons,this.de(this.oH("PivotTableContextMenu.Between",I),786260386,0,d?16===this.Db.LabelOrDateFilterType:
24===this.Db.ValueFilterType,te.a.instance.fa(103),d?"16":"24"));Array.add(w.buttons,this.de(this.oH("PivotTableContextMenu.NotBetween",I),786260386,0,d?17===this.Db.LabelOrDateFilterType:25===this.Db.ValueFilterType,te.a.instance.fa(653),d?"17":"25"))}return w};Ze.prototype.Vac=function(d,w){var I=this.Sa.Mc();if(this.Db){var ha=te.a.instance.fa(97),wa=d?this.Db.LabelOrDateFilterType.toString():this.Db.ValueFilterType.toString(),$a=["PivotTableContextMenu.ClearFilter",this.rva(this.Db.Caption),wa];
d=d?this.Db.IsDateField?w?1015867427:1105960559:1217404289:-743135194;$a.push(d.toString());ha=this.de($a.join("."),d,0,!1,ha,wa,ha,8,N.a.m2a);Array.add(I.buttons,ha)}return I};Ze.prototype.kOh=function(){var d=this.Sa.Mc();this.Db&&Array.add(d.buttons,this.de(this.oH("PivotTableContextMenu.Equals",Xh.d),786260386,0,26===this.Db.LabelOrDateFilterType,te.a.instance.fa(99),"26"));return d};Ze.prototype.jOh=function(){var d=this.Sa.Mc();this.Db&&(Array.add(d.buttons,this.de("PivotTableContextMenu.Before",
786260386,0,27===this.Db.LabelOrDateFilterType,te.a.instance.fa(111),"27")),Array.add(d.buttons,this.de("PivotTableContextMenu.After",786260386,0,28===this.Db.LabelOrDateFilterType,te.a.instance.fa(112),"28")),Array.add(d.buttons,this.de("PivotTableContextMenu.Between",786260386,0,29===this.Db.LabelOrDateFilterType,te.a.instance.fa(103),"29")));return d};Ze.prototype.$Ph=function(){var d=this.Sa.Mc();this.Db&&(Array.add(d.buttons,this.de("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.Db.LabelOrDateFilterType,
te.a.instance.fa(109),"30")),Array.add(d.buttons,this.de("PivotTableContextMenu.Today",1778578888,0,31===this.Db.LabelOrDateFilterType,te.a.instance.fa(108),"31")),Array.add(d.buttons,this.de("PivotTableContextMenu.Yesterday",1778578888,0,32===this.Db.LabelOrDateFilterType,te.a.instance.fa(110),"32")));return d};Ze.prototype.cQh=function(){var d=this.Sa.Mc();this.Db&&(Array.add(d.buttons,this.de("PivotTableContextMenu.NextWeek",1778578888,0,33===this.Db.LabelOrDateFilterType,te.a.instance.fa(114),
"33")),Array.add(d.buttons,this.de("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.Db.LabelOrDateFilterType,te.a.instance.fa(113),"34")),Array.add(d.buttons,this.de("PivotTableContextMenu.LastWeek",1778578888,0,35===this.Db.LabelOrDateFilterType,te.a.instance.fa(115),"35")));return d};Ze.prototype.aQh=function(){var d=this.Sa.Mc();this.Db&&(Array.add(d.buttons,this.de("PivotTableContextMenu.NextMonth",1778578888,0,36===this.Db.LabelOrDateFilterType,te.a.instance.fa(116),"36")),Array.add(d.buttons,
this.de("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.Db.LabelOrDateFilterType,te.a.instance.fa(117),"37")),Array.add(d.buttons,this.de("PivotTableContextMenu.LastMonth",1778578888,0,38===this.Db.LabelOrDateFilterType,te.a.instance.fa(118),"38")));return d};Ze.prototype.bQh=function(){var d=this.Sa.Mc();this.Db&&(Array.add(d.buttons,this.de("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.Db.LabelOrDateFilterType,te.a.instance.fa(119),"39")),Array.add(d.buttons,this.de("PivotTableContextMenu.ThisQuarter",
1778578888,0,40===this.Db.LabelOrDateFilterType,te.a.instance.fa(120),"40")),Array.add(d.buttons,this.de("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.Db.LabelOrDateFilterType,te.a.instance.fa(121),"41")));return d};Ze.prototype.dQh=function(){var d=this.Sa.Mc();this.Db&&(Array.add(d.buttons,this.de("PivotTableContextMenu.NextYear",1778578888,0,42===this.Db.LabelOrDateFilterType,te.a.instance.fa(122),"42")),Array.add(d.buttons,this.de("PivotTableContextMenu.ThisYear",1778578888,0,43===
this.Db.LabelOrDateFilterType,te.a.instance.fa(123),"43")),Array.add(d.buttons,this.de("PivotTableContextMenu.LastYear",1778578888,0,44===this.Db.LabelOrDateFilterType,te.a.instance.fa(124),"44")));return d};Ze.prototype.eQh=function(){var d=this.Sa.Mc();if(this.Db){Array.add(d.buttons,this.de("PivotTableContextMenu.YearToDate",1778578888,0,45===this.Db.LabelOrDateFilterType,te.a.instance.fa(125),"45"));var w=this.Uua("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,Xh.i(this.Db.LabelOrDateFilterType),
te.a.instance.fa(126));this.cHh(w.menu);Array.add(d.buttons,w)}return d};Ze.prototype.YNh=function(){var d=this.Sa.Mc();this.Db&&Array.add(d.buttons,this.de("PivotTableContextMenu.CustomFilter",786260386,0,this.lzj(this.Db.LabelOrDateFilterType),te.a.instance.fa(107),"26"));return d};Ze.prototype.GWh=function(){var d=this.Sa.Mc();this.Db&&(Array.add(d.buttons,this.de("PivotTableContextMenu.Quarter1",1778578888,0,46===this.Db.LabelOrDateFilterType,te.a.instance.fa(127),"46")),Array.add(d.buttons,this.de("PivotTableContextMenu.Quarter2",
1778578888,0,47===this.Db.LabelOrDateFilterType,te.a.instance.fa(128),"47")),Array.add(d.buttons,this.de("PivotTableContextMenu.Quarter3",1778578888,0,48===this.Db.LabelOrDateFilterType,te.a.instance.fa(129),"48")),Array.add(d.buttons,this.de("PivotTableContextMenu.Quarter4",1778578888,0,49===this.Db.LabelOrDateFilterType,te.a.instance.fa(130),"49")));return d};Ze.prototype.bUh=function(){var d=this.Sa.Mc();this.Db&&(Array.add(d.buttons,this.de("PivotTableContextMenu.January",1778578888,0,50===this.Db.LabelOrDateFilterType,
te.a.instance.fa(131),"50")),Array.add(d.buttons,this.de("PivotTableContextMenu.February",1778578888,0,51===this.Db.LabelOrDateFilterType,te.a.instance.fa(132),"51")),Array.add(d.buttons,this.de("PivotTableContextMenu.March",1778578888,0,52===this.Db.LabelOrDateFilterType,te.a.instance.fa(133),"52")),Array.add(d.buttons,this.de("PivotTableContextMenu.April",1778578888,0,53===this.Db.LabelOrDateFilterType,te.a.instance.fa(134),"53")),Array.add(d.buttons,this.de("PivotTableContextMenu.May",1778578888,
0,54===this.Db.LabelOrDateFilterType,te.a.instance.fa(135),"54")),Array.add(d.buttons,this.de("PivotTableContextMenu.June",1778578888,0,55===this.Db.LabelOrDateFilterType,te.a.instance.fa(136),"55")),Array.add(d.buttons,this.de("PivotTableContextMenu.July",1778578888,0,56===this.Db.LabelOrDateFilterType,te.a.instance.fa(137),"56")),Array.add(d.buttons,this.de("PivotTableContextMenu.August",1778578888,0,57===this.Db.LabelOrDateFilterType,te.a.instance.fa(138),"57")),Array.add(d.buttons,this.de("PivotTableContextMenu.September",
1778578888,0,58===this.Db.LabelOrDateFilterType,te.a.instance.fa(139),"58")),Array.add(d.buttons,this.de("PivotTableContextMenu.October",1778578888,0,59===this.Db.LabelOrDateFilterType,te.a.instance.fa(140),"59")),Array.add(d.buttons,this.de("PivotTableContextMenu.November",1778578888,0,60===this.Db.LabelOrDateFilterType,te.a.instance.fa(141),"60")),Array.add(d.buttons,this.de("PivotTableContextMenu.December",1778578888,0,61===this.Db.LabelOrDateFilterType,te.a.instance.fa(142),"61")));return d};
Ze.prototype.THh=function(d){var w=this.Sa.Mc();if(this.i3f()){var I=this.Uc.qL[4===this.ag.CellType?this.Uc.B5c-1:this.ag.CurrentFieldIndex-1];if(I&&this.T$a){var ha=this.Sa.Wv("ContextMenu.PivotTableLayout",null,te.a.instance.fa(640),-1777747317);var wa=this.Sa.Mc(),$a=String.format(te.a.instance.Cb(160),this.T$a),Tb=String.format(te.a.instance.Cb(161),this.T$a);Array.add(wa.buttons,this.de(Ib,-1457478532,0,!I.IsCompactLayout,$a));Array.add(wa.buttons,this.de(hb,-1390365353,0,I.IsCompactLayout,
Tb));Array.add(ha.menu.zc,wa);ha&&Array.add(w.buttons,ha)}}if(1===this.ag.CellArea||2===this.ag.CellArea)this.Db.Caption&&(I="",wa=this.pRd(),ha=String.format(te.a.instance.Cb(158),this.Ged(wa)),wa&&(I=String.format(te.a.instance.Cb(158),this.Db.Caption)),1===this.ag.CellArea?(I=this.Uua("ContextMenu.PivotTableSubtotal",1801458190,0,this.Db.ShowSubtotal,ha),ha=this.Sa.Mc(),Array.add(ha.buttons,this.Sa.Bb(259)),Array.add(ha.buttons,this.de("ContextMenu.PivotTableSubtotalOnTop",671485366,632,this.Db.ShowSubtotal&&
this.Db.ShowSubtotalAtTop)),Array.add(ha.buttons,this.de("ContextMenu.PivotTableSubtotalOnBottom",772221736,633,this.Db.ShowSubtotal&&!this.Db.ShowSubtotalAtTop)),Array.add(I.menu.zc,ha),I&&0<ha.buttons.length&&Array.add(w.buttons,I)):(wa=wa?this.oH(R,this.rva(ha)):R,Array.add(w.buttons,this.de(wa,1801458190,0,this.Db.ShowSubtotal,ha,null,I)))),Array.add(w.buttons,this.de("ContextMenu.RepeatItemLabels",-556893687,635,this.Db.RepeatItemLabels));1===this.ag.CellArea&&Array.add(w.buttons,this.de("ContextMenu.PivotBlankLineAfterEachItem",
1600778266,634,this.Db.ShowBlankLineAfterEachItem));Array.add(d.zc,w)};Ze.prototype.HIh=function(d){var w=this.Sa.Mc();Array.add(w.buttons,this.Sa.Bb(247));Array.add(d.zc,w)};Ze.prototype.xIh=function(d){var w="",I="",ha=!1;3===this.ag.CellType?w=te.a.instance.fa(637):8===this.ag.CellType?this.Uc&&(w=String.format(te.a.instance.Cb(159),this.Uc.yGe)):this.Db&&((ha=this.pRd())&&(I=String.format(te.a.instance.Cb(159),this.Db.Caption)),w=String.format(te.a.instance.Cb(159),this.Ged(ha)));if(w){var wa=
this.Sa.Mc();ha=ha?this.oH(Hi,this.rva(w)):Hi;w=this.de(ha,-1951357930,0,!1,w,null,I,8,N.a.g$c);Array.add(wa.buttons,w);Array.add(d.zc,wa)}};Ze.prototype.iHh=function(d){var w=this.Sa.Mc();ye.EwaSettings.la(483)&&Array.add(w.buttons,this.Sa.Bb(43));this.Db&&this.ag&&this.$.isEditMode&&(0===this.ag.CellType||4===this.ag.CellType)&&Array.add(w.buttons,this.Sa.Bb(136));Array.add(d.zc,w)};Ze.prototype.wIh=function(d){var w=this.Sa.Mc();Array.add(w.buttons,this.Sa.Bb(100));Array.add(d.zc,w)};Ze.prototype.NIh=
function(d){var w=2===this.Db.MeasureType&&!this.Db.IsNumeric,I=this.Sa.Wv("ContextMenu.SummarizeValuesBy",null,te.a.instance.fa(638),-249874296),ha=this.Sa.Mc();Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesBySum",-1255320719,1059,0===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,w));Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesByCount",1746132849,1060,1===this.Db.DataFieldAggregationType));Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesByAverage",
-771066011,1061,2===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,w));Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesByMax",835007294,1062,3===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,w));Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesByMin",929115636,1063,4===this.Db.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,w));Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesByProduct",1935475057,1064,5===this.Db.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,this.v2f(!0)||w));2!==this.Db.MeasureType&&(Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1065,6===this.Db.DataFieldAggregationType)),Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesByStdDeviation",588680636,1066,7===this.Db.DataFieldAggregationType)),Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1067,8===this.Db.DataFieldAggregationType)),Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesByVariant",
1668427539,1068,9===this.Db.DataFieldAggregationType)),Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1069,10===this.Db.DataFieldAggregationType)));this.Uc&&this.Uc.Vgc()&&Array.add(ha.buttons,this.de("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1070,11===this.Db.DataFieldAggregationType));Array.add(I.menu.zc,ha);Array.add(d.buttons,I)};Ze.prototype.IIh=function(d){var w=this.Sa.Wv("ContextMenu.ShowValuesAs",null,te.a.instance.fa(639),-1128612833),
I=this.Sa.Mc();Array.add(I.buttons,this.de("ContextMenu.ShowValuesAsNoCalculation",-841863025,1076,0===this.Db.DataFieldFormatType));Array.add(I.buttons,this.de("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1083,7===this.Db.DataFieldFormatType));Array.add(I.buttons,this.de("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1082,6===this.Db.DataFieldFormatType));Array.add(I.buttons,this.de("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1081,5===this.Db.DataFieldFormatType));
Array.add(I.buttons,this.de("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1086,9===this.Db.DataFieldFormatType));Array.add(I.buttons,this.de("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1087,10===this.Db.DataFieldFormatType));if(this.Uc&&this.Uc.qL&&0<this.Uc.qL.length||this.Uc.A$&&0<this.Uc.A$.length){for(var ha=this.Uua("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1088,11===this.Db.DataFieldFormatType),wa=this.Sa.Mc(),$a=this.MIh(),Tb=0;Tb<$a.length;Tb++){var Ic=
$a[Tb];Array.add(wa.buttons,this.de("ContextMenu.ShowValuesAsPercentOfParentTotal."+Ic.Caption,-2031744961,1088,11===this.Db.DataFieldFormatType&&this.Db.BaseFieldIndex===Ic.Index,Ic.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+Ic.Index))}Array.add(ha.menu.zc,wa);Array.add(I.buttons,ha)}Array.add(w.menu.zc,I);Array.add(d.buttons,w)};Ze.prototype.showPivotTableContextMenu=function(){this.sod=!0;this.expandCollapse=this.oZ=this.refresh=!1;var d=this.$,w=Ne.g(d),I=jf.a(d).xKa();if(I){var ha=
Nb.a(d);if(null===ha||void 0===ha?0:ha.HQd)this.sod=Qa.f(d.lg);ha=d.nc;this.oZ=I.supportsBIExplore&&!!ia.a(d)&&ha.L2(32768);ha.allowInteractivity&&(d=w.uc(null),(null===d||void 0===d?0:d.cell)&&(d.cell.OZc||d.cell.f3f)&&(this.expandCollapse=!0),ha.allowManualDataRefresh&&(this.refresh=!0))}d=null;I=1;this.w0a&&1!==this.w0a.yb?(d=new Sys.UI.Point(this.w0a.clientPoint.x,this.w0a.clientPoint.y),I=this.w0a.yb):(w=Ef.e(w,this.$))&&(d=new Sys.UI.Point(w.x+(this.$.isChromeRtl?0:w.width),w.y+w.height));Kf.a.$b=
I;this.dic=3===I;this.Eo(d,!0,I);this.xba=!0;this.cUd()};Ze.prototype.K7h=function(){var d=new eh.a(1114549926,0,this.$.gd,19,null);this.$.Ka.Xb(d)};Ze.prototype.LVh=function(){var d=this;if(this.Uc&&this.Uc.Qo){var w=this.Uc.Qo.CurrentCol;if(this.Uc.Qo.CurrentRow===this.activeCell.FirstRow&&w===this.activeCell.FirstColumn){this.wJb();this.showPivotTableContextMenu();return}}w=new Uf.a(228,0,function(I,ha,wa){return jg.C(d.$.na.ta,d.activeCell,Jf.b(I,d.VMi),Jf.a(ha,d.UMi),wa,null)},16);this.$.userOperationManager.hc(w,
null)};Ze.prototype.Bli=function(){if(yg.a.Kd(this.$)){var d=this.$.da.Aa(441);if(d)return d.Zr}else if(d=this.$.da.Aa(346))return d.Zr;return!1};Ze.prototype.oH=function(d,w){return d+"."+w};Ze.prototype.performPivotTableOperation=function(d,w){var I=this,ha=sh.a.Ra.Kb;if(!this.Uc||!this.Db&&this.ag&&3!==this.ag.CellType)this.vi();else{var wa=this.Uc.isOlap;jf.a(this.$).Eu(wa,function($a){$a&&I.$.hc(d,function(Tb,Ic,pc){if(ye.EwaSettings.la(523)){var vd=I.RCc,ne=I.activeCell,Pe=I.Db?I.Db.Caption:
null,Af=I.T$a;Tb=Jf.b(Tb,I.KQi);Ic=Jf.a(Ic,I.JQi);var Wf=I.$.na.ta.Zb();Wf=vd.Na(41,void 0===Wf?null:Wf);Wf.activeCell=ne;Wf.operationType=w;Wf.fieldCaption=Pe;Wf.prevFieldCaption=Af;pc=jg.i(vd,"ExecutePivotTableOperation",Wf,Tb,Ic,pc,null,0)}else vd=I.RCc,ne=I.activeCell,Pe=I.$.na.ta.Zb(),Pe=vd.Na(41,void 0===Pe?null:Pe),Pe.activeCell=ne,Pe.operationType=w,pc=jg.i(vd,"PerformPivotTableOperation",Pe,Tb,Ic,pc,null,0);return pc},ha,0,4,229)})}};Ze.prototype.applyValueFieldSettingsToPivotTable=function(d,
w){var I=this;w=void 0===w?!1:w;var ha=sh.a.Ra.Kb;this.Uc&&this.Db?(w&&2===this.Db.MeasureType&&Fd.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),w=this.Uc.isOlap,jf.a(this.$).Eu(w,function(wa){wa&&I.$.hc(d,function($a,Tb,Ic){var pc=I.RCc,vd=I.activeCell,ne=I.Pz;$a=Jf.b($a,I.AHi);Tb=Jf.a(Tb,I.zHi);var Pe=I.$.na.ta.Zb();Pe=pc.Na(41,void 0===Pe?null:Pe);Pe.activeCell=vd;Pe.pivotValueFieldSettingsApplyData=ne;return jg.i(pc,"ApplyValueFieldSettingsToPivotTable",
Pe,$a,Tb,Ic,null,0)},ha,0,4,231)})):this.vi()};Ze.prototype.de=function(d,w,I,ha,wa,$a,Tb,Ic,pc,vd){wa=void 0===wa?null:wa;$a=void 0===$a?null:$a;Tb=void 0===Tb?null:Tb;Ic=void 0===Ic?8:Ic;pc=void 0===pc?null:pc;vd=void 0===vd?!1:vd;ha&&(d+=".Checked");vd&&(d+=".Disabled");this.Sa.gnd(d)&&this.Sa.xId(d);I=wa||te.a.instance.fa(I);d=this.Sa.zHa(d,I,w,null,"None",$a,vd,null);d.Jvc(null);Tb&&d.rS(Tb);ha?d.tS("Image16by16",3,N.a.kaa):pc?d.tS("Image16by16",Ic,pc):d.Z1b();return d};Ze.prototype.Uua=function(d,
w,I,ha,wa){I=(void 0===wa?null:wa)||te.a.instance.fa(I);this.Sa.gnd(d)?this.Sa.xId(d):this.Sa.xId(d+".Checked");ha&&(d+=".Checked");this.Cxj&&(I=this.Khh.parseFromString(I,"text/html").body.innerText);d=this.Sa.I3c(d,null,I,w,3,N.a.kaa);d.U$e=ha;!ha&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&d.Z1b();return d};Ze.prototype.pai=function(){this.Pz=Object.assign(new Kc,{PivotValueFieldSummarizeValueByApplyData:Object.assign(new uc,{Aggregation:-1}),
PivotValueFieldShowValueAsApplyData:Object.assign(new yd,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})};Ze.prototype.ORa=function(d,w){this.Pz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=d;this.Pz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=w;this.Pz.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1};Ze.prototype.MIh=function(){var d=[];if(this.Uc&&this.Uc.A$&&0<this.Uc.A$.length)for(var w=yl(this.Uc.A$),I=w.next();!I.done;I=
w.next())(I=I.value)&&Array.add(d,I);if(this.Uc&&this.Uc.qL&&0<this.Uc.qL.length)for(w=yl(this.Uc.qL),I=w.next();!I.done;I=w.next())(I=I.value)&&Array.add(d,I);d.sort(function(ha,wa){return ha.Index-wa.Index});return d};Ze.prototype.i3f=function(){if(!this.ag||!this.Uc||!this.Uc.qL)return!1;var d=1===this.ag.CellArea||4===this.ag.CellType&&this.ag.IsRowAxis,w=4===this.ag.CellType?0<this.Uc.B5c:0<this.ag.CurrentFieldIndex;return 1<this.Uc.qL.length&&d&&w};Ze.prototype.jKa=function(d){var w=[];3===
d?this.$.isEditMode?Array.addRange(w,[na.a.NHf,na.a.PHf,na.a.DZi]):Array.addRange(w,[na.a.copy]):2===d&&Array.add(w,na.a.Jxe);return w};Ze.prototype.vi=function(){var d=hh.a.hd(1,0,0,641,0,104573951,"PivotTableContextMenuOperationFailure");Ki.a(this.$).vi(d)};Ze.prototype.ozj=function(){return this.Db?0!==this.Db.LabelOrDateFilterType||0!==this.Db.ValueFilterType||this.Db.HasManualFilter:!1};Ze.prototype.lzj=function(d){return 62<=d&&65>=d};Ze.prototype.Wri=function(){if(this.activeCell&&this.Db&&
this.Uc){var d={};d.cell=this.activeCell;d.dataSourceIndex=this.Uc.externalSourceIndex;d.fieldId=this.Db.Index.toString();d.isOlap=this.Uc.isOlap;d.confirmationRequired=this.Uc.confirmationRequiredForDataOps;this.$.xe(492140419,Kf.a.$b,19,{showPivotFilterDialogCommandData:d})}};Ze.prototype.GYg=function(d){var w=this;this.activeCell&&this.Db&&this.Uc&&this.$.userOperationManager.hc(new Uf.a(153,0,function(I,ha,wa){return jg.X(w.$.na.ta,w.activeCell,w.Uc.externalSourceIndex,w.Db.Index.toString(),d,
I,ha,wa,null,null)}),null)};Ze.prototype.CKg=function(d){var w=this;!(30>d||61<d)&&this.activeCell&&this.Db&&this.Uc&&this.$.userOperationManager.hc(new Uf.a(152,0,function(I,ha,wa){return jg.g(w.$.na.ta,w.activeCell,w.Uc.externalSourceIndex,w.Db.Index.toString(),d,I,ha,wa,null,null)}),null)};Ze.prototype.applyPivotSort=function(d){var w=this;if(this.Uc&&this.Db&&this.activeCell&&this.ag){var I=1===this.ag.CellArea||2===this.ag.CellArea;8===this.ag.CellArea?Ch.a(this.$.userOperationManager,function(ha,
wa,$a){return jg.e(w.$.na.ta,w.activeCell,d,w.Db.Caption,ha,wa,$a,null)},function(ha){return new Uf.a(1015,0,ha,void 0,null)},null):I&&(I=1===this.ag.CellArea?1:2,this.$.la(724)?Th.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Uc.externalSourceIndex,this.Db.Index.toString(),this.Db.Caption,this.Uc.isOlap?"":this.Db.Caption,I,1===d):Th.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Uc.externalSourceIndex,this.Db.Index.toString(),
1===d))}};Ze.prototype.vS=function(){return!this.Uc||!this.Uc.isActionable&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReadOnlyPivotTable",!1)};Ze.prototype.Sxj=function(){return(this.ag||this.Uc)&&4!==this.ag.CellType&&(0!==this.ag.CellType||8!==this.ag.CellArea||this.Uc.A$&&this.Uc.A$.length||this.Uc.qL&&this.Uc.qL.length)?!1:!0};Ze.prototype.Txj=function(){return this.ag&&this.Uc&&(1===this.ag.CellArea||2===this.ag.CellArea)&&this.Uc.hOb&&this.Uc.hOb.length?!1:!0};Sk.Object.defineProperties(Ze.prototype,
{au:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.RMf}}});Object(Hd.a)(Ze,"PivotTableContextMenu",qg.a,[]);Pd.prototype.compare=function(d,w){return(d||"").localeCompare(w||"",void 0,{numeric:!0,sensitivity:"accent"})};Object(Hd.a)(Pd,"DigitsAsNumberComparer",null,[790]);var gc=b(256),Id=Ca.a.B2g,fe=qg.a;vm(If,fe);If.prototype.executeCommand=function(d,w,I){d=w.command;switch(d){case 639960842:this.applyTableFieldList(I);
this.hO.zda();break;case -1085236154:I=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",this.Gyd);Fd.ULS.sendTraceTag(537166999,0,50,I);this.hO.zda();break;case 1833782813:this.hO.showCallout();break;default:return Dg.a(d)}return Vf.Task.Ta(!0)};If.prototype.applyTableFieldList=function(d){var w=d.MenuItemId.toString();ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(w=w.replace("'","''"),w=w.replace("[",
"'["),w=w.replace("]","']"));var I=Object(qc.a)(String,d.SourceControlId),ha={};ha.PulloutField=w;ha.PulloutCardPath=d.SourceCardKeyPath;ha.PulloutCardSourceRow=d.SourceCardRow;ha.PulloutCardSourceColumn=d.SourceCardColumn;if(this.hO.rN){Fd.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");ha.ParameterType=2;d=d.ColumnIndex;if(void 0===d||null===d){if(void 0===I||null===I){Fd.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");
return}d=0<=this.hO.VKf?this.hO.VKf:parseInt(I.substring(20+w.length+1,I.length),10);if(isNaN(d)){w=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",I);Fd.ULS.shipAssertTag(537166997,0,!1,w);return}}ha.PulloutRichColumnSourceIndex=d;if(this.MUb.fIg){this.VIg(w,ha);return}}else Fd.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),ha.ParameterType=4,I=this.hO.selectedRange.right,void 0!==ha.PulloutCardSourceColumn&&null!==ha.PulloutCardSourceColumn&&
(I=ha.PulloutCardSourceColumn+1),ha.PulloutRichColumnSourceIndex=I;this.AOd(w,ha)};If.prototype.AOd=function(d,w,I){I=void 0===I?0:I;var ha=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",this.Gyd,w.PulloutRichColumnSourceIndex);Fd.ULS.sendTraceTag(537166996,0,50,ha);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",w.ParameterType,w.PulloutRichColumnSourceIndex);
d=Object.assign(new gc.a,{Text:d});this.grid.setCell(d,this.hO.kya,0,127,w,I);this.grid.focus();this.S4b=null;this.hO.zda();this.hO.Dhj()};If.prototype.Jc=function(d,w,I){if(d=this.$.isEditMode&&ye.EwaSettings.la(136)&&!!this.hO)switch(w.command){case -1085236154:break;case 639960842:d=!!I;break;case 1833782813:d=this.hO.zwa&&this.hO.OAb;break;default:d=!1}return d};If.prototype.HO=function(d,w,I){this.$.isEditMode&&(this.S4b=this.bIh(Object(qc.a)(774,I)),fe.prototype.HO.call(this,d,w,null,null,!1))};
If.prototype.YY=function(){return this.S4b};If.prototype.G3c=function(d){if(!this.hO||!d||!d.Ek)return Fd.ULS.shipAssertTag(537166994,0,!!this.hO,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),Fd.ULS.shipAssertTag(537166993,0,!!d,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),d&&Fd.ULS.shipAssertTag(537166992,0,!!d.Ek,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;var w=new W.a;d=
yl(d.Ek);for(var I=d.next();!I.done;I=d.next()){var ha=I.value;I=new W.a;I.add(ha.ColumnName);I.add(ha.ColumnIndex.toString());var wa=new W.a,$a=null;$a=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new Pd:new pg;wa=E.OBc(E.concat(wa,E.select(E.asEnumerable(ha.FieldInfoDataList),function(Tb){return Tb.Name})),function(Tb){return Tb},$a);ha=new W.a;ha.add(E.toArray(E.concat(I,wa)));w=E.toList(E.concat(w,ha))}return E.toArray(w)};If.prototype.bIh=function(d){var w=
this.G3c(d);if(!w||!w.length)return this.S4b=null;var I=this.Sa;d=I.Mc();var ha=1<w.length;this.Gyd=w.length;w=yl(w);for(var wa=w.next();!wa.done;wa=w.next()){var $a=wa.value;ha||(d.title=$a[0]);wa=I.Mc();for(var Tb=2,Ic=$a.length;Tb<Ic;++Tb)Array.add(ha?wa.buttons:d.buttons,I.zHa("ApplyTableFieldList."+$a[Tb]+"."+$a[1],$a[Tb],639960842,null,"None",$a[Tb],!1,void 0,!0));ha&&($a=I.Wv("ApplyTableFieldList."+$a[0],this.menuId,$a[0],798637440),Array.add($a.menu.zc,wa),Array.add(d.buttons,$a))}I=I.Lp(this.menuId);
Array.add(I.zc,d);return I};If.prototype.VIg=function(d,w){var I=this,ha=hh.a.hd(12,1,0,881,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(ye.EwaSettings.oz()){var wa=new fi.a(this.$,ha);wa.QP(function(){2===wa.returnValue&&I.AOd(d,w,8)})}else{var $a=new gh.ErrorDialog(this.$,ha);$a.QP(function(){2===$a.returnValue&&I.AOd(d,w,8)});$a.mf()}};Sk.Object.defineProperties(If.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},qB:{configurable:!0,
enumerable:!0,get:function(){return Ca.a.TMf}},hO:{configurable:!0,enumerable:!0,get:function(){this.MUb||(this.MUb=this.$.da.Aa(261));return this.MUb}}});Object(Hd.a)(If,"PulloutFieldListContextMenu",qg.a,[]);var sf=Ca.a.VMf,hg=qg.a;vm(Yd,hg);Yd.prototype.Jc=function(d,w,I){return-1687037502===w.command&&!!I&&this.grid.isEditing};Yd.prototype.executeCommand=function(d,w,I){this.showRichTextFloatie(I);return Vf.Task.Ta(!0)};Yd.prototype.jKa=function(){return[na.a.eWg]};Yd.prototype.showRichTextFloatie=
function(d){var w=Object(qc.a)(aa.a,d.eventArgs);w&&(d=this.jKa(w.yb),w=new Sys.UI.Point(w.Ea.clientX,w.Ea.clientY),this.showFloatie(d,new Sys.UI.Bounds(w.x,w.y,0,0),2))};Sk.Object.defineProperties(Yd.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.VMf}}});Object(Hd.a)(Yd,"RichTextContextMenu",qg.a,[]);var $f=b(94),th=Ca.a.A2g,ji=qg.a;vm(ig,ji);ig.prototype.executeCommand=function(d,w,I){if(Jc.a(this.$))return Vf.Task.Ta(!0);
this.$.isEditMode&&(d=I[Ca.a.V1f],d=d.x&&d.y?new Sys.UI.Point(d.x+(this.$.isChromeRtl?10:-10),d.y):Rc.DOMElementExtensions.getLocation(I[Ca.a.W1f]),this.Eo(d,!1));return Vf.Task.Ta(!0)};ig.prototype.Jc=function(d,w,I){return-1075099431===w.command&&!!I};ig.prototype.YY=function(){var d=this.Sa.Lp(this.menuId),w=this.$.isEditMode;this.qUj();this.OHh(d,w);this.EHh(d);this.GIh(d);return d};ig.prototype.vYb=function(d,w,I,ha){Array.add(d,this.Sa.Bb(w?I:ha))};ig.prototype.OHh=function(d,w){var I=this.Sa,
ha=I.Mc();Array.add(ha.buttons,I.Bb(54));this.vYb(ha.buttons,this.Shc,127,56);Array.add(ha.buttons,I.Bb(55));w&&this.vYb(ha.buttons,this.Shc,126,125);Array.add(ha.buttons,I.Bb(158));this.$.ea.kKb&&(w=Object(qc.a)($f.a,this.$.pa))&&ef.q(w)&&this.$.isEditMode&&(Array.add(ha.buttons,I.Bb(277)),w.isLockPausedInSession?Array.add(ha.buttons,I.Bb(279)):w.Oj&&Array.add(ha.buttons,I.Bb(278)));w=I.Wv("ContextMenu.TabColor",null,te.a.instance.fa(511),1841703919);I=I.C3c(467002767,1549407384,534,-221093529,this.qB);
Array.add(w.menu.zc,I);Array.add(ha.buttons,w);Array.add(d.zc,ha)};ig.prototype.EHh=function(d){var w=this.Sa.Mc();this.vYb(w.buttons,this.Shc,114,112);this.vYb(w.buttons,!this.sgc,115,113);Array.add(d.zc,w)};ig.prototype.GIh=function(d){if(ye.EwaSettings.la(501)&&!ef.e(this.$.xa.pa)){var w=this.Sa,I=w.Mc();Array.add(I.buttons,w.Bb(263));Array.add(d.zc,I)}};ig.prototype.qUj=function(){var d=this.$.o3c();var w=d.p3c;d=d.kDe;this.Shc=1===w;this.sgc=0<d};Sk.Object.defineProperties(ig.prototype,{au:{configurable:!0,
enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.WMf}}});Object(Hd.a)(ig,"SheetOpsContextMenu",qg.a,[]);var aj=b(524),Uj=qg.a;vm(bg,Uj);bg.prototype.Yc=function(d,w){var I=!0;switch(w){case -231711729:I=!1;break;case -1909381757:I=this.Tbc();I=!!I&&I.Bii;break;case 1312363469:I=ye.EwaSettings.la(466)}return!I||Uj.prototype.Yc.call(this,d,w)};bg.prototype.executeCommand=function(d,w,I){if(!this.$.isEditMode)return Od.TaskExtensions.H4();
d=w.command;w=this.Tbc();var ha=null;switch(d){case 2108047455:w&&w.Gze();break;case -231711729:Fd.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:w&&w.g2b();break;case 1312363469:this.showSlicerContextMenu(I);break;default:ha=Dg.a(d)}return ha||Od.TaskExtensions.H4()};bg.prototype.Jc=function(d,w,I){d=!1;switch(w.command){case -231711729:case 2108047455:case -1909381757:d=!0;break;case 1312363469:d=ye.EwaSettings.la(466)&&!!I}return d};bg.prototype.YY=
function(){var d=this.Sa.Lp(this.menuId),w=this.Sa.Mc();Array.add(w.buttons,this.Sa.Bb(252));ye.EwaSettings.la(504)&&Array.add(w.buttons,this.Sa.Bb(253));Array.add(w.buttons,this.Sa.Bb(254));Array.add(d.zc,w);w=this.Sa.Mc();this.Lni()?Array.add(w.buttons,this.Sa.Bb(266)):Array.add(w.buttons,this.Sa.Bb(267));Array.add(d.zc,w);return d};bg.prototype.Lni=function(){if(yg.a.Kd(this.$)){var d=this.$.da.Aa(439);if(d)return d.Zr}else if(d=this.$.da.Aa(371))return d.Zr;return!1};bg.prototype.showSlicerContextMenu=
function(d){var w=Object(qc.a)(aa.a,d.eventArgs);d=this.tac(Object(qc.a)(aa.a,d.eventArgs));w=w.yb;Kf.a.$b=w;this.Eo(d,!1,w)};bg.prototype.hXe=function(d){var w=this.Sa.Mc(),I=this.Sa.Mc();Array.add(I.buttons,this.Sa.Bb(255));Array.add(I.buttons,this.Sa.Bb(256));var ha=this.Sa.I3c("ContextMenu.SlicerSort",null,te.a.instance.fa(2115),-814639094,0,N.a.WPe);Array.add(ha.menu.zc,I);Array.add(w.buttons,ha);Array.add(d.zc,w)};bg.prototype.Ezj=function(d){return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&
d.Tb.className===N.a.O9c||ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===d.yb};bg.prototype.tac=function(d){var w=Ne.g(this.$).ha.Pa.lc,I=d&&1!==d.yb&&d.clientPoint?d.clientPoint:Sys.UI.DomElement.getLocation(w.domElement);if(this.Ezj(d)){var ha=this.Tbc();ha&&(d.Tb.className===N.a.O9c&&(I=qb.HelperMethods.Iub(d.Ea)),1===d.yb&&(I=pf.a(this.$).Oja(Rc.DOMElementExtensions.getLocation(ha.frame))))}else if(d=this.Tbc())d=this.$Qh(d.frame),(ha=qb.HelperMethods.YA(this.$.tf,
this.$.domElement,Ne.g(this.$).rtl,!1))?(d.x=pf.a(this.$).Ii(d.x-ha.x)+ha.x,d.y=pf.a(this.$).Ii(d.y-ha.y)+ha.y):Fd.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),I.y+=d.y,I.x+=d.x;d=this.$.domElement;ha=Ne.g(this.$).rtl;w=qb.HelperMethods.YA(w.Eg.domElement,d,ha);I.y=Math.max(I.y,w.y);I.x=Math.max(I.x,w.x);return I};bg.prototype.Tbc=function(){var d=Ne.g(this.$).ha.Pa.lc;Fd.ULS.shipAssertTag(537166988,0,!!d);return aj.a(this.$).GC(d.floatingObject.id)};bg.prototype.$Qh=function(d){var w=
new Sys.UI.Point(d.offsetParent.offsetLeft,d.offsetParent.offsetTop),I=Ne.g(this.$);if(!I)return w;var ha=Ne.g(this.$).rtl;w=qb.HelperMethods.YA(d,this.$.dr.ownerDocument.body,ha);I.bDe(w);w.x=ha?this.$.dr.clientWidth-w.x-d.clientWidth:w.x;d=I.view.Uob;I=ha?-I.tO.jca(d.x):d.x;w.x-=I;w.y-=d.y;return w};Sk.Object.defineProperties(bg.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},qB:{configurable:!0,enumerable:!0,get:function(){return Ca.a.XMf}}});Object(Hd.a)(bg,
"SlicerContextMenu",qg.a,[]);Object(Hd.a)(je,"TimeSlicerRibbonButtonParameter",null,[]);var de=qg.a;vm(ng,de);ng.prototype.executeCommand=function(d,w,I){d=w.command;switch(d){case 2000085697:d=I.DOMElement;this.Fsa=I.ChangeLevelCallback;this.qKa=I.GetLevelLabelCallback;this.S0a=I.CurrentLevel;var ha=I.DomEvent;jh.g(ha);var wa=I.location;I=I.levelLabelText;this.JKe=Rc.DOMElementExtensions.lz(document.activeElement,"iframe")&&I?I.parentNode:null;I=Sys.UI.DomElement.getBounds(I);I.x=wa.x;I.y=wa.y;this.HO(ha,
d,I,w,!0);break;case -649826274:this.Fsa(0);break;case 149600865:this.Fsa(1);break;case -2012435159:this.Fsa(2);break;case -1979934975:this.Fsa(3);break;case 1634477200:Rc.DOMElementExtensions.setFocus(this.JKe);break;default:return Dg.a(d)}return Vf.Task.Ta(!0)};ng.prototype.Jc=function(d,w,I){d=!1;switch(w.command){case 2000085697:d=!!I;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:d=!0}return d};ng.prototype.HO=function(d,w,I){d=Sys.UI.DomElement.getBounds(w);
I.x=pf.a(this.$).Ii(I.x);I.y=pf.a(this.$).Ii(I.y);d.x=pf.a(this.$).Ii(d.x);d.y=pf.a(this.$).Ii(d.y);d=new Sys.UI.Point(d.x+I.x,d.y+I.y);this.ITa(d,w);this.showContextMenu(new Sys.UI.Bounds(d.x,d.y-I.height,I.width,I.height))};ng.prototype.YY=function(){for(var d=this.Sa,w=d.Lp(this.menuId),I=d.Mc(),ha=0;3>=ha;ha++){var wa=this.qKa(ha),$a=ng.tLh(ha);$a=d.w4g($a.y2g,$a.qp,this.S0a===ha,ng.Mye);$a.label=wa;$a.rS(wa);this.S0a===ha?$a.tS("Image16by16",8,ng.Mye):$a.Z1b();Array.add(I.buttons,$a)}Array.add(w.zc,
I);return w};ng.tLh=function(d){var w=null;switch(d){case 0:w=new je(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:w=new je(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:w=new je(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);break;case 3:w=new je(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return w};Sk.Object.defineProperties(ng.prototype,{au:{configurable:!0,enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},qB:{configurable:!0,enumerable:!0,
get:function(){return Ca.a.$Mf}}});ng.SKj=Ca.a.C2g;ng.gIb="TimeSlicerLevelMenuRootName";ng.Mye=N.a.jaa;Object(Hd.a)(ng,"TimeSlicerLevelMenu",qg.a,[]);var Se=b(308),Qi=b(220),Nh=b(3),fg=Ye.a;vm(rf,fg);rf.prototype.Od=function(){var d=this,w=this.$,I=Qi.a.K0a(fh.b(),this.ma,"Task","IRootUser"),ha=Wh.a(w),wa=null;wa=function(Ic,pc){ha.hRf(wa);I.setResult(pc.r3b)};ha.noe(wa);ha.Q1e();var $a=Rg.GetServiceTaskFactory.create(w.da,102,w.ma,this.ub),Tb=Rg.GetServiceTaskFactory.Wa(w.da,342,338,this.ub);Od.TaskExtensions.Ba(Od.TaskExtensions.ve([I.task,
$a,Tb],this.ma),function(){var Ic=$a.result,pc=I.task.result,vd=Tb.result;d.Fd([new vg(w,pc,Ic,vd),new af(w,pc,Ic,vd),new Nf(w,pc,Ic,vd),new dd(w,pc,Ic,vd),new Xf(w,pc,Ic,vd),new wf(w,pc,Ic,vd),new Ug.GridContextMenu(w,pc,Ic,vd),new Yf(w,pc,Ic,vd),new ig(w,pc,Ic,vd),new ng(w,pc,Ic,vd),new If(w,pc,Ic,vd),new vf(w,pc,Ic,vd),new Ze(w,pc,Ic,vd),new bg(w,pc,Ic,vd),new Yd(w,pc,Ic,vd)])},w.ma,3)};rf.initData=function(){var d=Se.a.x2;d(2000085697,20479,0,0);d(-227942804,Nh.a.Ic|24576,0,0);d(1634477200,Nh.a.Ic|
131072,0,0);d(-649826274,4095,0,0);d(149600865,4095,0,0);d(-2012435159,4095,0,0);d(-1979934975,4095,0,0);d(1247109494,Nh.a.Ic|24576,0,0);d(-2064931494,Nh.a.Ic|131072,0,0);d(-1396319072,Nh.a.Ja,128,0);d(-425234874,Nh.a.Ja,128,0);d(-1253126584,Nh.a.Ja,0,0);d(274207288,Nh.a.Ic|24576,0,0);d(-1497523576,Nh.a.Ic|131072,0,0);d(-498523270,Nh.a.Ic|24576,64,0);d(1640762262,Nh.a.Ic|131072,64,0);d(-2017893763,Nh.a.Ic|24576,0,0);d(1350204367,Nh.a.Ic|131072,0,0);d(-889576107,Nh.a.Sv,128,0);d(-1170196828,Nh.a.Sv,
128,0);d(389774337,Nh.a.Sv,128,0);d(1529312473,Nh.a.Sv,128,0);d(2033235475,Nh.a.Sv,128,0);d(-96230454,Nh.a.Sv,128,0);d(74086617,Nh.a.Sv,128,0);d(563292088,Nh.a.Sv,128,0);d(-1092351914,Nh.a.Sv,128,0);d(-2141589616,Nh.a.Sv|16384,128,0);d(745182485,Nh.a.Sv,0,0);d(359279088,Nh.a.Sv,128,0);d(-67292059,Nh.a.Sv,128,0);d(926905850,Nh.a.Sv,128,0);d(547535945,Nh.a.Sv,128,0);d(1374696078,Nh.a.Ic|24576,0,0);d(495005930,Nh.a.Ic|212992,0,0);d(-1045020714,Nh.a.Ic|24576,0,0);d(-170383950,Nh.a.Ic|212992,0,0);d(324156914,
Nh.a.Ja,0,0);d(-1085236154,Nh.a.Bu,0,0);d(-751848458,Nh.a.jl|16384,0,0);d(216058793,Nh.a.Bu,0,0);d(474690375,Nh.a.jl|16384,0,0);d(-1920954846,Nh.a.Ic|24576,0,0);d(723126814,Nh.a.Ic|131072,0,0);d(2108047455,128,128,0);d(-231711729,128,128,0);d(-1909381757,128,128,0);d(-814639094,128,128,0);d(1701016594,Nh.a.Ic|3072,128,0);d(-1475408662,Nh.a.Ic|24576,0,0);d(1114549926,Nh.a.Ic|131072,32,0)};rf.ja=function(d){Ye.a.fe(10,new rf(d))};Object(Hd.a)(rf,"ContextMenuCommandHandlerFactory",Ye.a,[]);var bi=b(214),
Li=b(1368),Rh=b(97),kj=b(249);kf.prototype.dispose=function(){};kf.prototype.X$=function(){this.Kqb.L3()};kf.prototype.sC=function(){this.Kqb.sC()};kf.prototype.GRd=function(d,w,I){Ef.h(this.$,Ef.b);this.Kqb.showContextMenu(Object.assign(new Li.a,{x:w.x,y:w.y}),I,d);Rh.EventHandlerManager.instance.bcd()};kf.prototype.xxc=function(d,w,I){Ef.h(this.$,Ef.b);this.Kqb.showFloatie(Object.assign(new Li.a,{x:w.x,y:w.y}),d,I);kj.a(function(){Rh.EventHandlerManager.instance.bcd()},this.$.ma)};kf.prototype.FRd=
function(d,w,I,ha){Ef.h(this.$,Ef.b);this.Kqb.FRd(Object.assign(new Li.a,{x:w.x,y:w.y}),d,I,ha)};Object(Hd.a)(kf,"ReactContextMenuController",null,[771,3]);var Uh=bi.a;vm(hf,Uh);hf.prototype.dispose=function(){this.Haf&&this.$&&this.$.ea.Lq(this.Ild);Uh.prototype.dispose.call(this)};hf.prototype.create=function(){this.$.ea.Th?(Fd.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.ea.Th),this.Ild(null,null)):(this.Haf=!0,
this.$.ea.Um(this.Ild))};hf.ja=function(d){d.da.Ha(338,new hf(d))};Object(Hd.a)(hf,"ContextMenuControllerFactory",bi.a,[]);var bj=b(158);Object(Hd.a)(ee,"RibbonCommandParams",null,[]);Object(Hd.a)(Ee,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);Gd.prototype.ELh=function(d){return(d=this.odc[d.toString()])?d.menuModel:null};Gd.prototype.nTg=function(d,w){this.odc[w.toString()]=Object.assign(new Ee,{menuModel:d,LFe:qb.HelperMethods.kc()})};Gd.prototype.a7b=function(d){this.odc[d.toString()]=null};
Gd.prototype.O_h=function(d){return(d=this.odc[d.toString()])?d.LFe:-1};Object(Hd.a)(Gd,"FilterMenuCache",null,[]);var sg=b(12),Mf=b(206),Yh=b(275);Object(Hd.a)(Ed,"AutoFilterEventRegistrationArgs",null,[]);var Bi=b(24);Oc.prototype.dispose=function(){window.cancelAnimationFrame(this.PAb);this.gridView&&this.gridView.Dsc(this.xDb);this.gridView=null};Oc.prototype.x$h=function(){if(this.XQd=qb.HelperMethods.H6a)this.GZa=[];this.pCg();this.gridView.SYb(this.xDb)};Oc.prototype.pCg=function(){for(var d=
yl(this.gridView.nn),w=d.next();!w.done;w=d.next()){w=w.value.QBa;for(var I in w){var ha=w[I];this.uLf(ha.domElement,ha.hashCode)}}};Oc.prototype.uLf=function(d,w){if(Ne.g(this.$).Ca.Ll.A1a(w))if(d){d=d.querySelectorAll('[id^="'+Ca.a.Pad+'"]');for(var I=0;I<d.length;I++){var ha=d[I],wa=ha.getAttribute(Ca.a.YBh),$a=ha.getAttribute(Ca.a.RBh);Fd.ULS.shipAssertTag(537167053,0,!!wa&&!!$a,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",
ha.id,w);wa=Bi.Range.kd(parseInt(wa,10),parseInt($a,10));ha=Object.assign(new Ed,{cell:wa,xte:ha,Xd:w});this.XQd?(this.GZa.push(ha),this.PAb||(this.bNe=window.performance.now(),this.PAb=window.requestAnimationFrame(this.TOf))):this.Dme(ha)}}else Fd.ULS.sendTraceTag(537167054,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",w);else Fd.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",
w)};Oc.prototype.Dme=function(d){var w=this.gridView.Ca.W3a(d.cell,d.Xd);w?this.oCg(d.xte,w):Fd.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",d.Xd,d.cell)};Oc.prototype.oCg=function(d,w){w.hasAutoFilter?this.rAg(d,w.Nad):w.R4?this.mCg(d,w.Nad,w.Dgf):Fd.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");
bj.a.instance.qa(sg.a.Hf,d,this.onPointerDown);Mf.a.instance.qa(sg.a.eya,d,this.onPointerDown)};Oc.prototype.rAg=function(d,w){Yh.a.instance.qa(sg.a.click,d,function(I){w&&Th.a.hrc(I.Ea.rawEvent,966232027,w,null);return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5465680_FixForAutoFilterClickHandlers")?!0:!1})};Oc.prototype.mCg=function(d,w,I){var ha=Ld.a.pi(w);Yh.a.instance.qa(sg.a.click,d,function(wa){I?Th.a.spf(document.getElementById(ha.EwaElementId),ha.Cell,ha.DataSourceIndex,ha.FieldId,ha.IsOlap,
ha.RequiresConfirmation,wa.Ea.rawEvent,ha.OptionalPivotMenuAnchor):Th.a.spfm(wa.Ea.rawEvent,ha.RequiresConfirmation,ha.Cell,ha.DataSourceIndex,ha.PivotName,ha.OptionalPivotMenuAnchor);return!1})};Object(Hd.a)(Oc,"FilterMenuPointerEventsManager",null,[3]);dc.prototype.dispose=function(){ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.QTe.dispose();this.$=null};dc.prototype.LRh=function(d){var w=
Ne.g(this.$).Ca.i$(d,this.$.activeItemName);return w&&w.blockPresentInViewportTimeStamp>this.B8a.O_h(d.left)?w.Vs(d).autoFilterMenu:this.B8a.ELh(d.left)};dc.prototype.MNi=function(d,w,I){this.B8a&&this.B8a.nTg(d.menuModel[w],I)};dc.prototype.NNi=function(d){this.B8a&&this.B8a.a7b(d)};Object(Hd.a)(dc,"FilterMenuManager",null,[769,3]);var Ih=b(222),Vg=b(173);Rf.prototype.bed=function(d){return Pg.a.Gc(this.Wxc,d)};Rf.prototype.dispose=function(){this.Md?Fd.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):
(this.Md=!0,this.$&&(this.$.pl(Rf.rd),this.$.da.OU(8),this.ha&&this.ha.xsc(this.$k),this.$.Ka.cbb(this.Hwf),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.uQa(this.J_),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.ea.Z6(this.m6)),this.$=this.ha=null,this.r9b.dispose(),this.Wxc=this.F6d=null)};Rf.prototype.showContextMenu=function(d,w,I){w=void 0===w?null:w;I=void 0===
I?null:I;this.kzj(d)&&(Ef.h(this.$,Ef.i),d=this.G5g(d,w,I),this.$.Ka.Xb(d.ae,d.dictionary))};Rf.prototype.L3=function(){this.contextMenuController?this.contextMenuController.X$():Fd.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};Rf.prototype.kzj=function(d){return Ki.a(this.$).Dq()?(Fd.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
Ki.a(this.$).d0(Vg.a.grid,Ih.a.showContextMenu),!1):!this.$.Ka.vzh&&(!d||d.Tb!==Ne.g(this.$).domElement&&!k.a.equals(d.Tb.tagName,"INPUT",!0))};Rf.prototype.G5g=function(d,w,I){w=void 0===w?null:w;var ha={};I=(ha.eventArgs=d,ha.creationParams=void 0===I?null:I,ha);d=d?d.yb:-1;ha=this.ha.Pa.lc;var wa=1441131127;ha?(w=ha.floatingObject,Fd.ULS.shipAssertTag(537167059,0,!!w,"floatingObj shouldn't be null."),Rf.Vqd(w)?wa=1312363469:Rf.isPivotChart(w)?(I[af.V_c]=w?w.Xc:null,wa=-149612405):wa=-1372040782):
Rf.Cgf(w)?(I[af.V_c]=w,wa=-149612405):!Ef.g(this.$)&&Ef.f(Ne.g(this.$))&&(wa=671488277);w=new eh.a(wa,d,this.$.gd,30,null);return Object.assign(new ee,{ae:w,dictionary:I})};Rf.ja=function(d){d.Qk(Rf.rd)};Rf.isPivotChart=function(d){return!!d&&0===d.type&&Rf.Cgf(d.Xc)};Rf.Vqd=function(d){return!!d&&2===d.type};Rf.Cgf=function(d){return!!d&&!!(d.Attributes&4)};Sk.Object.defineProperties(Rf.prototype,{r9b:{configurable:!0,enumerable:!0,get:function(){return this.F6d}}});Rf.D2g="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
Rf.y2h="GridContextMenu";Rf.rd=function(d){(d=Object(qc.a)(8,d))&&Rg.GetServiceTaskFactory.create(d.da,9,d.ma,0)};Object(Hd.a)(Rf,"ContextMenuManager",null,[731,3]);var ph=bi.a;vm(xf,ph);xf.prototype.create=function(){var d=this,w=this.$,I=w.nc;if(I.allowSelection||I.allowEdits||I.allowFiltering||I.allowSorting||I.allowPivotSpecificOperations){var ha=Rg.GetServiceTaskFactory.create(w.da,10,w.ma,this.ub),wa=Rg.GetServiceTaskFactory.Wa(w.da,342,338,this.ub);Od.TaskExtensions.Ba(Od.TaskExtensions.ve([ha,
wa],this.ma),function(){d.Fb(ua.a(w)||new Rf(w,ha.result,wa.result))},this.$.ma,3)}else Fd.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),w.da.OU(8),this.Fb(null)};xf.ja=function(d){d.da.Ha(9,new xf(d))};Object(Hd.a)(xf,"ContextMenuManagerFactory",bi.a,[]);ae.prototype.isEqual=function(d){return d?this.n5===d.n5&&this.o5===d.o5&&this.aO===d.aO&&this.bO===d.bO&&this.tB===d.tB&&this.ruleType===d.ruleType&&
this.VZ===d.VZ&&this.bU===d.bU&&this.aU===d.aU&&this.JV===d.JV&&this.gF===d.gF&&this.y5===d.y5&&this.z5===d.z5:(Fd.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(Hd.a)(ae,"DataValidationEditDialogState",null,[]);Uc.prototype.Yc=function(){return!1};Uc.prototype.executeCommand=function(d,w){-1728432249!==w.command&&Dg.a(w.command);this.selectedRanges=td.r(Ne.g(this.$).ha.va.selectedRanges,this.$);Ne.g(this.$).L0(!0);this.getDataValidationInitialState();
this.gh=this.$.Vb.Hc("UserAction","DataValidationEditTimeToDialogOpen");this.tKe?Fd.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(Fd.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.tKe=!0);return Vf.Task.Ta(!0)};Uc.prototype.Jc=function(d,w){return-1728432249===w.command};Uc.prototype.fd=function(){return!1};Uc.prototype.getDataValidationInitialState=function(){var d=this,w=this.$.na.ta.Zb();Ch.a(this.$.userOperationManager,
function(I,ha,wa){return jg.u(d.$.na.ta,d.selectedRanges,Jf.b(I,d.bMi),Jf.a(ha),wa,w)},function(I){return new Uf.a(120,0,I,16)},null)};Uc.prototype.l1i=function(){var d=this.EB={};switch(this.c1a.Command){case 0:var w="CreateNew";break;case 1:w="CreateNewFromRule";break;case 2:w="ExpandExisitng";break;case 3:w="OverrideExisitng";break;default:w="Unknown"}d.a=w;this.gh&&(this.gh.stop(),this.EB.r=this.gh.id);switch(this.c1a.Command){case 0:this.EB.b=!1;this.EB.c="None";this.AHa(new ae);break;case 1:this.EB.b=
!1;this.EB.c="None";this.AHa(new ae(this.c1a));break;case 2:this.EB.b=!0;this.E5c.F4g(this.$,this.Czh);break;case 3:this.EB.b=!0;this.E5c.H4g(this.$,this.oXi);break;default:Fd.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};Uc.prototype.AHa=function(d){this.E5c.AHa(this.$,this.selectedRanges,d,this.c1a.Command);this.hxi(d)};Uc.prototype.hxi=function(d){Uc.Srb(d,this.EB);this.EB.d=!0;fh.b().Pe(48,this.EB,!0)};Uc.prototype.Inf=function(){this.EB.d=
!1;fh.b().Pe(48,this.EB,!0)};Uc.prototype.UW=function(d,w){var I={};d=(I.ButtonType=Uc.yia(w),I.DialogName=d,I.Location="dialog",I.NumberOfSelectedRanges=Ne.g(this.$).ha.va.TK,I);og.b(this.$).ee(nf.a.W5b,d)};Uc.Srb=function(d,w){w.e=ue(d.ruleType);w.f=Lf(d.tB);w.g=!!d.aO;w.h=!!d.bO;w.i=d.n5;w.j=d.o5;w.k=d.z5;w.l=!!d.gF;w.m=!!d.JV;w.n=d.y5;w.o=d.VZ;w.p=!!d.bU;w.q=!!d.aU};Uc.yia=function(d){switch(d){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return Fd.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(Hd.a)(Uc,"DataValidationEditCommandHandler",null,[188]);var uj=b(972),cj;(function(d){d[d.between=0]="between";d[d.notBetween=1]="notBetween";d[d.equal=2]="equal";d[d.notEqual=3]="notEqual";d[d.greaterThan=4]="greaterThan";d[d.lessThan=5]="lessThan";d[d.greaterThanOrEqual=6]="greaterThanOrEqual";d[d.lessThanOrEqual=7]="lessThanOrEqual"})(cj||(cj={}));Object(Hd.b)("DataValidationRuleConditionType",
cj);var Vj;(function(d){d[d.anyValue=0]="anyValue";d[d.wholeNumber=1]="wholeNumber";d[d.decimal=2]="decimal";d[d.list=3]="list";d[d.date=4]="date";d[d.time=5]="time";d[d.textLength=6]="textLength";d[d.custom=7]="custom"})(Vj||(Vj={}));Object(Hd.b)("DataValidationRuleType",Vj);var Jj=b(140),Gf=b(157);Sk.Object.defineProperties(Sc,{eg:{configurable:!0,enumerable:!0,get:function(){return Jj.a.Cn(Sc.Vj,"")}},Keh:{configurable:!0,enumerable:!0,get:function(){return Jj.a.Cn(Sc.Oeh,Gf.a.fa(1625),Gf.a.fa(1640),
Gf.a.fa(1641),Gf.a.fa(1642),Gf.a.fa(1643),Gf.a.fa(1644),Gf.a.fa(1645),Gf.a.fa(1646),Gf.a.fa(1647),Gf.a.fa(1626),Gf.a.fa(1650),Gf.a.fa(1651),Gf.a.fa(1652),Gf.a.fa(1653),Gf.a.fa(1654),Gf.a.fa(1655),Gf.a.fa(1656),Gf.a.fa(1657),Gf.a.fa(1627),Gf.a.fa(1628),Gf.a.fa(1648),Gf.a.fa(1649),Gf.a.fa(1639),"255")}},Reh:{configurable:!0,enumerable:!0,get:function(){return Jj.a.Cn(Sc.Peh,Gf.a.fa(1662),Gf.a.fa(1666),Gf.a.fa(1667),"255","32")}},Veh:{configurable:!0,enumerable:!0,get:function(){return Jj.a.Cn(Sc.Qeh,
Gf.a.fa(1661),Gf.a.fa(1664),Gf.a.fa(1663),Gf.a.fa(1665),Gf.a.fa(1666),Gf.a.fa(1667),"255","32")}}});Sc.x9f=255;Sc.Vj="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";Sc.Oeh="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
Sc.Peh="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
Sc.Qeh="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(Hd.a)(Sc,"DataValidationEditDialogHtml",null,[]);var Oh=b(576),Ej=tg.a;vm(Cc,Ej);Cc.prototype.vAa=function(d){this.cU.selectedIndex=d.ruleType;this.WK.selectedIndex=d.tB;this.nec.checked=d.o5;this.lwa.checked=d.n5;this.Rya.value=d.aO;this.Sya.value=d.bO;this.vca(null)};Cc.prototype.lpb=function(d){d.n5=this.lwa.checked;d.o5=this.nec.checked;d.tB=this.WK.selectedIndex;d.ruleType=this.cU.selectedIndex;d.aO=this.Rya.value;d.bO=this.Sya.value};Cc.prototype.dispose=function(){this.un();this.wk=
this.wCd=this.Moc=this.gPa=this.h$a=this.zNa=this.w5a=this.nec=this.Sya=this.Rya=this.WK=this.cU=this.lwa=null;Ej.prototype.dispose.call(this)};Cc.prototype.render=function(d){d.appendChild(this.domElement)};Cc.prototype.Yja=function(){return this.isVisible};Cc.prototype.Hna=function(d){return this.isVisible=d};Cc.prototype.setFocus=function(){};Cc.prototype.$ub=function(d,w){return this.M1e(d,w,this.CDh)};Cc.prototype.Tgd=function(d,w){return 0!==w&&1!==w?"":this.M1e(d,w,this.Omj)};Cc.prototype.ska=
function(){this.domElement.innerHTML=Sc.Keh;this.lwa=Rc.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.cU=Rc.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.WK=Rc.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.Rya=Rc.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.Sya=Rc.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.Moc=Rc.DOMElementExtensions.getElementById(this.domElement,
"operatorInputLableId1");this.wCd=Rc.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.w5a=Rc.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.zNa=Rc.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.h$a=Rc.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.gPa=Rc.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.nec=Rc.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownCheckboxId");this.cl()};Cc.prototype.M1e=function(d,w,I){return I.length<d||I[d].length<w?(Fd.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",d,w),""):this.zR.oa(I[d][w])};Cc.prototype.cl=function(){Oh.a.instance.qa(sg.a.Sb,this.cU,this.knc);Oh.a.instance.qa(sg.a.Sb,this.WK,this.knc);Oh.a.instance.qa(sg.a.change,this.cU,this.vca);Oh.a.instance.qa(sg.a.change,this.WK,this.vca);Oh.a.instance.qa(sg.a.change,
this.WK,this.wk);Oh.a.instance.qa(sg.a.change,this.cU,this.wk);Oh.a.instance.qa(sg.a.change,this.Rya,this.wk);Oh.a.instance.qa(sg.a.Sb,this.Rya,this.wk);Oh.a.instance.qa(sg.a.change,this.Sya,this.wk);Oh.a.instance.qa(sg.a.Sb,this.Sya,this.wk)};Cc.prototype.un=function(){Oh.a.instance.za(sg.a.Sb,this.cU,this.knc);Oh.a.instance.za(sg.a.Sb,this.WK,this.knc);Oh.a.instance.za(sg.a.change,this.cU,this.vca);Oh.a.instance.za(sg.a.change,this.WK,this.vca);Oh.a.instance.za(sg.a.change,this.WK,this.wk);Oh.a.instance.za(sg.a.change,
this.cU,this.wk);Oh.a.instance.za(sg.a.change,this.Rya,this.wk);Oh.a.instance.za(sg.a.Sb,this.Rya,this.wk);Oh.a.instance.za(sg.a.change,this.Sya,this.wk);Oh.a.instance.za(sg.a.Sb,this.Sya,this.wk)};Cc.uja=function(){var d;return d=new W.a,d.add("operatorInputId1"),d.add("operatorInputId2"),d};Sk.Object.defineProperties(Cc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return te.a.instance.fa(1658)}},$0g:{configurable:!0,enumerable:!0,get:function(){return this.cU.selectedIndex}}});
Object(Hd.a)(Cc,"DataValidationEditConditionsControl",tg.a,[802,3,803]);var Vh=b(193),Nj=uj.a;vm(nb,Nj);nb.prototype.sSd=function(){var d={};d=(d.RuleType=this.Ed.ruleType,d.RuleOperatorType=this.Ed.tB,d.OperatorInput1=this.Ed.aO,d.OperatorInput2=this.Ed.bO,d.IsIgnoreBlank=this.Ed.n5,d.IsInCellDropDown=this.Ed.o5,d.IsAlertBlocking=this.Ed.VZ,d.AlertTitle=this.Ed.bU,d.AlertMessage=this.Ed.aU,d.InputTitle=this.Ed.gF,d.InputMessage=this.Ed.JV,d.IsShowErrorAlert=this.Ed.y5,d.IsShowInputMessage=this.Ed.z5,
d);this.Fc(2,te.a.instance.fa(1624));var w={};d=(w[nb.$y]=this.Ac,w.validateDialogValues=this.sWj,w.RangePickerController=Ne.g(this.$).Hh.Jbc(),w.isModal=!1,w.bodyProps=d,w);this.initializeAndShow(te.a.instance.fa(1623),this.D5c,d);Fd.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};nb.prototype.dispose=function(){this.disposed||(Nj.prototype.dispose.call(this),this.disposed=!0)};nb.prototype.uja=function(){return Cc.uja()};nb.prototype.hOh=function(d,w){var I=this;return function(ha,
wa,$a){var Tb=d.na.ta.Zb();return Hc(I.$.na.ta,I.selectedRanges,I.lRg(),I.G_a(ha,I.Uzd(w)),Jf.a(wa),$a,Tb)}};nb.prototype.Uzd=function(d){var w=this;return function(I){Fd.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var ha;xh.a(I)?(Fd.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",I?hh.a.Tc(I.Errors):null),I.Errors&&1===I.Errors.length&&((ha=w.led(I.Errors[0].MessageId))?
w.tla("OkInvalidByServer",I.Errors[0].MessageIdName):(w.tla("OkValid","None"),w.hide()),d(ha)),Fd.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",hh.a.Tc(I.Errors))):w.hide()}};nb.prototype.lRg=function(){var d={};d.Command=this.command;d.RuleType=this.Ed.ruleType;d.ConditionType=this.Ed.tB;d.IsIgnoreBlank=this.Ed.n5;d.IsInCellDropDown=this.Ed.o5;d.LowerBoundary=this.Ed.aO;d.UpperBoundary=this.Ed.bO;d.IsAlertBlocking=
this.Ed.VZ;d.IsShowErrorAlert=this.Ed.y5;d.IsShowInputMessage=this.Ed.z5;d.AlertTitle=this.Ed.bU;d.AlertMessage=this.Ed.aU;d.InputTitle=this.Ed.gF;d.InputMessage=this.Ed.JV;d.ShouldIgnoreFormulaError=this.ZMa;return d};nb.prototype.led=function(d){switch(d){case 1173235830:return te.a.instance.fa(1673);case 43935303:return te.a.instance.fa(1674);case -1323438439:return te.a.instance.fa(1676);case 2112020473:return te.a.instance.fa(1670);case -219503282:return te.a.instance.fa(1671);case 1689335445:return te.a.instance.fa(1672);
case 2146493810:return te.a.instance.fa(1675);case -2104909922:return String.format(te.a.instance.Cb(104),this.ztb,this.cNd);case -869372599:return String.format(te.a.instance.Cb(103),this.ztb);case -1181828368:return te.a.instance.fa(1678);case -758480861:return te.a.instance.fa(1679);case -13729088:return te.a.instance.fa(1680);case -846654055:return te.a.instance.fa(1681);case 751854001:return te.a.instance.fa(1682);case -453846397:return te.a.instance.fa(1683);case 1102013489:return te.a.instance.fa(1684);
case 835813260:return te.a.instance.fa(1685);case 1577787509:return te.a.instance.fa(1686);case 2083564019:return te.a.instance.fa(1677);default:Fd.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",d.toString())}return null};nb.prototype.Zla=function(){this.tla("Cancel","None")};nb.prototype.UW=function(d){Fd.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog {0} was clicked.",1===d?"Ok":"Cancel");var w={};d=(w.ButtonType=
nb.yia(d),w.DialogName=this.Ac,w.Location="dialog",w.NumberOfSelectedRanges=Ne.g(this.$).ha.va.TK,w);og.b(this.$).ee(nf.a.W5b,d)};nb.prototype.tla=function(d,w){var I={};nb.Srb(this.Ed,I);I.o=d;I.p=w;I.n=this.Fka;this.gh&&(this.gh.stop(),I.q=this.gh.id);fh.b().Pe(49,I,!0)};nb.prototype.Dac=function(d){this.Ed.ruleType=d.RuleType;this.Ed.tB=d.RuleOperatorType;this.Ed.aO=d.OperatorInput1;this.Ed.bO=d.OperatorInput2;this.Ed.VZ=d.IsAlertBlocking;this.Ed.y5=d.IsShowErrorAlert;this.Ed.bU=d.AlertTitle;this.Ed.aU=
d.AlertMessage;this.Ed.z5=d.IsShowInputMessage;this.Ed.gF=d.InputTitle;this.Ed.JV=d.InputMessage;this.Ed.n5=d.IsIgnoreBlank;this.Ed.o5=d.IsInCellDropDown;this.ztb=d.firstOperatorLabel;this.cNd=d.secondOperatorLabel};nb.prototype.eOb=function(d,w,I){var ha;var wa=ha=null;if(!d)return I?(ha=String.format(te.a.instance.Cb(104),this.ztb,this.cNd),wa="DataValidationEditNoMinMaxError"):(ha=String.format(te.a.instance.Cb(103),this.ztb),wa="DataValidationEditNoValueError"),{returnValue:!1,errorString:ha,
xq:wa};if(d.length>Sc.x9f)return ha=te.a.instance.fa(1677),{returnValue:!1,errorString:ha,xq:wa};if(Vh.d(d))return{returnValue:!0,errorString:ha,xq:wa};if(1===w||2===w||6===w){if(!k.a.s5(d))return ha=te.a.instance.fa(1670),{returnValue:!1,errorString:ha,xq:wa};if(1===w&&!k.a.isInteger(d))return ha=te.a.instance.fa(1671),{returnValue:!1,errorString:ha,xq:wa};if(6===w){if(!k.a.isInteger(d))return ha=te.a.instance.fa(1671),{returnValue:!1,errorString:ha,xq:wa};if(0>parseInt(d,10))return ha=te.a.instance.fa(1672),
{returnValue:!1,errorString:ha,xq:wa}}}return{returnValue:!0,errorString:ha,xq:wa}};nb.prototype.yZd=function(){var d=this,w;var I=w=null;var ha=this.Ed.aO,wa=this.Ed.bO,$a=Vj[this.Ed.ruleType],Tb=cj[this.Ed.tB];if(0===$a)return{returnValue:!0,errorString:w,xq:I};var Ic=(0===Tb||1===Tb)&&3!==$a&&7!==$a;return!function(){var pc=d.eOb(ha,$a,Ic);w=pc.errorString;I=pc.xq;return pc}().returnValue||Ic&&!function(){var pc=d.eOb(wa,$a,Ic);w=pc.errorString;I=pc.xq;return pc}().returnValue?{returnValue:!1,
errorString:w,xq:I}:Ic&&(1===$a||2===$a||6===$a)&&!Vh.d(ha)&&!Vh.d(wa)&&parseFloat(ha)>parseFloat(wa)?(w=te.a.instance.fa(1675),I="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:w,xq:I}):{returnValue:!0,errorString:w,xq:I}};nb.yia=function(d){switch(d){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Fd.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}};nb.Srb=function(d,w){w.a=ue(d.ruleType);
w.b=Lf(d.tB);w.c=!!d.aO;w.d=!!d.bO;w.e=d.n5;w.f=d.o5;w.g=d.z5;w.h=!!d.gF;w.i=!!d.JV;w.j=d.y5;w.k=d.VZ;w.l=!!d.bU;w.m=!!d.aU};Sk.Object.defineProperties(nb.prototype,{Ed:{configurable:!0,enumerable:!0,get:function(){return this.pRb}},Ac:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},u1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.Ed.ruleType}}});Object(Hd.a)(nb,"DataValidationEditDialog",uj.a,[]);var xk=b(304);Ve.Abh="DataValidationDialogPanel";Ve.zbh=
"DataValidationButtonPanel";Ve.ybh="DataValidationButtonClearAll";Object(Hd.a)(Ve,"CssClassNames",null,[]);var ck=tg.a;vm(Ae,ck);Ae.prototype.render=function(d){d.appendChild(this.domElement)};Ae.prototype.Yja=function(){return this.isVisible};Ae.prototype.Hna=function(d){return this.isVisible=d};Ae.prototype.setFocus=function(){};Ae.prototype.dispose=function(){this.un();this.wk=this.lba=this.kba=this.qbf=this.jba=null;ck.prototype.dispose.call(this)};Ae.prototype.ska=function(){this.domElement.innerHTML=
Sc.Reh;this.jba=Rc.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.qbf=Rc.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.lba=Rc.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.kba=Rc.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.jba.checked=!0;this.cl();this.mnc(null)};Ae.prototype.vAa=function(d){this.lba.value=void 0===d.gF||null===d.gF?"":d.gF;this.kba.value=void 0===
d.JV||null===d.JV?"":d.JV;this.jba.checked=d.z5;this.mnc(null)};Ae.prototype.lpb=function(d){d.gF=this.lba.value;d.JV=this.kba.value;d.z5=this.jba.checked};Ae.prototype.cl=function(){Oh.a.instance.qa(sg.a.change,this.jba,this.mnc);Oh.a.instance.qa(sg.a.change,this.jba,this.wk);Oh.a.instance.qa(sg.a.change,this.lba,this.wk);Oh.a.instance.qa(sg.a.Sb,this.lba,this.wk);Oh.a.instance.qa(sg.a.change,this.kba,this.wk);Oh.a.instance.qa(sg.a.Sb,this.kba,this.wk)};Ae.prototype.un=function(){Oh.a.instance.za(sg.a.change,
this.jba,this.mnc);Oh.a.instance.za(sg.a.change,this.jba,this.wk);Oh.a.instance.za(sg.a.change,this.lba,this.wk);Oh.a.instance.za(sg.a.Sb,this.lba,this.wk);Oh.a.instance.za(sg.a.change,this.kba,this.wk);Oh.a.instance.za(sg.a.Sb,this.kba,this.wk)};Sk.Object.defineProperties(Ae.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return te.a.instance.fa(1660)}}});Object(Hd.a)(Ae,"DataValidationEditInputControl",tg.a,[802,3,805]);var ik=tg.a;vm(ze,ik);ze.prototype.render=function(d){d.appendChild(this.domElement)};
ze.prototype.Yja=function(){return this.isVisible};ze.prototype.Hna=function(d){return this.isVisible=d};ze.prototype.setFocus=function(){};ze.prototype.dispose=function(){this.un();this.wk=this.T9=this.S9=this.jUa=this.wha=this.R9=null;ik.prototype.dispose.call(this)};ze.prototype.ska=function(){this.domElement.innerHTML=Sc.Veh;this.R9=Rc.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.wha=Rc.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.jUa=
Rc.DOMElementExtensions.getElementById(this.domElement,"warningId");this.T9=Rc.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.S9=Rc.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.R9.checked=!0;this.wha.checked=!0;this.cl();this.lnc(null)};ze.prototype.vAa=function(d){this.wha.checked=d.VZ;this.jUa.checked=!d.VZ;this.T9.value=void 0===d.bU||null===d.bU?"":d.bU;this.S9.value=void 0===d.aU||null===d.aU?"":d.aU;this.R9.checked=d.y5;this.lnc(null)};
ze.prototype.lpb=function(d){d.bU=this.T9.value;d.aU=this.S9.value;d.VZ=this.wha.checked;d.y5=this.R9.checked};ze.prototype.cl=function(){Oh.a.instance.qa(sg.a.change,this.R9,this.lnc);Oh.a.instance.qa(sg.a.change,this.R9,this.wk);Oh.a.instance.qa(sg.a.change,this.wha,this.wk);Oh.a.instance.qa(sg.a.change,this.jUa,this.wk);Oh.a.instance.qa(sg.a.change,this.T9,this.wk);Oh.a.instance.qa(sg.a.Sb,this.T9,this.wk);Oh.a.instance.qa(sg.a.change,this.S9,this.wk);Oh.a.instance.qa(sg.a.Sb,this.S9,this.wk)};
ze.prototype.un=function(){Oh.a.instance.za(sg.a.change,this.R9,this.lnc);Oh.a.instance.za(sg.a.change,this.R9,this.wk);Oh.a.instance.qa(sg.a.change,this.wha,this.wk);Oh.a.instance.qa(sg.a.change,this.jUa,this.wk);Oh.a.instance.za(sg.a.change,this.T9,this.wk);Oh.a.instance.za(sg.a.Sb,this.T9,this.wk);Oh.a.instance.za(sg.a.change,this.S9,this.wk);Oh.a.instance.za(sg.a.Sb,this.S9,this.wk)};Sk.Object.defineProperties(ze.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return te.a.instance.fa(1659)}}});
Object(Hd.a)(ze,"DataValidationEditMessagesControl",tg.a,[802,3,804]);oc.prototype.v3a=function(){return this.cellRange};Object(Hd.a)(oc,"MacroRecorderRangeDataValidationChangedPayload",null,[147]);var hj=b(63),ui=xk.a;vm(Yc,ui);Yc.prototype.sSd=function(){var d={};d=(d.key=this.Ed,d);this.initializeAndShow(te.a.instance.fa(1623),this.D5c,d);Fd.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};Yc.prototype.dispose=function(){this.disposed||(this.Mec=this.alc=this.r3=
null,eg.a.Fa(this.lCb),this.lCb=null,og.b(this.$)&&og.b(this.$).OTd("DataValidationDialogCorellation"),ui.prototype.dispose.call(this),this.disposed=!0)};Yc.prototype.mv=function(d){ui.prototype.mv.call(this,d);this.Fc(2,te.a.instance.fa(1624));d=this.kV(2);var w=this.kV(1),I=this.kV(0),ha=w.parentNode;ha.appendChild(d);ha.appendChild(w);ha.appendChild(I);d.parentNode.classList.add(Ve.zbh);d.classList.add(Ve.ybh);d=document.getElementById("dataValidationTabsId");w=new Cc(this.$,document.createElement("div"),
this.vca);I=new Ae(document.createElement("div"),this.vca);ha=new ze(document.createElement("div"),this.vca);this.rci(w,I,ha);var wa;this.lCb=new uf(d,(wa=new W.a,wa.add(w),wa.add(I),wa.add(ha),wa));this.lCb.MRf();this.bV=document.getElementById("validationErrorMessageId");this.vAa();og.b(this.$)&&og.b(this.$).ATd("DataValidationDialogCorellation")};Yc.prototype.IO=function(){ui.prototype.IO.call(this);document.getElementById(this.ri("WACDialogPanel")).classList.add(Ve.Abh)};Yc.prototype.uja=function(){return Cc.uja()};
Yc.prototype.yed=function(){return"validationErrorMessageId"};Yc.prototype.rci=function(d,w,I){this.r3=d;this.Mec=w;this.alc=I};Yc.prototype.Xnj=function(){function d(){return new oc(w.selectedRanges,I)}var w=this,I={};I.IsClearAll=this.Fka;I.Command=this.command;I.RuleType=this.Ed.ruleType;I.ConditionType=this.Ed.tB;I.IsIgnoreBlank=this.Ed.n5;I.IsInCellDropDown=this.Ed.o5;I.LowerBoundary=this.Ed.aO;I.UpperBoundary=this.Ed.bO;I.IsAlertBlocking=this.Ed.VZ;I.IsShowErrorAlert=this.Ed.y5;I.IsShowInputMessage=
this.Ed.z5;I.AlertTitle=this.Ed.bU;I.AlertMessage=this.Ed.aU;I.InputTitle=this.Ed.gF;I.InputMessage=this.Ed.JV;I.ShouldIgnoreFormulaError=this.ZMa;var ha=this.$.na.ta.Zb();Ch.a(this.$.userOperationManager,function(wa,$a,Tb){return Hc(w.$.na.ta,w.selectedRanges,I,Jf.b(wa,w.Uzd),Jf.a($a),Tb,ha)},function(wa){return new Uf.a(121,0,wa,void 0,d)},null)};Yc.prototype.Rzj=function(d){return 1577787509===d};Yc.prototype.cvj=function(d){this.bV.innerText=d;this.Hz(this.kV(0));this.ZMa=!0};Yc.prototype.Aze=
function(){this.ZMa=!1;this.bV.innerText=""};Yc.prototype.led=function(d){switch(d){case 1173235830:return te.a.instance.fa(1673);case 43935303:return te.a.instance.fa(1674);case -1323438439:return te.a.instance.fa(1676);case 2112020473:return te.a.instance.fa(1670);case -219503282:return te.a.instance.fa(1671);case 1689335445:return te.a.instance.fa(1672);case 2146493810:return te.a.instance.fa(1675);case -2104909922:return String.format(te.a.instance.Cb(104),this.r3.$ub(this.Ed.ruleType,this.Ed.tB),
this.r3.Tgd(this.Ed.ruleType,this.Ed.tB));case -869372599:return String.format(te.a.instance.Cb(103),this.r3.$ub(this.Ed.ruleType,this.Ed.tB));case -1181828368:return te.a.instance.fa(1678);case -758480861:return te.a.instance.fa(1679);case -13729088:return te.a.instance.fa(1680);case -846654055:return te.a.instance.fa(1681);case 751854001:return te.a.instance.fa(1682);case -453846397:return te.a.instance.fa(1683);case 1102013489:return te.a.instance.fa(1684);case 835813260:return te.a.instance.fa(1685);
case 1577787509:return te.a.instance.fa(1686);case 2083564019:return te.a.instance.fa(1677);default:Fd.ULS.sendTraceTag(537163265,0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",d.toString())}return null};Yc.prototype.L9a=function(){Fd.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.Dac();var d=this.yZd();var w=d.errorString;var I=d.xq;if(!d.returnValue)return this.nv(w),this.tla("OkInvalidByClient",
I),!1;this.Xnj();return!0};Yc.prototype.Zla=function(){this.Dac();this.tla("Cancel","None");this.hide()};Yc.prototype.tya=function(){Fd.ULS.sendTraceTag(537163235,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.ZMa?this.Aze():this.x0c();this.jhj();this.Fka=!0};Yc.prototype.UW=function(d){var w={};d=(w.ButtonType=Yc.yia(d),w.DialogName=this.Ac,w.Location="dialog",w.NumberOfSelectedRanges=Ne.g(this.$).ha.va.TK,w);og.b(this.$).ee(nf.a.W5b,d)};Yc.prototype.jhj=function(){this.pRb=
new ae;this.vAa()};Yc.prototype.vAa=function(){this.alc.vAa(this.Ed);this.Mec.vAa(this.Ed);this.r3.vAa(this.Ed)};Yc.prototype.Dac=function(){this.r3.lpb(this.Ed);this.alc.lpb(this.Ed);this.Mec.lpb(this.Ed)};Yc.prototype.tla=function(d,w){var I={};Yc.Srb(this.Ed,I);I.o=d;I.p=w;I.n=this.Fka;this.gh&&(this.gh.stop(),I.q=this.gh.id);fh.b().Pe(49,I,!0)};Yc.prototype.eOb=function(d,w){var I;var ha=I=null;if(!d)return w?(I=String.format(te.a.instance.Cb(104),this.r3.$ub(this.Ed.ruleType,this.Ed.tB),this.r3.Tgd(this.Ed.ruleType,
this.Ed.tB)),ha="DataValidationEditNoMinMaxError"):(I=String.format(te.a.instance.Cb(103),this.r3.$ub(this.Ed.ruleType,this.Ed.tB)),ha="DataValidationEditNoValueError"),{returnValue:!1,errorString:I,xq:ha};if(d.length>Sc.x9f)return I=te.a.instance.fa(1677),{returnValue:!1,errorString:I,xq:ha};if(Vh.d(d))return{returnValue:!0,errorString:I,xq:ha};if(1===this.Ed.ruleType||2===this.Ed.ruleType||6===this.Ed.ruleType){if(!k.a.s5(d))return I=te.a.instance.fa(1670),{returnValue:!1,errorString:I,xq:ha};if(1===
this.Ed.ruleType&&!k.a.isInteger(d))return I=te.a.instance.fa(1671),{returnValue:!1,errorString:I,xq:ha};if(6===this.Ed.ruleType){if(!k.a.isInteger(d))return I=te.a.instance.fa(1671),{returnValue:!1,errorString:I,xq:ha};if(0>parseInt(d,10))return I=te.a.instance.fa(1672),{returnValue:!1,errorString:I,xq:ha}}}return{returnValue:!0,errorString:I,xq:ha}};Yc.prototype.yZd=function(){var d=this,w;var I=w=null;if(this.Fka||0===this.Ed.ruleType)return{returnValue:!0,errorString:w,xq:I};var ha=(0===this.Ed.tB||
1===this.Ed.tB)&&3!==this.Ed.ruleType&&7!==this.Ed.ruleType;return!function(){var wa=d.eOb(d.Ed.aO,ha);w=wa.errorString;I=wa.xq;return wa}().returnValue||ha&&!function(){var wa=d.eOb(d.Ed.bO,ha);w=wa.errorString;I=wa.xq;return wa}().returnValue?{returnValue:!1,errorString:w,xq:I}:ha&&(1===this.Ed.ruleType||2===this.Ed.ruleType||6===this.Ed.ruleType)&&!Vh.d(this.Ed.aO)&&!Vh.d(this.Ed.bO)&&parseFloat(this.Ed.aO)>parseFloat(this.Ed.bO)?(w=te.a.instance.fa(1675),I="DataValidationEditMaximumLessMinimumError",
{returnValue:!1,errorString:w,xq:I}):{returnValue:!0,errorString:w,xq:I}};Yc.yia=function(d){switch(d){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Fd.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Yc.Srb=function(d,w){w.a=ue(d.ruleType);w.b=Lf(d.tB);w.c=!!d.aO;w.d=!!d.bO;w.e=d.n5;w.f=d.o5;w.g=d.z5;w.h=!!d.gF;w.i=!!d.JV;w.j=d.y5;w.k=d.VZ;w.l=!!d.bU;w.m=!!d.aU};Sk.Object.defineProperties(Yc.prototype,
{Ed:{configurable:!0,enumerable:!0,get:function(){return this.pRb}},Ac:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var d=this;return function(){d.UW(1);d.L9a()}},set:function(d){Object(hj.b)(Yc.prototype,this,"onCommitDialogHandler",d)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},u1b:{configurable:!0,enumerable:!0,get:function(){return 3===this.r3.$0g}}});Object(Hd.a)(Yc,
"DataValidationEditDialogDeprecated",xk.a,[]);Tc.prototype.AHa=function(d,w,I,ha){ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new nb(d,w,I,ha)).sSd():(new Yc(d,w,I,ha)).sSd()};Tc.prototype.F4g=function(d,w){var I=new Ah.StandardDialog;I.jc=3;I.KAa(d.Ab.zZ,te.a.instance.fa(1668),w)};Tc.prototype.H4g=function(d,w){var I=new Ah.StandardDialog;I.jc=1;I.mX(d.Ab.zZ,te.a.instance.fa(1669),w)};Object(Hd.a)(Tc,"DataValidationEditDialogFactory",null,[779]);var jk=
Ye.a;vm(Nd,jk);Nd.prototype.Od=function(){this.Fd([new Uc(this.$,new Tc)])};Nd.ja=function(d){Ye.a.fe(245,new Nd(d))};Object(Hd.a)(Nd,"DataValidationEditCommandHandlerFactory",Ye.a,[]);Wc.mjg='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(Hd.a)(Wc,"FileUploadDialogHTML",null,[]);var fj=b(370),vj=Jj.a;vm(mc,vj);mc.prototype.vi=function(d,w,I,ha,wa){wa=void 0===wa?!0:wa;this.pvd=void 0===ha?!1:ha;this.SAj(w);this.wof=d;wa&&zg.AFrameworkApplication.YF(d)};mc.prototype.SAj=function(d){if(mc.wy)this.ECj(d);else{var w={};w[mc.WSg]=d;w[mc.bTg]=CommonUIStrings.l_SendFileErrorReportMessage;w[mc.cTg]=CommonUIStrings.l_SendFileErrorReportTextCaption;w[mc.pZc]="";w[mc.ZSg]=CommonUIStrings.l_UserReportLinkText;w[mc.L0b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,
Object(Sg.a)(this,this.wsi,"legacyDialogHandler"),w);this.gX(mc.hTg)}};mc.prototype.ECj=function(d){var w={},I={},ha={},wa={},$a={};d=($a.id=this.Ue,$a.bodyControls=(wa.reportErrorCheckboxProps=this.pvd?(w.label=CommonUIStrings.l_UserReportLinkText,w):null,wa.textAreaProps=this.fpf?{}:null,wa.privacyStatementLinkProps=(ha.text=CommonUIStrings.l_PrivacyStatement,ha.handler=(I.href=zg.AFrameworkApplication.Hma,I.target="_blank",I),ha),wa),$a.errorMessage=d,$a.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,
$a.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,$a);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(Sg.a)(this,this.DGd,"reactDialogHandler"),d)};mc.prototype.w9a=function(){if(!mc.wy){var d=document.getElementById(mc.eTg);d&&(d.className=mc.dTg,d.appendChild(fj.createClusteredImage(32,32,mc.aTg,null,!0,CommonUIStrings.l_DialogError)));if(d=document.getElementById(mc.fTg))d.innerText=CommonUIStrings.l_PrivacyStatement,d.href=zg.AFrameworkApplication.Hma,Dd.a.addHandler(d,
"click",Object(Sg.a)(this,this.$Qi,"onPrivacyClickHandler"));this.fpf||(d=document.getElementById(mc.pZc))&&d.parentNode&&d.parentNode.removeChild(d);this.pvd||(d=document.getElementById(mc.YSg))&&d.parentNode&&d.parentNode.removeChild(d)}};mc.prototype.IO=function(){mc.wy||(vj.prototype.IO.call(this),document.getElementById(this.ri("WACDialogPanel")).style.width=String.format("{0}px",400))};mc.prototype.wsi=function(d,w){var I=w[mc.pZc]||"",ha=!0;void 0!==w[mc.L0b]&&null!==w[mc.L0b]&&(ha=w[mc.L0b]);
this.$v(d,I,ha)};mc.prototype.DGd=function(d,w){this.$v(d,w.text||"",w.reportErrorChecked)};mc.prototype.$v=function(d,w,I){this.pof&&(I&&Fd.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.wof),this.pof(d,w,I))};mc.prototype.$Qi=function(d){zg.AFrameworkApplication.Gb.Ce(mg.a.pza,2,d)};Sk.Object.defineProperties(mc.prototype,{canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Sk.Object.defineProperties(mc,{wy:{configurable:!0,enumerable:!0,get:function(){return zg.AFrameworkApplication.sa.Qa.rw&&
zg.AFrameworkApplication.sa.Qa.gmi}}});mc.WSg="WACDialogErrorMessage";mc.bTg="WACDialogErrorReportMessage";mc.cTg="WACDialogErrorTextPrompt";mc.pZc="WACDialogInput";mc.fTg="WACDialogPrivacyText";mc.eTg="WACDialogIconPanel";mc.aTg="CancelRequest_32x32x32";mc.dTg="WACDialogIcon";mc.hTg="WACDialogTextPanel";mc.L0b="WACDialogSendFileCheckbox";mc.YSg="WACDialogSendFileCheckboxContainer";mc.ZSg="WACDialogSendFileCheckboxText";mc.$Sg="FileUploadErrorDialog";Object(Hd.a)(mc,"FileUploadErrorDialog",Jj.a,[]);
var yj=dh.a;vm(yb,yj);yb.prototype.vEg=function(d){this.addHandler("fileCollectionComplete",d)};yb.prototype.Sbj=function(d){this.removeHandler("fileCollectionComplete",d)};yb.prototype.c_g=function(d,w,I){this.DJf=w;this.gH=d;this.vEg(I);zg.AFrameworkApplication.Hma=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;d=new mc(this.d_g);zg.AFrameworkApplication.Gb.fc(mg.a.pza,pi.a.frame,yb.i2i);d.vi(0,"",null,!1,!1)};yb.prototype.Daj=function(d){this.Sbj(d)};yb.i2i=function(d,w,I,ha,wa){Dd.a.Ht(wa);
zg.AFrameworkApplication.Hma&&qb.HelperMethods.vf(zg.AFrameworkApplication.Hma,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(Hd.a)(yb,"FileCollectionOperation",dh.a,[777,3]);var Bh=bi.a;vm(wc,Bh);wc.prototype.create=function(){var d=this;Od.TaskExtensions.Ba(Rg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){d.Fb(d.cBh)},this.ma,3)};wc.prototype.dispose=function(){eg.a.Fa(this.RRb);this.RRb=null;Bh.prototype.dispose.call(this)};wc.ja=function(d){d.da.Ha(125,
new wc(d))};Sk.Object.defineProperties(wc.prototype,{cBh:{configurable:!0,enumerable:!0,get:function(){return this.RRb||(this.RRb=new yb(this.$))}}});Object(Hd.a)(wc,"FileCollectionCommandHandlerFactory",bi.a,[]);var kk=b(929),Zj=b(177),$c=b(260),De=b(1019);Wb.SGh="GalleryGeneral";Wb.UGh="GalleryNumber";Wb.QGh="GalleryCurrency";Wb.OGh="GalleryAccounting";Wb.XGh="GalleryShortDate";Wb.TGh="GalleryLongDate";Wb.ZGh="GalleryTime";Wb.VGh="GalleryPercentage";Wb.RGh="GalleryFraction";Wb.WGh="GalleryScientific";
Wb.YGh="GalleryText";Wb.ASg="ButtonComma";Wb.buttonPercentage="ButtonPercentage";Wb.keyboardNumber="KeyboardNumber";Wb.keyboardCurrency="KeyboardCurrency";Wb.keyboardDate="KeyboardDate";Wb.keyboardTime="KeyboardTime";Wb.keyboardPercentage="KeyboardPercentage";Object(Hd.a)(Wb,"RibbonFormatKind",null,[]);var vi=b(287),yh=b(665),O=b(664),Fa=b(663),Gb=vi.a;vm(tf,Gb);tf.prototype.V2=function(d){return Gb.prototype.V2.call(this,d)||this.mFh.V2(this.gcd,this.activeCell,this.format,this.Qre,this.THf,this.OHf,
this.LZb,this.eFa,this.clientCorrelationId,this.Slb,this.gib)};tf.prototype.Zl=function(){var d=[];if(this.Ecc)for(var w=yl(this.Ecc),I=w.next();!I.done;I=w.next())d.push(Fa.a(I.value));else d.push(new O.a(this.format,this.gcd,this.activeCell));return function(){return new yh.a(d)}};tf.prototype.ieb=function(){var d={OperationType:0};d.FormatCellsMultiRange=this.gcd;d.ActiveCell=this.activeCell;d.Format=this.format;d.ApplyFormatOnPivotTableValueField=this.Qre;d.PivotTableXluid=this.THf;d.PivotTableFieldCaption=
this.OHf;return d};Sk.Object.defineProperties(tf.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return ye.EwaSettings.sc()?Object(hj.a)(tf.prototype,this,"operationWorkingState"):0}},Cr:{configurable:!0,enumerable:!0,get:function(){return this.Slb}},l4:{configurable:!0,enumerable:!0,get:function(){return this.gib}},gCc:{configurable:!0,enumerable:!0,get:function(){return this.eFa}}});Object(Hd.a)(tf,"FormatCellsBatchOperation",vi.a,[]);var yc=b(200);Bd.editCell="Edited";
Bd.dependentCell="Dependents";Object(Hd.a)(Bd,"RecalcPriorityGroupType",null,[]);var Xc=b(215),xe=b(8);Object(Hd.a)(Qd,"RecalcAccuracyObject",null,[]);Cd.string="String";Cd.blank="Blank";Cd.general="General";Cd.TDh="Flexible";Object(Hd.a)(Cd,"FormattedUnitKind",null,[]);Object(Hd.a)(Ec,"RecalcResultProcessingStatistics",null,[]);Object(Hd.a)(of,"RecalcedCellInfo",null,[]);var Ie=b(106),Xe=b(59),ff=b(586);ge.prototype.dispose=function(){this.calcManager=this.Yyc=this.Gh=this.grid=this.$=null};ge.prototype.zKf=
function(d){var w;if(d&&d.rangeDeltas){for(var I=this.$ca.length,ha=0;ha<d.rangeDeltas.length;ha++)(null===(w=d.rangeDeltas[ha])||void 0===w?0:w.data)&&void 0!==d.rangeDeltas[ha].data.value&&null!==d.rangeDeltas[ha].data.value&&void 0!==d.rangeDeltas[ha].range&&null!==d.rangeDeltas[ha].range&&Array.add(this.$ca,new of(d.rangeDeltas[ha],d.stateId,d.isFinished,d.priorityGroup));Fd.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",
d.stateId,d.priorityGroup,d.isFinished,d.rangeDeltas.length,I,this.$ca.length,this.lastSetCellInstantaneousOperation);!I&&this.$ca.length&&this.lCf(!1,0)}};ge.prototype.Tad=function(d,w,I,ha,wa,$a,Tb){if(!w)return Object(ff.a)("Null");var Ic=excelOnlineCalc.numfmt.renderCallback(ha,function(vd){return gridRenderer.CanvasRendererGlobals.measureTextWidth(vd,wa,!0,ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1))},Tb),pc=d.renderValue(w,Ic);if(!excelOnlineCalc.util.isSuccess(pc))return Object(ff.a)("Finalize");
ha=null;if(Tb=excelOnlineCalc.numfmt.isHashesValue(pc.value)){if(pc=d.renderHashesValue(pc.value,Ic),!excelOnlineCalc.util.isSuccess(pc))return Object(ff.a)("Hashes")}else ha=ge.yFh(w,pc.value);Ic=pc.value;d=excelOnlineCalc.numfmt.renderedValueToString(Ic);w=Vd(Ic);Ic=Ac(Ic);return Object(ff.d)({text:d,valueType:I,fontColor:Ic,Em:$a,b9a:ha,horizontalAlignment:w,isHashesValue:Tb})};ge.prototype.lCf=function(d,w){var I=this;this.$&&this.grid&&this.calcManager&&this.Yyc&&this.calcManager.cq?(d&&(this.Uca=
this.Yyc.Gbf),this.M2i(this.grid,this.calcManager.cq,d,w),!this.Uca&&this.$ca.length?Vf.Task.delay(0).CWRCT(function(ha){I.lCf(!0,ha.id);return!0},null,0,Xe.a.current):Vf.Task.Ta(!0)):(Fd.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),Vf.Task.Ta(!1))};ge.prototype.M2i=function(d,w,I,ha){var wa=qb.HelperMethods.kc();for(I=new Ec(this.$ca.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,
void 0,this.Uca,void 0,void 0,void 0,I,void 0,ha,!0,0,0,0,0,0,0);0<this.$ca.length;){ha=qb.HelperMethods.kc()-wa;if(!this.Uca||ha>this.Uca){I.numberOfCellsSkippedDueToTimeout=this.$ca.length;break}ha=Array.dequeue(this.$ca);if(hd(ha,I)){var $a=Bi.Range.kd(ha.rangeDelta.range.row+1,ha.rangeDelta.range.column+1);($a=d.uc($a))?ge.yUg(ha.stateId,$a.cell)?(ge.Xlc(d,$a,ha,I),this.OKg(w,$a,ha,I)):I.numberOfCellsUpdatedAlreadyByServer++:I.numberOfCellsWithNoFormattedCell++}}ha=Math.round(qb.HelperMethods.kc()-
wa);this.OUj(ha);this.cIj(I,ha);this.sgj(I)};ge.prototype.OKg=function(d,w,I,ha){var wa=Re(w,I),$a=I.rangeDelta.data.formatted,Tb=vc(I);d=this.Tad(d,$a,Tb,w.cell.YSa,w.cell.qia,wa,!1);if(Object(ff.c)(d))ye.EwaSettings.isChangeGateEnabled("OfficeVSO:OfficeVSO:6123700_checkTextAlignmentColorAndApplyNumberFormat")?this.kxj(w,d.value)&&(this.Gh.nZa(w,d.value),wa=od(I),this.Gh.s8c(w,this.lastSetCellInstantaneousOperation,2,wa,!0,!0),ha.numberOfUpdatedCells++):w.text!==d.value.text&&(this.Gh.nZa(w,d.value),
wa=od(I),this.Gh.s8c(w,this.lastSetCellInstantaneousOperation,2,wa,!0,!0),ha.numberOfUpdatedCells++);else switch(d.reason){case "Null":ha.numberOfRecalcedCellsWithoutFormattedValue=null==ha.numberOfRecalcedCellsWithoutFormattedValue?0:ha.numberOfRecalcedCellsWithoutFormattedValue+1;break;case "Hashes":ha.numberOfHashFormattedValues=null==ha.numberOfHashFormattedValues?0:ha.numberOfHashFormattedValues+1;break;case "Finalize":ha.newNumberFormatterFinalizeFailures=null==ha.newNumberFormatterFinalizeFailures?
0:ha.newNumberFormatterFinalizeFailures+1}Object(ff.b)(d)&&"Null"!==d.reason&&(ha.numberOfRecalcedCellsWithFormattedValue=null==ha.numberOfRecalcedCellsWithFormattedValue?0:ha.numberOfRecalcedCellsWithFormattedValue+1);I=ke(I);ha=0===I?w.cell.userInput:w.formulaBarText;wa=Object(ff.c)(d)?d.value.text:"";$a=Object(ff.b)(d)?d.reason:"";Fd.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",
w.range.top,w.range.left,d.success,$a,I,w.cell.Em,ha?k.a.AJ(ha):"null",wa?k.a.AJ(wa):"null")};ge.prototype.OUj=function(d){this.Uca=Math.max(this.Uca-Math.max(d,1),0)};ge.prototype.cIj=function(d,w){d.numberOfNonUpdatedCells=this.$ca.length;d.totalExecutionTime=w;d.newProcessingTimeLimit=this.Uca;d.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};ge.prototype.sgj=function(d){d=Sys.Serialization.JavaScriptSerializer.serialize(d);Fd.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",
d)};ge.yFh=function(d,w){d=d.units;var I=w.units;if(d.length!==I.length)return Fd.ULS.sendTraceTag(537162179,0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;w=[];for(var ha=-1,wa=0;wa<d.length;wa++)switch(d[wa].kind){case Cd.blank:w.push.apply(w,Ie.h(" ",I[wa].str.length));break;case Cd.string:w.push(d[wa].str);break;case Cd.TDh:w.push("");ha=wa;break;case Cd.general:w.push(I[wa].str);
break;default:Fd.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=ha||""===I[ha].str)return null;I={};I.Start=w.slice(0,ha).join("");I.Separator=d[ha].str;I.End=w.slice(ha+1,w.length).join("");return I};ge.TLh=function(d){return d&&d&&d.St?d.St.DJ:xe.a.Te};ge.yUg=function(d,w){if(!w)return!1;w=ge.TLh(w);return w===xe.a.Te||w===d};ge.Xlc=function(d,w,I,ha){var wa=I.rangeDelta.data.value.toString(),$a=vc(I),Tb=Re(w,I);wa=new Qd($a,wa,Tb,
I.priorityGroup);w.cell.Xlc(wa,d.Ca.tF);1===ke(I)?ha.numberOfDependentRecalcedCellsInBatch++:ha.numberOfEditedRecalcedCellsInBatch++};ge.prototype.kxj=function(d,w){return d.text!==w.text||d.horizontalAlignment!==w.horizontalAlignment||null!=w.fontColor&&d.HAe!=w.fontColor.DS()?!0:!1};ge.iHe=20;Object(Hd.a)(ge,"CalcResultProcessor",null,[797,3]);Object(Hd.a)(kd,"GetRibbonNumberFormatResult",null,[]);ie.prototype.tJb=function(d,w,I){var ha=w.Border;w=w.BorderFormat;var wa=0,$a=!1;if(0===ha)d.cell.Xrc(),
this.sId(d.cell.getRange());else{for(var Tb=0;3>=Tb;Tb++)ie.txj(d,I,Tb,ha)&&(wa|=qb.HelperMethods.s3a(Tb),this.SXd(d.cell.getRange(),Tb,w),$a=!0);qb.HelperMethods.nR(ha,16)&&!Vh.c(d,0,I)&&(wa|=2,this.SXd(d.cell.getRange(),0,w),$a=!0);qb.HelperMethods.nR(ha,32)&&!Vh.c(d,2,I)&&(wa|=4,this.SXd(d.cell.getRange(),2,w),$a=!0);$a&&(I=d.cell.St.Zf,qb.HelperMethods.nR(wa,2)&&this.U2f(d,I,0)&&(wa&=-3),qb.HelperMethods.nR(wa,1)&&this.T2f(d,I,1)&&(wa&=-2),qb.HelperMethods.nR(wa,4)&&this.U2f(d,I,2)&&(wa&=-5),
qb.HelperMethods.nR(wa,8)&&this.T2f(d,I,3)&&(wa&=-9),d.cell.setBorders(w,wa,!1))}};ie.prototype.BZ=function(d,w){d=ie.AXe(d,w);return d.isValidRange?(d=this.Ca.VJa(d))&&d.length?d:null:null};ie.prototype.sId=function(d){for(var w=0;3>=w;w++){var I=ie.AXe(d,w);if(I.isValidRange&&(I=this.Ca.VJa(I))&&I.length)for(var ha=ie.N1e(w),wa=0;wa<I.length;wa++)I[wa].rId(ha)}};ie.prototype.SXd=function(d,w,I){if(d=this.BZ(d,w))for(var ha=ie.N1e(w),wa=qb.HelperMethods.s3a(ha),$a=0;$a<d.length;$a++){var Tb=d[$a];
this.fgi(Tb,ha)&&ie.setBorders(Tb,I,wa,w,ha)}};ie.prototype.fgi=function(d,w){var I=d.St.Zf,ha=d.getRange();ha=this.BZ(ha,w);var wa=!1,$a=!1,Tb=!1,Ic=!1;ha&&(wa=ie.w6a(ha,!0),$a=ie.w6a(ha,!1),Ic=ie.npd(ha),Tb=1===ha.length?!0:!1);switch(w){case 0:return ie.ufi(d,I,Ic,$a,Tb);case 1:return ie.rfi(d,I,Ic,wa,Tb);case 2:return ie.sfi(d,I,Ic,wa,Tb);case 3:return ie.tfi(d,I,Ic,$a,Tb)}return!1};ie.prototype.U2f=function(d,w,I){if(!d.cell.nN)return!1;var ha=d.range,wa=this.BZ(ha,I),$a=Vh.c(d,I,w),Tb=!1;w=
0===I?ha.top<w.top:ha.left<w.left;!ie.dzb(d.cell)&&wa&&1!==wa.length&&(Tb=(0===I?ie.w6a(wa,!0):ie.w6a(wa,!1))?!1:!0);return!$a&&Tb||w?!0:!1};ie.prototype.T2f=function(d,w,I){var ha=d.cell,wa=this.BZ(ha.getRange(),I);d=Vh.c(d,I,w);w=!1;if(wa){var $a=ie.w6a(wa,!0),Tb=ie.w6a(wa,!1),Ic=$a&&!Tb;Tb=Tb&&!$a;1!==I||ie.Tzb(ha)?3!==I||ie.Tyb(ha)||ie.Axj(ha,wa,Tb,Ic)&&(w=!0):ie.zxj(ha,wa,$a,Tb)&&(w=!0)}return!d&&w||ie.dzb(ha)?!0:!1};ie.YPg=function(d,w,I){var ha={};ha.LineStyle=Array(4);ha.LineStyle[I]=d.LineStyle[w];
ha.Color=Array(4);ha.Color[I]=d.Color[w];return ha};ie.Qcf=function(d,w,I,ha,wa){return qb.HelperMethods.nR(d,wa)&&Vh.c(w,I,ha)};ie.txj=function(d,w,I,ha){return ie.Qcf(ha,d,I,w,qb.HelperMethods.s3a(I))||ie.Qcf(ha,d,I,w,64)||112===ha};ie.setBorders=function(d,w,I,ha,wa){w=ie.YPg(w,ha,wa);d.setBorders(w,I,!1)};ie.AXe=function(d,w){switch(w){case 0:return new Bi.Range(d.top-1,d.left,d.top-1,d.right,!1,!1);case 2:return new Bi.Range(d.top,d.left-1,d.bottom,d.left-1,!1,!1);case 1:return new Bi.Range(d.bottom+
1,d.left,d.bottom+1,d.right,!1,!1);case 3:return new Bi.Range(d.top,d.right+1,d.bottom,d.right+1,!1,!1)}return d};ie.N1e=function(d){switch(d){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};ie.w6a=function(d,w){for(var I=0;I<d.length;I++){var ha=d[I];if(ha.nN)return w?ie.Tyb(ha):ie.Tzb(ha)}return!1};ie.dzb=function(d){var w=d.St.Zf,I=d.getRange();return d.nN&&(I.top<w.top||I.bottom>w.bottom||I.left<w.left||I.right>w.right)?!0:!1};ie.npd=function(d){for(var w=0;w<d.length;w++)if(ie.dzb(d[w]))return!0;
return!1};ie.zxj=function(d,w,I,ha){if(!d.nN){if(!I||ie.npd(w))return!0}else if(ie.Tyb(d)&&(1===w.length&&ie.hLg(d,w[0])||!I))return!0;return ha};ie.Axj=function(d,w,I,ha){if(!d.nN){if(!I||ie.npd(w))return!0}else if(ie.Tzb(d)&&(1===w.length&&ie.iLg(d,w[0])||!I))return!0;return d.Zka||ha};ie.ufi=function(d,w,I,ha,wa){var $a=d.getRange();return ie.Tyb(d)?ie.dzb(d)||wa:w.top===$a.top||!ha||I};ie.rfi=function(d,w,I,ha,wa){var $a=d.getRange();return ie.Tyb(d)?w.bottom===$a.bottom&&wa:ha&&!I||w.bottom===
$a.bottom};ie.sfi=function(d,w,I,ha,wa){var $a=d.getRange();return ie.Tzb(d)?ie.dzb(d)||wa:w.left===$a.left||!ha||I};ie.tfi=function(d,w,I,ha,wa){var $a=d.getRange();return d.Zka?!1:ie.Tzb(d)?w.right===$a.right&&wa:ha&&!I||w.right===$a.right};ie.Tyb=function(d){return 0<d.getRange().right-d.getRange().left};ie.Tzb=function(d){return 0<d.getRange().bottom-d.getRange().top};ie.iLg=function(d,w){d=d.getRange();w=w.getRange();return d.top===w.top&&d.bottom===w.bottom};ie.hLg=function(d,w){d=d.getRange();
w=w.getRange();return d.left===w.left&&d.right===w.right};Object(Hd.a)(ie,"BorderModelAccessorHelper",null,[]);Zd.prototype.tcb=function(d,w,I,ha,wa,$a){d&&(d.q7(w,I,void 0===wa?!1:wa,void 0===$a?!1:$a),d.verticalAlignment=ha)};Zd.prototype.tJb=function(d,w,I){this.gE||(this.gE=new ie(this.Ca,this.w2a));this.gE.tJb(d,w,I)};Object(Hd.a)(Zd,"FormatCellsActionModelAccessor",null,[796]);mf.prototype.isValid=function(){return this.Dl&&this.cq?!(void 0===this.formatString||null===this.formatString):!1};
mf.prototype.aSh=function(){return null!=this.UE?this.UE:this.formatString};Sk.Object.defineProperties(mf.prototype,{UE:{configurable:!0,enumerable:!0,get:function(){return this.fpg}},formatString:{configurable:!0,enumerable:!0,get:function(){if(this.d9a)return this.d9a;if(this.Mqa)return this.Mqa.formatString;if(!this.Dl)return null;if(null!=this.UE){var d=this.UE;return 0>d?(Fd.ULS.shipAssertTag(537162126,0,!1,"NumberFormatHolder.FormatString: ifmt is negative!"),null):(d=this.Dl.mca[d])?this.d9a=
d.FormatString:null}return null}},numberFormat:{configurable:!0,enumerable:!0,get:function(){return this.Mqa?this.Mqa:this.cq&&this.formatString?this.Mqa=this.cq.createFormat(this.formatString,this.tSg).value:null}},tSg:{configurable:!0,enumerable:!0,get:function(){if(!this.Dl||null==this.UE||0>this.UE)return!1;var d=this.Dl.mca[this.UE];return d?d.Builtin:!1}}});Object(Hd.a)(mf,"NumberFormatHolder",null,[795]);var zf=b(246);Object(Hd.a)(Sf,"FormatCellInstantaneousResult",null,[]);Object(Hd.a)(Qe,
"FormatStringResult",null,[]);var Yg=b(1185),Hg=b(526),Gg=b(192),Zh;(function(d){d.InvalidInput="invalid input";d.UnsupportedZeroResize="resizing to 0 - ignore";d.UnsupportedSkeletonInView="skeleton in view - ignore";d.NullSPD="ActiveSheetProcessedData is null";d.UnsupportedHiddenInRange="hiddens in resizeRanges";d.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(Zh||(Zh={}));Object(Hd.b)("InstantaneousRowColumnResizeFailureReason",Zh);var Wi=b(307);sd.prototype.dispose=
function(){eg.a.rc([this.qSa,this.Y2]);this.$=this.Y2=this.qSa=null};sd.prototype.iSa=function(d,w,I,ha,wa,$a,Tb,Ic,pc){return this.HBj(d,w,I,void 0===wa?!1:wa,void 0===Ic?0:Ic,void 0===$a?"":$a,void 0===pc?null:pc)};sd.prototype.s8c=function(d,w,I,ha,wa,$a){d.cell.St.xQ|=ha;sd.N0g(Ne.g(this.$),d,I,wa);this.Y2.lastSetCellInstantaneousOperation=w;$a&&Ne.g(this.$).Mi.O0(w,Xg.BasicTelemetryCalculator.hR)};sd.prototype.$da=function(d,w,I,ha,wa,$a){ha=void 0===ha?!1:ha;wa=void 0===wa?null:wa;var Tb=void 0===
Tb?null:Tb;$a=(void 0===$a?null:$a)||d.ha.va.selectedRanges;if(!(-1690267012===w&&1<$a.length)){-1690267012===w&&Fd.ULS.shipAssertTag(537162176,0,1===$a.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",$a.length);var Ic=d.N$("FormatCellsAction.ShowInstantaneousFormatting",$a);try{Ic.$$rst();for(var pc=!1;Ic.$$mn();){var vd=void 0,ne=Ic.$$cu().NH?d.QIb(Ic.$$cu().range):(vd=new W.a,vd.add(Ic.$$cu()),vd);vd={};for(var Pe=yl(ne),Af=Pe.next();!Af.done;vd={Nfb:vd.Nfb},Af=
Pe.next()){var Wf=Af.value;if(Ne.g(this.$).kz&&Wf&&Tb&&-1690267012===w&&(vd.Nfb=Wf.range,vd.Nfb&&Tb.contains(vd.Nfb)&&ih.a.all($a,function(Of){return function(xg){return!td.c(xg,Of.Nfb)}}(vd))))continue;if(!Wf||Ic.jd.contains(Wf.range))if(this.IBj(w,Wf,I,ha,wa,Ic.$$cu().NH),pc||(d.Ca.NV(),pc=!0),wa)break}}}finally{Ic&&Ic.dispose()}}};sd.prototype.nZa=function(d,w,I){if(I=void 0===I?null:I)I.GLa=!0;I=!w.text;var ha=k.a.ngf(w.text),wa,$a=d.NH?Ne.g(this.$).QIb(d.range):(wa=new W.a,wa.add(d),wa);wa=yl($a);
for($a=wa.next();!$a.done;$a=wa.next())this.MKg(this.$,$a.value,w.text,w.horizontalAlignment,w.fontColor,w.Em,d.cell.Em,I,ha,w.valueType,w.b9a);d.cell.VBc()};sd.prototype.KYi=function(d,w,I,ha,wa){wa=void 0===wa?null:wa;try{var $a=td.D(w),Tb=td.D(I);if(d.Rb.x6a($a)||d.Rb.x6a(Tb))return 8;if(-185374993!==ha&&this.Pni(d,$a,Tb))return 9;if(-185374993!==ha&&(d.Rb.u5(Tb)||d.Rb.qzb($a)))return 10;if(1804571062!==ha&&d.Rb.Ska(Tb))return 11;if(this.Ghh(Tb))return 12;if(this.Eoi($a,Tb))return 13;var Ic=this.$.Vb.Hc("UserAction",
"PasteInstantaneous");Ic.start();Hg.a(Ic);wa&&fh.b().XB(Ic.id,wa.id,"actions","actions");!$a.isSingle&&Tb.isSingle&&(Tb=sd.expandRange($a,Tb),d.ha.updateSelection(Tb,Tb,0));switch(ha){case 237279923:case 808159687:if(!this.cZi($a,Tb))return 14;this.d3c(d,$a,Tb,!0,!1);break;case 1804571062:this.d3c(d,$a,Tb,!0,!1);break;case -185374993:this.d3c(d,$a,Tb,!1,!0);break;default:return 2}Fd.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(pc){return Fd.ULS.sendTraceTag(537162145,
0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",JSON.stringify(pc)),15}};sd.prototype.JYg=function(d,w){d=yl(d);for(var I=d.next();!I.done;I=d.next())this.G0c(I.value,!0,w)};sd.prototype.G0c=function(d,w,I){I=void 0===I?"":I;if(d){var ha=Ne.g(this.$);if(w){if(w=ha.xl("FormatCellsAction.ClearRangeInstantaneous",d),d=d.isSingle?null:d,w.$$mn()&&void 0!==w.$$cu()&&null!==w.$$cu())for(ha=Object.assign(new gc.a,{Text:""}),this.iSa(w.$$cu(),ha,!1,void 0,yg.a.Zod(this.$),
I,void 0,void 0,d);w.$$mn();)void 0!==w.$$cu()&&null!==w.$$cu()&&this.iSa(w.$$cu(),ha,!1,void 0,!1,I)}else this.$da(ha,-1228228458,{},void 0,void 0,[d])}else Fd.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};sd.prototype.m8i=function(d,w){if(!w){w=qb.HelperMethods.kc();var I=Ne.g(this.$),ha=I.N$("FormatCellsAction.ReformatCells",d);try{ha.$$rst();for(var wa=!1;ha.$$mn();){var $a=ha.$$cu().cell;if(0===$a.qU||2===$a.qU)this.yUj($a,d),wa||
(I.Ca.NV(),wa=!0)}}finally{ha&&ha.dispose()}Fd.ULS.sendTraceTag(537162143,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",qb.HelperMethods.kc()-w)}};sd.prototype.qjd=function(d,w){if(this.Dg){if(d.formulaBarText)return!k.a.equals(w.Text,d.formulaBarText,!1);var I=d.cell.formattedText;I=zf.a(I,d.cell.getCellFont());return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(I,w).isEqual}return!k.a.equals(w.Text,d.text,!1)};sd.prototype.QVe=function(d){if(void 0===
d||null===d)return new Qe(!1,"1234.56");d=new mf(this.Dl,this.cq,void 0,d);if(!d.isValid())return new Qe(!1,"1234.56");d=this.T2a({value:"1234.56",type:1},d,244,"12px sans-serif");return Object(ff.b)(d)?new Qe(!1,"1234.56"):new Qe(!0,d.value.text)};sd.prototype.JBj=function(d,w,I,ha){return Fe(d,this,w,I,ha,!0)};sd.prototype.FBj=function(d,w,I){if(!this.qjd(w,I))return Object(ff.d)("Skip unchanged cell content");w=w.cell;var ha=new mf(this.Dl,this.cq,w.Em);I=this.SVe(I.Text,ha,w.YSa,w.qia,!0);if(Object(ff.b)(I))d=
I;else{I=I.value;ha=I.text;var wa=I.valueType;ha=w.hasRichValueIcon?"Unsupported rich value icon":w.o1?ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EstimateWrapTextEditResize",!1)&&2==wa&&'normal 11pt "calibri"'===w.qia&&w.kCe(ha)>=w.offsetWidth*Math.floor(w.offsetHeight/xe.a.Jrb)?"Unsupported wrapped text with long input":"Unsupported wrapped text":w.Vzb||null!=w.y9f&&0!==w.y9f?"Unsupported rotated text":!0;!0!==ha?d=Object(ff.a)(ha):(w.isCellWidthFixed?ha="Skip fixed width cell":
(ha=I.valueType,ha=0===ha?"Skip empty cell value":2===ha?"Skip string cell value":w.nN&&!w.Ini?"Skip merged cell":w.Pxc?"Skip shrunk to fit":I.isHashesValue?"Skip hashes cell value":!0),!0!==ha?d=Object(ff.d)(ha):(I=w.kCe(I.text),I>w.offsetWidth?(w=[w.getRange().clone()],d=Fe(d,this,w,I,!1,!1),d=Object(ff.b)(d)?d:Object(ff.d)(I)):d=Object(ff.d)("Column is wide enough")))}return d};sd.prototype.tFh=function(d,w,I){var ha=Number.POSITIVE_INFINITY;w=new mf(this.Dl,this.cq,w);if(!w.isValid())return new Qe(!1,
d);var wa={};wa.value=d;wa.type=1;I=this.T2a(wa,w,ha,I);return Object(ff.b)(I)?new Qe(!1,d):new Qe(!0,I.value.text)};sd.prototype.yUj=function(d,w){var I=d.getRange(),ha=!1;w=yl(w);for(var wa=w.next();!wa.done;wa=w.next())if(I.left===wa.value.left){ha=!0;break}d.IRj(ha)};sd.prototype.HBj=function(d,w,I,ha,wa,$a,Tb){var Ic=void 0;$a=void 0===$a?"":$a;Ic=void 0===Ic?1:Ic;Tb=void 0===Tb?null:Tb;var pc=new Sf;pc.source=0;pc.GLa=!1;d.cell.Qoc=d.cell.Em;var vd=w.Text,ne=!vd,Pe=k.a.ngf(vd);k.a.Gn(vd)&&(Fd.ULS.shipAssertTag(537162142,
0,!((void 0===vd||null===vd)&&void 0!==w.TextRuns&&null!==w.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),w=Object.assign(new gc.a,{Text:""}),vd="");d.cell.userInput=vd;if(!this.qjd(d,w))return this.gWg(d,wa,ne,Pe,pc);I?this.$Vg(d,vd,this.$.workbookContext.DefaultHyperlinkStyle,pc):this.UVg(d,w,vd,ne,Pe,ha,pc,Tb);this.s8c(d,$a,wa,Ic,pc.qhc,pc.GLa);return pc};sd.prototype.gWg=function(d,w,I,ha,wa){wa.Zfg=!0;wa.qhc=!0;wa.GLa=!1;0===w&&Ne.g(this.$).Ca.NV();
0===d.cell.Uya&&(I?d.cell.q7(0,!1):ha&&d.cell.q7(1,!1));return wa};sd.prototype.$Vg=function(d,w,I,ha){ha.GLa=!0;d.insertHyperlink(w,yc.a.tbd(w),I)};sd.prototype.UVg=function(d,w,I,ha,wa,$a,Tb,Ic){Ic=void 0===Ic?null:Ic;Tb.GLa=!1;var pc=d.cell;this.Dl||(this.Dl=this.$.da.Aa(268));this.INj(this.Dl,pc.Em);ha||wa?this.WVg(d,ha,wa,Tb):(ha=new mf(this.Dl,this.cq,pc.Em),ha=this.SVe(I,ha,pc.YSa,pc.qia,!1),Object(ff.c)(ha)?(this.Gyj(w.TextRuns,w.Fonts)&&this.YVg(d,w,ha.value),this.nZa(d,ha.value,Tb)):this.dWg(d,
w.Text),w=Object(ff.c)(ha)?ha.value.text:"",wa=Object(ff.b)(ha)?ha.reason:"",Fd.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",d.range.top,d.range.left,ha.success,wa,pc.Em,k.a.Pnb(pc.userInput),k.a.Pnb(w)));pc.formulaBarText=I;$a&&this.nNj(this.Dl,d,I,Ic);Tb.qhc=!0};sd.prototype.WVg=function(d,w,I,ha){ha.GLa=!0;d.text="";d.formulaBarText="";d.cell.userInput="";this.B_c(d,null,
null,w,I)};sd.prototype.YVg=function(d,w,I){w.Text===I.text&&2===I.valueType&&(d.cell.formattedText=w)};sd.prototype.dWg=function(d,w){d.text=w;d.formulaBarText=w;this.B_c(d,1)};sd.prototype.B_c=function(d,w,I,ha,wa,$a){I=void 0===I?null:I;ha=void 0===ha?!1:ha;wa=void 0===wa?!1:wa;$a=void 0===$a?!1:$a;var Tb=d.horizontalAlignment;I=null!=I?I:d.verticalAlignment;0===d.cell.Uya&&(null!=w||ha||wa||$a)&&(ha?Tb=0:wa||$a?Tb=1:null!=w&&(Tb=w),this.Nua.tcb(d,Tb,!1,I,!0))};sd.prototype.INj=function(d,w){(null===
d||void 0===d?0:d.mca)&&w>=sd.zDh&&w>d.mca.length-1&&(Fd.ULS.sendTraceTag(537162141,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",w),d.JVe())};sd.prototype.nNj=function(d,w,I,ha){ha=void 0===ha?null:ha;if(void 0!==d&&null!==d)if(this.Dl.xmd)Fd.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var wa=this.$.da.Aa(266);wa&&(this.Y2.Uca=ge.iHe,d&&(this.Y2.Uca=d.Gbf),wa.NTg(w,
I,Object(Sg.a)(this.Y2,this.Y2.zKf,"processResults"),ha))}};sd.prototype.T2a=function(d,w,I,ha){var wa=this.$.da.Aa(266);if(!wa)return Object(ff.a)("calcManager is null");if(!wa.cq)return Object(ff.a)("calcManager.NumberFormatter is null");if(!this.Dl)return Object(ff.a)("instantaneousManager is null");if(!w||!w.isValid())return Object(ff.a)("numberFormatHolder is invalid or null");var $a=wa.Xfd(w);if(null===$a)return Object(ff.a)("cellFormat is null");var Tb=wa.cq,Ic=lf(d);if(void 0===Ic||null===
Ic)return Object(ff.a)("cellValue is null");wa=excelOnlineCalc.calc.cellValueToReadOper(wa.config.mathpack,Ic);if(void 0===wa||null===wa)return Object(ff.a)("readOper is null");$a=Tb.applyFormat($a,wa);return excelOnlineCalc.util.isSuccess($a)?this.Y2.Tad(Tb,$a.value,d.type,I,ha,null!=w.UE?w.UE:-1,!1):Object(ff.a)("NumberFormatter.ApplyFormat: "+JSON.stringify($a.reason.kind))};sd.prototype.SVe=function(d,w,I,ha,wa){var $a=this.$.da.Aa(266);if(void 0===$a||null===$a)return Object(ff.a)("calcManager is null");
if(void 0===$a.cq||null===$a.cq)return Object(ff.a)("calcManager.NumberFormatter is null");if(void 0===this.Dl||null===this.Dl)return Object(ff.a)("instantaneousManager is null");if(void 0===w||null===w||!w.isValid())return Object(ff.a)("numberFormatHolder is invalid or null");if(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseNumberFormatterInWebWorker",!1))return Object(ff.a)("No main thread number formatter");var Tb=$a.Xfd(w);if(void 0===Tb||null===Tb)return Object(ff.a)("cellFormat is null");
var Ic=$a.cq;d=Ic.parseEdit(d,Tb);if(!excelOnlineCalc.util.isSuccess(d))return Object(ff.a)("ParseEdit failure: reason="+d.reason.kind+", features="+d.reason.features);if(d.value.kind===De.a.formula)return Object(ff.a)("Main thread - skipping formula edit");$a=excelOnlineCalc.numfmt.applyValueEdit(Ic,$a.localeInfo,Tb,d.value);if(!excelOnlineCalc.util.isSuccess($a))return Object(ff.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify($a.reason.kind));Tb=d.value;Fd.ULS.shipAssertTag(537162190,0,Tb.kind!==
De.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");Tb=excelOnlineCalc.numfmt.getValueEditOperKind(Tb);d=0;switch(Tb){case 0:case 128:d=0;break;case 1:d=1;break;case 2:d=2;break;case 4:d=3;break;case 8:d=4;break;case 16:case 32:case 64:case 256:Fd.ULS.sendTraceTag(537162189,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",Tb);break;default:Fd.ULS.shipAssertTag(537162188,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",
Tb)}return this.Y2.Tad(Ic,$a.value,d,I,ha,null!=w.UE?w.UE:-1,wa)};sd.prototype.Pni=function(d,w,I){if(w.width<I.width)for(var ha=d.xl("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new Bi.Range(w.top,w.left,w.bottom,w.left,!0,!0));ha.$$mn();){var wa=ha.$$cu();if(wa&&wa.WKa())return Fd.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0}if(w.height<I.height)for(d=d.xl("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new Bi.Range(w.top,
w.left,w.top,w.right,!0,!0));d.$$mn();)if((w=d.$$cu())&&w.$Ka())return Fd.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};sd.prototype.d3c=function(d,w,I,ha,wa){for(var $a=w.HL().FirstRow,Tb=w.HL().LastRow,Ic=I.HL().LastRow,pc=$a,vd=I.HL().FirstRow;vd<=Ic;vd++,pc++){pc>Tb&&(pc=$a);var ne=w.HL();ne.FirstRow=ne.LastRow=pc;var Pe=I.HL();Pe.FirstRow=Pe.LastRow=vd;this.H3g(d,Zj.a.VQ(ne),Zj.a.VQ(Pe),ha,wa)}};sd.prototype.cZi=function(d,
w){var I=this.$.da.Aa(266);return void 0!==I&&null!==I?(I.HTg(d,w.topLeft,Object(Sg.a)(this.Y2,this.Y2.zKf,"processResults")),!0):!1};sd.prototype.Eoi=function(d,w){var I=d.right-d.left+1;d=d.bottom-d.top+1;var ha=w.right-w.left+1;w=w.bottom-w.top+1;if(ha>I&&w>d){if(!(ha%I&&w%d))return!0}else if(ha===I&&w>d){if(!(w%d))return!0}else if(ha>I&&w===d&&!(ha%I))return!0;return!1};sd.prototype.Ghh=function(d){if(ye.EwaSettings.la(103)){d=Ne.g(this.$).k1(d).gridView.getRangeInformation(d);d=yl(d);for(var w=
d.next();!w.done;w=d.next())if(w=w.value,Object(cf.a)($c.DynamicArrayRange,w)&&!Object(qc.a)($c.DynamicArrayRange,w).Olc)return!0}return!1};sd.prototype.$Ce=function(d,w,I,ha,wa,$a){w=yl(w);for(var Tb=w.next();!Tb.done;Tb=w.next())Tb=Tb.value,I&&(this.L3g(Tb,wa),Tb.setCell(!0)),ha&&($a=this.J4h(wa,Tb)),$a||(d.Ca.NV(),$a=!0);return $a};sd.prototype.VQh=function(d,w,I){w=new Bi.Range(w,I,w,I,!0,!0);return d.uc(w)};sd.prototype.H3g=function(d,w,I,ha,wa){if(I){this.qSa&&I.equals(this.qSa.range)||(eg.a.Fa(this.qSa),
this.qSa=d.xl("FormatCellsAction.CopyBetweenRows",I));I=this.qSa;I.$$rst();var $a=!1;if(ye.EwaSettings.getBooleanFeatureGate(Wi.a.OFe,!1)){var Tb=w.HL().FirstColumn+1,Ic=w.HL().LastColumn+1;w=w.HL().FirstRow+1;for(var pc=Tb;I.$$mn();){pc>Ic&&(pc=Tb);var vd=this.VQh(d,w,pc);pc+=1;var ne=void 0,Pe=I.$$cu().NH?d.QIb(I.$$cu().range):(ne=new W.a,ne.add(I.$$cu()),ne);vd&&($a=this.$Ce(d,Pe,ha,wa,vd,$a));E.lastOrDefault(Pe)}}else for(Tb=d.xl("FormatCellsAction.CopyBetweenRows2",w);I.$$mn();)Tb.$$mn()||(Tb.$$rst(),
Tb.$$mn()),Ic=Tb.$$cu(),w=void 0,pc=I.$$cu().NH?d.QIb(I.$$cu().range):(w=new W.a,w.add(I.$$cu()),w),Ic&&($a=this.$Ce(d,pc,ha,wa,Ic,$a)),E.lastOrDefault(pc)}else Fd.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};sd.prototype.E4f=function(){var d=hh.a.hd(1,0,0,641,0,104573951,"PivotTableContextMenuOperationFailure");Ki.a(this.$).vi(d)};sd.prototype.azi=function(d,w){var I={ValidMembers:32},ha=w.NumberFormat;switch(d){case 1890566896:if(1001===ha||1002===ha||
1003===ha){I.NumberFormat=14;I.NumberFormatOptions={};switch(ha){case 1001:I.NumberFormatOptions.TimeType=2;break;case 1002:I.NumberFormatOptions.DateType=7;break;case 1003:I.NumberFormatOptions.DecimalPlaces=0}I.NumberFormatOptions.NumberFormatCategory=this.AKg(ha)}else I.NumberFormat=ha;break;case 1886928607:I.NumberFormat=13;break;case -992833457:I.NumberFormat=11;break;case 218524921:I.NumberFormat=12;break;case 996232352:I.NumberFormat=14;I.NumberFormatOptions=Object.assign(new kk.a,{DecimalPlaces:0});
I.NumberFormatOptions.NumberFormatCategory=6;break;default:return w}return I};sd.prototype.formatCells=function(d,w,I,ha,wa,$a,Tb){ha=void 0===ha?null:ha;wa=void 0===wa?null:wa;$a=void 0===$a?null:$a;Tb=void 0===Tb?null:Tb;var Ic=this.$.Vb.Hc("UserAction","FormatCellsInstantaneous, command = "+fh.b().ui(d)),pc=this.$.Vb.Wh("UserAction","FormatCellsInstantaneousFrame");pc.start();Hg.a(pc);var vd=fh.b().ui(d),ne=this.$,Pe=Ne.g(ne),Af=Pe.ha.va,Wf=wa||Af.selectedRanges,Of=Ie.g(Wf,function(tj){return tj.pU});
vd=String.format("{0}, cellCount={1}",vd,Of);Ne.g(this.$).Mi.C7(1,Ic.id,vd);Wf=td.r(Wf,this.$);Af=Af.activeCell;vd=-168056295===I.command;var xg=Of=null;if(vd){xg=Pe.Rb.$o(Af);if(!xg){this.E4f();return}Of=xg.Jca.substring(1,xg.Jca.length-1);xg=xg.yac();if(!xg){this.E4f();return}xg=xg.Caption}Pe.Hh.XG(!1,!0);var oi=td.o(Af,ne),Sh=ne.na.ta.Zb(!0),mj=this.azi(I.command,w);vd||this.$da(Pe,d,w,!1,ha,wa);Ic.stop();Ne.g(this.$).Mi.O0(Ic.id,Xg.BasicTelemetryCalculator.hR);I.vdi=sh.a.Ra.Kb;ha=this.$.Vb.Hc("UserAction",
"FormatCellsUserAction");this.qvi(d,I.taskId,w,Wf,Af,ha.id);fh.b().XB(Ic.id,ha.id,"actions","actions");fh.b().XB(pc.id,ha.id,"actions","actions");ye.EwaSettings.sc()?ne.userOperationManager.hc(new tf(this,Wf,oi,mj,vd,Of,xg,Sh,ha,Ic.id,64,$a,Tb),I):ne.userOperationManager.hc(new tf(this,Wf,oi,mj,vd,Of,xg,Sh,ha,Ic.id,0,$a,Tb),I)};sd.prototype.V2=function(d,w,I,ha,wa,$a,Tb,Ic,pc,vd,ne){var Pe=this,Af=this.$;return function(Wf,Of,xg){Af.oy();Wf=[Wf,Pe.ELi];Of=[Of];vd&&Wf.push(vd);ne&&Of.push(ne);return jg.q(Af.na.ta,
d,w,I,ha,wa,$a,Jf.b.apply(null,Wf),Jf.a.apply(null,Of),xg,pc,Tb,Ic)}};sd.prototype.IBj=function(d,w,I,ha,wa,$a){if(w&&I){var Tb=I.Font,Ic=I.HorizontalAlignment,pc=I.VerticalAlignment;I.ValidMembers&2||(Ic=w.horizontalAlignment);I.ValidMembers&1||(pc=w.verticalAlignment);var vd=0!==Ic;sd.Afi(d)&&0===Ic&&(Ic=this.$_e(w));var ne=!1;switch(d){case -394785302:this.Nua.tcb(w,Ic,vd,0);break;case 1041132226:this.Nua.tcb(w,Ic,vd,1);break;case -571165336:this.Nua.tcb(w,Ic,vd,2);break;case -1150205178:case -1142465846:case -286432209:this.Nua.tcb(w,
Ic,vd,pc,!1,!1);break;case 1650812936:this.setFillColor(w,I,$a);break;case -287251124:w.bold=Tb.Bold;break;case -1690267012:Ne.g(this.$).ha.va.qh&&(Tb=Ne.g(this.$).ha.va.Sd,this.Nua.tJb(w,I,Tb));break;case 1970784898:I=Xc.a.Tp(w.color,w.backgroundColor);if(Ag.a.compare(I,Ag.a.red)&&(k.a.s5(w.text)||k.a.a8e(w.text)))break;Tb=Ag.a.kH(Tb.FontColor);w.color=Gg.c(Xc.a.jG(Tb));break;case -1925065947:w.italic=Tb.Italic;break;case -1293291468:I=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");
this.ln?(w.MJb(Tb.FontName,I,"ShowInstantaneousFormattingOnCell"),w.f_f(Tb.FontScheme)):w.MJb(Tb.FontName,I,"ShowInstantaneousFormattingOnCell");break;case 862890474:case 963349338:w.fontSize=Tb.FontSize;this.$.If();break;case -1077965542:w.fontSize=Tb.FontSize;break;case 1764140053:w.underline=Tb.Underline;break;case -1685033574:w.doubleUnderline=Tb.DoubleUnderline;break;case -1590502662:w.fontStrikethrough=Tb.Strikethrough;break;case -848953656:case 2045211913:ne=w.Vpb();break;case 2105621672:Tb=
Object(qc.a)(Yg.a,wa);if(!Tb)break;I=Ag.a.tGh(Tb.color);w.color=Gg.c(Xc.a.jG(I));this.Wre(w,Tb.d9a);break;case -1409276245:this.Wre(w,I.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.LKg(w,I);break;case -1228228458:w.Vpb();w.clearFormat();this.KWc(w,0);ne=!0;break;case -730106152:w.clearFormat();this.KWc(w,0);break;case 932244020:this.kqj(w,I,$a);break;case -1942512156:case -1920201820:this.esj(w,I)}ha||(ne?w.Qab(!0):w.setCell(!0))}else Fd.ULS.shipAssertTag(537162135,0,!w,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),
Fd.ULS.shipAssertTag(537162134,0,!I,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};sd.prototype.L3g=function(d,w){d&&w?(d.dqb(w),d.a1c(w),this.KWc(d,w.cell.Em)):Fd.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};sd.prototype.KWc=function(d,w){if(0>w)this.u_("ApplyNumberFormatIndexOnCell",d,!1,"ApplyNumberFormatIndexOnCell: negative format index was supplied");else if(w=new mf(this.Dl,this.cq,w),
w.isValid()){var I=this.T2a(d.WI,w,d.cell.YSa,d.cell.qia);Object(ff.b)(I)?this.u_("ApplyNumberFormatIndexOnCell",d,!1,I.reason):(this.nZa(d,I.value),this.u_("ApplyNumberFormatIndexOnCell",d,!0,void 0,I.value,w))}else this.u_("ApplyNumberFormatIndexOnCell",d,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};sd.prototype.Wre=function(d,w){if(void 0===w||null===w)this.u_("ApplyNumberFormatStringOnCell",d,!1,"ApplyNumberFormatStringOnCell: no format string was supplied");else if(w=new mf(this.Dl,
this.cq,void 0,w),w.isValid()){var I=this.T2a(d.WI,w,d.cell.YSa,d.cell.qia);Object(ff.b)(I)?this.u_("ApplyNumberFormatStringOnCell",d,!1,I.reason):(this.nZa(d,I.value),this.u_("ApplyNumberFormatStringOnCell",d,!0,void 0,I.value,w))}else this.u_("ApplyNumberFormatStringOnCell",d,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};sd.prototype.LKg=function(d,w){if(w=void 0===w?null:w)if(w=this.UXh(d,w),w.success){var I=this.T2a(d.WI,w.bmc,d.cell.YSa,d.cell.qia);Object(ff.b)(I)?this.u_("ApplyNumberFormatCategoryOnCell",
d,!1,I.reason,void 0,w.bmc):(this.nZa(d,I.value),this.u_("ApplyNumberFormatCategoryOnCell",d,!0,void 0,I.value,w.bmc))}else this.u_("ApplyNumberFormatCategoryOnCell",d,!1,w.reason,void 0,w.bmc);else this.u_("ApplyNumberFormatCategoryOnCell",d,!1,"ApplyNumberFormatCategoryOnCell: no format was supplied")};sd.prototype.AKg=function(d){switch(d){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<
d?-1:d};sd.prototype.UXh=function(d,w){if(!this.Dl||!this.localeInfo||!w)return d=this.Dl?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new kd(!1,void 0,"GetRibbonNumberFormat: "+d);w=w.NumberFormat;switch(w){case 0:d=Wb.SGh;break;case 1:d=Wb.UGh;break;case 2:d=Wb.QGh;break;case 3:d=Wb.OGh;break;case 4:d=Wb.XGh;break;case 5:d=Wb.TGh;break;case 6:d=Wb.ZGh;break;case 7:d=Wb.VGh;break;case 8:d=Wb.RGh;break;case 9:d=Wb.WGh;break;case 10:d=Wb.YGh;break;case 11:case 12:return this.Dl.JVe(),
this.nOh(d,w);case 13:d=Wb.ASg;break;case 1006:d=Wb.buttonPercentage;break;case 1004:d=Wb.keyboardNumber;break;case 1005:d=Wb.keyboardCurrency;break;case 1002:d=Wb.keyboardDate;break;case 1001:d=Wb.keyboardTime;break;case 1003:d=Wb.keyboardPercentage;break;case 14:return d="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",Fd.ULS.shipAssertTag(537162132,0,!1,d),new kd(!1,void 0,d);default:return d="GetRibbonNumberFormat: unknown NumberFormatType!",Fd.ULS.shipAssertTag(537162131,
0,!1,d),new kd(!1,void 0,d)}if(!d)return new kd(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...");d=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,d);if(!d)return new kd(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format...");d=new mf(this.Dl,this.cq,void 0,d);return new kd(!0,d)};sd.prototype.nOh=function(d,w){if(!this.calcManager||!this.cq)return w=this.calcManager?"numberFormatter is null":"calcManager is null",
new kd(!1,void 0,"GetDecimalChangeNumberFormat: "+w);d=this.calcManager.Xfd(new mf(this.Dl,this.cq,d.cell.Em));if(!d)return new kd(!1,void 0,"GetDecimalChangeNumberFormat: currentFormat is null");w=this.cq.changeFormatDecimals(d,11===w?1:-1);if(!excelOnlineCalc.util.isSuccess(w))return new kd(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure");if(void 0===w.value||null===w.value)return new kd(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result");w=
new mf(this.Dl,this.cq,void 0,void 0,w.value);return new kd(!0,w)};sd.prototype.u_=function(d,w,I,ha,wa,$a){ha=void 0===ha?"":ha;wa=void 0===wa?null:wa;$a=($a=void 0===$a?null:$a)?$a.UE?$a.UE.toString():k.a.Pnb($a.formatString):"null";var Tb=k.a.Pnb(w.WI.value)||"null";wa=wa?k.a.Pnb(wa.text)||"null":"null";d=String.format("FormatCellsAction.LogNumberFormatEdit: {{ caller: '{0}', range: '{1}, {2}', success: '{3}', reason: '{4}', value: '{5}', valueType: '{6}', ifmt: '{7}', prediction: '{8}' }}",d,
w.range.top,w.range.left,I,ha,Tb,w.WI.type,$a,wa);Fd.ULS.sendTraceTag(537162130,0,50,d)};sd.prototype.MKg=function(d,w,I,ha,wa,$a,Tb,Ic,pc,vd,ne){Ic=void 0===Ic?!1:Ic;pc=void 0===pc?!1:pc;var Pe=w.cell;Pe.qU=void 0===vd?0:vd;vd=w.text;vd!==I&&(Pe.text=I);Pe.b9a=void 0===ne?null:ne;Vh.e(vd)?w.formulaBarText=vd:w.formulaBarText="";d=Ne.g(d).Rb.Xgf(w.range);this.B_c(w,ha,null,Ic,pc,d);wa&&(w.color=Gg.c(Xc.a.jG(wa)));w.cell.Em=$a;w.cell.Qoc=Tb;w.cell.oTd=$a};sd.prototype.qvi=function(d,w,I,ha,wa,$a){var Tb=
{};Tb.a=this.$.ya.UserSessionId;Tb.b=w;Tb.c=ha.Ranges.length;Tb.d=this.G7g(ha.Ranges);Tb.e=wa.toString();Tb.f=d;Tb.h=$a;1890566896===d?Tb.g=I.NumberFormat.toString():2105621672===d&&(Tb.g=I.NumberFormatOptions.NumberFormatCategory.toString());fh.b().Pe(3,Tb,!0)};sd.prototype.G7g=function(d){for(var w=0,I=0,ha=0,wa=0;wa<d.length;wa++){var $a=td.B(d[wa]).pU;w+=$a;$a>ha&&(ha=$a,I=wa)}d=td.B(d[I]).toString();return"TotalCellCount:"+w+"; Max range:"+d+"; MaxRangeSize:"+ha+";"};sd.prototype.kqj=function(d,
w,I){64===(w.ValidMembers&64)&&this.setFillColor(d,w,I);16===(w.ValidMembers&16)&&sd.Jrj(d,w);128===(w.ValidMembers&128)&&this.Nua.tJb(d,w,d.range);if(2===(w.ValidMembers&2)||1===(w.ValidMembers&1)){I=w.VerticalAlignment;w=w.HorizontalAlignment;var ha=0!==w;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&!ha&&this.$_e(d);this.Nua.tcb(d,w,ha,I)}};sd.prototype.setFillColor=function(d,w,I){(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?
d.aba:d.aba&&d.cdc&&!d.xwb&&!d.gdc)||(w=-1===w.FillColor?I?Xc.a.jG(Ag.a.white):null:Xc.a.jG(Ag.a.kH(w.FillColor)),d.backgroundColor=w?Gg.c(w):null)};sd.prototype.esj=function(d,w){0!==d.horizontalAlignment&&2!==d.horizontalAlignment||d.q7(1,!1);0<=d.indentation+w.IndentationIncrease&&(d.indentation+=w.IndentationIncrease)};sd.prototype.$_e=function(d){var w=new mf(this.Dl,this.cq,d.cell.Em);if(!w.isValid())return 0;d=this.T2a(d.WI,w,d.cell.YSa,d.cell.qia);return Object(ff.b)(d)?0:null!=d.value.horizontalAlignment?
d.value.horizontalAlignment:0};sd.prototype.otj=function(d,w,I){this.gE||(this.gE=new ie(Ne.g(this.$).Ca,this.$));this.gE.tJb(d,w,I)};sd.prototype.J4h=function(d,w){var I=new gc.a;if(d.cell.formulaBarText&&d.cell.formulaBarText.startsWith("'"))I.Text=d.cell.formulaBarText;else{var ha=d.cellValue;ha&&4!==d.cell.qU||(ha=d.text);I.Text=ha}this.iSa(w,I,!1,void 0,yg.a.Zod(this.$));return!0};sd.prototype.Gyj=function(d,w){return this.Dg&&!!d&&!!w};sd.N0g=function(d,w,I,ha){ha&&w.setCell(!0);0===I&&d.Ca.NV()};
sd.expandRange=function(d,w){w=w.clone();w.height<d.height&&(w.bottom=w.top+d.height-1);w.width<d.width&&(w.right=w.left+d.width-1);return w};sd.Afi=function(d){switch(d){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}};sd.Jrj=function(d,w){w=w.Font;var I=0!==(w.ValidMembers&16),ha=0!==(w.ValidMembers&16),wa=0!==(w.ValidMembers&16);d.bold=0!==(w.ValidMembers&4);d.italic=0!==(w.ValidMembers&8);I&&(d.underline=I);ha&&(d.doubleUnderline=
ha);wa&&(d.fontStrikethrough=wa);I=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");d.MJb(w.FontName,I,"SetFont");d.fontSize=w.FontSize;I=Xc.a.Tp(d.color,d.backgroundColor);Ag.a.compare(I,Ag.a.red)&&(k.a.s5(d.text)||k.a.a8e(d.text))||(w=Ag.a.kH(w.FontColor),d.color=Gg.c(Xc.a.jG(w)))};Sk.Object.defineProperties(sd.prototype,{Nua:{configurable:!0,enumerable:!0,get:function(){return this.nFh}},cq:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||
null===this.calcManager?null:this.calcManager.cq}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});sd.zDh=36;Object(Hd.a)(sd,"FormatCellsAction",null,[770,3]);var qi=bi.a;vm(be,qi);be.prototype.create=function(){this.Fb(new sd(this.$))};be.ja=function(d){d.da.Ha(18,new be(d))};Object(Hd.a)(be,"FormatCellsActionFactory",bi.a,[]);Object(Hd.a)(me,"FormulaAssistanceUIContext",null,[]);var qj=bi.a;vm(nd,
qj);nd.prototype.create=function(){var d=this,w=this.$.da.Aa(448);if(w)this.Fb(w);else{var I=Rg.GetServiceTaskFactory.Wa(this.$.da,283,284,this.ub);Od.TaskExtensions.Ba(I,function(){Od.TaskExtensions.Ba($g.c(I.result.Un.loadScript(d.emj)),function(){w=d.$.da.Aa(448);if(!w){var ha=Object.assign(new me,{isFeedbackAllowed:d.$.isFeedbackEnabled});w=d.$.da.Ha(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(ha));d.$.Aye(function(){var wa={};wa.isFeedbackAllowed=d.$.isFeedbackEnabled;w.updateContext(wa)})}d.Fb(w)},
d.$.ma,3)},this.$.ma,3)}};nd.ja=function(d){d.da.Ha(449,new nd(d))};Object(Hd.a)(nd,"FormulaAssistanceUIControlFactory",bi.a,[]);var rj=b(690);Object(Hd.a)(rc,"FreezePanesCommandParameters",null,[]);var ij=b(174),Ig=b(389),Oj=b(262),Kj=b(284),Ti=b(118);Wd.prototype.getSheetName=function(){return this.freezeOptions.SheetName};Object(Hd.a)(Wd,"MacroRecorderSheetPaneFrozenPayload",null,[147]);rb.prototype.Yc=function(d,w){var I=!1;switch(w){case 1844679312:I=1!==d&&!this.gridView.$a.P4}return I};rb.prototype.executeCommand=
function(d,w){d=this.gridView.$a;var I=this.gridView.Zhd();zg.AFrameworkApplication.sa.Qa.pz&&this.$.Yka&&(1844679312===w.command||340334732===w.command||-806625837===w.command)&&rj.ShyRibbon.kQ(1,2);switch(w.command){case 1844679312:return this.setFreezePanes(w,I,d.aj);case 340334732:return d.K9b?Vf.Task.Ta(!1):this.Orj(w,I);case -806625837:return d.oTa?Vf.Task.Ta(!1):this.Prj(w,I)}return Vf.Task.Ta(!1)};rb.prototype.Jc=function(d,w){d=!1;switch(w.command){case 1844679312:case 340334732:case -806625837:case 1745254833:d=
!0}return d};rb.prototype.fd=function(){return!1};rb.prototype.setFreezePanes=function(d,w,I){if(I)return this.evc(d,!1,0,0,0,0,w,null);var ha=this.gridView.ha.va;I=ha.activeCell.clone();ha=ha.activeRange;ha.Sh&&(Fd.ULS.sendTraceTag(537159585,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",I.top,I.bottom,w.top),I.top=I.bottom=w.top);ha.isRow&&(Fd.ULS.sendTraceTag(537159584,
0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",I.left,I.right,w.left),I.left=I.right=w.left);I.top===w.top&&I.left===w.left&&(I=Bi.Range.kd(I.top+1,I.left));ha=I.top-1;var wa=I.left-1,$a=ha-(w.top-1),Tb=wa-(w.left-1);return this.uWj(I,$a,Tb)?this.evc(d,!0,ha,wa,$a,Tb,w,I):(this.$.If(),this.bGf(),Vf.Task.Ta(!0))};rb.prototype.Orj=function(d,w){return this.evc(d,!0,0,w.left,
0,1,w,null)};rb.prototype.Prj=function(d,w){return this.evc(d,!0,w.top,0,1,0,w,null)};rb.prototype.uWj=function(d,w,I){var ha=this.gridView.pg(d),wa=this.gridView.view.visibleArea;return!ha||wa.topLeft.y>ha.bottomRight.y||wa.topLeft.x>ha.bottomRight.x||wa.bottomRight.y<ha.bottomRight.y||wa.bottomRight.x<ha.bottomRight.x?(Fd.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",
d,ha?ha.toString():"null",wa.toString()),d=hh.a.hd(1,0,26,1446,0,2105967339,"FreezePaneSelectionNotInViewErr"),ye.EwaSettings.oz()?new fi.a(this.$,d):(d=new gh.ErrorDialog(this.$,d),d.initialize(),d.mf()),!1):0>=w&&0>=I?(Fd.ULS.sendTraceTag(537159582,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),d=Ne.g(this.$).rtl?1448:1447,w=Ne.g(this.$).rtl?-2131054257:-1953454131,d=hh.a.hd(1,0,26,d,0,w,"FreezePaneA1SelectedErr"),ye.EwaSettings.oz()?new fi.a(this.$,
d):(d=new gh.ErrorDialog(this.$,d),d.initialize(),d.mf()),!1):!0};rb.prototype.evc=function(d,w,I,ha,wa,$a,Tb,Ic){function pc(){return new Wd(ne)}var vd=this;this.IFd=Ki.a(this.$).J9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.XT(this.tyf);this.wF.RAa();this.gridView.oGj(w?"":"UnsetFreezePane");this.iuj(d,w,this.gridView.$a);var ne=Object.assign(new rc,{SheetName:this.$.pa.name,Freeze:w,FrozenRows:wa,FrozenColumns:$a,FirstRow:I,FirstColumn:ha});Fd.ULS.sendTraceTag(573101852,
0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",w,wa,$a,I,ha);this.q$b=sh.a.Ra.he;return Ch.a(this.$.userOperationManager,function(Pe,Af,Wf){if(ye.EwaSettings.la(61)){var Of=window.performance;Of.clearMarks();Of.mark("FreezePanes request sent")}Of=vd.gridView.Js;vd.$.la(718)&&Of?(Of=vd.Bmh(ne,Of,Tb,Ic),vd.pNj(Of)):vd.$.oy();Of=vd.$.na.ta;var xg=Of.Na(9,null);xg.freezeSettings=ne;return jg.i(Of,"FreezeOrUnfreezePanes",
xg,Pe,Af,Wf,w,0)},function(Pe){return new Uf.a(151,0,Pe,void 0,pc)},d)};rb.prototype.Bmh=function(d,w,I,ha){Fd.ULS.shipAssertTag(537159580,1,!!w,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!d.Freeze)return null;var wa=Kj.a();wa.State=1;wa.IsEstimated=!0;var $a=!1,Tb=!1,Ic=w.lV(Bi.Range.kd(I.top,I.left)),pc=d.FrozenRows,vd=d.FrozenColumns;1!==d.FrozenRows||d.FrozenColumns?d.FrozenRows||1!==d.FrozenColumns?(vd=w.lV(Bi.Range.kd(d.FirstRow+1,
d.FirstColumn+1)),w=w.lV(Bi.Range.kd(I.top,I.left)),wa.Width=vd.$l-Ic.$l,wa.Height=vd.Jm-Ic.Jm,0<d.FrozenRows&&(wa.AbsoluteTop=vd.Jm,Tb=!0),0<d.FrozenColumns&&(wa.AbsoluteLeft=vd.$l,$a=!0),pc=vd.rL-w.rL,vd=vd.KJ-w.KJ):(wa.Width=w.YWh(ij.a.kd(I.top,I.left)),ha=Bi.Range.kd(I.top,I.left+1),wa.AbsoluteLeft=Ic.$l+wa.Width,$a=!0):(wa.Height=w.WWh(ij.a.kd(I.top,I.left)),ha=Bi.Range.kd(I.top+1,I.left),wa.AbsoluteTop=Ic.Jm+wa.Height,Tb=!0);Tb&&(wa.FirstFrozenRow=I.top,wa.FirstScrollableRow=ha.top);$a&&(wa.FirstFrozenColumn=
I.left,wa.FirstScrollableColumn=ha.left);wa.VisibleRows=pc;wa.VisibleColumns=vd;return wa};rb.prototype.pNj=function(d){var w=this;Vf.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){w.$.pa&&w.$.ea&&(w.$.ea.yX(xe.a.Te,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),Ig.b(w.$.pa,d,-1,void 0,!0))})};rb.prototype.iuj=function(d,w,I){if(!ye.EwaSettings.la(689))switch(d.command){case 1844679312:if(w||-1===this.PKa&&-1===this.QKa)this.PKa=I.ix-I.width+this.gridView.scrollLeft,
this.QKa=I.jx-I.height+this.gridView.scrollTop;break;case 340334732:if(w||-1===this.PKa)this.PKa=I.ix-I.width+this.gridView.scrollLeft;break;case -806625837:if(w||-1===this.QKa)this.QKa=I.jx-I.height+this.gridView.scrollTop}};rb.prototype.Btc=function(){var d=this.gridView.$a;0<d.width?this.gridView.scrollLeft=Ti.a.u0b(this.gridView.domElement,Ne.g(this.$).rtl,0):-1!==this.PKa&&(this.gridView.scrollLeft=this.PKa,this.PKa=-1);0<d.height?this.gridView.scrollTop=0:-1!==this.QKa&&(this.gridView.scrollTop=
this.QKa,this.QKa=-1)};rb.prototype.bGf=function(){this.wF.JSa();eg.a.Fa(this.IFd);this.IFd=null;this.gridView.kO(this.tyf)};Object(Hd.a)(rb,"FreezePanesCommandHandler",null,[188]);var Ii=Ye.a;vm(ld,Ii);ld.prototype.Od=function(){var d=this;Od.TaskExtensions.Ba(Rg.GetServiceTaskFactory.Wa(this.$.da,12,477,this.ub),function(w){d.Fd([new rb(d.$,w.result)])},this.$.ma)};ld.ja=function(d){d.da.Ha(116,new ld(d))};Object(Hd.a)(ld,"FreezePanesCommandHandlerFactory",Ye.a,[]);var Gj=b(938),lk=bi.a;vm(zc,lk);
zc.prototype.create=function(){var d=this,w=Rg.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.ub),I=Rg.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.ub);Od.TaskExtensions.Ba(Od.TaskExtensions.ve([w,I],this.ma),function(){d.Fb(d.$.da.Aa(296)||d.$.da.Ha(296,new Gj.BorderFormatManager(d.$,w.result,I.result)))},this.ma,3)};zc.ja=function(d){ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&d.da.Ha(468,new zc(d))};Object(Hd.a)(zc,"BorderFormatManagerFactory",
bi.a,[]);var mk=b(958),Ci=b(23),ri=b(99),yk=b(274),rk=b(354),al=b(351),Tk=b(95),Ik;(function(d){d[d.insert=1]="insert";d[d.delete=2]="delete";d[d.rows=4]="rows";d[d.columns=8]="columns";d[d.cellsShiftHorizontal=16]="cellsShiftHorizontal";d[d.cellsShiftVertical=32]="cellsShiftVertical";d[d.insertRows=5]="insertRows";d[d.insertColumns=9]="insertColumns";d[d.insertCellsShiftRight=17]="insertCellsShiftRight";d[d.insertCellsShiftDown=33]="insertCellsShiftDown";d[d.deleteRows=6]="deleteRows";d[d.deleteColumns=
10]="deleteColumns";d[d.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";d[d.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(Ik||(Ik={}));Object(Hd.b)("InsertDeleteCellFlags",Ik);var Fj=b(418);Object(Hd.a)(qd,"MacroRecorderRangeInsertedOrDeletedPayload",null,[147]);var Bk=b(119),Ck=b(252),Lj=b(1140);b(823);bc.prototype.TWe=function(d,w,I,ha){ha=void 0===ha?null:ha;var wa=Object.assign(new Kg.a,{Id:"FontDropdownMenu"});wa.MenuSectionList=[];if(this.ln&&this.themesManager){this.themesManager.yad(ha);if(null==
this.themesManager.FL||this.themesManager.mrd)return wa;ha=Object.assign(new ai.a,{ControlsId:"ThemeFontsMenuSectionControl",Title:te.a.instance.fa(1293),ControlList:this.F_h(d,w,I)});Array.add(wa.MenuSectionList,ha)}ha=Object.assign(new ai.a,{ControlsId:"FontsMenuSectionControl"});this.ln&&(ha.Title=te.a.instance.fa(1294));ha.ControlList=this.KQh(d,w,I);Array.add(wa.MenuSectionList,ha);return wa};bc.prototype.F_h=function(d,w,I){var ha,wa=[],$a=Ne.g(this.$).ha.Pa.lc;$a=5===(null===(ha=null===$a||
void 0===$a?void 0:$a.floatingObject)||void 0===ha?void 0:ha.type);if(this.themesManager.FL){var Tb=this.themesManager.FL.Zqf;var Ic=this.themesManager.FL.upf}else Fd.ULS.sendTraceTag(525361436,1,15,"ThemeFonts are Null");null!=Ic?(ha=this.AFe(Ic,1,$a,d,w,I),Array.add(wa,ha)):Fd.ULS.sendTraceTag(525361435,1,15,"Major Theme Font is Null");null!=Tb?(d=this.AFe(Tb,2,$a,d,w,I),Array.add(wa,d)):Fd.ULS.sendTraceTag(525361434,1,15,"Minor Theme Font is Null");return wa};bc.prototype.AFe=function(d,w,I,ha,
wa,$a){var Tb=2===w?this.vBi:this.ryi;I=I?Tb:Ng.a.xf(d);Tb=Ng.a.xf(qb.HelperMethods.ccc(d,w));d=Ng.a.xf(d);return Object.assign(new Lj.a,{MenuItemId:2===w?this.$qf:this.vpf,CommandValueId:I,LabelText:Tb,LabelCss:String.format("font-size:12pt;font-family:{0};",d),Styles:bc.zvb(d),AriaLabel:Tb,Alt:Tb,Command:ha.toString(),CommandPreviewId:wa.toString(),CommandRevertId:$a.toString()})};bc.prototype.KQh=function(d,w,I){var ha=[],wa=this.jgi&&!this.Hgf;bc.Rbd||bc.jbi();var $a=bc.Rbd,Tb;for(Tb in $a){var Ic=
Tb,pc=$a[Tb],vd=Ng.a.xf(Ic),ne=Ng.a.xf(qb.HelperMethods.qUd[Ic]);Ic=Ng.a.xf(Ic);wa||(pc=0);vd=Object.assign(new Lj.a,{MenuItemId:vd,CommandValueId:vd,LabelText:wa&&0<pc?Ng.a.xf(String.fromCodePoint(pc)):ne,LabelCss:String.format("font-size:12pt;font-family:{0};",wa&&0<pc?"msofp":Ic),Styles:bc.zvb(wa&&0<pc?"msofp":Ic),AriaLabel:ne,Alt:ne,Command:d.toString(),CommandPreviewId:w.toString(),CommandRevertId:I.toString()});Array.add(ha,vd)}wa&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.XQi);
return ha};bc.jbi=function(){var d={};bc.Rbd=(d["Angsana New"]=983046,d["Arial Black"]=983051,d.Arial=983050,d.Batang=983061,d["Book Antiqua"]=983077,d["Browallia New"]=983082,d.Calibri=983085,d.Cambria=983089,d.Candara=983091,d.Century=983095,d["Comic Sans MS"]=983100,d.Consolas=983101,d.Constantia=983102,d.Corbel=983106,d["Cordia New"]=983107,d["Courier New"]=983109,d.DilleniaUPC=983121,d.Dotum=983123,d.FangSong=983138,d.Garamond=983154,d.Georgia=983156,d.Gulim=983182,d.GungSuh=983186,d.KaiTi=983222,
d.JasmineUPC=983218,d["Malgun Gothic"]=983258,d.Mangal=983262,d.Meiryo=983264,d["Microsoft JhengHei"]=983272,d["Microsoft YaHei"]=983284,d.MingLiU=983292,d.MingLiU_HKSCS=983296,d["MS Gothic"]=983245,d["MS Mincho"]=983247,d["MS PGothic"]=983249,d["MS PMincho"]=983251,d.PMingliU=983322,d["PMingLiU-ExtB"]=983324,d.SimHei=983382,d.SimSun=983384,d["SimSun-ExtB"]=983386,d["Source Sans Pro"]=983396,d.Tahoma=983405,d.THSarabunPSK=983404,d["Times New Roman"]=983415,d["Trebuchet MS"]=983419,d.Verdana=983443,
d["Yu Gothic"]=983464,d["Yu Mincho"]=983474,d)};bc.zvb=function(d){var w={};w["font-family"]=d;w["font-size"]="12pt";return{optionText:w}};Sk.Object.defineProperties(bc.prototype,{themesManager:{configurable:!0,enumerable:!0,get:function(){this.cx||(this.cx=this.$.da.Aa(422));return this.cx}}});bc.Rbd=null;Object(Hd.a)(bc,"FontDropdownHelper",null,[]);Ke.rRg=function(d,w){return new Ke(d,w,null,null,null)};Ke.YYc=function(d,w){return new Ke(d,null,w,null,null)};Ke.sRg=function(d,w){return new Ke(d,
null,null,w,null)};Ke.qRg=function(d,w,I){return new Ke(d,null,w,null,I)};Sk.Object.defineProperties(Ke.prototype,{GJa:{configurable:!0,enumerable:!0,get:function(){return this.gpg}},formattedText:{configurable:!0,enumerable:!0,get:function(){return this.hpg}},style:{configurable:!0,enumerable:!0,get:function(){return this.bxg}},size:{configurable:!0,enumerable:!0,get:function(){return this.lWb}},Faa:{configurable:!0,enumerable:!0,get:function(){return this.CVe}}});Object(Hd.a)(Ke,"CachedPreviewCellGroup",
null,[]);var Pj=b(65);oe.prototype.TL=function(){var d=this;this.xDc=!1;if(xh.b(this.eCa,514846606)){this.xDc=!0;Fd.ULS.sendTraceTag(537159430,0,50,"Merge cells with multiple values");Pj.a(this.Bf.$).qd.ZD(514846606);if(this.KOb&&this.Y_d)window.setTimeout(function(){d.Bf.eaa(d.Bf.gridView,d.dCa,!0,!0)},0);else return this.n0d=Ne.g(this.Bf.$).rtl,this.p0d=hh.a.hd(3,2,0,this.n0d?628:627,0,514846606,"MergeCellsLoseData"),this.jj=Ki.a(this.Bf.$).vi(this.p0d).G(),this.jj.isCompleted||(this._state=2,this.jj.PN(this.moveNext)),
this.qDc;return this.Gfb}return this.p1};oe.prototype.p1=function(){this.Bf.Hmf(this.xDc,this.Y_d,this.Lhg.scenario,this.KOb);this._state=3};oe.prototype.Gfb=function(){return this.p1};oe.prototype.qDc=function(){this.tDc=this.jj.hz();if(0===this.tDc)return Fd.ULS.sendTraceTag(537159429,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.jj=this.Bf.eaa(this.Bf.gridView,this.dCa,!0,!1).g(),this.jj.isCompleted||(this._state=2,this.jj.PN(this.moveNext)),this.rDc;1===this.tDc&&Fd.ULS.sendTraceTag(537159428,
0,50,"MergeCellsLoseData Dialog: Cancel pressed");return this.Ifb};oe.prototype.Ifb=function(){return this.Gfb};oe.prototype.rDc=function(){this.jj.hz();return this.Ifb};oe.prototype.dispose=function(){};Object(Hd.a)(oe,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOld",null,[3]);se.prototype.TL=function(){return xh.b(this.eCa,514846606)?(Fd.ULS.sendTraceTag(537159427,0,50,"Merge cells with multiple values"),Pj.a(this.Bf.$).qd.ZD(514846606),this.k0d=Ne.g(this.Bf.$).rtl,
this.l0d=hh.a.hd(3,2,0,this.k0d?628:627,0,514846606,"MergeCellsLoseData"),this.jj=Ki.a(this.Bf.$).vi(this.l0d).G(),this.jj.isCompleted||(this._state=2,this.jj.PN(this.moveNext)),this.Ffb):this.p1};se.prototype.p1=function(){this._state=3};se.prototype.Ffb=function(){this.wDc=this.jj.hz();if(0===this.wDc)return Fd.ULS.sendTraceTag(537159426,0,50,"MergeCellsLoseData Dialog: Ok pressed"),this.jj=this.Bf.eaa(this.Bf.gridView,this.dCa,!0,this.KOb).g(),this.jj.isCompleted||(this._state=2,this.jj.PN(this.moveNext)),
this.Whg;1===this.wDc&&Fd.ULS.sendTraceTag(537159425,0,50,"MergeCellsLoseData Dialog: Cancel pressed");return this.Hfb};se.prototype.Hfb=function(){return this.p1};se.prototype.Whg=function(){this.jj.hz();return this.Hfb};se.prototype.dispose=function(){};Object(Hd.a)(se,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOldForNonDataLossCSE",null,[3]);var Hj=b(371),gj=Hj.a;vm(Sd,gj);Sd.prototype.Ch=function(){1896159024===this.qp?(this.io=te.a.instance.fa(23),
this.L6c=0):(this.io=te.a.instance.fa(22),this.L6c=1);var d=this.selectedRanges[0].i_&&!this.selectedRanges[0].C5?0:1;this.jc=1;var w={};d=(w[Sd.$y]=this.Ac,w.dialogToDisplay=this.L6c,w.defaultSelectedKey=d,w.isRtl=this.isRtl,w);this.initializeAndShow(this.io,this.$ci,d)};Sk.Object.defineProperties(Sd.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});Object(Hd.a)(Sd,"InsertDeleteCellsDialog",Hj.a,[]);Object(Hd.a)(Jd,"MacroRecorderRangeFilledPayload",null,
[147]);Object(Hd.a)(Ue,"RangeBorders",null,[]);Object(Hd.a)(Me,"ScenarioInfo",null,[]);Ad.prototype.dispose=function(){this.$=null};Ad.prototype.whi=function(d,w){return!(void 0===w||null===w)&&!!(w.scenario&16384)&&155820588!==d&&this.Scf(w,d)};Ad.prototype.T0e=function(){var d=Te.a.we(),w=Ne.g(this.$),I=w.ha.va.selectedRanges,ha=0,wa=0,$a=I.length,Tb=new Me;if(1<$a)return Tb.scenario=4,Tb;this.mpd&&Ne.g(this.$).rtl&&(ha|=65536);if(!w.Cba(I[0]))if(this.oyb)ha|=32;else return Tb.scenario=32,Tb;if(w=
w.Ca.N3a(I[0],this.$.activeItemName))for(w=yl(w),$a=w.next();!$a.done;$a=w.next())if(wa+=1,1<wa)return this.oyb?(ha|=256,Tb.scenario=ha):Tb.scenario=256,Tb;wa=Ne.g(this.$).Ca.VJa(I[0]);if(!wa)return Tb.scenario=32768,Tb;w=wa.length;I=I[0];$a=I.bottom-I.top+1;for(var Ic=I.right-I.left+1,pc=new Ue,vd=0;vd<w;vd++)if(this.Tgf&&this.OWh(wa[vd],I,pc),ha=ha|(void 0!==wa[vd].text&&null!==wa[vd].text&&""!==wa[vd].text?1:0)|(wa[vd].nN?2:0)|(wa[vd].UKa?8:0)|(wa[vd].uwb?16:0)|(wa[vd].lK?64:0)|(wa[vd].aba?128:
0),void 0!==wa[vd].text&&null!==wa[vd].text&&""!==wa[vd].text||wa[vd].UKa)void 0===Tb.Baa||null===Tb.Baa?Tb.Baa=Ne.g(this.$).uc(wa[vd].getRange()):ha|=16384;this.Tgf&&(pc.mTa===Ic&&(ha|=512),pc.wGa===Ic&&(ha|=2048),pc.tNa===$a&&(ha|=4096),pc.SQa===$a&&(ha|=1024),0<pc.mTa&&pc.mTa<Ic||0<pc.wGa&&pc.wGa<Ic||0<pc.tNa&&pc.tNa<$a||0<pc.SQa&&pc.SQa<$a)&&(ha|=8192);d=Te.a.we()-d;Fd.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenrio is : {0}",d);Tb.scenario=ha;return Tb};Ad.prototype.Fqf=
function(d,w){d=d.command;if(void 0===w||null===w)w=this.T0e();if(!this.Scf(w,d))return!1;var I=Ne.g(this.$).ha.va.selectedRanges,ha=Ne.g(this.$).Ca.VJa(I[0]);if(!ha)return!1;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===ha.length&&!ha[0].nN)return-167499203===d?(ha[0].q7(2,!0),!0):!1;ha=Ne.g(this.$).ha.va.aB;var wa=this.$.pa.sheetName;switch(d){case -167499203:2===(w.scenario&2)&&this.Kgc?this.Xbg(w.scenario,I,d):this.MAi(w,I);break;case 1097660126:this.Gqf(w,
I);break;case 155820588:this.Xbg(w.scenario,I,d);break;default:return!1}Ne.g(this.$).wV(I,ha,wa,null,I[0],null,null,0,"MergeCellCommandAction");return!0};Ad.prototype.Scf=function(d,w){var I=this.ngi(d,w);if(!this.Yef)return I;var ha=Ne.g(this.$).ha.va.selectedRanges[0].FC(!1);Fd.ULS.sendTraceTag(526149324,0,50,"Merge Cell Command: {0}; Scenario Number: {1}; IsCSEPossible result: {2}; Range: {3}",w.toString(),d.scenario,I,ha);return I};Ad.prototype.ngi=function(d,w){if(-255094134===w||this.mpd&&65536===
(d.scenario&65536))return!1;if(this.Roi(w,d))return this.Qoi(d);this.oyb&&32===(d.scenario&32)&&(d.scenario&=-33);return 32768===d.scenario||4===d.scenario||256===d.scenario||128===(d.scenario&128)||!this.oyb&&32===d.scenario||void 0!==d.Baa&&null!==d.Baa&&d.Baa.o1?!1:0===d.scenario?!0:16384===(d.scenario&16384)?ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):(1===(d.scenario&1)||8===(d.scenario&8))&&ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",
!1)||(-167499203==w||1097660126===w)&&this.egi(d)?!0:!1};Ad.prototype.egi=function(d){return ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1)?16===(d.scenario&16)||this.T7e(d.scenario)||this.E8e(d.scenario)||this.p8e(d.scenario)||this.I8e(d.scenario)||8192===(d.scenario&8192)?!0:!1:!1};Ad.prototype.Roi=function(d,w){return 155820588===d||-167499203===d&&2===(w.scenario&2)&&this.Kgc?!0:!1};Ad.prototype.Qoi=function(d){if(!ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",
!1)||this.qhi&&void 0!==d.Baa&&null!==d.Baa&&d.Baa.o1)return!1;this.oyb&&32===(d.scenario&32)&&(d.scenario&=-33);return 32768===d.scenario||4===d.scenario||256===d.scenario||128===(d.scenario&128)?!1:2===(d.scenario&2)&&512!==(d.scenario&512)&&4096!==(d.scenario&4096)&&1024!==(d.scenario&1024)&&2048!==(d.scenario&2048)?!0:!1};Ad.prototype.OWh=function(d,w,I){var ha=d.getRange();if(ha.top===w.top)if(d.$Ka)I.mTa+=ha.right-ha.left+1;else{var wa=this.gE.BZ(ha,0);if(wa){var $a=yl(wa);for(wa=$a.next();!wa.done;wa=
$a.next())wa=wa.value,wa.vwb&&(I.mTa+=wa.getRange().right-wa.getRange().left+1)}}if(ha.left===w.left)if(d.WKa)I.tNa+=ha.bottom-ha.top+1;else if(wa=this.gE.BZ(ha,2))for($a=yl(wa),wa=$a.next();!wa.done;wa=$a.next())wa=wa.value,wa.Dwb&&(I.tNa+=wa.getRange().bottom-wa.getRange().top+1);if(ha.bottom===w.bottom)if(d.vwb)I.wGa+=ha.right-ha.left+1;else if(wa=this.gE.BZ(ha,1))for($a=yl(wa),wa=$a.next();!wa.done;wa=$a.next())wa=wa.value,wa.$Ka&&(I.wGa+=wa.getRange().right-wa.getRange().left+1);if(ha.right===
w.right)if(d.Dwb)I.SQa+=ha.bottom-ha.top+1;else if(d=this.gE.BZ(ha,3))for(d=yl(d),wa=d.next();!wa.done;wa=d.next())w=wa.value,w.WKa&&(I.SQa+=w.getRange().bottom-w.getRange().top+1)};Ad.prototype.kaj=function(d){d=Ne.g(this.$).Ca.VJa(d);for(var w=d.length,I=1;I<w;I++){var ha=Ne.g(this.$).uc(d[I].getRange());ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1)?ha.cell.deleteCellFromModel():(ha.Vpb(),ha.clearFormat(),ha.cell.naj());ha.Qab(!0)}};Ad.prototype.MUj=
function(d,w){d.backgroundColor=w.backgroundColor;d.color=w.color};Ad.prototype.MXh=function(d,w,I,ha){w.cell.Dsj(I.bottom-I.top,I.right-I.left);var wa=this.e3(this.f5(w),!0,0,ha,"merge");if(void 0!==d&&null!==d){var $a=d.cell.formattedText,Tb=Object.assign(new gc.a,{TextRuns:$a.TextRuns,Fonts:$a.Fonts});Tb.Text=void 0!==d.cell.originalText&&null!==d.cell.originalText?d.cell.originalText:void 0!==d.cell.userInput&&null!==d.cell.userInput?d.cell.userInput:$a.Text;wa=this.e3(this.f5(w),wa,1,ha,"merge");
this.Gh.iSa(w,Tb,!1,null,!0,"MergeCells",void 0,2);wa=this.e3(this.f5(w),wa,2,ha,"merge");this.mpd?w.dqb(d):this.MUj(w,d);wa=this.e3(this.f5(w),wa,3,ha,"merge");w.cell.J3g(d.cell);wa=this.e3(this.f5(w),wa,4,ha,"merge")}this.kaj(I);wa=this.e3(this.f5(w),wa,5,ha,"merge");w.cell.VBc(!1);this.e3(this.f5(w),wa,6,ha,"merge");return w};Ad.prototype.p8e=function(d){return 4096===(d&4096)};Ad.prototype.I8e=function(d){return 512===(d&512)};Ad.prototype.T7e=function(d){return 2048===(d&2048)};Ad.prototype.E8e=
function(d){return 1024===(d&1024)};Ad.prototype.bTh=function(d,w){w=w.cell.eva().Borders;1<w.length&&(w=[w[1]]);return d=[].concat(Gl(w),Gl(d))};Ad.prototype.Y_h=function(d,w){w=w.cell.eva().Borders;1<w.length&&(w=[w[0]]);return d=[].concat(Gl(w),Gl(d))};Ad.prototype.eLh=function(d,w){w=this.gE.BZ(w.cell.getRange(),1);var I=[];0<w.length&&(I=w[0].eva().Borders);I[0].BorderPosition=1;return d=[].concat(Gl(I),Gl(d))};Ad.prototype.XXh=function(d,w){w=this.gE.BZ(w.cell.getRange(),3);var I=[];0<w.length&&
(I=w[0].eva().Borders);I[0].BorderPosition=3;return d=[].concat(Gl(I),Gl(d))};Ad.prototype.PWh=function(d,w,I){this.p8e(d.scenario)&&(w=this.bTh(w,I));this.I8e(d.scenario)&&(w=this.Y_h(w,I));this.T7e(d.scenario)&&(w=this.eLh(w,I));this.E8e(d.scenario)&&(w=this.XXh(w,I));return w};Ad.prototype.W0d=function(d,w,I){I=void 0===I?null:I;var ha=[];ha=null!==I?[].concat(Gl(I)):this.PWh(w,ha,d);var wa=[0,0,0,0],$a=[1,1,1,1],Tb=0;ha.forEach(function(Ic){var pc=Ic.BorderPosition;$a[pc]=Ic.BorderLineStyle;var vd=
new Ag.a(Ic.Color.Red,Ic.Color.Green,Ic.Color.Blue);wa[pc]=vd.DS();Tb|=qb.HelperMethods.s3a(Ic.BorderPosition)});w={};w.LineStyle=$a;w.Color=wa;I={};I.BorderFormat=w;I.Border=Tb;d.cell.Xrc(d.cell.getRange());this.gE.sId(d.cell.getRange());this.Gh.$da(Ne.g(this.$),-1690267012,I,!1,null,[d.cell.getRange()])};Ad.prototype.Sli=function(d){return 512===(d.scenario&512)||4096===(d.scenario&4096)||1024===(d.scenario&1024)||2048===(d.scenario&2048)?!0:!1};Ad.prototype.Z_h=function(d){d=this.gE.BZ(d.cell.getRange(),
1);return d[0].$Ka?(d=d[0].eva().Borders[0],d.BorderPosition=1,d):null};Ad.prototype.$_h=function(d){d=this.gE.BZ(d.cell.getRange(),3);return d[0].WKa?(d=d[0].eva().Borders[0],d.BorderPosition=3,d):null};Ad.prototype.u4h=function(d,w,I,ha,wa){w.cell.$dg();this.Sli(d)?this.W0d(w,d):wa&&(wa=[],null!==I&&wa.push(I),null!==ha&&wa.push(ha),0<wa.length?this.W0d(w,d,wa):(w.cell.Xrc(w.cell.getRange()),this.gE.sId(w.cell.getRange())))};Ad.prototype.ySh=function(d,w){return null===d||void 0===d?!0:d.cell.getRange().top===
w.topLeft.top&&d.cell.getRange().left===w.topLeft.left&&d.cell.getRange().bottom===w.topLeft.bottom&&d.cell.getRange().right===w.topLeft.right?!0:!1};Ad.prototype.MAi=function(d,w){w=this.Gqf(d,w);w.q7(2,!0);this.e3(this.f5(w),!0,8,d.scenario,"merge")};Ad.prototype.Gqf=function(d,w){var I=d.Baa,ha=Ne.g(this.$).uc(w[0]),wa=null,$a=null;ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1)&&(wa=this.Z_h(ha),$a=this.$_h(ha));ha=this.MXh(I,ha,w[0],d.scenario);Ne.g(this.$).Ca.i$(w[0],
this.$.activeItemName).aeg(w[0],!0);this.e3(this.f5(ha),!0,9,d.scenario,"merge");ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellBorderScenarioCse",!1)&&(w=this.ySh(I,w[0]),this.u4h(d,ha,wa,$a,w));return ha};Ad.prototype.$Pj=function(d,w){for(var I=d.length,ha=0;ha<I;ha++){d[ha].cell.VBc();var wa=d[ha].cell.getRange();wa=Ne.g(this.$).Ca.VJa(wa);var $a=wa.length;if(-167499203===w&&this.Kgc){var Tb=0;2===d[ha].cell.VGd||1===d[ha].cell.qU?Tb=3:2===d[ha].cell.qU&&(Tb=1);d[ha].q7(Tb,
!1)}for(Tb=1;Tb<$a;Tb++)wa[Tb].attachCellToModel(),wa[Tb].dqb(d[ha]),-167499203===w&&this.Kgc&&wa[Tb].q7(null,!1)}};Ad.prototype.Xbg=function(d,w,I){var ha=Ne.g(this.$).Ca.qva(w[0],this.$.activeItemName),wa=Ne.g(this.$).Ca.i$(w[0],this.$.activeItemName),$a=[];if(void 0!==ha&&null!==ha&&(w=Ne.g(this.$).pva(w[0],ha),void 0!==w&&null!==w)){for(ha=w.$$ge();ha.$$mn();)w=ha.$$cu(),w.NH&&($a.push(w),this.e3(this.f5(w),!0,10,d,"unmerge"),w.cell.yYg(),this.e3(this.f5(w),!1,11,d,"unmerge"),wa.aeg(w.cell.getRange(),
!1));0<$a.length&&(wa.Cf.resetCellLookup(),this.$Pj($a,I))}};Ad.prototype.e3=function(d,w,I,ha,wa){if(this.Yef)return d!==w&&Fd.ULS.sendTraceTag(526149323,0,50,"Merge Information for resultant cell is unexpectedly changed at step: {0}; Scenario: {1}; Command: {2}; Expected: {3}; Actual: {4}",I,ha,wa,w?"populated":"empty",d?"populated":"empty"),d};Ad.prototype.f5=function(d){return!!d.cell.cell.Merge};Object(Hd.a)(Ad,"MergeCellCommandAction",null,[]);var sk=b(105),dj=b(462),zk=b(377),bl=b(818);xd.prototype.Rji=
function(d){return 1896159024===d||-1554384558===d||-1113896058===d||1554436520===d||1415868706===d||674605324===d||1035996630===d};xd.prototype.Yc=function(d,w){return 2054778433===w&&d&1?!jf.a(this.$).xhc:600686207===w?!1:this.Rji(w)&&ih.a.any(this.gridView.ha.va.selectedRanges,function(I){return I.Sh||I.isRow})&&!this.Lhf&&!this.Hhf?!0:this.Phc(d,w)};xd.prototype.executeCommand=function(d,w,I){return this.Xb(w,I)};xd.prototype.Jc=function(d,w,I){if(d=1===d)switch(w.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:d=
!!I;break;case 862825906:case 1532790410:case 46555851:case -1522760979:d=!0;break;default:d=!1}return d};xd.prototype.fd=function(d,w,I){switch(w){case "PopulateFontColor":I.MenuItems=this.pB.kac(1970784898,-803000997,535,null,null,-128950598,2036397036,1688184685,862825906,I.MenuId);break;case "PopulateFillColor":I.MenuItems=this.pB.kac(1650812936,null,null,87208751,533,673562736,1457172838,-446735083,1532790410,I.MenuId);break;case "PopulateBorderColor":I.MenuItems=this.pB.kac(-236759591,-1803452024,
535,void 0,void 0,void 0,void 0,void 0,46555851,I.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.M4h(I);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":I.MenuItems=this.Sbd.TWe(-1293291468,324978188,-1428968098,I.MenuId);break;default:return!1}return!0};xd.prototype.Phc=function(d,w){var I=Ne.g(this.$).ha.va.selectedRanges;return!(new Cf.a(this.$.xa)).Hn(d,w,I,this.gridView)};xd.prototype.Xb=function(d,w){var I=this,ha=this.gridView,wa=d.command,$a=Od.TaskExtensions.om(),
Tb=!0;switch(wa){case -1077965542:Tb=this.Q6e(w,d,!1);break;case 909774670:this.mpb(wa);Tb=this.Q6e(w,d,!0);break;case -1293291468:Tb=this.O6e(w,d,!1);break;case 324978188:ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Fd.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.mpb(wa);Tb=this.O6e(w,d,!0);break;case 862890474:case 963349338:Tb=this.h4h(d);break;case -1832800737:Tb=this.Ncc(wa,w,!1,d);break;case 1970784898:Tb=
this.Ncc(wa,w,!1,d);break;case -803000997:Tb=this.Ncc(wa,w,!1,d);break;case -128950598:case 1688184685:this.mpb(wa);Tb=this.Ncc(wa,w,!0,d);break;case 1597684571:Tb=this.hwb(wa,w,!1,d);break;case 87208751:w.Color="-1";w.IntColor=!0;Tb=this.hwb(wa,w,!1,d);break;case -446735083:this.mpb(wa);w.Color="-1";w.IntColor=!0;Tb=this.hwb(wa,w,!0,d);break;case 1650812936:Tb=this.hwb(wa,w,!1,d);break;case 673562736:this.mpb(wa);Tb=this.hwb(wa,w,!0,d);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(d=fh.b().ui(wa),Fd.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",d));this.oUf(wa);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Tb=this.T3h(wa,d);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Tb=this.d3h(wa,d);break;case -1803452024:case -236759591:Tb=this.Iid(wa,w,d);break;case -2118943501:Tb=this.borderFormatManager.n3h(w,d);break;case 1012765228:Tb=
this.borderFormatManager.$4h(w,d);break;case 1256700402:Tb=this.borderFormatManager.Nid(d);break;case -1756763834:Tb=this.borderFormatManager.Oid(d);break;case -1418159950:Tb=this.borderFormatManager.B6e(d);break;case -1920201820:case -1942512156:Tb=this.i4h(wa,d);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Tb=this.borderFormatManager.m6e(w,d);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Tb=this.F4h(wa,w,d);break;case -693675336:case 322710748:break;
case 1696566924:Tb=this.U3h(d);break;case -167499203:case -255094134:case 1097660126:case 155820588:$a=this.handleMergeCellsCommand(this.gridView,d);break;case 1896159024:case -1554384558:w=this.gridView.ha.va.selectedRanges;if(this.rzj(d,w))Fd.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new Sd(this.$,wa,w)).Ch(),Tb=!0;else if(ih.a.any(w,function(pc){return I.gridView.Rb.axa(pc)})){ha="";$a=1461300262;var Ic=-1554384558===wa&&this.gridView.Rb.Tli(w[0]);
w=w[0].height>w[0].width&&!Ic;switch(wa){case 1896159024:ha=w?"InsertColumnsTable":"InsertRowsTable";$a=w?622604322:942362098;break;case -1554384558:ha=w?"DeleteColumnsTable":"DeleteRowsTable",$a=w?284490184:1405456548}w=Pg.a.Tn(xd.pmd,ha,1);new eh.a($a,1,2,6,null);$a=this.insertOrDeleteCells(w,d,!0)}else $a=this.insertOrDeleteCells(1896159024===wa?1:2,d,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:$a=this.insertOrDeleteCells(Pg.a.Tn(xd.pmd,w[Kf.a.ld],1),d,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:$a=
this.insertOrDeleteCells(Pg.a.Tn(xd.pmd,w[Kf.a.ld],1),d,!1);break;case 504848446:$a=ha.startEdit(!1,1,w[Ca.a.event],void 0,void 0,!0);break;case 1504715724:if(Ne.g(this.$).kz&&this.borderFormatManager.UU.dB)break;$a=ha.startEdit(!0,0,w[Ca.a.event],void 0,void 0,!0);break;case 1872288872:this.Zpb();break;case 41465729:$a=this.fill(ha.ha.va.Sd,null,0,1,d);break;case -1451655532:case 1972143101:$a=this.fillDownAbsoluteValueAndStartEdit(ha,w[Ca.a.event],-1451655532===wa);break;case -475861485:$a=this.fill(ha.ha.va.Sd,
null,ha.rtl?1:2,1,d);break;case -978843926:$a=this.fill(ha.ha.va.Sd,null,3,1,d);break;case 2098035706:$a=this.fill(ha.ha.va.Sd,null,ha.rtl?2:1,1,d);break;case -2142700828:$a=this.fill(ha.ha.sourceRange,ha.ha.va.Sd,xd.k_e(ha.ha.va.Sd,ha.ha.sourceRange),2,d);break;case 1405660955:$a=this.fill(ha.ha.sourceRange,ha.ha.va.Sd,xd.k_e(ha.ha.va.Sd,ha.ha.sourceRange),4,d);break;case 1983983164:$a=this.fill(ha.ha.va.Sd,null,0,0,d);break;case 478842689:(d=this.$.da.Aa(376))?(d.E4i(),Tb=!0):Fd.ULS.sendTraceTag(537159509,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Tb=ha.ha.Xb(null,wa);break;case -208772570:this.A4h();Tb=!0;break;case -987339782:this.v3h();Tb=!0;break;case -1770246794:ha.ha.w3h();Tb=!0;break;case 748067091:case -381232414:this.z3h(wa);Tb=!0;break;case -1522760979:this.gridView.toggleFormulaView();Tb=!0;break;case 886009118:$a=this.f4h();break;case 894341014:this.k4h();
Tb=!0;break;case 862825906:$a=this.e7e(1970784898,d);break;case 1532790410:$a=this.e7e(1650812936,d);break;case 46555851:$a=this.w4h(d);break;default:Tb=!1}Tb||($a=Dg.a(wa));return $a};xd.prototype.rzj=function(d,w){var I=this,ha=ih.a.all(w,function(Tb){return!I.gridView.Rb.axa(Tb)}),wa=1<w.length&&!!this.gridView.Rb.uhd(w),$a=ih.a.all(w,function(Tb){return!I.gridView.Rb.Ska(Tb)});w=!ih.a.any(w,function(Tb){return Tb.isRow||Tb.Sh});return 1===d.method&&6===d.af&&(ha||wa)&&$a&&w};xd.prototype.fillDownAbsoluteValueAndStartEdit=
function(d,w,I){var ha=this,wa=d.ha.va.activeCell,$a=td.E(wa,this.gridView.Js);return d.startEdit(!0,0,w).CWR(function(){var Tb=d.uc($a),Ic=d.uc(wa);if(!Tb||!Ic)return Fd.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",wa.toString(),$a.toString()),Vf.Task.Ta(!1);ha.gridView.yc.text=I?Tb.b1:Tb.text;ha.gridView.yc.textBox.setCaretPositionToEnd();return Vf.Task.Ta(!0)})};xd.prototype.insertOrDeleteCells=
function(d,w,I){function ha(){return new qd(vd)}var wa=this,$a=nh.a.create().toString(),Tb=Enum.toString(Ik,d);this.gridView.Mi.C7(17,$a,Tb);Tb=this.gridView.ha.va.selectedRanges;var Ic=this.Lhf,pc=this.Hhf;if(!this.$.Ns(null,!1,void 0,w.af)&&!pc&&!Ic&&5!==d&&9!==d)return Vf.Task.Ta(!0);2===d?d=pc?10:Ic?6:Tb[0].height>Tb[0].width?18:34:1===d?d=pc?9:Ic?5:Tb[0].height>Tb[0].width?17:33:18===d&&Ic?d=34:34===d&&pc&&(d=18);Tb=this.wIg(Tb,d);if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5931745_AllowDeleteRowColFromDialog")){if((10===
d||6===d)&&!this.$.Ns(Tb,!0,1,w.af))return Vf.Task.Ta(!0)}else if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5670217_PromptPasswordDialogForDeleteRowCol")&&(10===d||6===d)&&!this.$.Ns(Tb,!0))return Vf.Task.Ta(!0);var vd={};vd.InsertDeleteRangeItems=Array(Tb.length);vd.SheetName=this.$.pa.sheetName;vd.IsTableCommand=I;for(I=0;I<Tb.length;I++){Ic=Tb[I];var ne={},Pe=pc=void 0;d&4?(ne.FirstRow=Ic.top-1,ne.LastRow=xe.a.rz,ne.FirstColumn=0,ne.LastColumn=xe.a.uw,pc=Ic.bottom-Ic.top+1,Pe=0,6===d&&(Ic.Sh||
(ne.FirstRow=Ic.bottom),pc=-pc)):d&8?(ne.FirstRow=0,ne.LastRow=xe.a.rz,ne.FirstColumn=Ic.left-1,ne.LastColumn=xe.a.uw,pc=0,Pe=Ic.right-Ic.left+1,10===d&&(Ic.isRow||(ne.FirstColumn=Ic.right),Pe=-Pe)):d&16?(ne.FirstRow=Ic.top-1,ne.LastRow=Ic.bottom-1,ne.FirstColumn=Ic.left-1,ne.LastColumn=xe.a.uw,pc=0,Pe=Ic.right-Ic.left+1,18===d&&(ne.FirstColumn=Ic.right,Pe=-Pe)):(ne.FirstRow=Ic.top-1,ne.LastRow=xe.a.rz,ne.FirstColumn=Ic.left-1,ne.LastColumn=Ic.right-1,pc=Ic.bottom-Ic.top+1,Pe=0,34===d&&(ne.FirstRow=
Ic.bottom,pc=-pc));ne={InsertDeleteRange:ne};ne.DeltaRow=pc;ne.DeltaColumn=Pe;ne.AdjustedSelectedRange=td.j(Ic);vd.InsertDeleteRangeItems[I]=ne}this.gridView.Hh.XG(!1);var Af=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");vd.IsDecoupleRecalc=Af;var Wf=this.$.na.ta.Zb();return Ch.a(this.$.userOperationManager,function(Of,xg,oi){Af&&!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||wa.$.oy();var Sh=wa.$.na.ta;Of=Jf.b(Of,wa.oOi);var mj=Sh.Na(41,
void 0===Wf?null:Wf);mj.insertDeleteMultiRangeParameters=vd;return jg.i(Sh,"InsertDeleteCells",mj,Of,xg,oi,$a,0)},function(Of){return new Uf.a(237,0,Of,void 0,ha)},w)};xd.prototype.wIg=function(d,w){return w&32?this.XYa(d,function(I){return I.bottom},function(I){return I.top},function(I,ha){I.bottom=ha},!1,!0):w&16?this.gridView.rtl?this.XYa(d,function(I){return I.left},function(I){return I.right},function(I,ha){I.left=ha},!1,!1):this.XYa(d,function(I){return I.right},function(I){return I.left},function(I,
ha){I.right=ha},!1,!1):w&4?this.XYa(d,function(I){return I.bottom},function(I){return I.top},function(I,ha){I.bottom=ha},!0,!0):w&8?this.gridView.rtl?this.XYa(d,function(I){return I.left},function(I){return I.right},function(I,ha){I.left=ha},!0,!1):this.XYa(d,function(I){return I.right},function(I){return I.left},function(I,ha){I.right=ha},!0,!1):d};xd.prototype.XYa=function(d,w,I,ha,wa,$a){d=td.d(d);d.sort(function(pc,vd){return w(vd)-w(pc)});if(wa){wa=[];$a=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?
$a?xe.a.Lh+1:xe.a.Xh+1:$a?xe.a.rz:xe.a.uw;for(var Tb=0;Tb<d.length;Tb++){var Ic=d[Tb];I(Ic)<$a&&(ha(Ic,Math.min(w(Ic),$a-1)),Array.add(wa,Ic),$a=I(Ic))}d=wa}return d};xd.prototype.fill=function(d,w,I,ha,wa){function $a(){return new Jd(pc,vd,ha,I)}var Tb=this,Ic=this.$;if(!Ic.Ns([w],!0))return Vf.Task.Ta(!0);var pc=td.v(d,Ic),vd=w?td.v(w,Ic):pc,ne=this.$.na.ta.Zb();return Ch.a(this.$.userOperationManager,function(Pe,Af,Wf){Tb.$.oy();var Of=Tb.$.na.ta,xg=Of.Na(9,ne);xg.sourceRange=pc;xg.targetRange=
vd;xg.fillDirection=I;xg.fillType=ha;return jg.i(Of,"FillRange",xg,Pe,Af,Wf,null,0)},function(Pe){return new Uf.a(155,0,Pe,void 0,$a)},wa)};xd.prototype.F4h=function(d,w,I){var ha={ValidMembers:32};switch(d){case 1890566896:d=parseInt(w[Kf.a.ld].toString(),10);if(14===d)return I=new eh.a(2105621672,I.method,I.mode,I.af,I.tabName),w[Kf.a.ld]=null,this.$.Ka.Xb(I,w),Fd.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),
!0;ha.NumberFormat=d;break;case 1886928607:ha.NumberFormat=13;break;case -992833457:ha.NumberFormat=11;break;case 218524921:ha.NumberFormat=12;break;case 996232352:ha.NumberFormat=1006;break;default:return Fd.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+fh.b().ui(I.command)),!1}Fd.ULS.sendTraceTag(537159504,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",fh.b().ui(I.command),w[Kf.a.ld]);this.Gh.formatCells(1890566896,ha,I);
this.$.If();return!0};xd.prototype.h4h=function(d){var w=this.gridView.uc(this.gridView.ha.va.activeCell);if(this.Dg&&this.gridView.isEditing){w=this.gridView.yj.M3a(w?Vh.a(w).Font:null);if(!w)return Fd.ULS.shipAssertTag(537159503,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",this.gridView.ha.va.activeCell.toString()),!1;var I=w.FontSize}else if(w)I=w.fontSize;else return!1;w=d.command;var ha=0;if(862890474===w)for(;ha<xd.EJa.length-
1&&xd.EJa[ha]<=I;)ha++;else if(963349338===w)for(ha=xd.EJa.length-1;0<ha&&xd.EJa[ha]>=I;)ha--;Fd.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",I,xd.EJa[ha]);if(I===xd.EJa[ha])return!0;I=xd.Dvc(2);I.Font.FontSize=xd.EJa[ha];this.Dg&&this.gridView.isEditing?(this.Vnb(d,!1,I),this.$.If()):this.Gh.formatCells(w,I,d);return!0};xd.prototype.Q6e=function(d,w,I){d=d[d[mk.a.IsFreeForm]?mk.a.Value:Kf.a.Ug].toString();if(!xd.c0i.test(d))return Fd.ULS.sendTraceTag(537159499,
0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) is not a number.",d),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;d=parseFloat(d);if(8>d||72<d)return Fd.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) not within expected limits ({1} - {2}).",d,8,72),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var ha=
Math.round(2*d)/2,wa=xd.Dvc(2);wa.Font.FontSize=ha;this.Dg&&this.gridView.isEditing?(this.Vnb(w,I,wa,!0),ha===d||I||this.$.If()):I?this.Gh.$da(this.gridView,-1077965542,wa,I):(this.Gh.formatCells(-1077965542,wa,w),this.Q_a());return!0};xd.prototype.O6e=function(d,w,I){var ha=d[Kf.a.Ug],wa=qb.HelperMethods.qUd[ha],$a=0;this.ln&&(d=d.MenuItemId,d===this.Sbd.$qf?(ha==this.themesManager.FL.Zqf&&(wa=ha),$a=2):d===this.Sbd.vpf&&(ha==this.themesManager.FL.upf&&(wa=ha),$a=1));if(!wa)return!0;ha=xd.Dvc(1);
ha.Font.FontName=wa;this.ln&&(ha.Font.FontScheme=$a);this.Dg&&this.gridView.isEditing?(this.Vnb(w,I,ha),this.$.If()):I?this.Gh.$da(this.gridView,-1293291468,ha,I):(this.Gh.formatCells(-1293291468,ha,w),this.Q_a());return!0};xd.prototype.Ncc=function(d,w,I,ha){var wa=-803000997===d||1688184685===d?"black":w.Color;this.moreColorsHelper&&(-1832800737===d?wa=k.a.compare(wa,"WindowText",!0)?this.moreColorsHelper.sGb:"black":I||(this.moreColorsHelper.sGb=wa,this.moreColorsHelper.ada(w,wa,ha)));d=xd.Dvc(32);
d.Font.FontColor=Xc.a.lH(wa,Pg.a.yg(w,"IntColor"));this.Dg&&this.gridView.isEditing?this.Vnb(ha,I,d,17===ha.af):I?this.Gh.$da(this.gridView,1970784898,d,I):(this.RC&&(I=this.getThemeColor(w),w=I.themeColor,I.returnValue&&(d.Font.ThemeFontColor=w,d.Font.ColorTypeOption=1)),this.Gh.formatCells(1970784898,d,ha),this.Q_a());return!0};xd.prototype.z3h=function(d){var w=(new Date).format(748067091===d?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),I=this.gridView.Dj?Bk.a(this.gridView.$):this.gridView.yc;
d=I.textBox;if(this.gridView.isEditing)I.insertText(w);else{var ha=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeEditingModeAfterInsertDateOrTime",!1)?0:1;this.gridView.startEdit(!0,ha);I.text=w;w=w.length;d.wRa(w);d.caretPosition=w}};xd.prototype.A4h=function(){this.gridView.Cba(this.gridView.ha.va.activeCell)||this.gridView.Yuc||this.gridView.zMa()||this.gridView.Rt(this.gridView.ha.va.activeCell,3,sk.a.V5e)};xd.prototype.v3h=function(){if(!(this.gridView.Yuc||this.gridView.zMa()||
this.gridView.isEditing&&Ci.a.isMac)){var d=this.gridView.ha.va.s4;this.gridView.Vg(td.v(d,this.$),d,null,null,60,sk.a.V5e)}};xd.prototype.U3h=function(d){var w=this;this.i$b=ef.d(this.$.xa.pa);var I=this.$.da.Aa(254,!0);if(this.gridView.j6a)return this.gridView.Hh.XG(!1),!!I;if(!I)return Fd.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.I2(this.hcd);var ha=String.format(Ca.a.yta,Eg.a.current.ro(84));this.gridView.Hh.hu(ha);
d=new eh.a(-911352779,d.method,d.mode,d.af,d.tabName);ha={};this.$.Ka.Xb(d,(ha[Ca.a.silentClipboardAccessFailures]=!0,ha[Ca.a.isFormatPainter]=!0,ha)).continueWith(function(wa){(6>wa.status||6===wa.status&&!wa.result)&&w.Zpb()});this.gridView.j6a=!0;I.sGg(this.Zpb);return!0};xd.prototype.hwb=function(d,w,I,ha){var wa=87208751===d?"-1":w.Color;this.moreColorsHelper&&(1597684571===d?wa=this.moreColorsHelper.zab:I||(this.moreColorsHelper.zab=wa===xd.notSet?xd.BWd:wa,this.moreColorsHelper.ada(w,wa,ha)));
d={ValidMembers:64};d.FillColor=Xc.a.lH(wa,Pg.a.yg(w,"IntColor"));I?this.Gh.$da(this.gridView,1650812936,d,!0):(this.RC&&(I=this.getThemeColor(w),w=I.themeColor,I.returnValue&&(d.ThemeFillColor=w,d.ColorTypeOption=1)),this.Gh.formatCells(1650812936,d,ha),this.Q_a());return!0};xd.prototype.k4h=function(){Fd.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");var d=this.$.da.Aa(221);if(d){var w=this.gridView.yj;if(w){var I=d.bdi(w.text,
w.textBox.caretPosition);var ha=I.msf;var wa=I.JUe;(I=I.returnValue)?(d.isListVisible=!1,w.text=I,w.textBox.selectRange(ha,ha+wa),Fd.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):Fd.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else Fd.ULS.shipAssertTag(537159491,0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else Fd.ULS.sendTraceTag(537159492,
0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};xd.prototype.T3h=function(d,w){var I=0,ha=this.gridView,wa=Vh.a(ha.uc(null));this.Dg&&ha.isEditing&&(wa.Font=ha.yj.M3a(wa.Font));var $a=wa.Font;$a||($a={ValidMembers:0});switch(d){case -287251124:I|=4;Ck.e($a,4)?$a.Bold=!$a.Bold:$a.Bold=!0;break;case -1925065947:I|=8;Ck.e($a,8)?$a.Italic=!$a.Italic:$a.Italic=!0;break;case 1764140053:I|=16;Ck.e($a,16)?$a.Underline=!$a.Underline:$a.Underline=!0;break;case -1685033574:I|=
64;Ck.e($a,64)?$a.DoubleUnderline=!$a.DoubleUnderline:$a.DoubleUnderline=!0;break;case -1590502662:I|=128,Ck.e($a,128)?$a.Strikethrough=!$a.Strikethrough:$a.Strikethrough=!0}if(!I)return!1;$a.ValidMembers=I;wa.Font=$a;wa.ValidMembers=16;this.Dg&&this.gridView.isEditing?this.Vnb(w,!1,wa):(ye.EwaSettings.la(684)||ha.Hh.XG(!1),this.Gh.formatCells(d,wa,w));this.$.If();return!0};xd.prototype.d3h=function(d,w){var I=0,ha=this.gridView,wa=Vh.a(ha.uc(null));-571165336===d||1041132226===d||-394785302===d?
(I|=1,wa.VerticalAlignment=Pg.a.Tn(xd.bZa,d.toString(),2)):xd.Bji(d)?(I|=2,this.c4h(wa,d)):-1116189897===d&&(I|=8,wa.Wrap=wa.ValidMembers&8?!wa.Wrap:!0);if(!I)return!1;wa.ValidMembers=I;ye.EwaSettings.la(684)||ha.Hh.XG(!1);this.Gh.formatCells(d,wa,w);this.$.If();return!0};xd.prototype.c4h=function(d,w){!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==w&&(w=-1150205178===w?-286432209:-1150205178);w=Pg.a.Tn(xd.bZa,w.toString(),
0);d.HorizontalAlignment=w===d.HorizontalAlignment?0:w};xd.prototype.wKf=function(d,w,I,ha){var wa=this,$a=!1;ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&($a=this.Ykc.Fqf(w,I))&&Ne.g(this.$).Mi.O0(this.D8a,Xg.BasicTelemetryCalculator.hR);return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.eaa(d,w,!1,$a,function(Tb){wa.BPi(Tb,I,w,$a,ha)}):this.eaa(d,w,!1,$a,function(Tb,
Ic,pc){wa.DPi(Tb,Ic,pc,I,w,$a,ha)})};xd.prototype.handleMergeCellsCommand=function(d,w){var I=this;this.D8a=nh.a.create().toString();var ha=null;ha=this.Ykc.T0e();var wa=Fj.a(w.command),$a=this.Ykc.whi(w.command,ha),Tb=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),Ic=0;Tb&&$a?Ic=Te.a.we():Ne.g(this.$).Mi.C7(4,this.D8a,wa+", Scenario = "+ha.scenario.toString());wa=d.ha.va.selectedRanges;Fd.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",
fh.b().ui(w.command),wa.length,td.i(wa,",",this.$,!1));wa=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1);d.Hh.XG(!1,wa);if(10===Pg.a.Tn(xd.Hqf,w.command.toString(),10))return Vf.Task.Ta(!1);var pc=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(wa&&pc)return $a?(Tb?this.KRd(ha,w,!0,!0,Ic):this.KRd(ha,w,!0),Vf.Task.Ta(!0)):this.wKf(d,w,ha,!1);var vd=!1;wa&&(vd=this.Ykc.Fqf(w,ha))&&Ne.g(this.$).Mi.O0(this.D8a,
Xg.BasicTelemetryCalculator.hR);return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.eaa(d,w,!1,vd,function(ne){I.CPi(ne,w,vd)}):this.eaa(d,w,!1,vd,function(ne,Pe,Af){I.EPi(ne,Pe,Af,w,vd)})};xd.prototype.eaa=function(d,w,I,ha,wa){function $a(Af,Wf,Of){pc.$.oy();Af=wa?Jf.b(Af,wa):Af;Af=Jf.b(Af,Tb);return jg.f(pc.$.na.ta,ne,Pe,I,Af,Wf,Of,null,vd)}function Tb(Af){var Wf=!!Af&&!!Af.RequestTelemetryData;Ne.g(pc.$).Mi.Bla(pc.D8a,
Af.StateId,Wf?Af.RequestTelemetryData.EcsOperationDuration:0,Wf?Af.RequestTelemetryData.EcsRequestDuration:0,Wf?Af.RequestTelemetryData.WfeRequestDuration:0)}function Ic(){return new Ab(ne,Pe)}var pc=this;wa=void 0===wa?null:wa;var vd=this.$.na.ta.Zb(),ne=Pg.a.Tn(xd.Hqf,w.command.toString(),10),Pe=td.r(d.ha.va.selectedRanges,d.$);return ha?ye.EwaSettings.sc()?Ch.a(this.$.userOperationManager,$a,function(Af){return new Uf.a(156,0,Af,64,Ic)},w):Ch.a(this.$.userOperationManager,$a,function(Af){return new qf.a(156,
0,Af,void 0,Ic)},w):Ch.a(this.$.userOperationManager,$a,function(Af){return new Uf.a(156,0,Af,void 0,Ic)},w)};xd.prototype.KRd=function(d,w,I,ha,wa){var $a=this;ha=void 0===ha?!1:ha;wa=void 0===wa?0:wa;Fd.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",I);var Tb=Ne.g(this.$).rtl,Ic=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");Tb=hh.a.hd(3,2,0,Tb?628:627,0,514846606,"MergeCellsLoseData");Od.TaskExtensions.Ba(Ki.a(this.$).vi(Tb),
function(pc){pc=pc.result;if(ha){var vd=Te.a.we()-wa;Fd.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : {0}, and the user action is : {1}",vd,pc)}0===pc?(Fd.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),I?(ha&&Ic&&(pc=Fj.a(w.command),Ne.g($a.$).Mi.C7(4,$a.D8a,pc+", Scenario = "+d.scenario.toString())),$a.wKf(Ne.g($a.$),w,d,!0)):$a.eaa($a.gridView,w,!0,!1)):1===pc&&Fd.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},
this.$.ma,11)};xd.prototype.Hmf=function(d,w,I,ha){w!==d&&Fd.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",w,d,I,ha)};xd.prototype.CPi=function(d,w,I){var ha=this;xh.b(d,514846606)&&(Fd.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),Pj.a(this.$).qd.ZD(514846606),d=Ne.g(this.$).rtl,d=hh.a.hd(3,2,0,d?628:627,
0,514846606,"MergeCellsLoseData"),Od.TaskExtensions.Ba(Ki.a(this.$).vi(d),function(wa){wa=wa.result;0===wa?(Fd.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),ha.eaa(ha.gridView,w,!0,I)):1===wa&&Fd.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed")},this.$.ma,11))};xd.prototype.EPi=function(d,w,I,ha,wa){new se(this,d,w,I,ha,wa)};xd.prototype.BPi=function(d,w,I,ha,wa){var $a=this,Tb=!1;xh.b(d,514846606)&&(Tb=!0,Pj.a(this.$).qd.ZD(514846606),ha&&wa?
window.setTimeout(function(){$a.eaa($a.gridView,I,!0,!0)},0):this.KRd(w,I,!1));this.Hmf(Tb,wa,w.scenario,ha)};xd.prototype.DPi=function(d,w,I,ha,wa,$a,Tb){new oe(this,d,w,I,ha,wa,$a,Tb)};xd.prototype.mpb=function(d){var w=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");if(w&&this.o_a!==d&&1461300262!==this.o_a){this.oUf(this.o_a);var I=fh.b().ui(d),ha=fh.b().ui(this.o_a);Fd.ULS.sendTraceTag(537159450,0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",
ha,I)}w&&(this.o_a=d);if(this.Dg&&this.gridView.isEditing)this.k_a||(this.k_a=this.gridView.yj.formattedText);else if(!this.vA){this.vA=[];w=this.gridView.N$("GridCommandHandler.CacheFontStyles",this.gridView.ha.va.selectedRanges);try{for(w.$$rst();w.$$mn();){var wa=w.$$cu(),$a=wa.cell.hasRichText;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Tb=fh.b().ui(d);Fd.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",
Tb,$a,this.vA.length)}if($a)Array.add(this.vA,Ke.rRg(wa,wa.cell.formattedText));else switch(d){case 673562736:case -446735083:Array.add(this.vA,Ke.YYc(wa,wa.backgroundColor));ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!wa.backgroundColor&&Fd.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",!wa.backgroundColor);break;case -128950598:case 1688184685:Array.add(this.vA,Ke.YYc(wa,wa.color));
ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!wa.color&&Fd.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!wa.color);break;case 909774670:Array.add(this.vA,Ke.sRg(wa,wa.fontSize));if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Ic=bl.c(wa.fontSize)?"null or undefined":wa.fontSize.toString();Fd.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",
Ic)}break;case 324978188:this.ln?Array.add(this.vA,Ke.qRg(wa,wa.fontName,wa.Faa)):Array.add(this.vA,Ke.YYc(wa,wa.fontName)),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(wa.fontName?Fd.ULS.sendTraceTag(537159444,0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",gridRenderer.CanvasRendererGlobals.getFontNameForLogging(wa.fontName),wa.fontName.length):Fd.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",
!wa.fontName))}}}finally{w&&w.dispose()}}};xd.prototype.JDj=function(){return this.Dg&&this.gridView.isEditing?!this.k_a:!this.vA};xd.prototype.sgi=function(d){return!!this.vA&&this.vA.length>d&&!!this.vA[d].formattedText};xd.prototype.Z$b=function(d){return this.vA[d].style};xd.prototype.GLh=function(d){return this.vA[d].size};xd.prototype.FLh=function(d){return this.vA[d].Faa};xd.prototype.oUf=function(d){if(this.JDj())ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
Fd.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",d);else{if(this.Dg&&this.gridView.isEditing)ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(d=fh.b().ui(d),Fd.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",d)),this.k_a&&(this.gridView.yc.formattedText=this.k_a);else for(var w=this.vA.length,
I=0;I<w;I++){var ha,wa=this.vA[I].GJa.cell.getRange();if(ha=this.gridView.uc(wa)){wa=void 0;var $a=ha.NH?this.gridView.QIb(ha.range):(wa=new W.a,wa.add(ha),wa);wa=yl($a);for($a=wa.next();!$a.done;$a=wa.next()){$a=$a.value;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Tb=fh.b().ui(d);Fd.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",
Tb,$a.cell.hasRichText,I,ha.NH,w)}if($a.cell.hasRichText&&1457172838!==d)this.sgi(I)&&($a.cell.formattedText=this.vA[I].formattedText,ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!$a.cell.formattedText&&Fd.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));else switch(d){case 1457172838:$a.backgroundColor=this.Z$b(I);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!$a.backgroundColor&&Fd.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",!$a.backgroundColor);break;case 2036397036:$a.color=this.Z$b(I);ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!$a.color&&Fd.ULS.sendTraceTag(537159437,0,100,"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!$a.color);break;case -1904244080:$a.fontSize=this.GLh(I);
ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&($a=bl.c($a.fontSize)?"null or undefined":$a.fontSize.toString(),Fd.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",$a));break;case -1428968098:Tb=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),this.ln?($a.MJb(this.Z$b(I),Tb,"RestoreCachedStyles"),$a.f_f(this.FLh(I))):$a.MJb(this.Z$b(I),Tb,"RestoreCachedStyles")}}}else Fd.ULS.sendTraceTag(537159441,
0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",wa.FC(!1))}ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.o_a=1461300262);this.Q_a()}};xd.prototype.Q_a=function(){this.Dg&&this.gridView.isEditing?this.k_a=null:this.vA=null;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Fd.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};xd.prototype.i4h=
function(d,w){var I={IndentationIncrease:0};if(-1942512156===d)I.IndentationIncrease=1;else if(-1920201820===d)I.IndentationIncrease=-1;else return!0;I.ValidMembers=256;this.Gh.formatCells(d,I,w);return!0};xd.prototype.f4h=function(){var d=this,w=Ne.g(this.$),I=td.r(w.ha.va.selectedRanges,this.$),ha=td.o(w.ha.va.activeCell,this.$);Fd.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return Ch.a(this.$.userOperationManager,function(wa,$a,Tb){return jg.L(d.$.na.ta,
ha,I,wa,$a,Tb,null)},function(wa){return new Uf.a(201,0,wa)},null)};xd.prototype.e7e=function(d,w){var I=null,ha=Ne.g(this.$).ha.va.selectedRanges;ha=this.gridView.N$("MoreColors",ha,1,!0);try{for(ha.$$rst();ha.$$mn();){var wa=ha.$$cu().cell;if(wa){var $a=xd.black;if(1970784898===d)$a=wa.color;else if(1650812936===d){var Tb=wa.backgroundColor;$a=k.a.compare(Tb,xd.BWd,!0)&&k.a.compare(Tb,xd.empty,!0)?wa.backgroundColor:xd.white}if(!I)I=$a;else if(I!==$a){I=xd.black;break}}}}finally{ha&&ha.dispose()}this.Dg&&
this.gridView.isEditing&&1970784898===d&&this.gridView.yj.textBox.rue();return this.moreColorsHelper.zxa(d,w,I)};xd.prototype.w4h=function(d){var w=Ng.a.g4a(this.borderFormatManager.x3);return this.moreColorsHelper.zxa(-236759591,d,w)};xd.prototype.Vnb=function(d,w,I,ha){var wa=this;ha=void 0===ha?!1:ha;w?this.gridView.yj.wJf(I.Font):(this.Ywi(d),ha?window.requestAnimationFrame(function(){ri.FocusManager.instance().ek(yk.AFrame.Cia);wa.gridView.yj.RVe(I.Font)}):(ri.FocusManager.instance().ek(yk.AFrame.Cia),
this.gridView.yj.RVe(I.Font)),this.Q_a())};xd.prototype.Ywi=function(d){var w=Fj.a(d.command);d=rk.a[d.af]+"_"+al.a[d.method];var I=this.gridView.pc.Sxe.toString(),ha=new Map;ha.set("Command",w);ha.set("Source",d);ha.set("Ribbon","React");ha.set("CellTextRuns",I);Tk.Health.instance.recordKpiUsage(zk.a.pFh,0,dj.a.NUf,ha)};xd.prototype.Iid=function(d,w,I){d=this.borderFormatManager.Iid(d,w,I);this.moreColorsHelper&&this.moreColorsHelper.ada(w,this.borderFormatManager.x3,I);return d};xd.prototype.getThemeColor=
function(d){var w={};var I=!1;if((d.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return Fd.ULS.sendTraceTag(537159433,0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:w};I=this.themesManager.getThemeColor(d.Color);d=I.themeIndex;var ha=I.iBa;if(I=I.returnValue)w.ThemeColorIndex=d,w.ThemeColorRow=ha}return{returnValue:I,themeColor:w}};xd.Bji=function(d){return-1150205178===d||-1142465846===d||-286432209===d};xd.Dvc=function(d){var w=
{},I={};w.ValidMembers=16;w.Font=I;I.ValidMembers=d;return w};xd.k_e=function(d,w){var I=d.top<w.top?3:d.bottom>w.bottom?0:-1;return I=d.left<w.left?1:d.right>w.right?2:I};Sk.Object.defineProperties(xd.prototype,{Lhf:{configurable:!0,enumerable:!0,get:function(){return ih.a.all(this.gridView.ha.va.selectedRanges,function(d){return d.isRow})}},Hhf:{configurable:!0,enumerable:!0,get:function(){return ih.a.all(this.gridView.ha.va.selectedRanges,function(d){return d.Sh})}},themesManager:{configurable:!0,
enumerable:!0,get:function(){this.cx||(this.cx=this.$.da.Aa(422));return this.cx}}});Sk.Object.defineProperties(xd,{c0i:{configurable:!0,enumerable:!0,get:function(){return xd.cee||(xd.cee=RegExp("^[0-9]+[.]?[0-9]*$"))}},pmd:{configurable:!0,enumerable:!0,get:function(){var d={};return xd.F8d||(xd.F8d=(d.InsertRows=5,d.InsertColumns=9,d.InsertCellsShiftRight=17,d.InsertCellsShiftDown=33,d.DeleteRows=6,d.DeleteColumns=10,d.DeleteCellsShiftLeft=18,d.DeleteCellsShiftUp=34,d.DeleteRowsTable=6,d.DeleteColumnsTable=
10,d.InsertRowsTable=5,d.InsertColumnsTable=9,d))}},bZa:{configurable:!0,enumerable:!0,get:function(){var d={};return xd.xgb||(xd.xgb=(d["-394785302"]=0,d["-571165336"]=2,d["1041132226"]=1,d["-1150205178"]=1,d["-1142465846"]=2,d["-286432209"]=3,d))}},Hqf:{configurable:!0,enumerable:!0,get:function(){var d={};return xd.sbe||(xd.sbe=(d["-167499203"]=2,d["-255094134"]=5,d["1097660126"]=6,d["155820588"]=7,d))}}});xd.BWd="transparent";xd.notSet="-1";xd.black="#000000";xd.empty="";xd.white="#FFFFFF";xd.F8d=
null;xd.xgb=null;xd.sbe=null;xd.cee=null;xd.EJa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(Hd.a)(xd,"GridCommandHandler",null,[188]);var Uk=Ye.a;vm(fd,Uk);fd.prototype.Od=function(){var d=this;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var w=Rg.GetServiceTaskFactory.create(this.$.da,111,this.ma,this.ub),I=Rg.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.ub),ha=Rg.GetServiceTaskFactory.create(this.$.da,397,this.ma,this.ub),wa=Rg.GetServiceTaskFactory.Wa(this.$.da,
296,468,this.ub);Od.TaskExtensions.Ba(Od.TaskExtensions.ve([w,I,ha,wa],this.ma),function(){d.Fd([new xd(d.$,Ne.g(d.$),I.result,w.result,wa.result,ha.result)])},this.ma,3)}else{var $a=Rg.GetServiceTaskFactory.create(this.$.da,111,this.ma,this.ub),Tb=Rg.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.ub),Ic=Rg.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.ub),pc=Rg.GetServiceTaskFactory.create(this.$.da,397,this.ma,this.ub);Od.TaskExtensions.Ba(Od.TaskExtensions.ve([$a,Tb,Ic,pc],this.ma),
function(){d.Fd([new xd(d.$,Ne.g(d.$),Tb.result,$a.result,new Gj.BorderFormatManager(d.$,Tb.result,Ic.result),pc.result)])},this.ma,3)}};fd.ja=function(d){Ye.a.fe(80,new fd(d))};Object(Hd.a)(fd,"GridCommandHandlerFactory",Ye.a,[]);var Dk=b(28),Xi=b(203),Wj=b(1186);Qb.prototype.dispose=function(){var d=this;this.deactivate();this.gridView&&(this.tableManager.kRf(this.YBf),this.gridView.Acj(this.nzf),this.gridView.Bcj(this.ozf),this.$.xa.ug(this.Qe),this.$.zb.ug(this.Qe),this.Vre(function(w){w.SJd(d.aLa)}));
this.gridView=this.tableManager=this.Mga=null};Qb.prototype.aAc=function(d,w,I,ha){if(!ef.b(this.$.pa)||this.$.ea.isNamedObjectViewMode||this.gridView.$a.oTa)return!0;if(!I.length)return!1;var wa=ha.length;if(ha[wa-1]<d.left)return!1;var $a=qb.HelperMethods.nx(new Xi.a(ha),0,wa,d.left,qb.HelperMethods.WC);if(0>$a)return!1;var Tb=d.m$f,Ic=!!d.G0b&&0<d.G0b.length,pc=!!d.menuModel&&0<d.menuModel.length,vd=$a,ne=0;for(wa=Math.min(Tb.length+$a,wa);vd<wa;vd++,ne++)if($a=I[vd],!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||
$a){var Pe=null,Af=$a.getElementsByClassName(Dk.a.t$c);Af&&(Pe=Af[0]);if(Pe&&Pe.innerText){if(Af=$a.getElementsByClassName(Dk.a.Gpe))for(var Wf=Af.length-1;0<=Wf;Wf--)$a.removeChild(Af[Wf]);Af=ha[vd];w?(Pe.innerText=Tb[ne],$a.classList.add(Dk.a.sRe),Ic&&d.G0b[ne]&&(Pe=document.createElement("div"),Pe.innerHTML=d.G0b[ne],pc&&d.menuModel[ne]&&this.RBg(d,ne,Af),$a.appendChild(Pe.firstChild))):($a.classList.remove(Dk.a.sRe),Pe.textContent=Bi.Range.vU(Af),this.rih(Af))}}d.xSa=w;return!0};Qb.prototype.RBg=
function(d,w,I){this.$.da.Za(8,function(ha){ha.r9b.MNi(d,w,I)})};Qb.prototype.rih=function(d){this.$.da.Za(8,function(w){w.r9b.NNi(d)})};Qb.prototype.S5f=function(d,w,I,ha){for(var wa=!1,$a=this.y0h(d,w),Tb=this.Mga.length-1;0<=Tb;Tb--){var Ic=this.Mga[Tb];w>=Ic.left&&d<=Ic.right&&(this.aAc(Ic,!1,I,ha),Array.removeAt(this.Mga,Tb),wa=!0)}d=0;for(w=$a.length;d<w;d++)this.aAc($a[d],!0,I,ha)&&(Array.add(this.Mga,$a[d]),wa=!0);return wa};Qb.prototype.activate=function(){this.te()&&!this.active&&(this.gridView.view.Ms(this.yw),
this.active=!0)};Qb.prototype.deactivate=function(){this.active&&(this.gridView.view.Nq(this.yw),this.active=!1)};Qb.prototype.te=function(){return ef.b(this.$.pa)&&!this.$.ea.isNamedObjectViewMode&&0>=this.gridView.$a.gP&&0<this.tableManager.rangeList.length};Qb.prototype.Vre=function(d){var w=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?this.gridView.epc:[this.gridView.k3];w=yl(w);for(var I=w.next();!I.done;I=w.next()){I=yl(I.value);for(var ha=
I.next();!ha.done;ha=I.next()){ha=yl(ha.value);for(var wa=ha.next();!wa.done;wa=ha.next())d(wa.value)}}};Qb.prototype.y0h=function(d,w){var I=[];if(!this.active)return I;this.lNa=this.gridView.Jhd();for(var ha=this.tableManager.rangeList.length-1;0<=ha;ha--){var wa=this.tableManager.rangeList[ha];wa.bottom>=this.lNa&&this.Ihd(wa)<=this.lNa&&wa.left>=d&&wa.right<=w&&wa.Xva&&Array.add(I,wa)}return I};Qb.prototype.Ihd=function(d){var w=this.gridView.Rb.Xj(d);return w&&this.tableManager.Ref(d,w.usedRange.topLeft)?
d.top+1:d.top};Object(Hd.a)(Qb,"HeaderSnappingFeature",null,[3]);var Jk=bi.a;vm(Zc,Jk);Zc.prototype.create=function(){var d=this,w=Rg.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.ub);Od.TaskExtensions.Ba(Od.TaskExtensions.ve([w],this.ma),function(){d.Fb(d.$.da.Aa(68)||new Qb(w.result,Ne.g(d.$)))},this.ma,11)};Zc.ja=function(d){d.da.Ha(67,new Zc(d))};Object(Hd.a)(Zc,"HeaderSnappingFactory",bi.a,[]);var wg=b(1239),tk=bi.a;vm(jd,tk);jd.prototype.create=function(){var d=this,w=this.$.da,I=
Rg.GetServiceTaskFactory.create(w,134,this.ma,this.ub),ha=Rg.GetServiceTaskFactory.Wa(w,213,214,this.ub);Od.TaskExtensions.Ba(Od.TaskExtensions.ve([I,ha],this.ma),function(){var wa=w.Aa(1);wa||(wa=new wg.CellAutoCompleteControl(d.$,I.result),ha.result.ja(wa));d.Fb(wa)},this.ma,3)};jd.ja=function(d){d.da.Ha(151,new jd(d))};Object(Hd.a)(jd,"CellAutoCompleteControlFactory",bi.a,[]);md.prototype.dispose=function(){this.yXd();this.FZa=null};md.prototype.ja=function(d){d&&(this.FZa=d,d.kVc(this.dCf),d.G2(this.eCf),
d.BFg(this.fCf))};md.prototype.yXd=function(){this.FZa&&(this.FZa.uJd(this.dCf),this.FZa.pda(this.eCf),this.FZa.Lcj(this.fCf))};Object(Hd.a)(md,"CellAutoCompleteReadoutHandler",null,[758,3]);var xi=bi.a;vm(jc,xi);jc.prototype.create=function(){var d=this,w=this.$.da;Od.TaskExtensions.Ba(Rg.GetServiceTaskFactory.Wa(w,211,212,this.ub),function(I){I=w.Aa(213)||new md(I.result,w);d.Fb(I)},this.ma,3)};jc.ja=function(d){d.da.Ha(214,new jc(d))};Object(Hd.a)(jc,"CellAutoCompleteReadoutHandlerFactory",bi.a,
[]);Yb.Noh="ewa-dv";Yb.Ooh="ewa-dv-buttonarea";Yb.Vnh="ewa-dlb";Yb.aBb="list-table";Yb.listItem="list-item";Yb.YAb="list-item-selected";Yb.bBb="list-table-touch";Yb.Moh="ewa-dpb";Yb.Gih="dv-prompt-title";Yb.Fih="dv-prompt-message";Object(Hd.a)(Yb,"CssClassNames",null,[]);var Ok=b(522),Ak=b(45),Vk=b(431),Di=b(960),nk=gh.ErrorDialog;vm(Ua,nk);Ua.prototype.dispose=function(){Ne.g(this.$).ha.WF(this.nd);nk.prototype.dispose.call(this)};Ua.prototype.setFocus=function(){switch(this.error.Severity){case 0:var d=
4;break;case 1:d=3;break;case 2:d=0;break;default:d=this.closeAction}(d=this.getButton(d))?d.get_element().focus():nk.prototype.setFocus.call(this)};Ua.prototype.sqb=function(){var d=Ne.g(this.$);d.isEditing&&d.yc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.vTd(1);if(2===this.returnValue||0===this.returnValue){var w=d.uc(null);if(w){d.Ca.NV();var I=Object.assign(new gc.a,{Text:w.originalText});d.setCell(I,w.range,0,63,null)}this.$.xe(-798660877,
Kf.a.$b,8,null)}nk.prototype.sqb.call(this)};Ua.prototype.JGa=function(){var d=Ne.g(this.$);d.isEditing&&d.yc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.vTd(0);nk.prototype.JGa.call(this)};Ua.prototype.vTd=function(d){var w=Ne.g(this.$);Od.TaskExtensions.Ba(w.startEdit(!1,d),function(){var I=w.yc.textBox;I.text&&I.selectRange(0,I.text.length)},this.ma,11,Xe.a.current)};Ua.YQ=function(d,w,I){I=w.da.Aa(14).A3a(I);d.MessageId=-1083021405;d.MessageIdName=
"DataValidationError";d.MessageIdHash=Ng.a.Qv(d.MessageIdName);d.Severity=I?I.a9c:1;w=(null===I||void 0===I?0:I.VIa)?Ng.a.Lf(I.VIa):null;I=(null===I||void 0===I?0:I.error)?Ng.a.Lf(I.error):String.format("<p>{0}</p><p>{1}</p>",te.a.instance.fa(877),te.a.instance.fa(878));switch(d.Severity){case 0:d.Appearance=18;break;case 1:d.Appearance=12;I+=String.format("<p>{0}</p>",te.a.instance.fa(879));break;default:d.Appearance=3}d.Caption=w;d.Description=I;d.HelpDescription=te.a.instance.fa(1276);d.HelpTopicId=
Di.a.AGe;return d};Object(Hd.a)(Ua,"DataValidationErrorDeprecatedDialog",gh.ErrorDialog,[]);var ak=b(179),cl=b(166),gk=Hj.a;vm(sa,gk);sa.prototype.dispose=function(){this===this.Ab.Mp&&(this.Ab.Mp=null);eg.a.Fa(this.xm);this.xm=null;gk.prototype.dispose.call(this)};sa.prototype.Tqj=function(){this.Hu&&this.Hu.error?this.errorMessage=this.Hu.error:this.Hu&&this.Hu.options&1?(Fd.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),
this.errorMessage=te.a.instance.fa(1689),this.c9e=Eg.a.current.ro(96)):(this.errorMessage=te.a.instance.fa(1688),this.iOh(this.NMe));var d=this.Hu?this.Hu.a9c:1,w={};this.W$=(w[sa.$y]=this.Ac,w.errorDescription=this.errorMessage,w.helpImageUri=this.c9e,w);switch(d){case 0:this.jc=1;this.Fc(1,"Retry");this.W$.dialogIcon=2;this.phf=!0;break;case 1:this.jc=4;this.W$.dialogIcon=1;this.W$.additionalInformation=te.a.instance.fa(879);break;default:this.jc=1,this.W$.dialogIcon=3}d={};this.W$.helpLink=(d.type=
"AppLinkProps",d[sa.$y]=this.error.HelpTopicId,d.text=te.a.instance.fa(1276),d.handler=this.u9a,d);d=hh.a.QWc([this.error]);w={};this.aV=(w[Ca.a.b9b]=!0,w[Ca.a.pad]=d,w[Ca.a.qad]=cl.a(this.$).Osb(this.error.MessageIdHash),w[Ca.a.rZ]=this.Ac,w.DismissHandler=this.kAd,w);d={};this.W$.giveFeedbackLink=(d.type="AppLinkProps",d[sa.$y]=Ca.a.jid,d.text=te.a.instance.fa(1725),d.handler=this.GNi,d)};sa.prototype.iOh=function(d){var w=this.$.na.ta.Zb();jg.u(this.$.na.ta,td.q(d,this.$),Jf.b(this.dMi),Jf.a(this.cMi),
null,w)};sa.prototype.eYh=function(d){switch(d.RuleType){case 1:switch(d.ConditionType){case 0:var w=te.a.instance.Cb(107);return String.format(w,d.LowerBoundary,d.UpperBoundary);case 1:return w=te.a.instance.Cb(108),String.format(w,d.LowerBoundary,d.UpperBoundary);case 2:return w=te.a.instance.Cb(109),String.format(w,d.LowerBoundary);case 3:return w=te.a.instance.Cb(110),String.format(w,d.LowerBoundary);case 4:return w=te.a.instance.Cb(111),String.format(w,d.LowerBoundary);case 5:return w=te.a.instance.Cb(112),
String.format(w,d.UpperBoundary);case 6:return w=te.a.instance.Cb(113),String.format(w,d.LowerBoundary);case 7:return w=te.a.instance.Cb(114),String.format(w,d.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(d.ConditionType){case 0:return w=te.a.instance.Cb(115),String.format(w,d.LowerBoundary,d.UpperBoundary);case 1:return w=te.a.instance.Cb(116),String.format(w,d.LowerBoundary,d.UpperBoundary);case 2:return w=te.a.instance.Cb(117),String.format(w,d.LowerBoundary);case 3:return w=
te.a.instance.Cb(118),String.format(w,d.LowerBoundary);case 4:return w=te.a.instance.Cb(119),String.format(w,d.LowerBoundary);case 5:return w=te.a.instance.Cb(120),String.format(w,d.UpperBoundary);case 6:return w=te.a.instance.Cb(121),String.format(w,d.LowerBoundary);case 7:return w=te.a.instance.Cb(122),String.format(w,d.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(d.ConditionType){case 0:return w=te.a.instance.Cb(123),String.format(w,d.LowerBoundary,d.UpperBoundary);
case 1:return w=te.a.instance.Cb(124),String.format(w,d.LowerBoundary,d.UpperBoundary);case 2:return w=te.a.instance.Cb(125),String.format(w,d.LowerBoundary);case 3:return w=te.a.instance.Cb(126),String.format(w,d.LowerBoundary);case 4:return w=te.a.instance.Cb(127),String.format(w,d.LowerBoundary);case 5:return w=te.a.instance.Cb(128),String.format(w,d.UpperBoundary);case 6:return w=te.a.instance.Cb(129),String.format(w,d.LowerBoundary);case 7:return w=te.a.instance.Cb(130),String.format(w,d.UpperBoundary);
default:return"we couldn't get the details"}case 5:switch(d.ConditionType){case 0:return w=te.a.instance.Cb(131),String.format(w,d.LowerBoundary,d.UpperBoundary);case 1:return w=te.a.instance.Cb(132),String.format(w,d.LowerBoundary,d.UpperBoundary);case 2:return w=te.a.instance.Cb(133),String.format(w,d.LowerBoundary);case 3:return w=te.a.instance.Cb(134),String.format(w,d.LowerBoundary);case 4:return w=te.a.instance.Cb(135),String.format(w,d.LowerBoundary);case 5:return w=te.a.instance.Cb(136),String.format(w,
d.UpperBoundary);case 6:return w=te.a.instance.Cb(137),String.format(w,d.LowerBoundary);case 7:return w=te.a.instance.Cb(138),String.format(w,d.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(d.ConditionType){case 0:return w=te.a.instance.Cb(139),String.format(w,d.LowerBoundary,d.UpperBoundary);case 1:return w=te.a.instance.Cb(140),String.format(w,d.LowerBoundary,d.UpperBoundary);case 2:return w=te.a.instance.Cb(141),String.format(w,d.LowerBoundary);case 3:return w=te.a.instance.Cb(142),
String.format(w,d.LowerBoundary);case 4:return w=te.a.instance.Cb(143),String.format(w,d.LowerBoundary);case 5:return w=te.a.instance.Cb(144),String.format(w,d.UpperBoundary);case 6:return w=te.a.instance.Cb(145),String.format(w,d.LowerBoundary);case 7:return w=te.a.instance.Cb(146),String.format(w,d.UpperBoundary);default:return"we couldn't get the details"}case 3:return w=te.a.instance.Cb(105),String.format(w,d.LowerBoundary);case 7:return w=te.a.instance.Cb(106),String.format(w,d.LowerBoundary);
default:return"we couldn't get the details"}};sa.prototype.vTd=function(d){var w=Ne.g(this.$);Od.TaskExtensions.Ba(w.startEdit(!1,d),function(){var I=w.yc.textBox;I.text&&I.selectRange(0,I.text.length)},this.ma,11,Xe.a.current)};sa.YQ=function(d,w,I){w=w.da.Aa(14).A3a(I);d.MessageId=-1083021405;d.MessageIdName="DataValidationError";d.MessageIdHash=Ng.a.Qv(d.MessageIdName);d.Severity=w?w.a9c:1;d.HelpDescription=te.a.instance.fa(1276);d.HelpTopicId=Di.a.AGe;return d};Sk.Object.defineProperties(sa.prototype,
{Ac:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},ma:{configurable:!0,enumerable:!0,get:function(){this.xm=this.xm||new ak.a;return this.xm.token}}});Object(Hd.a)(sa,"DataValidationErrorDialog",Hj.a,[99,100,3,101]);var Ek=b(1043),dk=b(384),Fk=Ek.a;vm(Lb,Fk);Lb.prototype.dispose=function(){this.dataValidationControl=null;Fk.prototype.dispose.call(this)};Lb.prototype.Rh=function(d,w){this.dataValidationControl.Ya=this.Ya;var I=d.keyCode;return 1461300262!==w||16!==
I&&17!==I&&18!==I?Fk.prototype.Rh.call(this,d,w):!1};Lb.prototype.pzd=function(){this.TV&&(this.dataValidationControl.Ya=this.Ya,this.dataValidationControl.show(this.dataValidationControl.qR,!0,!0,Ci.a.Xp||3===Kf.a.$b))};Lb.prototype.Kg=function(){};Lb.prototype.fj=function(){this.dataValidationControl.show(this.dataValidationControl.qR,!0,!0,Ci.a.Xp||3===Kf.a.$b)};Lb.prototype.LFd=function(d,w){return this.dataValidationControl.Rh(w)};Sk.Object.defineProperties(Lb.prototype,{tyb:{configurable:!0,
enumerable:!0,get:function(){return Object(cf.a)(sa,this.$.Ab.hh)}},TV:{configurable:!0,enumerable:!0,get:function(){return this.dataValidationControl.isListVisible},set:function(d){this.dataValidationControl.isListVisible=d}},yLa:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return dk.a.F5c}}});Object(Hd.a)(Lb,"DataValidationListAutoCompleteBehavior",Ek.a,[]);var hk=b(977),dl=b(1042),Yi=hk.a;vm(Hb,Yi);Hb.prototype.dispose=function(){Yi.prototype.dispose.call(this);
this.Z7a=this.wlb=null};Hb.prototype.Bea=function(d,w,I,ha){if(d&&(!d||d.length)){this.J7(!1);this.$Ha=d;this.dW=[];for(var wa=0;wa<d.length;wa++)this.dW[wa]=d[wa]?d[wa].Name:null;wa=String.format("<table class='{0}' aria-live='polite'><tbody>",this.Wba);var $a="",Tb="";d=0;var Ic=Ne.g(this.$).uc(null);ha=this.isEditing?ha?ha.text:this.editText:Ic?Ic.originalText:null;Ic=!ha;var pc=0;Array.clear(this.KEb);var vd=[],ne=[],Pe=[],Af=ha?ha.split(" "):[""];ha=ha.trim();for(var Wf={},Of=0;Of<this.dW.length;Wf=
{GDc:Wf.GDc},Of++){var xg=this.dW[Of],oi=void 0;Wf.GDc=xg.split(" ");oi=ih.a.all(Af,function(tj){return function(Cj){return ih.a.any(tj.GDc,function(pj){return k.a.yL(pj,Cj)})}}(Wf));var Sh=!xg,mj=Array.contains(Pe,xg);Sh||mj||this.isEditing&&!oi||(oi=xg?Ng.a.Lf(Ng.a.y7b(xg)):"",oi=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.p_,oi),Array.add(Pe,xg),this.isEditing&&k.a.yL(xg,ha)?($a+=oi,Array.add(vd,Of)):(Tb+=oi,Array.add(ne,Of)),!Ic&&k.a.equals(ha,xg,!0)&&(d=this.isEditing?vd.length-
1:pc,Ic=!0),pc++)}this.Exa=pc;Array.addRange(this.KEb,vd);Array.addRange(this.KEb,ne);this.gg.innerHTML=wa+($a+Tb+"</tbody></table>");wa=this.Jn=Rc.DOMElementExtensions.Bj(this.domElement,this.Wba);this.enb(wa,w);this.J7(!0);this.Rra(w,I);this.Mk=0<this.Exa?wa.rows[d]:null}};Hb.prototype.xRa=function(d){var w=!1;this.isEditing&&d&&(w=!this.Exa,d.endEdit(w,"DataValidationListBox.SetCellContent",0));if(!w&&(d=Ne.g(this.$),w=d.uc(null))){var I=null;this.Hda&&-1!==this.Hda.SheetId&&-1!==this.Hda.Row&&
-1!==this.Hda.Column&&(I={},I.SheetName=this.Hda.SheetId.toString(),I.FirstRow=this.Hda.Row,I.FirstColumn=this.Hda.Column,I={ParameterType:6,SourceRange:I});var ha=Object.assign(new gc.a,{Text:this.qe});d.setCell(ha,w.range,0,63,I)}return!0};Hb.prototype.Rra=function(d,w){var I=d?this.MBb:this.bI;d=d?this.wjc:this.xjc;if(0>=this.Exa)this.gg.style.height=qb.HelperMethods.Qb(d);else if(this.gg.style.height="auto",this.Exa>I){var ha=this.udg?Math.floor(d*I):Math.floor(this.gg.offsetHeight*I/this.Exa);
!this.udg&&this.Xui&&Fd.ULS.sendTraceTag(529056667,0,50,"DataValidationListBox.adjustHeightAndWidth:\n            old height: "+ha+",\n            new height: "+Math.floor(d*I)+",\n            maxItems: "+I+", listItemHeight: "+d+", listItemCount: "+this.Exa);Rc.DOMElementExtensions.pG(this.gg,ha);this.gg.style.overflowY="auto"}else this.gg.style.height="auto",this.gg.style.overflowY="hidden";Rc.DOMElementExtensions.Uq(this.gg,w);Rc.DOMElementExtensions.Uq(this.Jn,w-(this.Exa>I?Ti.a.gq:0))};Sk.Object.defineProperties(Hb.prototype,
{Mk:{configurable:!0,enumerable:!0,get:function(){return this.wlb},set:function(d){this.oBa(this.wlb);if(d){this.wlb=d;this.Z7a.innerText="";this.oBa(this.wlb);var w=this.KEb[d.rowIndex];this.qe=this.dW[w];this.$Ha&&(this.Hda=this.$Ha[w],Fd.ULS.shipAssertTag(537163286,0,!this.KEb.length||!!this.Hda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.Z7a.innerText=this.qe;this.Cuc(d)}else this.Hda=this.qe=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return Ne.g(this.$).isEditing}},
editText:{configurable:!0,enumerable:!0,get:function(){return Ne.g(this.$).yc.text}}});Object(Hd.a)(Hb,"DataValidationListBox",hk.a,[]);var el=b(239),di=b(117),Qj=b(169),Z=tg.a;vm(Gc,Z);Gc.prototype.UUc=function(d){this.get_events().addHandler("ClickButton",d)};Gc.prototype.eJd=function(d){this.get_events().removeHandler("ClickButton",d)};Gc.prototype.iVc=function(d){this.get_events().addHandler("KeyDown",d)};Gc.prototype.tJd=function(d){this.get_events().removeHandler("KeyDown",d)};Gc.prototype.cZb=
function(d){this.get_events().addHandler("PointerOver",d)};Gc.prototype.GJd=function(d){this.get_events().removeHandler("PointerOver",d)};Gc.prototype.bZb=function(d){this.get_events().addHandler("PointerOut",d)};Gc.prototype.FJd=function(d){this.get_events().removeHandler("PointerOut",d)};Gc.prototype.jnb=function(d){this.get_events().addHandler("Blur",d)};Gc.prototype.cHb=function(d){this.get_events().removeHandler("Blur",d)};Gc.prototype.L9=function(d){this.get_events().addHandler("Focus",d)};
Gc.prototype.nda=function(d){this.get_events().removeHandler("Focus",d)};Gc.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove(Ok.a.$Y),this.domElement.style.cursor="",Yh.a.instance.qa(sg.a.click,this.domElement,this.Zc),di.KeyInputManager.instance.qa(sg.a.Sb,this.domElement,this.onKeyDown),Qj.a.instance.qa(sg.a.pointerOver,this.domElement,this.xw),Qj.a.instance.qa(sg.a.pointerOut,this.domElement,this.YN),this.wc.hn("blur")||this.wc.ja("blur",this.onBlur),this.wc.hn("focus")||
this.wc.ja("focus",this.onFocus),this.domElement.title=this.Xkh,this.tl=!0)};Gc.prototype.disable=function(){this.domElement&&(this.domElement.classList.add(Ok.a.$Y),this.domElement.style.cursor="",this.isEnabled&&(Yh.a.instance.za(sg.a.click,this.domElement,this.Zc),di.KeyInputManager.instance.za(sg.a.Sb,this.domElement,this.onKeyDown),Qj.a.instance.za(sg.a.pointerOver,this.domElement,this.xw),Qj.a.instance.za(sg.a.pointerOut,this.domElement,this.YN)),this.domElement.title=this.Hfh,this.tl=!1)};
Gc.prototype.dispose=function(){this.isEnabled&&(Yh.a.instance.za(sg.a.click,this.domElement,this.Zc),di.KeyInputManager.instance.za(sg.a.Sb,this.domElement,this.onKeyDown),Qj.a.instance.za(sg.a.pointerOver,this.domElement,this.xw),Qj.a.instance.za(sg.a.pointerOut,this.domElement,this.YN),this.tl=!1);Rc.DOMElementExtensions.setVisible(this.domElement,!1);Z.prototype.dispose.call(this)};Gc.Bb=function(d,w,I,ha,wa,$a,Tb,Ic){d.removeAttribute("Href");d.setAttribute(Ca.a.Td,Ca.a.Qr);d.className=w;d.tabIndex=
Ic;w=document.createElement("span");w.className=Tb;w.classList.add(I);w.tabIndex=-1;d.appendChild(w);d=document.createElement("img");d.src=Eg.a.Ee(ha);d.className=wa;d.alt=$a;d.tabIndex=-1;w.appendChild(d);return d};Sk.Object.defineProperties(Gc.prototype,{Yj:{configurable:!0,enumerable:!0,get:function(){return this.kJ}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.tl}}});Object(Hd.a)(Gc,"ListButton",tg.a,[784,3]);var xa=b(124),fb="<p class='"+Yb.Gih+"'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",
Zb="<p class='"+Yb.Fih+"'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",Fc=N.a.ONe,cd=N.a.ONe,ed=N.a.iZg,Nc=tg.a;vm(Kb,Nc);Kb.prototype.dispose=function(){this.$&&(this.KLb(!1),this.gridView.ha.jO(this.Mh),this.gridView.pt(this.onContentReady),this.gridView.pc.hcj(this.uxf),this.$.sn(this.od));this.QEe(!1);this.REe(!1);eg.a.rc(this.r5b);this.r5b=this.Eha=this.gg=this.GW=this.eJ=this.gridView=this.$=null;Nc.prototype.dispose.call(this)};Kb.prototype.p7c=function(d){return!!this.A3a(d)};
Kb.prototype.Wqb=function(d,w){return ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new sa(this.$,d,w):new Ua(this.$,d,w)};Kb.prototype.A3a=function(d){d=this.gridView.getRangeInformation(d);for(var w=0;w<d.length;w++){var I=d[w];if(Object(cf.a)(Vk.DataValidationRange,I))return I}return null};Kb.prototype.pKh=function(){if(!this.N4a)return"";var d=this.y8e?String.format("{0} {1}",this.Hu.MKf,this.Hu.prompt):"",w=this.Bwb?te.a.instance.fa(825):"";return String.format(te.a.instance.Cb(17),
d,w)};Kb.prototype.Rh=function(d){var w=!1;if(this.isListVisible||(-569786022===d||541421805===d)&&this.Bwb||1872288872===d&&this.qR)switch(d){case -569786022:case 541421805:this.show(this.qR,!this.isListVisible,!0,Ci.a.Xp||3===Kf.a.$b);w=!0;break;case 1872288872:this.isListVisible?(this.show(this.qR,!1,!0,!1),w=!0):this.qR?(this.show(!1,!1,!0,!1),w=!0):this.Ya&&(this.Ya.endEdit(!1,"DataValidationControl.HandleKeyDown",0),w=!0);break;case -798660877:this.Vh.jB(1);w=!0;break;case 137938150:this.Vh.jB(-1);
w=!0;break;case 2091832999:this.Vh.jB(this.Vh.bI-1);w=!0;break;case 742457698:this.Vh.jB(-(this.Vh.bI-1));w=!0;break;case 125627505:case 267796030:w=this.xRa()}return w};Kb.prototype.show=function(d,w,I,ha){this.Mx();if(this.Qzb&&this.N4a){var wa=this.tOa;if(wa){if(d||w||I)this.isVisible=!0;zf.d(this.style,this.isGridRtl);I&&this.Bwb&&(this.REe(!0),this.Wdg(wa,!1));w&&this.Bwb&&this.jSa(ha,wa);d&&this.y8e&&this.CCj(wa);this.Ooi||(this.isVisible=!1)}}};Kb.prototype.vva=function(d,w){if(!w||!w.cell.ik)return null;
var I=this.gridView.pc.textBox.domElement;var ha=0<Rc.DOMElementExtensions.getHeight(I)&&0<Rc.DOMElementExtensions.getWidth(I)&&0<=I.offsetTop&&0<=I.offsetLeft;if(ha)I=Rc.DOMElementExtensions.vva(I,d.xj);else{I=d.getCellBounds(w.cell);var wa=Rc.DOMElementExtensions.getBoundingClientRect(d.xj);I=new Sys.UI.Bounds(I.x-wa.x,I.y-wa.y,I.width,I.height)}if(I)if(ha)2<I.height&&2<I.height&&(I.x+=1,I.y+=1,I.height-=2,I.width-=2);else if(ha=Ne.g(this.$).aK(w.cell))ha=ha.width+1,wa=k.a.equals(el.a.z3a(w.cell,
d.rtl),"right",!0),d.rtl&&wa&&(I.x=I.x+I.width-ha),w.Zka&&d.rtl===wa&&(I.width=ha);else return null;return I};Kb.prototype.S3f=function(d){var w=this.N4a;this.KLb(w);w?this.show(!0,d,!0,!1):this.Mx()};Kb.prototype.xRa=function(){var d=!1;this.isListVisible&&(d=this.Vh.xRa(this.Ya),this.show(this.qR,!1,!0,!1));return d};Kb.prototype.Mx=function(){this.zhi?(this.isListVisible&&(this.isListVisible=!1),this.WLa&&(this.WLa=!1),this.qR&&(this.qR=!1),this.isVisible&&(this.isVisible=!1)):this.isListVisible=
this.WLa=this.qR=this.isVisible=!1;this.hpd=this.hnd=this.$pd=!1};Kb.prototype.jSa=function(d,w){this.Bwb&&!this.Hu.$Ha?this.WLa&&this.Jh.disable():(this.QEe(!0),this.Vh.Bea(this.Hu.$Ha,d,this.oTh(w),this.Ya),this.DBa(w,!1))};Kb.prototype.CCj=function(d){this.Hu.prompt&&(this.qR=!0,this.ZTj(this.Hu.MKf,this.Hu.prompt),this.peg(d,!1))};Kb.prototype.Wdg=function(d,w){var I=d.y;this.Eha.style.top=qb.HelperMethods.Qb(I);d=this.isGridRtl?d.x-this.Eha.offsetWidth+1:d.x+d.width+1;this.Eha.style.left=qb.HelperMethods.Qb(d);
w?this.WLa=this.gridView.qic(new Ak.a(d,I))&&this.hnd:this.hnd=!0};Kb.prototype.DBa=function(d,w){var I=d.y+d.height;d=this.isGridRtl?d.x+d.width-this.gg.offsetWidth:d.x;this.gg.style.top=qb.HelperMethods.Qb(I);this.gg.style.left=qb.HelperMethods.Qb(d);w?this.isListVisible=this.gridView.qic(new Ak.a(d,I))&&this.hpd:this.hpd=!0};Kb.prototype.peg=function(d,w){var I=d.y+d.height+5,ha=this.activeCell;ha=ha?ha.width/2:32;d=this.isGridRtl?d.x-this.GW.offsetWidth+ha:d.x+d.width-ha;this.GW.style.top=qb.HelperMethods.Qb(I);
this.GW.style.left=qb.HelperMethods.Qb(d);w?this.qR=this.gridView.qic(new Ak.a(d,I))&&this.$pd:this.$pd=!0};Kb.prototype.ZTj=function(d,w){if(w){var I="";d&&(I+=String.format(fb,Ng.a.Lf(d)));I+=String.format(Zb,Ng.a.Lf(w));this.GW.innerHTML=I;d=Rc.DOMElementExtensions.Bj(this.GW,"dv-prompt-titletext");if(w=Rc.DOMElementExtensions.Bj(this.GW,"dv-prompt-messagetext"))for(d=d?parseInt(String(Math.max(d.offsetWidth,w.offsetWidth)),10):w.offsetWidth,d+=6,Rc.DOMElementExtensions.Uq(this.GW,d),w=0,I=this.GW.children.length;w<
I;w++)Rc.DOMElementExtensions.Uq(this.GW.children[w],d)}};Kb.prototype.oTh=function(d){if(this.Ahi)return d.width+17-2+1;var w=this.Eha.clientWidth;this.ski&&17!==w&&Fd.ULS.sendTraceTag(528855200,0,15,"DataValidationControl.getListBoxWidth: buttonWidth is "+w);return d.width+w-2+1};Kb.prototype.REe=function(d){this.$&&!this.Qzb||!d?(this.U7f(!1),eg.a.Fa(this.Jh),this.Jh=null):(this.Jh||(this.Jh=new Gc(this.Eha,Fc,Ok.a.ria,1,cd,te.a.instance.fa(876),ed,te.a.instance.fa(875),"",-1),this.U7f(!0)),this.WLa=
!0,this.Hu.$Ha?this.Jh.isEnabled||this.Jh.enable():this.Jh.disable())};Kb.prototype.QEe=function(d){this.$&&!this.Qzb||!d?(this.NSa(!1),eg.a.Fa(this.Vh),this.Vh=null):(this.Vh||(this.Vh=new Hb(this.$,this.gg,this.Z7a),this.NSa(!0)),this.isListVisible=!0)};Kb.prototype.NSa=function(d){this.Vh&&(d&&!this.BR?(this.Vh.L9(this.Vzd),this.Vh.TYb(this.uLa),this.Vh.Bnb(this.Jya),this.BR=!0):!d&&this.BR&&(this.Vh.nda(this.Vzd),this.Vh.Esc(this.uLa),this.Vh.vHb(this.Jya),this.BR=!1))};Kb.prototype.KLb=function(d){d&&
!this.dR?(this.gridView.view.Ms(this.it),this.dR=!0):!d&&this.dR&&(this.gridView.view.Nq(this.it),this.dR=!1)};Kb.prototype.U7f=function(d){this.Jh&&(d&&!this.F0b?(this.Jh.UUc(this.NOa),this.Jh.iVc(this.NOa),this.Jh.jnb(this.uLa),this.F0b=!0):!d&&this.F0b&&(this.Jh.eJd(this.NOa),this.Jh.tJd(this.NOa),this.Jh.cHb(this.uLa),this.F0b=!1))};Kb.prototype.eeg=function(){if(this.N4a){var d=this.tOa;d&&(this.Wdg(d,!0),this.DBa(d,!0),this.peg(d,!0))}};Sk.Object.defineProperties(Kb.prototype,{Qzb:{configurable:!0,
enumerable:!0,get:function(){return!!(this.$.Hd&16)}},Ooi:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||this.qR||this.WLa}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Rc.DOMElementExtensions.isVisible(this.gg)},set:function(d){Rc.DOMElementExtensions.setVisible(this.gg,d)}},qR:{configurable:!0,enumerable:!0,get:function(){return Rc.DOMElementExtensions.isVisible(this.GW)},set:function(d){Rc.DOMElementExtensions.setVisible(this.GW,d)}},WLa:{configurable:!0,
enumerable:!0,get:function(){return Rc.DOMElementExtensions.isVisible(this.Eha)&&!!this.Jh&&Rc.DOMElementExtensions.isVisible(this.Jh.domElement)},set:function(d){Rc.DOMElementExtensions.setVisible(this.Eha,d);this.Jh&&Rc.DOMElementExtensions.setVisible(this.Jh.domElement,d)}},Ya:{configurable:!0,enumerable:!0,get:function(){return this.eJ},set:function(d){this.eJ=d}},N4a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&this.p7c(this.activeCell.range)}},activeCell:{configurable:!0,
enumerable:!0,get:function(){return this.gridView.uc(null)}},y8e:{configurable:!0,enumerable:!0,get:function(){return this.N4a&&!!this.Hu&&!!(this.Hu.options&2)&&!!this.Hu.prompt}},Bwb:{configurable:!0,enumerable:!0,get:function(){return this.N4a&&!!this.Hu&&!!(this.Hu.options&1)}},isGridRtl:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rtl}},Hu:{configurable:!0,enumerable:!0,get:function(){return this.A3a(this.activeCell.range)}},tOa:{configurable:!0,enumerable:!0,get:function(){var d=
this.activeCell;return d?this.vva(this.gridView,d):null}}});Object(Hd.a)(Kb,"DataValidationControl",tg.a,[757,3]);var Pc=bi.a;vm(Sa,Pc);Sa.prototype.create=function(){this.Fb(this.$.da.Aa(14)||new Kb(this.$))};Object(Hd.a)(Sa,"DataValidationControlFactory",bi.a,[]);gb.F$c="!";gb.hGf="[";gb.gGf="]";gb.openParen="(";gb.closeParen=")";gb.lhg=" /.(*\\".split("");gb.p7b="...";gb.UEb="param_help_link";gb.WCd="param_help_udf";gb.Icd="function_list_box";gb.JGh="function_param_box";gb.Kcd="function_reader_description";
gb.Dcd="function_description_box";gb.tWe="function_param_table";gb.HXi="param_row_";gb.XCd="param_set";gb.OGf="param_row_0";gb.PGf="param_row_1";gb.KGh="<div id='{0}' class='{1}'></div>";gb.IGh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";gb.QGf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";gb.FGh="<div id='{0}' class='{1} {2} {3}'></div>";
gb.CGh="<div id='{0}' class='{1} {2} {3} {4}'></div>";gb.jlf="[@";gb.Z3g=1;gb.Y3g=3;gb.Xch=500;gb.lqf=50;Object(Hd.a)(gb,"FormulaAssistanceConstants",null,[]);var wd=b(68),Kd=b(217);Object(Hd.a)(Sb,"FormulaAuthoringUsageDetails",null,[]);Object(Hd.a)(zb,"FormulaSuggestionsUsageDetails",null,[]);Object(Hd.a)(kc,"AutocompleteCardInteractionUsageDetails",null,[]);Object(Hd.a)(lb,"AutocompleteRenderOptimizationDetails",null,[]);Object(Hd.a)(Va,"SessionDetails",null,[]);Object(Hd.a)(bb,"PerfMetrics",null,
[]);Object(Hd.a)(Ia,"AggregatedPerfMetrics",null,[]);ta.prototype.DSa=function(){this.Pkc=sh.a.Ra.he.m};ta.prototype.Jia=function(d){-1!==this.Pkc&&(d?(this.cnb(sh.a.Ra.he.m-this.Pkc),this.Pkc=-1):this.U_.failedCount++)};ta.prototype.dCh=function(){this.U_.excludingFirstAction=ta.WTe(this.e7b);Array.add(this.e7b,this.U_.firstAction);this.U_.includingFirstAction=ta.WTe(this.e7b)};ta.prototype.cnb=function(d){var w=this;this.U_.count?1E3>this.U_.count&&Array.add(this.e7b,d):this.U_.firstAction=d;this.Rqf&&
this.Sqf&&this.Sqf.forEach(function(I){d>I&&w.U_.countAboveThresholds[I]++});this.U_.count++};ta.WTe=function(d){var w=new Ia;0<d.length&&(Ie.i(d),w.median=d[Math.floor(.5*d.length)],w.P75=d[Math.floor(.75*d.length)],w.P95=d[Math.floor(.95*d.length)],w.max=d[d.length-1],w.average=Ie.g(d,function(I){return I})/d.length);return w};Object(Hd.a)(ta,"PerformanceMeasurement",null,[]);var re=b(40),We=b(100),df={},ag=(df.argumentAssistanceOverall=[50,80,100,130,150,170,200],df);ra.prototype.D7=function(d){var w=
this;d.forEach(function(I){w.C$a.xb(I)||w.C$a.ia(I,new ta(ag[I]));w.C$a.oa(I).DSa()})};ra.prototype.lZ=function(d,w){var I=this;w=void 0===w?!0:w;d.forEach(function(ha){I.C$a.xb(ha)&&I.C$a.oa(ha).Jia(w)})};ra.prototype.OYf=function(d){var w="Undefined";switch(d){case 1:w="Collapsed";break;case 0:w="Expanded";break;case 2:w="Hidden"}this.Iaa.argumentAssistanceCardInitialMode=w};ra.prototype.B7b=function(d){var w=this;window.requestAnimationFrame(function(){w.lZ([d])})};ra.prototype.getJsonForLogging=
function(){return"{"+this.s3("SessionDetails",this.rvc)+","+this.s3("FormulaAuthoringUsage",this.Iaa)+","+this.s3("FormulaSuggestionsUsage",this.KJa)+","+this.s3("AutocompleteCardInteraction",this.R2)+","+this.s3("AutocompleteRenderOptimization",this.Dob)+","+this.HYh()+"}"};ra.prototype.nuj=function(){this.rvc.argumentAssistanceFlight=this.Ped("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.rvc.autoCompleteUIFlight=this.Ped("Microsoft.Office.Excel.","AutoCompleteNewUI");this.rvc.smartFormulaBarAutoCompleteFlight=
this.Ped("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteFeatureIsEnabled")};ra.prototype.HYh=function(){for(var d=new W.a,w=yl(this.C$a),I=w.next();!I.done;I=w.next())I=I.value,I.value.dCh(),d.add(String.format('"{0}":{1}',I.key,Ld.a.Kc(I.value.U_)));return String.format('"PerfMeasurements": {{{0}}}',d.toArray().join(","))};ra.prototype.Ped=function(d,w){return k.a.contains(this.vb.ya.FlightHolder.FlightId,w,!0)?ye.EwaSettings.getBooleanFeatureGate(d+w,!1)?"T":"C":"None"};ra.prototype.s3=function(d,
w){return String.format('"{0}":{1}',d.toString(),re.c(w))};Sk.Object.defineProperties(ra.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.vb},set:function(d){this.vb||(this.vb=d,this.vb.vl(this.od))}}});Sk.Object.defineProperties(ra,{instance:{configurable:!0,enumerable:!0,get:function(){ra.Oa||(ra.Oa=new ra);return ra.Oa}}});ra.Oa=null;Object(Hd.a)(ra,"FormulaAssistanceTelemetryManager",null,[]);var lg=b(352),oh=wd.a.zoh,zh=wd.a.JNe,uh=wd.a.KNe,Ji=wd.a.u9c,yi=wd.a.Boh,Oi=wd.a.Foh,
Pi=wd.a.FNe,Mi=wd.a.NNe,zj=wd.a.Doh,lj=wd.a.GNe,Zg=fc.a;vm(Ob,Zg);Ob.prototype.initialize=function(){this.Ob.classList.add(wd.a.xoh);this.Ob.innerHTML=Ob.ZG();this.Me||(this.Wk(),this.C2());Zg.prototype.initialize.call(this);var d=Rc.DOMElementExtensions.Bj(this.Ob,lj);this.rtl&&(d.align="right",this.fub.style.marginLeft="5px");this.Me&&(d.style.padding="1px");this.functionInfoManager.Isb({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};Ob.prototype.dispose=function(){this.functionInfoManager&&
(this.functionInfoManager.kHb(this.onFunctionInfoLoaded),this.functionInfoManager.$.ea.lk(this.$c));eg.a.rc([this.q1b,this.a6,this.Swb,this.MJa,this.gub]);Zg.prototype.dispose.call(this)};Ob.prototype.Wk=function(){this.NJa=Rc.DOMElementExtensions.Bj(this.Ob,oh);this.rja=Rc.DOMElementExtensions.Bj(this.Ob,zh);this.NJa.setAttribute(Ca.a.Td,Ca.a.t_b);this.MJa=new ii.a(this.NJa,!0);this.gub=new ii.a(this.rja,!0);this.rWe=Rc.DOMElementExtensions.Bj(this.Ob,Oi);this.fub=Rc.DOMElementExtensions.Bj(this.Ob,
yi);this.vWe=Rc.DOMElementExtensions.Bj(this.Ob,Mi);this.nmf=Rc.DOMElementExtensions.Bj(this.Ob,zj);this.sWe=$get(Ob.Ecd,this.Ob);this.qja=Rc.DOMElementExtensions.Bj(this.Ob,Pi);this.Me&&(this.qja.style.paddingLeft="1px");this.functionInfoManager.snb(this.onFunctionInfoLoaded);this.functionInfoManager.$.ea.Uj(this.$c)};Ob.prototype.eR=function(d){var w=this;this.$.da.Za(40,function(){w.MJa.eR(d)})};Ob.prototype.mm=function(){this.lcd?this.formulaAssistanceManager.OIe():this.formulaAssistanceControl.set_visible(!1);
Zg.prototype.mm.call(this);this.Hjd||(this.getButton(0).get_element().disabled=!0)};Ob.prototype.setFocus=function(){!this.NJa.disabled&&this.Hjd&&Rc.DOMElementExtensions.setFocus(this.NJa)};Ob.prototype.commit=function(){return!0};Ob.prototype.sqb=function(){var d=this,w=this.P$.NameDataStrings;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var I=new eh.a(-433697611,0,this.$.gd,8,null),ha={};ha=(ha[Kf.a.ld]=w,ha);this.$.Ka.Xb(I,ha)}else{w+=gb.openParen;I=Ne.g(this.$);
I.view.visibleArea.contains(I.pg(null))||I.Rt(I.ha.va.activeCell,3,sk.a.DGh);var wa=this.KIa.textBox;if(this.KIa.isEditing&&this.KIa.text){ha=this.KIa.text;var $a=this.v_c?ha.substring(0,this.v_c):"=";this.KIa.text=$a+w+ha.substring(this.v_c+(wa.lv?wa.lv.length:0),ha.length);wa.caretPosition=$a.length+w.length}else Od.TaskExtensions.Ba(I.startEdit(!0,1),function(){d.KIa.text="="+w;var Tb=w.length+1;wa.wRa(Tb);wa.caretPosition=Tb},this.ma,11,Xe.a.current);I.Dj&&(I=I.yc,I.text=wa.text,I.setCaretPosition(wa.caretPosition));
(I=this.KIa.BY.get(dk.a.c3a))&&I.tU(!1)}};Ob.prototype.JGa=function(){this.lcd?this.formulaAssistanceManager.wda():this.formulaAssistanceControl.lob()};Ob.prototype.Vua=function(d){this.gub.clear();for(var w=Ob.Ecd+" "+Ob.nWe,I=0,ha=d.length;I<ha;++I){var wa=this.gub.oM(d[I].NameUI,d[I].FunctionIndex.toString(),!1);Ci.a.Vu&&wa.classList.add(Ji);wa.setAttribute(Ca.a.fE,Ob.oWe);wa.setAttribute(Ca.a.BJ,w)}this.gub.selectedIndex=0};Ob.prototype.wZf=function(){if(this.P$){this.fub.parentNode.className=
wd.a.GNe+(this.functionInfoManager.Fod(this.P$)?"-udf":"");var d=this.P$.NameDataStrings;this.vWe.innerText=d;this.fub.innerText=d;this.qja.innerText=this.P$.Help;d=this.P$.Params.split(gb.F$c);this.sWe.innerText=gb.openParen+(1<d.length?gb.p7b:d[0])+gb.closeParen}};Ob.ZG=function(){return String.format("<div class='"+wd.a.yoh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+Tg.a.ko+"'>{1}</div>\r\n<div class='"+wd.a.ENe+
"'>\r\n\t<select id='{16}' class='{17} "+N.a.Xo+" "+N.a.Tk+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+wd.a.Coh+"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+N.a.Xo+"'>\r\n\t\t\t<span class='"+N.a.gr+" "+wd.a.Eoh+"'>\r\n\t\t\t\t<img title='{3}' class='"+N.a.Jvh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",
te.a.instance.fa(1005),te.a.instance.fa(1006),te.a.instance.fa(723),te.a.instance.Cb(3),Eg.a.Ee(13),te.a.instance.fa(1007),Ob.BGh,Ob.Ecd,7,oh,yi,Oi,Pi,Mi,zj,lj,Ob.GGh,zh+(Ci.a.Vu?" "+uh:""),Ob.nWe,Ob.oWe)};Sk.Object.defineProperties(Ob.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"FunctionDialog"}},P$:{configurable:!0,enumerable:!0,get:function(){if(!this.rja||!this.rja.firstChild)return null;var d=Number.parseInvariant(this.rja.children[this.rja.selectedIndex].value);return this.functionInfoManager.gRh(d)}}});
Ob.Ecd="function_dialog_param_string";Ob.nWe="function_dialog_function_description";Ob.oWe="function_dialog_function_name";Ob.GGh="function_list";Ob.BGh="function_category";Object(Hd.a)(Ob,"FunctionDialog",fc.a,[]);cc.prototype.Yc=function(d,w){if(!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;switch(w){case 753860909:case -2060563418:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return d=
Ne.g(this.$).yj,d.yLa||!d.isEditing||0>=d.text.length?!1:!0;default:return!1}};cc.prototype.executeCommand=function(d,w,I){w=w.command;d=Ne.g(this.$);switch(w){case 753860909:case -2060563418:ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")?(I=d.yj,d.inRangePicker&&I.iE(!1),this.create(I)):d.uc(null)&&(I=d.yj,I.yLa||!I.isEditing||0>=I.text.length)&&(d.inRangePicker&&I.iE(!1),this.create(I));break;case -433697611:var ha=I[Kf.a.ld]+gb.openParen;I.UILocation&&this.$.xe(-1075437823,
-1,0,null);d.view.visibleArea.contains(d.pg(null))||d.Rt(d.ha.va.activeCell,3,sk.a.DFh);var wa=d.yj,$a=wa.textBox;I=wa.textBox.caretPosition;if(wa.isEditing&&wa.text){w=wa.text;var Tb=I?w.substring(0,I):"=";wa.text=Tb+ha+w.substring(I+($a.lv?$a.lv.length:0),w.length);$a.caretPosition=Tb.length+ha.length}else Od.TaskExtensions.Ba(d.startEdit(!0,1),function(){wa.text="="+ha;var Ic=ha.length+1;$a.wRa(Ic);$a.caretPosition=Ic},this.$.ma,11,Xe.a.current);d.Dj&&(d=d.yc,d.text=$a.text,d.setCaretPosition($a.caretPosition));
this.mF?this.formulaAssistanceManager.wda():(d=wa.BY.get(dk.a.c3a),null===d||void 0===d?void 0:d.tU(!1))}return Vf.Task.Ta(!0)};cc.prototype.Jc=function(d,w){switch(w.command){case 753860909:case -2060563418:case -433697611:return!0;default:return!1}};cc.prototype.zHh=function(d,w){w=this.Sa.Lp(w);var I=this.Sa.Mc(),ha=this.functionInfoManager.G_e(d);if(!ha)return Fd.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),w.aC();for(var wa=0;wa<
ha.length;++wa){var $a=ha[wa].NameUI,Tb=this.Sa.sQ(280,"Formulas."+d+"MenuItem_"+ha[wa].FunctionIndex.toString(),-433697611,null,1,"None",0,0,$a,!1,0);Tb.label=$a;var Ic=ha[wa].Params.split(gb.F$c);Tb.rS($a+" "+(gb.openParen+(1<Ic.length?gb.p7b:Ic[0])+gb.closeParen)+"\n"+ha[wa].Help);Array.add(I.buttons,Tb)}d=this.Sa.Mc();ha=this.Sa.sQ(280,"Formulas.MoreFunctionsMenuItem",-2060563418,N.a.nRe,3,"Image16by16",1004,0,"Formulas.MoreFunctionsMenuItem",!1,0);Array.add(d.buttons,ha);Array.add(w.zc,I);Array.add(w.zc,
d);return w.aC()};cc.prototype.fd=function(d,w,I){d=this.fRh(w);if(-1===d)return!1;this.menuId=I.MenuId;if(!this.functionInfoManager.l5)return this.functionInfoManager.Isb({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;d=this.functionInfoManager.mWe[d];this.wM[d]=this.wM[d]||this.zHh(d,I.MenuId);I.MenuItems=this.wM[d];return!0};cc.prototype.create=function(d){(new Ob(this.$,d)).mf()};cc.prototype.fRh=function(d){switch(d){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;
case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(Hd.a)(cc,"FormulaAssistanceCommandHandler",null,[188]);var ci=Ye.a;vm(Jb,ci);Jb.prototype.Od=function(){var d=this,w=Rg.GetServiceTaskFactory.create(this.$.da,
102,this.ma,this.ub),I=Rg.GetServiceTaskFactory.create(this.$.da,153,this.ma,this.ub);Od.TaskExtensions.Ba(Od.TaskExtensions.ve([w,I],this.ma),function(){d.Fd([new cc(d.$,w.result,I.result)])},this.ma,3)};Jb.ja=function(d){Ye.a.fe(92,new Jb(d))};Object(Hd.a)(Jb,"FormulaAssistanceCommandHandlerFactory",Ye.a,[]);ic.prototype.dispose=function(){this.yXd();this.OJa=this.Oua=this.nja=null};ic.prototype.vXc=function(d){d&&(this.nja=d,this.nja.Rne(this.gCf),this.nja.Goe(this.iCf),this.P5a&&this.nja.Foe(this.hCf))};
ic.prototype.wXc=function(d){d&&(this.Oua=d,this.oMa&&(this.Oua.Pne(this.syf),this.Oua.Nne(this.lyf)),this.nMa&&this.Oua.One(this.oyf))};ic.prototype.Yse=function(d){d&&(this.OJa=d,this.OJa.Hoe(this.jCf),this.OJa.kVc(this.cCf))};ic.prototype.yXd=function(){var d,w,I;this.nja&&(this.nja.RQf(this.gCf),this.nja.oRf(this.iCf),this.P5a&&this.nja.nRf(this.hCf));this.OJa&&(this.OJa.pRf(this.jCf),this.OJa.uJd(this.cCf));this.oMa&&(null===(d=this.Oua)||void 0===d?void 0:d.QQf(this.syf),null===(w=this.Oua)||
void 0===w?void 0:w.OQf(this.lyf));this.nMa&&(null===(I=this.Oua)||void 0===I?void 0:I.PQf(this.oyf))};ic.prototype.J6i=function(d,w){if(w){var I="";this.P5a||(I+=te.a.instance.Cb(56)+this.ariaLiveNotifier.Lxa);for(var ha=0;ha<w.length;ha++)I+=d+this.ariaLiveNotifier.Lxa+this.XYc(w[ha])+ic.$Dd(ha,w.length);this.P5a&&(I+=te.a.instance.fa(864)+this.ariaLiveNotifier.Lxa);this.ariaLiveNotifier.readText(I)}};ic.prototype.I6i=function(d,w,I){if(d){var ha="",wa=0;if(w){for(var $a=0;$a<w.length;$a++)if(I>=
d[$a].split(this.$.listSeparator).length)wa++;else{var Tb=w[$a].trim();if(!Tb)return;Tb=this.XYc(Tb);var Ic=ic.$Dd($a-wa,w.length-wa);ha+=Tb+Ic;Ic&&(ha+=this.ariaLiveNotifier.Lxa)}this.ariaLiveNotifier.readText(ha)}}};ic.prototype.XYc=function(d){if(!d)return"";var w=d.split(this.$.listSeparator);d="";w=yl(w);for(var I=w.next();!I.done;I=w.next()){var ha=I.value;ic.dod(ha)?d+=ha:(ha=(I=ic.hli(ha))?ha.replace("[","").replace("]",""):ha,d+=String.format(I?te.a.instance.Cb(58):te.a.instance.Cb(57),ha));
d+=this.ariaLiveNotifier.Lxa}return d};ic.$Dd=function(d,w){if(d>=w||1===w)return Fd.ULS.shipAssertTag(537161997,0,d<w,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""};ic.dod=function(d){return k.a.contains(d,gb.p7b,!0)};ic.hli=function(d){return d.trimStart().startsWith(gb.hGf)||d.trimEnd().endsWith(gb.gGf)};Object(Hd.a)(ic,"FormulaAssistanceReadoutHandler",null,[751,3]);var Ui=bi.a;vm(Ub,Ui);Ub.prototype.create=function(){var d=this,w=this.$.da;Od.TaskExtensions.Ba(Rg.GetServiceTaskFactory.Wa(w,
211,212,this.ub),function(I){I=w.Aa(219)||new ic(I.result,d.$);d.Fb(I)},this.ma,3)};Ub.ja=function(d){d.da.Ha(220,new Ub(d))};Object(Hd.a)(Ub,"FormulaAssistanceReadoutHandlerFactory",bi.a,[]);var Ri=b(687),Ij=b(109),mi=b(1128);pb.prototype.phd=function(d){return this.MQa&&d in this.MQa?this.MQa[d]:null};pb.prototype.q7f=function(d,w){this.MQa||(this.MQa={});this.MQa[d]=w};pb.prototype.SZ=function(){this.MQa=null};Object(Hd.a)(pb,"FormulaAssistanceContextualPreviewCache",null,[]);lc.prototype.dispose=
function(){this.Md||(this.$&&(this.$.ea.VF(this.$C),this.$=null),this.Jha=this.fFb=null,this.Md=!0)};lc.prototype.ced=function(d,w,I,ha){var wa=this;if(w&&0>=w.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!d)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.Aa(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");
var $a="="+w.substring(I.start,I.end);ye.EwaSettings.la(620)&&($a=this.calcManager.WZh(Ne.g(this.$).ha.va.activeCell,d,I));var Tb=this.mNh($a,I);if(ye.EwaSettings.la(620)){if(Tb&&!this.calcManager.isFormulaSubExpressionVolatile(d))return Promise.resolve(Tb)}else if(Tb)return Promise.resolve(Tb);return this.oNh($a,I).then(function(Ic){if(wa.f0c(ha))throw Error.create("OperationCanceledException");if(!Ic||Ic.Mij||Ic.cna.startsWith("##UNSUPPORTED:"))return wa.cZe(w,$a,I,ha);wa.Jha.q7f($a,Ic.cna);return Promise.resolve(Ic)})};
lc.prototype.mNh=function(d,w){return(d=this.Jha.phd(d))?new mi.a(d,w.start,w.end,0):null};lc.prototype.oNh=function(d,w){if(!d||0>=d.length||!w)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.BTg(Ne.g(this.$).ha.va.activeCell,d,this.Lzi,w)};lc.prototype.cZe=function(d,w,I,ha){var wa=this;if(!d||0>=d.length||!w||0>=w.length||!I)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.aPa)return this.nNh(d,w,I,ha);var $a={};$a.PartialFormula=w;$a.Formula=d;$a.SourceRange=td.v(Ne.g(this.$).ha.va.activeCell,this.$);return this.aPa=new Promise(function(Tb,Ic){wa.fFb=new Ri.a;wa.pTf=wa.$.ea.uf;wa.B$a=Oa(wa.$.na.ta,$a,function(pc){wa.xVi(w,I,ha,pc,Tb,Ic)},function(pc){wa.aPa=null;wa.B$a=null;Ic(pc)},null,null,null);wa.fFb.token.R(function(){wa.fVg(Ic)})})};lc.prototype.xVi=function(d,w,I,ha,wa,$a){this.B$a=this.aPa=null;if(this.pTf!==this.$.ea.uf)$a(Error.create("OperationCanceledException"));
else if(ha.Result)if(ha=Ld.a.pi(ha.Result),!ha||Ij.a.isEmpty(ha))wa(null);else{for(var Tb in ha)this.Jha.q7f(Tb,ha[Tb]);this.f0c(I)?$a(Error.create("OperationCanceledException")):(d=this.Jha.phd(d))?(""===d&&(d=" "),wa(new mi.a(d,w.start,w.end,0))):$a(Error.create("SubexpressionNotFoundException"))}else wa(null)};lc.prototype.nNh=function(d,w,I,ha){var wa=this;return new Promise(function($a,Tb){wa.aPa.then(function(){wa.bUf(d,w,I,ha,$a,Tb)}).catch(function(){wa.bUf(d,w,I,ha,$a,Tb)})})};lc.prototype.bUf=
function(d,w,I,ha,wa,$a){if(this.f0c(ha))$a(Error.create("OperationCanceledException"));else{var Tb=this.Jha.phd(w);Tb?wa(new mi.a(Tb,I.start,I.end,0)):this.cZe(d,w,I,ha).then(function(Ic){wa(Ic)}).catch(function(Ic){$a(Ic)})}};lc.prototype.fVg=function(d){this.B$a&&(Cg.a.ou(this.B$a.Ft)?(this.aPa=this.B$a=null,d(Error.create("PendingWebReqeuestCancelled"))):Fd.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};lc.prototype.SZ=function(){this.gVg();this.Jha&&this.Jha.SZ()};
lc.prototype.gVg=function(){this.fFb&&this.fFb.C()};lc.prototype.f0c=function(d){return this.Md||d.uK};Object(Hd.a)(lc,"FormulaAssistanceContextualPreviewCalculator",null,[3]);var Si=b(139),wi=b(208);Xb.mph="ewa-facp-text-box";Object(Hd.a)(Xb,"CssClassNames",null,[]);$b.prototype.dispose=function(){(this.H$||this.rQ)&&this.n9e();this.Ya=this.xqa=null};$b.prototype.VRj=function(d,w,I,ha){d&&w&&ha&&w.cna&&!(1>w.cna.length)&&(this.Ya=d,this.XPf(),this.f2a=w,this.PSa=ha,this.LAj(w,I,ha))};$b.prototype.n9e=
function(){this.z7h();this.XPf();this.PSa=this.f2a=null};$b.prototype.LAj=function(d,w,I){var ha=this;if(d.cna&&!(1>d.cna.length)){var wa=this.Oc.da.Aa(266);if(wa){var $a=wa.pTh();$a&&Od.TaskExtensions.Ba(this.fBb,function(){if(w)if(ye.EwaSettings.la(620)&&ha.Ya.isEditing&&0<I.length){ha.fxb(d.JJa,I[0].start,null);var Tb=ha.b4e(I[0],$a),Ic=ha.Ya.text.substring(I[0].start,I[0].end).trim();Ic=ha.Ya.text.indexOf(Ic);Ic=ha.Ya.text.substring(0,Ic).lastIndexOf("\n");ha.fxb(0>Ic||1>=I.length?I[0].start:
Ic+1,I[0].end,Tb?String.format(Tb,.3):null);for(var pc=1;pc<I.length;pc++)Tb=ha.b4e(I[pc],$a),Ic=ha.Ya.text.substring(I[pc].start,I[pc].end).trim(),Ic=ha.Ya.text.indexOf(Ic),Ic=ha.Ya.text.substring(I[pc-1].end,Ic).lastIndexOf("\n"),ha.fxb(0>Ic?I[pc-1].end:Ic+1+I[pc-1].end,I[pc].end,Tb?String.format(Tb,.3):null);Ic=ha.Ya.text.substring(I[I.length-1].end,d.Rua).indexOf("\n");ha.fxb(0>Ic?I[I.length-1].end:Ic+1+I[I.length-1].end,d.Rua,null);Fd.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else ha.fxb(d.JJa,
d.Rua,null),Fd.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");ha.H$||(ha.H$=document.createElement(wi.a.div),ha.Ya.textBox.domElement.appendChild(ha.H$));ha.rQ||(ha.rQ=document.createElement(wi.a.div),ha.rQ.className=Xb.mph,ha.Oc.domElement.appendChild(ha.rQ));Tb=d.Rua;ye.EwaSettings.la(620)&&ha.Ya.isEditing&&I&&0<I.length&&I[0].start<Tb&&I[0].start!==d.JJa&&!ha.Ya.textBox.lv.length&&
(Tb=I[0].start);pc=k.a.contains(ha.Ya.textBox.nf.id,"FormulaBar",!0)&&k.a.contains(ha.Ya.text.substring(d.JJa,d.Rua),"\n",!0);Ic=ha.Ya.isEditing?ha.Ya.textBox.caretPosition:0;Tb=excelOnline.utils.getBoundingRectForText(ha.Ya.textBox.nf,pc?Ic:d.JJa,pc?Ic:Tb,ye.EwaSettings.la(620));ha.rQ.style.left=qb.HelperMethods.Qb(Tb.left);ha.rQ.style.top=qb.HelperMethods.Qb(Tb.top);ha.rQ.style.width=qb.HelperMethods.Qb(Tb.width);ha.rQ.style.height=qb.HelperMethods.Qb(Tb.height);Tb=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",
d.Rua,d.Rua);dialogControls.renderToolTip(ha.H$,Tb,d.cna,ha.rQ,0,!1,!1,1)},this.Oc.ma,3)}}};$b.prototype.b4e=function(d,w){var I=this.Ya.text,ha=I.substring(d.start,d.end);ha=ha.trim();d=I.indexOf(ha,d.start);w=I.indexOf(w,d);ha=I.substring(d,w);ha=ha.trim();return this.Ya.colors.getItem(d+"-"+(d+ha.length))};$b.prototype.z7h=function(){var d=this;this.Ya&&this.H$&&this.rQ&&Od.TaskExtensions.Ba(this.fBb,function(){d.Ya.textBox.domElement.contains(d.H$)&&(dialogControls.clearToolTip(d.H$),d.Ya.textBox.domElement.removeChild(d.H$),
d.H$=null);d.Oc.domElement.contains(d.rQ)&&(d.Oc.domElement.removeChild(d.rQ),d.rQ=null)},this.Oc.ma,3)};$b.prototype.fxb=function(d,w,I){if(this.Ya&&!(d>=w)){var ha={};this.Ya.textBox.formatText(d,w-d,(ha.background=I||"#E3DDCC",ha));this.xjd=!0}};$b.prototype.XPf=function(){if(this.Ya&&this.f2a&&this.xjd){var d=this.f2a.Rua;ye.EwaSettings.la(620)&&0<this.PSa.length&&this.PSa[this.PSa.length-1].end>d&&(d=this.PSa[this.PSa.length-1].end);var w={};this.Ya.textBox.formatText(this.f2a.JJa,d-this.f2a.JJa,
(w.background=!1,w));this.xjd=!1}};Sk.Object.defineProperties($b.prototype,{fBb:{configurable:!0,enumerable:!0,get:function(){var d=this;if(this.xqa)return this.xqa;var w=new Si.a;this.Oc.$E(function(I){Od.TaskExtensions.Ba(I.Gtd(),function(){w.setResult(!0)},d.Oc.ma,3)});return this.xqa=w.task}}});Object(Hd.a)($b,"FormulaAssistanceContextualPreviewControl",null,[3]);var zi=b(44),Ei=b(42);pd.prototype.P3f=function(d,w,I){I?this.V5g(d,w,I):this.t6e(d,w,I,!0)};pd.prototype.shj=function(){this.P7=0};
pd.prototype.V5g=function(d,w,I){var ha=this;this.P7++;var wa=this.P7;zi.a.instance.create(function(){ha.t6e(d,w,I,wa===ha.P7)},500,Ei.a.EFh,!0,!0)};pd.prototype.t6e=function(d,w,I,ha){var wa=this,$a=this.kcd.ced(d,w);$a&&$a.then(function(Tb){ha&&wa.kcd.Qod(w)&&wa.kcd.URj(d,Tb,I)}).catch(function(Tb){Tb=Object(qc.a)(Error,Tb);"OperationCanceledException"===Tb.message?Fd.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",Tb):Fd.ULS.sendTraceTag(537162058,0,
10,"GetContextualFormulaPreviewResults - caught exception: {0}",Tb)})};Object(Hd.a)(pd,"FormulaAssistanceContextualPreviewHoverManager",null,[]);sc.prototype.dispose=function(){this.d_c();eg.a.rc([this.Ytb,this.j$b]);this.k$b=this.j$b=this.Ytb=null;this.$&&Ne.g(this.$).yc.Pn(this.s9a);this.Hha=this.Ya=this.$=null};sc.prototype.MAj=function(d,w){w&&Vh.e(w.text)&&!(w.Jwa||w.textBox.lv||this.Ya&&this.Ya.textBox.lv)&&(this.Ya=w,this.calcManager=this.$.da.Aa(266))&&(Fd.ULS.sendTraceTag(537162056,0,50,
"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),d=qb.HelperMethods.Iub(d),d=this.calcManager.TZh(Ne.g(this.$).ha.va.activeCell,this.Ya.text,d.x,d.y),w=this.calcManager.getSubExpressionSpan(d),!w||w.end<=w.start||this.Qod(w)||(this.Hha=w,this.k$b.P3f(d,w,!0)))};sc.prototype.IRd=function(d){if(d&&Vh.e(d.text))if(d.textBox.lv&&d.textBox.lv.trim()){if(this.Ya=d,this.calcManager=this.$.da.Aa(266)){Fd.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");d={};var w=this.Ya.textBox.lv.trim();d.start=this.Ya.text.indexOf(w,this.Ya.textBox.caretPosition);d.end=d.start+w.length;(w=this.calcManager.getFormulaSubExpressionObject(Ne.g(this.$).ha.va.activeCell,this.Ya.text,this.Ya.textBox.lv))&&!this.Qod(d)&&(this.Hha=d,this.k$b.P3f(w,d,!1))}}else this.c5a(!1,!0)};sc.prototype.c5a=function(d,w){!this.Ya||w&&this.Ya.textBox.lv||
(this.Hha=null,d&&(this.d_c(),this.j$b.SZ(),this.k$b.shj()),this.Ytb&&this.Ytb.n9e(),this.Ya.Jwa||(this.Ya.Jwa=!1,this.Ya=null))};sc.prototype.ced=function(d,w){if(!this.Ya||this.Ya.Jwa)return null;this.d_c();this.prb=new Ri.a;return this.j$b.ced(d,this.Ya.text,w,this.prb.token)};sc.prototype.URj=function(d,w,I){this.prb=null;!d||!w||!w.cna||0>=w.cna.length?this.c5a(!1,!1):(d=this.calcManager.UZh(Ne.g(this.$).ha.va.activeCell,d,this.Ya.text),this.Ytb.VRj(this.Ya,w,I,d))};sc.prototype.Qod=function(d){return this.Hha?
d.start===this.Hha.start&&d.end===this.Hha.end&&d.pre===this.Hha.pre&&d.post===this.Hha.post:!1};sc.prototype.d_c=function(){this.prb&&this.prb.C()};Object(Hd.a)(sc,"FormulaAssistanceContextualPreviewManager",null,[761,3,762]);var Ai=b(1187),vh=b(902),ki=b(244),Og=b(154);mb.prototype.i_f=function(d){this.oT=0;this.e9d=d.IsCompatibility;this.set_name(d.NameDataStrings);this.VVa=d.Help};mb.prototype.orj=function(d){this.oT=1;this.set_name(d.Name)};mb.prototype.Pqj=function(d){this.oT=2;this.set_name(d.name);
this.VVa=d.tooltip};mb.prototype.psj=function(d){this.oT=3;this.set_name(d.name);this.VVa=d.toolTip};mb.prototype.G0f=function(d){this.oT=4;this.set_name(d.name)};mb.prototype.Juj=function(d){this.oT=5;this.set_name(d.name);this.VVa=d.toolTip};mb.prototype.Iuj=function(d){this.oT=7;this.set_name(d.name)};mb.prototype.etj=function(){this.oT=6;this.set_name(te.a.instance.Cb(182));this.VVa=te.a.instance.Cb(183)};mb.prototype.set_name=function(d){return this.C$d=d};mb.k$g=function(){return Object.assign(new mb,
{j$d:!0})};Sk.Object.defineProperties(mb.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.oT}},ahi:{configurable:!0,enumerable:!0,get:function(){return this.e9d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.C$d}},qja:{configurable:!0,enumerable:!0,get:function(){return this.VVa}},Izb:{configurable:!0,enumerable:!0,get:function(){return this.j$d}}});Object(Hd.a)(mb,"AutoCompleteItem",
null,[810]);Object(Hd.a)(Za,"DefinedNameInfo",null,[]);ec.prototype.xOj=function(d){var w=this.uHe[d.toUpperCase()];if(!w)return{returnValue:!1,sheetName:"",range:null};d=w.sheetName;w=this.W2g(w.namedRange);return{returnValue:!0,sheetName:d,range:w}};ec.prototype.k3g=function(d){if(null!=d&&void 0!=d)return{top:d.top,left:d.left,bottom:d.bottom,right:d.right,maxRows:d.maxRows,maxColumns:d.maxColumns,sheetName:void 0}};ec.prototype.W2g=function(d){if(null!=d&&void 0!=d)return new Zj.a(d.top,d.left,
d.bottom,d.right,d.maxRows,d.maxColumns)};ec.prototype.d3g=function(d){switch(d){case 2:return 0;case 3:return 1;default:return-1}};Sk.Object.defineProperties(ec.prototype,{tHe:{configurable:!0,enumerable:!0,get:function(){var d=[];if(!this.$.zb||!this.$.zb.items)return d;for(var w=0,I=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&yg.a.mF(this.$),ha=yl(this.$.zb.items),wa=ha.next();!wa.done;wa=ha.next())if((wa=wa.value)&&(3===wa.type&&wa.usedRange||
I&&2===wa.type)){var $a=new Za;$a.tooltip=wa.sheetName+va.a.exclamation+wa.usedRange.toString();$a.name=wa.name;$a.namedRange=this.k3g(wa.usedRange);$a.sheetName=wa.sheetName;$a.type=this.d3g(wa.type);Array.add(d,$a);this.uHe[wa.name.toUpperCase()]=$a;++w;if(w===gb.lqf){Fd.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: {0}",gb.lqf);break}}return d}}});Object(Hd.a)(ec,"DefinedNameInfoManager",null,[]);var Rj=b(121),Tj=Sys.EventArgs;vm(tb,Tj);Object(Hd.a)(tb,
"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);var Pk=Sys.EventArgs;vm(Ya,Pk);Object(Hd.a)(Ya,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Wk=Sys.EventArgs;vm(Eb,Wk);Object(Hd.a)(Eb,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var jj=b(255);ub.prototype.Ne=function(d,w){d=!1;w||(Ne.g(this.$).yj.textBox.pK=!0,d=this.formulaAssistanceUIControl.focus(this.VVe));return d};ub.prototype.Yf=function(d){var w=this.Jb;return!(void 0===w||
null===w)&&Rc.DOMElementExtensions.Oe(w,d)};ub.prototype.gi=function(){this.N6e&&this.N6e()};ub.prototype.Qh=function(){};ub.prototype.dispose=function(){jj.a(this.$).Dz(this)};Sk.Object.defineProperties(ub.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.RZc},set:function(d){this.RZc!==d&&(d?jj.a(this.$).Rg(this):jj.a(this.$).Dz(this),this.RZc=d)}},Zd:{configurable:!0,enumerable:!0,get:function(){return this.Ymj}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.VVe)}}});
Object(Hd.a)(ub,"FormulaAssistanceFocusManager",null,[112,3]);var Aj=b(1044),nj=dh.a;vm(ib,nj);ib.prototype.snb=function(d){this.addHandler("FunctionInfoLoaded",d)};ib.prototype.kHb=function(d){this.removeHandler("FunctionInfoLoaded",d)};ib.prototype.eFg=function(d){this.addHandler("FunctionInfoReset",d)};ib.prototype.wcj=function(d){this.removeHandler("FunctionInfoReset",d)};ib.prototype.dispose=function(){var d=this.$.da.Aa(268);d&&d.mJd(this.wyf);this.vb=null;nj.prototype.dispose.call(this)};ib.prototype.ITf=
function(){this.raiseEvent("FunctionInfoReset")};ib.prototype.RKd=function(){this.ITf();this.TKc=!1;this.kT=null;this.RKc=!0};ib.prototype.Isb=function(d,w){var I=this;w=void 0===w?!1:w;if(this.l5)this.MLf();else{Fd.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.ya.UICultureTag);var ha=null;(ha=this.$.da.Aa(268))||Fd.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===ha||void 0===ha?0:ha.sja)&&
0<ha.sja.length)ye.EwaSettings.la(122)?ha.eFh(this.Lyf):this.xHd(ha.sja,!0,!1);else{var wa=this.$.na.ta.Zb();d&&(this.$.ea.qc||w)&&!this.Wii&&(w?Ch.a(this.$.userOperationManager,function($a,Tb,Ic){return jg.x(I.$.na.ta,d,Jf.b($a,I.Nyf),Jf.a(Tb,I.Myf),Ic,d,wa)},function($a){return new Uf.a(130,0,$a,16)},null):jg.x(this.$.na.ta,d,this.Nyf,this.Myf,null,d,wa));!this.l5&&this.$.ea.qc&&(ha?(Fd.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",
this.l5,this.$.ea.qc),ha.Qne(this.wyf)):(Fd.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),jg.x(this.$.na.ta,{FilterType:0},this.Lyf,null,null,null,wa),this.RKc=!1))}}};ib.prototype.gRh=function(d){return 0>d||d>=this.kT.length?null:this.kT[d]};ib.prototype.cfd=function(d){return Pg.a.Gc(this.Mcd,d.toUpperCase())};ib.prototype.G_e=function(d){return Pg.a.Gc(this.PJa,d)};ib.prototype.Fod=function(d){return!d.GroupUI};
ib.prototype.zyf=function(d,w,I){var ha=xh.a(d);Fd.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",ha);ha?(Ne.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.ea.np(d.Errors)):(this.xHd(d.Result,w,I),yg.a.a_()&&!yg.a.mF(this.$)&&this.fUj())};ib.prototype.xHd=function(d,w,I){Fd.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",
d.length,w,I,this.l5);this.l5||(this.kT=d,this.iQg(w),this.TKc=!I,this.MLf())};ib.prototype.MLf=function(){this.raiseEvent("FunctionInfoLoaded")};ib.prototype.fUj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.Hcd)};ib.prototype.iQg=function(d){function w(Pe,Af){return Pe.NameUI.localeCompare(Af.NameUI)}var I=te.a.instance.fa(1001),ha=[];this.PJa={};this.O8=[];this.PJa[I]=ha;var wa=te.a.instance.fa(1002),$a=[];Array.add(this.O8,I);Array.add(this.O8,wa);I=0;for(var Tb=this.kT.length;I<
Tb;I++){var Ic=this.kT[I];Ic.IsCompatibility||Array.add($a,Ic);var pc=Ic.NameUI,vd=Ic.NameDataStrings;this.Mcd[vd.toUpperCase()]||(this.Mcd[vd.toUpperCase()]=Ic);this.xWe[pc.toUpperCase()]||(this.xWe[pc.toUpperCase()]=Ic);if(!this.Fod(Ic)){if(d){pc=Ic.GroupUI;var ne=Pg.a.Gc(this.PJa,pc);ne||(ne=[],this.PJa[pc]=ne,Array.add(this.O8,pc));Array.add(ne,Ic)}Ic.IsCommonlyUsed&&Array.add(ha,Ic);Ic.IsCompatibility||Array.add(this.opg,vd)}}this.PJa[wa]=$a;d&&(ib.nPf(ha,[2,3,0,5,4,9,1,7,8,6]),ha=Array(14),
ha[0]=0,ha[1]=1,ha[2]=7,ha[3]=11,ha[4]=5,ha[5]=2,ha[6]=6,ha[7]=10,ha[8]=9,ha[9]=3,ha[10]=4,ha[11]=13,ha[12]=12,ha[13]=8,ib.nPf(this.O8,ha),ha=[],Array.addRange(ha,this.O8),Array.removeAt(ha,13),this.O8=ha);this.kT=Array.clone(this.kT);this.kT.sort(function(Pe,Af){return Pe.NameDataStrings.localeCompare(Af.NameDataStrings)});ha=1;for(wa=this.O8.length;ha<wa&&d;ha++)this.PJa[this.O8[ha]].sort(w);d=0;for(ha=this.kT.length;d<ha;d++)this.kT[d].FunctionIndex=d};ib.nPf=function(d,w){for(var I=Array.clone(d),
ha=0;ha<I.length&&ha<w.length;ha++)d[ha]=I[w[ha]]};Sk.Object.defineProperties(ib.prototype,{l5:{configurable:!0,enumerable:!0,get:function(){return this.TKc}},Wii:{configurable:!0,enumerable:!0,get:function(){return this.RKc}},Hcd:{configurable:!0,enumerable:!0,get:function(){var d=this.kT,w=Aj.a(this.$);if(!w)return d;w=w.uQh();var I=w.length;if(0>=I)return d;var ha=[];Array.addRange(ha,d);for(d=0;d<I;d++){var wa=w[d],$a={};$a.FunctionIndex=ha.length;$a.HelpId=$a.GroupUI=null;$a.Help=wa.description;
$a.IsCommonlyUsed=$a.IsCompatibility=!1;$a.NameDataStrings=wa.name;$a.NameUI=wa.name;$a.Params=null;$a.ParamsHelp=null;Array.add(ha,$a)}return ha}},mWe:{configurable:!0,enumerable:!0,get:function(){return this.O8}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(Hd.a)(ib,"FunctionInfoManager",dh.a,[749,750,3]);var ni=b(1124),sj=ni.a;vm(vb,sj);vb.prototype.setVisible=function(d){Rc.DOMElementExtensions.setVisible(this.domElement,d);d||(this.domElement.style.top="auto",this.domElement.style.left=
"auto")};vb.prototype.isRtl=function(){return this.kj};vb.prototype.a2e=function(){return this.domElement.parentNode};vb.prototype.LRa=function(d){var w=this.domElement.style;w.cursor="move";w.position=d?"relative":"absolute"};Object(Hd.a)(vb,"FunctionParamBoxDraggableItem",ni.a,[]);Object(Hd.a)(Dc,"FormulaArgumentAssistanceCallbacks",null,[]);Object(Hd.a)(Mb,"FormulaArgumentAssistanceRenderingInfo",null,[]);Object(Hd.a)(cb,"ArgumentAssistanceRequest",null,[]);Ga.prototype.ja=function(d){(this.root=
d)&&!this.hn&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.hn=!0)};Ga.prototype.detach=function(){this.root&&this.hn&&(this.root.addEventListener("keydown",this.onKeyDown,!0),this.hn=!1)};Ga.prototype.P7b=function(){this.root&&(this.target=this.cH.nEf("move",!0),this.ITd=this.target.getBoundingClientRect(),this.PZ=!0,this.LQd=!1,this.hv(),this.olc||this.l4c(),this.target.appendChild(this.olc))};Ga.prototype.k4=function(d){this.cH.Hxf(void 0===d?!1:d);this.PZ=!1;this.OId();this.mId();
this.ITd=this.target=void 0};Ga.prototype.hv=function(){this.qr.capture(this.aNa,null);this.pointerInputManager.ot(sg.a.pointerDown,this.target,this.pFb,!0);this.target.addEventListener("blur",this.onBlur)};Ga.prototype.mId=function(){this.qr.releaseCapture();this.pointerInputManager.ut(sg.a.pointerDown,this.target,this.pFb,!0);this.target.removeEventListener("blur",this.onBlur)};Ga.prototype.OId=function(){var d;this.target&&(null===(d=this.olc)||void 0===d?void 0:d.parentNode)===this.target&&this.target.removeChild(this.olc)};
Ga.prototype.Z5=function(d,w){var I=this.target.getBoundingClientRect();d+=I.left-this.ITd.left;w+=I.top-this.ITd.top;this.cH.onMove(d,w)};Ga.prototype.l4c=function(){this.olc=fj.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")};Object(Hd.a)(Ga,"FormulaAssistanceMoveAdapter",null,[]);var Sj=b(268);za.prototype.tba=function(){return this.hn&&!!this.cka};za.prototype.DOa=function(d){this.cka.style.cursor="grabbing";this.GGj=d.clientPoint.x;this.HGj=d.clientPoint.y;this.cH.nEf("drag");
return!0};za.prototype.cma=function(d){this.cH.onMove(d.clientPoint.x-this.GGj,d.clientPoint.y-this.HGj);return!0};za.prototype.bma=function(){this.Mt()};za.prototype.ama=function(){this.Mt()};za.prototype.ja=function(d){if(this.cka=d)this.cka.style.cursor="grab",Sj.a.instance.k0(this.cka,this),this.hn=!0};za.prototype.detach=function(){this.hn&&this.cka&&(this.cka.style.cursor="",Sj.a.instance.X7(this.cka,this),this.hn=!1)};za.prototype.Mt=function(){this.cka.style.cursor="grab";this.cH.Hxf()};Object(Hd.a)(za,
"FormulaAssistanceDragAdapter",null,[831]);ya.prototype.ja=function(d,w,I,ha){this.root=d;this.render=I;this.dismiss=ha;this.detach();w&&(this.ZJe.ja(w),this.lrf.ja(d.firstChild),this.hn=!0)};ya.prototype.detach=function(){this.hn&&(this.ZJe.detach(),this.lrf.detach(),this.hn=!1);Rc.DOMElementExtensions.Tf(this.placeholder)};ya.prototype.clear=function(){this.l$b.setOverrideTarget(void 0);this.detach();this.DKd()};ya.prototype.nEf=function(d,w){w=void 0===w?!1:w;this.usageCount[d]+=1;this.xyc=this.root.firstChild.getBoundingClientRect();
this.placeholder=this.root.cloneNode(!0);d=this.placeholder.firstChild;d.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);w&&(this.WEd=document.activeElement,d.tabIndex=0,d.focus());this.dismiss();return d};ya.prototype.onMove=function(d,w){d=Math.min(Math.max(d,this.TCc-this.xyc.left),window.innerWidth-this.xyc.right-this.TCc);w=Math.min(Math.max(w,this.TCc-this.xyc.top),window.innerHeight-this.xyc.bottom-this.TCc);this.placeholder.firstChild.style.transform="translate("+
d+"px, "+w+"px)"};ya.prototype.Hxf=function(d){var w=this;d=void 0===d?!0:d;var I=this.placeholder.firstChild.getBoundingClientRect(),ha=this.l$b.getDirectionalHint({top:I.top,left:I.left});this.l$b.setOverrideTarget({top:1===ha?I.bottom:I.top,left:I.left});this.render();window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){Rc.DOMElementExtensions.Tf(w.placeholder);w.WEd&&(d&&w.WEd.focus(),w.WEd=void 0)})})};ya.prototype.DKd=function(){var d=ra.instance.Iaa,w=this.usageCount[Mj.Drag],
I=this.usageCount[Mj.Move];0<w&&(d.argumentAssistanceDragCounter+=1,d.argumentAssistanceDragTotalCounter+=w,this.usageCount[Mj.Drag]=0);0<I&&(d.argumentAssistanceMoveCounter+=1,d.argumentAssistanceMoveTotalCounter+=I,this.usageCount[Mj.Move]=0)};Object(Hd.a)(ya,"FormulaAssistanceDragControl",null,[]);var Mj;(function(d){d.Drag="drag";d.Move="move"})(Mj||(Mj={}));Object(Hd.b)("FormulaAssistanceDragMode",Mj);var ok=tg.a;vm(eb,ok);eb.prototype.Rne=function(d){this.addHandler("FAFunctionNameUpdated",
d)};eb.prototype.RQf=function(d){this.removeHandler("FAFunctionNameUpdated",d)};eb.prototype.Goe=function(d){this.addHandler("FAParameterSelectionChangedOld",d)};eb.prototype.oRf=function(d){this.removeHandler("FAParameterSelectionChangedOld",d)};eb.prototype.Foe=function(d){this.addHandler("FAParameterSelectionChanged",d)};eb.prototype.nRf=function(d){this.removeHandler("FAParameterSelectionChanged",d)};eb.prototype.set_visible=function(d){this.Vm?d||this.Wrb():Sys.UI.Control.prototype.set_visible.call(this,
d);return d};eb.prototype.Wrb=function(){this.formulaAssistanceUIControl&&(this.Oq=null,this.lR&&this.cH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.nla=null,this.kr.canReceiveFocus=!1)};eb.prototype.show=function(d){this.Vm||(ra.instance.D7(["argumentAssistanceRender"]),this.H1a.setVisible(!!d),ra.instance.lZ(["argumentAssistanceRender"]),this.VWc&&(this.VWc=!1,ra.instance.B7b("argumentAssistanceOverall")))};eb.prototype.Hgj=function(){var d=this;if(!this.qba||this.aSa){ra.instance.D7(["argumentAssistanceComputation",
"argumentAssistanceOverall"]);var w=Ne.g(this.$).yj;this.pluginScheduler.requester().argumentAssistance(Object.assign(new cb,{content:w.text,caretPosition:w.textBox.caretPosition})).then(function(I){0===I.kind?I.payload?(ra.instance.lZ(["argumentAssistanceComputation"]),d.qAj(d.rEd(I.payload),w.textBox.domElement)):d.Wrb():ra.instance.lZ(["argumentAssistanceComputation"],!1);return null})}};eb.prototype.update=function(d,w,I,ha){if(!this.Vm&&d){ra.instance.D7(["argumentAssistanceComputation","argumentAssistanceOverall"]);
this.VWc=!0;var wa=this.$.listSeparator;try{var $a=$get(gb.Kcd,this.xj),Tb=$get(gb.Dcd,this.xj);$a.innerText="";Tb.innerText="";var Ic=$get(gb.tWe,this.xj),pc=d.Params.split(gb.F$c);$a=[];Tb=0;for(var vd=Ic.rows.length;Tb<vd;Tb++){var ne=Ic.rows[Tb];Rc.DOMElementExtensions.setVisible(ne,Tb<pc.length);var Pe=pc[Tb],Af=gb.HXi+Tb+"_",Wf=d.NameDataStrings;$get(Af+gb.UEb,ne).innerText=Wf;$get(Af+gb.WCd,ne).innerText=Wf;if(Pe){var Of=pc[Tb].split(wa),xg=eb.dod(Of[Of.length-1]),oi=eb.lli(d);xg&&(oi&&(2<
Of.length?(Of[Of.length-2]+="1",Of[Of.length-3]+="1"):Fd.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Wf,Of.length.toString(),w)),eb.lKg(Of,oi,w,d));Pe=Of.join(wa.toString()+" ");pc[Tb]=Pe;I<Of.length?($a[Tb]=Of[I],Fd.ULS.shipAssertTag(537162072,0,!!Of[I]&&1<=Of[I].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",
I,Of.length,Wf,Tb),Of[I]=String.format("{0}{1}{2}","<b>",Of[I],"</b>"),Pe=Of.join(wa.toString()+" ")):Fd.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+I+"currRowParamsArray.Length = "+Of.length+", current row = "+Tb);ha&&Fd.ULS.sendTraceTag(558474578,0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",Wf,Of.length,xg,oi,w)}$get(Af+gb.XCd,ne).innerHTML="("+(Pe||"")+")"}ha?
this.raiseEvent("FAFunctionNameUpdated",new tb(d.NameDataStrings,pc)):this.raiseEvent("FAParameterSelectionChangedOld",new Eb(pc,$a,I));Ic.className=vh.a.Rqh+(this.functionInfoManager.Fod(d)?"-udf":"")}catch(Sh){throw Fd.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",d.NameDataStrings,w,Sh),Sh;}ra.instance.lZ(["argumentAssistanceComputation"])}};eb.prototype.dispose=function(){this.Vm||(this.wc.IA(),eg.a.Fa(this.wc),Ne.g(this.$).view.Nq(this.it),
eg.a.Fa(this.H1a),this.H1a=null);this.Vm&&eg.a.Fa(this.kr);this.qba&&Ne.g(this.$).pc.Pn(this.Kg);this.functionInfoManager=this.$=null;ok.prototype.dispose.call(this)};eb.prototype.rEd=function(d){var w=new Mb;w.functionRenderingInfo=d;w.cardMode=this.O2;this.cId(w);return w};eb.prototype.cId=function(d){d.callbacks=new Dc;d.callbacks.onHelpLink=this.lfd(d.functionRenderingInfo);d.callbacks.onCardModeChange=this.onCardModeChange;d.callbacks.onFeedback=this.oRa;this.qba&&(d.callbacks.onDismissClick=
this.onDismissClick)};eb.prototype.qAj=function(d,w){var I=this;if(this.formulaAssistanceUIControl){ra.instance.D7(["argumentAssistanceRender"]);var ha={};ha.zoomLevel=P(this.$);this.formulaAssistanceUIControl.updateContext(ha);this.Oq=function(){I.formulaAssistanceUIControl.renderArgumentAssistanceCard(I.domElement,w,d)};this.Oq();this.wDd(d);this.lR&&this.cH.ja(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Oq,function(){return I.formulaAssistanceUIControl.dismiss(I.domElement)});
this.kr.canReceiveFocus=!0;ra.instance.lZ(["argumentAssistanceRender"]);ra.instance.B7b("argumentAssistanceOverall")}};eb.prototype.lfd=function(d){var w=this;return function(){Ba(w.$,d.helpID,d.isUDF)}};eb.prototype.NOd=function(){var d=Rj.a.get(Ca.a.r_b);this.O2=d?parseInt(d,10):eb.e6c;ra.instance.OYf(this.O2)};eb.prototype.wDd=function(d){var w=d.functionRenderingInfo.functionName;this.nla&&k.a.equals(this.nla,w,!0)?(w=ih.a.map(d.functionRenderingInfo.signatures,function(I){var ha="";0<=I.signatureParams.activeParam&&
I.signatureParams.activeParam<I.signatureParams.params.length&&(ha=I.signatureParams.params[I.signatureParams.activeParam]);return ha}),this.raiseEvent("FAParameterSelectionChanged",new Ya(w))):(this.nla=w,d=ih.a.map(d.functionRenderingInfo.signatures,function(I){return I.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new tb(w,d)))};eb.prototype.qNb=function(d){this.O2=d;try{Rj.a.pv(Ca.a.r_b,d.toString(),yk.AFrame.zea)}catch(w){Fd.ULS.sendTraceTag(537162070,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",
w.message)}};eb.dod=function(d){return k.a.contains(d,gb.p7b,!0)};eb.lli=function(d){return!!d&&k.a.T1a(d.NameDataStrings,"IFS")};eb.lKg=function(d,w,I,ha){try{if(!d||2>d.length)Fd.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",ha.NameDataStrings,d?d.length.toString():"currRowParamsArray == null",w,I);else{for(var wa=d.pop().toString(),$a=d.length-1;$a<I;$a++){var Tb=d[$a].trim();if(w){var Ic=
d[$a-1].trim();d.push(eb.nIh(Ic,Tb))}else{var pc=eb.gaf(Tb);d.push(eb.$We(pc))}}d.push(wa)}}catch(vd){throw Fd.ULS.shipAssertTag(537162068,0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",ha.NameDataStrings,d?d.length.toString():"currRowParamsArray == null",w,I,vd),vd;}};eb.nIh=function(d,w){d=eb.gaf(d);var I=eb.$1e(d);w=eb.$1e(w);return eb.$We(d,!0,!!I&&!!w&&I!==w)};eb.gaf=function(d){var w=d.match(eb.Oyd);
d=k.a.trimEnd(k.a.trimStart(d,gb.hGf),gb.gGf);if(w&&w.length){w=w[w.length-1];var I=Number.parseLocale(w)+1;d=d.replace(w,I.toString())}else d=String.format("{0}{1}",d,1);return d};eb.$We=function(d,w,I){var ha="[{0}]";(void 0===w?0:w)&&(ha=(void 0===I?0:I)?"[{0}":"{0}]");return String.format(ha,d)};eb.$1e=function(d){return(d=d.match(eb.Oyd))&&d.length?d[0]:null};eb.TJa=function(d){if(d)return document.createElement("div");d=String.format(gb.QGf,gb.OGf,gb.WCd,vh.a.tOe,gb.UEb,vh.a.sOe,gb.XCd);var w=
String.format(gb.QGf,gb.PGf,gb.WCd,vh.a.tOe,gb.UEb,vh.a.sOe,gb.XCd);d=String.format(gb.IGh,gb.JGh,vh.a.pPe,vh.a.Tmh,N.a.Xo,gb.tWe,d,w);w=document.createElement("div");w.innerHTML=d;return w.firstChild};eb.Oyd=RegExp("\\d+");eb.e6c=0;Object(Hd.a)(eb,"FormulaArgumentAssistanceControlDeprecated",tg.a,[808]);Object(Hd.a)(Cb,"ParseContext",null,[]);var Gk=b(315),Kk=Ek.a;vm(ob,Kk);ob.prototype.Rh=function(d,w){this.formulaAssistanceControl.Ya=this.Ya;-1470715894!==w&&-1231471547!==w||this.Q5a&&!this.oIe()||
(this.TV=!1);return Kk.prototype.Rh.call(this,d,w)};ob.prototype.pzd=function(){var d=this.yLa;if(d||this.iRd){this.formulaAssistanceControl.Ya=this.Ya;if(this.Q5a&&(ra.instance.Dob.formulaAssistanceRequestAttemptedCounter++,!this.oIe())){ra.instance.Dob.formulaAssistanceRequestOptimizedCounter++;return}if(!d&&this.iRd)this.formulaAssistanceControl.Gse();else if(ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.K9h){if(d=this.$.Vb.Hc("LoadingUIShown",
"FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.Ise(),d.stop(),this.xob.text.endsWith("[")&&"["!==this.xob.text.charAt(this.xob.text.length-2)){var w=""===this.VHa?this.formulaAssistanceControl.tableManager.Mg:Object(qc.a)(Gk.a,this.$.zb.getItemByName(this.VHa));Fd.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",
w.ij,d.Dc,this.old,this.TV)}}else this.formulaAssistanceControl.lob(),this.LFf&&(this.LFf=this.TV=!1)}else this.TV=!1};ob.prototype.fj=function(){this.Haj||(this.eSa=null,this.iRd&&this.formulaAssistanceControl.DZ())};ob.prototype.Kg=function(){this.TV=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.ytc();this.Vm&&this.rvi()};ob.prototype.LFd=function(d,w){return this.formulaAssistanceControl.Rh(d,w)};ob.prototype.rvi=function(){this.formulaAssistanceControl.PAa&&(ra.instance.KJa.smartSuggestionShownCounter++,
this.formulaAssistanceControl.PAa=!1);this.formulaAssistanceControl.wSa&&(ra.instance.KJa.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.wSa=!1);this.formulaAssistanceControl.qLb&&(ra.instance.KJa.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.qLb=!1)};ob.prototype.AVg=function(d,w){for(var I=0,ha;-1!==I;)if(I=d.indexOf("[",I+1),-1!==I&&I<w&&(ha=d.indexOf("]",I+1),-1===ha||ha>=w))return I;return-1};ob.prototype.oIe=function(){var d=this.Ya.text,w=this.Ya.textBox.caretPosition,
I=this.formulaAssistanceControl.jNa,ha=this.formulaAssistanceControl.iNa;if(this.TV&&k.a.equals(d,I,!0)&&w===ha)return!1;this.formulaAssistanceControl.jNa=d;this.formulaAssistanceControl.iNa=w;return!0};Sk.Object.defineProperties(ob.prototype,{tyb:{configurable:!0,enumerable:!0,get:function(){return Object(cf.a)(Ob,this.$.Ab.hh)}},TV:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(d){this.formulaAssistanceControl.isListVisible=d}},yLa:{configurable:!0,
enumerable:!0,get:function(){return this.Ya.yLa}},K9h:{configurable:!0,enumerable:!0,get:function(){var d=this.xob.text,w=!1;if(0>=d.length)return w;var I=this.$.Vb.Hc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),ha=Ne.g(this.$).ha.va.activeCell.clone(),wa=d.charCodeAt(0);this.VHa="";this.BQ=this.AVg(d,this.xob.caretPosition);wa=61===wa&&-1!==this.BQ;if(!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))wa&&(w=!0);else if(wa){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){wa=
0;for(var $a=this.BQ-1;1<=$a&&!(this.BQ-$a>ob.hqf);$a--)if(Array.contains(ob.Jue,d.charAt($a))){wa=$a;break}wa=d.substring(wa+1,this.BQ);d=""!==wa?this.$.zb.getItemByName(wa):null;$a=this.BQ;for(var Tb=this.BQ+1;Tb<=this.Ya.textBox.caretPosition;Tb++)if("["===this.Ya.text.charAt(Tb))$a=Tb;else break;this.BQ=$a}else{wa=d.lastIndexOf("[");$a=0;for(Tb=wa-1;1<=Tb&&!(wa-Tb>ob.hqf);Tb--)if(Array.contains(ob.Jue,d.charAt(Tb))){$a=Tb;break}wa=d.substring($a+1,wa);d=""!==wa?this.$.zb.getItemByName(wa):null}d&&
2===d.type?(w=!0,this.VHa=wa):Ne.g(this.$).Rb.Xj(ha)&&(w=!0,this.VHa="")}I.stop();this.old=I.Dc;Fd.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",this.old);return w}},key:{configurable:!0,enumerable:!0,get:function(){return dk.a.c3a}},calcManager:{configurable:!0,enumerable:!0,get:function(){this.OFc||(this.OFc=this.$.da.Aa(266,!1));return this.OFc}},iRd:{configurable:!0,
enumerable:!0,get:function(){if(null!=this.eSa)return this.eSa;if(!ye.EwaSettings.la(136))return this.eSa=!1;var d=Ne.g(this.$).ha.va.activeCell.clone();if(1!==d.Qpf||!d.left||Ne.g(this.$).ha.va.Lgc())return!1;var w=this.formulaAssistanceControl.tableManager.En(d);if(w)return this.eSa=!1;--d.left;--d.right;if(!d.isValidRange)return!1;w=this.formulaAssistanceControl.tableManager.En(d);return this.eSa=!!w&&d.top===w.top&&this.formulaAssistanceControl.tableManager.W3g(w,Ne.g(this.$))}}});ob.Jue=" !%&'()*+,-/:;<=>@[]^{|}~".split("");
ob.hqf=255;Object(Hd.a)(ob,"FormulaAutoCompleteListAutoCompleteBehavior",Ek.a,[]);var pk;(function(d){d[d.function=0]="function";d[d.field=1]="field";d[d.definedName=2]="definedName";d[d.letVariable=3]="letVariable";d[d.tableColHeaderName=4]="tableColHeaderName";d[d.tableSpecialStructRef=5]="tableSpecialStructRef";d[d.pendingData=6]="pendingData";d[d.tableNamedObject=7]="tableNamedObject"})(pk||(pk={}));Object(Hd.b)("ItemType",pk);var uk=b(1189),fl=b(1188);Ta.prototype.execute=function(d){Array.add(d,
this.index)};Object(Hd.a)(Ta,"AppendIndexOperation",null,[830]);Ka.prototype.execute=function(){};Object(Hd.a)(Ka,"NopIndexOperation",null,[830]);ma.prototype.execute=function(d){for(var w=0;w<d.length;w++)d[w]===this.A1i&&(d[w]=this.qsf)};Object(Hd.a)(ma,"ReplaceIndexOperation",null,[830]);hc.prototype.NEe=function(d,w){var I=new Ta(w);if(!yg.a.Cod())return I;d=this.Vpi(d,w);return null!=d?this.items[d].Izb?new ma(d,w):new Ka:I};hc.prototype.Vpi=function(d,w){var I=this,ha=this.items[w];Fd.ULS.shipAssertTag(537162075,
0,!!ha,"Internal error: invalid item index");d=E.where(E.asEnumerable(d),function(wa){return I.items[wa].name===ha.name});return E.Ct(d)?E.first(d):null};Object(Hd.a)(hc,"FilterItemOperationFactory",null,[]);Object(Hd.a)(jb,"CompletionItem",null,[]);var gl="<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='"+N.a.Xo+"'>{3}</td>\r\n\t<td id='item_type_cell' class='"+N.a.Xo+"'>{5}</td>\r\n</tr>",L="<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+
N.a.Xo+"'></td>\r\n\t<td id='item_type_cell' class='"+N.a.Xo+"'>{2}</td>\r\n</tr>",oa="<td>\r\n\t<div class='"+N.a.gr+"'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",Wa="<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='"+N.a.Xo+"'>{5}</td>\r\n\t<td id='item_type_cell' class='"+N.a.Xo+"'>{2}</td>\r\n</tr>",Rb=uk.a;vm(Ja,Rb);Ja.prototype.Hoe=function(d){this.addHandler("FLBSelectedRowChanged",d)};Ja.prototype.pRf=
function(d){this.removeHandler("FLBSelectedRowChanged",d)};Ja.prototype.kVc=function(d){this.addHandler("ACLBUpdated",d)};Ja.prototype.uJd=function(d){this.removeHandler("ACLBUpdated",d)};Ja.prototype.dispose=function(){Rb.prototype.dispose.call(this);this.ora=this.uWe=this.eub=null};Ja.prototype.fzc=function(d,w,I,ha){ha=void 0===ha?0:ha;this.fgf||this.J7(!1);var wa="";I&&(wa+=String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>","list_column_header",vh.a.n_g,
I));wa+=String.format("<table class='{0}' aria-live='off'><tbody>",this.Wba);for(var $a=new W.a,Tb=0,Ic=this.DW.length;Tb<Ic;Tb++)wa+=this.i4e(d[this.DW[Tb]],Tb+1,w,ha),this.Vm&&$a.add(this.$Ye(d[this.DW[Tb]]));Tb=this.DW.length;Ic=0;for(var pc=this.cs.length;Ic<pc;Ic++)Array.contains(this.DW,this.cs[Ic])||(Tb++,wa+=this.i4e(d[this.cs[Ic]],Tb,w,ha),this.Vm&&$a.add(this.$Ye(d[this.cs[Ic]])));this.gg.innerHTML=wa+"</tbody></table>";this.Jn=Rc.DOMElementExtensions.Bj(this.domElement,this.Wba);this.Vm&&
(this.k2c=$a.toArray());this.fgf?(this.isListVisible=!0,this.oGa.set_visible(!0)):(this.J7(!0),this.nIg(!!I))};Ja.prototype.sJa=function(d,w,I,ha,wa,$a){ha=void 0===ha?"":ha;wa=void 0===wa?0:wa;$a=void 0===$a?!1:$a;if(d){var Tb=[],Ic=[];this.pLb=0;var pc=new hc(this.$,d);if(w){var vd=!!w&&0<wa,ne=vd&&91===w.charCodeAt(wa+1)?wa+2:wa+1;$a=vd?w.length===ne:!1;vd&&w.length===wa&&ye.EwaSettings.la(136)&&($a=!0);var Pe=null;!$a&&vd&&w.length>wa+1&&(Pe=w.substring(ne,w.length));if(w)for(vd=0,ne=d.length;vd<
ne;vd++){var Af=d[vd].name;if(!d[vd].ahi){var Wf=pc.NEe(Tb,vd);d[vd].Izb&&this.pLb++;if(!Pe&&!$a||0===d[vd].itemType)Ic=this.PTe(w,Af,I,Wf,Tb,Ic),Tb=Ic.oaf,Ic=Ic.VIf;Pe&&1===d[vd].itemType&&(Ic=this.PTe(Pe,Af,!0,Wf,Tb,Ic),Tb=Ic.oaf,Ic=Ic.VIf);$a&&1===d[vd].itemType&&Wf.execute(Tb)}}}else for(I=0;I<d.length;++I)if(d[I].Izb||$a)Pe=pc.NEe(Tb,I),Pe.execute(Tb),Pe.execute(Ic),d[I].Izb&&this.pLb++;this.DW=Ic;this.cs=Tb;this.fzc(d,w,ha,wa)}};Ja.prototype.kTj=function(d){if(d&&!(1<d.length)){var w=[],I=[];
w.push(0);I.push(0);this.DW=w;this.cs=I;this.fzc(d,"","",0)}};Ja.prototype.bya=function(){this.Mk&&Rb.prototype.bya.call(this)};Ja.prototype.R4i=function(d,w){this.raiseEvent("ACLBUpdated",new fl.a(d,void 0,void 0,w))};Ja.prototype.zeg=function(d){var w=this.Jn.rows[d];return(!this.Mk||this.Mk!==w)&&d<this.Jn.rows.length?(this.Mk=w,!0):!1};Ja.prototype.onc=function(d){jh.g(d.Ea);0===this.Iw||2===this.Iw||3===this.Iw||4===this.Iw||5===this.Iw||7===this.Iw?(this.raiseEvent(hk.a.v4a),this.bya()):1===
this.Iw?this.oGa.My(!1):(this.oGa.My(!1),d=Ne.g(this.$),d.Rq(!1),d.focus());return!0};Ja.prototype.nIg=function(d){this.Rra();if(d){var w=this.Jn.offsetWidth+(this.cs.length>this.bI?Ti.a.gq:0);d=$get("list_column_header");d.offsetWidth>w&&Rc.DOMElementExtensions.Uq(this.gg,d.offsetWidth);w=this.gg.getElementsByClassName(this.p_);for(var I=0;I<w.length;I++)w[I].style.width=qb.HelperMethods.Qb(d.offsetWidth)}};Ja.prototype.i4e=function(d,w,I,ha){if(1===d.itemType){var wa=Ng.a.Lf(d.name),$a=Ng.a.Lf(ha?
I.substring(ha+1,I.length):I),Tb=0;wa.substring(0,$a.length).toLowerCase()!==$a.toLowerCase()&&(Tb=Ja.mGj(wa,gb.lhg,$a));I="";I=0<=Tb?I+(wa.substring(0,Tb)+"<b>"+wa.substring(Tb,Tb+$a.length)+"</b>"+wa.substring(Tb+$a.length,wa.length)):I+wa;ha=ha?String.format(oa,N.a.UPe,Ng.a.HV(Eg.a.Ee(0)),te.a.instance.fa(699)):"";return String.format(L,ha,w,pk[d.itemType],this.p_,I)}if(5===d.itemType)return String.format(Wa,"",w,pk[d.itemType],this.p_,Ng.a.Lf(d.name),Ng.a.Lf(d.qja));if(4===d.itemType)return String.format(Wa,
"(...)",w,pk[d.itemType],this.p_,Ng.a.Lf(d.name));if(6===d.itemType)return ha=ha?String.format(oa,N.a.UPe,Ng.a.HV(Eg.a.Ee(0)),te.a.instance.fa(699)):"",String.format(gl,ha,this.p_,Ng.a.Lf(d.name),Ng.a.Lf(d.qja),w,pk[d.itemType]);ha=String.format(oa,2===d.itemType||3===d.itemType?N.a.Ruh:N.a.Puh,Ng.a.HV(Eg.a.Ee(0)),te.a.instance.fa(696));return String.format(gl,ha,this.p_,Ng.a.Lf(d.name),Ng.a.Lf(d.qja),w,pk[d.itemType])};Ja.prototype.$Ye=function(d){var w=new jb;w.label=d.label;w.textEdit=d.textEdit;
w.kind=Ja.XMh(d.itemType);w.type=d.Izb?1:0;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===w.kind){var I=this.formulaAssistanceControl.hRh(d.label);w.detail=I?I:d.qja}else w.detail=d.qja;return w};Ja.prototype.PTe=function(d,w,I,ha,wa,$a){k.a.equals(w,"Pretend this is the line.",!1)&&0<wa.length||k.a.yL(w,d)?(ha.execute(wa),ha.execute($a)):I&&d.length>=gb.Z3g&&Ja.Bdh(w,gb.lhg,d)?ha.execute(wa):!I&&d.length>=gb.Y3g&&k.a.contains(w,d,!0)&&ha.execute(wa);return{oaf:wa,
VIf:$a}};Ja.XMh=function(d){switch(d){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}};Ja.Bdh=function(d,w,I){w=yl(w);for(var ha=w.next();!ha.done;ha=w.next())if(ha=d.split(ha.value),!(2>ha.length)){ha=yl(ha);for(var wa=ha.next();!wa.done;wa=ha.next())if(k.a.yL(wa.value,I))return!0}return!1};Ja.mGj=function(d,w,I){w=yl(w);for(var ha=w.next();!ha.done;ha=w.next())if(ha=d.toLowerCase().indexOf((ha.value+
I).toLowerCase()),0<ha)return ha+1;return-1};Sk.Object.defineProperties(Ja.prototype,{Qhc:{configurable:!0,enumerable:!0,get:function(){return 0<this.pLb&&this.pLb===this.cs.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(hj.a)(Ja.prototype,this,"isListVisible")},set:function(d){Object(hj.b)(Ja.prototype,this,"isListVisible",d);d||(this.Uuc=0,this.qe=null);0===this.Uuc?Rc.DOMElementExtensions.setVisible(this.eub,d&&!this.Vm):Rc.DOMElementExtensions.setVisible(this.eub,
!1)}},Mk:{configurable:!0,enumerable:!0,get:function(){return this.ora},set:function(d){this.oBa(this.Mk);if(d){this.uWe.innerText="";this.ora=d;var w=this.oBa(this.Mk),I=d.rowIndex+1,ha=$get("description_cell"+I,d);this.eub.innerText=ha.innerText;var wa=$get("item_type_cell",d);this.qe=w=w.innerText;this.Uuc="field"===wa.innerText?1:"definedName"===wa.innerText?2:"letVariable"===wa.innerText?3:"tableColHeaderName"===wa.innerText?4:"tableSpecialStructRef"===wa.innerText?5:"pendingData"===wa.innerText?
6:"tableNamedObject"===wa.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new fl.a(this.cs.length,I,w,ha.innerText));this.Cuc(d)}}},jTa:{configurable:!0,enumerable:!0,get:function(){return this.eub}},oGa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},Iw:{configurable:!0,enumerable:!0,get:function(){return this.Uuc}}});Object(Hd.a)(Ja,"FormulaAutoCompleteListBox",uk.a,[807]);Sk.Object.defineProperties(db.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
toolTip:{configurable:!0,enumerable:!0,get:function(){return this.y9}}});Object(Hd.a)(db,"LETVariableInfo",null,[]);Sk.Object.defineProperties(Na.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Hd.a)(Na,"TableColHeaderNameInfo",null,[]);Sk.Object.defineProperties(Xa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(Hd.a)(Xa,"TableNamedObjectInfo",null,[]);Sk.Object.defineProperties(Ha.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.y9}}});Object(Hd.a)(Ha,"TableSpecialStructRefInfo",null,[]);var xc=b(185),id=b(176);Object(Hd.a)(Pa,"FormulaAutoCompleteCallbacks",null,[]);Object(Hd.a)(pa,"FormulaAutoCompleteRenderingInfo",null,[]);Object(Hd.a)(qa,"CellMessage",null,[]);Object(Hd.a)(ea,"FunctionSuggestionRequest",null,[]);Object(Hd.a)(ja,"RunExperimentRequest",null,[]);var rd=Ai.a;vm(ca,rd);ca.prototype.Pne=function(d){this.addHandler(ca.tcd,
d)};ca.prototype.QQf=function(d){this.removeHandler(ca.tcd,d)};ca.prototype.Nne=function(d){this.addHandler(ca.Nbd,d)};ca.prototype.OQf=function(d){this.removeHandler(ca.Nbd,d)};ca.prototype.One=function(d){this.addHandler("FormulaAutoCompleteShown",d)};ca.prototype.PQf=function(d){this.removeHandler("FormulaAutoCompleteShown",d)};ca.prototype.set_visible=function(d){this.mja.set_visible(d);this.Vm&&!d&&this.w1a();Sys.UI.Control.prototype.set_visible.call(this,d);return d};ca.prototype.HUg=function(d,
w){this.isListVisible&&(d+=gb.openParen,w++,this.aDd(d,w));var I=0<w&&d.charAt(w-1)===gb.openParen,ha=w===d.length||d.charAt(w)===gb.closeParen;if(!I||!ha)return Fd.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",w,!d.length,!!this.AQ),!1;I=d.substring(0,w).lastIndexOf(this.$.listSeparator);ha=d.substring(0,w-1).lastIndexOf(gb.openParen);d=d.substring(-1===I&&-1===ha?1:Math.max(I,
ha)+1,w-1).trim();return this.functionInfoManager.cfd(d)?!0:(Fd.ULS.sendTraceTag(537162052,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.AQ),!1)};ca.prototype.bdi=function(d,w){var I=this.HUg(d,w);if(!I||!this.AQ)return Fd.ULS.shipAssertTag(537162051,0,!I||I&&!!this.AQ,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,msf:0,JUe:0};I=this.AQ.Params;I=
I.replace(RegExp("[\\[\\]]","g"),"");var ha=d.charAt(w-1)===gb.openParen,wa=ha?"":"(",$a=w===d.length?")":"";var Tb=this.$.listSeparator;Tb=I.includes(Tb)?I.indexOf(Tb):I.length;return{returnValue:d.substring(0,w)+wa+I+$a+d.substring(w,d.length),msf:ha?w:w+1,JUe:Tb}};ca.prototype.it=function(d,w){this.Vm&&void 0!==this.Oq&&null!==this.Oq&&this.Oq();this.Vm||rd.prototype.it.call(this,d,w)};ca.prototype.dispose=function(){if(this.$){this.NSa(!1);var d=Ne.g(this.$);d&&(d.ha&&(this.Vm?d.ha.WF(this.nd):
d.ha.qda(this.nd),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")&&d.ha.Lza(this.gzd)),d.view.Nq(this.fnc));this.Vm&&this.$.xa&&this.$.xa.ug(this.ii)}this.functionInfoManager&&(this.functionInfoManager.kHb(this.onFunctionInfoLoaded),this.functionInfoManager.wcj(this.yyf));this.nh&&this.nh.Csc(this.wya);this.Vm&&this.Kf&&this.Kf.pRf(this.pDf);yg.a.nfc&&this.Ya&&this.Ya.dHb(this.p6);this.V7f(!1);eg.a.Fa(this.Kf);eg.a.Fa(this.D_b);eg.a.Fa(this.mja);this.Dka&&eg.a.Fa(this.kr);
this.Ya=this.functionInfoManager=this.nh=null;eg.a.rc(this.HJa);this.Mg=this.p8=this.mja=this.HJa=null;rd.prototype.dispose.call(this)};ca.prototype.Pwa=function(){return!this.Nv};ca.prototype.$ji=function(){return!this.pGa};ca.prototype.Rh=function(d,w){if(!this.Pwa()){if(this.Vm&&this.lN){if(125627505===w||267796030===w)return this.rba&&this.dBc(w),this.kBe(),!1;if(1872288872===w)return this.kda(),this.isListVisible=!1,!0;if(this.Kf.Qhc&&(-798660877===w||137938150===w))return!1}if(1!==this.Kf.Iw||
125627505!==w&&267796030!==w)if(6===this.Kf.Iw){var I=d.keyCode;13!==I&&9!==I||this.My(!1)}else{if(4===this.Kf.Iw||5===this.Kf.Iw)return rd.prototype.Rh.call(this,d,w,!0);1===this.Kf.DW.length&&(I=d.keyCode,this.$we=8===I||127===I||46===I?!0:!1)}else{if(this.My(!1)&&!this.qka)return Ne.g(this.$).ha.Rh(d,w);if(125627505===w&&this.qka)return!0}}return rd.prototype.Rh.call(this,d,w)};ca.prototype.ytc=function(){this.nh.zbb();this.p8=null;null==this.Zia||this.Zia||this.Ljc("NoFieldChosen",1,2,1);this.Zia=
null;this.S3=0;this.G5=this.Prd=this.ppc=null};ca.prototype.lob=function(){var d=this,w=!!this.Ya&&!ef.f(this.$.pa);if((this.OAa||this.fyc)&&w){var I=this.Ya.text;this.pluginScheduler.requester().functionSuggestion(Object.assign(new ea,{content:I})).then(function(ha){0===ha.kind&&(Fd.ULS.shipAssertTag(537162050,0,!!ha&&!!ha.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),ha=E.toArray(E.select(E.asEnumerable(ha.payload.items),function(wa){return ca.T2g(wa)})),
d.fyc&&"="===I&&0<ha.length&&d.gridView.K1a.ssj("="+ha[0].textEdit.newText),d.OAa&&(d.vSa=ha,zg.AFrameworkApplication.Ig||d.Hse(w,!0)));return null})}this.OAa&&w||this.Hse(w,!1)};ca.prototype.g4e=function(){if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var d=Ne.g(this.$).Dj?this.Ztb.BQ:this.Fpb.BQ;"@"===this.Ya.text.charAt(d+1)&&this.Ya.textBox.caretPosition>d+1?this.Sdb=d+2:this.Sdb=d+1}else{d=this.Ya.text.lastIndexOf(gb.jlf);var w=this.Ya.text.lastIndexOf("[");
this.Sdb=d+1>=w?d+2:w+1}return this.Ya.text.substring(this.Sdb,this.Ya.textBox.caretPosition)};ca.prototype.Ise=function(){this.Y4f()&&(this.B$g(),this.Nv&&(this.Zia=!1,this.ZV=this.g4e(),this.Kf.sJa(this.Nv,this.ZV,!0,void 0,void 0,!0),this.show(),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.mja.Wrb()))};ca.prototype.Gse=function(){this.Y4f()&&(this.D_b&&this.D_b.cancel(),this.nh.Eyb?(this.Pwa()&&this.DDe(!0),this.get_visible()?this.LTe():
this.X1d=xc.AsyncMethodContext.Zy(this.LTe,gb.Xch,Ei.a.FFh,this.D_b)):this.DZ())};ca.prototype.Y4f=function(){return this.Ya?0<this.$.Ab.$N||!this.Ya.text||!this.Ya.isEditing?(this.set_visible(!1),!1):ef.f(this.$.pa)?!1:!0:!1};ca.prototype.l0a=function(d){this.Ya&&this.isListVisible&&(this.tmd(this.Ya.text,d),this.Ya.textBox.caretPosition=d.range.start.character+d.newText.length,this.set_visible(!1))};ca.prototype.My=function(){var d;if(!this.Ya||!this.isListVisible)return!1;var w="",I=0,ha=Ne.g(this.$),
wa=this.Ya.text,$a=0,Tb=this.Kf.qe,Ic=!1;if(0===this.Kf.Iw||2===this.Kf.Iw||3===this.Kf.Iw||7===this.Kf.Iw)w+=wa.substr(0,this.d3a)+this.Kf.qe,0!==this.Kf.Iw||this.Kf.qe.endsWith(")")||(w+="("),I=w.toString().length,w+=wa.substr(this.v$b),2===this.Kf.Iw&&($a=4,Tb="DefinedName",Ic=!0,this.set_visible(!1));else if(1===this.Kf.Iw)if(this.Zia=!0,this.qka){w+=wa.substr(0,this.S3+2);!w.toString().endsWith(va.a.TU)&&ye.EwaSettings.la(136)&&(w+=va.a.TU);$a=this.Kf.qe;$a=$a.replace("'","''");$a=$a.replace("[",
"'[");$a=$a.replace("]","']");if(this.p6c||this.aBh($a))$a=va.a.ssi+$a+va.a.Jjj,Ic=!0;w+=$a;I=w.length;$a=3;id.a("PulloutFieldAccepted")}else return this.Ya.text=this.Kf.qe,this.set_visible(!1),ha.Rq(!1),ha.focus(),this.Ljc("FieldName",1,1,1),id.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===this.Kf.Iw)Fd.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),w+=wa.substr(0,this.Sdb),k.a.equals(this.Kf.qe,"@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString,
!1)?w+="@":(w+=this.Kf.qe,Ic=!0,this.set_visible(!1)),I=w.length;else if(4===this.Kf.Iw){Fd.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");w+=wa.substr(0,this.Sdb);Ic="";I=!1;for(var pc=[39,91,93,64,35],vd=0;vd<this.Kf.qe.length;vd++){var ne=this.Kf.qe.charCodeAt(vd);Array.contains(pc,ne)&&(Ic+="'");Ic+=this.Kf.qe.charAt(vd).toString();I||k.a.isNumeral(ne)||k.a.Bff(ne)||(I=!0)}pc=Ne.g(this.$).Dj?this.Ztb.BQ:this.Fpb.BQ;wa=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?
"@"===wa.charAt(pc+1)&&I:wa.lastIndexOf(gb.jlf)+1>=wa.lastIndexOf("[")&&I;w+=wa?"["+Ic+"]":Ic;Ic=!0;this.set_visible(!1);I=w.toString().length}else if(6===this.Kf.Iw)w+=wa.substr(0,this.hsb);else return Fd.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;this.Ya.text=w;this.Ya.textBox.caretPosition=I;this.Ya.TMa()&&(null===(d=ha.Jt)||void 0===d?0:d.Qua)&&ha.Jt.cJb(this.Ya.text,this.Ya.textBox.caretPosition,this.Ya.textBox.caretPosition,this.Ya.textBox.lv.length);
ha.Dj&&(d=ha.yc,d.text=this.Ya.text,d.setCaretPosition(this.Ya.textBox.caretPosition));Tb=(null==this.Zia?0:this.Zia)?"FieldName":Tb;this.Kf.Mk.sectionRowIndex>=this.Kf.DW.length?this.Ljc(Tb,4,$a,0):this.Ljc(Tb,1,$a,0);Ic||(5===this.Kf.Iw||4===this.Kf.Iw?this.Ise():this.lob());return!0};ca.prototype.DZ=function(d,w){d=void 0===d?null:d;w=void 0===w?null:w;d?(this.nh.zbb(),this.nh.DZ(d,!1,!1,w)):(d=Ne.g(this.$),d.ha.va.qh&&(d=td.v(d.ha.va.Sd,this.$),this.nh.DZ(d,!0,!0,w)))};ca.prototype.kda=function(){this.Ofa=
!1;this.Ya.SIe()};ca.prototype.hRh=function(d){d=this.calcManager.getWorksheetFuncId(d);return this.yWe?this.yWe.descriptionsMap.get(d):null};ca.prototype.DDe=function(d){if(this.$ji()){if(this.nh.Eyb&&this.nh.Ek&&(!this.nh.Ek.length||!this.nh.Ek[0].FieldInfoDataList))return;this.nRj(d)}d=E.asEnumerable(this.pGa);d=E.concat(d,this.gTh(this.Ya.text));ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&this.Vm&&(d=E.concat(d,this.qUh()));E.OBc(d,function(w){return w.name},
new pg);this.OAa&&(d=E.concat(E.asEnumerable(this.vSa),d),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.vSa.length&&(this.PAa=!0),this.vSa=[]));this.p8=E.toArray(d)};ca.prototype.B$g=function(){var d=this.Ya.text;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var w=Ne.g(this.$).Dj?this.Ztb.VHa:this.Fpb.VHa,I=!0;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==w&&
(this.Mg=Object(qc.a)(Gk.a,this.$.zb.getItemByName(w))),this.Mg||(this.Mg=this.tableManager.Mg,I=!1),!this.Mg){Fd.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d",this.$.zb.count,""===w);return}}else this.Mg=Object(qc.a)(Gk.a,this.$.zb.getItemByName(w)),this.Mg||(this.Mg=this.tableManager.Mg,I=!1);this.Mg.QO&&this.Mg.QO.IsFullTableHeaders?this.tIf(I):
Og.d(this.Mg)?(Fd.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",this.Mg.ij),jg.I(this.$.na.ta,this.Mg.ij,this.uNi,this.tNi,null,null)):Fd.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",this.Mg.ij)}else if(this.calcManager&&this.tableManager.Mg)if(w=this.calcManager.Wvb(this.tableManager.Mg))if(this.calcManager.aJg(this.tableManager.Mg,
w)){d=E.empty();if(91===this.Ya.text.charCodeAt(this.Ya.text.length-1)){var ha=this.J0a("@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString);d=E.concat(d,(I=new W.a,I.add(ha),I))}d=E.concat(d,E.select(E.asEnumerable(w.toArray()),function(wa){var $a=new mb,Tb=new Na;Tb._name=wa.toString();$a.G0f(Tb);return $a}));this.p8=E.toArray(d)}else d.endsWith("[")&&"["!==d.charAt(d.length-2)&&Fd.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",
w.count,this.tableManager.Mg.ij,this.tableManager.Mg.usedRange.right-this.tableManager.Mg.usedRange.left+1);else d.endsWith("[")&&"["!==d.charAt(d.length-2)&&Fd.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};ca.prototype.aBh=function(d){if(!d)return!1;var w=d.charCodeAt(0);if(46===w||48<=w&&57>=w||63===w)return!0;for(var I=0;I<d.length;I++,
w=d.charCodeAt(I))if(!((ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?k.a.isLetter(w):k.a.fpd(w))||92===w||95===w||63===w||48<=w&&57>=w))return!0;return!1};ca.prototype.aDd=function(d,w){var I=!1,ha=!1,wa=!1,$a=0,Tb=0;this.d3a=0;this.v$b=w;this.V4b=1;for(var Ic=w-1;0<=Ic;--Ic)switch(d.charCodeAt(Ic)){case 39:ha=!ha;break;case 34:I=!I;break;case 91:++$a;wa=$a>Tb;break;case 93:++Tb}wa=Object.assign(new Cb,{Qsa:!I,Rsa:!ha,Zha:!wa,VEb:1});
$a=this.cYi(d,w,wa);w=this.dYi(d,w,wa.Qsa,wa.Rsa,wa.Zha);this.V4b=$a+w;if(this.sQc=$a-1)this.cxc=!1;this.PBh(d,I,ha,wa.DCd,wa.ECd)};ca.prototype.emd=function(){ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")?Ne.g(this.$).ha.Ora(this.gzd):Ne.g(this.$).ha.JG(this.gzd);this.CCb();yg.a.nfc&&Ne.g(this.$).yj.FYa(this.p6);ca.mMd(this.pluginScheduler);this.OAa&&this.dXg()};ca.prototype.nAh=function(){return this.OAa||this.TSe};ca.prototype.eYi=function(){var d=this.G5;if(!this.Eyj||
!d)return this.S3=0,this.pGa=this.p8=null,!1;d=d.endsWith(va.a.TU);var w;if(w=ye.EwaSettings.la(136)){w=this.NOj(this.G5.substring(0,this.T3));var I=w.sheetRange;w=w.returnValue}return w&&(w=this.G5.substring(0,this.S3),d&&w!==this.Prd)?(this.Prd=w,this.S3=this.G5.length-(d?1:0),this.DZ(I,this.G5),this.Zia=!1,Fd.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0):!1};ca.prototype.gTh=function(d){var w=new W.a;this.calcManager&&ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&
Fd.ULS.shipAssertTag(537162014,0,!!this.calcManager.dta(Bi.Range.kd(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.TSe&&(d=this.calcManager.extractLetVariables(d,this.Ya.textBox.caretPosition))){d=yl(d);for(var I=d.next();!I.done;I=d.next()){var ha=I.value;I=new db;I._name=ha;I.y9=te.a.instance.fa(2152);ha=new mb;ha.psj(I);w.add(ha)}}return w};ca.prototype.qUh=function(){for(var d=new W.a,w=this.$.zb.items,I=0,ha=w.length;I<ha;I++){var wa=
w[I];if(ef.o(wa)){var $a=new Xa;$a._name=wa.name;wa=new mb;wa.Iuj($a);d.add(wa)}}return d};ca.prototype.J0a=function(d){var w=new mb,I=new Ha;I._name=d;w.Juj(I);return w};ca.prototype.tIf=function(d){var w=new W.a,I=this.Ya.text.charCodeAt(this.Ya.text.length-1),ha=this.Ya.textBox.caretPosition-1;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.Ya.text.charCodeAt(ha):91===I){var wa=this.J0a("@ - "+this.instantaneousSupportInformationManager.Je.ThisRowStructRefString);
w.add(wa)}wa=yl(this.Mg.QO.HeadersList);for(var $a=wa.next();!$a.done;$a=wa.next()){$a=$a.value;var Tb=new mb,Ic=new Na;Ic._name=$a.Name;Tb.G0f(Ic);w.add(Tb)}wa=Ne.g(this.$).Dj?this.Ztb.BQ:this.Fpb.BQ;$a=this.Ya.text.charCodeAt(wa+1);(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!d||ha!==wa&&35!==$a:!d||91!==I&&35!==I)||(d=this.J0a("#"+this.instantaneousSupportInformationManager.Je.AllStructRefString),w.add(d),d=this.J0a("#"+this.instantaneousSupportInformationManager.Je.DataStructRefString),
w.add(d),d=this.J0a("#"+this.instantaneousSupportInformationManager.Je.HeadersStructRefString),w.add(d),d=this.J0a("#"+this.instantaneousSupportInformationManager.Je.TotalsStructRefString),w.add(d));w&&(this.p8=w.toArray())};ca.prototype.nRj=function(d){var w=E.empty();!d&&this.functionInfoManager.l5&&(w=E.concat(w,E.select(E.asEnumerable(this.functionInfoManager.Hcd),function(I){var ha=new mb;ha.i_f(I);return ha})),d=this.F5b.tHe,0<d.length&&(w=E.OBc(E.concat(w,E.select(E.asEnumerable(d),function(I){var ha=
new mb;ha.Pqj(I);return ha})),function(I){return I.name},new pg)));if(this.nh.Eyb&&this.nh.Ek){if(!this.nh.Ek.length||!this.nh.Ek[0].FieldInfoDataList)return;w=E.OBc(E.concat(w,E.select(E.asEnumerable(this.nh.Ek[0].FieldInfoDataList),function(I){var ha=new mb;ha.orj(I);return ha})),function(I){return I.name},new pg);this.columnName=this.nh.Ek[0].ColumnName}this.pGa=E.toArray(w)};ca.prototype.CCb=function(){var d=Ne.g(this.$).ha.va.activeCell;if(d){var w=this.calcManager.dta(d);if(w){var I=this.$.xa,
ha=w.sheet.index;0>=I.count||0>ha||ha>=I.count||(ha=I=null,this.pyd&&void 0!==this.calcManager&&null!==this.calcManager&&(d=Ne.g(this.$).Ca.es(d))&&(d=this.calcManager.Yfd(d.Em),void 0!==d&&null!==d&&(I=d.FormatString,ha=d.Builtin)),this.pluginScheduler.notifier().setActiveCell(Object.assign(new qa,{colIndex:w.range.col,rowIndex:w.range.row,sheetIndex:this.$.xa.getItem(w.sheet.index).sheetId,docName:w.sheet.document.name,docPath:w.sheet.document.path,formatString:I,builtIn:ha})))}}};ca.prototype.dXg=
function(){Ne.g(this.$).Dj?this.Ztb.tU(!1):this.Fpb.tU(!1)};ca.prototype.Vif=function(d){var w=ye.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?k.a.isLetter(d):k.a.fpd(d);return 48<=d&&57>=d||46===d||95===d||w};ca.prototype.show=function(){if(this.Nv){var d=this.Kf.zeg(0);this.Vm?0<this.Kf.cs.length?d||this.K4f():this.w1a():((d=0<this.Kf.cs.length)&&ra.instance.D7(["autoCompleteRender"]),!this.isListVisible&&this.columnName&&d&&this.Kf.R4i(this.Kf.cs.length,
this.columnName),this.isListVisible=d,this.mja.show(this.AQ),this.DBa(!0),this.Kf.bya(),d&&ra.instance.lZ(["autoCompleteRender"]))}};ca.prototype.dYi=function(d,w,I,ha,wa){for(I=Object.assign(new Cb,{YFf:41,fAe:40,Qsa:I,Rsa:ha,Zha:wa});w<d.length&&!this.UGf(d,w,I);++w);return I.VEb};ca.prototype.cYi=function(d,w,I){for(--w;0<=w&&!this.UGf(d,w,I);--w);return I.VEb};ca.prototype.UGf=function(d,w,I){var ha=d.charCodeAt(w);0>=this.T3&&(this.T3=d.substring(0,w).lastIndexOf(va.a.TU));46===ha&&(w<this.T3?
this.T3=w:w>this.hsb&&(this.S3=this.hsb=w));if(!this.Vif(ha)&&!ca.opi(ha)&&(!this.qka||w<=this.T3||!ca.m9h(ha,I))){I.Lwf&&(I.Lwf=!1,this.d3a=w+1);if(I.iBd){I.ECd=w+1;if(this.functionInfoManager.cfd(d.substring(I.ECd,I.DCd)))return!0;I.iBd=!1}switch(ha){case 39:I.Rsa=!I.Rsa;break;case 34:I.Qsa=!I.Qsa;break;case 91:I.Zha=!1;break;case 93:I.Zha=!0}ha===this.$.listSeparator.toString().charCodeAt(0)&&I.Rsa&&I.Qsa&&!I.V_a&&(!this.qka||I.Zha)&&(w<I.aNd||-1===I.aNd)&&(I.VEb+=1,this.V4b++);ha===I.fAe&&I.Qsa&&
I.Rsa&&(!this.qka||I.Zha)?I.V_a+=1:ha===I.YFf&&I.Qsa&&I.Rsa&&(!this.qka||I.Zha)?0<I.V_a?--I.V_a:(I.aNd=I.IUe,I.IUe=w,0<w&&this.Vif(d.charCodeAt(w-1))&&(I.iBd=!0,I.DCd=w)):this.qka&&46===ha&&w>this.T3&&(w<this.T3?this.T3=w:w>this.hsb&&(this.S3=this.hsb=w))}return!1};ca.prototype.PBh=function(d,w,I,ha,wa){this.v$b>this.d3a&&0<=this.d3a?w||I||(this.ZV=d.substring(this.d3a,this.v$b)):this.ZV=null;ha!==wa?(d=d.substring(wa,ha),this.AQ&&k.a.equals(this.AQ.NameDataStrings,d,!0)||(this.cxc=!0),this.AQ=this.functionInfoManager.cfd(d)):
(this.cxc=!1,this.AQ=null)};ca.prototype.V7f=function(d){var w=$get(gb.OGf+"_"+gb.UEb,this.domElement),I=$get(gb.PGf+"_"+gb.UEb,this.domElement);d&&!this.sdc?(w&&Yh.a.instance.qa(sg.a.click,w,this.uca),I&&Yh.a.instance.qa(sg.a.click,I,this.uca),this.sdc=!0):this.sdc&&(w&&Yh.a.instance.za(sg.a.click,w,this.uca),I&&Yh.a.instance.za(sg.a.click,I,this.uca),this.sdc=!1)};ca.prototype.NOj=function(d){var w=this;var I=null;var ha;if(function(){var Ic=td.Z(d,w.$.ea.xa);$a=Ic.sheetName;ha=Ic.range;return Ic}().returnValue&&
ha){if(!$a){var wa=Object(qc.a)($f.a,this.$.pa);if(!wa)return{returnValue:!1,sheetRange:I};var $a=wa.name}I=td.v(ha,this.$);I.SheetName=$a;this.p6c=!1;return{returnValue:!0,sheetRange:I}}var Tb=null;return function(){var Ic=w.F5b.xOj(d);$a=Ic.sheetName;Tb=Ic.range;return Ic}().returnValue?(I=td.v(Tb,this.$),I.SheetName=$a,this.p6c=!0,{returnValue:!0,sheetRange:I}):{returnValue:!1,sheetRange:I}};ca.prototype.kMd=function(d){this.pluginScheduler.requester().runAuthoringExperiment({content:d})};ca.prototype.mec=
function(){if(1===this.Kf.DW.length&&this.Nv.length){var d=this.Nv[this.Kf.DW[0]];if(1===d.itemType){var w=d.name;d=this.Ya.text;w=w.substring(d.length,w.length);w.length&&(this.Ya.text=d+w,this.Ya.textBox.selectRange(d.length,this.Ya.text.length))}}else Fd.ULS.shipAssertTag(537162007,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.Kf.DW.length)};ca.prototype.Ljc=function(d,w,I,ha){var wa={};wa.a=d;wa.b=w;wa.c=I;wa.d=ha;fh.b().Pe(38,wa,!0)};ca.prototype.Hse=
function(d,w){if(!this.functionInfoManager.l5){if(d)if(this.aDd(this.Ya.text,this.Ya.textBox.caretPosition),this.OAa||this.ZV){var I={};I.Filter=this.ZV?this.ZV.charAt(0).toString():"";I.FilterType=1;I.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.Isb(I)}else ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.get_visible()&&this.set_visible(!1);if(!w)return}0<this.$.Ab.$N||this.Ya&&!this.Ya.isEditing?this.set_visible(!1):d&&(this.aDd(this.Ya.text,
this.Ya.textBox.caretPosition),this.mja.update(this.AQ,this.V4b,this.sQc,this.cxc),this.G5=this.Ya.text.substring(1,this.Ya.textBox.caretPosition),this.T3=this.G5.indexOf(va.a.TU),this.S3=this.G5.lastIndexOf(va.a.TU),this.eYi()?(d=new mb,d.etj(),this.pGa=this.p8=d=[d],this.Kf.kTj(d),this.show()):((this.nAh()||this.Pwa())&&this.DDe(!1),0<this.S3?this.Kf.sJa(this.Nv,this.G5,!1,void 0,this.G5.lastIndexOf(va.a.TU),!1):this.Kf.sJa(this.Nv,this.ZV,!1,void 0,this.S3,!1),this.show(),this.Vm&&(this.Kf.cs.length||
Ne.g(this.$).yj.eL?this.mja.Wrb():(this.mja.Hgj(),this.Vm&&this.w1a()))))};ca.prototype.K4f=function(){var d=this;if(0<this.Kf.cs.length){ra.instance.D7(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var w={};w.zoomLevel=P(this.$);this.formulaAssistanceUIControl.updateContext(w);this.Oq=function(){d.formulaAssistanceUIControl.renderAutoCompleteMenu(d.domElement,Ne.g(d.$).yj.textBox.domElement,d.$ed())};this.Oq();this.oMa&&this.Kf.Qhc&&this.raiseEvent(ca.tcd,null);!this.nMa||this.Xmd||
this.Kf.Qhc||this.raiseEvent("FormulaAutoCompleteShown");this.Dka&&(this.kr.canReceiveFocus=!0);this.Xmd=!0}ra.instance.lZ(["autoCompleteRender"]);!ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.vSa&&null!==this.vSa&&0<this.vSa.length&&(this.PAa=!0)}};ca.prototype.Ytd=function(){this.qIa&&(ra.instance.R2.selectByArrowKeyCounter++,this.qIa=!1);this.rIa&&(ra.instance.R2.selectByMouseHoverCounter++,this.rIa=!1);this.pIa&&(ra.instance.R2.commitByTabKeyCounter++,
this.pIa=!1);this.nIa&&(ra.instance.R2.commitByEnterKeyCounter++,this.nIa=!1);this.oIa&&(ra.instance.R2.commitByMouseClickCounter++,this.oIa=!1)};ca.prototype.$ed=function(){var d=new pa;d.completionItems=this.Kf.k2c;d.activeItemIndex=this.Kf.Mk?this.Kf.Mk.rowIndex:-1;this.aId(d);return d};ca.prototype.aId=function(d){d.callbacks=new Pa;d.callbacks.onCompletionItemSelected=this.Qzd;d.callbacks.onCompletionItemCommitted=this.Pzd;d.callbacks.onFeedback=this.oRa;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&
(d.callbacks.onDismiss=this.Qnd?this.onDismiss:this.w1a)};ca.prototype.JEd=function(d){this.Ofa=!0;var w=d.textEdit.newText;this.Ya.ndb(w.substring(this.Ya.text.length-d.textEdit.range.start.character,w.length))};ca.prototype.kBe=function(){this.My(!0);this.Ofa=this.isListVisible=!1;this.wSa=!0};ca.prototype.tmd=function(d,w){this.Ya.text=d.substring(0,w.range.start.character)+w.newText+d.substring(w.range.end.character,d.length);Ne.g(this.$).Dj&&(Ne.g(this.$).yc.text=this.Ya.text)};ca.mMd=function(d){d.requester().runExperiment(new ja)};
ca.T2g=function(d){var w=mb.k$g(),I={IsCompatibility:!1};I.NameDataStrings=d.label;I.Help=d.detail;w.i_f(I);w.textEdit=d.textEdit;return w};ca.TJa=function(){var d=String.format(gb.KGh,gb.Kcd,Dk.a.wOe),w=String.format(gb.FGh,gb.Icd,vh.a.C9c,N.a.Tk,N.a.Xo),I=String.format(gb.CGh,gb.Dcd,vh.a.C9c,N.a.Tk,vh.a.pPe,N.a.Xo);return String.format("{0}\r\n{1}\r\n{2}",d,w,I)};ca.opi=function(d){return 36===d||58===d||33===d||39===d||32===d};ca.m9h=function(d,w){return 32===d||91===d||!w.Zha};Sk.Object.defineProperties(ca.prototype,
{Gt:{configurable:!0,enumerable:!0,get:function(){return this.Kf}},Nv:{configurable:!0,enumerable:!0,get:function(){return this.p8}},UIb:{configurable:!0,enumerable:!0,get:function(){return this.Kf.qe}},qWe:{configurable:!0,enumerable:!0,get:function(){return this.Kf}},UVe:{configurable:!0,enumerable:!0,get:function(){return this.mja}},Kf:{configurable:!0,enumerable:!0,get:function(){return this.ipg}},O0a:{configurable:!0,enumerable:!0,get:function(){return this.OAa?this.Ya?this.Ya.text:null:this.ZV}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.Gt.isListVisible},set:function(d){this.Vm&&!d&&this.w1a();this.Gt.isListVisible=d}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.qxg}},qka:{configurable:!0,enumerable:!0,get:function(){return 0<this.S3}},lN:{configurable:!0,enumerable:!0,get:function(){return this.Ofa}},D_b:{configurable:!0,enumerable:!0,get:function(){return this.X1d}},S3:{configurable:!0,enumerable:!0,get:function(){return this.KJe},
set:function(d){this.KJe=d;d||(this.T3=0)}},Eyj:{configurable:!0,enumerable:!0,get:function(){if(null==this.ppc){var d=this.$.nc;this.ppc=!!d&&!d.inEmbedView}return this.ppc}},CXf:{configurable:!0,enumerable:!0,get:function(){return this.Kf.k2c[this.Kf.Mk.rowIndex]}},yWe:{configurable:!0,enumerable:!0,get:function(){!this.Lcd&&this.pluginScheduler&&(this.Lcd=this.pluginScheduler.getFunctionsShortDescriptions());return this.Lcd}}});ca.tcd="FACardOpened";ca.Nbd="FAFocusOnSmartSuggestionsCard";ca.Hkd=
null;Object(Hd.a)(ca,"FormulaAssistanceControl",Ai.a,[753,754,3,755,756]);var $d=tg.a;vm(X,$d);X.prototype.Rne=function(d){this.addHandler("FAFunctionNameUpdated",d)};X.prototype.RQf=function(d){this.removeHandler("FAFunctionNameUpdated",d)};X.prototype.Goe=function(d){this.addHandler("FAParameterSelectionChangedOld",d)};X.prototype.oRf=function(d){this.removeHandler("FAParameterSelectionChangedOld",d)};X.prototype.Foe=function(d){this.addHandler("FAParameterSelectionChanged",d)};X.prototype.nRf=
function(d){this.removeHandler("FAParameterSelectionChanged",d)};X.prototype.IEg=function(d){this.addHandler("DC",d)};X.prototype.ecj=function(d){this.removeHandler("DC",d)};X.prototype.dismiss=function(){this.Kv=!1;this.formulaAssistanceUIControl&&(this.Oq=null,this.lR&&this.cH.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.nla=null,this.kr.canReceiveFocus=!1)};X.prototype.show=function(d,w){var I=this;this.Kv=!0;this.KUc();var ha=this.rEd(d);this.formulaAssistanceUIControl&&
(ra.instance.D7(["argumentAssistanceRender"]),d={},d.zoomLevel=P(this.$),this.formulaAssistanceUIControl.updateContext(d),ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Oq=function(){I.formulaAssistanceUIControl.renderArgumentAssistanceCard(I.domElement,w,ha)},this.Oq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,w,ha),this.wDd(ha),this.lR&&this.cH.ja(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),
this.Oq,function(){return I.formulaAssistanceUIControl.dismiss(I.domElement)}),this.kr.canReceiveFocus=!0,ra.instance.lZ(["argumentAssistanceRender"]),ra.instance.B7b("argumentAssistanceOverall"))};X.prototype.dispose=function(){if(this.$){var d=Ne.g(this.$);d&&(d.ha&&d.ha.WF(this.nd),d.view.Nq(this.it),this.lR&&d.pc.Pn(this.Kg))}eg.a.Fa(this.kr);this.$=null};X.prototype.KUc=function(){Ne.g(this.$).yj.rOb.add(this)};X.prototype.rEd=function(d){var w=new Mb;w.functionRenderingInfo=d;w.cardMode=this.O2;
this.cId(w);return w};X.prototype.cId=function(d){d.callbacks=new Dc;d.callbacks.onHelpLink=this.lfd(d.functionRenderingInfo);d.callbacks.onCardModeChange=this.onCardModeChange;d.callbacks.onFeedback=this.oRa;this.qba&&(d.callbacks.onDismissClick=this.onDismissClick)};X.prototype.lfd=function(d){var w=this;return function(){Ba(w.$,d.helpID,d.isUDF)}};X.prototype.NOd=function(){var d=Rj.a.get(Ca.a.r_b);this.O2=d?parseInt(d,10):X.e6c;ra.instance.OYf(this.O2)};X.prototype.wDd=function(d){var w=d.functionRenderingInfo.functionName;
this.nla&&k.a.equals(this.nla,w,!0)?(w=ih.a.map(d.functionRenderingInfo.signatures,function(I){var ha="";0<=I.signatureParams.activeParam&&I.signatureParams.activeParam<I.signatureParams.params.length&&(ha=I.signatureParams.params[I.signatureParams.activeParam]);return ha}),this.raiseEvent("FAParameterSelectionChanged",new Ya(w))):(this.nla=w,d=ih.a.map(d.functionRenderingInfo.signatures,function(I){return I.signatureParams.params.join(", ")}),this.raiseEvent("FAFunctionNameUpdated",new tb(w,d)))};
X.prototype.qNb=function(d){this.O2=d;try{Rj.a.pv(Ca.a.r_b,d.toString(),yk.AFrame.zea)}catch(w){Fd.ULS.sendTraceTag(537162074,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",w.message)}};X.TJa=function(){return document.createElement("div")};Sk.Object.defineProperties(X.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Kv},set:function(d){d||this.dismiss();this.Kv=d}}});X.e6c=0;Object(Hd.a)(X,"FormulaArgumentAssistanceControl",tg.a,
[812]);var Be;(function(d){d[d.Dismissed=0]="Dismissed";d[d.Smart=1]="Smart";d[d.Simple=2]="Simple";d[d.Mixed=3]="Mixed"})(Be||(Be={}));Object(Hd.b)("UIState",Be);var gg=tg.a;vm(fa,gg);fa.prototype.Pne=function(d){this.addHandler("FACardOpened",d)};fa.prototype.QQf=function(d){this.removeHandler("FACardOpened",d)};fa.prototype.Nne=function(d){this.addHandler("FAFocusOnSmartSuggestionsCard",d)};fa.prototype.OQf=function(d){this.removeHandler("FAFocusOnSmartSuggestionsCard",d)};fa.prototype.One=function(d){this.addHandler("FormulaAutoCompleteShown",
d)};fa.prototype.PQf=function(d){this.removeHandler("FormulaAutoCompleteShown",d)};fa.prototype.dispose=function(){if(this.$){var d=Ne.g(this.$);d&&(d.ha&&d.ha.WF(this.nd),d.pc&&this.Nyb&&d.pc.Pn(this.Kg),d.view.Nq(this.it));this.$.xa&&this.$.xa.ug(this.ii)}this.Dka&&eg.a.Fa(this.kr);this.$=null};fa.prototype.uEg=function(d){this.addHandler("CVIC",d)};fa.prototype.Rbj=function(d){this.removeHandler("CVIC",d)};fa.prototype.Rh=function(d,w){if(!this.visible)return!1;this.rba&&this.dBc(w);if(this.lN){if(125627505===
w||this.god&&267796030===w)return this.l0a(this.Nv.items[this.A0]),!this.god;if(1872288872===w)return this.kda(),this.visible=!1,!0;if(!this.god&&267796030===w)this.kda();else if(this.MFf&&(-798660877===w||137938150===w))return!1}d=!1;switch(w){case 1872288872:this.visible=!1;d=!0;break;case -798660877:this.cfb(this.Pvb(this.A0+1));d=!0;break;case 137938150:this.cfb(this.Pvb(this.A0-1));d=!0;break;case 2091832999:this.cfb(this.Pvb(this.A0+8));d=!0;break;case 742457698:this.cfb(this.Pvb(this.A0-8));
d=!0;break;case 125627505:this.l0a(this.Nv.items[this.A0]);d=!0;break;case 267796030:ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.l0a(this.Nv.items[this.A0]),d=!0)}return d};fa.prototype.show=function(d){this.Ya=Ne.g(this.$).yj;this.Kv=!0;this.KUc();this.A0=0;this.Nv=d;0<this.Nv.items.length&&(this.render(),this.cfb(this.Pvb(this.A0)),1===this.Nv.items[0].type&&this.Nyb&&(this.PAa=!0))};fa.prototype.kda=function(){this.Ofa=!1;this.Ya.SIe()};
fa.prototype.render=function(){var d=this;ra.instance.D7(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var w={};w.zoomLevel=P(this.$);this.formulaAssistanceUIControl.updateContext(w);this.Oq=function(){d.formulaAssistanceUIControl.renderAutoCompleteMenu(d.domElement,d.Ya.textBox.domElement,d.$ed())};this.Oq();this.nMa&&(w=this.gNb,this.gNb=this.s0h(this.Nv.items),w!==Be.Dismissed&&w!==Be.Smart||this.gNb!==Be.Simple&&this.gNb!==Be.Mixed||this.raiseEvent("FormulaAutoCompleteShown"));this.Dka&&
(this.kr.canReceiveFocus=!0);ra.instance.lZ(["autoCompleteRender"]);ra.instance.B7b("autoCompleteOverall")}};fa.prototype.KUc=function(){this.Ya.rOb.add(this)};fa.prototype.l0a=function(d){if(this.Ya&&this.visible){var w=d.textEdit;this.tmd(this.Ya.text,w);this.Ya.textBox.caretPosition=w.range.start.character+w.newText.length;this.lN&&(this.Ofa=!1,this.Nyb&&(this.wSa=!0),this.Ya.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",0));this.visible=!1;this.raiseEvent("CVIC",{shouldRequestAutocompleteOnCommit:d.shouldRequestAutocompleteOnCommit})}};
fa.prototype.OIg=function(){this.PAa&&(ra.instance.KJa.smartSuggestionShownCounter++,this.PAa=!1);this.wSa&&(ra.instance.KJa.smartSuggestionSelectedCounter++,this.wSa=!1);this.qLb&&(ra.instance.KJa.smartSuggestionCommittedCounter++,this.qLb=!1)};fa.prototype.$ed=function(){var d=new pa;d.completionItems=this.Nv.items;d.activeItemIndex=this.A0;this.aId(d);return d};fa.prototype.aId=function(d){d.callbacks=new Pa;d.callbacks.onCompletionItemSelected=this.Qzd;d.callbacks.onCompletionItemCommitted=this.Pzd;
d.callbacks.onFeedback=this.oRa;ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(d.callbacks.onDismiss=this.Qnd?this.pKi:this.dismiss)};fa.prototype.JEd=function(d){this.Ofa=!0;var w=d.textEdit.newText;this.Ya.ndb(w.substring(this.Ya.text.length-d.textEdit.range.start.character,w.length))};fa.prototype.cfb=function(d){var w=this.A0;this.A0=d;var I=this.Nv.items[d];this.lN&&this.kda();w!==d&&this.render();1===I.type&&ye.EwaSettings.Ehc()&&!Ne.g(this.$).yj.text.includes("\n")&&
this.JEd(I)};fa.prototype.Pvb=function(d){return 0>d?0:Math.min(d,this.Nv.items.length-1)};fa.prototype.tmd=function(d,w){this.Ya.text=d.substring(0,w.range.start.character)+w.newText+d.substring(w.range.end.character,d.length);Ne.g(this.$).Dj&&(Ne.g(this.$).yc.text=this.Ya.text)};fa.prototype.Ytd=function(){this.qIa&&(ra.instance.R2.selectByArrowKeyCounter++,this.qIa=!1);this.rIa&&(ra.instance.R2.selectByMouseHoverCounter++,this.rIa=!1);this.pIa&&(ra.instance.R2.commitByTabKeyCounter++,this.pIa=
!1);this.nIa&&(ra.instance.R2.commitByEnterKeyCounter++,this.nIa=!1);this.oIa&&(ra.instance.R2.commitByMouseClickCounter++,this.oIa=!1)};fa.prototype.dBc=function(d){switch(d){case -798660877:case 137938150:case 2091832999:case 742457698:this.qIa=!0;break;case 125627505:this.pIa=!0;break;case 267796030:ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.nIa=!0)}};fa.TJa=function(){return document.createElement("div")};fa.prototype.s0h=function(d){return d.reduce(function(w,
I){return w|=0===I.type?Be.Simple:Be.Smart},Be.Dismissed)};Sk.Object.defineProperties(fa.prototype,{visible:{configurable:!0,enumerable:!0,get:function(){return this.Kv},set:function(d){d||this.dismiss();this.Kv=d}},lN:{configurable:!0,enumerable:!0,get:function(){return this.Ofa}},MFf:{configurable:!0,enumerable:!0,get:function(){return 1===this.Nv.items.length&&1===this.Nv.items[0].type}}});Object(Hd.a)(fa,"FormulaAutoCompleteControl",tg.a,[811,3,755]);da.prototype.then=function(d,w){return this.promise.then(d,
w)};da.prototype.resolve=function(d){this.dvg(d);return null!=d&&"function"===typeof d.then?this.promise.then():void 0};da.prototype.reject=function(d){this.Mug(d);return null!=d&&"function"===typeof d.then?this.promise.then():void 0};Object(Hd.a)(da,"ResolvablePromise",null,[]);K.prototype.getRichValueFieldListContext=function(d,w,I,ha){this.ikf&&d!==this.ikf&&this.nh.zbb();this.ikf=d;this.nh.DZ(d,I,ha,w);this.e9b=new da;this.nh.Eyb?this.e9b.resolve(this.nh.Ek):this.n9i();return this.e9b.promise};
K.prototype.n9i=function(){this.nh.RYb(this.wya);this.nh.gFg(this.Gyf)};K.prototype.Ibg=function(){this.nh.Csc(this.wya);this.nh.ycj(this.Gyf)};Object(Hd.a)(K,"ServerDataProvider",null,[809]);S.prototype.dispose=function(){if(this.$){var d=Ne.g(this.$);d&&(d.ha&&yg.a.a_()&&d.ha.Lza(this.Mh),this.dgf&&d.Ca&&d.Ca.Kq(this.Jg))}this.qba&&(Ne.g(this.$).pc.Pn(this.Kg),this.sDa.ecj(this.Ruf));this.dqa.Rbj(this.Zuf);this.functionInfoManager&&this.functionInfoManager.kHb(this.onFunctionInfoLoaded);yg.a.nfc&&
this.Ya&&this.Ya.dHb(this.p6);eg.a.Fa(this.sDa);eg.a.Fa(this.dqa);this.dqa=this.sDa=this.functionInfoManager=this.$=null};S.prototype.bhj=function(){this.iNa=-1;this.jNa=null};S.prototype.OIe=function(){this.Pua.visible=!1;this.jcd.visible=!1};S.prototype.Rh=function(){this.wda();return!1};S.prototype.wda=function(d){var w=this;d=void 0===d?0:d;if(27!==d&&9!==d&&13!==d&&!this.Ya.eL){if(this.Q5a&&(ra.instance.Dob.formulaAssistanceRequestAttemptedCounter++,!this.Xyj())){ra.instance.Dob.formulaAssistanceRequestOptimizedCounter++;
return}this.functionInfoManager.l5||(this.functionInfoManager.snb(this.onFunctionInfoLoaded),this.functionInfoManager.Isb({}));var I=this.Ya;d=I.text;I=I.textBox.caretPosition;!this.qba||this.aSa?(ra.instance.D7(["argumentAssistanceComputation","autoCompleteComputation","argumentAssistanceOverall","autoCompleteOverall"]),this.SXf(d,I)):(ra.instance.D7(["autoCompleteComputation","autoCompleteOverall"]),this.pluginScheduler.requester().functionSuggestion(Object.assign(new ea,{content:d,caretPosition:I})).then(function(ha){0===
ha.kind&&w.S6e(ha.payload);return null}))}};S.prototype.SXf=function(d,w){var I=this;this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:d,caretPosition:w},argumentAssistance:{content:d,caretPosition:w}}).then(function(ha){0===ha.kind&&(I.l6e(ha.payload.argumentAssistance),I.S6e(ha.payload.functionSuggestion));return null})};S.prototype.Xyj=function(){var d=this.Ya,w=d.text;d=d.textBox.caretPosition;if(this.dqa.visible&&k.a.equals(w,this.jNa,
!0)&&d===this.iNa)return!1;this.jNa=w;this.iNa=d;return!0};S.prototype.mMd=function(){this.pluginScheduler.requester().runExperiment(new ja)};S.prototype.l6e=function(d){d&&this.Ya.isEditing?(ra.instance.lZ(["argumentAssistanceComputation"]),this.sDa.show(d,this.Ya.textBox.domElement)):this.sDa.dismiss()};S.prototype.S6e=function(d){d&&0<d.items.length&&this.Ya.isEditing?(ra.instance.lZ(["autoCompleteComputation"]),this.dqa.show(d)):this.dqa.dismiss()};S.prototype.kMd=function(d){this.pluginScheduler.requester().runAuthoringExperiment({content:d})};
S.prototype.CCb=function(){var d=Ne.g(this.$).ha.va.activeCell;if(d){var w=this.calcManager.dta(d);if(w){var I=this.$.xa,ha=w.sheet.index;0>=I.count||0>ha||ha>=I.count||(ha=I=null,this.pyd&&void 0!==this.calcManager&&null!==this.calcManager&&(d=Ne.g(this.$).Ca.es(d))&&(d=this.calcManager.Yfd(d.Em),void 0!==d&&null!==d&&(I=d.FormatString,ha=d.Builtin)),this.pluginScheduler.notifier().setActiveCell(Object.assign(new qa,{colIndex:w.range.col,rowIndex:w.range.row,sheetIndex:this.$.xa.getItem(w.sheet.index).sheetId,
docName:w.sheet.document.name,docPath:w.sheet.document.path,formatString:I,builtIn:ha})))}else Fd.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}};S.prototype.gUj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.Hcd)};S.prototype.emd=function(){Ne.g(this.$).ha.Ora(this.Mh);this.CCb();yg.a.nfc&&this.Ya.FYa(this.p6);this.mMd();this.dqa.uEg(this.Zuf);this.pluginScheduler.setServerDataProvider(new K(this.nh,
this.$));this.wda()};Sk.Object.defineProperties(S.prototype,{Pua:{configurable:!0,enumerable:!0,get:function(){return this.dqa}},jcd:{configurable:!0,enumerable:!0,get:function(){return this.sDa}},Ya:{configurable:!0,enumerable:!0,get:function(){return Ne.g(this.$).yj}}});Object(Hd.a)(S,"FormulaAssistanceManager",null,[752,3]);var Wg=bi.a;vm(H,Wg);H.prototype.create=function(){var d=this,w=yg.a.a_(),I=ye.EwaSettings.la(383),ha=ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",
!1),wa=yg.a.mF(this.$),$a=this.$.da,Tb=Rg.GetServiceTaskFactory.create($a,134,this.ma,this.ub),Ic=Rg.GetServiceTaskFactory.Wa(this.$.da,12,477,this.ub);var pc=yg.a.iN(this.$)?Rg.GetServiceTaskFactory.create(this.$.da,449,this.$.ma,1):Vf.Task.Ta(null);var vd=yg.a.a_()?Rg.GetServiceTaskFactory.create(this.$.da,414,this.$.ma,1):Vf.Task.Ta(null);if(ha||w){var ne=Rg.GetServiceTaskFactory.Wa($a,266,265,this.ub),Pe=Rg.GetServiceTaskFactory.Wa($a,219,220,this.ub);Od.TaskExtensions.Ba(Od.TaskExtensions.ve([ne,
vd,pc,Pe],this.ma),function(){var Wf=$a.Aa(19)||new ib(d.$,vd.result),Of=Pe.result;if(wa){var xg=$a.Aa(464);xg||(xg=new S(d.$,Wf,ne.result,vd.result,pc.result,Ic.result.M3c(d.$,Tb.result)),Of.vXc(xg.jcd),Of.wXc(xg.Pua))}else xg=$a.Aa(221),xg||(xg=new ca(d.$,Wf,Tb.result,ne.result,null,Ic.result,pc.result,vd.result),Of.vXc(xg.UVe),Of.Yse(xg.qWe),Of.wXc(xg)),I&&($a.Aa(317)||new sc(d.$));d.Fb(Wf)},this.ma,3)}else{var Af=Rg.GetServiceTaskFactory.Wa($a,219,220,this.ub);Od.TaskExtensions.Ba(Od.TaskExtensions.ve([Af,
pc,vd],this.ma),function(){var Wf=$a.Aa(19)||new ib(d.$,vd.result),Of=Af.result,xg=$a.Aa(221);xg||(xg=new ca(d.$,Wf,Tb.result,null,null,Ic.result,pc.result,vd.result),Of.vXc(xg.UVe),Of.Yse(xg.qWe),Of.wXc(xg));I&&($a.Aa(317)||new sc(d.$));d.Fb(Wf)},this.ma,3)}};H.ja=function(d){d.da.Ha(153,new H(d))};Object(Hd.a)(H,"FunctionInfoManagerFactory",bi.a,[]);var Dh=b(199),ei=b(74),wj=b(113);T.prototype.TZe=function(){return wj.a(sh.a.Ra,this.startTime)};Object(Hd.a)(T,"OngoingAction",null,[]);var Bj=ei.a;
vm(ba,Bj);ba.prototype.Dpc=function(d){Fd.ULS.sendTraceTag(537153864,0,50,"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.xla,this.MLa,this.M5a);this.Inb=this.xzg.JZb(d,this.Inb);this.Emd()};ba.prototype.dispose=function(){this.documentVisibilityObserver&&this.documentVisibilityObserver.fHb(this.vya);this.lxe();Bj.prototype.dispose.call(this)};ba.prototype.X_f=function(d){this.fZc?(this.$Oa=d?new T:null,d?this.startTimer():this.lxe()):
this.$Oa=d?{}:null};ba.prototype.yUe=function(d){d=void 0===d?null:d;this.fZc&&d&&d.uK?Fd.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",this.xla):(Fd.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.xla,this.MLa,this.M5a),this.X_f(!1),this.Emd())};ba.prototype.Emd=function(){var d=this;if(!this.KKb()){var w=this.Inb;this.Inb=null;this.X_f(!0);Fd.ULS.sendTraceTag(537153857,
0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",this.xla);var I=this.fZc?this.$Oa.qx.token:Dh.a.none;Od.TaskExtensions.Ba(this.wzg.Bpc(w),function(){d.yUe(I)},I,0,this.TO)}};ba.prototype.KKb=function(){return!this.M5a||this.MLa?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.Di?(Fd.ULS.sendTraceTag(593376846,0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",this.xla),!0):!1};ba.prototype.lxe=function(){this.Joc&&
this.Joc.cancel()};ba.prototype.startTimer=function(){this.gZc<=this.Mve&&(this.Joc=zi.a.instance.create(this.eSi,this.QSg,Ei.a.yke))};Sk.Object.defineProperties(ba.prototype,{MLa:{configurable:!0,enumerable:!0,get:function(){return!!this.$Oa}},M5a:{configurable:!0,enumerable:!0,get:function(){return!!this.Inb}}});Object(Hd.a)(ba,"ActionAggregator",ei.a,[814,3]);var Xj=b(122),Fi=dh.a;vm(la,Fi);la.prototype.FFg=function(d){this.addHandler("KBIS",d)};la.prototype.Pcj=function(d){this.removeHandler("KBIS",
d)};la.prototype.dispose=function(){this.firstElement&&Dd.a.removeHandler(this.firstElement,sg.a.focus,this.cyf);this.Cs&&this.Cs.detach("focus");this.to&&(Dd.a.removeHandler(this.to,sg.a.focus,this.Xzf),Dd.a.removeHandler(this.to,sg.a.blur,la.onBlur),di.KeyInputManager.instance.za(sg.a.Sb,this.to,this.Yzf));di.KeyInputManager.instance.za(sg.a.Sb,this.$.domElement,this.BFf);this.Cs=this.to=this.firstElement=this.$=null;Fi.prototype.dispose.call(this)};la.prototype.B6g=function(){this.jxj?(this.firstElement=
document.documentElement,this.Cs=Xj.a.instance.rE(document.parentWindow),this.Cs.ja("focus",this.EVi)):(this.firstElement=la.eEe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),Dd.a.addHandler(this.firstElement,sg.a.focus,this.cyf))};la.prototype.y7g=function(){this.to=la.eEe();this.to.id=Ca.a.mLe;this.to.setAttribute(Ca.a.Et,te.a.instance.fa(845));document.body.appendChild(this.to);Dd.a.addHandler(this.to,sg.a.focus,this.Xzf);Dd.a.addHandler(this.to,sg.a.blur,la.onBlur);
di.KeyInputManager.instance.qa(sg.a.Sb,this.to,this.Yzf)};la.prototype.yzh=function(d){this.cag(d);return!1};la.prototype.PKi=function(){this.mMa=!0;Ne.g(this.$).focus();Ne.g(this.$).ha.L6e();this.raiseEvent("KBIS");return!0};la.prototype.cag=function(d){this.mMa?this.mMa=!1:(this.mMa=!0,d&&d.focus())};la.eEe=function(){var d=document.createElement("div");d.tabIndex=0;return d};la.G9e=function(){document.body.classList.add(N.a.PNe)};la.onBlur=function(){document.body.classList.remove(N.a.PNe)};Object(Hd.a)(la,
"EmbedViewFocusControl",dh.a,[813,3]);var oj=b(58),bk=b(528),vk=dh.a;vm(Q,vk);Q.prototype.RYb=function(d){this.addHandler("FieldInfoListContextLoaded",d)};Q.prototype.Csc=function(d){this.removeHandler("FieldInfoListContextLoaded",d)};Q.prototype.gFg=function(d){this.addHandler("GetFieldInfoListContextOperationFailed",d)};Q.prototype.ycj=function(d){this.removeHandler("GetFieldInfoListContextOperationFailed",d)};Q.prototype.dispose=function(){this.vb=null;this.zbb();vk.prototype.dispose.call(this)};
Q.prototype.DZ=function(d,w,I,ha){ha=void 0===ha?null:ha;if(d){this.a_c();this.h1b();var wa=null,$a=!1,Tb;if(Tb=!ha)Tb=this.pOj(d,w,I),$a=Tb.t$a,wa=Tb.Ek,Tb=Tb.returnValue;if(Tb&&(this.PZf(wa),this.tTb=!0,(this.wP=wa)&&0<this.wP.length&&(this.ajb=!0,this.eGd()),!$a))return;this.Rdg(d,ha,w,I,!1)}};Q.prototype.Rdg=function(d,w,I,ha,wa){if(this.$.ea.qc){this.$.Vb&&(this.XHb=this.$.Vb.Hc("WebServiceCall","GetRichValueFieldInfoListContext"));this.Zub=null;var $a=this.$.na.ta.Zb(),Tb=this.$.na.ta,Ic=this.kMi,
pc=this.jMi,vd=Tb.Na(1,null);vd.selectedRange=d;vd.richValueKeyPath=w;vd.singleColumn=I;vd.searchForRange=ha;vd.calculateMajorityDataType=wa;this.Zub=jg.i(Tb,"GetRichValueFieldListContextList",vd,Ic,pc,null,$a,4)}else this.wP=null};Q.prototype.zbb=function(){this.wP=null;this.ajb=!1;this.a_c();this.h1b();this.Zub=null;this.fSb=-1};Q.prototype.a_c=function(){Q.Cpb(this.Zub)};Q.prototype.h1b=function(){Q.Cpb(this.Fed)};Q.prototype.eGd=function(){this.raiseEvent("FieldInfoListContextLoaded")};Q.prototype.En=
function(d){d=td.D(d);--d.left;--d.right;return this.tableManager.En(d)};Q.prototype.hKa=function(d){var w=this;d.FirstColumn=d.FirstColumn;d.LastColumn=d.LastColumn;d.FirstRow=d.FirstRow;d.LastRow=d.LastRow;this.h1b();this.Fed=null;return Ch.a(this.$.userOperationManager,function(I,ha,wa){return jg.w(w.$.na.ta,d,Jf.b(I,function($a){w.uMi($a)}),Jf.a(ha,ha,function($a){w.tMi($a)}),wa,null)},function(I){return new Uf.a(264,0,I,80)},null)};Q.prototype.tMi=function(d){d=Cg.a.og(d.data);Fd.ULS.sendTraceTag(525336847,
0,10,"FieldInfoManager.OnGetFullTableRangeFailure - Webservice call failed with Errors: {0}",hh.a.Tc(d))};Q.prototype.uMi=function(d){if(xh.a(d))-315732528!==d.Errors[0].MessageId&&Fd.ULS.sendTraceTag(525336846,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call failed with Unexpected error : {0}",hh.a.Tc(d.Errors));else if(d&&d.Result){d=d.Result;var w=d.HasHeaderRow;w=new bk.AutofilterRange(d.TableRange.FirstRow+(w?1:0)+1,d.TableRange.FirstColumn+1,d.TableRange.LastRow+1,d.TableRange.LastColumn+
1,null,null,null,0,w);this.fSb=d.TableRange.FirstColumn;(d=this.BKf(!1,!0,w))||Fd.ULS.sendTraceTag(525336844,0,50,"FieldInfoManager.OnGetFullTableRangeSuccess - fieldInfoListContextList is null");this.PZf(d)}else Fd.ULS.sendTraceTag(525336845,0,10,"FieldInfoManager.OnGetFullTableRangeSuccess - Webservice call returned no result")};Q.prototype.pOj=function(d,w,I){var ha=null;var wa=!1;if(d.SheetName!==this.$.ea.pa.sheetName)return{returnValue:!1,t$a:wa,hKa:!1,Ek:ha};this.fSb=-1;if(I){var $a=this.En(d);
if(!$a||!$a.Xva)return{returnValue:!1,t$a:wa,hKa:!1,Ek:ha};var Tb=Ne.g(this.$).Rb.Z2e($a);this.B4d=$a;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5167298_ObtainFullRangeOfTableForPopulatingInsertDataDropdownCorrectly")&&Tb&&0<Tb.count)return--d.FirstColumn,--d.LastColumn,this.Fed=this.hKa(d),{returnValue:!0,t$a:wa,hKa:!0,Ek:ha};$a.top+=1;$a.right=td.D(d).right-1}else $a=new bk.AutofilterRange(d.FirstRow+1,d.FirstColumn+1,d.LastRow+1,d.LastColumn+1,null,null,null,0,!1);if($a.top>$a.bottom||$a.left>
$a.right)return{returnValue:!0,t$a:wa,hKa:!1,Ek:ha};d=Ne.g(this.$);var Ic=d.$a.width,pc=d.$a.height;Tb=d.view.visibleArea;Ic=new oj.a(Tb.x-Ic,Tb.y-pc,Tb.width+Ic,Tb.height+pc);pc=d.pg($a);if(!Tb||!pc||!d.vhc($a))return{returnValue:!1,t$a:wa,hKa:!1,Ek:ha};Ic.contains(pc)||(wa=!0);ha=this.BKf(w,I,$a);return{returnValue:!0,t$a:wa,hKa:!1,Ek:ha}};Q.prototype.PZf=function(d){d&&Fd.ULS.sendTraceTag(25264348,0,50,"Retrieved {0} rich value field contexts from block cache",d.length);this.tTb=!0;(this.wP=d)&&
0<this.wP.length&&(this.ajb=!0,this.eGd())};Q.prototype.BKf=function(d,w,I){var ha=null;var wa=I.clone();if(w){w=I.right;for(var $a=0;w>=I.left;--w){wa.left=w;wa.right=w;var Tb=this.h_e(wa,!0,I.left);if(Tb){ha||(ha=[]);ha[$a]=Tb;if(d)break;++$a}}}else if(d=this.h_e(wa,!1))ha=[],ha[0]=d;return ha};Q.prototype.h_e=function(d,w,I){I=void 0===I?0:I;var ha=null;if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var wa=Ne.g(this.$).Rb.WXh(d);if(wa&&0<wa.count){var $a=
Array(wa.count),Tb=0;wa=yl(wa.values);for(ha=wa.next();!ha.done;ha=wa.next()){var Ic={};Ic.Name=ha.value;$a[Tb]=Ic;++Tb}Tb="";wa=-1;0<d.top&&w&&(d=new Bi.Range(d.top-1,d.left,d.top-1,d.left,!1,!1),Tb=Ne.g(this.$).uc(d).originalText,wa=d.left-I);ha={};ha.ColumnName=Tb;ha.ColumnIndex=wa;ha.FieldInfoDataList=$a}}else if((wa=Ne.g(this.$).Rb.Z2e(d))&&0<wa.count){$a=Array(wa.count);Tb=0;wa=yl(wa);for(ha=wa.next();!ha.done;ha=wa.next())Ic={},Ic.Name=ha.value,$a[Tb]=Ic,++Tb;Tb="";wa=-1;0<d.top&&w&&(d=new Bi.Range(d.top-
1,d.left,d.top-1,d.left,!1,!1),Tb=Ne.g(this.$).uc(d).originalText,wa=d.left-I);ha={};ha.ColumnName=Tb;ha.ColumnIndex=wa;ha.FieldInfoDataList=$a}return ha};Q.Cpb=function(d){d&&zg.AFrameworkApplication.Jd.ou(d.Ft)};Sk.Object.defineProperties(Q.prototype,{Eyb:{configurable:!0,enumerable:!0,get:function(){return this.ajb}},Tti:{configurable:!0,enumerable:!0,get:function(){return this.tTb}},lWe:{configurable:!0,enumerable:!0,get:function(){return this.fSb}},h5c:{configurable:!0,enumerable:!0,get:function(){return this.B4d}},
$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},Ek:{configurable:!0,enumerable:!0,get:function(){return this.wP}},WPh:{configurable:!0,enumerable:!0,get:function(){return!!this.Zub}}});Object(Hd.a)(Q,"FieldInfoManager",dh.a,[774,3]);vm(U,Q);U.prototype.fQh=function(d,w){this.M1a=w;Fd.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",d.FirstRow,d.FirstColumn,
d.LastRow,d.LastColumn);this.Rdg(d,null,!0,!1,!0)};Sk.Object.defineProperties(U.prototype,{QG:{configurable:!0,enumerable:!0,get:function(){return this.Clg}}});Object(Hd.a)(U,"FilterInfoManager",Q,[783,774,3]);V.kth="ewa-sharedUi-launchButton";V.nth="ewa-sharedUi-launchButtonWithText";V.lth="ewa-sharedUi-launchButtonClick";V.pth="ewa-sharedUi-launchButtonWithTextClick";V.mth="ewa-sharedUi-launchButtonText";Object(Hd.a)(V,"CssClassNames",null,[]);var Qk=b(279),Lk=tg.a;vm(D,Lk);D.prototype.D2=function(d){this.addHandler(this.qFb,
d)};D.prototype.mda=function(d){this.get_events().removeHandler(this.qFb,d)};D.prototype.WFg=function(d){this.addHandler("OnObjectButtonMouseOver",d)};D.prototype.edj=function(d){this.get_events().removeHandler("OnObjectButtonMouseOver",d)};D.prototype.VFg=function(d){this.addHandler("OnObjectButtonMouseOut",d)};D.prototype.ddj=function(d){this.get_events().removeHandler("OnObjectButtonMouseOut",d)};D.prototype.Xcg=function(d){d&&(this.h_a.innerHTML=d)};D.prototype.xRj=function(d,w,I){this.h_a.innerHTML=
"";d?d.mba(w,16,16,this.h_a,16,16,void 0,I):Fd.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};D.prototype.yRj=function(d,w){d&&(this.nMb.innerText=d);this.domElement.title=w};D.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.wc.IA(),eg.a.rc([this.hZ,this.ZZa]),Yh.a.instance.za(sg.a.click,this.domElement,this.Zc),Qj.a.instance.za(sg.a.pointerDown,this.domElement,this.QN),this.nSa&&this.nSa.dispose(),Lk.prototype.dispose.call(this))};
D.prototype.xbb=function(){this.f2b&&this.domElement.classList.remove(this.f2b);this.Qlc&&this.domElement.classList.add(this.Qlc)};D.prototype.oFb=function(){this.Qlc&&this.domElement.classList.remove(this.Qlc);this.f2b&&this.domElement.classList.add(this.f2b);this.$1a()};D.prototype.$1a=function(){this.Rhc&&(this.nSa.cancel(),this.f7f(),this.setOpacity(1));this.set_visible(!0)};D.prototype.Eo=function(d,w,I,ha,wa){wa=void 0===wa?!1:wa;d=pf.a(ha).Ii(d);w=pf.a(ha).Ii(w);pf.a(ha).gwc(this.domElement);
this.domElement.style.top=qb.HelperMethods.Qb(w);this.domElement.style.left=this.domElement.style.right="";w=d;wa&&(w=d-this.domElement.offsetWidth);zf.c(this.domElement.style,I,qb.HelperMethods.Qb(w));this.set_visible(!0);this.setOpacity(1);this.Rhc&&(this.wSd=!1,this.kGj(),this.nSa.Pq())};D.prototype.hide=function(){this.xbb();this.set_visible(!1);this.Rhc&&(this.f7f(),this.nSa.cancel())};D.prototype.u7b=function(){this.wc.ja("mouseover",this.EF,!0);this.wc.ja("mouseout",this.jI,!0)};D.prototype.kGj=
function(){this.hZ.hn("mousemove")||this.hZ.ja("mousemove",this.Zzd)};D.prototype.f7f=function(){this.hZ.hn("mousemove")&&this.hZ.detach("mousemove")};D.prototype.$id=function(d){if(this.domElement.parentNode){var w=Sys.UI.DomElement.getBounds(this.domElement),I=new Sys.UI.Point(Math.round(w.x+w.width),Math.round(w.y+w.height));w=Math.abs(I.x-d.x);d=Math.abs(I.y-d.y);d=w>d?w:d;this.wSd?this.setOpacity(D.TTg(d)):100>=d&&this.Mke()}};D.prototype.Mke=function(){this.wSd=!0;this.nSa.cancel()};D.prototype.setOpacity=
function(d){Ci.a.setOpacity(this.domElement,d);this.wkf=sh.a.Ra.Kb};D.TTg=function(d){return 100>=d?1:250<=d?0:.01*(100-(d-100)/150*100)};Object(Hd.a)(D,"OnObjectButton",tg.a,[794,85,3]);var il=b(925),jl=V.mth,Rk=ei.a;vm(v,Rk);v.prototype.dispose=function(){this.tgh();this.$=null;Rk.prototype.dispose.call(this)};v.prototype.getButton=function(d,w){return this.cva(d,void 0===w?!0:w)};v.prototype.cva=function(d,w){var I=d.toString();I in this.buttons||this.A7g(d,void 0===w?!0:w);return this.buttons[I]};
v.prototype.Eo=function(d,w,I,ha,wa,$a){wa=void 0===wa?!0:wa;$a=void 0===$a?!1:$a;this.hide();if(this.$.ea.isNamedObjectViewMode&&ef.i(this.$.pa)){var Tb=Ne.g(this.$).tO.domElement,Ic=d+this.buttonWidth-Tb.scrollWidth;Tb=w+this.buttonWidth-Tb.scrollHeight;d=0<Ic?d-Ic:d;w=0<Tb?w-Tb:w}this.cva(ha,wa).Eo(d,w,I,this.$,$a)};v.prototype.hide=function(){var d=this.buttons,w;for(w in d)d[w].hide()};v.prototype.u7b=function(d,w){!this.g$e&&(w=this.buttons[w.toString()])&&(this.llc=function(I,ha){d(ha,!0)},
w.WFg(this.llc),this.klc=function(I,ha){d(ha,!1)},w.VFg(this.klc),this.g$e=!0,w.u7b())};v.prototype.A7g=function(d,w){function I($a,Tb){ha.PIi(Tb,d)}var ha=this;this.qwa=String.format(this.dld===N.a.j8b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',Ng.a.Lf(this.dld),Ng.a.Lf(this.cld),"{0}");var wa=String.format(this.qwa,Ng.a.Lf(this.altText));w=new D(""===this.buttonText?V.kth:V.nth,
""===this.buttonText?V.lth:V.pth,N.a.gr,wa,w,this.qFb,this.buttonText,jl);w.D2(I);this.buttons[d.toString()]=w;this.ZMe[d.toString()]=I;wa=Ne.g(this.$).Sf(d);wa.domElement.insertBefore(w.domElement,wa.domElement.firstChild)};v.prototype.tgh=function(){for(var d=yl(il.a(this.buttons)),w=d.next();!w.done;w=d.next()){w=w.value;var I=this.buttons[w];I.mda(this.ZMe[w]);eg.a.Fa(I);delete this.buttons[w];this.llc&&I.edj(this.llc);this.klc&&I.ddj(this.klc)}};v.prototype.domElement=function(d){return this.cva(d).domElement};
v.prototype.$1a=function(d){this.cva(d).$1a()};v.prototype.PNb=function(d,w,I){I=void 0===I?!0:I;this.qwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',Ng.a.Lf(this.dld),Ng.a.Lf(this.cld),"{0}");d=String.format(this.qwa,Ng.a.Lf(d));this.cva(w,I).Xcg(d)};v.prototype.LTa=function(d,w,I){this.cva(I,!1).yRj(d,w)};v.prototype.Odg=function(){var d=void 0===d?!1:d;this.qwa=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',
"{0}",Ng.a.Lf(this.cld),"{1}");var w=String.format(this.qwa,void 0,Ng.a.Lf(void 0));this.cva(void 0,d).Xcg(w)};v.prototype.Pdg=function(d,w,I){this.cva(I,!1).xRj(this.svgIconProvider,d,w)};Sk.Object.defineProperties(v.prototype,{jz:{configurable:!0,enumerable:!0,get:function(){return pf.a(this.$).TFa(xe.a.rQi)}},H1b:{configurable:!0,enumerable:!0,get:function(){return xe.a.qQi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return pf.a(this.$).TFa(xe.a.sQi)}}});Object(Hd.a)(v,"OnObjectLaunchButton",
ei.a,[785,3]);var ol=b(83),kl=ol.a;vm(J,kl);J.prototype.dispose=function(){eg.a.Fa(this.hBb);this.hBb=null;kl.prototype.dispose.call(this)};J.prototype.RAa=function(){eg.a.Fa(this.hBb);this.hBb=zi.a.instance.create(Object(Sg.a)(this,this.display,"display"),this.f$h,Ei.a.Xti)};J.prototype.JSa=function(){eg.a.Fa(this.hBb);this.hide()};Object(Hd.a)(J,"LoadingIndicatorBehavior",ol.a,[793,3]);vm(r,J);r.prototype.dispose=function(){this.gBb=null;J.prototype.dispose.call(this)};r.prototype.display=function(){this.Vng(this.gBb)};
r.prototype.hide=function(){this.t7h(this.gBb)};r.prototype.JBg=function(){this.gBb=document.createElement("div");this.domElement.appendChild(this.gBb)};Object(Hd.a)(r,"ShimmerLoadingIndicatorBehavior",J,[]);vm(C,J);C.prototype.dispose=function(){this.DNa=null;J.prototype.dispose.call(this)};C.prototype.display=function(){Rc.DOMElementExtensions.setVisible(this.DNa,!0)};C.prototype.hide=function(){Rc.DOMElementExtensions.setVisible(this.DNa,!1)};C.prototype.IBg=function(){this.DNa=document.createElement("div");
this.DNa.classList.add(wd.a.lrh);var d=document.createElement("div");d.classList.add(wd.a.mrh);this.l5c&&""!=this.l5c&&d.classList.add(this.l5c);var w=0===this.lmf?"":te.a.instance.fa(this.lmf),I=String.format('<div class="'+wd.a.nrh+'">{0}</div>',w);this.lec?(w=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.lec,w),d.innerHTML=w+I):d.innerHTML=I;this.DNa.appendChild(d);this.domElement.appendChild(this.DNa)};Object(Hd.a)(C,"SpinnerLoadingIndicatorBehavior",J,[]);u.prototype.i4c=function(d,
w,I){return new hk.a(d,w,I)};u.prototype.m4b=function(d,w,I,ha,wa,$a,Tb,Ic,pc,vd){return new Gc(d,w,I,ha,wa,$a,Tb,Ic,pc,vd)};u.prototype.H0a=function(d,w,I,ha,wa){return new C(d,w,I,ha,void 0===wa?0:wa)};u.prototype.hgd=function(d){return d.da.Aa(238)||new la(d)};u.prototype.p4b=function(d,w,I,ha,wa,$a,Tb,Ic){return new v(d,w,I,ha,wa,$a,Tb,void 0===Ic?"":Ic)};u.prototype.M3c=function(d,w){return new Q(d,w)};u.prototype.x6g=function(d,w,I,ha){return new U(d,w,I,ha)};u.prototype.P3b=function(d,w,I,
ha){return new ba(d,w,I,ha)};Object(Hd.a)(u,"SharedUIControlsFactory",null,[746]);var pl=bi.a;vm(z,pl);z.prototype.create=function(){ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1)?this.Fb(this.$.da.Aa(12)||new u):this.Fb(new u)};z.ja=function(d){d.da.Ha(477,new z(d))};Object(Hd.a)(z,"SharedUIControlsFactoryServiceFactory",bi.a,[]);var sl=b(1020),ll=bi.a;vm(B,ll);B.prototype.create=function(){var d=this;Fd.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");
sl.a.then(this.R8g(),function(w){d.Fb(w);return!0})};B.prototype.R8g=function(){var d=this;if(this.r4b)return this.r4b;var w=Qi.a.K0a(fh.b(),Dh.a.none,"LoadResource","x10Scheduler loading");if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&Ci.a.Vu){var I=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();this.$.da.Ha(413,I);w.setResult(I);return this.r4b=w.task}this.$.da.Za(266,function(){d.$.da.Za(283,function(ha){var wa=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();
ha=$g.b(Vf.Task.Ta(ha.Un));if(ye.EwaSettings.isChangeGateEnabled("OfficeVSO:6035660_attachX10PluginsOnOouiSide"))excelOnlineCalc.x10.ensureAllPluginsAttached(ha).then(function(){d.$.da.Ha(413,wa);w.setResult(wa)});else{var $a=excelOnlineCalc.x10.ensurePluginAttached(1,ha),Tb=excelOnlineCalc.x10.ensurePluginAttached(4,ha),Ic=excelOnlineCalc.x10.ensurePluginAttached(1E3,ha),pc=excelOnlineCalc.x10.ensurePluginAttached(1002,ha),vd=excelOnlineCalc.x10.ensurePluginAttached(9,ha),ne=excelOnlineCalc.x10.ensurePluginAttached(10,
ha),Pe=excelOnlineCalc.x10.ensurePluginAttached(11,ha),Af=excelOnlineCalc.x10.ensurePluginAttached(12,ha),Wf=excelOnlineCalc.x10.ensurePluginAttached(1004,ha),Of=excelOnlineCalc.x10.ensurePluginAttached(13,ha),xg=excelOnlineCalc.x10.ensurePluginAttached(1006,ha);$a=[$a,Tb,Ic,pc,vd,ne,Af,Wf,Pe,Of,xg];ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5818445_AttachDataTypesExperiment")&&(ha=excelOnlineCalc.x10.ensurePluginAttached(1003,ha),$a.push(ha));Promise.all($a).then(function(){d.$.da.Ha(413,wa);
w.setResult(wa)})}})});return this.r4b=w.task};B.ja=function(d){d.da.Ha(414,new B(d))};Object(Hd.a)(B,"PluginSchedulerFactory",bi.a,[]);var wk=ei.a;vm(t,wk);t.prototype.dispose=function(){this.Jp.dispose();this.$=null;wk.prototype.dispose.call(this)};t.prototype.domElement=function(d){return this.Jp.domElement(d)};t.prototype.getButton=function(d){return this.Jp.getButton(d,!1)};t.prototype.PNb=function(d,w){this.Jp.PNb(d,w,!1)};t.prototype.IAa=function(d,w){var I=Ne.g(this.$),ha=I.$a.oj(d);this.Jp.PNb(w?
te.a.instance.fa(1691):te.a.instance.fa(1692),ha);w=this.isMac?w?te.a.instance.fa(1695):te.a.instance.fa(1696):w?te.a.instance.fa(1693):te.a.instance.fa(1694);var wa=I.pg(d,ha);d=I.Sf(ha).pn;if(wa&&0<=wa.x&&0<=wa.y){var $a=wa.bottomRight.x+this.jz;wa=wa.topLeft.y-this.jz-this.buttonWidth;if(wa<d.topLeft.y+this.jz){if(I.$a.oTa){this.hide();return}wa=d.topLeft.y+this.jz}this.Eo($a,wa,I.rtl,ha);this.ariaLiveNotifier.YPa(w)}else this.hide()};t.prototype.Eo=function(d,w,I,ha){this.Jp.Eo(d,w,I,ha,!1)};
t.prototype.hide=function(){this.Jp.hide()};Sk.Object.defineProperties(t.prototype,{jz:{configurable:!0,enumerable:!0,get:function(){return this.Jp.jz}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.Jp.buttonWidth}}});Object(Hd.a)(t,"PulloutLaunchButton",ei.a,[]);var Xk=ei.a;vm(y,Xk);y.prototype.dispose=function(){this.gridView&&(this.gridView.ha.qda(this.Yh),this.gridView.view.Nq(this.it),this.gridView.yc&&this.gridView.yc.ol(this.fj));if(this.$){var d=this.$;d.pl(this.rd);
d.sn(this.od);d.mD(this.ej);Ne.g(d).pt(this.WR)}this.nh&&this.nh.Csc(this.wya);eg.a.Fa(this.Uh);this.nh=this.$=this.gridView=this.oob=this.Uh=null;Xk.prototype.dispose.call(this)};y.prototype.Mx=function(){this.Uh.hide()};y.prototype.zda=function(){this.Uh?this.Uh.getButton(this.Hea).xbb():Fd.ULS.sendTraceTag(537154142,0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};y.prototype.Dhj=function(){this.s0=null};y.prototype.oKf=function(){this.Uh&&this.Uh.hide()};y.prototype.Y0h=function(){if(!this.Aid||
1!==this.selectedRange.width)return null;for(var d=this.selectedRange.clone();this.gridView.e_(d);){d.left+=1;d.right+=1;if(!this.gridView.Sf(this.gridView.$a.oj(d)).Kh.zf(d))break;if(this.gridView.Ca.es(d)){var w=this.gridView.xl("PulloutManager.GetValidatedRangeToFill",d,2);try{if(y.gWj(w))return d}finally{w&&w.dispose()}}}return null};y.prototype.ytc=function(){this.nh.zbb()};y.prototype.showCallout=function(){var d=this;this.zwa&&(this.nh.Eyb?(this.Uh.getButton(this.Hea).oFb(),ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",
!1)?Od.TaskExtensions.Ba(Rg.GetServiceTaskFactory.Wa(this.$.da,8,9,0),function(w){d.F3f(w.result)},this.$.ma,3):this.F3f(this.contextMenuManager)):(this.cZc=!0,this.DZ()))};y.prototype.F3f=function(d){d.bed("tableFieldList").HO(null,this.Uh.domElement(this.Hea),this.nh,null,!0);this.ytc()};y.prototype.pUe=function(){if(!this.zwa||!this.gridView||this.gridView.ha.Pa.lc||!this.gridView.ha.va.qh)return null;var d=this.gridView.ha.va.activeCell,w=Ne.g(this.$).$a.oj(d);if(!d)return null;this.pFa=d.clone();
var I=this.tableManager.En(d);this.xLc=!!I;if(this.rN){this.Uh.PNb(te.a.instance.fa(1691),w);this.cP=y.Tfg(I);if(!this.cP)return null;w=this.tableManager.gDe(I,this.gridView);d=w.DY;w=w.returnValue||d;this.yEc=d;if(w)return this.Juc=new Bi.Range(I.top,I.left,I.bottom,I.right,!1,!1),this.HNc=new Bi.Range(this.cP.top,this.cP.right+1,this.cP.top,this.cP.right+1,!1,!1),this.cP}else if(this.Aid){this.Uh.PNb(te.a.instance.fa(1692),w);this.AXa=this.gridView.ha.va.Sd.clone();I=Ne.g(this.$).Rb.KMa(this.selectedRange);
this.cP=y.Tfg(this.selectedRange);if(!I||!this.cP||!this.selectedRange||ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.vKa(this.selectedRange))return null;this.HNc=this.Y0h();if((ye.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?this.gridView.e_(this.selectedRange):this.gridView.e_(this.cP))&&this.kya)return this.Juc=this.cP,I=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",
this.kya?this.kya.toString():"null",this.cP?this.cP.toString():"null",d?d.toString():"null"),Fd.ULS.sendTraceTag(537154137,0,50,I),this.cP}return null};y.prototype.DZ=function(){this.rN?this.nh.DZ(td.v(this.kya,this.$),!1,!0):ye.EwaSettings.la(136)&&this.nh.DZ(td.v(this.selectedRange,this.$),!0,!1)};y.prototype.B6a=function(){return this.$.ea.isNamedObjectViewMode&&ef.f(this.$.pa)};y.gWj=function(d){for(;d.$$mn();)if(d.$$cu().text||d.$$cu().NH||d.$$cu().Di||d.ho.o8e)return!1;return!0};y.Tfg=function(d){return d.right===
xe.a.Xh?null:new Bi.Range(d.top,d.right,d.top,d.right,!1,!1)};Sk.Object.defineProperties(y.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return this.Uh.domElement(1)}},kya:{configurable:!0,enumerable:!0,get:function(){return this.HNc}},selectedRange:{configurable:!0,enumerable:!0,get:function(){return this.AXa}},rN:{configurable:!0,enumerable:!0,get:function(){return this.xLc}},VKf:{configurable:!0,enumerable:!0,get:function(){return this.Bee}},OAb:{configurable:!0,enumerable:!0,get:function(){var d=
this.Uh.domElement(this.Hea);return d?Rc.DOMElementExtensions.isVisible(d):!1}},zwa:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&ye.EwaSettings.la(136)?!(new Cf.a(this.$.xa)).Oj:!1}},fIg:{configurable:!0,enumerable:!0,get:function(){return this.yEc}},Hea:{configurable:!0,enumerable:!0,get:function(){return this.kya?this.gridView.$a.oj(this.cP):1}}});Object(Hd.a)(y,"PulloutManager",ei.a,[748,3]);var hl=bi.a;vm(x,hl);x.prototype.create=function(){var d=this;Jh.a.Ga(function(w){var I=
Rg.GetServiceTaskFactory.Wa(w.da,12,477,d.ub),ha=Rg.GetServiceTaskFactory.Wa(w.da,66,134,d.ub),wa=Rg.GetServiceTaskFactory.Wa(w.da,211,212,d.ub),$a=null,Tb=!ye.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1);Tb&&($a=Rg.GetServiceTaskFactory.Wa(w.da,8,9,d.ub));Od.TaskExtensions.Ba(Od.TaskExtensions.ve([I,ha,$a,wa],w.ma),function(){Tb?d.Fb(d.$.da.Aa(261)||new y(d.$,I.result,ha.result,$a.result,wa.result)):d.Fb(d.$.da.Aa(261)||new y(d.$,I.result,ha.result,null,wa.result))},
w.ma)})};x.ja=function(d){d.da.Ha(262,new x(d))};Object(Hd.a)(x,"PulloutManagerFactory",bi.a,[]);var ql=b(386);Object(Hd.a)(f,"GestureAdapterInfo",null,[]);var tl=b(375),rl=b(219);m.prototype.qti=function(){if(!this.pHc){var d="hammer.min.js";zg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseIsServerFlavorAppSetting",!1)&&(d=zg.AFrameworkApplication.ga.ra("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");d=zg.AFrameworkApplication.h7(String.format("{0}",d),5);d=rl.a.create(d,
null,null);tl.a.Kia(d);this.pHc=d.$7a}return this.pHc};Sk.Object.defineProperties(m,{instance:{configurable:!0,enumerable:!0,get:function(){m.Oa||(m.Oa=new m);return m.Oa}}});m.Oa=null;Object(Hd.a)(m,"HammerJsDependencyLoader",null,[787]);var ek;(function(d){d[d.none=-1]="none";d[d.pinch=0]="pinch";d[d.pan=1]="pan";d[d.swipe=2]="swipe"})(ek||(ek={}));Object(Hd.b)("GestureEvent",ek);var Hk=b(70),Yk=Hk.a;vm(n,Yk);n.create=function(d,w,I,ha,wa,$a){if(I.rawEvent)if($a){var Tb=I.rawEvent;Tb=new Sys.UI.Point(Tb.clientX,
Tb.clientY)}else Tb=Hk.a.Jub(I);else Tb=new Sys.UI.Point(I.clientX,I.clientY);return new n(d,Tb,w,I,ha,wa,I.shiftKey,I.ctrlKey,$a)};Sk.Object.defineProperties(n.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.wga}},ctrlKey:{configurable:!0,enumerable:!0,get:function(){return this.OX}},clientPoint:{configurable:!0,enumerable:!0,get:function(){return this.ahb}},Xua:{configurable:!0,enumerable:!0,get:function(){return this.tpg}}});Object(Hd.a)(n,"GestureEventArgs",Hk.a,
[]);Object(Hd.a)(l,"GestureManagerData",null,[]);e.Qjg=2;e.Rjg=4;e.Sjg=8;e.Tjg=8;Object(Hd.a)(e,"HammerConstants",null,[]);var G=b(197),ka=Dd.a;vm(c,ka);c.prototype.nRh=function(){return this.NOc?0:this.Zie?1:2};c.prototype.fn=function(d){ka.prototype.fn.call(this,d);this.Vd.tka(this.WVa,d,0,this.okb)};c.prototype.am=function(d){ka.prototype.am.call(this,d);this.Vd.gIa(d,this.WVa)};c.prototype.v9i=function(d,w,I){var ha=this;I=void 0===I?null:I;var wa=void 0===wa?null:wa;zg.AFrameworkApplication.Ogc()?
m.instance.qti().continueWith(function($a){ha.vGj();if($a.kg||$a.Ih)Fd.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",$a.status);else{Fd.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",$a.status);if(ha.l3d){$a=window.Hammer;if("undefined"===typeof $a){Fd.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");ha.Iyc();return}if("undefined"===typeof $a.inputHandler){Fd.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");ha.Iyc();return}}if(!d)throw ha.Iyc(),
Error.argumentNull("source element can not be null");$a=G.a.uva(d,ha.jqa);if(void 0===$a||null===$a)$a=new We.a,G.a.Ccb(d,ha.jqa,$a),ha.w9i(d);var Tb=null;if(!$a.xb(ek[0])){Tb=Object;var Ic=Tb.assign,pc=new f,vd=ek[0],ne=wa;ne=void 0===ne?null:ne;if(void 0===ha||null===ha)throw Fd.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),Error.argumentNull("manager can not be null");var Pe=null;switch(vd){case sg.a.pinch:Pe=new Hammer.Pinch(ne);break;case sg.a.pan:Pe=new Hammer.Pan(ne)}Pe&&(Pe.manager=
ha);Tb=Ic.call(Tb,pc,{bda:Pe,oXe:w});$a.add(ek[0],Tb)}if(void 0!==I&&null!==I)for(Ic=0;Ic<I.length;Ic++)$a.xb(ek[I[Ic]])&&(pc=$a.oa(ek[I[Ic]]),Tb.bda.recognizeWith(pc.bda))}ha.Iyc()}):Fd.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};c.prototype.vGj=function(){this.dJc&&(this.Ah?this.wRc=this.Ah.Hc("Task","RegisterGestureAdapterAfterLoad"):Fd.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))};c.prototype.Iyc=function(){this.dJc&&
(this.wRc?this.wRc.stop():Fd.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};c.prototype.w9i=function(d){this.upg.add(d);this.Vd.tka(this.WVa,d,0,this.okb)};c.prototype.recognize=function(d){for(var w=Array(d.pointers.length),I=0;I<d.pointers.length;I++)w[I]=d.pointers[I].target;I=null;for(this.Fpa=this.ETh(w);void 0!==this.Fpa&&null!==this.Fpa&&(I=G.a.uva(this.Fpa,this.jqa),void 0===I||null===I);this.Fpa=this.Fpa.parentNode);if(void 0!==I&&null!==I){this.curRecognizer&&
this.curRecognizer.state===e.Tjg&&(this.curRecognizer=null);w=yl(I.keys);for(var ha=w.next();!ha.done;ha=w.next()){ha=I.oa(ha.value);void 0!==ha&&null!==ha&&void 0!==ha.bda&&null!==ha.bda&&(void 0===this.curRecognizer||null===this.curRecognizer||ha.bda===this.curRecognizer||ha.bda.canRecognizeWith(this.curRecognizer))&&ha.bda.recognize(d);var wa=ha.bda.state;this.curRecognizer||e.Qjg!==wa&&e.Rjg!==wa&&e.Sjg!==wa||(this.curRecognizer=ha.bda)}}};c.prototype.emit=function(d,w){if("hammer.input"!==d){this.P8=
!1;w=n.create(d,this.Fpa,w.srcEvent,w,3,this.NOc);var I=G.a.uva(this.Fpa,this.jqa);if(this.yli(d))var ha=0;else if(this.nli(d))ha=1;else if(this.joi(d))ha=2;else{Fd.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}I=I.Gc(ek[ha]).value;void 0!==I&&null!==I&&((I=I.oXe,I.iji())?d.endsWith("start")?this.P8=I.RLi(w):d.endsWith("end")?(I.PLi(w),this.P8=!0):d.endsWith("cancel")?(I.OLi(w),this.P8=!0):d.endsWith("move")&&(this.P8=I.QLi(w)):Fd.ULS.sendTraceTag(42256257,
310,50,"App rejected to perform gesture now : {0}",d))}};c.prototype.get=function(d){return Object(qc.a)(Hammer.Recognizer,d)};c.prototype.ETh=function(d){if(1>d.length)return null;if(1===d.length)return d[0];for(var w=d[0],I=!0,ha=1;ha<d.length;ha++){if(!d[ha])return null;if(w!==d[ha]){I=!1;break}}if(I)return w;w=this.GXe(d[0]);I=0;d=yl(d);for(ha=d.next();!ha.done;ha=d.next()){ha=this.GXe(ha.value);if(w.oa(w.count-1)!==ha.oa(ha.count-1))return null;for(var wa=w.count-2,$a=ha.count-2;wa>=I&&0<=$a;wa--,
$a--)if(w.oa(wa)!==ha.oa($a)){I=wa+1;break}}return w.oa(I)};c.prototype.GXe=function(d){for(var w=new W.a;void 0!==d&&null!==d;d=d.parentNode)w.add(d);return w};c.prototype.n0e=function(d){switch(d){case sg.a.Hf:case sg.a.ssa:return 1;case sg.a.xg:case sg.a.t0b:return 2;case sg.a.ye:case sg.a.Tob:return 4;case sg.a.nAc:case sg.a.GYc:return 8}return 0};c.prototype.Nya=function(d,w,I){d=this.n0e(d);w=this.nSh(I);Hammer.inputHandler(this,d,w);this.P8&&I.preventDefault();return this.P8};c.prototype.N7e=
function(){return 1<this.qT.count};c.prototype.j1b=function(){Fd.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.lmb)for(var d=yl(this.qT),w=d.next();!w.done;w=d.next())this.$Pf(w.value.key);else this.qT=new We.a;this.session=null};c.prototype.$Bg=function(d,w,I){Fd.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",d);if(!this.Kkb.xb(d)){try{w.setPointerCapture(d)}catch(ha){Fd.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",ha)}this.Kkb.add(d,
w)}this.qT.ia(d,I);this.$Ua&&1<this.qT.count&&this.vfa&&!this.vfa.zpb&&(this.vfa.zpb=!0)};c.prototype.$Pf=function(d){Fd.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",d);if(this.Kkb.xb(d)){try{this.Kkb.oa(d).releasePointerCapture(d)}catch(w){Fd.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",w)}this.Kkb.remove(d)}else Fd.ULS.sendTraceTag(594055955,310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",d);this.qT.remove(d);this.$Ua&&1>=this.qT.count&&this.vfa&&
this.vfa.zpb&&(this.vfa.zpb=!1)};c.prototype.Tnc=function(d,w,I){var ha=I.rawEvent.pointerType.toString(),wa=I.rawEvent.pointerId.toString();if("touch"!==ha)return!1;d=this.n0e(d);if(1!==d&&!this.qT.xb(wa))return!1;this.r3d&&1===d&&I.rawEvent.isPrimary&&this.qT.count&&(Fd.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.j1b());this.lmb?this.$Bg(wa,w,I):this.qT.ia(wa,I);this.IMc&&2===d&&(!this.ZFc||this.ZFc&&"function"===typeof I.rawEvent.getCoalescedEvents)&&(w=I.rawEvent.getCoalescedEvents())&&
this.N7e()&&(this.Pjb=Math.max(this.Pjb,w.length));this.pfe&&(this.P8=!1);ha=this.mSh(this.qT,I,ha);Hammer.inputHandler(this,d,ha);if(4===d||8===d)this.lmb?this.$Pf(wa):this.qT.remove(wa),this.qT.count||(this.session=null,this.IMc&&-1!==this.Pjb&&(Fd.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Pjb),this.Pjb=-1));this.P8&&I.preventDefault();return this.P8};c.prototype.Enc=function(){return!1};c.prototype.nSh=function(d){var w=new l,I=d.rawEvent,ha=I.touches;I=I.changedTouches;
w.pointers=Array.clone(ha);w.pointers=Array.clone(0<ha.length?ha:I);w.changedPointers=Array.clone(I);w.srcEvent=d;w.pointerType="touch";return w};c.prototype.mSh=function(d,w,I){var ha=new l;ha.pointers=E.toArray(d.values);ha.changedPointers=[w];ha.pointerType=I;ha.srcEvent=w;return ha};c.prototype.yli=function(d){return Ng.a.startsWith(d,sg.a.pinch)};c.prototype.nli=function(d){return Ng.a.startsWith(d,sg.a.pan)};c.prototype.joi=function(d){return Ng.a.startsWith(d,sg.a.swipe)};Object(Hd.a)(c,"GestureInputManager",
Dd.a,[763,764]);a.prototype.ji=function(d){d.register(c,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").Bc().Lc(function(){return new c(Sj.a.instance,zg.AFrameworkApplication.sa.xD)});this.tb=d};a.prototype.init=function(){this.Ww||(this.tb.resolve("Common.App.GestureManager.GestureInputManager"),this.Ww=!0)};a.prototype.dispose=function(){};a.main=function(){si.a.instance.sj(new a)};Sk.Object.defineProperties(a.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});
Object(Hd.a)(a,"GestureInputManagerPackage",null,[4,5]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");
Type.registerNamespace("_Ewa");Tf.a.$i('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;-ms-touch-action:manipulation;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}');
Jh.a.Ga(nc.ja);Jh.a.Ga(Qc.ja);Type.registerNamespace("Common.App.MultitabControl");Type.registerNamespace("CAUI");Ea.main();Tf.a.$i(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}");
(function(){rf.initData();Jh.a.Ga(function(d){hf.ja(d);xf.ja(d);rf.ja(d);Rf.ja(d)})})();Tf.a.$i(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}");
Tf.a.$i(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}");
Jh.a.Ga(Nd.ja);Jh.a.Ga(wc.ja);Jh.a.Ga(be.ja);Tf.a.$i(".ewa-facp-text-box{position:absolute}");(function(){Jh.a.Ga(function(d){nd.ja(d)})})();(function(){Jh.a.Ga(function(d){ld.ja(d)})})();Jh.a.Ga(fd.ja);Jh.a.Ga(zc.ja);Jh.a.Ga(Zc.ja);Tf.a.$i('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
Jh.a.Ga(jd.ja);Jh.a.Ga(jc.ja);(function(){Jh.a.Ga(function(d){d.da.Ha(150,new Sa(d))})})();(function(){Jh.a.Ga(function(d){Jb.ja(d);Ub.ja(d);H.ja(d)})})();Jh.a.Ga(z.ja);(function(){Jh.a.Ga(function(d){B.ja(d)})})();(function(){Jh.a.Ga(function(d){d.la(136)&&x.ja(d)})})();Type.registerNamespace("Common.App.GestureManager");a.main()},842:function(A,F,b){function a(X,ca,ja,ea,qa,pa,Pa,Ha,Xa,Na,db,Ja){var jb=fa.call(this)||this;jb.Rkc=!1;jb.contextMenuController=null;jb.IIc=null;jb.UFc=null;jb.wod=!1;
jb.t0j=0;jb.s0j=0;jb.$rb=null;jb.Xtc=null;jb.sC=function(){jb.contextMenuController?jb.contextMenuController.sC():c.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");jb.icg()};jb.vb=X;jb.Cqf=qa;jb.NPc=Na;jb.L_j=ja;jb.K_j=ea;jb.r_j=ca;jb.kIf=pa;jb.populateOnlyOnce=Pa;jb.p6h=db;jb.EOf(Ja);return jb}b.d(F,"a",function(){return a});A=b(0);var c=b(13),e=b(892),l=b(88),n=b(23),m=b(865),f=b(844),x=b(995),
y=b(914),t=b(109),B=b(309),z=b(86),u=b(411),C=b(814);F=b(74);var r=b(16),J=b(4),v=b(975),D=b(77),V=b(43),U=b(57),Q=b(141),la=b(119),ba=b(1),T=b(9),H=b(19),S=b(14),K=b(20),da=b(34),fa=F.a;vm(a,fa);a.prototype.Yc=function(X,ca){X=!0;switch(ca){case 1651433993:case 1675506831:case 966232027:X=this.te(4096)||this.te(2048);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:X=this.te(8192)}return!X};a.prototype.fd=function(X,ca,ja){ja.IsShadowMenuOpen||v.h(this.$,v.d);X=!1;ca===this.au&&
(ja.IsShadowMenuOpen||v.h(this.$,v.a),ca=Object.assign(new e.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.QDd(ca,ja.IsShadowMenuOpen),ja.MenuItems=ca,ja.IsShadowMenuOpen||v.h(this.$,v.c),X=!0);X&&this.Rkc&&T.HelperMethods.v0b&&!ja.IsShadowMenuOpen&&v.j(this.$);return X};a.prototype.QDd=function(X,ca){(ca=this.YY(ca))?(this.n$e(ca),Array.addRange(X.MenuSectionList,ca.aC().MenuSectionList),this.sCg(X)):c.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};
a.prototype.YY=function(){c.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.HO=function(X,ca,ja,ea,qa){X=Sys.UI.DomElement.getBounds(ca);ja=new Sys.UI.Point(X.x,X.y+X.height);this.ITa(ja,ca);this.$.isChromeRtl&&(ja.x+=X.width);this.Eo(ja,qa)};a.prototype.Eo=function(X,ca,ja){ja=void 0===ja?0:ja;ca&&(X=da.a(this.$).Oja(X));ca=!0;if(this.p6h){var ea;3===ja?(ea=this.jKa(3))&&0<ea.length?
(ca=!1,this.showFloatie(ea,new Sys.UI.Bounds(X.x,X.y,0,0),ja)):c.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",this.menuId):2===ja&&this.$.isEditMode&&((ea=this.jKa(2))&&0<ea.length?ea[0]!==a.YUe?(ca=!1,this.HRd(ea,new Sys.UI.Bounds(X.x,X.y,0,0),ja)):c.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",
this.menuId):c.ULS.sendTraceTag(537167073,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}ca&&this.showContextMenu(new Sys.UI.Bounds(X.x,X.y,0,0),ja)};a.prototype.jKa=function(){return null};a.prototype.zgd=function(X,ca){var ja="";3===X?ja="touch":2===X&&(ja="mouse");X={};return X.ContextMenuId=this.menuId,X.IsEditMode=this.$.isEditMode,X.IsSLR=!!U.a.Rf&&U.a.Rf.QC,X.IsReactMLR=!!U.a.Rf&&
U.a.Rf.UV,X.IsNov=this.$.ea.isNamedObjectViewMode,X.InputType=ja,X.FloatieGroups=JSON.stringify(void 0===ca?null:ca),X};a.prototype.showContextMenu=function(X,ca){ca=void 0===ca?0:ca;var ja=this.zgd(ca);c.ULS.sendTraceTag(595359709,0,50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",JSON.stringify(ja));this.contextMenuController?this.qB!==J.a.EGd&&this.qB!==J.a.FGd||0===ca?this.contextMenuController.GRd(this.qB,X,D.a.$b):this.contextMenuController.GRd(this.qB,
X,ca):c.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};a.prototype.showFloatie=function(X,ca,ja){var ea=this.zgd(ja,X);c.ULS.sendTraceTag(595359710,0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(ea));this.contextMenuController?(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.KOf(),this.contextMenuController.xxc(X,
ca,ja)):c.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",JSON.stringify(X))};a.prototype.HRd=function(X,ca,ja){var ea=this.zgd(ja,X);c.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(ea));this.contextMenuController?(ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&
this.KOf(),this.contextMenuController.FRd(X,ca,ja,this.qB)):c.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};a.prototype.EOf=function(X){this.contextMenuController=X};a.prototype.dispose=function(){this.$&&this.$.Ka.Rab(this);this.vb=null;ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.icg();this.Xtc&&(l.a.Fa(this.Xtc),this.Xtc=
null);fa.prototype.dispose.call(this)};a.prototype.vHh=function(X){var ca=this.$.da.Aa(204);ca&&(ca=ca.cIh(this.Cqf))&&Array.add(X.zc,ca)};a.prototype.ITa=function(X,ca){X&&ca&&this.$.ea.nc.isDivSyndicated&&n.a.Af&&(ca=ca.ownerDocument.documentElement,X.x-=ca.scrollLeft,X.y-=ca.scrollTop)};a.prototype.te=function(X){return(new Q.a(this.$.xa)).te(X)};a.prototype.n$e=function(X){X=yl(X.zc);for(var ca=X.next();!ca.done;ca=X.next())if(ca=ca.value,Object(u.a)(643,ca)){ca.title&&(ca.title=a.ym(ca.title));
ca=yl(ca.buttons);for(var ja=ca.next();!ja.done;ja=ca.next())ja=ja.value,Object(u.a)(563,ja)?(ja.label=a.ym(ja.label),ja.rS(a.ym(ja.alt))):Object(u.a)(677,ja)&&this.n$e(ja.menu)}};a.prototype.rwd=function(X,ca){ca=void 0===ca?!1:ca;var ja=[];X=yl(X);for(var ea=X.next();!ea.done;ea=X.next())ja.push(this.AU(ea.value,ca));return ja};a.prototype.AU=function(X){for(var ca=[],ja=yl(X.MenuItems),ea=ja.next();!ea.done;ea=ja.next())switch(ea=ea.value,ea.Type){case 3:Array.add(ca,this.g5g(ea));break;case 2:Array.add(ca,
this.L$g(ea));break;case 1:Array.add(ca,this.G6g(ea))}return Object.assign(new m.a,{ControlList:ca,Title:X.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0})};a.prototype.Ucd=function(X,ca){ca=[this.$rb,X.RibbonCommand.toString(),ca||X.Label,X.Disabled?X.Disabled.toString():"False"];var ja=X.CommandData;ja=H.a.hashCode(ja).toString();ca.push(ja,X.Identifier.toString());ca=ca.join("_");X.IsChecked&&(ca+="_Checked");return ca};a.prototype.dIh=
function(X){var ca=[this.$rb,H.a.hashCode(X.Title).toString()];X=yl(X.MenuItems);for(var ja=X.next();!ja.done;ja=X.next())ca.push(ja.value.RibbonCommand.toString());return ca.join("_")};a.prototype.SWe=function(X){var ca=X.Label;ca=H.a.hashCode(ca).toString();ca=[this.$rb,ca];ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&X.Id&&ca.push(H.a.hashCode(X.Id).toString());ca=ca.join("_");X.IsChecked&&(ca+="_Checked");return ca};a.prototype.g5g=function(X){var ca=
this.C$b(X,!1);var ja=ca.label;var ea=ca.rLa;ca=ca.qp;var qa=this.Ucd(X,ja);return Object.assign(new f.a,{Command:X.Disabled?(-251203935).toString():ca.toString(),ExternalId:qa,Id:qa,Image16by16Class:ea,LabelText:ja||X.Label,MenuItemId:X.CommandData,CommandValueId:X.CommandData})};a.prototype.L$g=function(X){var ca=this.C$b(X,X.IsChecked);var ja=ca.label;var ea=ca.rLa;ca=ca.qp;var qa=this.Ucd(X,ja);return Object.assign(new x.a,{Command:X.Disabled?(-251203935).toString():ca.toString(),ExternalId:qa,
Id:qa,Image16by16Class:ea,LabelText:ja||X.Label,MenuItemId:X.CommandData,CommandValueId:X.CommandData,IsChecked:X.IsChecked})};a.prototype.G6g=function(X){var ca=this.cXe(X);var ja=ca.label;ca=ca.rLa;var ea=Object.assign(new e.a,{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(ea.MenuSectionList,this.rwd(X.SubMenu.Sections,!0));var qa=this.SWe(X);X=ja||X.Label;return Object.assign(new y.a,{ExternalId:qa,Id:qa,LabelText:X,PopulateOnlyOnce:!1,Menu:ea,Image16by16Class:ca,ImageIsVisible:!!ca})};
a.prototype.cXe=function(X){X=this.C$b(X,!0);return{label:X.label,rLa:X.rLa,qp:X.qp}};a.prototype.C$b=function(X,ca){var ja=ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled");switch(X.Identifier){case 26:var ea=912804500;ca=r.a.bRe;X=S.a.instance.fa(1899);break;case 3:ea=-1902148570;ca=ca?r.a.kaa:null;X=S.a.instance.fa(1859);break;case 4:ea=-1902148570;ca=ca?r.a.kaa:null;X=S.a.instance.fa(1860);break;case 5:ea=-1902148570;ca=ca?r.a.kaa:null;X=null;break;case 1:ea=-1677817820;
ca=r.a.o8b;X=S.a.instance.fa(231);break;case 2:ea=-1649376918;ca=X.IsChecked?r.a.jaa:null;X=S.a.instance.fa(2062);break;case 23:ea=1701016594;ca=X.IsChecked?r.a.jaa:null;X=S.a.instance.fa(2062);break;case 6:ea=-87741481;ca=null;X=S.a.instance.fa(2063);break;case 7:ea=1948650742;ca=r.a.QPe;X=S.a.instance.fa(1897);break;case 8:ea=1933713114;ca=r.a.PPe;X=S.a.instance.fa(1898);break;case 14:ea=504133448;ca=ja?r.a.h4:ca?r.a.rua:r.a.h4;X=S.a.instance.fa(144);break;case 30:ea=504133448;ca=ja?r.a.h4:ca?r.a.rua:
r.a.h4;X=S.a.instance.fa(148);break;case 32:ea=504133448;ca=ja?r.a.h4:ca?r.a.rua:r.a.h4;X=S.a.instance.fa(150);break;case 34:ea=504133448;ca=ja?r.a.h4:ca?r.a.rua:r.a.h4;X=S.a.instance.fa(152);break;case 27:ea=1701016594;ca=ca?r.a.rua:r.a.h4;X=S.a.instance.fa(144);break;case 15:ea=-798968736;ca=ja?r.a.i4:ca?r.a.sua:r.a.i4;X=S.a.instance.fa(146);break;case 31:ea=-798968736;ca=ja?r.a.i4:ca?r.a.sua:r.a.i4;X=S.a.instance.fa(149);break;case 33:ea=-798968736;ca=ja?r.a.i4:ca?r.a.sua:r.a.i4;X=S.a.instance.fa(151);
break;case 35:ea=-798968736;ca=ja?r.a.i4:ca?r.a.sua:r.a.i4;X=S.a.instance.fa(153);break;case 28:ea=1701016594;ca=ca?r.a.sua:r.a.i4;X=S.a.instance.fa(146);break;case 21:ea=-2058042992;ca=r.a.m2a;X=null;break;case 29:ea=1701016594;ca=r.a.m2a;X=null;break;case 9:ea=1701016594;X=ca=null;break;case 11:ea=-1494291901;X=ca=null;break;case 25:ea=-1045020714;ca=X.IsChecked?r.a.jaa:null;X=null;break;case 13:ea=1701016594;ca=X.IsChecked?r.a.jaa:null;X=S.a.instance.fa(155);break;case 16:ea=1701016594;ca=r.a.aJa;
X=S.a.instance.fa(1035);break;case 17:ea=1701016594;ca=r.a.pua;X=null;break;case 18:ea=1701016594;ca=r.a.oua;X=null;break;case 19:ea=1701016594;ca=r.a.l2a;X=S.a.instance.fa(1040);break;case 20:ea=1701016594;ca=r.a.N9c;X=S.a.instance.fa(1041);break;case 24:ea=1675506831;ca=ja?null:X.IsChecked?r.a.jaa:null;X=null;break;case 22:ea=X.RibbonCommand;ca=X.IsChecked?ja?r.a.kaa:r.a.jaa:null;X=null;break;case 36:ea=1461300262;ca=null;X=S.a.instance.fa(154);break;default:c.ULS.shipAssertTag(537167069,0,!1,"Unable to map menu item: {0}",
JSON.stringify(X)),ea=1461300262,X=ca=null}return{label:X,rLa:ca,qp:ea}};a.prototype.sCg=function(X){if(!this.$.ea.amIAlone){var ca=this.$.da.Aa(25);if((void 0!==ca&&null!==ca||!ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!t.a.isEmpty(ca.KBa)&&(ca=ca.m1h(),!B.a.oi(ca))){var ja=[];z.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").c9g(ca,ja);Array.addRange(X.MenuSectionList,ja)}}};a.prototype.KOf=function(){this.wod||(this.$tb&&this.$tb.VYb(this.sC),
this.Gpb&&this.Gpb.VYb(this.sC),this.wod=!!this.$tb||!!this.Gpb)};a.prototype.icg=function(){this.$tb&&this.$tb.Gsc(this.sC);this.Gpb&&this.Gpb.Gsc(this.sC);this.wod=!1};a.Ffc=function(X,ca){ca=V.C(ca);X=K.g(X).Ca.W3a(ca);return!(null===X||void 0===X||!X.ik)};a.uac=function(X,ca,ja){ca=V.C(ca);var ea=K.g(X).Ca.W3a(ca);ca=K.g(X).getCellBounds(ea);var qa=ea.fNg;ea=ea.eNg;var pa=ca.x+qa.x;ca=ca.y+qa.y;ja&&ba.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(K.g(X).rtl||(pa+=
ea),ca-=ea);return new Sys.UI.Point(pa,ca)};a.gzh=function(X){try{Object(C.a)(X.CommandValueId)}catch(ca){}};a.ym=function(X){var ca=a.Rta.parseFromString(X,"text/html");return ca?ca.body.innerText:(c.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),X)};Sk.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.Xtc}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},Sa:{configurable:!0,enumerable:!0,get:function(){return this.NPc}},
menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.Ib+this.Cqf}},$tb:{configurable:!0,enumerable:!0,get:function(){this.IIc||(this.IIc=la.a(this.$));return this.IIc}},Gpb:{configurable:!0,enumerable:!0,get:function(){this.UFc||(this.UFc=K.g(this.$).yc);return this.UFc}}});a.Rta=new DOMParser;a.YUe="Unsupported";Object(A.a)(a,"ContextMenuBase",F.a,[188,789,3])},902:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);a.iNe="ewa-ac";a.Tmh="ewa-ac-param";a.sOe="ewa-function-help-link";
a.C9c="ewa-lb";a.WNe="ewa-fb-refactor";a.listItem="list-item";a.YAb="list-item-selected";a.bBb="list-table-touch";a.aBb="list-table";a.cuh="ewa-suggested-cell-name";a.n_g="columnName-header";a.pPe="ewa-tt";a.Rqh="ewa-function-link-container";a.tOe="ewa-function-udf-name";a.rtl="rtl";Object(A.a)(a,"CssClassNames",null,[])},938:function(A,F,b){function a(fa,X,ca){this.fQb=null;this.PF={};this.VQb=this.cx=null;m.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=fa;this.v4d=
a.X5c;this.w4d=a.borderStyleSolidLine;this.Gh=X;this.Sa=ca;C.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ha(296,this);this.UU=new c(this.$,this.Gh);this.RC=C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);m.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}","296")}function c(fa,X){var ca=this;this.GFb=this.ribbonCommandInfo=this.cellFormat=this.Sr=this.Nb=this.ha=null;
this.Hrc=!1;this.AJf=this.ELa=this.KJf=this.k8d=this.mza=this.Dma=null;this.o0b=this.Yta=this.IJf=0;this.borderStyle=this.XZa=this.borderColor=null;this.dB=!1;this.$4b=this.W$a=null;this.p0=function(){if(!ca.dB||K.g(ca.$).kz)ca.dB=!1,K.g(ca.$).kz=!1,ca.Yta=0,K.g(ca.$).Hh.hu(y.a.Zaa),1===ca.$.Ka.pH()&&(K.g(ca.$).wV(J.a.clone(ca.KJf),ca.IJf,ca.$.pa?ca.$.pa.sheetName:null,null,ca.AJf.clone(),null,null,0,S.a.jih,!0),K.g(ca.$).L0(!0)),ca.wv(),ca.vXd(),ca.un(),ca.Hrc=!1,ca.Dma=null,ca.mza=null,ca.Sr&&(ca.Sr.cancel(),
ca.Sr.dispose()),m.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=function(ja){try{if(ja=ca.He(ja),K.g(ca.$).kz=!0,ca.Dma={},ca.mza={},ca.W$a=null,ca.Yob(ca.o0b),2===ja.yb){var ea=K.g(ca.$).ha.xr(ja.clientPoint,ja.Tb,5,void 0,void 0,!1);ea&&(ca.ELa=ea,ca.$4b=ea,ca.e9i())}}catch(qa){K.g(ca.$).kz=!1}return!0};this.qj=function(ja){try{ja=ca.He(ja);var ea=K.g(ca.$).ha.xr(ja.clientPoint,ja.Tb,5,void 0,void 0,!1),qa=K.g(ca.$).Ca.es(ea);if(!ca.GFb||
qa&&(qa.rK!==ca.GFb.rK||qa.qK!==ca.GFb.qK))if(ca.dB=!0,ca.GFb=qa,ea){var pa=new Q.Range(ca.ELa.top,ca.ELa.left,ca.ELa.top,ca.ELa.left,!0,!1);pa.union(ea);pa=K.g(ca.$).ha.NWh(pa);ca.s0b(ea);ca.mUf(ca.W$a,pa);if(ca.bottomRightCorner(pa.bottom,pa.right))return m.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;var Pa=new Q.Range(pa.top,pa.left,pa.bottom+1,pa.right+1,!0,!1),Ha=K.g(ca.$).N$("DrawBorderBehavior.OnPointerMove",
[Pa]);if(ca.Dma&&ca.mza)for(;Ha.$$mn();){var Xa=Ha.$$cu(),Na=Xa.cell.getRange().toString();Na in ca.Dma&&1!==ca.Yta||(ca.Dma[Na]=Xa,ca.mza[Na]=Xa.cell.eva())}ca.W$a=Pa;ca.$4b=pa;K.g(ca.$).wV([pa],0,ca.$.pa.sheetName,null,pa.topLeft,null,null,0,S.a.gih,!0);ca.Gh.$da(K.g(ca.$),-1690267012,ca.cellFormat,!0,null,[pa])}return!0}catch(db){return K.g(ca.$).kz=!1}};this.Og=function(ja){ja=ca.He(ja);(ja=K.g(ca.$).ha.xr(ja.clientPoint,ja.Tb,5,void 0,void 0,!1))?ca.dB&&(ca.s0b(ja),ca.ELa.union(ja),3===ca.Yta?
ca.Yob(0):ca.Yob(ca.o0b),K.g(ca.$).wV([ca.ELa],0,ca.$.pa.sheetName,null,null,null,null,0,S.a.hih,!0),ca.Gh.formatCells(-1690267012,ca.cellFormat,ca.ribbonCommandInfo)):(3===ca.Yta?ca.Yob(0):ca.Yob(ca.o0b),K.g(ca.$).wV([ca.$4b],0,ca.$.pa.sheetName,null,null,null,null,0,S.a.iih,!0),ca.Gh.formatCells(-1690267012,ca.cellFormat,ca.ribbonCommandInfo));ca.dB=!1;ca.vXd();ca.Dma=null;ca.mza=null;return!0};this.onKeyDown=function(ja){ja=ca.He(ja);if(ca.dB||Array.contains([17,16,18,20],ja.Ea.keyCode))return!0;
ca.p0();return!1};this.onKeyUp=function(ja){ja=ca.He(ja);if(ja.Ea.keyCode===v.a.LL&&ca.dB)return ca.dB=!1,ca.mUf(ca.W$a,ca.$4b,!0),ca.vXd(),!0;if(ca.dB||ja.Ea.keyCode===v.a.LBa||ja.Ea.keyCode===v.a.Y0d||ja.Ea.keyCode===v.a.X0d||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],ja.Ea.keyCode)||ja.Ea.keyCode===v.a.skg||ja.Ea.keyCode===v.a.okg||ja.Ea.keyCode===v.a.kkg)return!0;ca.p0();return!1};this.J_=function(ja,ea){K.g(ca.$).kz&&!Array.contains(ca.l9h,ea.ae.command)&&(m.ULS.sendTraceTag(537159512,
0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",ea.ae),ca.p0())};this.$=fa;this.Gh=X}function e(fa){fa.UOf()}function l(){this.iconName=this.title=this.key=null}function n(fa,X,ca,ja,ea,qa,pa,Pa){this.Qlg=fa;this.Rlg=X;this.Plg=ca;this.NP=ja;this.Zwg=ea;this.htg=qa;this.zjb=pa;this.dsg=Pa}b.r(F);A=b(0);var m=b(13),f=b(947),x=b(849),y=b(4),t=b(77),B=b(53),z=b(215),u=b(32),C=b(1),r=b(14);n.cQg=function(){return new n("BorderStyleSolidLine",1903,1,"1","",1,8,0)};n.ZPg=
function(){return new n("BorderStyleDashedLine",1904,3,"1","5,3",1,8,0)};n.$Pg=function(){return new n("BorderStyleDottedLine",1905,4,"1","1,1",1,8,0)};n.bQg=function(){return new n("BorderStyleMediumLine",1906,2,"2","",1,8,0)};n.dQg=function(){return new n("BorderStyleThickLine",1907,5,"3","",1,8,0)};n.aQg=function(){return new n("BorderStyleDoubleLine",1908,6,"1","",2,8,3)};Sk.Object.defineProperties(n.prototype,{Due:{configurable:!0,enumerable:!0,get:function(){return this.Qlg}},m0b:{configurable:!0,
enumerable:!0,get:function(){return this.Rlg}},Cue:{configurable:!0,enumerable:!0,get:function(){return this.Plg}},width:{configurable:!0,enumerable:!0,get:function(){return this.NP}},BHj:{configurable:!0,enumerable:!0,get:function(){return this.Zwg}},XFi:{configurable:!0,enumerable:!0,get:function(){return this.htg}},lineHeight:{configurable:!0,enumerable:!0,get:function(){return this.zjb}},Ssi:{configurable:!0,enumerable:!0,get:function(){return this.dsg}}});Object(A.a)(n,"BorderLineStyleProperties",
null,[]);Object(A.a)(l,"BorderLineStyleProps",null,[]);e.prototype.getBorderLineStyleProps=function(){var fa=b(938).BorderFormatManager.WZa,X=Array(Object.keys(fa).length),ca=0,ja;for(ja in fa){var ea=ja,qa=fa[ja];X[ca]=new l;X[ca].key=ea;ea=qa;X[ca].title=r.a.instance.fa(ea.m0b);X[ca].iconName=ea.Due;ca++}return X};Object(A.a)(e,"BorderMenuController",null,[786]);var J=b(309),v=b(91),D=b(169),V=b(12),U=b(117),Q=b(24),la=b(44),ba=b(42),T=b(201),H=b(9),S=b(105),K=b(20),da=b(34);c.prototype.Ezg=function(fa){m.ULS.sendTraceTag(537159517,
0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");this.ha=K.g(this.$).ha;this.Nb=K.g(this.$).Nb;this.ribbonCommandInfo=fa;this.KJf=J.a.clone(this.ha.va.selectedRanges);this.IJf=this.ha.va.aB;this.AJf=this.ha.va.activeCell.clone();this.Nb&&this.Nb.bkd();this.hv();this.cl()};c.prototype.dispose=function(){this.p0();this.GFb=this.ribbonCommandInfo=this.cellFormat=null};c.prototype.Yob=function(fa){var X=b(938).BorderFormatManager;this.cellFormat={};var ca={};this.borderColor=this.borderColor||
X.X5c;var ja=z.a.lH(this.borderColor,!1);ca.Color=[ja,ja,ja,ja];C.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.XZa&&(ca.ThemeBorderColor=[this.XZa,this.XZa,this.XZa,this.XZa],ca.ColorTypeOption=1);ja=b(938).BorderFormatManager.WZa;this.borderStyle=this.borderStyle||X.borderStyleSolidLine;X=ja[this.borderStyle].Cue;ca.LineStyle=[X,X,X,X];this.cellFormat.BorderFormat=ca;this.cellFormat.ValidMembers=128;this.cellFormat.Border=fa};c.prototype.hv=function(){for(var fa=
yl(K.g(this.$).nn),X=fa.next();!X.done;X=fa.next())D.a.instance.qa(V.a.pointerDown,X.value.domElement,this.onPointerDown);U.KeyInputManager.instance.qa(V.a.Sb,document.documentElement,this.onKeyDown);U.KeyInputManager.instance.qa(V.a.Wd,document.documentElement,this.onKeyUp)};c.prototype.e9i=function(){for(var fa=yl(K.g(this.$).nn),X=fa.next();!X.done;X=fa.next())X=X.value,D.a.instance.qa(V.a.fh,X.domElement,this.qj),D.a.instance.qa(V.a.Yd,X.domElement,this.Og);D.a.instance.qa(V.a.Yd,document.documentElement,
this.Og);D.a.instance.qa(V.a.hy,document.documentElement,this.Og);this.Hrc=!0};c.prototype.wv=function(){try{for(var fa=yl(K.g(this.$).nn),X=fa.next();!X.done;X=fa.next())D.a.instance.za(V.a.pointerDown,X.value.domElement,this.onPointerDown);U.KeyInputManager.instance.za(V.a.Sb,document.documentElement,this.onKeyDown);U.KeyInputManager.instance.za(V.a.Wd,document.documentElement,this.onKeyUp)}catch(ca){K.g(this.$).kz=!1,m.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",
ca)}};c.prototype.vXd=function(){if(this.Hrc)try{this.Hrc=!1;for(var fa=yl(K.g(this.$).nn),X=fa.next();!X.done;X=fa.next()){var ca=X.value;D.a.instance.za(V.a.fh,ca.domElement,this.qj);D.a.instance.za(V.a.Yd,ca.domElement,this.Og)}D.a.instance.za(V.a.Yd,document.documentElement,this.Og);D.a.instance.za(V.a.hy,document.documentElement,this.Og)}catch(ja){K.g(this.$).kz=!1,m.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",
ja)}};c.prototype.cl=function(){this.$.xa.Qf(this.p0);K.g(this.$).yc.Yl(this.p0);K.g(this.$).cE(this.p0);this.$.Ka.CFa(this.J_)};c.prototype.un=function(){this.$.xa.ug(this.p0);K.g(this.$).yc.ol(this.p0);K.g(this.$).UF(this.p0);this.$.Ka.uQa(this.J_)};c.prototype.mUf=function(fa,X,ca){ca=void 0===ca?!1:ca;if(fa&&this.Dma&&this.mza)for(fa=K.g(this.$).N$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[fa]);fa.$$mn();){var ja=fa.$$cu().cell.getRange();if(ca||!X.contains(ja)||1===this.Yta){ja=ja.toString();
var ea=u.a.Gc(this.Dma,ja);if(ea){var qa=u.a.Gc(this.mza,ja);this.setBorders(ea,qa);delete this.Dma[ja];delete this.mza[ja]}}}};c.prototype.setBorders=function(fa,X){var ca=fa.cell,ja=ca.getRange();ca.Xrc();ja.right!==this.W$a.right&&(ca=new Q.Range(ja.top,ja.left-1,ja.bottom,ja.left-1,!0,!1),K.g(this.$).Ca.es(ca).rId(3));ja.bottom!==this.W$a.bottom&&(ca=new Q.Range(ja.top-1,ja.left,ja.top-1,ja.right,!0,!1),K.g(this.$).Ca.es(ca).rId(1));if(null===X||void 0===X?0:X.Borders.length){var ea={};ca=0;for(var qa=
Array(4),pa=Array(4),Pa=0;4>Pa;Pa++)qa[Pa]=1,pa[Pa]=0;X=yl(X.Borders);for(Pa=X.next();!Pa.done;Pa=X.next()){Pa=Pa.value;var Ha=Pa.BorderPosition;qa[Ha]=Pa.BorderLineStyle;var Xa=new T.a(Pa.Color.Red,Pa.Color.Green,Pa.Color.Blue);pa[Ha]=Xa.DS();ca|=H.HelperMethods.s3a(Pa.BorderPosition)}ea.LineStyle=qa;ea.Color=pa;ea={BorderFormat:ea};ea.Border=ca;this.Gh.otj(fa,ea,ja)}};c.prototype.s0b=function(fa){var X=this,ca=new Q.Range(Math.max(1,fa.top-1),Math.max(1,fa.left-1),fa.bottom+1,fa.right+1,!1,!1);
K.g(this.$).Cba(ca)||this.Sr&&this.Sr.fp||(this.Sr=la.a.instance.create(function(){K.g(X.$).Rt(ca,60,S.a.eih)},40,ba.a.fih))};c.prototype.bottomRightCorner=function(fa,X){return 1048576<=fa||16384<=X?!0:!1};c.prototype.He=function(fa){return da.a(this.$).He(fa)};Sk.Object.defineProperties(c.prototype,{l9h:{configurable:!0,enumerable:!0,get:function(){return this.k8d||(this.k8d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,
-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(A.a)(c,"DrawBorderBehavior",null,[3]);b.d(F,"BorderFormatManager",function(){return a});a.prototype.m6e=function(fa,X){m.ULS.sendTraceTag(537159564,0,50,"HandleBorderCommand : Begin handling, Command being executed: {0}",X.command.toString());var ca={},ja={};var ea=z.a.lH(this.x3,!1);ja.Color=[ea,ea,ea,ea];this.RC&&this.tta&&(ja.ThemeBorderColor=[this.tta,this.tta,this.tta,this.tta],ja.ColorTypeOption=1);fa=-600086683===
X.command?"OutsideBorders":fa[t.a.ld];ja.LineStyle=u.a.Gc(a.OIf,fa);ja.LineStyle?m.ULS.sendTraceTag(537159562,0,50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",fa):(ea=a.WZa[this.LHa].Cue,ja.LineStyle=[ea,ea,ea,ea],m.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",this.LHa));ea=u.a.Tn(a.bPg,fa,0);m.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",
fa,this.x3);ca.BorderFormat=ja;4!==ea&&8!==ea||!this.$.pa.displayRtl||(ea=4===ea?8:4);ca.ValidMembers=128;ca.Border=ea;this.Gh.formatCells(-1690267012,ca,X);m.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",X.command.toString());return!0};a.prototype.Iid=function(fa,X,ca){m.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",fa.toString(),this.x3);if(this.RC){if((X.SqmControlId||"").includes("ThemeColorPicker")){var ja=
this.themesManager.getThemeColor(X.Color);var ea=ja.themeIndex;var qa=ja.iBa;ja.returnValue?(this.VQb={},this.tta.ThemeColorIndex=ea,this.tta.ThemeColorRow=qa):this.VQb=null}else this.VQb=null;this.UU.XZa=this.tta}this.v4d=-1803452024===fa?a.X5c:X.Color;this.UU.borderColor=this.x3;this.zLe(ca);this.$.If();m.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",fa.toString(),this.x3);return!0};a.prototype.M4h=function(fa){m.ULS.sendTraceTag(537159559,
0,50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var X=this.Sa.Lp(),ca=this.Sa.Mc();X.zc.push(ca);var ja=this.Sa.GA("StyleDashGallery",1,"Size120by20");ca.buttons.push(ja);ca=a.WZa;for(var ea in ca){var qa=ea,pa=ca[ea],Pa=r.a.instance.fa(pa.m0b);ja.Bt(qa,-2118943501,"QueryBorderStyle",pa.m0b,qa,qa,void 0,void 0,Pa)}m.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");fa.MenuItems=X.aC();m.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};
a.prototype.n3h=function(fa,X){m.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",this.LHa);fa=fa[t.a.ld];if(a.cpi(fa))this.w4d=fa,m.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.LHa);else return m.ULS.sendTraceTag(537159553,0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",fa),!0;this.UU.borderStyle=this.LHa;this.zLe(X);this.$.If();m.ULS.sendTraceTag(40944220,
0,50,"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.LHa);return!0};a.prototype.Nid=function(fa){m.ULS.sendTraceTag(537159552,0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",fa.command.toString());this.wTc(fa,64,this.x3,86,1);return!0};a.prototype.Oid=function(fa){m.ULS.sendTraceTag(537159523,0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",fa.command.toString());this.wTc(fa,112,this.x3,87,2);return!0};
a.prototype.B6e=function(fa){m.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",fa.command.toString());this.wTc(fa,112,"white",88,3);return!0};a.prototype.P4h=function(fa){this.Yrj(this.cPg,fa,fa.MenuItemId?fa.MenuItemId:a.borderStyleSolidLine)};a.prototype.Yrj=function(fa,X,ca){ca in fa?(fa=fa[ca],m.ULS.sendTraceTag(537159521,0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",ca),this.$rj(X,fa)):m.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",
ca)};a.prototype.$4h=function(fa,X){var ca=fa[t.a.ld];return"DrawBorder"===ca?this.Nid(X):"DrawBorderGrid"===ca?this.Oid(X):"EraseBorder"===ca?this.B6e(X):this.m6e(fa,X)};a.prototype.UOf=function(){this.fQb||this.eQg()};a.prototype.dLh=function(){return new e(this)};a.prototype.eQg=function(){this.fQb={};var fa=0,X=a.WZa,ca={},ja;for(ja in X){ca.Rea=X[ja];var ea=ca.Rea.Due;r.a.instance.fa(ca.Rea.m0b);var qa=function(pa){return function(){return appChrome.buildBorderStyleIconNew(pa.Rea.BHj,pa.Rea.width,
pa.Rea.XFi,pa.Rea.lineHeight,pa.Rea.Ssi)}}(ca);this.fQb[ea]=ea;this.Jab(ea,qa);fa++;ca={Rea:ca.Rea}}};a.prototype.Jab=function(fa,X){if(!(fa in this.PF)){var ca={};X=X();ca[fa]=X;appChrome.api.registerIconProvider(function(){return ca});this.PF[fa]=!0}return fa};a.prototype.$rj=function(fa,X){fa.MenuItemId&&(fa[f.a.On]=fa.MenuItemId===this.LHa,fa[x.a.Icon]=X)};a.prototype.wTc=function(fa,X,ca,ja,ea){m.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");
this.aXg(fa,ea)?(m.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.UU.p0()):(K.g(this.$).kz&&this.UU.p0(),B.a.current&&(ja=String.format(y.a.yta,B.a.current.ro(ja)),K.g(this.$).Hh.hu(ja)),this.UU.o0b=X,this.UU.borderColor=ca,K.g(this.$).kz=!0,this.UU.Ezg(fa),this.UU.Yta=ea)};a.prototype.zLe=function(fa){if(fa)switch(this.UU.Yta){case 2:this.Oid(fa);break;default:this.Nid(fa)}};a.prototype.aXg=function(fa,X){return this.UU.Yta===
X&&-236759591!==fa.command&&-2118943501!==fa.command?!0:!1};a.cpi=function(fa){return fa?fa in a.OIf||fa in a.WZa:!1};Sk.Object.defineProperties(a.prototype,{LHa:{configurable:!0,enumerable:!0,get:function(){return this.w4d}},x3:{configurable:!0,enumerable:!0,get:function(){return this.v4d}},tta:{configurable:!0,enumerable:!0,get:function(){return this.VQb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.cx||(this.cx=this.$.da.Aa(422));return this.cx}},cPg:{configurable:!0,enumerable:!0,
get:function(){this.UOf();return this.fQb}}});Sk.Object.defineProperties(a,{WZa:{configurable:!0,enumerable:!0,get:function(){var fa={};return a.x2d||(a.x2d=(fa.BorderStyleSolidLine=n.cQg(),fa.BorderStyleDashedLine=n.ZPg(),fa.BorderStyleDottedLine=n.$Pg(),fa.BorderStyleMediumLine=n.bQg(),fa.BorderStyleThickLine=n.dQg(),fa.BorderStyleDoubleLine=n.aQg(),fa))}},bPg:{configurable:!0,enumerable:!0,get:function(){var fa={};return a.w2d||(a.w2d=(fa.NoBorder=0,fa.BottomBorder=1,fa.TopBorder=2,fa.LeftBorder=
4,fa.RightBorder=8,fa.OutsideBorders=64,fa.AllBorders=112,fa.ThickOutsideBorders=64,fa.InsideBorders=48,fa.InsideHorizontalBorders=16,fa.InsideVerticalBorders=32,fa.BottomDoubleBorder=1,fa.ThickBottomBorder=1,fa.TopBottomBorder=3,fa.TopThickBottomBorder=3,fa.TopDoubleBottomBorder=3,fa))}},OIf:{configurable:!0,enumerable:!0,get:function(){var fa={};return a.fee||(a.fee=(fa.ThickOutsideBorders=[2,2,2,2],fa.BottomDoubleBorder=[1,6,1,1],fa.ThickBottomBorder=[1,2,1,1],fa.TopBottomBorder=a.Bch,fa.TopThickBottomBorder=
[1,2,1,1],fa.TopDoubleBottomBorder=[1,6,1,1],fa))}}});a.w2d=null;a.x2d=null;a.fee=null;a.X5c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.Bch=[1,1,1,1];Object(A.a)(a,"BorderFormatManager",null,[765])},975:function(A,F,b){function a(J,v,D){window.performance.measure(J,v,D);v=window.performance.getEntriesByName(J);v.length||y.ULS.sendTraceTag(537167063,0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",J);return v[v.length-1]?v[v.length-1].duration:-1}function c(){if(t.a.Vob){var J=
a("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),v=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),D=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");y.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",J,v,D)}}function e(J,v){C.HelperMethods.JYc&&window.performance.mark(v)}function l(J){J=r.g(J).ha.va;return J.qh&&(J.Sd.isRow||J.Sd.Sh)}function n(J){return J.Rb.Ska(J.ha.va.activeCell)}
function m(J,v,D,V,U){J=V.xl("ContextMenuHelper.FindFirstCellInViewportArea",J,v,D);try{for(J.$$rst();J.$$mn();){var Q=J.$$cu();if(Q&&f(Q,V,U))return Q.cell}}finally{J&&J.dispose()}return null}function f(J,v,D){var V=v.rtl,U=D.isChromeRtl;J=J.cell;return(D=r.g(D).aK(J))?(D=D.topLeft,V=D.x+=V===U?J.offsetWidth:0,U=D.y+=J.offsetHeight,v.view.visibleArea.contains(new z.a(V,U,0,0))):!1}function x(J,v){var D=J.uc(null);if((null===D||void 0===D?0:D.cell.ik)&&f(D,J,v))return J.getCellBounds(D.cell);D=J.ha.va.activeCell;
return(v=m(new u.Range(D.top,D.left,B.a.Lh,D.left,!1,!1),2,!0,J,v)||m(new u.Range(1,D.left,D.top,D.left,!1,!1),2,!1,J,v)||m(new u.Range(D.top,D.right,D.top,B.a.Xh,!1,!1),1,!0,J,v)||m(new u.Range(D.top,1,D.top,D.right,!1,!1),1,!1,J,v)||null)&&v.ik?J.getCellBounds(v):Sys.UI.DomElement.getBounds(J.Z4a.Jb)}b.d(F,"i",function(){return"ContextMenuPerf.A"});b.d(F,"b",function(){return"ContextMenuPerf.B"});b.d(F,"d",function(){return"ContextMenuPerf.C1"});b.d(F,"a",function(){return"ContextMenuPerf.C2"});
b.d(F,"c",function(){return"ContextMenuPerf.D"});b.d(F,"e",function(){return x});b.d(F,"f",function(){return n});b.d(F,"g",function(){return l});b.d(F,"h",function(){return e});b.d(F,"j",function(){return c});var y=b(13),t=b(314),B=b(8),z=b(58),u=b(24),C=b(9),r=b(20)},976:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.cNg="AutoFill";a.Xjj="RowOperations";a.o_g="ColumnOperations";a.mXj="ViewModeRowOperations";
a.lXj="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.kwj="ShapeStyle";a.bEh="FloatingObjectClipboard";a.NHf="PivotTableCopyDelete";a.PHf="PivotTableFieldListActions";a.Jxe="CellFloatie";a.gwj="ShapeFloatie";a.contextMenu="ContextMenu";a.x2h="GridContextMenu";a.DZi="PivotTableContextMenu";a.cEh="FloatingObjectContextMenu";a.eWg="CellRTEFloatie";a.w1f="ShapeRTEFloatie";Object(A.a)(a,"FloatieGroupIdentifiers",null,[])},977:function(A,F,b){function a(t,B,z){var u=
y.call(this,B)||this;u.BR=!1;u.zjc=!1;u.xNa=null;u._selectedRowListBox=null;u.Jn=null;u.Jzf=function(C){return u.onc(C)};u.NAd=function(C){f.g(C.Ea);u.raiseEvent(a.v4a);u.raiseEvent(a.mOd);return!0};u.onScroll=function(C){f.g(C);u.hGd();u.raiseEvent(a.v4a)};u.onBlur=function(C){f.g(C);u.hGd()};u.onPointerDown=function(){u.hGd();u.raiseEvent(a.v4a);u.raiseEvent(a.yPa);return!1};u.CDb=function(C){var r=C.Ea;if(r.button===Sys.UI.MouseButton.leftButton||r.button===Sys.UI.MouseButton.rightButton)u.Mk=
u.gac(r),u.onPointerDown(C);u.raiseEvent(a.Qrd);return!1};u.vb=t;u.XAb=z;u.WAa(!0);return u}b.d(F,"a",function(){return a});A=b(0);var c=b(88),e=b(275),l=b(12),n=b(169);F=b(230);var m=b(11),f=b(69),x=b(20),y=F.a;vm(a,y);a.prototype.L9=function(t){this.get_events().addHandler(a.v4a,t)};a.prototype.nda=function(t){this.get_events().removeHandler(a.v4a,t)};a.prototype.TYb=function(t){this.get_events().addHandler(a.Rkd,t)};a.prototype.Esc=function(t){this.get_events().removeHandler(a.Rkd,t)};a.prototype.Bnb=
function(t){this.get_events().addHandler(a.mOd,t)};a.prototype.vHb=function(t){this.get_events().removeHandler(a.mOd,t)};a.prototype.MYa=function(t){this.get_events().addHandler(a.yPa,t)};a.prototype.ebb=function(t){this.get_events().removeHandler(a.yPa,t)};a.prototype.gVc=function(t){this.get_events().addHandler(a.Qrd,t)};a.prototype.sJd=function(t){this.get_events().removeHandler(a.Qrd,t)};a.prototype.dispose=function(){this.J7(!1);this.WAa(!1);c.a.rc([this.xNa]);this.xNa=null;y.prototype.dispose.call(this)};
a.prototype.gac=function(t){return m.DOMElementExtensions.Med(t.target,"tr",!0)};a.prototype.jB=function(t){if(t){if(!this.Mk){var B=this.Jn;if(!B||!B.rows.length)return;this.Mk=B.rows[0];0<t?t--:t++}B=this.Mk;for(var z=0,u=Math.abs(t);z<u;z++)if(0>t){if(!B.previousSibling)break;B=B.previousSibling}else{if(!B.nextSibling)break;B=B.nextSibling}B&&(this.Mk=B)}};a.prototype.enb=function(t,B){m.DOMElementExtensions.toggleCssClass(t,this.XAb.ListTableClassInTouch,B)};a.prototype.J7=function(t){var B=this.Jn;
B&&(t&&!this.zjc?(e.a.instance.qa(l.a.click,B,this.Jzf),e.a.instance.qa(l.a.hk,B,this.NAd),n.a.instance.qa(l.a.pointerDown,B,this.CDb),this.zjc=!0):this.zjc&&(e.a.instance.za(l.a.click,B,this.Jzf),e.a.instance.za(l.a.hk,B,this.NAd),n.a.instance.za(l.a.pointerDown,B,this.CDb),this.zjc=!1))};a.prototype.oBa=function(t){var B=null;t&&(B=m.DOMElementExtensions.Bj(t,this.XAb.ListCellClass))&&B.classList.toggle(this.XAb.ListCellSelectedClass);return B};a.prototype.WAa=function(t){this.gg&&(t&&!this.BR?
(this.xNa=this.Pd.Dd(this.gg),this.xNa.ja("scroll",this.onScroll),this.xNa.ja("blur",this.onBlur),n.a.instance.qa(l.a.pointerDown,this.domElement,this.onPointerDown),this.BR=!0):this.BR&&(c.a.Fa(this.xNa),this.xNa=null,n.a.instance.za(l.a.pointerDown,this.domElement,this.onPointerDown),this.BR=!1))};a.prototype.onc=function(t){return this.NAd(t)};a.prototype.Cuc=function(t){if(t){var B=t.offsetTop,z=this.gg.scrollTop;B<z?this.cXf(!0):B+t.offsetHeight>z+this.gg.clientHeight&&this.cXf(!1)}};a.prototype.cXf=
function(t){this.gg.scrollTop=t?this.Mk.offsetTop:this.Mk.offsetTop+this.Mk.offsetHeight-this.gg.clientHeight};a.prototype.hGd=function(){x.g(this.$).isEditing&&this.raiseEvent(a.Rkd)};Sk.Object.defineProperties(a.prototype,{Mk:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(t){this.oBa(this._selectedRowListBox);t?(this._selectedRowListBox=t,this.oBa(this._selectedRowListBox),this.Cuc(t)):this._selectedRowListBox=null}},p_:{configurable:!0,enumerable:!0,
get:function(){return this.XAb.ListCellClass}},Wba:{configurable:!0,enumerable:!0,get:function(){return this.XAb.ListTableClass}},bI:{configurable:!0,enumerable:!0,get:function(){return 8}},MBb:{configurable:!0,enumerable:!0,get:function(){return 5}},xjc:{configurable:!0,enumerable:!0,get:function(){return 24}},wjc:{configurable:!0,enumerable:!0,get:function(){return 35}},gg:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});
a.v4a="GotFocus";a.Rkd="IgnoreBlur";a.mOd="SetCell";a.yPa="PointerDown";a.Qrd="ItemPointerDown";Object(A.a)(a,"ListBox",F.a,[341,3])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kpae.js.map/2bdebc697661fd43601615ee7da1c223/EwaDS.kpae.js.map