(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1082:function(A,F,b){function a(u,C){var r=this;this.$c=function(){f.a.yg(y.a(r.$).qd.activityState,z.a.bzd)||r.vaa.reset()};this.$=C;this.mkc=u;this.ea=C.ea;this.ea.Uj(this.$c);this.vaa=B.a.Wse(this.$)}function c(u){var C=this;this.jj=this.sDc=null;this._state=0;this.moveNext=function(){try{for(C._state=1;1===C._state;)C.wu=C.wu()}catch(r){C.dispose(),C._state=3}};this.Bf=u;this.wu=this.TL;this.moveNext()}b.r(F);A=b(0);
var e=b(13),l=b(35),n=b(200),m=b(114),f=b(32),x=b(1),y=b(65),t=b(52);c.prototype.TL=function(){this.sDc=this.Bf.$.Vb.Hc("LoadResource","DownloadACopyOperation");return this.b0d};c.prototype.b0d=function(){var u=b(1082).DownloadACopyOperation;if(this.Bf.vaa.H$e||!(this.sDc.Dc<u.Jkc))return this.Uhg;this.jj=t.Task.delay(u.YJe).g();this.jj.isCompleted||(this._state=2,this.jj.PN(this.moveNext));return this.Ffb};c.prototype.Uhg=function(){var u=b(1082).DownloadACopyOperation;this.sDc.Dc>=u.Jkc&&e.ULS.sendTraceTag(537154819,
0,15,"Download did not complete after 10 seconds.");y.a(this.Bf.$).qd.JJ();this._state=3};c.prototype.Ffb=function(){this.jj.hz();return this.b0d};c.prototype.dispose=function(){};Object(A.a)(c,"$$sm_Microsoft$Office$Excel$WebUI$Client$OpenInClient$DownloadACopyOperation$IframeCompleteLoadOld",null,[3]);var B=b(1178),z=b(136);b.d(F,"DownloadACopyOperation",function(){return a});a.prototype.Rhh=function(){var u=this,C=this.pSg(this.$),r=this.$.userOperationManager.operationCount;0<r&&e.ULS.sendTraceTag(537154822,
0,15,"flushing queue in downloadcopy. Queue is {0}",r);this.$.userOperationManager.o4("DownloadACopyOperation.DownloadForkedFile");this.mkc&&e.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.vaa.downloadFile(C,-21742208);x.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?l.TaskExtensions.Ba(t.Task.delay(1),function(){u.G$e()},this.vaa.ma,3):l.TaskExtensions.Ba(t.Task.delay(1),function(){u.k9h()},
this.vaa.ma,3)};a.prototype.dispose=function(){this.ea&&this.ea.lk(this.$c);this.$=this.ea=null};a.prototype.G$e=function(u){var C=this;(u=void 0===u?null:u)||(u=this.$.Vb.Hc("LoadResource","DownloadACopyOperation"));!this.vaa.H$e&&u.Dc<a.Jkc?window.setTimeout(function(){C.G$e(u)},a.YJe):(u.Dc>=a.Jkc&&e.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),y.a(this.$).qd.JJ())};a.prototype.k9h=function(){new c(this)};a.prototype.pSg=function(u){var C=new Sys.StringBuilder,
r=u.workbookContext,J=u.ya;C.append(u.Pda);C.append(J.FileHandlerRelativeUri);C.append("?id=");C.append(encodeURIComponent(n.a.ZGb(r.WorkbookUri,"sc")));u.ea.qc&&(C.append("&sessionId="),C.append(encodeURIComponent(u.ea.sessionId)));C.append("&workbookType=FullForkedWorkbook");C.append("&dataloss=");C.append(this.mkc?"true":"false");m.a.fGa(C,J);return C.toString()};a.Jkc=1E5;a.YJe=100;Object(A.a)(a,"DownloadACopyOperation",null,[3])},1170:function(A,F,b){function a(m,f){m=n.call(this,m,f)||this;
c.ULS.sendTraceTag(537170201,0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");m.title="";m.message=a.Oxa;m.XKa=!0;return m}b.d(F,"a",function(){return a});A=b(0);var c=b(13),e=b(47),l=b(78);b=b(830);var n=b.a;vm(a,n);a.prototype.ima=function(m){n.prototype.ima.call(this,m);e.a.openWindow(4,l.a.rH(a.Uof))};a.prototype.BF=function(m){n.prototype.BF.call(this,m);a.gvd&&a.gvd(null)};a.initialize=function(m,f,x,y){c.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");
a.Oxa=m;a.Vof=f;a.Uof=x;a.gvd=y};Sk.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.Vof}}});a.Oxa=null;a.Vof=null;a.Uof=null;a.gvd=null;Object(A.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1171:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);a.$mh="ewa-bb";a.bnh="ewa-bb-entry";a.cnh="ewa-bb-entry-body";a.inh="ewa-bb-icon";a.enh="ewa-bb-entry-icon";a.hnh="ewa-bb-entry-title";a.gnh="ewa-bb-entry-message";a.jNe="ewa-bb-entry-button";
a.fnh="ewa-bb-entry-link";a.dnh="ewa-bb-entry-close";a.kNe="ewa-bb-entry-button-holder";a.E9c="ewa-nov2-ltr";a.anh="ewa-bb-content";a.G9c="ewa-nov2-rtl";Object(A.a)(a,"CssClassNames",null,[])},1172:function(A,F,b){function a(e,l){e=c.call(this,e,l)||this;e.hw=!0;e.title=a.fpa;e.message=a.dpa;return e}b.d(F,"a",function(){return a});A=b(0);b=b(830);var c=b.a;vm(a,c);a.prototype.kp=function(e){c.prototype.kp.call(this,e);(e=a.epa)&&e(null)};a.initialize=function(e,l,n,m){a.fpa=e;a.dpa=l;a.cpa=n;a.epa=
m};Sk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.cpa}}});a.fpa=null;a.dpa=null;a.cpa=null;a.epa=null;Object(A.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",b.a,[])},1173:function(A,F,b){function a(e,l){e=c.call(this,e,l)||this;e.hw=!0;e.title=a.fpa;e.message=a.dpa;return e}b.d(F,"a",function(){return a});A=b(0);b=b(830);var c=b.a;vm(a,c);a.prototype.kp=function(e){c.prototype.kp.call(this,e);(e=a.epa)&&e(null)};a.initialize=function(e,
l,n,m){a.fpa=e;a.dpa=l;a.cpa=n;a.epa=m};Sk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.cpa}}});a.fpa=null;a.dpa=null;a.cpa=null;a.epa=null;Object(A.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",b.a,[])},1174:function(A,F,b){function a(e,l){e=c.call(this,e,l)||this;e.hw=!0;e.title=a.fpa;e.message=a.dpa;return e}b.d(F,"a",function(){return a});A=b(0);b=b(830);var c=b.a;vm(a,c);a.prototype.kp=function(e){c.prototype.kp.call(this,e);(e=
a.epa)&&e(null)};a.initialize=function(e,l,n,m){a.fpa=e;a.dpa=l;a.cpa=n;a.epa=m};Sk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.cpa}}});a.fpa=null;a.dpa=null;a.cpa=null;a.epa=null;Object(A.a)(a,"MandatorySensitivityLabelBusinessBarEntry",b.a,[])},1175:function(A,F,b){function a(e,l){e=c.call(this,e,l)||this;e.hw=!0;e.title=a.DBb;e.message=a.Oxa;return e}b.d(F,"a",function(){return a});A=b(0);b=b(830);var c=b.a;vm(a,c);a.prototype.kp=function(e){c.prototype.kp.call(this,
e);a.Qxa&&a.Qxa(null)};a.initialize=function(e,l,n,m){a.DBb=e;a.Oxa=l;a.k8a=n;a.Qxa=m};Sk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.k8a}}});a.DBb=null;a.Oxa=null;a.k8a=null;a.Qxa=null;Object(A.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",b.a,[])},1176:function(A,F,b){function a(e,l){e=c.call(this,e,l)||this;a.k8a&&a.Qxa&&(e.hw=!0);e.title=a.DBb;e.message=a.Oxa;return e}b.d(F,"a",function(){return a});A=b(0);b=b(830);
var c=b.a;vm(a,c);a.prototype.kp=function(e){c.prototype.kp.call(this,e);a.Qxa&&a.Qxa(null)};a.initialize=function(e,l,n,m){a.DBb=e;a.Oxa=l;a.k8a=n;a.Qxa=m};Sk.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.k8a}}});a.DBb=null;a.Oxa=null;a.k8a=null;a.Qxa=null;Object(A.a)(a,"SensitivityApplicationSetLabelErrorBusinessBarEntry",b.a,[])},1177:function(A,F,b){function a(m,f,x,y,t,B){this.cY=m;this.dY=f;this.PJc=x;this.FD=y;this.nRb=t;this.OUa=B}
b.d(F,"a",function(){return a});A=b(0);var c=b(1233),e=b(5),l=b(49),n=b(86);a.prototype.l6i=function(m){this.luf(m)};a.prototype.Csi=function(m){this.luf(m)};a.prototype.luf=function(m){var f=10;1===m?(n.a.instance.resolve("Common.IOfficeTrialExperience").kjc(this.OUa),f=3):2===m&&((!this.PJc||this.PJc(this.FD))&&this.dY&&c.a.instance.o8g(this.dY,this.cY,this.FD),f=5);(0===m||1===m)&&this.cY&&this.cY(this.FD);e.AFrameworkApplication.jtc(l.a.WFf,this.nRb,f);this.dispose()};a.prototype.dispose=function(){this.FD=
this.dY=this.cY=null};Sk.Object.defineProperties(a.prototype,{g4f:{configurable:!0,enumerable:!0,get:function(){return!this.dY&&!this.PJc}},Utf:{configurable:!0,enumerable:!0,get:function(){return 2===this.OUa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},LMe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},t$e:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},Yva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},d9e:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},zXb:{configurable:!0,enumerable:!0,get:function(){return 2===this.OUa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}},io:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(A.a)(a,"AOICErrorDialogWithTrial",null,[3])},1178:function(A,F,b){function a(B,z){var u=t.call(this,B)||this;u.mVj=["id","sessionId","workbookType","workbookFileType","dataloss"];u.command=0;u.vDb=function(){var C=u.HPh();if(C){u.$.nI(!0);if(-2028960985!==u.command&&1461300262!==u.command){var r=x.a(u.$).qd.activityState;r[f.a.rYa]=m.a.download;r[y.a.OTc]=u.command}n.a(u.$).nv(C.Errors)}};u.iframe=B;u.$=z;u.wc.ja("load",u.vDb);return u}b.d(F,"a",function(){return a});A=b(0);var c=b(13),e=b(47);
F=b(230);var l=b(200),n=b(41),m=b(6),f=b(33),x=b(65),y=b(607),t=F.a;vm(a,t);a.prototype.downloadFile=function(B,z){var u={};(B=this.hAh(B,u))&&e.a.Zpc("dlfr",B,u);this.command=z};a.prototype.hAh=function(B,z){var u=B.split("?");if(2!==u.length)return B=null,c.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),B;u=u[1].split("&");u=yl(u);for(var C=u.next();!C.done;C=u.next()){var r=C.value.split("=",2);if(2!==r.length){B=null;c.ULS.sendTraceTag(537154787,
0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}C=r[0];Array.contains(this.mVj,C)&&(r=decodeURIComponent(r[1]),z[C]=r,B=l.a.ZGb(B,C))}return B};a.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};a.prototype.HPh=function(){try{return this.iframe.contentWindow.ewaResult}catch(z){if(!this.$.ea.nc.isDivSyndicated){var B=window.document.referrer.match(RegExp("://(.[^/]+)/"));c.ULS.sendTraceTag(537154785,
0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<B.length?B[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.Gwa);throw z;}return null}};a.Wse=function(B){var z=document.createElement("iframe");z.id="ewaFileLoader";z.style.cssText="height:0;width:0;display:none";z.src="about:blank";z.setAttribute("name","dlfr");z=B.domElement.appendChild(z);return new a(z,B)};Sk.Object.defineProperties(a.prototype,
{H$e:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(A.a)(a,"FileLoader",F.a,[])},1179:function(A,F,b){function a(){this.BaseDocQuerySignature=null;this.RoamingApp=0}b.d(F,"a",function(){return a});A=b(0);var c=b(1337),e=b(5),l=b(40),n=b(78);a.prototype.RNd=function(){return l.c([this.wja(),this])};a.prototype.execute=function(m,f,x){var y="RoamingAppsHandler.ashx";c.a.instance.roamingAppsAreEnabled&&
0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(y=n.a.il(y,"wdEnableRoaming","1"));e.AFrameworkApplication.Jd.Xl(y,2,this.RNd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.f4a(),m,f,x,void 0,void 0,void 0,void 0,"6")};Object(A.a)(a,"ARoamingAppsRequest",null,[])},1183:function(A,F,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=this.logger=this.printPreviewPaneCallbacks=
this.backActionButtonText=null}b.d(F,"a",function(){return a});A=b(0);Object(A.a)(a,"PrintPreviewPaneProps",null,[])},1184:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);a.Q1i="PrintDialogBody";a.printDialogTitle="PrintDialogTitle";a.$7b="ewa-dlg-elements-container-rtl";a.R1i="PrintDialogLeftContainer";a.S1i="PrintDialogRightContainer";a.aab="PrintDialogRadioButtonContainer";a.WJf="PrintRadioButtonElementInnerDiv";a.X1i="PrintRadioButtonElementOuterDiv";a.bab="PrintDialogTitleSection";
a.hFd="PrintDialogComboBoxContainer";a.Y1i="PrintRadioButtonIcon";a.P1i="PrintButtonArea";a.Aw="PrintPreviewerContainer";Object(A.a)(a,"CssClassNames",null,[])},1225:function(A,F,b){function a(ic,Jb){var cc=Ub.call(this,Jb)||this;cc.aFh=S.DOMElementExtensions.Rp+",div";cc.DU=Array(66);cc.tm=!1;cc.oW=function(Ob){if(Ob.Ea.keyCode===U.a.AD){var P=cc.Jb.querySelectorAll(cc.aFh),Ba=S.DOMElementExtensions.Cl(P);P=S.DOMElementExtensions.gz(P);return S.DOMElementExtensions.Qda(Ob.Ea,Ba,P)}return!1};cc.vb=
ic;cc.set_visible(!1);cc.addCssClass(da.a.$mh);Q.KeyInputManager.instance.qa(la.a.Sb,cc.Jb,cc.oW);X.a(ic).Rg(cc);return cc}function c(ic,Jb,cc,Ob,P,Ba){var ra=D.call(this,ic,Jb,cc)||this;lc.a.instance.create(function(){if(ra.businessBar&&ra.businessBar.kMa(Jb.f_a)){var ta=new qa.a(-847286761,0,ra.businessBar.$.gd,0,null),Ia={};Ia=(Ia.CalloutName=Ob,Ia.Target=ra.XS.domElement,Ia);ra.businessBar.$.Ka.Xb(ta,Ia)}},P,Ba,!0,!0);return ra}function e(ic,Jb,cc,Ob){ic=Xb.call(this,ic,Jb)||this;ic.automateCommandManager=
cc.da.Aa(352);V.ULS.shipAssertTag(526787654,0,!!ic.automateCommandManager);ic.id=mb.a.create();ic.$=cc;ic.title=Xa.a.instance.fa(2212);ic.message="";ic.LTd=Xa.a.instance.fa(2208);ic.pXj=Xa.a.instance.fa(2209);ic.rgg=Xa.a.instance.fa(2210);ic.X1g=Xa.a.instance.fa(2211);ic.update(Ob);return ic}function l(ic,Jb){ic=ub.call(this,ic,Jb)||this;ic.XBa=ib.a.y4b();ic.hw=!0;ic.O4=ic.XBa.wVj;ic.title=ic.XBa.title;ic.message=ic.XBa.message;return ic}function n(ic,Jb){ic=Dc.call(this,ic,Jb)||this;ic.hw=!0;ic.title=
"";return ic}function m(ic,Jb){Jb=eb.call(this,ic,Jb)||this;Jb.policyManager=ic.$.da.Aa(274);if(!Jb.policyManager)return V.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),Jb;Jb.message=Jb.policyManager.Npc;Jb.title=Jb.policyManager.title;Jb.XKa=!0;return Jb}function f(ic,Jb){ic=ob.call(this,ic,Jb)||this;ic.hw=!0;ic.O4=!0;return ic}function x(ic,Jb,cc,Ob){ic=Ta.call(this,ic,Jb)||this;ic.Twb=cc;ic.command=Ob;ic.XKa=!0;ic.hw=
1461300262!==Ob;return ic}function y(ic,Jb,cc){ic=ma.call(this,ic,Jb)||this;ic.Twb=cc;ic.XKa=!0;return ic}function t(ic,Jb,cc){ic=hc.call(this,ic,Jb)||this;ic.Twb=cc;ic.hw=!0;return ic}function B(ic,Jb){ic=Ja.call(this,ic,Jb)||this;ic.hw=!0;ic.O4=!1;return ic}function z(ic,Jb){ic=db.call(this,ic,Jb)||this;ic.hw=!0;ic.O4=!0;return ic}function u(ic,Jb,cc,Ob,P,Ba,ra){return C.call(this,ic,0,Jb,cc,Ob,P,Ba,ra)||this}function C(ic,Jb,cc,Ob,P,Ba,ra,ta){this.mJ=this.n8=this.XS=0;this.bmg=ic;this.xLj=Jb;this.zP=
cc;this.oqg=ra;this.Iib=H.a.Qv(ta);this.rog=ta;0!==Ob&&(this.XS=Ob);0!==P&&(this.n8=P);0!==Ba&&(this.mJ=Ba)}function r(ic,Jb,cc,Ob,P){ic=J.call(this,ic,Jb,cc,Ob)||this;ic.command=P;ic.O4=!0;return ic}function J(ic,Jb,cc,Ob){ic=Ha.call(this,ic,Jb)||this;ic.error=cc;ic.options=Ob;ic.error&&ic.options&2&&(ic.message=ic.error.Description);ic.error&&ic.options&1&&(ic.title=ic.error.Caption);ic.hw=!(Ob&4);return ic}function v(ic,Jb,cc){return D.call(this,ic,Jb,cc)||this}function D(ic,Jb,cc){ic=pa.call(this,
ic,Jb)||this;ic.hw=!0;ic.command=cc;return ic}b.r(F);A=b(0);var V=b(13),U=b(91),Q=b(117),la=b(12),ba=b(88),T=b(49),H=b(29),S=b(11),K=b(230),da=b(1171),fa=b(4),X=b(255),ca=b(1172),ja=b(830),ea=b(1251),qa=b(92),pa=ja.a;vm(D,pa);D.prototype.kp=function(ic){pa.prototype.kp.call(this,ic);this.businessBar.$.Ka.Xb(new qa.a(this.command,ic,this.businessBar.$.gd,10,null))};Object(A.a)(D,"CommandActionBusinessBarEntry",ja.a,[]);vm(v,D);v.prototype.BF=function(ic){D.prototype.BF.call(this,ic)};Object(A.a)(v,
"EditAttemptReadOnlyBusinessBarEntry",D,[]);var Pa=b(41),Ha=ja.a;vm(J,Ha);J.prototype.kp=function(ic){Ha.prototype.kp.call(this,ic);this.error.Appearance&=-33;Pa.a(this.businessBar.$).nv([this.error])};Object(A.a)(J,"ErrorBusinessBarEntry",ja.a,[]);vm(r,J);r.prototype.l6=function(ic){J.prototype.l6.call(this,ic);this.businessBar.$.Ka.Xb(new qa.a(this.command,ic,this.businessBar.$.gd,10,null))};Object(A.a)(r,"ErrorAndCommandBusinessBarEntry",J,[]);var Xa=b(14);C.fa=function(ic){return Xa.a.instance.fa(ic)};
Sk.Object.defineProperties(C.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return C.fa(this.xLj)}},message:{configurable:!0,enumerable:!0,get:function(){return C.fa(this.zP)}},messageId:{configurable:!0,enumerable:!0,get:function(){return this.zP}},f_a:{configurable:!0,enumerable:!0,get:function(){return this.bmg}},actionButton:{configurable:!0,enumerable:!0,get:function(){return C.fa(this.XS)}},fZa:{configurable:!0,enumerable:!0,get:function(){return C.fa(this.n8)}},link:{configurable:!0,
enumerable:!0,get:function(){return C.fa(this.mJ)}},Nj:{configurable:!0,enumerable:!0,get:function(){return this.oqg}},hash:{configurable:!0,enumerable:!0,get:function(){return this.Iib}},alt:{configurable:!0,enumerable:!0,get:function(){var ic=b(1225).BusinessBarControl;switch(this.Nj){case ic.Mia:return C.fa(26);case ic.GB:return C.fa(25);case ic.pj:return C.fa(24);default:return C.fa(0)}}},U8c:{configurable:!0,enumerable:!0,get:function(){return this.rog}}});Object(A.a)(C,"EwaBusinessBarEntry",
null,[]);vm(u,C);Sk.Object.defineProperties(u.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(A.a)(u,"EwaNoTitleBusinessBarEntry",C,[]);var Na=b(69),db=ja.a;vm(z,db);z.prototype.kp=function(ic){db.prototype.kp.call(this,ic);this.set_visible(!1);this.businessBar.$.qI();this.businessBar.$.Ka.Xb(new qa.a(1038998010,ic,this.businessBar.$.gd,10,null))};z.prototype.l6=function(ic){db.prototype.l6.call(this,ic);this.businessBar.$.Ka.Xb(new qa.a(-722953877,ic,this.businessBar.$.gd,
10,null))};z.prototype.BF=function(ic){this.businessBar.removeEntry(53);Na.g(ic)};Object(A.a)(z,"ExternalLinksEnableContentBusinessBarEntry",ja.a,[]);var Ja=ja.a;vm(B,Ja);B.prototype.kp=function(ic){Ja.prototype.kp.call(this,ic);this.businessBar.$.Ka.Xb(new qa.a(-722953877,ic,this.businessBar.$.gd,10,null))};B.prototype.BF=function(ic){this.businessBar.removeEntry(5);Na.g(ic)};Object(A.a)(B,"ExternalLinksShowErrorBusinessBarEntry",ja.a,[]);var jb=b(9),hc=ja.a;vm(t,hc);t.prototype.kp=function(ic){hc.prototype.kp.call(this,
ic);jb.HelperMethods.Bca(this.businessBar.$.RI,this.Twb,this.businessBar.$.AX)};Object(A.a)(t,"HelpButtonBusinessBarEntry",ja.a,[]);var ma=ja.a;vm(y,ma);y.prototype.ima=function(ic){ma.prototype.ima.call(this,ic);jb.HelperMethods.Bca(this.businessBar.$.RI,this.Twb,this.businessBar.$.AX)};Object(A.a)(y,"HelpTextBusinessBarEntry",ja.a,[]);var Ka=b(77),Ta=ja.a;vm(x,Ta);x.prototype.kp=function(ic){Ta.prototype.kp.call(this,ic);this.businessBar.$.Ka.Xb(new qa.a(this.command,ic,this.businessBar.$.gd,10,
null))};x.prototype.ima=function(ic){Ta.prototype.ima.call(this,ic);var Jb=new qa.a(-859308420,ic,this.businessBar.$.gd,12,null),cc={};ic=(cc[Ka.a.Ug]="HelpID="+this.Twb,cc.InputMethod=ic,cc[Ka.a.ld]=fa.a.MZ,cc[fa.a.dBa]=!0,cc);this.businessBar.$.Ka.Xb(Jb,ic)};Object(A.a)(x,"HelpTextTaskPaneAndCommandBusinessBarEntry",ja.a,[]);var ob=ja.a;vm(f,ob);f.prototype.kp=function(ic){ob.prototype.kp.call(this,ic);this.set_visible(!1);this.businessBar.$.qI();this.businessBar.$.Ka.Xb(new qa.a(-1081442996,ic,
this.businessBar.$.gd,10,null))};f.prototype.l6=function(ic){ob.prototype.l6.call(this,ic);this.businessBar.$.Ka.Xb(new qa.a(1702917262,ic,this.businessBar.$.gd,10,null))};f.prototype.BF=function(ic){this.businessBar.removeEntry(57);Na.g(ic)};Object(A.a)(f,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",ja.a,[]);var Cb=b(1174),eb=ja.a;vm(m,eb);m.prototype.ima=function(ic){eb.prototype.ima.call(this,ic);(ic=this.policyManager.fPi)&&ic(null)};Sk.Object.defineProperties(m.prototype,{linkText:{configurable:!0,
enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(A.a)(m,"PolicyBusinessBarEntry",ja.a,[]);var ya=b(1173),za=b(1176),Ga=b(1175);b(413);var cb=b(176),Mb=b(30),Dc=ja.a;vm(n,Dc);n.prototype.kp=function(ic){Dc.prototype.kp.call(this,ic);cb.c(Mb.a.HDi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")};Object(A.a)(n,"UnsupportedBrowserBusinessBarEntry",ja.a,[]);var vb=b(1170),ib=b(1267),ub=ja.a;vm(l,ub);l.prototype.kp=function(ic){ub.prototype.kp.call(this,
ic);this.XBa.tvf(null)};l.prototype.l6=function(ic){ub.prototype.l6.call(this,ic);this.XBa.wvf(null)};l.prototype.BF=function(ic){ub.prototype.BF.call(this,ic);this.XBa.NIe(null)};Sk.Object.defineProperties(l.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.XBa.Jve}},fZa:{configurable:!0,enumerable:!0,get:function(){return this.XBa.Lve}}});Object(A.a)(l,"WildFireMobileAppBusinessBarEntry",ja.a,[]);var Eb=b(244),Ya=b(19),tb=b(238),ec=b(166),Za=b(46),mb=b(178),sc=b(1096),
pd=b(75),$b=b(126),Xb=ja.a;vm(e,Xb);e.prototype.update=function(ic){this.scriptLink=ic.scriptLink;this.runStatus=ic.runStatus;this.buttonText=ic.buttonText||"";this.wui(ic.clickId);this.ehj();"preparing"===this.runStatus?(this.message=String.format(Xa.a.instance.Cb(198),this.buttonText),this.hw=!0,this.fYa=this.LTd,this.hqb=this.nFa=this.U9a):"running"===this.runStatus?(this.message=String.format(Xa.a.instance.Cb(197),this.buttonText),this.hw=!0,this.fYa=this.LTd,this.hqb=this.nFa=this.U9a):"succeeded"===
this.runStatus?(this.message=String.format(Xa.a.instance.Cb(200),this.buttonText),this.hw=!0,this.fYa=this.rgg,this.nFa=this.pFf,this.O4=!0,this.kWc=this.pXj,this.lWc=this.mVi):"runFailed"===this.runStatus?(this.message=String.format(Xa.a.instance.Cb(199),this.buttonText),this.m5a=a.Mia,this.hw=!0,this.fYa=this.rgg,this.nFa=this.pFf,"false"===ic.isOwner&&(this.O4=!0,this.kWc=this.X1g,this.lWc=this.sJi)):"fetchFailed"===this.runStatus?(this.m5a=a.Mia,this.message=String.format(Xa.a.instance.Cb(201),
this.buttonText)):"canceled"===this.runStatus?(this.m5a=a.GB,this.message=String.format(Xa.a.instance.Cb(203),this.buttonText)):"alreadyRunning"===this.runStatus?(this.m5a=a.GB,this.message=String.format(Xa.a.instance.Cb(202),this.buttonText),this.hw=!0,this.fYa=this.LTd,this.hqb=this.nFa=this.U9a):"initializing"===this.runStatus&&(this.m5a=a.pj,this.message=Xa.a.instance.fa(2213))};e.prototype.kp=function(ic){Xb.prototype.kp.call(this,ic);this.nFa&&this.nFa()};e.prototype.l6=function(ic){Xb.prototype.l6.call(this,
ic);this.fZa&&this.lWc()};e.prototype.BF=function(ic){Xb.prototype.BF.call(this,ic);this.hqb&&this.hqb()};e.prototype.ehj=function(){this.message="";this.m5a=a.pj;this.hw=!1;this.fYa="";this.nFa=void 0;this.O4=!1;this.kWc="";this.lWc=void 0;this.Wwb=!1;this.hqb=void 0};e.prototype.U9a=function(){var ic=mb.a.create().toString();this.automateCommandManager.k3h(ic);this.Mjc(-2186799,ic)};e.prototype.pFf=function(){var ic=mb.a.create().toString();this.automateCommandManager.j3h(ic);this.Mjc(1036446140,
ic)};e.prototype.mVi=function(){var ic=mb.a.create();if(this.scriptLink){var Jb=new sc.b(this.scriptLink);this.automateCommandManager.w7e(this.id.toString(),JSON.stringify(Jb),ic)}this.Mjc(-585097204,ic.toString())};e.prototype.sJi=function(){var ic=mb.a.create().toString();this.automateCommandManager.i3h(ic);this.Mjc(-639858579,ic)};e.prototype.wui=function(ic){var Jb=[];Jb.push(Object.assign(new pd.a,{name:"id",string:this.id.toString()}));Jb.push(Object.assign(new pd.a,{name:"hasScriptLink",bool:!!this.scriptLink}));
Jb.push(Object.assign(new pd.a,{name:"runStatus",string:this.runStatus}));Jb.push(Object.assign(new pd.a,{name:"clickId",string:ic}));Jb.push(Object.assign(new pd.a,{name:"hasButtonText",bool:!!this.buttonText&&""!==this.buttonText}));cb.a($b.a.pGi,void 0,void 0,Jb)};e.prototype.Mjc=function(ic,Jb){var cc=[];cc.push(Object.assign(new pd.a,{name:"id",string:this.id.toString()}));cc.push(Object.assign(new pd.a,{name:"hasScriptLink",bool:!!this.scriptLink}));cc.push(Object.assign(new pd.a,{name:"runStatus",
string:this.runStatus}));cc.push(Object.assign(new pd.a,{name:"clickId",string:Jb}));cb.d(ic,void 0,void 0,void 0,void 0,void 0,cc)};Sk.Object.defineProperties(e.prototype,{Nj:{configurable:!0,enumerable:!0,get:function(){return this.m5a}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.fYa}},fZa:{configurable:!0,enumerable:!0,get:function(){return this.kWc}}});Object(A.a)(e,"OfficeScriptsRunStatusBusinessBarEntry",ja.a,[]);var lc=b(44);vm(c,D);Object(A.a)(c,"CalloutBusinessBarEntry",
D,[]);var Oa=b(1),pb=b(16);b.d(F,"BusinessBarControl",function(){return a});var Ub=K.a;vm(a,Ub);a.prototype.Ne=function(ic,Jb){Jb||S.DOMElementExtensions.setFocus(this.domElement.firstChild);return!Jb};a.prototype.Yf=function(ic){return S.DOMElementExtensions.Oe(this.Jb,ic)};a.prototype.gi=function(){};a.prototype.Qh=function(){};a.prototype.dispose=function(){this.tm||(Q.KeyInputManager.instance.za(la.a.Sb,this.Jb,this.oW),ba.a.rc(this.DU),this.DU=Array(66),this.vb=null,Ub.prototype.dispose.call(this),
this.tm=!0)};a.prototype.kMa=function(ic){if(!this.get_visible())return!1;ic=this.DU[ic];return!!ic&&ic.isVisible};a.prototype.dC=function(ic){return!!this.DU[ic]};a.prototype.wNb=function(ic,Jb){if(ic=this.DU[ic])ic.update(Jb),ic.wRj()};a.prototype.$D=function(ic,Jb,cc,Ob){cc=void 0===cc?null:cc;Ob=void 0===Ob?null:Ob;var P=!1;if(this.dC(ic))cc=this.DU[ic].get_visible();else{this.set_visible(!0);var Ba=a.m5e()[ic];this.DU[ic]=this.M$(ic,Jb,cc,Ob);cc=!1;P=!0;Ob="";var ra=0;Jb&&(Ob=Jb.MessageIdName,
ra=Jb.MessageId);var ta=Ba.U8c;V.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",ic,Za.PageLoadTrackingInfo.instance.Pja(new Date));if(Oa.EwaSettings.isChangeGateEnabled("OfficeVSO:6069521_TelemetryForBusinessBar")){var Ia=this.DU.filter(function(bb){return null!=bb}).length;1<Ia&&V.ULS.sendTraceTag(525349006,0,50,"Total BizBars: {0}",Ia.toString())}ec.a(this.$).oKd(Ba.hash,Ob,ra,T.a.KAc,!0,1,Jb,ta)}cc||!Array.contains(ea.a.ncc(),ic)&&!P||
(this.DU[ic].set_visible(!0),this.$.qI())};a.prototype.removeEntry=function(ic){return this.xaj(ic)};a.prototype.qId=function(){ba.a.rc(this.DU);this.DU=Array(66);this.set_visible(!1)};a.prototype.xaj=function(ic){if(!this.dC(ic))return!1;ba.a.Fa(this.DU[ic]);this.DU[ic]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.qI();return!0};a.prototype.M$=function(ic,Jb,cc,Ob){cc=void 0===cc?null:cc;Ob=void 0===Ob?null:Ob;var P=a.m5e()[ic],Ba=!!(this.$.Hd&64);switch(ic){case 2:case 4:case 23:case 25:case 26:case 35:case 34:ic=
new ja.a(this,P);break;case 12:case 29:case 30:case 31:case 32:case 55:ic=Ba?new D(this,P,-8805455):new ja.a(this,P);break;case 22:ic=new v(this,P,-8805455);break;case 44:case 43:ic=Ba?new r(this,P,Jb,0,-8805455):new J(this,P,Jb,0);break;case 11:case 41:case 7:case 0:case 1:case 3:case 33:ic=new J(this,P,Jb,0);break;case 19:ic=new ja.a(this,P);break;case 45:ic=new J(this,P,Jb,0);break;case 6:case 14:ic=new t(this,P,Jb.HelpTopicId);break;case 64:ic=new y(this,P,Jb.HelpTopicId);break;case 36:ic=new y(this,
P,fa.a.xbh);break;case 16:ic=new ja.a(this,P);ic.title=H.a.Lf(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);ic.message=H.a.Lf(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);break;case 18:ic=new D(this,P,-1762562205);ic.Wwb=!0;break;case 20:ic=new l(this,P);break;case 21:case 54:ic=new ja.a(this,P);break;case 28:ic=new ja.a(this,P);break;case 24:ic=new n(this,P);break;case 27:ic=new m(this,P);break;case 37:ic=new vb.a(this,P);break;case 38:ic=new ca.a(this,P);break;case 39:ic=
new ya.a(this,P);break;case 40:ic=new Cb.a(this,P);break;case 46:ic=new ja.a(this,P);break;case 47:ic=new ja.a(this,P);break;case 48:ic=new ja.a(this,P);break;case 49:ic=new ja.a(this,P);break;case 50:ic=new ja.a(this,P);break;case 51:ic=new Ga.a(this,P);break;case 52:ic=new za.a(this,P);break;case 53:ic=new z(this,P);break;case 5:ic=new B(this,P);break;case 56:ic=new D(this,P,-1753056834);Jb?(Jb=Jb.Directive,Ya.a.Gn(Jb)||"&nbsp;"===Jb||(ic.message=Jb)):cc&&(ic.message=cc);break;case 57:ic=new f(this,
P);break;case 58:ic=new ja.a(this,P);break;case 59:case 62:ic=new y(this,P,fa.a.tFi);break;case 60:ic=new x(this,P,fa.a.KNg,-8805455);break;case 65:ic=new x(this,P,fa.a.R6i,1461300262);break;case 61:ic=Oa.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammerBusinessBarTeachingCallout",!1)?new c(this,P,515196233,13,3E5,"OptimizeWorkbookManager.ShowBusinessBarTeachingCallout"):new D(this,P,515196233);break;case 63:ic=new e(this,P,this.$,Ob);break;default:ic=new J(this,
P,Jb,7)}ic.y3c();return ic};a.m5e=function(){var ic=tb.a.o6a()?259:258;return a.zve||(a.zve=[new C(0,274,275,276,0,0,a.Mia,"BB_UnableToRefreshLock"),new C(1,274,275,276,0,0,a.Mia,"BB_UnableToRefreshLockExpected"),new C(2,266,267,0,0,0,a.GB,"BB_WorkbookAlmostTooLarge"),new C(3,268,269,270,0,0,a.Mia,"BB_WorkbookTooLarge"),new C(4,257,ic,0,0,0,a.GB,"BB_ExternalWorkbookLinksDisabled"),new C(5,261,260,262,0,0,a.Mia,"BB_ExternalWorkbookLinksShowError"),new C(6,263,264,265,0,0,a.pj,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),
new C(7,249,250,251,0,0,a.pj,"BB_UnsupportedFeatures"),new C(8,0,0,0,0,0,a.pj,"BB_CollabDataAndDataStringsLocaleMismatch"),new C(9,0,0,0,0,0,a.pj,"BB_CollabDataStringsLocaleMismatch"),new C(10,0,0,0,0,0,a.pj,"BB_CollabDataLocaleMismatch"),new C(11,277,278,279,0,0,a.Mia,"BB_LastGenericStatusError"),new C(12,280,281,282,0,0,a.GB,"BB_ScratchPadWarning"),new C(13,283,284,285,0,0,a.Mia,"BB_AuthenticationLost"),new C(14,286,287,288,0,0,a.GB,"BB_OdfCompatibilityIssues"),new C(15,0,568,0,0,0,a.GB,"BB_PivotChartInteractivityMissingWarning"),
new C(16,0,0,0,0,0,a.pj,"BB_WorkbookIsIrmProtected"),new C(17,0,0,0,0,0,a.pj,"BB_BIFeatureNotAvailable"),new C(18,289,290,285,0,0,a.GB,"BB_AnonymousCreateMode"),new C(19,252,253,0,0,0,a.GB,"BB_UnsupportedInteractiveReportEditing"),new C(20,0,0,0,0,0,a.pj,"BB_MobileAppCampaignBizBar"),new C(21,295,296,0,0,0,a.pj,"BB_TransientServerCommunicationFailures"),new C(22,1598,1609,1610,0,0,a.pj,"BB_EditAttemptInReadOnly"),new C(23,1598,1609,0,0,0,a.pj,"BB_EditAttemptInReadOnlyNoEditPermissions"),new C(24,
0,jb.HelperMethods.XQj(),1587,0,0,a.pj,"BB_UnsupportedBrowser"),new C(25,298,299,0,0,0,a.pj,"BB_ReadOnlyPermissions"),new C(26,300,301,0,0,0,a.pj,"BB_DocumentIsIrmProtectedWarning"),new C(27,0,0,0,0,0,a.GB,"BB_PolicyWarningMessage"),new C(28,1242,297,0,0,0,a.pj,"BB_WorkingOnIt"),new C(29,1598,1596,1597,0,0,a.pj,"BB_PasswordProtectedWorkbookLockedForEdit"),new C(30,1611,1612,1613,0,0,a.pj,"BB_WorkbookIsReadOnlyRecommended"),new C(31,1598,1614,1615,0,0,a.pj,"BB_WorkbookHasPasswordToModify"),new C(32,
1598,1616,1619,0,0,a.pj,"BB_LegacySharedWorkbookEditWarning"),new C(33,1606,1617,251,0,0,a.pj,"BB_LegacyConnectionsWarning"),new C(34,1607,1608,0,0,0,a.pj,"BB_GroupedSlicers"),new C(35,311,312,0,0,0,a.GB,"BB_ThirdPartyAddinDisabled"),new C(36,1739,1740,0,0,1741,a.pj,"BB_FinanceLinkedEntityDisclaimerBar"),new C(37,0,0,0,0,0,a.pj,"BB_WacGdprNotice"),new C(38,0,0,0,0,0,a.pj,"BB_AutomaticSensitivityLabel"),new C(39,0,0,0,0,0,a.pj,"BB_RecommendedSensitivityLabel"),new C(40,0,0,0,0,0,a.pj,"BB_MandatorySensitivityLabel"),
new C(41,313,314,315,0,0,a.pj,"BB_LocalStorageDisabled"),new C(42,625,626,0,0,0,a.pj,"BB_AutoRefreshDisabled"),new C(43,983,981,985,1271,0,a.pj,"BB_CorruptedFileRepaired"),new C(44,984,982,985,1271,0,a.pj,"CorruptedOdsFileRepaired"),new C(45,271,272,273,0,0,a.GB,"BB_MinorVersionLimitReached"),new C(46,302,303,0,0,0,a.GB,"BB_SensitivityApplicationGenericError"),new C(47,304,306,0,0,0,a.GB,"BB_SensitivityApplicationTooLargeFileError"),new C(48,305,306,0,0,0,a.GB,"BB_SensitivityApplicationLabelNotSupportedError"),
new C(49,307,308,0,0,0,a.GB,"BB_SensitivityApplicationLabelDisabledError"),new C(50,309,310,0,0,0,a.GB,"BB_SensitivityApplicationMandatoryConflictError"),new C(51,0,0,0,0,0,a.GB,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new C(52,0,0,0,0,0,a.GB,"BB_SensitivityApplicationSetLabelError"),new C(53,2059,2060,2061,2064,0,a.pj,"BB_ExternalWorkbookLinksPromptEnableContent"),new C(54,295,296,0,0,0,a.pj,"BB_NetworkDown"),new C(55,316,317,318,0,0,a.pj,"BB_DefaultToViewDueToCogs"),new C(56,1765,
1766,1767,0,0,a.pj,"BB_RefreshLinkedEntityErrorBar"),new C(57,1742,1743,1744,1745,0,a.pj,"BB_LinkedEntitiesUntrustedImagesDisabled"),new u(58,248,0,0,0,a.pj,"BB_CanvasHealth"),new C(59,319,320,0,0,321,a.pj,"BB_NovModeDepreciation"),new C(60,986,987,1271,0,988,a.pj,"BB_MismatchedFileFormatConverted"),new C(61,2169,2170,2171,0,0,a.pj,"BB_OptimizeWorkbook"),new C(62,322,323,0,0,324,a.pj,"BB_NovModePostDepreciation"),new C(63,0,0,0,0,0,a.pj,"BB_OfficeScriptsRunning"),new C(64,2148,2149,0,0,2150,a.pj,
"BB_PowerQueryRefreshDataSourceNotSupported"),new C(65,325,326,0,0,327,a.pj,"BB_ReadOnlyPivotTable")])};Sk.Object.defineProperties(a.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return Eb.a.aZc}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});a.Mia=pb.a.orh;a.GB=pb.a.qrh;a.pj=pb.a.prh;a.zve=null;Object(A.a)(a,
"BusinessBarControl",K.a,[112])},1233:function(A,F,b){function a(){this.gjb=!!t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.rw}function c(v,D,V){var U=n.call(this,v,D,V)||this;v={};v=(v.errorMessage=U.MMe,v.errorFileDownloadOffer=U.Ssb,v);D={};v.helpLink=(D.type="AppLinkProps",D.id="helpLink",D.text=U.Yva,D.onExecute=function(Q){U.uOa(Q)},D);D=new J.a(!1,!1,!0);D.jc=1;D.Fc(1,U.Tsb);D.Ue=U.id;V={};v=(V.id=U.id,V.dialogIcon=U.icon,V.bodyControls=v,V);D.initializeAndShow(U.io,Object(x.a)(U,
U.HGd,"reactOICErrorDialogHandler"),v);return U}function e(v,D,V,U){var Q=f.call(this,v,D,V,U)||this;v={};v=(v.errorMessage=Q.errorMessage,v);D={};v.helpLink=(D.type="AppLinkProps",D.id="helpLink",D.text=Q.Yva,D.onExecute=function(la){Q.uOa(la)},D);Q.Zwc?(v.macOfficePreLinkText=Q.ppf,D={},v.macOfficeLink=(D.type="AppLinkProps",D.id="macOfficeLink",D.text=Q.mpf,D.onExecute=function(la){Q.czd(la)},D),v.macOfficePostText=Q.opf):Q.f3b&&(v.errorFileDownloadOffer=Q.Ssb);D=new J.a(!1,!1,!0);Q.f3b?(D.jc=
1,D.Fc(1,Q.Tsb)):D.jc=0;D.Ue=Q.id;V={};v=(V.id=Q.id,V.dialogIcon=Q.icon,V.bodyControls=v,V);D.initializeAndShow(Q.io,Object(x.a)(Q,Q.HGd,"reactOICErrorDialogHandler"),v);return Q}function l(v,D,V){v=n.call(this,v,D,V)||this;v.Tl=null;D=document.createElement("span");D.id="errorMessageText";D.innerText=v.MMe;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));v.Tl=document.createElement("a");v.Tl.href="#";v.Tl.innerText=v.Yva;D.appendChild(v.Tl);C.a.addHandler(v.Tl,
"click",Object(x.a)(v,v.uOa,"oicErrorHelpLinkHandler"));D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));V=document.createElement("span");V.innerText=v.Ssb;D.appendChild(V);V=new r.StandardDialog;V.Ue=v.id;V.jc=1;V.Fc(1,v.Tsb);V.Jk(v.io,null,v.icon,Object(x.a)(v,v.ntd,"legacyOICErrorDialogHandler"),D);V.gX("errorMessageText");return v}function n(v,D,V){this.cY=D;this.dY=v;this.FD=V}function m(v,D,V,U){v=f.call(this,v,D,V,U)||this;v.Tl=null;v.Cqa=null;D=document.createElement("span");
D.id="errorMessageText";D.innerText=v.errorMessage;D.appendChild(document.createElement("br"));D.appendChild(document.createElement("br"));v.Tl=document.createElement("a");v.Tl.href="#";v.Tl.innerText=v.Yva;D.appendChild(v.Tl);C.a.addHandler(v.Tl,"click",Object(x.a)(v,v.uOa,"oicErrorHelpLinkHandler"));V=new r.StandardDialog;V.Ue=v.id;if(v.Zwc){U=document.createElement("span");var Q=document.createElement("span");U.innerText=v.ppf;Q.innerText=v.opf;v.Cqa=document.createElement("a");v.Cqa.href="#";
v.Cqa.innerText=v.mpf;D.appendChild(document.createElement("br"));D.appendChild(U);D.appendChild(v.Cqa);D.appendChild(Q);C.a.addHandler(v.Cqa,"click",Object(x.a)(v,v.czd,"oicErrorMacOfferLinkHandler"))}else v.f3b&&(D.appendChild(document.createElement("br")),D.appendChild(document.createElement("br")),U=document.createElement("span"),U.innerText=v.Ssb,D.appendChild(U));v.f3b?(V.jc=1,V.Fc(1,v.Tsb)):V.jc=0;V.Jk(v.io,null,v.icon,Object(x.a)(v,v.ntd,"legacyOICErrorDialogHandler"),D);V.gX("errorMessageText");
return v}function f(v,D,V,U){this.TMc=null;this.nRb=U;this.cY=v;this.dY=D;this.FD=V;this.nhe=this.npf.Cyj;v=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.wsg=v[0];this.vsg=v[1]}A=b(0);var x=b(80),y=b(13),t=b(5),B=b(49),z=b(413),u=b(86);f.prototype.HGd=function(v){this.UCb(v)};f.prototype.ntd=function(v){this.UCb(v)};f.prototype.UCb=function(v){var D=10;this.dY&&1===v&&(this.dY(this.FD),D=1);this.cY&&this.cY(this.FD);this.YF(D)};f.prototype.uOa=function(){z.Redirect.showHelp("OICFailure");
this.YF(2)};f.prototype.czd=function(){this.npf.dlf();this.YF(4)};f.prototype.YF=function(v){y.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.nRb,v);t.AFrameworkApplication.jtc(B.a.UFf,this.nRb,v)};f.prototype.dispose=function(){this.FD=this.cY=this.dY=null};Sk.Object.defineProperties(f.prototype,{npf:{configurable:!0,enumerable:!0,get:function(){return this.TMc||(this.TMc=u.a.instance.resolve("Common.IMacOfficeOffer"))}},id:{configurable:!0,enumerable:!0,
get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},Yva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Zwc:{configurable:!0,enumerable:!0,get:function(){return this.nhe}},ppf:{configurable:!0,enumerable:!0,get:function(){return this.wsg}},opf:{configurable:!0,enumerable:!0,get:function(){return this.vsg}},mpf:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},
icon:{configurable:!0,enumerable:!0,get:function(){return this.nhe?3:2}},Ssb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},f3b:{configurable:!0,enumerable:!0,get:function(){return!!this.dY}},Tsb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},io:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(A.a)(f,"AOICErrorDialog",null,[3]);var C=b(38),
r=b(128);vm(m,f);m.prototype.dispose=function(){this.Tl&&(C.a.removeHandler(this.Tl,"click",Object(x.a)(this,this.uOa,"oicErrorHelpLinkHandler")),this.Tl=null);this.Cqa&&(C.a.removeHandler(this.Cqa,"click",Object(x.a)(this,this.czd,"oicErrorMacOfferLinkHandler")),this.Cqa=null);f.prototype.dispose.call(this)};Object(A.a)(m,"OICErrorDialog",f,[]);n.prototype.HGd=function(v){this.UCb(v)};n.prototype.ntd=function(v){this.UCb(v)};n.prototype.UCb=function(v){var D=10;1===v&&(this.dY(this.FD),D=1);this.cY&&
this.cY(this.FD);this.YF(D)};n.prototype.uOa=function(){z.Redirect.showHelp("OICFailure");this.YF(2)};n.prototype.YF=function(v){t.AFrameworkApplication.jtc(B.a.VFf,3,v)};n.prototype.dispose=function(){this.FD=this.dY=this.cY=null};Sk.Object.defineProperties(n.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},MMe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},Yva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},
Ssb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},Tsb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},icon:{configurable:!0,enumerable:!0,get:function(){return 2}},io:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(A.a)(n,"AOICErrorDialogWithDownload",null,[3]);vm(l,n);l.prototype.dispose=function(){this.Tl&&(C.a.removeHandler(this.Tl,"click",
Object(x.a)(this,this.uOa,"oicErrorHelpLinkHandler")),this.Tl=null);n.prototype.dispose.call(this)};Object(A.a)(l,"OICErrorDialogWithDownload",n,[]);var J=b(140);vm(e,f);Object(A.a)(e,"ReactOICErrorDialog",f,[]);vm(c,n);Object(A.a)(c,"ReactOICErrorDialogWithDownload",n,[]);b.d(F,"a",function(){return a});a.prototype.n8g=function(v,D,V){this.gjb?new e(v,D,null,V):new m(v,D,null,V)};a.prototype.o8g=function(v,D,V){this.gjb?new c(v,D,V):new l(v,D,V)};a.prototype.p8g=function(v,D,V,U,Q){var la=b(1317).ReactOICErrorDialogWithTrial,
ba=b(1318).OICErrorDialogWithTrial;this.gjb?new la(v,D,V,null,U,Q):new ba(v,D,V,null,U,Q)};Sk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Oa||(a.Oa=new a)}}});a.Oa=null;Object(A.a)(a,"OICErrorDialogFactory",null,[806])},1251:function(A,F,b){function a(ea,qa){var pa=ja.call(this)||this;pa.Ma=new x.a;pa.mU=null;pa.KHc=[];pa.vmc=function(){pa.$.na.ULa?pa.removeEntry(13):pa.ig(13,null)};pa.Eya=function(){H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&
e.ULS.sendTraceTag(537170243,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");pa.removeEntry(21);pa.dC(54)&&(e.ULS.sendTraceTag(537170242,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),pa.removeEntry(54));pa.rSf("OnNetworkResumed")};pa.Nh=function(Ha,Xa){Ha=0;for(var Na=a.ncc().length;Ha<Na;Ha++){var db=a.ncc()[Ha];pa.removeEntry(db)}Xa.context&&0<Xa.context.communicationErrorRetryCount&&(e.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),
pa.removeEntry(21));pa.rSf("OnWebMethodSuccess")};pa.Mn=function(Ha,Xa){var Na;Ha=pa.UBh(Xa.errors);for(var db=[],Ja=0,jb=Ha.length;Ja<jb;++Ja){var hc=Ha[Ja];if(1===hc.Type&&hc.Appearance&32)db=pa.p5h(hc,db);else if(Xa.opj){e.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");var ma=(null===(Na=Xa.context)||void 0===Na?0:Na.stopwatch)?Xa.context.stopwatch.Dc:-1;5E3>ma?e.ULS.sendTraceTag(537170208,
0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",ma):l.AFrameworkApplication.Zqd()||pa.yDg(hc,Xa.context.methodName)}ma=[].concat(Gl(a.ncc()));for(var Ka=0,Ta=db.length;Ka<Ta;++Ka){var ob=db[Ka];pa.ig(ob,hc);Array.remove(ma,ob)}hc=0;for(Ka=ma.length;hc<Ka;++hc)pa.removeEntry(ma[hc])}};pa.PDb=function(Ha,Xa){Ha=0;for(var Na=Xa.errors.length;Ha<Na;++Ha){var db=Xa.errors[Ha];l.AFrameworkApplication.Zqd()||
(H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),pa.ig(54,db))}};pa.$c=function(Ha,Xa){pa.od(Ha,Xa)};pa.od=function(){var Ha=pa.$.ea;Ha.qc||Ha.Ng()||(pa.qId(),Array.clear(pa.KHc))};pa.rd=function(Ha,Xa){pa.$.ea.Ng()&&!Xa.tR||pa.taf(Xa.tR)};pa.yEb=function(){var Ha=pa.$.userOperationManager.$bc();Ha&&Ha.operation.flags&1&&pa.f4f()};pa.dzf=function(){pa.f4f()};pa.Mf=function(){pa.oye();
pa.o4f()};pa.VN=function(){if(pa.$.v5&&pa.$.ea.Ng()&&pa.$.ea.qc)if(pa.$.ea.isEditMode)pa.removeEntry(43),pa.removeEntry(12),pa.removeEntry(29),pa.removeEntry(30),pa.removeEntry(31),pa.removeEntry(32),pa.removeEntry(22),pa.removeEntry(55);else{var Ha=pa.$.da.Aa(331);Ha&&Ha.mJa||pa.removeEntry(53);pa.removeEntry(5)}};pa.$=ea;pa.aZa=qa;pa.XLg();l.AFrameworkApplication.Jd&&l.AFrameworkApplication.Jd.vUc(pa);pa.Jmb=Array(66);for(var Pa=0;66>Pa;Pa++)pa.Jmb[Pa]=null;pa.mh=ba.EcmaDateClock.instance;pa.Xjf=
pa.mh.Kb.getTime();qa&&(qa=ea.na,Pa=qa.sf,qa.Ky(pa.Mn),qa.uq(pa.Nh),qa.inb(pa.vmc),qa.DYa(pa.vmc),H.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(Pa.ZFg(pa.PDb),Pa.unb(pa.Eya)),ea.ea.Uj(pa.$c),ea.ea.Dt(pa.Mf),ea.Qk(pa.rd),ea.vl(pa.od),ea.ea.K9(pa.VN),ea.userOperationManager.lx(pa.yEb),H.EwaSettings.la(170)&&ea.ea.oh.get(45)&&l.AFrameworkApplication.ga.ra("SupportsPolicies")||pa.h7e(),pa.taf(da.c(ea)));ea.da.Ha(5,pa);return pa}function c(ea,qa,pa){pa=void 0===pa?null:
pa;var Pa=u.call(this)||this;Pa.f_a=ea;Pa.a7c=qa;Pa.data=pa;return Pa}A=b(0);var e=b(13),l=b(5),n=b(88),m=b(23),f=b(121),x=b(36),y=b(74),t;(function(ea){ea[ea.unableToRefreshLock=0]="unableToRefreshLock";ea[ea.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";ea[ea.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";ea[ea.workbookTooLarge=3]="workbookTooLarge";ea[ea.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";ea[ea.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";
ea[ea.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";ea[ea.unsupportedFeatures=7]="unsupportedFeatures";ea[ea.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";ea[ea.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";ea[ea.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";ea[ea.lastGenericStatusError=11]="lastGenericStatusError";ea[ea.scratchPadWarning=12]="scratchPadWarning";ea[ea.authenticationLost=13]=
"authenticationLost";ea[ea.odfCompatibilityIssues=14]="odfCompatibilityIssues";ea[ea.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";ea[ea.workbookIsIrmProtected=16]="workbookIsIrmProtected";ea[ea.biFeatureNotAvailable=17]="biFeatureNotAvailable";ea[ea.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";ea[ea.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";ea[ea.mobileAppCampaignBizBar=20]="mobileAppCampaignBizBar";ea[ea.transientServerCommunicationFailures=
21]="transientServerCommunicationFailures";ea[ea.editAttemptInReadOnly=22]="editAttemptInReadOnly";ea[ea.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";ea[ea.unsupportedBrowser=24]="unsupportedBrowser";ea[ea.readOnlyPermissions=25]="readOnlyPermissions";ea[ea.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";ea[ea.policyWarningMessage=27]="policyWarningMessage";ea[ea.workingOnIt=28]="workingOnIt";ea[ea.passwordProtectedWorkbookLockedForEdit=29]=
"passwordProtectedWorkbookLockedForEdit";ea[ea.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";ea[ea.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";ea[ea.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";ea[ea.legacyConnectionsBB=33]="legacyConnectionsBB";ea[ea.groupedSlicersBB=34]="groupedSlicersBB";ea[ea.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";ea[ea.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";ea[ea.wacGdprNotice=
37]="wacGdprNotice";ea[ea.automaticSensitivityLabel=38]="automaticSensitivityLabel";ea[ea.recommendedSensitivityLabel=39]="recommendedSensitivityLabel";ea[ea.mandatorySensitivityLabel=40]="mandatorySensitivityLabel";ea[ea.localStorageDisabled=41]="localStorageDisabled";ea[ea.autoRefreshDisabled=42]="autoRefreshDisabled";ea[ea.corruptedFileRepaired=43]="corruptedFileRepaired";ea[ea.corruptedOdsFileRepaired=44]="corruptedOdsFileRepaired";ea[ea.minorVersionLimitReached=45]="minorVersionLimitReached";
ea[ea.sensitivityApplicationGenericError=46]="sensitivityApplicationGenericError";ea[ea.sensitivityApplicationTooLargeFileError=47]="sensitivityApplicationTooLargeFileError";ea[ea.sensitivityApplicationLabelNotSupportedError=48]="sensitivityApplicationLabelNotSupportedError";ea[ea.sensitivityApplicationLabelDisabledError=49]="sensitivityApplicationLabelDisabledError";ea[ea.sensitivityApplicationMandatoryConflictError=50]="sensitivityApplicationMandatoryConflictError";ea[ea.sensitivityApplicationMinorVersionLimitReachedError=
51]="sensitivityApplicationMinorVersionLimitReachedError";ea[ea.sensitivityApplicationSetLabelError=52]="sensitivityApplicationSetLabelError";ea[ea.promptEnableExternalLinks=53]="promptEnableExternalLinks";ea[ea.networkDown=54]="networkDown";ea[ea.defaultToViewDueToCogs=55]="defaultToViewDueToCogs";ea[ea.refreshLinkedEntityErrorBar=56]="refreshLinkedEntityErrorBar";ea[ea.promptEnableLinkedEntitiesUntrustedImages=57]="promptEnableLinkedEntitiesUntrustedImages";ea[ea.canvasHealth=58]="canvasHealth";
ea[ea.novModeDepreciation=59]="novModeDepreciation";ea[ea.mismatchedFileFormatConverted=60]="mismatchedFileFormatConverted";ea[ea.optimizeWorkbook=61]="optimizeWorkbook";ea[ea.novModePostDepreciation=62]="novModePostDepreciation";ea[ea.officeScriptsRunning=63]="officeScriptsRunning";ea[ea.powerQueryRefreshDataSourceNotSupported=64]="powerQueryRefreshDataSourceNotSupported";ea[ea.readOnlyPivotTable=65]="readOnlyPivotTable";ea[ea.count=66]="count"})(t||(t={}));Object(A.b)("EwaBusinessBarEntryType",
t);var B=b(4),z=b(1172),u=Sys.EventArgs;vm(c,u);Object(A.a)(c,"BusinessBarEntryDisplayChangedEventArgs",Sys.EventArgs,[]);var C=b(1174),r=b(1173),J=b(1176),v=b(1175),D=b(1170),V=b(479),U=b(56),Q=b(216),la=b(35),ba=b(691),T=b(27),H=b(1),S=b(9),K=b(20),da=b(55),fa=b(65),X=b(974),ca=b(176);b.d(F,"a",function(){return a});var ja=y.a;vm(a,ja);a.prototype.h7e=function(){T.a.er(this.$.ea.MF)&&this.Mn(this,new V.a(this.$.ea.MF,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.cEg=function(ea){this.Ma.addHandler("bBarAttachedOrDetached",
ea)};a.prototype.dispose=function(){if(this.$){var ea=this.$,qa=ea.na,pa=qa.sf;qa.Ez(this.Mn);qa.yr(this.Nh);qa.tsc(this.vmc);qa.aHb(this.vmc);pa.qHb(this.Eya);pa.hdj(this.PDb);ea.ea.lk(this.$c);ea.ea.Ew(this.Mf);ea.pl(this.rd);ea.sn(this.od);ea.ea.Z6(this.VN);ea.userOperationManager.jv(this.yEb);K.g(ea).yc.ol(this.dzf)}n.a.Fa(this.mU);this.$=this.mU=null;ja.prototype.dispose.call(this)};a.prototype.mgi=function(ea){switch(ea){case 4:case 5:case 11:case 53:case 7:case 36:return!0;case 57:return H.EwaSettings.la(680);
default:return!1}};a.prototype.ig=function(ea,qa,pa,Pa,Ha){pa=void 0===pa?null:pa;Pa=void 0===Pa?null:Pa;Ha=void 0===Ha?null:Ha;if(!this.$.isMobileMode||this.mgi(ea))this.aZa&&!this.dC(ea)&&(H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: {0}",Enum.toString(t,ea)),this.Jmb[ea]=this.mh.Lea,this.mU.$D(ea,qa,Pa,Ha),this.Ma.raiseEvent("bBarAttachedOrDetached",new c(ea,!0,pa))),qa&&32===qa.Appearance&&fa.a(this.$).qd.Ala(qa)};
a.prototype.rBj=function(ea,qa,pa,Pa){e.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");D.a.initialize(ea,qa,pa,Pa);this.ig(37,null)};a.prototype.sAj=function(ea,qa,pa,Pa){z.a.initialize(ea,qa,pa,Pa);this.ig(38,null)};a.prototype.FCj=function(ea,qa,pa,Pa){r.a.initialize(ea,qa,pa,Pa);this.ig(39,null)};a.prototype.UBj=function(ea,qa,pa,Pa){C.a.initialize(ea,qa,pa,Pa);this.ig(40,null)};a.prototype.PCj=function(ea,qa,pa,Pa){v.a.initialize(ea,qa,pa,Pa);this.ig(51,null)};a.prototype.OCj=
function(ea,qa,pa,Pa){J.a.initialize(ea,qa,pa,Pa);this.ig(52,null)};a.prototype.removeEntry=function(ea){this.aZa&&(H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&e.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: {0}",Enum.toString(t,ea)),this.Jmb[ea]=null,this.mU.removeEntry(ea)&&this.Ma.raiseEvent("bBarAttachedOrDetached",new c(ea,!1)))};a.prototype.kMa=function(ea){return this.aZa?this.mU.kMa(ea):!1};a.prototype.dC=function(ea){return this.aZa?this.mU.dC(ea):
!1};a.prototype.qCb=function(){e.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};a.prototype.Hlc=function(){e.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)};a.prototype.XLg=function(){var ea=b(1225).BusinessBarControl;if(this.aZa&&!this.mU){K.g(this.$).yc.Yl(this.dzf);var qa=document.getElementById(this.$.Ib+B.a.Bve);this.mU=new ea(this.$,
qa)}};a.prototype.qId=function(){this.aZa&&this.mU.qId()};a.prototype.rSf=function(ea){if(H.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var qa=this.mh.Lea;if(3E5<=qa-this.Xjf){this.Xjf=qa;for(var pa=0;66>pa;pa++){var Pa=this.Jmb[pa];Pa&&(Pa=qa-Pa,3E5<=Pa&&e.ULS.sendTraceTag(537170241,0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",ea,Enum.toString(t,pa),Pa))}}}};a.prototype.UBh=function(ea){for(var qa=[],pa=yl(ea),Pa=pa.next();!Pa.done;Pa=pa.next())switch(Pa.value.MessageId){case -113742550:Pa=
[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.ea.isNamedObjectViewMode||T.a.kh(ea,Pa))&&Array.add(qa,-113742550)}return T.a.SF(ea,qa)};a.prototype.p5h=function(ea,qa){switch(ea.MessageId){case 2113407564:for(var pa=T.a.c_a([1821390342,-943219229,-502303485,1437034227]),Pa=0;Pa<pa.length;Pa++)pa[Pa].HelpTopicId=ea.HelpTopicId,pa[Pa].HelpDescription=ea.HelpDescription,Array.add(this.KHc,pa[Pa])}switch(ea.MessageId){case -395951567:this.ig(6,ea);break;
case 1643490758:this.ig(4,ea);break;case -907264831:this.ig(5,ea);break;case 757111532:case 2113407564:this.ig(7,ea);break;case 2010656511:this.ig(15,ea);break;case 1321660996:this.$.C5c=!0;this.ig(8,ea);break;case 526339737:this.$.C5c=!0;this.ig(9,ea);break;case -407088521:this.ig(10,ea);break;case 1756116017:this.ig(14,ea);break;case -1703455218:this.ig(17,ea);break;case 1393475740:this.ig(25,ea);break;case -949523941:this.ig(26,ea);break;case 1779381952:this.ig(42,ea);break;case 1421575100:this.ig(43,
ea);break;case 613676060:this.ig(44,ea);break;case 1233668252:this.ig(60,ea);break;case 1911608588:ea=!!(this.$.Hd&64);!this.$.ea.Ng()&&ea&&Array.add(qa,29);break;case 1544494907:break;case -655555355:Array.add(qa,this.ord()?1:0);break;case -1221382671:Array.add(qa,2);break;case 1662282929:Array.add(qa,3);break;case 104919273:this.$.ea.Ng()||Array.add(qa,30);break;case -689453604:ea=!!(this.$.Hd&64);this.$.ea.x8e=!0;!this.$.ea.Ng()&&ea&&Array.add(qa,31);break;case 157762400:this.$.ea.Dgc=!0;!this.$.ea.Ng()&&
this.$.Hd&64&&!this.$.isEditMode&&Array.add(qa,32);break;case -73730134:H.EwaSettings.isChangeGateEnabled("OfficeVSO:6079602_EnableEditingOfFilesWithLegacyConnections")&&!this.$.ea.Ng()&&this.$.Hd&64&&Array.add(qa,33);break;case -293349236:Array.add(qa,64);break;case -37299333:break;case 136737622:Array.add(qa,45);break;case -1780327030:this.ig(53,ea);break;case -113742550:this.ig(55,ea);break;case -260312420:this.$.ea.Ng()||Array.add(qa,65);break;default:this.ig(11,ea)}return qa};a.prototype.rai=
function(){var ea=this;if(l.AFrameworkApplication.ga.ra("WildFireExcelBizBar")&&!X.a.jpd(X.a.Bdd(1))&&(m.a.Vp||m.a.ah)){var qa=U.GetServiceTaskFactory.create(this.$.da,155,this.$.ma,1);la.TaskExtensions.Ba(qa,function(){ea.ig(20,null)},this.ma,3)}};a.prototype.oai=function(){var ea=H.EwaSettings.la(74),qa=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled",!1),pa=H.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockStringIsEnabled",
!1);S.HelperMethods.kRd(pa||qa,ea)&&(ca.a("NewBrowserSuggestionShown"),pa||f.a.pv("NewBrowserSuggestionShown","true",7),this.ig(24,null))};a.prototype.L$h=function(ea){!ea&&Q.g(this.$)&&this.ig(59,null)};a.prototype.M$h=function(ea){!ea&&Q.h(this.$)&&this.ig(62,null)};a.prototype.taf=function(ea){(!ea&&!this.$.printingEnabled||this.$.jg.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(e.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),
this.ig(16,null));this.rai();this.oai();this.oye();this.o4f();this.L$h(ea);this.M$h(ea)};a.prototype.oye=function(){this.$.workbookContext.Options&32768&&this.gBj()};a.prototype.gBj=function(){this.Jmb[36]||this.ig(36,null)};a.prototype.o4f=function(){H.EwaSettings.la(680)&&this.$.workbookContext.Options&524288&&this.ig(57,null)};a.prototype.L4f=function(ea,qa){this.ig(56,ea,null,qa)};a.prototype.xme=function(ea,qa){var pa=null,Pa=null;pa=void 0===pa?null:pa;Pa=void 0===Pa?null:Pa;qa=void 0===qa?
null:qa;this.mU.dC(ea)?this.mU.wNb(ea,qa):this.ig(ea,null,pa,Pa,qa)};a.prototype.f4f=function(){this.$.Hd&8&&this.ig(12,null)};a.prototype.ord=function(){var ea=this.$.da.Aa(38);return ea?ea.tokenExpired:!1};a.prototype.yDg=function(ea,qa){if(!this.dC(21)&&-1387426400!==ea.MessageId){e.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");var pa={};pa.FailedMethod=qa;this.ig(21,ea,pa)}};a.ncc=function(){return a.Ppe||(a.Ppe=[0,1,2,3])};Sk.Object.defineProperties(a.prototype,
{f8c:{configurable:!0,enumerable:!0,get:function(){return this.KHc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.mU?this.mU.domElement:null}}});a.Ppe=null;Object(A.a)(a,"BusinessBarManager",y.a,[723,3,143])},1267:function(A,F,b){function a(B,z,u,C,r,J){this.eOc=null;this._id=B;this.MOc=z;this.Hpg=void 0===r?null:r;this.$ib=C;this.olb=void 0===J?null:J;this.ppa=null;this.XXa=u;this.Nlb=c.instance.RZh(z,B)}function c(){this.NEc=new f.a;this.LEc=new f.a;this.KEc=new f.a;this.VPg(this.NEc);
this.UPg(this.LEc);this.TPg(this.KEc);this.SJc=new f.a;this.RJc=new f.a;this.QJc=new f.a;this.sSg(this.SJc);this.rSg(this.RJc);this.qSg(this.QJc);this.cGc=new f.a;this.nQg(this.cGc);this.wFa(this.cGc);this.wFa(this.KEc);this.wFa(this.LEc);this.wFa(this.NEc);this.wFa(this.RJc);this.wFa(this.SJc);this.wFa(this.QJc)}A=b(0);var e=b(13),l=b(80),n=b(988),m=b(974),f=b(1246);c.prototype.RZh=function(B,z){switch(B){case 1:return this.c2h(z);case 2:return this.eKh(z)}return m.a.mxc?this.cGc:null};c.prototype.VPg=
function(B){B.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};c.prototype.UPg=function(B){B.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};c.prototype.TPg=function(B){B.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};c.prototype.sSg=function(B){B.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);B.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);
B.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);B.add("OverlayBig","Get the Word app");B.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");B.add("OverlaySmallSplit1","Discover Word");B.add("OverlaySmallSplit2","designed for the iPad.");B.add("SkipButton","Skip for now")};c.prototype.nQg=function(B){B.add("Headline","Get the Office Online extension for Chrome");B.add("UseAppButton","Get the extension");B.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};
c.prototype.rSg=function(B){B.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);B.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);B.add("OverlayBig","Get the PowerPoint app");B.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");
B.add("OverlaySmallSplit1","Discover PowerPoint");B.add("OverlaySmallSplit2","designed for the iPad.");B.add("SkipButton","Skip for now")};c.prototype.qSg=function(B){B.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);B.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);B.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);B.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);B.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};
c.prototype.wFa=function(B){B.add("Corporation","Microsoft Corporation")};c.prototype.c2h=function(B){switch(B){case 3:return this.SJc;case 2:return this.RJc;case 1:return this.QJc}return null};c.prototype.eKh=function(B){switch(B){case 3:return this.NEc;case 2:return this.LEc;case 1:return this.KEc}return null};Sk.Object.defineProperties(c,{instance:{configurable:!0,enumerable:!0,get:function(){c.Oa||(c.Oa=new c);return c.Oa}}});c.Oa=null;Object(A.a)(c,"WildFireStringFactory",null,[]);var x=b(5),
y=b(47),t=b(23);b.d(F,"a",function(){return a});a.prototype.y3c=function(){this.ppa=new n.a(this.title,this.message,null);this.ppa.addButton(this.Jve,Object(l.a)(this,this.tvf,"onButtonOneClick"),"");this.XXa&&this.ppa.KCg(this.Lve,Object(l.a)(this,this.wvf,"onButtonTwoClick"));this.ppa.w$=Object(l.a)(this,this.NIe,"dismissBar");this.ppa.image=3;this.ppa.id=16;this.ppa.closeable=!0};a.prototype.tvf=function(){this.XXa?this.tdi():this.nVj()};a.prototype.wvf=function(){this.XXa&&this.WVi()};a.prototype.tdi=
function(){e.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.$ib&&this.olb&&this.olb();m.a.YNf(this._id,this.MOc)};a.prototype.WVi=function(){this.openUrl&&(e.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.$ib&&this.olb&&this.olb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(m.a.Mqe(this._id),this.openUrl,0,!1))};a.prototype.nVj=function(){m.a.mxc?this.zSg():(e.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),
m.a.tPd("BizBarClicked"),1!==this.MOc&&2!==this.MOc||m.a.bZg(this.openUrl,this.$ib,this._id,this.olb))};a.prototype.zSg=function(){this.$ib?e.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):e.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");y.a.fV(x.AFrameworkApplication.ga.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.Mfh=function(){this.$ib?e.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):e.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");
m.a.tPd(m.a.Pye)};a.prototype.NIe=function(){m.a.mxc?this.Mfh():(m.a.tPd(m.a.Bdd(this._id)),e.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.y4b=function(){var B=x.AFrameworkApplication.sa.Qa,z=new a(B.Pj,m.a.lcc(),8<t.a.l5a,1===B.nca,function(){return B.eC},B.NVf());e.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return z};Sk.Object.defineProperties(a.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.Nlb.oa("Headline")}},message:{configurable:!0,
enumerable:!0,get:function(){return this.Nlb.oa("CallToAction")}},wVj:{configurable:!0,enumerable:!0,get:function(){return this.XXa}},Jve:{configurable:!0,enumerable:!0,get:function(){return this.XXa?this.Nlb.oa("InstallButton"):this.Nlb.oa("UseAppButton")}},Lve:{configurable:!0,enumerable:!0,get:function(){return this.XXa?this.Nlb.oa("OpenAppButton"):""}},wSg:{configurable:!0,enumerable:!0,get:function(){return this.ppa}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.eOc||(this.eOc=
this.Hpg());return this.eOc}}});Object(A.a)(a,"WildFireBusinessBar",null,[])},1317:function(A,F,b){function a(m,f,x,y,t,B){var z=n.call(this,m,f,x,y,t,B)||this;m={};f=(m.errorMessage=z.LMe,m.offerString=z.Utf,m);m=new l.a(!1,!1,!0);z.g4f?(m.jc=1,x={},f.helpLink=(x.type="AppLinkProps",x.id="helpLink",x.text=z.Yva,x.onExecute=function(){e.Redirect.showHelp(z.d9e)},x)):(m.jc=4,m.Fc(2,z.t$e));m.Fc(1,z.zXb);m.Ue=z.id;x={};f=(x.id=z.id,x.dialogIcon=z.icon,x.bodyControls=f,x);m.initializeAndShow(z.io,Object(c.a)(z,
z.l6i,"reactOICErrorDialogWithTrialHandler"),f);return z}b.r(F);b.d(F,"ReactOICErrorDialogWithTrial",function(){return a});A=b(0);var c=b(80);F=b(1177);var e=b(413),l=b(140),n=F.a;vm(a,n);Object(A.a)(a,"ReactOICErrorDialogWithTrial",F.a,[])},1318:function(A,F,b){function a(n,m,f,x,y,t){n=l.call(this,n,m,f,x,y,t)||this;m=document.createElement("span");m.innerText=n.LMe;m.appendChild(document.createElement("br"));m.appendChild(document.createElement("br"));f=document.createElement("span");f.innerText=
n.Utf;m.appendChild(f);f=new e.StandardDialog;n.g4f?(f.jc=1,f.jme(n.Yva,n.d9e)):(f.jc=4,f.Fc(2,n.t$e));f.Fc(1,n.zXb);f.Ue=n.id;f.Jk(n.io,null,n.icon,Object(c.a)(n,n.Csi,"legacyOICErrorDialogWithTrialHandler"),m);return n}b.r(F);b.d(F,"OICErrorDialogWithTrial",function(){return a});A=b(0);var c=b(80);F=b(1177);var e=b(128),l=F.a;vm(a,l);Object(A.a)(a,"OICErrorDialogWithTrial",F.a,[])},1319:function(A,F,b){function a(){return c.call(this)||this}b.r(F);b.d(F,"CheckRoamingRightsRequest",function(){return a});
A=b(0);b=b(1179);var c=b.a;vm(a,c);a.prototype.f4a=function(){return 2};a.prototype.wja=function(){return 1};Object(A.a)(a,"CheckRoamingRightsRequest",b.a,[])},1320:function(A,F,b){function a(){return c.call(this)||this}b.r(F);b.d(F,"GetRoamingLauncherRequest",function(){return a});A=b(0);b=b(1179);var c=b.a;vm(a,c);a.prototype.f4a=function(){return 0};a.prototype.wja=function(){return 2};Object(A.a)(a,"GetRoamingLauncherRequest",b.a,[])},1337:function(A,F,b){function a(x){this.aGc=!1;this.nXa=a.Cec;
this.PPc=this.SNc=0;this.platform=null;this.pvg=x;this.Aje=this.QPc=!1}function c(){this.state=this.callback=null;this.vod=!1}function e(){this.classId=0}A=b(0);var l=b(80),n=b(40);e.jIa=function(x){try{return n.a(x)}catch(y){}return null};Object(A.a)(e,"ARoamingAppsResponse",null,[]);Object(A.a)(c,"GetRoamingAppsLauncherContext",null,[]);var m=b(5),f=b(108);b.d(F,"a",function(){return a});a.prototype.zXg=function(){m.AFrameworkApplication.Wgc&&this.roamingAppsAreEnabled&&!this.QPc&&!this.aGc&&(this.PPc=
1,this.aGc=!0,this.Bhj(),this.aSe())};a.prototype.Bhj=function(){this.nXa=a.Cec;this.SNc=0};a.prototype.getRoamingAppsLauncher=function(x,y,t){this.GVj?(x=new c,x.callback=y,x.state=t,x.vod=!0,this.fSe(x)):y(!1,"",t)};a.prototype.aSe=function(){var x=new (b(1319).CheckRoamingRightsRequest);x.RoamingApp=this.PPc;x.BaseDocQuerySignature=m.AFrameworkApplication.mj;x.execute(Object(l.a)(this,this.BXg,"checkUserRoamingRightsSucceeded"),Object(l.a)(this,this.AXg,"checkUserRoamingRightsFailed"),null)};a.prototype.BXg=
function(x){m.AFrameworkApplication.Ig||((x=e.jIa(x.data.ie))?this.vPd(x.HasRights):this.vPd(!1))};a.prototype.AXg=function(){if(!m.AFrameworkApplication.Ig)if(this.SNc>=a.Rzi)this.vPd(!1);else{var x=new f.a(2,1,this.nXa,Object(l.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);m.AFrameworkApplication.hj.Zg(x);this.SNc++;this.nXa*=a.Vij;this.nXa>a.cqf&&(this.nXa=a.cqf)}};a.prototype.vPd=function(x){this.Aje=x;this.QPc=!0;this.aGc=!1};a.prototype.retryCheckUserRoamingRights=
function(){this.aSe()};a.prototype.fSe=function(x){var y=new (b(1320).GetRoamingLauncherRequest);y.RoamingApp=this.PPc;y.BaseDocQuerySignature=m.AFrameworkApplication.mj;y.execute(Object(l.a)(this,this.ZXh,"getRoamingAppsLauncherSucceeded"),Object(l.a)(this,this.YXh,"getRoamingAppsLauncherFailed"),x)};a.prototype.ZXh=function(x){if(!m.AFrameworkApplication.Ig){var y=e.jIa(x.data.ie);x=x.data.state;y?(this.platform=y.Platform,x.callback(!0,y.Launcher,x.state)):x.callback(!1,"",x.state)}};a.prototype.YXh=
function(x){if(!m.AFrameworkApplication.Ig){var y=x.data.state;5===x.data.status&&y.vod?(y.vod=!1,this.fSe(y)):y.callback(!1,"",y.state)}};Sk.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.pvg}},GVj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.QPc?this.Aje:!1}}});Sk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.SB||(a.SB=new a(m.AFrameworkApplication.pLg))}}});
a.Cec=1E3;a.Vij=5;a.cqf=12E5;a.Rzi=5;a.SB=null;Object(A.a)(a,"RoamingAppsManager",null,[])},1372:function(A,F,b){function a(L){return gl.call(this,L)||this}function c(L,oa,Wa){var Rb=this;this.ignorePrintArea=!1;this.mNj=function(){var xc=tg.g(Rb.$).Ca;Rb.NQc=!0;xc.wyd()};this.FQi=function(){Rb.cjd()};this.EQi=function(xc,id,rd){td.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",rd);Rb.cjd()};this.$=L;this.ea=L.ea;this.zia=oa;this.dO=
new H(1,this.ignorePrintArea);this.jD=oa=new e(L,oa,Od.AFrameworkApplication.Jd,Wa);this.$.da.Ha(418,oa);this.OJf=new J(L);this.$.da.Ha(384,this);this.NQc=!1}function e(L,oa,Wa,Rb){var xc=this;this.activeCell=this.selectedRange=this.tg=this.graphServiceEndpoint=null;this.Z_=0;this.Gm=this.fv=null;this.DH=new r;this.tk=new r;this.Sba=0;this.H7a=null;this.ULb=!1;this.b3a=this.TEb=null;this.Ypd=!1;this.F6a=this.kzb=this.ahc=!0;this.tma=this.Wya=this.hNa=null;this.qyb=!1;this.E7a=null;this.$5a=this.iLc=
!1;this.nAd=function(id){if(!(id&&id.data&&id.data.ie&&id.data.responseHeaders&&id.data.ie.length)){var rd=id?id.data?id.data.ie?id.data.responseHeaders?id.data.ie.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";xc.tg&&(id=xc.bAa(pe.a.instance.fa(1168)),xc.Sna(id,0));td.ULS.sendTraceTag(593266765,0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",
rd);xc.uKd&&(id=Object.assign(new nj.a,{extendedProperties:new Map}),id.extendedProperties.set("InvalidParameterName",rd),gh.Health.instance.recordQosError(Aj.a.QJf,[ag.a.RJf],!1,!0,!0,!1,id))}else if(0<xc.Sba&&id.data.id===xc.Sba){if(id.data.responseHeaders["Content-Type"]&&(Ib.a.contains(id.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||Ib.a.contains(id.data.responseHeaders["Content-Type"].toString(),"text/plain",!0))){td.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");
var $d=null;Ib.a.contains(id.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&($d=xc.d5g(id));rd={};xc.iDb(rd,null,null,$d);id.data.responseHeaders["Total-Pdf-PageCount"]?($d=parseInt(id.data.responseHeaders["Total-Pdf-PageCount"].toString(),10),xc.qyb||(xc.kFd>=$d?xc.tma=$d:xc.qyb=!0),xc.F6a&&xc.tg&&xc.tg.setPageRangeSettings($d,xc.kFd,xc.qyb,xc.Wya,xc.tma)):td.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else rd=
zk.a.pi(id.data.ie),Qg.a.b$(rd.Errors)||dg.a(xc.$).qd.ZD(rd.Errors[0].MessageId),xc.Z7i(rd.Errors),xc.tg&&($d=xc.bAa(rd.Errors[0].Description),-1831476778===rd.Errors[0].MessageId?(td.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),xc.Sna($d,0,pe.a.instance.fa(1171))):xc.Sna($d,0)),297284985===rd.Errors[0].MessageId?td.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",
rd.Errors[0].MessageId):td.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",rd.Errors[0].MessageId);id=id.data.state;id.K9c(rd,id.userContext,id.methodName)}};this.mAd=function(id){if(0<xc.Sba&&id.data.id===xc.Sba){var rd=Vg.a.og(id.data);xc.tg&&xc.Sna(xc.bAa(rd[0].Description),1);td.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Qg.a.Tc(rd));rd=id.data.state;
rd.raa(id,rd.userContext,rd.methodName);xc.$.userOperationManager.kla.operation.yAa(function(){return xc.ULb})}};this.KJi=function(id,rd,$d){id.Errors&&0<id.Errors.length&&xc.tg?(Qg.a.b$(id.Errors)||dg.a(xc.$).qd.ZD(id.Errors[0].MessageId),xc.Sna(xc.bAa(id.Errors[0].Description),0),td.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",id.Errors[0].MessageId)):(td.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),
xc.iDb(id,rd,$d,null))};this.JJi=function(id){id=Vg.a.og(id.data);xc.tg&&xc.Sna(xc.bAa(id[0].Description),1);td.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",Qg.a.Tc(id));xc.$.userOperationManager.kla.operation.yAa(function(){return xc.ULb})};this.aBf=function(id,rd){if(rd)switch(rd.U1i){case 1:if(xc.tk&&xc.b3a)switch(id=xc.b3a.Dc,xc.b3a.stop(),xc.b3a=null,xc.tk.xv){case 1:xc.$_c(id,4800,"ActiveSheet");break;case 0:xc.$_c(id,6100,"CurrentSelection");
break;case 2:xc.$_c(id,7500,"EntireWorkbook")}break;case 0:xc.TEb&&(id=xc.TEb.Dc,xc.TEb.stop(),2400<id&&(rd=Object.assign(new nj.a,{extendedProperties:new Map}),rd.extendedProperties.set("PaneLoadTime",id.toString()),gh.Health.instance.recordQosError(Aj.a.yEj,[ag.a.O5f],!1,!0,!0,!1,rd)),xc.fv.Fei(function($d){xc.vCj($d)}))}};this.HF=function(id,rd){(1===rd.Bw&&xc.hNa===rd.Pg||2===rd.Bw)&&xc.eLd()};this.$=L;this.zia=oa;this.i3=Wa;this.Pyd=Rb;this.uKd=Hh.HelperMethods.c_;this.Ma=new Nh.a;this.kFd=this.$.ya.PrintPreviewerPaginationRange;
this.Ywa=jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",!1);this.useMSPdfViewer=this.bAj();this.Abi();this.Xfi=this.XWg();this.Xpd=jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1);if(this.isUniversalPrintEnabled=!!Rb&&Rb.TLa()&&jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.jg.get(116))this.graphServiceEndpoint=this.$.ya.GraphServiceEndpoint}function l(){this.appName=this.disabledChangeGates=
this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function n(){this.onBackToSheet=null}function m(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=null}function f(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=
this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function x(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function y(L,oa,Wa,Rb,xc,id){var rd=B.call(this,xc)||this;rd.Md=!1;rd.G5f=!1;rd.rBd=function($d){rd.jD.rBd($d)};rd.ABd=function($d){rd.jD.ABd($d)};rd.nSi=function(){td.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};
rd.mSi=function($d){$d=Vg.a.og($d.data);td.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",Qg.a.Tc($d))};rd.HF=function($d,Be){2===Be.Bw?rd.ev.clear():1===Be.Bw&&rd.ev&&rd.ev.contains(Be.Pg)&&(td.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",pk.a(Be.Pg.operation.operationName),Be.Pg.dequeueUtcTime.getTime()-Be.Pg.enqueueUtcTime.getTime()),
rd.ev.remove(Be.Pg))};rd.jD=L;rd.dO=Wa;rd.$=oa;rd.sheetName=Rb;rd.locale=window.navigator.browserLanguage||window.navigator.language||rd.$.ya.UICultureTag;rd.FXi=rd.f3g();rd.$.userOperationManager.lx(rd.HF);rd.ev=new ua.a;rd.Ywa=jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",!1);rd.isUniversalPrintEnabled=id;return rd}function t(L,oa){this.sheetPrintOptions=this.sheetName=null;this.sheetName=L;this.sheetPrintOptions=oa}function B(L){this.oEi=[.75,.75,.7,.7,.3,.3];this.dDi=
[.75,.75,.25,.25,.3,.3];this.sYj=[1,1,1,1,.5,.5];this.ebe=this.lge=this.zde=this.ide=this.Zje=this.G6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Lm=L;this.Obi();this.Wbi()}function z(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function u(){this.footer=this.header=this.bottom=this.top=this.right=this.left=0}function C(){this.marginValue=this.printSettingOption=null}function r(){this.margin=this.v0=this.Dca=this.orientation=this.xv=0;this.ignorePrintArea=
!1;this.sheetPrintOptions=null;this.E1a=!1;this.NoColor=null}function J(L){var oa=this;this.ribbonCommandInfo=this.GEb=null;this.sNj=function(Wa,Rb,xc){Rb=!!Wa&&!!Wa.RequestTelemetryData;tg.g(oa.$).Mi&&tg.g(oa.$).Mi.Bla(oa.NKa.oa(oa.ribbonCommandInfo.command),Wa.StateId,Rb?Wa.RequestTelemetryData.EcsOperationDuration:0,Rb?Wa.RequestTelemetryData.EcsRequestDuration:0,Rb?Wa.RequestTelemetryData.WfeRequestDuration:0);Hh.HelperMethods.c_&&oa.RWg(xc)};this.$=L;this.NKa=new ni.a;this.Kva=new ni.a;this.Kva.add(78661008,
12);this.Kva.add(275604654,13);this.Kva.add(-13332329,14);this.Kva.add(-837651977,9);this.Kva.add(-1778266776,10);this.Kva.add(845325699,11);this.Xpd=jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",!1)}function v(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function D(){this.Max=this.Min=this.Index=0}function V(){this.Col=this.Row=null}function U(L){this.sheetName=null;this.sheetName=L}function Q(L){this.sheetName=null;this.sheetName=L}
function la(L){this.sharedSheetCell=null;this.sharedSheetCell=L}function ba(L){this.sharedSheetCell=null;this.sharedSheetCell=L}function T(L,oa){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=L;this.addToPrintArea=oa}function H(L,oa){this.H6=0;this.m8d=!1;this.xv=L;this.ignorePrintArea=oa}function S(L,oa,Wa,Rb,xc,id,rd,$d){var Be=ja.call(this,L,oa,Wa,Rb,xc,jf.EwaSettings.la(407))||this;Be.Tca=null;Be.gaa=null;Be.gec=null;Be.QSd=!1;Be.sxa=null;Be.M$a=null;Be.Yya=null;Be.eAa=null;Be.r5a=
null;Be.oza=1;Be.Gma=1;Be.Y_=0;Be.H6=1;Be.OFb=!1;Be.ns=null;Be.EIb=0;Be.DIb=0;Be.Zya=null;Be.fAa=null;Be.selectedRange=null;Be.Z_=0;Be.n9a=function(){Be.Z_++;Be.H6=Be.AZc();Be.m8c(Be.gaa.checked?!0:!1);Be.z7&&(Be.gec.disabled=Be.Yv.checked);Be.vOd(Be.gaa.checked?!0:!1);td.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",Be.H6.toString());return!0};Be.Hvf=function(){Be.Z_++;Be.OFb=Be.r5a.checked;td.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",
Be.OFb.toString())};Be.Cmc=function(){Be.Z_++;Be.oza=Be.lwe();td.ULS.sendTraceTag(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",Be.oza.toString());return!0};Be.Ivf=function(){Be.Z_++;var gg=Be.Gma;Be.Gma=S.paperSizeOptions[Be.Yya.selectedIndex];td.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",gg.toString(),Be.Gma.toString());return!0};Be.Jvf=function(){Be.Z_++;var gg=Be.Y_;Be.Y_=S.scalingOptions[Be.eAa.selectedIndex];
2===Be.Y_?(Be.EIb=1,Be.DIb=0):3===Be.Y_?(Be.EIb=0,Be.DIb=1):1===Be.Y_&&(Be.EIb=1,Be.DIb=1);td.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",gg.toString(),Be.Y_.toString());return!0};Be.nAd=function(gg){if(gg&&gg.data&&gg.data.ie&&gg.data.responseHeaders&&gg.data.ie.length){if(gg.data.responseHeaders["Content-Type"]&&Ib.a.contains(gg.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){td.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");
var Wg={};Be.iDb(Wg,null,null)}else Wg=zk.a.pi(gg.data.ie),td.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",Wg.Errors[0].MessageId);gg=gg.data.state;gg.K9c(Wg,gg.userContext,gg.methodName)}else td.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",gg?gg.data?gg.data.ie?gg.data.responseHeaders?gg.data.ie.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":
"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};Be.mAd=function(gg){var Wg=Vg.a.og(gg.data);td.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Qg.a.Tc(Wg));Wg=gg.data.state;Wg.raa(gg,Wg.userContext,Wg.methodName)};Be.iDb=function(gg){gg.Errors&&0<gg.Errors.length?td.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",
gg.Errors[0].MessageId):(6===Be.ae.af&&Od.AFrameworkApplication.sa.Se.ek(tg.g(Be.$).SWf),td.ULS.shipAssertTag(537154309,0,!!Be.$.xa.pa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),Be.$.xa.pa&&Be.zia.H4f(Be.CHa()))};Be.zia=id;Be.activeCell=Be.$.pa.activeCell.toString();Be.Gm.SelectedRanges&&Be.Gm.SelectedRanges.Ranges&&0<Be.Gm.SelectedRanges.Ranges.length&&Be.Gm.SelectedRanges.Ranges[0]&&(Be.selectedRange=Ef.B(Be.Gm.SelectedRanges.Ranges[0]).toString());
Be.sheetName=rd;Be.dO=$d;Be.VCd={};L=0;for(oa=S.paperSizeOptions.length;L<oa;++L)Be.VCd[S.paperSizeOptions[L].toString()]=L;Be.locale=window.navigator.browserLanguage||window.navigator.language||Be.$.ya.UICultureTag;Be.z7=jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");return Be}function K(L,oa){this.printSettings=this.sheetName=null;this.sheetName=L;this.printSettings=oa}function da(L,oa,Wa,Rb,xc){L=ja.call(this,L,oa,Wa,Rb,xc)||this;L.Nsb=null;return L}
function fa(L,oa,Wa,Rb,xc,id,rd,$d){$d=L.Na(1,void 0===$d?null:$d);$d.sheetName=oa;$d.locale=Wa;return ia.i(L,"GetPrintSettings",$d,Rb,xc,id,rd,4)}function X(L,oa,Wa,Rb,xc,id,rd){rd=L.Na(1,void 0===rd?null:rd);rd.ConvertInParameters=oa;return ia.i(L,"ConvertWorkbookToPrintPdf",rd,Wa,Rb,xc,id,4)}function ca(L,oa,Wa,Rb,xc,id,rd,$d){$d=L.Na(9,void 0===$d?null:$d);$d.sheetName=oa;$d.printSettings=Wa;return ia.i(L,"SetSheetPrintSettings",$d,Rb,xc,id,rd,0)}function ja(L,oa,Wa,Rb,xc,id){L=Ei.call(this,L,
oa,Wa,void 0===id?!1:id)||this;L.Yv=null;L.Gm=Rb;L.EQb=xc;return L}function ea(){this.n5d=this.tb=null}function qa(L,oa,Wa,Rb,xc,id,rd,$d,Be,gg){this.dXb=null;this.Tng=L;this.fkb=oa;this.DNc=Wa;this.crg=Rb;this.Frg=xc;this.YOc=new Kf.a(Object(qf.a)(this,this.zWh,"getProbeResults"));this.uVa=id;this.tae=Be;this.Vwg=rd;this.Grg=$d;this.Nrg=gg}function pa(L,oa){this.k8f=L;this.TSa=oa}function Pa(L){this.isEnabled=Boolean.parse(L.DirectPrintIsEnabled||"false");Boolean.parse(L.DirectPrintProbeIsEnabled||
"false");this.Wji=Boolean.parse(L.DirectPrintEnabledForInternetExplorer||"false");this.SSa=(L.DirectPrintSupportedMimeTypes||"").split(Pa.P6c);this.TSa=(L.DirectPrintSupportedPlugins||"").split(Pa.P6c);this.E9h=(L.DirectPrintImmersivePreviewPlugins||"").split(Pa.P6c);this.Xdf=Boolean.parse(L.DirectPrintEnabledForEdge||"false");this.Kgi=Boolean.parse(L.ChromePrintLayoutFixIsEnabled||"false");this.MXg=parseInt(L.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.Cwd=14;this.Uqf=14394;if(L=L.DirectPrintMinimalSupportedEdgeVersion){var oa=
L.split(".");2===oa.length?(this.Cwd=parseInt(oa[0]),this.Uqf=parseInt(oa[1])):td.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",L)}else td.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}function Ha(L,oa,Wa,Rb,xc){Wa=void 0===Wa?null:Wa;Rb=void 0===Rb?!0:Rb;xc=void 0===xc?!1:xc;oa=Ee.call(this,L,!0,!(Ha.PTa&&Rb),new ee(L,oa),Wa,xc)||this;Ha.PTa=Ha.PTa&&Rb;if(Ha.PTa){Rb=
document.createElement("iframe");xc=null;var id=oa.Xeh;Rb.name="pdfObjectFrame";Rb.id="pdfObjectIFrame";if(Wa&&0<Wa.count){var rd=eg.a.ogd(L,Wa);L=eg.a.QId(L,Wa);xc=document.createElement("form");xc.id="printPreviewPostForm";xc.method="POST";xc.target=Rb.name;xc.action=L;L=yl(rd);for(Wa=L.next();!Wa.done;Wa=L.next())Wa=Wa.value,rd=document.createElement("input"),rd.type="hidden",rd.name=Wa.key,rd.value=Wa.value,xc.appendChild(rd)}else Rb.src=L;id.appendChild(Rb);xc&&(id.appendChild(xc),xc.submit());
Sys.UI.DomElement.addCssClass(Rb,"DirectPrintPdfObjectHidden");Wh.a.Yg(Rb,Wh.a.ZB,Wh.a.vj)}return oa}function Xa(L){this.AP=L}function Na(L,oa,Wa,Rb){Rb=void 0===Rb?null:Rb;var xc=wi.call(this)||this;xc.Zpa=null;xc.Ul=null;xc.HP=null;xc.Sm=[];xc.tUb=oa;xc.AP=L;xc.aqg=Wa;xc.HVb=Rb;xc.Mlb=new Si.a("LoadResource","LoadPrintablePdf");return xc}function db(L){var oa=ci.call(this)||this;oa.$=L;oa.dc();return oa}function Ja(L){this.stopwatch=this.VZb=this.Bzc=this.fVd=null;this.g9f=0;this.$=L;(this.SWc=
jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||L.da.Ha(322,this)}function jb(L){this.Fie=0;this.h9f=L}function hc(L,oa,Wa,Rb,xc,id,rd){this.title=L;this.body=oa;this.N1i=Wa;this.primaryButtonAction=Rb;this.secondaryButtonAction=id;this.qXf=xc;this.targetObject=rd}function ma(L){var oa=Pi.call(this)||this;oa.$=L;oa.dc();return oa}function Ka(L){this.$=L;L.da.Ha(309,this)}function Ta(L){var oa=yi.call(this,L)||this;oa.Wo=null;oa.stopwatch=null;oa.ZCi=function(Wa){if(1===Wa)oa.$.Ka.Xb(new Vj.a(-2050946363,
na.a.$b,2,8,null)).continueWith(function(xc){oa.Wo.setResult(!Ug.a(xc)&&xc.result)}),Wa="Yes";else{var Rb=2===Wa;oa.Wo.setResult(Rb);Wa=2===Wa?"No":"Close";Rb&&oa.C1i()}oa.Vvi(Wa);oa.hide()};return oa}function ob(){}function Cb(L){return uh.call(this,L)||this}function eb(L){this.Gi=L}function ya(L){var oa=zh.call(this)||this;oa.$=L;oa.dc();return oa}function za(L){L.da.Ha(446,this)}function Ga(L){return oh.call(this,L)||this}function cb(L,oa){var Wa=this;this.sortOptions=this.jyc=this.selectedRange=
null;this.tdf=!1;this.activeCell=this.ag=this.Db=this.Uc=null;this.DTi=function(Rb,xc){fj.b(Rb,-901005882)?(dg.a(Wa.$).qd.ZD(-901005882),Wa.KFd(xc)):Wa.t8e(Rb)?Wa.d7e(Rb.Errors[0]):!fj.a(Rb)&&Rb.Result&&(Wa.sortOptions=xc,Wa.jyc=Ef.D(Rb.Result.ActualSortRange),Wa.Nkf=Wa.ha().uia,Wa.tdf||(Wa.selectedRange=Wa.ha().va.Sd,Wa.selectedRange.equals(Wa.jyc)||Wa.XCj()),Wa.sortOptions&&Wa.sortOptions.ActiveCell&&(Rb=Wa.sortOptions.ActiveCell,Rb=new Gj.Range(Rb.FirstRow+1,Rb.FirstColumn+1,Rb.FirstRow+1,Rb.FirstColumn+
1,!0,!1),Wa.JL(Rb),Wa.KWd(Rb)))};this.onContentReady=function(){Wa.DOf(!1);var Rb=Wa.ha();Rb.va.qh&&Rb.va.Sd.equals(Wa.jyc)&&Rb.updateSelection(Wa.selectedRange,Rb.va.activeCell,0,void 0,void 0,void 0,!0)};this.XMi=function(Rb,xc){Rb&&!Qg.a.lh(Rb.Errors)&&Wa.Uc&&(Wa.Uc.Qo=Rb.Result,Wa.wJb(),Wa.applyPivotSort(xc))};this.WMi=function(){};this.$=L;this.Nkf="";this.namedSheetViewPublic=oa;this.gridView=tg.g(this.$);this.$.Vb.Wh("LoadResource","LoadDialogControlsStopwatch")}function Mb(L,oa,Wa,Rb,xc,id,
rd){rd=L.Na(41,void 0===rd?null:rd);rd.options=oa;return ia.i(L,"Sort",rd,Wa,Rb,xc,id,0)}function Dc(L){this.filterRange=null;this.filterRange=L}function vb(L){this.selection=null;this.selection=L}function ib(L,oa,Wa,Rb){var xc=Kd.call(this,L)||this;xc.$Qd=!1;xc.Rfc=!1;xc.C6=[];xc.Iei=function(id,rd){var $d=xc.R6g(id);xc.L5a(214,function(Be,gg,Wg){return ia.H(xc.$.na.ta,$d,xc.G_a(Be,xc.BHh(rd)),xc.rU(gg),Wg,null)},16,!0)};xc.Hei=function(id,rd,$d){id=ia.G(xc.$.na.ta,rd,xc.lIh(rd,$d),xc.oNi,null,id);
Array.add(xc.C6,id)};xc.oNi=function(){td.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");xc.n6b(ib.Xqb())};xc.J6c=function(id,rd){if(1===id){id=rd.sortRangeType;var $d={};$d.SortOptions=rd.sortOptions;$d.ShouldRestoreSelection=xc.$Qd;$d.SelectedRange=xc.selectedRange;$d.OriginalActiveCell=xc.Noc;$d.TopCellAddress=xc.nTa;if(xc.Myj(id)){var Be=xc.$;xc.namedSheetViewPublic.LAa().continueWith(function(gg){gg.result&&
ib.YLf(Be,$d)})}else ib.YLf(xc.$,$d)}else xc.$Qd&&xc.Hoa(xc.selectedRange,xc.Noc)};xc.g8h=function(id,rd){xc.$Qd=!0;xc.Hoa(id,rd)};xc.getColorName=function(id){return Fc.a.rKa(cd.a.kH(id))};td.ULS.shipAssertTag(529105669,0,!!oa.ActiveCell);td.ULS.shipAssertTag(529105668,0,!!oa.SelectedRange);td.ULS.shipAssertTag(529105667,0,Ef.D(oa.SelectedRange).contains(Ef.C(oa.ActiveCell)));td.ULS.shipAssertTag(529105666,0,Ib.a.equals(oa.SelectedRange.SheetName,oa.ActiveCell.SheetName,!0));jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&
(xc.Tbb=new wd.a(L,Pc.a.Yah,function(){return xc.Rfc},1));xc.selectedRange=oa.SelectedRange;xc.Noc=oa.ActiveCell;xc.sUg=oa.ExpandSelection;xc.namedSheetViewPublic=Wa;xc.nTa=Rb;xc.initializeAndShow(pe.a.instance.fa(182),xc.J6c,xc.jta(oa));return xc}function ub(L,oa){L=Nc.call(this,L,oa)||this;L.WBb=L.Wcd();L.Ar();return L}function Eb(L,oa){var Wa=L.SortRange;L=L.SortTopToBottom?Wa.LastColumn-Wa.FirstColumn:Wa.LastRow-Wa.FirstRow;return 0<=oa&&oa<=L}function Ya(L,oa){if(!L.SortColumnInfoItems)return td.ULS.sendTraceTag(537151618,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var Wa=new ua.a,Rb=yl(L.SortColumnInfoItems),xc=Rb.next();!xc.done;xc=Rb.next()){xc=xc.value;if(!Eb(L,xc.ColumnOffset))return td.ULS.sendTraceTag(537151617,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",xc.ColumnOffset,L.SortRange),!1;if(!xc.Name)return td.ULS.sendTraceTag(537151616,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",
xc.ColumnOffset),!1;if(xc.CellColors&&!xc.CellColors.length)return td.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",xc.CellColors.length),!1;if(xc.TextColors&&!xc.TextColors.length)return td.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",xc.TextColors.length),!1;if(xc.Icons&&!xc.Icons.length)return td.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",
xc.Icons.length),!1;Wa.add(xc.ColumnOffset)}if(L.SortConditions)for(Rb=yl(L.SortConditions),xc=Rb.next();!xc.done;xc=Rb.next())if(xc=xc.value,!Wa.contains(xc.RowColOffset))return td.ULS.shipAssertTag(537151584,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",xc.RowColOffset),!1;if(L.HeaderColumnInfoItems){if(L.HeaderColumnInfoItems.length!==L.SortColumnInfoItems.length)return td.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),
!1;for(Wa=0;Wa<L.HeaderColumnInfoItems.length;++Wa){Rb=L.HeaderColumnInfoItems[Wa];if(oa&&Rb.ColumnOffset!==L.SortColumnInfoItems[Wa].ColumnOffset)return td.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;if(Rb.CellColors&&1<Rb.CellColors.length)return td.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),
!1;if(Rb.TextColors&&1<Rb.TextColors.length)return td.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(Rb.Icons&&1<Rb.Icons.length)return td.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),!1}}return!0}function tb(L){if(!L.SortConditions)return!0;for(var oa=yl(L.SortConditions),Wa=oa.next();!Wa.done;Wa=
oa.next()){Wa=Wa.value;if(!Eb(L,Wa.RowColOffset))return td.ULS.sendTraceTag(537151620,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",Wa.RowColOffset,L.SortRange),!1;if(1===Wa.SortConditionType&&Wa.FillGradient&&!Za.isValid(Wa.FillGradient))return td.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),!1}return!0}function ec(L){return L.SortRange?4===L.SortRangeType?
(td.ULS.sendTraceTag(537151622,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",L.SortRangeType),!1):2===L.SortRangeType&&L.SortTopToBottom&&(null==L.HeaderRowSize||0>L.HeaderRowSize)?(td.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(td.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),!1)}function Za(){}
function mb(L,oa,Wa,Rb){new Sys.UI.Point(L,oa);new Sys.UI.Point(Wa,Rb)}function sc(){}function pd(L,oa,Wa,Rb){L=L.HeaderColumnInfo;return Rb||L?2===oa&&Wa?L.CellColors&&1!==L.CellColors.length?(td.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):L.TextColors&&1!==L.TextColors.length?(td.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):L.Icons&&1!==L.Icons.length?(td.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:L?(td.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",Wa),!1):!0:!0}function $b(L,oa){L=L.ColumnInfo;switch(oa){case 1:return L.CellColors&&
L.CellColors.length?!0:(td.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return L.TextColors&&L.TextColors.length?!0:(td.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return L.Icons&&L.Icons.length?
!0:(td.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return td.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function Xb(L){var oa=this;this.$v=function(Wa){switch(Wa){case 0:oa.KNa("Cancel");break;case 1:oa.KNa("Expand and sort");oa.oSe(!0);break;case 2:oa.KNa("Just sort"),
oa.oSe(!1)}};this.oSe=L}function lc(L,oa,Wa,Rb,xc,id,rd){rd=L.Na(41,void 0===rd?null:rd);rd.filterRange=oa;return ia.i(L,"ReapplyAutoFilter",rd,Wa,Rb,xc,id,0)}function Oa(L){this.options=null;this.options=L}function pb(L){return Z.call(this,L)||this}function Ub(L,oa,Wa){var Rb=Qj.call(this)||this;Rb.Awe=!1;Rb.zwe=!1;Rb.aIi=function(){Rb.Awe=!0;Rb.M3f()};Rb.$=L;Rb.Sa=oa;Rb.eK=Wa;dg.a(Rb.$).LHd(new Yi.a(xb.a.Hcg,xb.a.idle,Ub.oWg),new Xi.a(xb.a.aAe,xb.a.E_,null,xb.a.dP,xb.a.idle));return Rb}function ic(L){var oa=
hk.call(this,L,pe.a.instance.fa(1228))||this;oa.textBox=null;oa.jRa=null;oa.BTa=null;oa.gFf=function(){var Wa=oa.$;oa.Du();var Rb=new Jb(Wa,1231,1232,1233,function(xc,id,rd){var $d=Wa.na.ta.Zb(),Be=Wa.na.ta;$d=Be.Na(1,$d);return ia.i(Be,"UnshareForm",$d,xc,id,rd,null,0)},16);Rb.initialize();Rb.mf()};return oa}function Jb(L,oa,Wa,Rb,xc,id){id=void 0===id?0:id;L=Fk.call(this,L,pe.a.instance.fa(oa),!1)||this;L.message=Wa;L.GGi=Rb;L.m_d=xc;L.operationFlags=id;return L}function cc(L,oa,Wa){var Rb=ra.call(this,
L,new Sys.UI.Point(cc.Tch,cc.uch),pe.a.instance.fa(oa?1226:1225))||this;Rb.M0a=null;Rb.aLc=!1;Rb.zoc=function(xc){function id(gg,Wg,Dh){return ia.F(rd.na.ta,Tg.b(gg,Rb.NSi),Wg,Dh,$d)}var rd=Rb.$,$d=new Ob;$d.vH=xc.Values[P.vH];var Be=!1;switch(xc.MessageId){case P.A1f:Rb.Du();Be=!0;$d.fEd=1334518759;break;case P.view:Rb.nBa=pe.a.instance.fa(1226);Rb.Keg(!0);break;case P.Tze:Rb.Du(),Be=!0}jf.EwaSettings.sc()?(xc=new Jc.a(140,0,id),xc.flags=Be?16:80):(xc=Be?new Jc.a(140,0,id):new Fj.a(140,0,id),xc.flags=
16);rd.userOperationManager.hc(xc,Rb.ae)};Rb.JKi=function(){var xc=Rb.$;xc.ya.SurveyRedirectUrl?(Rb.Du(),xc.xe(1305810481,0,8,null)):(Rb.nBa=pe.a.instance.fa(1225),Rb.Keg(!1))};Rb.aTi=function(){var xc=Rb.$;Rb.Du();xc.xe(1334518759,0,8,null)};Rb.ewf=function(xc){var id=Rb.$;Rb.Du();xc.MessageId===P.cAe&&id.ea.ecd()};Rb.rRi=function(){Rb.aLc=!0;Rb.raiseEvent(cc.otd)};Rb.NSi=function(xc,id){if(!fj.a(xc)){xc=Rb.$;if(id.vH){var rd=xc.ea.xa;if(rd.contains(id.vH.SheetName))Rb.rnc(id);else{var $d=null;$d=
function(){rd.Tma($d);Rb.rnc(id)};rd.$ga($d)}}1461300262!==id.fEd&&xc.xe(id.fEd,0,8,null)}};Rb.X9d=oa;Rb.ae=Wa;return Rb}function Ob(){this.vH=null;this.fEd=1461300262}function P(){}function Ba(L){L=ra.call(this,L,new Sys.UI.Point(960,680),pe.a.instance.fa(1221))||this;L.name=E.a.pLe;return L}function ra(L,oa,Wa,Rb){var xc=Ak.call(this,L,Wa,2,void 0===Rb?null:Rb)||this;xc.NJc=null;xc.onResize=function(){var id=xc.XRh();xc.qLa.setAttribute("width",id.x.toString());xc.qLa.setAttribute("height",id.y.toString());
xc.dSj(id);xc.EAd()};xc.Glh=function(){var id=xc.tx.parentNode.style,rd=id.top;id.top="2px";id.top=rd};xc.mHe=oa;xc.$.nA(xc.onResize);xc.xdc();return xc}function ta(L){return tk.call(this,L)||this}function Ia(L){this.$=L}function bb(L,oa,Wa,Rb,xc,id,rd,$d){$d=L.Na(9,void 0===$d?null:$d);$d.sheetName=oa;$d.directionRtl=Wa;return ia.i(L,"ChangeSheetDirection",$d,Rb,xc,id,rd,0)}function Va(L,oa,Wa,Rb,xc,id,rd,$d){$d=L.Na(9,void 0===$d?null:$d);$d.sheetName=oa;$d.show=Wa;return ia.i(L,"ShowHeadings",
$d,Rb,xc,id,rd,0)}function lb(L,oa,Wa,Rb,xc,id,rd,$d){$d=L.Na(9,void 0===$d?null:$d);$d.sheetName=oa;$d.show=Wa;return ia.i(L,"ShowGridlines",$d,Rb,xc,id,rd,0)}function kc(L,oa){this.sheetName=null;this.value=!1;this.sheetName=L;this.value=oa}function zb(L,oa){var Wa=wg.call(this)||this;Wa.activityName=L;Wa.JM=oa;Wa.dc();return Wa}function Sb(L,oa,Wa,Rb,xc){L=Jk.call(this,L,oa)||this;Sb.Avd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];Sb.zvd=[-1468309555,-315732528,-399065540,
810218235,1531005923,1593924569,1112506702,1220851643];Sb.hpf=[-1468309555,611268539,-1750576502,61029505];Sb.gpf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];L.Rxc=Wa;L.sDj=Rb;L.BMj=xc;return L}function gb(){var L=dj.call(this)||this;L.dc();return L}function Sa(L,oa){return sk.call(this,L,oa)||this}function Kb(L){var oa=gj.call(this)||this;oa.$=L;oa.dc();return oa}function Gc(L,oa){this.$=L;this.Gi=oa;this.$.da.Ha(393,this)}function Hb(L){var oa=Hj.call(this,L)||
this;oa.fFh=function(Wa,Rb,xc,id,rd){return 1===xc?32:Wa===Vf.a.cRa&&2===xc?(Wa=oa.$.na.ta.Zb(),ia.ab(oa.$.na.ta,rd[0],rd[1],null,null,Wa),32):8};return oa}function Lb(L,oa){this.$=L;this.Gi=oa}function sa(L){return Pj.call(this,L)||this}function Ua(L,oa){var Wa=this;this.MRi=function(Rb,xc){if(!fj.a(Rb)&&xc){var id=!!Rb&&!!Rb.RequestTelemetryData;tg.g(Wa.$).Mi.Bla(xc,Rb.StateId,id?Rb.RequestTelemetryData.EcsOperationDuration:0,id?Rb.RequestTelemetryData.EcsRequestDuration:0,id?Rb.RequestTelemetryData.WfeRequestDuration:
0)}};this.$=L;this.Gh=oa}function Yb(L,oa){var Wa=Ck.call(this,L)||this;Wa.mvb=function(Rb){Rb=Wa.yfd(Rb);return Wa.Rcd(Rb)};Wa.Uhj=function(Rb,xc){var id=Wa.Hzb=xc[Yb.Dhi];1===Rb?(Rb=xc[Yb.zDj],id=Wa.O4e(Rb,id),td.ULS.shipAssertTag(537153996,0,id!==Yb.pba,"ResizeHeadersDialogHandler - invalid size input, size = {0}",Rb),Rb=id!==Wa.Old,td.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",Wa.isRow,Wa.Hzb,id,
Rb),Rb&&Wa.D4g(id)):td.ULS.sendTraceTag(537153994,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",Wa.isRow)};Wa.isRow=2040891415===oa.command;Wa.gridView=tg.g(Wa.$);Wa.Etc=new Qb(Wa.$.workbookContext.DxDigitNormal);Wa.Old=Wa.QTg();L=Wa.q3g(Wa.Old);oa=Wa.s3g(Wa.Old);Wa.io=pe.a.instance.fa(Wa.isRow?470:471);L=Wa.tV(L,oa);Wa.initializeAndShow(Wa.io,Wa.Uhj,L);td.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",Wa.isRow);return Wa}function jc(L){this.resizeParameters=
null;this.resizeParameters=L}function md(L,oa){this.isRow=!1;this.autoFitRange=null;this.isRow=L;this.autoFitRange=oa}function jd(){var L=Tk.call(this)||this;L.dc();return L}function Zc(L,oa){var Wa=al.call(this,oa.domElement)||this;Wa.YTf=!1;Wa.Eba=!1;Wa.ISa=null;Wa.G7a=null;Wa.vq=null;Wa.offset=0;Wa.em=0;Wa.CIb=0;Wa.S0=null;Wa.c7=null;Wa.eN=null;Wa.e7h="headerResizeTooltip";Wa.xud=null;Wa.nG=null;Wa.Vza=!1;Wa.rWa=!1;Wa.MXc=!1;Wa.WN=function(Rb){if(Wa.grid.Sx)return!0;Rb=rk.a(Wa.grid.$).He(Rb);if(3===
Rb.yb&&!Wa.Kif(Rb.Ea)||!Wa.$If(Rb,!1))return!1;td.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");var xc=Wa.Lxc();Wa.Ycd(Rb.clientPoint,xc,!0);Wa.Vza||(ij.a.instance.qa(mg.a.fh,Wa.domElement.ownerDocument.body,Wa.q9a),Ig.a.instance.qa(mg.a.xg,Wa.domElement.ownerDocument.body,Wa.q9a),Wa.Vza=!0);Wa.Sef()&&Wa.Eba&&Wa.N$e(Rb);return!1};Wa.Smc=function(Rb){Rb=rk.a(Wa.grid.$).He(Rb);Wa.Sef()&&Wa.MXc&&Wa.N$e(Rb);if(Rb.Ea.button!==Sys.UI.MouseButton.leftButton||
!Wa.Eba)return!1;Ci.g(Rb.Ea);Wa.PLe();Rb=Mg.a.I5a;Wa.vq&&(Rb=Wa.rWa?Wa.wed():Wa.vq.Gja());var xc=Rb!==Wa.em;if(Wa.ISa&&xc&&Rb!==Mg.a.I5a){Rb=Wa.grid;xc=Wa.V2e(Rb);var id={};id.SheetMultiRange=Ef.r(xc,Rb.$);Zc.dPd(id,Wa.isRow,Wa.em);Wa.ulh(id);Rb.NIj=!0}else Wa.Yh(null,null),Wa.jsc();return Wa.rWa=!1};Wa.rca=function(Rb){Rb=Oj.a.create(Rb.eventName,Rb.Tb,Rb.Ea,Rb.yb);Rb=rk.a(Wa.grid.$).He(Rb);if(!Wa.$If(Rb,!0))return!1;Rb=Wa.grid;var xc=Wa.V2e(Rb);xc=Ef.r(xc,Rb.$);Rb.Nb.ll([Wa.isRow?13:14]);Rb.Nb.qdb();
Wa.jsc();var id={};Rb.$.xe(Wa.isRow?146338636:1391094586,na.a.$b,30,(id.autoFitRanges=xc,id));return!1};Wa.q9a=function(Rb){Rb=rk.a(Wa.grid.$).He(Rb);if(!Wa.Eba)return!1;Ci.g(Rb.Ea);var xc=Wa.isRow;if(!Wa.S0){Wa.S0=document.createElement("div");Wa.S0.style.cssText="position: relative; width: inherit; height: inherit;"+(xc?"top: 0px; ":Wa.rtl?"right: 0px:":"left: 0px:");for(var id=Wa.vq.dK();id.nextSibling;)Wa.S0.appendChild(id.nextSibling);id.parentNode.appendChild(Wa.S0)}id=Rb.clientPoint;var rd=
xc?id.y-Wa.G7a.y:(Wa.rtl?-1:1)*(id.x-Wa.G7a.x),$d=xc?id.y-Wa.ISa.y:(Wa.rtl?-1:1)*(id.x-Wa.ISa.x),Be=Wa.vq.Gja();if(Be===Mg.a.I5a)return!1;rd&&(0<Wa.em||0<Be+$d)&&Be+$d<=Wa.Rpf&&(Wa.em=Wa.Lxc($d),Wa.Ycd(id,Wa.em,!1),Ie.DOMElementExtensions.KTa(Wa.vq.dK(),!xc,Math.max(Wa.CIb+$d,0)),Wa.S0.style[xc?"top":Wa.rtl?"right":"left"]=Math.max($d,-Wa.CIb)+"px",Ie.DOMElementExtensions.KTa(Wa.vq.qf.domElement,!xc,(xc?Wa.vq.qf.cQ:Wa.vq.qf.dQ)+Math.max($d,-Wa.CIb)),Wa.G7a=new Sys.UI.Point(Rb.clientPoint.x,Rb.clientPoint.y),
Ie.DOMElementExtensions.setVisible(Wa.nG,!1));return!0};Wa.YR=function(Rb){if(Wa.grid.Sx)return!0;Rb=rk.a(Wa.grid.$).He(Rb);var xc;if(!Wa.ohf||-1!==Wa.grid.ha.selectionType)return ii.a(Wa.grid.$).Dq()&&(xc=Wa.jfd(Rb))&&(xc.Uva.style.cursor=""),!1;if(Wa.Eba)return Wa.aci(),!1;xc=Wa.jfd(Rb);if(!xc)return!1;xc.Uva.style.cursor=!Wa.grid.isEditing&&Wa.Lrd(xc)?Wa.isRow?"row-resize":"col-resize":"";Ci.g(Rb.Ea);return!0};Wa.tr=function(){Wa.jsc()};Wa.Yh=function(){if((3===na.a.$b||Cf.a.Xp)&&Wa.grid.ha.va.qh){var Rb=
Wa.grid.ha.va.Sd;if(!(!Rb.isRow&&!Rb.Sh||!Wa.domElement||Rb.isRow&&Wa.isRow&&!Array.contains(Wa.qf.Fn,Rb.top)||Rb.Sh&&!Wa.isRow&&!Array.contains(Wa.qf.Fn,Rb.left))){var xc=Wa.grid.pg(Rb,Wa.qf.wj.paneType);xc&&(Wa.nG||Wa.S$g(),Rb.isRow&&Wa.isRow?(Ie.DOMElementExtensions.setVisible(Wa.nG,!0),Wa.nG.style.top=xc.bottomRight.y-Wa.nG.offsetHeight/2+"px"):Rb.isRow||Wa.isRow||(Ie.DOMElementExtensions.setVisible(Wa.nG,!0),ri.c(Wa.nG.style,Wa.grid.rtl,xc.bottomRight.x-Wa.nG.offsetWidth/2+"px")))}}};Wa.GF=function(Rb,
xc){xc.PP&&Wa.Bpb()};Wa.qf=oa;Wa.isRow=oa.isRow;Wa.rtl=oa.wj.rtl;Wa.grid=L;Wa.Rpf=Wa.isRow?Mg.a.Zvd:Mg.a.Gkc;Wa.a7h=pe.a.instance.fa(429);Wa.j7h=pe.a.instance.fa(428);Wa.d7h=pe.a.instance.fa(430);zf.a(Wa.grid.$,function(Rb){Wa.xud=Rb.wQ(yc.a.bij,!1)});Wa.j9i();Wa.grid.ha.J2(Wa.Yh);Wa.grid.ha.O9(Wa.tr);Wa.grid.ar(Wa.Yh);ii.a(Wa.grid.$).sg.aha(Wa.GF);return Wa}function Qb(L){this.J7c=L}function fd(L,oa,Wa,Rb,xc,id,rd){this.Uva=L;this.bCb=oa;this.tOa=Wa;this.Kjd=Rb;this.Fbb=xc;this.Jif=id;this.i6h=rd}
function xd(){}function Ad(L){var oa=rj.call(this)||this;oa.$=L;oa.dc();return oa}function Me(L){var oa=this;this.uoa=this.kWe=this.EFb=this.k2a=this.mqc=this.Qca=this.GPa=null;this.Dqd=this.yNb=this.MLd=!1;this.IKb=!0;this.Xfc=!1;this.cSd=!0;this.xNb=this.U0a=this.lCe=0;this.Wuc={};this.$oc={};this.Zoc={};this.nJf=0;this.b7a=this.W9d=!1;this.jbj=function(){Ie.DOMElementExtensions.toggleCssClass(oa.$.dr,"ewr-presentMode-transition",!1);$removeHandler(oa.k2a,"transitionend",oa.uoa)};this.ej=function(){parseInt(oa.$.Vv.style.right,
10)!==oa.lCe&&window.requestAnimationFrame(function(){oa.kBc(0);oa.$.vza(Gb.a.GZ("PresentModeManager.OnContentAreaResized"))})};this.Kya=function(){var Wa=Object($f.a)(Xe.a,oa.$.pa);if(Wa&&oa.nz){oa.gridView.Jod=!1;Wa=Wa.headersVisible;var Rb=tg.g(oa.$).rtl;Ie.DOMElementExtensions.toggleCssClass(oa.$.dr,"ewr-presentMode-on-headers-off",!Wa);Ie.DOMElementExtensions.toggleCssClass(oa.$.dr,"ewr-presentMode-on-rtl",Rb);(12!==oa.U0a&&!Wa||32!==oa.U0a&&Wa&&!Rb||0!==oa.U0a&&Wa&&Rb)&&window.requestAnimationFrame(function(){oa.kBc(2)})}};
this.rd=function(){oa.ncf();oa.sh("OnWorkbookOpened");td.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};this.tr=function(){oa.Dqd=!0;oa.Eea("OnSelectionStarted")};this.Yh=function(){oa.Dqd=!1;oa.Eea("OnSelectionEnded");oa.gWf()};this.fj=function(){oa.Eea("OnEditStarted")};this.Kg=function(){oa.Eea("OnEditEnded")};this.yw=function(){if(!oa.Xfc){var Wa=jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");
oa.Eea("OnVisibleAreaChanged",!0,Wa)}};this.qya=function(){oa.Xfc=!0};this.lp=function(){oa.Eea("OnCurrentSelectionModeChanged");oa.gWf();oa.sh("OnCurrentSelectionModeChanged")};this.Fm=function(){oa.Eea("OnBlockCacheItemEvicted")};this.Re=function(){oa.Eea("OnBlockCacheItemChanged")};this.oca=function(){oa.Xfc||oa.Eea("OnActiveItemPanesChanged")};this.ii=function(){oa.Xfc=!1;oa.Qca.sh("ActiveSheetChanged");oa.Kya()};this.gEb=function(Wa,Rb){if(Wa=Object($f.a)(Xe.a,Rb.item))Wa.Jpb(16,!0),Wa.Cnb(oa.Kya)};
this.ILi=function(){Ue.dji||(oa.mqc&&oa.mqc.Eq&&oa.mqc.hide(),tg.g(oa.$).isEditing&&tg.g(oa.$).Rq(!0),oa.Fxc(!1),td.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};this.JLi=function(){td.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=L;this.gridView=tg.g(this.$);this.Vlj=L.ya.PresentModeRenderUpdateTimeout;this.initialize(L)}function Ue(){}function Jd(L,
oa){var Wa=qi.call(this,L)||this;Wa.u1i=function(){Wa.Qca.YRd(!0)};Wa.Qca=oa;Wa.domElement.classList.add("ewr-presentMode-on");L={};L=(L[Jd.$y]=Wa.Ac,L);Wa.jc=0;Wa.initializeAndShow("",Wa.u1i,L);return Wa}function Sd(L){this.n_a=this.GEd=null;this.$=L;this.gridView=tg.g(this.$)}function se(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function oe(){this.height=this.width=0}function Ke(){this.angle=this.translateY=this.translateX=this.height=this.width=this.top=this.left=
0}function bc(L){var oa=this;this.Nse=this.EPa=this.EEd=this.FEd=this.Pca=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.Rpc={};this.Qpc={};this.APa=null;this.cIf=0;this.onKeyDown=function(Wa){Wa=Wa.Ea;if(9===Wa.keyCode){var Rb=oa.Pca.querySelectorAll(Ie.DOMElementExtensions.Rp),xc=Ie.DOMElementExtensions.Cl(Rb);Rb=Ie.DOMElementExtensions.gz(Rb);Ie.DOMElementExtensions.Qda(Wa,xc,Rb);return!0}return!1};this.Il=function(){var Wa=[];oa.$.da.Za(337,function(Rb){oa.EPa.getPresentModeFloatieControlsMap().then(function(xc){for(var id=
{},rd=0;rd<xc.length;rd++)id[xc[rd].controlId]=xc[rd].modelType;Wa.push.apply(Wa,Rb.Vca.p4a(id));0<Wa.length&&appChrome.api.dispatch(Wa);oa.jlj()})})};this.$=L}function qd(){}function zc(L){return De.call(this,L)||this}function ld(L,oa){this.$=L;this.presentModeManager=oa}function rb(L,oa,Wa,Rb){var xc=$c.call(this)||this;xc.activityName=L;xc.JM=oa;xc.VJ=Wa;xc.$=Rb;xc.dc();return xc}function Wd(L,oa,Wa){var Rb=Zj.call(this,L,oa)||this;Rb.zi=null;Rb.Gsi=function(xc){var id=Rb.Ds.qd,rd=Object($f.a)(8,
id.Ie);var $d=xc.Rrb;Rb.unsubscribe(function(Wg){xc.remove_disposing(Wg)});for(var Be=0,gg=id.errors.length;Be<gg;Be++)-573864504===id.errors[Be].MessageId&&id.Ala(id.errors[Be]);switch($d){case 1:rd.ea.DAc=!0;td.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");Rb.vh(rd.isEditMode?xb.a.QMb:Rb.Dch);Rb.jp();break;case 2:Rb.vh(xb.a.openInExcelClient);Rb.jp();break;case 0:id.activityState[Td.a.Ls]=
!1,Rb.vh(Rb.VJ),Rb.jp()}};Rb.Dch=oa;Rb.VJ=Wa;return Rb}function rc(L,oa){L=kk.call(this,L,oa)||this;L.Mpa=0;L.Ar();return L}function nd(L,oa,Wa,Rb){var xc=yj.call(this)||this;xc.activityName=L;xc.JM=oa;xc.VJ=Wa;xc.$=Rb;xc.dc();return xc}function me(L,oa,Wa){return Zd.call(this,L,oa,Wa)||this}function be(L,oa){L=mf.call(this,L)||this;L.password=null;L.fjf=oa;L.Ch();return L}function sd(L,oa,Wa,Rb){var xc=vj.call(this)||this;xc.activityName=L;xc.JM=oa;xc.VJ=Wa;xc.$=Rb;xc.dc();return xc}function Qe(L,
oa,Wa){return Zd.call(this,L,oa,Wa)||this}function Sf(L){var oa=mf.call(this,L)||this;oa.ELd=5;oa.T9d=!1;oa.passwordToModify=null;oa.eHf=function(){oa.$.isEditMode&&oa.$gc&&(Ra.b().y8c("PasswordToModifyPasswordVerifiedTillInteractive"),oa.$.pl(oa.eHf))};oa.Ch();oa.$.Qk(oa.eHf);return oa}function mf(L){var oa=jk.call(this,L)||this;oa.Mpa=0;oa.w6i=function(Wa,Rb){oa.uab(Wa,Rb)};return oa}function Zd(L,oa,Wa){var Rb=hj.call(this,L,oa)||this;Rb.zi=null;Rb.gDd=null;Rb.DYi=function(xc,id){Rb.aFb(xc,id)};
Rb.VJ=Wa;return Rb}function ie(L){var oa=ik.call(this)||this;oa.$=L;L.da.Ha(56,new ge(L));oa.dc();return oa}function kd(L,oa){return ck.call(this,L,oa)||this}function ge(L){var oa=Vh.call(this)||this;oa.$=L;oa.dc();ge.o1g();return oa}function of(L,oa,Wa){var Rb=Ec.call(this,!0)||this;Rb.Ma=new Nh.a;Rb.FVe=!1;Rb.t7c=!1;Rb.mAe=null;Rb.xm=null;Rb.Q2b=null;Rb.$c=function(){Jj.a.yg(dg.a(Rb.$).qd.activityState,fc.a.bzd)||Rb.vaa.reset()};Rb.IKi=function(xc){Rb.vSf(xc)};Rb.HKi=function(){Rb.$Aj()};Rb.$=L;
Rb.ea=L.ea;Rb.eK=oa;Rb.businessBar=Wa;Rb.ea.Uj(Rb.$c);Rb.vaa=Oh.a.Wse(Rb.$);Rb.p1g();L.da.Ha(55,Rb);return Rb}function Ec(L){this.dga=this.C5d=this.cVa=null;this.tib=!1;this.TMc=this.Jce=null;this.zQb=this.JD=this.PVb="";this.application=this.NB=0;this.tIj=this.xUd=!1;this.qVj=L&&Od.AFrameworkApplication.ga.ra("OICLaunchDialogIsEnabled");Od.AFrameworkApplication.Gb.u4(Vf.a.OQa)||Od.AFrameworkApplication.Gb.fc(Vf.a.OQa,kh.a.frame,Object(qf.a)(this,this.Yij,"retryOpenInClientAction"));this.s5f=!!Od.AFrameworkApplication.ga&&
Od.AFrameworkApplication.ga.ra("SilentExternalHandler")}function Cd(){}function Qd(){}function od(L){var oa=Uh.call(this)||this;oa.nq=L;oa.Ue="ProtocolLaunchingDialog";Od.AFrameworkApplication.hj.V4a&&Od.AFrameworkApplication.hj.Itc();Od.AFrameworkApplication.sa.Qa.kid&&oa.cme(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,Object(qf.a)(oa,oa.dnc,"onGiveFeedbackClick"));od.X7e?(oa.jc=12,oa.Fc(1,CommonUIStrings.l_CloseFile),oa.Fc(2,CommonUIStrings.l_OICDialogContinueHere),oa.Fc(3,CommonUIStrings.l_OICDialogLaunchAgain)):
(oa.jc=4,oa.Fc(1,CommonUIStrings.l_OICDialogContinueHere),oa.Fc(2,CommonUIStrings.l_OICDialogLaunchAgain));oa.XBb(CommonUIStrings.l_OICDialog2ndTitle,5===oa.nq.RFf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(qf.a)(oa,oa.NFd,"protocolLaunchingDialogResultHandler"),null);return oa}function ke(L){var oa=Rh.call(this)||this;oa.hfa=null;oa.WUa=null;oa.Opa=!1;oa.tpa=null;oa.nq=L;oa.eg=Re.eg;oa.Bte=!0;oa.jc=5;oa.Ue="ProtocolLaunchingDialog";oa.aHc=
"OICRetryDialog";Od.AFrameworkApplication.hj.V4a&&Od.AFrameworkApplication.hj.Itc();Od.AFrameworkApplication.hj.Zg(new hh.a(2,1,5E3,function(){oa.switchToBackupMode()},101));oa.showDialog("",Object(qf.a)(oa,oa.NFd,"protocolLaunchingDialogResultHandler"));oa.G_f();oa.gX("Issues");oa.qVe();td.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return oa}function Re(){}function lf(L){var oa=Li.call(this)||this;oa.ACa=null;oa.XUa=
null;oa.Opa=!1;oa.nq=L;oa.eg=vc.eg;oa.Bte=!0;oa.jc=5;oa.Ue="OICLaunchDialog";oa.showDialog("",Object(qf.a)(oa,oa.EGi,"oicLaunchDialogResultHandler"));oa.G_f();oa.gX("ProtocolLaunchingDialogTitle");4!==Od.AFrameworkApplication.sa.Qa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);oa.Hz(oa.ACa);td.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";
return oa}function vc(){}function hd(L,oa,Wa,Rb,xc){var id=document.createElement("img");id.alt=L;id.className=Eg.getImageClassWithCluster(Wa,Rb);id.src=oa;id.setAttribute(Wh.a.Td,Wh.a.Rr);L=document.createElement("span");L.className="ProtocolLaunchingDialogImg32Container";L.appendChild(id);id=document.createElement("span");id.className="ProtocolLaunchingDialogIconContainer";id.appendChild(L);xc.appendChild(id)}function Ac(L,oa,Wa,Rb,xc,id,rd){var $d=document.createElement("a");$d.className="ProtocolLaunchingDialogButtonAnchor";
$d.className+=" OICDialog";$d.id=L;$d.setAttribute(Wh.a.Td,Wh.a.Qr);$d.style.padding="0";$d.style.margin="0";Rb&&hd(xc,oa,Wa,Rb,$d);L=document.createElement("span");L.className="ProtocolLaunchingDialogButtonLabel";L.innerText=xc;$d.appendChild(L);$d.tabIndex=0;id&&bi.a.instance.qa(mg.a.click,$d,id);rd&&ef.KeyInputManager.instance.qa(mg.a.Wd,$d,rd);return $d}function Vd(L){return L.Ea.keyCode===si.a.$h||L.Ea.keyCode===si.a.Noa?(L.Tb.click(),!0):!1}function Bd(L){for(var oa=0;oa<L.children.length;oa++){var Wa=
L.children[oa];Wa.style.position="relative";Wa.style.top=(Wa.parentNode.offsetHeight-Wa.offsetHeight)/2+"px"}}function tf(){}function Wb(L,oa,Wa){var Rb=this;this.La=L;this.org=oa;this.XEc=null;(this.aXb=Od.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&Qh.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(xc){Rb.XEc=xc});this.U1=Wa}function wc(L,oa,Wa){this.La=L;this.lrg=
oa;this.U1=Wa}function yb(L){var oa=Se.call(this)||this;oa.$=L;oa.dc();return oa}function mc(L){var oa=de.call(this)||this;oa.$=L;oa.dc();return oa}function Wc(L,oa,Wa){Wa=void 0===Wa?!1:Wa;var Rb=Uj.call(this,L,oa)||this;Rb.wBb=null;Rb.sBd=function(xc){Rb.unsubscribe(function(id){xc.remove_disposing(id)});Rb.vh(xb.a.Bk);Rb.jp()};Rb.mkc=Wa;return Rb}function Nd(L){return sf.call(this,L)||this}function Tc(L,oa){this.Gi=oa;this.$=L}function Yc(L){var oa=fe.call(this)||this;oa.$=L;oa.dc();return oa}
function oc(L){return Id.call(this,L)||this}function ze(L){this.lo="Excel";this.$=L;this.gV=Bc.a.current}function Ae(L,oa,Wa,Rb,xc,id,rd){rd=L.Na(9,void 0===rd?null:rd);rd.sheetName=oa;rd.confirmationChoice=!0;return ia.i(L,"DeleteSheet",rd,Wa,Rb,xc,id,0)}function Ve(){}function nb(L){var oa=gc.call(this)||this;oa.c0d=null;oa.e0d=0;oa.jj=null;oa._state=0;oa.moveNext=function(){try{for(oa._state=1;1===oa._state;)oa.wu=oa.wu()}catch(Wa){oa.dispose(),oa.Tda(Wa),oa._state=3}};oa.Bf=L;oa.wu=oa.TL;oa.moveNext();
return oa}function Hc(){}function Cc(L){return hb.call(this,L)||this}function Sc(L,oa){this.$=L;this.gridView=oa}function Uc(L,oa,Wa){var Rb=Aa.call(this,L)||this;Rb.Kmb=0;Rb.zyb=!1;Rb.x1a=null;Rb.yIe=!1;Rb.Mqb=!0;Rb.GTc=null;Rb.io=null;Rb.Lxd=0;Rb.Mxd=null;Rb.Kxd=null;Rb.removeHyperLink=!1;Rb.cellValue=null;Rb.location=null;Rb.J8h=function(xc,id){1===xc||2===xc?(td.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===xc?"OK":"Remove"),Rb.Mxd=id[Uc.Xsi],Rb.Lxd=id[Uc.onj],Rb.Kxd=id[Uc.lgh],
2===xc&&(Rb.removeHyperLink=!0),Rb.commit()):td.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};Rb.wWj=function(xc,id){return 0!==id&&xc.length?1===id?Rb.a_e(Ef.y(xc,Rb.ea.xa)||Rb.QCi(xc),747):Rb.a_e(Uf.a.eod(xc),749):null};Rb.selectedRange=oa;Rb.mM=Wa;Rb.ea=L.ea;Rb.sheetName=oa.SheetName;Rb.DLa();Rb.mm();Rb.jc=Rb.zyb?9:1;Rb.Fc(1,pe.a.instance.fa(4));Rb.zyb&&Rb.Fc(2,pe.a.instance.fa(750));L={};L=(L[Uc.wfh]=Rb.yIe,L[Uc.mgh]=Rb.x1a,L[Uc.Szg]=Rb.Kmb,L[Uc.Tzg]=Rb.GTc,L[Uc.M3g]=Rb.Mqb,L);
oa={};L=(oa[Uc.$y]=Rb.Ac,oa[Uc.xWj]=Rb.wWj,oa[Uc.UOg]=L,oa);Rb.initializeAndShow(Rb.io,Rb.J8h,L);return Rb}function ae(L){return Xh.call(this,L)||this}function ue(L,oa,Wa,Rb){var xc=Jg.call(this)||this;xc.$=L;xc.businessBar=Rb;xc.openInExcelOperation=oa;xc.eK=Wa;return xc}function Lf(){}function xf(L){var oa=rh.call(this,L)||this;oa.ZH=null;oa.dDb=function(){td.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(oa.$.ya.IsMeetingLiveSession)return oa.Hjg(),!0;Cf.a.Vp?(td.ULS.sendTraceTag(574993312,
306,50,"Android intent scheme is being used to open android app from browser"),oa.eC&&oa.eC.length||td.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),oa.openUrl("intent:"+oa.eC+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+oa.Sq+";end","_top")):9<=Cf.a.Okd?(td.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),oa.openUrl(oa.vOa,"_top"),window.setTimeout(function(){oa.openUrl(oa.Sq,
"_blank")},9E3)):(td.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),oa.openUrl(oa.vOa,"_top"),window.setTimeout(function(){oa.openUrl(oa.Sq,"_blank")},500));return!0};oa.hma=function(Wa){return Wa.Ea.keyCode===si.a.$h||Wa.Ea.keyCode===si.a.Noa?(td.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Wa.Tb.click(),!0):!1};if(1!==Od.AFrameworkApplication.sa.Qa.Pj)return oa;oa.eC=
oa.$.workbookContext.ClientUrl;oa.vOa="ms-excel:ofe|u|"+oa.eC;oa.Sq=Od.AFrameworkApplication.ga.Ua("AppUrl");Cf.a.Lka?oa.Sq="itms-apps://"+Od.AFrameworkApplication.ga.Ua("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":Cf.a.Vp&&(jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&oa.$.ya.IsMeetingLiveSession?(td.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),oa.Sq=Od.AFrameworkApplication.ga.Ua("WildFireMarketUrlExcelAndroid")):
Cf.a.Ggc?oa.Sq=Od.AFrameworkApplication.ga.Ua("WildFireUrlChinaStoreAndroid"):4<Cf.a.iqe.GBb&&(oa.Sq=Od.AFrameworkApplication.ga.Ua("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return oa}function Rf(){}function dc(L){this.calculateType=0;this.calculateType=L}function Oc(L){this.calculationMode=0;this.calculationMode=L}function Ed(L,oa){var Wa=this;this.dialog=null;this.exf=function(){Wa.dialog&&Wa.dialog.hide()};this.FGi=L;this.Ab=oa;this.Ab.mnb(this.exf)}
function Gd(L,oa){return Ee.call(this,L,void 0,void 0,oa)||this}function Ee(L,oa,Wa,Rb,xc,id){oa=void 0===oa?!0:oa;Wa=void 0===Wa?!1:Wa;Rb=void 0===Rb?null:Rb;xc=void 0===xc?null:xc;id=void 0===id?!1:id;var rd=gd.call(this)||this;rd.aY=null;rd.Ul=null;rd.RVa=null;rd.SVa=null;var $d=rd.OVd?rd.OVd:CommonUIStrings.l_DefaultDialogTitle;Ee.Zwb=id;rd.uRb=Rb||new ee(L,!0);rd.uRb.Tse(rd);var Be=[],gg=[];Ee.wy&&(rd.RVc&&rd.RVc.forEach(function(wj){Array.add(Be,wj)}),rd.ipe&&rd.ipe.forEach(function(wj){Array.add(gg,
wj)}));oa?Wa?(rd.jc=4,rd.Fc(1,rd.buttonText),rd.Fc(2,CommonUIStrings.l_DialogClose)):(rd.jc=6,rd.Fc(0,CommonUIStrings.l_DialogClose)):rd.jc=5;id=document.createElement("span");rd.S4c&&(id.className=rd.S4c);Rb=document.createElement("a");Rb.innerText=rd.tjc;Rb.href=L;Rb.target="_blank";Rb.id=rd.sjc;Rb.className=tc.AFrame.Rpe;var Wg=!Cf.a.MC&&!!xc&&0<xc.count;if(Wg){var Dh=eg.a.ogd(L,xc);xc=eg.a.QId(L,xc);Rb.href="#";Rb.target="_self";rd.Ul=document.createElement("form");rd.Ul.id="printPreviewPostForm1";
rd.Ul.method="post";rd.Ul.target="_blank";rd.Ul.action=xc;xc=yl(Dh);for(Dh=xc.next();!Dh.done;Dh=xc.next()){Dh=Dh.value;var ei=document.createElement("input");ei.type="hidden";ei.name=Dh.key;ei.value=Dh.value;rd.Ul.appendChild(ei)}}else rd.Ul=null;rd.Ul||Ee.Zwb?Ee.Zwb||(L={},Array.add(gg,(L.type="AppLinkProps",L.id=rd.sjc,L.text=rd.tjc,L.onExecute=function(){rd.IMf()},L))):(xc={},Dh={},Array.add(gg,(Dh.type="AppLinkProps",Dh.id=rd.sjc,Dh.text=rd.tjc,Dh.handler=(xc.href=Wg?"#":L,xc.target=Wg?"_self":
"_blank",xc),Dh)));rd.$Na&&Array.add(Be,rd.$Na);Wa?(L=document.createElement("span"),L.innerText=rd.$Na.replace("{0}",""),id.appendChild(L)):rd.Mqf?(L=document.createElement("span"),L.id=rd.ri("message"),Wg=document.createElement("span"),xc=document.createElement("span"),Dh=rd.$Na.split("{0}"),Wg.innerText=Dh[0],xc.innerText=Dh[1],L.appendChild(Wg),L.appendChild(Rb),L.appendChild(xc),id.appendChild(L)):(L=document.createElement("span"),L.innerText=rd.$Na,id.appendChild(L),id.appendChild(document.createElement("br")),
id.appendChild(document.createElement("br")),id.appendChild(Rb),Ee.Zwb||Array.add(Be,"{0}"));rd.Ul&&id.appendChild(rd.Ul);Ee.wy&&(rd.U7a&&(rd.QAb?rd.ame(rd.U7a,rd.QAb):(Array.add(Be,"{0}"),L={},Array.add(gg,(L.type="AppLinkProps",L.id="LearnMoreLinkId",L.text=rd.U7a,L.onExecute=function(){rd.mjc()},L)))),rd.Kra(Be,gg));rd.XBb($d,null,rd.A$e,null,Object(qf.a)(rd,rd.$v,"dialogHandler"),Ee.wy?null:id);rd.gX(rd.ri("message"));!Ee.wy&&rd.QAb&&rd.U7a&&($d=document.createElement("div"),$d.className="WACDialogLearnMoreLinkContainer",
rd.aY=document.createElement("a"),rd.aY.innerText=rd.U7a,rd.aY.href=rd.QAb,rd.aY.target="_blank",rd.aY.id=rd.ri("LearnMoreLinkId"),rd.aY.className=tc.AFrame.Rpe,$d.appendChild(rd.aY),oa?rd.Lb.insertBefore($d,rd.Lb.lastChild):rd.Lb.appendChild($d),rd.gX(String.format("{0} {1}",rd.ri("message"),rd.ri("LearnMoreLinkId"))));rd.Phb=Rb;Wa?rd.Hz(rd.HB):rd.Hz(rd.Phb);rd.Imf();Od.AFrameworkApplication.sa.rX.qa(mg.a.click,rd.Phb,Object(qf.a)(rd,rd.SJe,"downloadLinkClicked"),null);rd.aY&&Od.AFrameworkApplication.sa.rX.qa(mg.a.click,
rd.aY,Object(qf.a)(rd,rd.mjc,"learnMoreLinkClicked"),null);rd.tRb=!1;return rd}function ee(L,oa){this._url=L;this.vtg=oa}function hf(L){return Bb.call(this,L)||this}function kf(L){this.Gi=L}function rf(L){var oa=fh.call(this)||this;oa.$=L;oa.dc();return oa}function ng(){}function je(){this.tb=null}function bg(L){this.nLa=this.fab=null;this._initialized=!1;this.Akd=L}function ig(){this.tb=null}function Yd(L,oa,Wa,Rb,xc,id){oa=kg.call(this,oa,Wa,Rb,xc,id)||this;oa.La=L;return oa}function If(L,oa,Wa,
Rb,xc,id,rd){oa=yd.call(this,oa,Wa,Rb,xc,id,rd)||this;oa.Oog=L;return oa}function Pd(L,oa,Wa,Rb){L=Vc.call(this,L,oa,Wa,Rb)||this;L.qtg=oa;return L}function Ze(L){var oa=te.call(this)||this;oa.jc=1;oa.Fc(1,CommonUIStrings.l_RetryButtonLabel);oa.Fc(0,CommonUIStrings.l_DialogClose);oa.La=L;return oa}function Yf(L,oa,Wa){this.La=L;this.KX=oa;this.kmb=Wa}function Xf(L,oa,Wa,Rb){var xc=Pg.call(this)||this;xc.N8=null;xc.cSb=null;xc.La=L;xc.KX=oa;xc.kmb=Wa;xc.Fc(1,CommonUIStrings.l_SaveButtonLabel);xc.eg=
rg.eg;xc.Ue="FileNameDialog-SaveACopy";xc.Fh=Rb;return xc}function rg(){}function uf(){this.tb=null}function kg(L,oa,Wa,Rb,xc){this.N8=this.vm=this.ECa=null;this.lDa=!1;this.Fh=this.Iga=null;this.BSc=L;this.Rkb=oa;this.Es=Wa;this.gf=Rb;this.Ah=xc}function qh(L){this.wb=L;this.jFa=L.appSettings.SkyDriveUploadWebServiceBase;this.bA=L.appSettings.FileName;this.Hfa=L.Ua("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function La(L,oa,Wa,Rb,xc,id,rd){this.iFa=L;this.bA=oa;this.LVa=Wa;this.cSb=Rb;
this.fPc=xc;this.Hfa=id;this.Fh=rd}function Db(L,oa,Wa){this.La=L;this.f2=oa;this.KX=Wa}function uc(L,oa,Wa){var Rb=jh.call(this)||this;Rb.La=L;Rb.f2=oa;Rb.KX=Wa;Rb.Cv=!1;Rb.jc=1;Rb.xna(1);Rb.Fc(1,CommonUIStrings.l_SignIn);Rb.Fc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return Rb}function Vc(L,oa,Wa,Rb){this.nVb=null;this.Dvg=L;this.wb=Wa;this.ade=oa;this.Cae=new Lh.a;this.Ah=Rb}function yd(L,oa,Wa,Rb,xc,id){this.Fh=null;this.zwg=L;this.f2=oa;this.kmb=Wa;this.wb=Rb;this.VPb=xc;this.Es=id}
function Md(){}function qe(){var L=Ag.call(this)||this;L.jc=0;L.Fc(1,CommonUIStrings.l_DialogClose);return L}function ac(){this.vga=this.STb=this.QTb=this.tb=null}function Kc(L,oa,Wa,Rb,xc){this.vm=this.ECa=null;this.FEc=!1;this.gQc=this.N8=null;this.BSc=oa;this.Rkb=Wa;this.Es=Rb;this.gf=xc;this.La=L}function dd(L){this.jFa=L.appSettings.SaveAsToHostWebServiceBase;this.bA=L.appSettings.FileName;this.Hfa=L.Ua("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}function Ud(L,oa,Wa,Rb,xc,id,rd,
$d){this.iFa=L;this.bA=oa;this.LVa=Rb;this.fPc=id;this.N8=Wa;this.Gwg=xc;this.Hfa=rd;this.Fh=$d}function Le(L,oa,Wa,Rb){this.Fh=this.cce=null;this.cFa=L;this.Es=oa;this.cOc=Wa;this.gf=Rb}function ce(L,oa,Wa,Rb,xc,id,rd){this.wb=L;this.kIc=Wa;this.La=oa;this.rlb=Rb;this.lib=xc;this.cOc=id;this.rmg=rd}function Nf(){return nf.call(this)||this}function af(L,oa,Wa,Rb){var xc=this;this.Ho=this.pkb=null;this.lib=L;this.gf=Wa;this.Ttg=Rb;this.xDa=new Kf.a(function(){return new Ch.a(oa.value,Object(qf.a)(xc,
xc.svb,"getMoreInfoEventReceived"))})}function wf(L,oa,Wa,Rb,xc,id,rd,$d,Be,gg){this.La=oa;this.wb=L;this.KX=Rb;this.Jga=id;this.Es=xc;this.gf=Wa;this.gge=rd;this.asg=void 0===$d?null:$d;this.cFa=void 0===Be?null:Be;this.DXa=void 0===gg?null:gg}function vf(L,oa,Wa,Rb,xc,id,rd,$d,Be){this.tMc=null;this.bA="";this.rlb=L;this.Es=oa;this.Fh=Be;this.Jga=Wa;this.gf=xc;this.Bv=Rb;this.cFa=rd;this.DXa=$d;id&&(this.tMc=new Kf.a(function(){return new Ch.a(id.value,null)}))}function pg(){this.properties=this.friendlyPath=
this.folderName=null}function bf(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=null}function Bf(L,oa,Wa,Rb,xc,id,rd,$d){L=Lc.call(this,L,oa,Wa,Rb,xc,id,$d)||this;L.Gy=null;L.kQc=null;L.hqa=null;L.MSg=CommonUIStrings.l_SaveToAnotherFolder;L.eg=$e.eg;L.Ue="FileNameDialog-SaveToSharePoint";L.rlb=rd;L.xtg=$d;return L}function $e(){}function He(){var L=pi.call(this)||this;L.jc=0;L.Fc(1,CommonUIStrings.l_DialogClose);return L}function vg(){this.tb=null}
function ah(L,oa,Wa,Rb,xc,id,rd,$d){this.vm=null;this.WWa=this.lDa=!1;this.Iga=this.Fh=this.bA=null;this.wb=oa;this.iFa=this.wb.appSettings.SaveAsToHostWebServiceBase;this.X8d=Rb;this.Rkb=xc;this.Tg=Wa;this.Es=id;this.Ah=$d;this.gf=rd;this.La=L;this.Hfa=oa.Ua("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}function Ph(L,oa,Wa){this.Jga=Wa;this.kIc=oa;this.wb=L}function Pf(L,oa,Wa,Rb,xc,id){this.La=oa;this.wb=L;this.KX=Rb;this.Jga=id;this.Es=xc;this.gf=Wa}function Da(L,oa,Wa,Rb,xc,id){L=Lc.call(this,
L,oa,Wa,Rb,xc,id)||this;L.eg=Fb.eg;L.Ue="FileNameDialog-SaveAsToHost";return L}function Fb(){}function Lc(L,oa,Wa,Rb,xc,id,rd){rd=void 0===rd?null:rd;var $d=Bg.call(this)||this;$d.iJ=null;$d.La=oa;$d.KX=Rb;$d.Jga=id;$d.wb=L;$d.Es=xc;$d.gf=Wa;$d.fib=$d.wb.ra("SaveToHostWithExtraCharsInFileName");$d.Fh=rd;$d.Fc(1,CommonUIStrings.l_SaveButtonLabel);return $d}function ud(L,oa){this.wb=L;this.La=oa;this.fib=this.wb.ra("SaveToHostWithExtraCharsInFileName")}function zd(L,oa){var Wa=zg.call(this)||this;Wa.WWa=
!1;Wa.bA=null;Wa.La=L;Wa.fib=oa;Wa.lSa=!1;return Wa}function Ce(){this.tb=null}function Ge(L){this.Vl=null;this.Tg=L;this.HPc=3}function gf(L,oa,Wa,Rb){oa=Ea.call(this,L,oa,Wa,Rb)||this;oa.options.advanced.filter=L.Ua("OneDriveApiV72Filter")||"folder,photo";oa.options.advanced.linkType="download";oa.options.multiSelect=Od.AFrameworkApplication.Kqe;L.ra("OneDriveApiV72CommandModeEnabled")&&(oa.options.commandMode=L.Ua("OneDriveApiV72CommandMode")||"none");L.ra("OneDriveApiV72QosExtraDataEnabled")&&
(oa.options.qosExtradata=new Df(Od.AFrameworkApplication.userSessionId));return oa}function Df(L){this.olsSessionId=this.value=this.key=null;this.olsSessionId=L}function Ea(L,oa,Wa,Rb){oa=Qc.call(this,L,oa,Wa,Rb)||this;oa.hlg=L;oa.options={};oa.options.advanced={};oa.options.action="query";oa.options.clientId=oa.ga.Ua("OneDriveApiV72ClientId");oa.options.advanced.trapFocus=!0;return oa}function kb(L,oa,Wa,Rb,xc){L=Qc.call(this,L,oa,Wa,Rb)||this;L.$ce=null;L.qSb=null;L.oog=xc;L.options={};L.options.clientId=
L.ga.Ua("OneDriveApiV7ClientId");L.options.cancel=Object(qf.a)(L,L.bAc,"toggleHostDivVisibility");return L}function Vb(L,oa,Wa,Rb,xc,id){oa=Qc.call(this,oa,Wa,Rb,id)||this;oa.Fh=null;oa.f2=L;oa.twg=xc;return oa}function Qc(L,oa,Wa,Rb){this.pEa=this.s6=null;this.CQc=this.EQc=!1;this.VWa=null;this.wb=L;this.VPb=oa;this.WDa=Wa;this.Es=Rb}function Mc(){}function Ab(){var L=hi.call(this)||this;L.jc=0;L.Fc(1,CommonUIStrings.l_DialogClose);return L}function nc(){}function Rd(L,oa,Wa,Rb){this.kib=L;this.Kqa=
oa;this.Z1=Wa;this.Bpg=Rb}function Je(L,oa,Wa,Rb,xc,id,rd){var $d=this;this.Ho=null;this.tge=!1;this.aqa=this.P2d=0;this.Wsg=L;this.TWa=oa;this.UTb=Wa;this.kib=Rb;this.Kqa=xc;this.Z1=id;this.xDa=new Kf.a(function(){return new Ch.a(rd.value,Object(qf.a)($d,$d.svb,"getMoreInfoEventReceived"))})}function he(L,oa,Wa,Rb,xc,id,rd,$d){var Be=this;this.KFc=null;this.TSc=!0;this.lQb="";this.Wxg=0;this.CWa=null;this.dMc=3;this.wb=$d;this.Z1=L;this.lj=oa;this.Pog=Wa;this.Vlg=Rb;this.Ulg=xc;this.xDa=new Kf.a(function(){return new Ch.a(id.value,
null)});this.Cpg=new Kf.a(function(){return new Ch.a(rd.value,Object(qf.a)(Be,Be.wCi,"mruEventResultReceived"))});this.wb.ra("WacInTabOpenMRUIsEnabledForUiHost");this.wb.ra("UiHostSupportsDocRebootFeatures")}function Ff(){return Kh.call(this)||this}function Fe(L,oa,Wa,Rb,xc,id){var rd=this;this.VRc=this.Ho=this.mQb=null;this.gWb=this.$Qc=!1;this.rbe=0;this.OQc=this.kLc=!1;this.Z1=L;this.kib=oa;this.xDa=new Kf.a(function(){return new Ch.a(Wa.value,Object(qf.a)(rd,rd.svb,"getMoreInfoEventReceived"))});
this.Nsg=Rb;this.Kqa=xc;this.kwg=id;this.Blb=this.jxc;2===this.RK.gca&&(this.OQc=!0)}function Tf(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}function Hd(){}function Ye(){}b.r(F);var Fd=b(516),ve=b(0),jg=b(273);Ye.prototype.ji=function(){};Ye.prototype.init=function(){};Ye.prototype.dispose=function(){};Ye.main=function(){jg.a.instance.sj(new Ye)};Sk.Object.defineProperties(Ye.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});
Object(ve.a)(Ye,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var Kf=b(685),td=b(13),qf=b(80),Ch=b(940),Uf=b(29),Rg=b(125);Hd.Ykh=function(L){return Hd.vve("New",L)};Hd.Zkh=function(L){return Hd.vve("Open",L)};Hd.eve=function(L,oa){return Hd.Cha("LoadingMenuSection",Hd.Wti,L,Hd.bpb("lblLoading",oa))};Hd.cpb=function(L,oa,Wa,Rb){return Hd.Cha("MessageMenuSection",Hd.zrf,oa,Hd.bpb("lblMessage",L,void 0===Wa?null:Wa,void 0===Rb?null:Rb))};Hd.gRg=function(L){return Hd.eve(L,CommonUIStrings.l_VoicedLoadingText)};
Hd.hRg=function(L,oa){return Hd.cpb(CommonUIStrings.l_NewCreationLocationMessage,L.Ei,oa.cS,oa.coa)};Hd.fRg=function(L,oa){return Hd.cpb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,oa.coa,"\n\n"),L.Ei)};Hd.gve=function(L){return Hd.cpb(CommonUIStrings.l_NewGenericErrorMessage,L.Ei)};Hd.dRg=function(L,oa,Wa){return Hd.Cha("menuNewBlank",Hd.Y6h,Wa?L.Ei:null,Hd.Xob(L.R8e,L.S8e,L.T8e,null,L.mka,L.pxb,oa,"blank"))};Hd.eSg=function(){return Hd.bpb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};
Hd.qve=function(){return Hd.bpb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};Hd.fSg=function(L,oa){return Hd.Cha("menuNewTemplates",L,null,oa)};Hd.bRg=function(L,oa){return Hd.Cha("menuNewMoreTemplates",Hd.DVe,null,Hd.Xob("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,L,oa))};Hd.fQg=function(L,oa,Wa){var Rb="";Wa&&oa&&(Rb=Hd.Cha("BrowseMoreMenuSection",Hd.DVe,null,Hd.Xob("btnBrowseMore",oa,oa,null,null,null,L||"1959943459",
Wa)));return Rb};Hd.bpb=function(L,oa,Wa,Rb){Wa=void 0===Wa?null:Wa;var xc=Rb=void 0===Rb?null:Rb;oa&&0<oa.length&&(xc=Hd.ssf.Cpc(oa).trimEnd(),xc=0<=xc.indexOf("{0}")?String.format(xc,Rb):String.format("{0} {1}",xc,Rb));Wa=Wa&&Rb?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',Uf.a.xf(Wa),Uf.a.xf(Rb),Uf.a.xf(xc)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Uf.a.xf(L||
""),Hd.ssf.Cpc(Uf.a.xf(oa||"")),Wa)};Hd.Xob=function(L,oa,Wa,Rb,xc,id,rd,$d){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',Uf.a.xf(L||""),Uf.a.xf(oa||""),Uf.a.xf(Wa||""),Rb||"32by32",Uf.a.xf(xc||""),Uf.a.xf(id||""),rd,Uf.a.xf($d||""))};Hd.vve=function(L,oa){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',
L,oa)};Hd.Cha=function(L,oa,Wa,Rb){Wa=Wa?String.format('Title="{0}"',Uf.a.xf(Wa)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',Uf.a.xf(L||""),Uf.a.xf(oa||""),Wa,Rb)};Hd.zrf="MenuMru";Hd.Wti="MenuLoading";Hd.Y6h="MenuHeader";Hd.DVe="MenuFooter";Hd.ssf=Rg.a.yx("\n","&#10;");Object(ve.a)(Hd,"NewAndOpenXmlUtilities",
null,[]);var Od=b(5),gh=b(95),fi=b(168);Object(ve.a)(Tf,"HostInformation",null,[]);var hh=b(108),ye=b(47),Dg=b(373),Jf=b(170),Ne=b(689),gi=b(596),kh=b(104),Vf=b(30);Fe.prototype.Qg=function(){var L=this.RK.R8a;L.fc(Vf.a.newDocument,kh.a.frame,Object(qf.a)(this,this.newDocument,"newDocument"));L.ef(Vf.a.Upc,kh.a.frame,Object(qf.a)(this,this.Upc,"populateNewMenu"),96)};Fe.prototype.newDocument=function(L,oa,Wa,Rb,xc){return 1===Wa?32:2===Wa&&xc&&xc.MenuItemId&&xc.SourceControlId?this.E0a(xc.MenuItemId,
xc.SourceControlId):8};Fe.prototype.E0a=function(L,oa){var Wa=this.Klc.m4c;if(null===Wa)return 8;var Rb=Od.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(Od.AFrameworkApplication.bla&&Rb){td.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");var xc={};xc[Dg.a.$db]=L;xc[Dg.a.VP]=this.VP;xc[Dg.a.lcid]=Od.AFrameworkApplication.lcid.toString();xc[Dg.a.reason]=Ne.a.createNew;Od.AFrameworkApplication.vV().execute(function(id){id.Sj(Jf.a.E0a,
xc)})}else Rb=(new Date).getTime(),oa=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Wa,Uf.a.pf(this.Ola),Uf.a.pf(L),Uf.a.pf(this.VP),Uf.a.pf(Od.AFrameworkApplication.lcid.toString()),Uf.a.pf(Rb.toString()),Uf.a.pf(oa),Uf.a.pf(Od.AFrameworkApplication.canary),Od.AFrameworkApplication.mj),(Wa=Od.AFrameworkApplication.ga.Ua("ScenarioId"))&&""!==Wa&&(oa+="&wdscenarioid="+Uf.a.pf(Wa)),oa+="&"+Od.AFrameworkApplication.Rbc(),
Od.AFrameworkApplication.Rwa&&(oa+="&"+Od.AFrameworkApplication.kbc()),(Wa=this.Ho?this.Ho.cS:null)&&(oa+="&DestinationUrl="+Uf.a.pf(Wa)),ye.a.vf(oa,"_blank",void 0,"CreateNewDocument");2===this.RK.gca&&(oa={},td.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(oa.AppType=gi.a[this.RK.gca],oa.Template=L,oa)));return 32};Fe.prototype.Zwi=function(L){var oa=Number.MAX_VALUE,Wa=Number.MIN_VALUE,Rb=window.performance;if(Rb&&"undefined"!==typeof Rb.getEntriesByName){for(var xc=0;xc<
L.length;xc++){var id=Rb.getEntriesByName(L[xc]);id&&0<id.length&&(id=id[0],oa=Math.min(parseInt(String(id.fetchStart)),oa),Wa=Math.max(parseInt(String(id.responseEnd)),Wa))}Wa>oa&&(L={},td.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(L.TotalElapsedMs=Wa-oa,L.MinFetchStart=oa,L.MaxResponseEnd=Wa,L)))}};Fe.prototype.Upc=function(L,oa,Wa,Rb,xc){if(1===Wa)return this.OQc&&(Od.AFrameworkApplication.CK("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.OQc=!1),32;2!==Wa||this.kLc||(this.rbe=(new Date).getTime(),L={},td.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(L.ShouldShowTemplates=this.jxc,L.CachedNewMenuXmlExists=!!this.mQb,L.ShouldCallGetMoreInfo=this.RK.supportsGetMoreInfoForPersonalStorage,L)));return this.D_i(xc)};Fe.prototype.D_i=function(L){L&&(this.mQb?L.PopulationXML=this.mQb:(this.RK.supportsGetMoreInfoForPersonalStorage&&!this.Ho&&this.QDi.hz("Opened New menu",!0),L.PopulationXML=this.aJh(this.getTemplateListJson())));
return 32};Fe.prototype.ehf=function(){return!this.RK.supportsGetMoreInfoForPersonalStorage||!!this.Ho&&3===this.Ho.state&&!!this.Ho.coa&&!!this.Ho.cS};Fe.prototype.kmi=function(){return Od.AFrameworkApplication.sa&&Od.AFrameworkApplication.sa.Qa.f_?!0:this.ehf()};Fe.prototype.getTemplateListJson=function(){var L=this;if(!this.jxc||!this.kmi())return null;if(this.Blb&&!this.gWb){var oa="9",Wa=Od.AFrameworkApplication.ga.appSettings;"NumberOfTemplatesInBackstage"in Wa&&(oa=Wa.NumberOfTemplatesInBackstage);
var Rb=this.VP;"TemplateCollectionId"in Wa&&(Rb=Wa.TemplateCollectionId);oa=String.format(this.RK.jW+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",Uf.a.pf(Od.AFrameworkApplication.lcid.toString()),Uf.a.pf(Rb),oa);Boolean.parse(Wa.AppendOriginQueryParam||"false")&&(oa+="&org=backstage");oa+="&"+Od.AFrameworkApplication.Rbc();Od.AFrameworkApplication.Rwa&&(oa+="&"+Od.AFrameworkApplication.kbc());this.RK.rCb.Xl(oa,1,null,null,!1,2,function(xc){L.RK.HNa("CreateNewActor.GetTemplateListJson",xc.data);
L.OJj(xc.data.ie)},function(xc){L.RK.HNa("CreateNewActor.GetTemplateListJson",xc.data);L.NJj()},null,void 0,void 0,void 0,void 0,"5");this.Blb=!1}return this.VRc};Fe.prototype.OJj=function(L){this.VRc=L;this.Blb=!1;this.AGb();if(Od.AFrameworkApplication.sa&&Od.AFrameworkApplication.sa.Qa.f_&&fi.c()){L=Od.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");var oa=Od.AFrameworkApplication.bla;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.VRc,!0,
L&&oa))}};Fe.prototype.NJj=function(){this.gWb=this.Blb=!0;this.AGb();Od.AFrameworkApplication.sa&&Od.AFrameworkApplication.sa.Qa.f_&&fi.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));gh.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};Fe.prototype.L_h=function(L){for(var oa=0,Wa=0;Wa<L.length;Wa++)if("ST"===L[Wa].ImageType){oa=Wa;break}var Rb=L.length?L[oa]:null;L=Rb?Rb.Url||"":"";var xc,id=Wa=oa=!1;if(Rb&&
(xc=Rb.AspectRatio))xc=parseFloat(xc),1>xc?oa=!0:1.5<xc?Wa=!0:1===xc&&(id=!0);else switch(xc={},td.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(xc.Url=L,xc)),this.RK.gca){case 3:oa=!0;break;case 2:Wa=!0;break;case 5:id=!0}return{returnValue:L,y9h:oa?"95by123":Wa?"123by69":id?"100by100":"123by95"}};Fe.prototype.aJh=function(L){var oa=this.eRg(L,this.Klc,this.Klc.zGa||"1056925771");L=oa.returnValue;if(oa.Mwc){this.mQb=L;oa=(new Date).getTime()-this.rbe;var Wa={};td.ULS.sendTraceTag(5849604,
202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(Wa.ElapsedMsSinceMenuOpened=oa,Wa))}return L};Fe.prototype.svb=function(L,oa){td.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.Ho||3!==L.state?2===L.state&&(td.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.$Qc=!0,this.AGb()):(this.Ho=L,oa||this.AGb(),Od.AFrameworkApplication.sa&&Od.AFrameworkApplication.sa.Qa.f_&&fi.c()&&fi.d("setFileMenuHostInformation")&&(L=Object.assign(new Tf,
{hostUrl:this.Ho.cS,hostName:this.Ho.coa,folderUrl:Od.AFrameworkApplication.breadcrumbFolderUrl,folderName:Od.AFrameworkApplication.breadcrumbFolderName}),td.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(L))))};Fe.prototype.eRg=function(L,oa,Wa){var Rb=!1;var xc=this.ehf(),id="";if(this.RK.supportsGetMoreInfoForPersonalStorage)if(this.$Qc)id=Hd.gve(oa),this.$Qc=!1,td.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");
else if(this.Ho)if(xc)id=Hd.hRg(oa,this.Ho);else if(this.Ho.Edi)Rb=!0,this.Blb=!1,id=Hd.fRg(oa,this.Ho),td.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{Rb=!0;id=Hd.gve(oa);var rd={};td.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",(rd.PersonalFileStorageUrlIsSet=!!this.Ho.cS,rd.StorageServiceDisplayNameIsSet=!!this.Ho.coa,rd))}else id=Hd.gRg(oa.Ei),td.ULS.sendTraceTag(5849606,
202,50,"Rendering File>New with loading spinner");xc&&(xc=id,oa=Hd.dRg(oa,Wa,!id),L=this.dSg(L,Wa),Rb=L.Mwc,id=xc+(oa+L.returnValue));return{returnValue:Hd.Ykh(id),Mwc:Rb}};Fe.prototype.dSg=function(L,oa){var Wa=!1;if(!this.jxc)return Wa=!0,td.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Mwc:Wa};var Rb="",xc="",id="MenuTemplate";if(this.gWb)Rb=Hd.qve(),this.gWb=!1,td.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");
else if(L){try{var rd=Sys.Serialization.JavaScriptSerializer.deserialize(L,!0);Rb=this.cSg(rd,oa);td.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");Od.AFrameworkApplication.tsf&&"OneDrive"===this.Ola&&(xc=Hd.bRg(this.RDi,Od.AFrameworkApplication.tsf))}catch($d){oa={},td.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",(oa.JsonToConvert=L,oa)),Rb=Hd.qve()}Wa=!0}else id="MenuLoading",Rb=Hd.eSg(),td.ULS.sendTraceTag(5849611,202,50,
"Rendering File>New with template loading spinner");return{returnValue:Hd.fSg(id,Rb)+xc,Mwc:Wa}};Fe.prototype.cSg=function(L,oa){for(var Wa=this,Rb="",xc=[],id=0;id<L.length;id++){var rd=L[id],$d="";if(rd){var Be=rd.Title,gg=rd.AssetId,Wg=rd.Thumbnails;gg&&Be&&Wg&&(rd=void 0,$d=this.L_h(Wg),rd=$d.y9h,$d=$d.returnValue,Rb+=Hd.Xob("jbtnNewTemplate"+id,Be,null,rd,null,$d,oa,gg))}xc[id]=$d}L=new hh.a(4,1,5E3,function(){Wa.Zwi(xc)},106);this.RK.Ilc.Zg(L);return Rb};Fe.prototype.AGb=function(){this.kLc=
!0;this.RK.lsf.Pw(this.Klc.Mtb);this.kLc=!1};Sk.Object.defineProperties(Fe.prototype,{VP:{configurable:!0,enumerable:!0,get:function(){switch(this.RK.gca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},RK:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},Klc:{configurable:!0,enumerable:!0,get:function(){return this.kib.value}},QDi:{configurable:!0,enumerable:!0,get:function(){return this.xDa.value}},RDi:{configurable:!0,
enumerable:!0,get:function(){return this.Nsg.value}},Ola:{configurable:!0,enumerable:!0,get:function(){return this.Kqa.value}},jxc:{configurable:!0,enumerable:!0,get:function(){return this.kwg.value}}});Object(ve.a)(Fe,"CreateNewActor",null,[]);var ti=b(1316),Kh=ti.a;vm(Ff,Kh);Ff.prototype.Vme=function(){this.WT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.WT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.WT(2,CommonUIStrings.l_Open);this.WT(3,CommonUIStrings.l_OpenMenuRecentDocuments);
this.WT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.WT(5,CommonUIStrings.l_VoicedLoadingText)};Ff.sWi=function(L){return Ff.instance.fa(L)};Sk.Object.defineProperties(Ff,{instance:{configurable:!0,enumerable:!0,get:function(){return Ff.Oa||(Ff.Oa=new Ff)}}});Ff.Oa=null;Object(ve.a)(Ff,"MruActorIntlHelper",ti.a,[]);var Jh;(function(L){L[L.success=0]="success";L[L.failure=1]="failure";L[L.spinner=2]="spinner";L[L.none=3]="none"})(Jh||(Jh={}));Object(ve.b)("DisplayState",Jh);var nh=b(40);he.prototype.wCi=
function(L,oa){this.CWa=L;oa||this.pOf()};he.prototype.h$i=function(){this.nB.R8a.ef(Vf.a.Tpc,kh.a.frame,Object(qf.a)(this,this.Tpc,"populateMruMenu"),96)};he.prototype.Tpc=function(L,oa,Wa,Rb,xc){return 1!==Wa&&xc?this.A_i(xc):32};he.prototype.A_i=function(L){this.Dlh();this.Clh();L.PopulationXML=Hd.Zkh(this.lQb+this.KFc);return 32};he.prototype.Dlh=function(){var L=3,oa=!1;if(this.lQb&&this.Wxg===this.CWa.uLj)L={},td.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",
(L.CacheRefresh="Not Dirty",L)),L=this.dMc;else{var Wa={};td.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(Wa.CacheRefresh="Starting",Wa));Wa=this.nB.ew();this.CWa=this.vCi.hz("File Open opened",!0);if(this.lQb&&2!==this.dMc&&3!==this.CWa.state)oa=!0;else{L=this.GYh(this.CWa);Od.AFrameworkApplication.sa&&Od.AFrameworkApplication.sa.Qa.f_&&fi.c()&&L&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(L,!0));var Rb=this.bJh(this.CWa);L=Rb.IDi;this.lQb=
Rb.returnValue}Wa=this.nB.ew()-Wa;Rb={};td.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(Rb.CacheRefresh="Complete",Rb.ElapsedMs=Wa,Rb))}2!==L&&(Wa={},Wa=(Wa.DisplayState=Jh[L],Wa),1!==L&&(Wa.IsStale=oa),td.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Wa));this.dMc=L};he.prototype.GYh=function(L){try{var oa=nh.c(L.Zwd)}catch(Wa){oa=null,td.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
Wa)}return oa};he.prototype.Clh=function(){if(this.TSc){td.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var L=this.tyi();this.TSc=L.YXj;this.KFc=L.returnValue}else td.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");L={};td.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(L.WaitingOnLinkInfo=this.TSc,L.NotDisplayingLink=!this.KFc,L))};he.prototype.bJh=function(L){if(1===L.state||0===L.state){L={};td.ULS.sendTraceTag(5849635,
202,50,"Open menu XML built {0}",(L.Display="Spinner",L));L=2;var oa=Hd.eve(this.Vja(2),this.Vja(5))}else 3===L.state&&L.Zwd?(oa=this.cRg(L.Zwd),L=0):(L={},td.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(L.Display="Server Error",L)),oa=Hd.cpb(this.Vja(1),this.Vja(2)),L=1);return{returnValue:oa,IDi:L}};he.prototype.cRg=function(L){var oa=this.SBb.zGa||"2155708348";if(L.length){var Wa=Hd.bpb("lblRecentDocuments",this.Vja(3));for(var Rb=0,xc=0;xc<L.length;xc++){var id=L[xc];"FileName"in
id&&"DocumentUrl"in id&&"Path"in id&&(Wa+=Hd.Xob("MruButton"+xc,id.FileName.toString(),id.Path.toString(),null,this.SBb.mka,this.SBb.pxb,oa,id.DocumentUrl.toString()),id.IsPinned&&Rb++)}Wa=Hd.Cha("RecentDocumentsMenuSection",Hd.zrf,this.Vja(2),Wa);oa={};td.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(oa.Display="MRU List",oa.TotalDocuments=L.length,oa.NumPinnedDocuments=Rb,oa))}else Wa=Hd.cpb(this.Vja(0),this.Vja(2)),L={},td.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",
(L.Display="Empty MRU",L));return Wa};he.prototype.tyi=function(){var L=!0;var oa=this.yPg,Wa=this.xPg;if(oa&&Wa||!this.nB.supportsGetMoreInfoForPersonalStorage)L=!1;else{var Rb=this.tbc.hz("File Open",!1);3===Rb.state&&(oa=Rb.cS,Wa=Rb.coa,L=!1)}Wa=Wa?String.format(this.Vja(4),Wa):null;return{returnValue:Hd.fQg(this.SBb.zGa,Wa,oa),YXj:L}};he.prototype.pOf=function(){this.nB.lsf.Pw(this.SBb.Mtb)};Sk.Object.defineProperties(he.prototype,{nB:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},
Vja:{configurable:!0,enumerable:!0,get:function(){return this.lj.value}},SBb:{configurable:!0,enumerable:!0,get:function(){return this.Pog.value}},yPg:{configurable:!0,enumerable:!0,get:function(){return this.Vlg.value}},xPg:{configurable:!0,enumerable:!0,get:function(){return this.Ulg.value}},tbc:{configurable:!0,enumerable:!0,get:function(){return this.xDa.value}},vCi:{configurable:!0,enumerable:!0,get:function(){return this.Cpg.value}}});Object(ve.a)(he,"MruRenderer",null,[]);var ih=b(231),dh=
b(895);Je.prototype.E0a=function(){!this.Ho&&this.Ixd.supportsGetMoreInfoForPersonalStorage?this.tbc.hz("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};Je.prototype.svb=function(L){if(!this.Ho&&3===L.state)this.Ho=L;else if(2===L.state){this.tge?td.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.tbc.hz("NewDocumentFromStream",!0),this.tge=!0);return}this.createNewDocumentFromStream()};Je.prototype.createNewDocumentFromStream=function(){this.P2d=
(new Date).getTime();var L=this.oBh.m4c;if(null===L)this.TWa(null);else{var oa=this.UTb.menuItemId,Wa=this.UTb.CI,Rb=this.UTb.xHj,xc=this.UTb.tBh;this.aqa="streamBase64"===Rb?xc.length/1024:0;td.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.VP,this.aqa);var id=(new Date).getTime();L=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",L,Uf.a.pf(this.Ola),Uf.a.pf(oa),Uf.a.pf(this.VP),Uf.a.pf(Od.AFrameworkApplication.lcid.toString()),
Uf.a.pf(id.toString()),Uf.a.pf(Wa),Uf.a.pf(Od.AFrameworkApplication.canary),Od.AFrameworkApplication.mj,Uf.a.pf(Rb));L+="&"+Od.AFrameworkApplication.Rbc();Od.AFrameworkApplication.Rwa&&(L+="&"+Od.AFrameworkApplication.kbc());(oa=this.Ho?this.Ho.cS:null)&&(L+="&DestinationUrl="+Uf.a.pf(oa));this.Ixd.rCb.Xl(L,2,xc,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(qf.a)(this,this.LDi,"newDocumentFromStreamSuccessHandler"),Object(qf.a)(this,this.KDi,"newDocumentFromStreamFailureHandler"),
null,void 0,void 0,void 0,void 0,"31")}};Je.prototype.LDi=function(L){if(L&&L.data&&L.data.ie){var oa=nh.d(L.data.ie);var Wa=oa.Ju;oa.returnValue?Wa.StatusCode!==ih.a.kP&&Wa.StatusCode!==ih.a.orb?(td.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.VP,this.aqa,Wa.StatusCode),this.TWa(null)):Wa.NewDocumentUrl&&""!==Wa.NewDocumentUrl?(L=(new Date).getTime()-this.P2d,td.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.VP,this.aqa,L),this.Wsg(Wa.NewDocumentUrl)):(td.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.VP,this.aqa),this.TWa(null)):(Wa={},td.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.VP,this.aqa,(Wa.ResponseData=dh.a.Eeb(L.data.ie),Wa)),this.TWa(null))}else td.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.VP,this.aqa),this.TWa(null)};Je.prototype.KDi=function(L){L&&L.data&&td.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.VP,this.aqa,L.data.status);this.TWa(null)};Sk.Object.defineProperties(Je.prototype,{VP:{configurable:!0,enumerable:!0,get:function(){switch(this.Ixd.gca){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},oBh:{configurable:!0,enumerable:!0,
get:function(){return this.kib.value}},Ola:{configurable:!0,enumerable:!0,get:function(){return this.Kqa.value}},Ixd:{configurable:!0,enumerable:!0,get:function(){return this.Z1.value}},tbc:{configurable:!0,enumerable:!0,get:function(){return this.xDa.value}}});Object(ve.a)(Je,"NewDocumentFromStreamOperation",null,[]);Rd.prototype.create=function(L,oa,Wa){return new Je(L,oa,Wa,this.kib,this.Kqa,this.Z1,this.Bpg)};Object(ve.a)(Rd,"NewDocumentFromStreamOperationFactory",null,[747]);var Qh=b(86),xh=
b(525),Xg=b(52);nc.prototype.ji=function(L){L.register(Rd,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").Bc().Lc(function(){return new Rd(new Kf.a(function(){return Od.AFrameworkApplication.sa.Qa.Hed()}),new Kf.a(function(){return Od.AFrameworkApplication.Ola}),new Kf.a(function(){return L.Oh("Common.INewAndOpenCommonHelpers")}),new Kf.a(function(){return L.Oh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};
nc.prototype.init=function(){var L=this;Od.AFrameworkApplication.ga.ow(function(){L.Fxb()})};nc.prototype.Fxb=function(){var L=xh.a.Tq(Qh.a.instance.oc("Common.INewAndOpenCommonHelpers")),oa=xh.a.Tq(Qh.a.instance.oc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));Od.AFrameworkApplication.Ola&&Xg.Task.WAA.call(null,L,oa).continueWith(function(){var Rb=new Fe(new Kf.a(function(){return L.result}),new Kf.a(function(){return Od.AFrameworkApplication.sa.Qa.Hed()}),new Kf.a(function(){return oa.result}),
new Kf.a(function(){return Od.AFrameworkApplication.sa.Qa.Ied().zGa||"1959943459"}),new Kf.a(function(){return Od.AFrameworkApplication.Ola}),new Kf.a(function(){return Od.AFrameworkApplication.Vki}));Rb.Qg();Rb.AGb()});if(Od.AFrameworkApplication.cNf){var Wa=xh.a.Tq(Qh.a.instance.oc("Common.IEventEmitter<Common.IMruResult>"));Xg.Task.WAA.call(null,L,oa,Wa).continueWith(function(){var Rb=new he(new Kf.a(function(){return L.result}),new Kf.a(function(){return Ff.sWi}),new Kf.a(function(){return Od.AFrameworkApplication.sa.Qa.Ied()}),
new Kf.a(function(){return Od.AFrameworkApplication.rWi}),new Kf.a(function(){return Od.AFrameworkApplication.qWi}),new Kf.a(function(){return oa.result}),new Kf.a(function(){return Wa.result}),Od.AFrameworkApplication.ga);Rb.h$i();Rb.pOf()})}};nc.prototype.dispose=function(){};Sk.Object.defineProperties(nc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(ve.a)(nc,"UXPackageManager",null,[4,5,3]);var Lg=b(128),hi=Lg.StandardDialog;vm(Ab,hi);
Ab.prototype.displayError=function(L){this.Jz(L,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)};Ab.prototype.$6c=function(L){this.Jz(L,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(ve.a)(Ab,"ErrorDialog",Lg.StandardDialog,[733]);var Lh=b(139);Mc.prototype.KXe=function(){td.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var L=new Lh.a;L.setResult("api.onedrive.com");return L.task};Object(ve.a)(Mc,"OneDriveConsumerEndpointHelper",
null,[719]);var Kg=b(49),ai=b(375),Fh=b(219);Qc.prototype.Y3a=function(){this.VWa||(this.VWa=this.c$a?Fh.a.create(this.c$a,null,null,null,!1):null);return this.VWa};Qc.prototype.setup=function(L){var oa=this;this.pEa=L;this.EQc||this.CQc?this.EQc&&this.pEa&&this.pEa(!0):(L=this.Y3a())?(this.CQc=!0,L.$7a.continueWith(function(Wa){oa.zQi(Wa)}),ai.a.Kia(L)):(td.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.pEa(!1))};Qc.prototype.PAd=
function(L){td.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",L.exception?L.exception.toString():"No error detail.")};Qc.prototype.zQi=function(L){this.CQc=!1;if(L.kg)this.PAd(L),this.pEa(!1);else try{this.EQc=!0,td.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Tld(),td.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.pEa(!0)}catch(oa){td.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",oa.toString()),this.pEa(!1)}};
Qc.prototype.startPicker=function(L){this.s6=L;this.WDa?td.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(td.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(qf.a)(this,this.nzd,"onApiReady")))};Qc.prototype.nzd=function(L){L?this.jjc():this.vi()};Qc.prototype.vi=function(){this.Es().displayError(Kg.a.RVi)};Qc.prototype.onSuccess=function(L){td.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");
this.s6&&this.s6(!0,L)};Qc.prototype.dispose=function(){this.VWa&&this.VWa.dispose()};Sk.Object.defineProperties(Qc.prototype,{Cqe:{configurable:!0,enumerable:!0,get:function(){return this.VPb}},ga:{configurable:!0,enumerable:!0,get:function(){return this.wb}}});Object(ve.a)(Qc,"AOneDriveFilePickerApiManager",null,[768,3]);vm(Vb,Qc);Vb.prototype.start=function(L,oa){this.Fh=L;this.startPicker(oa)};Vb.prototype.Tld=function(){var L={},oa={};L=1===this.Cqe||2===this.Cqe?(L.client_id=this.ga.appSettings.UploadToSkyDriveClientId,
L):(oa.client_id=this.ga.appSettings.UploadToSkyDriveClientId,oa.env="INT",oa);WL.init(L)};Vb.prototype.startPicker=function(L){this.s6=L;!this.WDa&&this.f2.ULa?(td.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(qf.a)(this,this.nzd,"onApiReady"))):(td.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.twg())};Vb.prototype.jjc=function(){try{td.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.Fh).then(Object(qf.a)(this,
this.onSuccess,"onSuccess"),Object(qf.a)(this,this.r6,"onFailure"))}catch(L){td.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",L,L.stack),this.vi()}};Vb.prototype.r6=function(L){if(L&&L.error){if("user_canceled"===L.error.code){td.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}td.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",L.error.code,L.error.message)}else td.ULS.sendTraceTag(17909060,352,50,
"File Dialog returned with no response");this.s6&&this.s6(!1,L);this.vi()};Sk.Object.defineProperties(Vb.prototype,{c$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiUrl")}}});Object(ve.a)(Vb,"OneDriveFilePickerApiManagerV5",Qc,[]);vm(kb,Qc);kb.prototype.start=function(L,oa){var Wa=this;this.qSb=oa;var Rb=this.oog.KXe();Rb.continueWith(function(){td.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");Wa.$ce=Rb.result;
Wa.startPicker(function(xc,id){Wa.bAc();L(xc,id)})},3);Rb.continueWith(function(){td.ULS.sendTraceTag(24134242,352,15,Rb.exception.message);Wa.bAc()},5)};kb.prototype.Tld=function(){var L=this;this.options.success=function(oa){var Wa={};Wa.data=oa;L.onSuccess(Wa)};this.options.error=function(oa){var Wa={};Wa.error=oa;L.r6(Wa)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.$ce;this.options.advanced.iframeParentDiv=this.qSb};kb.prototype.jjc=
function(){try{td.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.bAc(),OneDrive.open(this.options)}catch(L){td.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",L.message),this.vi()}};kb.prototype.r6=function(L){this.s6&&this.s6(!1,L);this.vi()};kb.prototype.bAc=function(){this.qSb.style.visibility="hidden"===this.qSb.style.visibility?"":"hidden"};Sk.Object.defineProperties(kb.prototype,{c$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});
Object(ve.a)(kb,"OneDriveFilePickerApiManagerV7",Qc,[]);vm(Ea,Qc);Ea.prototype.start=function(L,oa,Wa,Rb){this.options.advanced.iframeParentDiv=Wa;this.options.advanced.endpointHint=Rb;this.options.cancel=oa;this.hlg.ra("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(L)};Ea.prototype.startPicker=
function(L){this.s6=L;this.WDa?td.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(td.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(qf.a)(this,this.nzd,"onApiReady")))};Ea.prototype.Tld=function(){var L=this;this.options.success=function(oa){var Wa={};Wa.data=oa;L.onSuccess(Wa)};this.options.error=function(oa){var Wa={};Wa.error=oa;L.r6(Wa)}};Ea.prototype.jjc=function(){try{td.ULS.sendTraceTag(23881879,216,50,
"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(L){td.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",L.message,L.stack),this.vi()}};Ea.prototype.PAd=function(L){td.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",L.exception?L.exception.toString():"No error detail.");ai.a.bbj(this.c$a);this.VWa=null};Ea.prototype.vi=function(){this.Es().$6c(Kg.a.Okj)};Ea.prototype.r6=function(L){this.s6&&
this.s6(!1,L)};Sk.Object.defineProperties(Ea.prototype,{c$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});Object(ve.a)(Ea,"OneDriveFilePickerApiManagerV72",Qc,[]);Object(ve.a)(Df,"IExtraData",null,[]);vm(gf,Ea);gf.prototype.jjc=function(){try{td.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?
this.options.qosExtradata.olsSessionId:"",Od.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(L){td.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",L.message,L.stack),this.vi()}};Sk.Object.defineProperties(gf.prototype,{c$a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});Object(ve.a)(gf,"OneDriveFilePickerApiOpenManagerV72",Ea,[]);Ge.prototype.KXe=function(){this.Vl=new Lh.a;td.ULS.sendTraceTag(24134235,
352,50,"Sending initial request for OneDrive for Business Endpoint");this.ENd();return this.Vl.task};Ge.prototype.ENd=function(L){L=void 0===L?null:L;var oa=String.format("GetMoreInfoHandler.ashx?{0}",Od.AFrameworkApplication.NHa);this.Tg.I9(oa,1,null,L,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(qf.a)(this,this.eUh,"getMoreInfoSucceeded"),Object(qf.a)(this,this.cUh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};Ge.prototype.cUh=function(L){if(L.data.httpStatus===ih.a.AFb&&"X-NewKey"in
L.data.responseHeaders){td.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var oa={};oa["X-Key"]=L.data.responseHeaders["X-NewKey"];this.ENd(oa)}else 0<this.HPc?(td.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.HPc),this.HPc--,this.ENd()):(td.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Vl.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};
Ge.prototype.eUh=function(L){"PersonalFileStorageUrl"in L.data.responseHeaders&&""!==L.data.responseHeaders.PersonalFileStorageUrl?(td.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Vl.setResult(L.data.responseHeaders.PersonalFileStorageUrl)):(td.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Vl.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(ve.a)(Ge,"OneDriveForBusinessEndpointHelper",
null,[719]);var Sg=b(581);Ce.prototype.init=function(){};Ce.prototype.dispose=function(){};Ce.prototype.ji=function(L){var oa=this;this.tb=L;this.tb.register(Vb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").Bc().Lc(function(){return new Vb(Sg.a.instance,Od.AFrameworkApplication.ga,Od.AFrameworkApplication.b2a,Od.AFrameworkApplication.limitedEdit,Od.AFrameworkApplication.O4f,function(){return new Ab})});Od.AFrameworkApplication.$hf?
this.tb.register(719,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Bc().Lc(function(){return new Mc}):this.tb.register(719,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").Bc().Lc(function(){return new Ge(Od.AFrameworkApplication.Jd)});this.tb.register(kb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").Bc().Lc(function(){return new kb(Od.AFrameworkApplication.ga,Od.AFrameworkApplication.b2a,Od.AFrameworkApplication.limitedEdit,function(){return new Ab},
oa.tb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.tb.register(Ea,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").Bc().Lc(function(){return new Ea(Od.AFrameworkApplication.ga,Od.AFrameworkApplication.b2a,Od.AFrameworkApplication.limitedEdit,function(){return new Ab})});this.tb.register(gf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").Bc().Lc(function(){return new gf(Od.AFrameworkApplication.ga,Od.AFrameworkApplication.b2a,
Od.AFrameworkApplication.limitedEdit,function(){return new Ab})})};Ce.main=function(){jg.a.instance.sj(new Ce)};Sk.Object.defineProperties(Ce.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});Object(ve.a)(Ce,"PackageManager",null,[4,5]);var zg=Lg.StandardDialog;vm(zd,zg);zd.prototype.displayError=function(L,oa,Wa){this.bA=oa;this.WWa=Wa;td.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",L,Wa);L=this.c0c(L);
0===L?(this.jc=6,this.Fc(0,CommonUIStrings.l_DialogClose)):(this.jc=0,this.Fc(1,CommonUIStrings.l_DialogClose));0===L&&td.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.Jz(Kg.a.Nkj,this.oed(L),this.GOh(L,oa),Object(qf.a)(this,this.JLd,"retryDialogHandler"),!0)};zd.prototype.JLd=function(L){1===L?(td.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.bA?this.La.Ce(Vf.a.wIb,2,[this.bA,this.WWa]):this.La.processAction(Vf.a.wIb,2)):td.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")};zd.prototype.c0c=function(L){return 0>L||6<L?(td.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",L),0):L};zd.prototype.GOh=function(L,oa){L=this.c0c(L);return this.fib?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,oa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][L]:
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,oa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][L]};zd.prototype.oed=function(L){L=this.c0c(L);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][L]};Object(ve.a)(zd,"ErrorRetryDialog",Lg.StandardDialog,[775]);ud.prototype.create=function(){return new zd(this.La,this.fib)};Object(ve.a)(ud,"ErrorRetryDialogFactory",null,[735]);var wh=b(140),ch=b(38),Bg=wh.a;vm(Lc,Bg);Lc.prototype.FIe=function(L,oa){this.vL(1,!!L&&L!==oa);this.iJ=document.getElementById(Lc.FTe);ch.a.addHandler(this.iJ,"change",Object(qf.a)(this,this.Ymc,"onFileNameChange"));ch.a.addHandler(this.iJ,"input",
Object(qf.a)(this,this.Ymc,"onFileNameChange"));this.iJ.focus()};Lc.prototype.m9b=function(L){return this.fib?(new RegExp("["+this.T7b('\\/:*?"<>|')+"]")).test(L):(new RegExp("["+this.T7b('\\/:*?"<>|#{}%~&')+"]")).test(L)};Lc.prototype.T7b=function(L){return L.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")};Lc.prototype.Rid=function(){var L=Uf.a.lr(Od.AFrameworkApplication.dm.zn);this.vL(1,!!this.iJ&&""!==this.iJ.value&&this.iJ.value!==L)};Lc.prototype.Ymc=function(){var L=this;this.iJ&&window.setTimeout(function(){L.Rid()},
0)};Lc.prototype.l9b=function(L,oa){if(1!==L)td.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{L=oa[Lc.FTe];oa=Lc.rGf in oa?oa[Lc.rGf]:!1;td.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Uf.a.rrc(L),oa);var Wa=Uf.a.v4(Od.AFrameworkApplication.fileName);(L=L?L.trim():null)&&""!==L&&""!==Wa||1===this.sa.state?this.m9b(L)?this.Es.create().displayError(1,L,oa):this.Jga.$na(L+Wa,oa,
this.Fh):this.Es.create().displayError(2,L,oa)}};Lc.prototype.dispose=function(){this.iJ&&(ch.a.removeHandler(this.iJ,"change",Object(qf.a)(this,this.Ymc,"onFileNameChange")),ch.a.removeHandler(this.iJ,"input",Object(qf.a)(this,this.Ymc,"onFileNameChange")),this.iJ=null);Bg.prototype.dispose.call(this)};Sk.Object.defineProperties(Lc.prototype,{sa:{configurable:!0,enumerable:!0,get:function(){return this.gf}}});Lc.FTe="txtFileName";Lc.rGf="chkOverwrite";Object(ve.a)(Lc,"FileNameDialogBase",wh.a,[]);
Sk.Object.defineProperties(Fb,{eg:{configurable:!0,enumerable:!0,get:function(){return wh.a.Cn(Fb.Vj,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});Fb.Vj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(ve.a)(Fb,"FileNameDialogHtml",null,[]);vm(Da,Lc);Da.prototype.GQ=function(L,oa){var Wa=Uf.a.lr(Od.AFrameworkApplication.dm.zn),Rb={};oa=(Rb.txtFileName=L||Wa,Rb.lblFolderName=CommonUIStrings.l_ToCurrentFolder,Rb.chkOverwrite=oa,Rb);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(qf.a)(this,this.l9b,"fileNameDialogHandler"),oa);this.FIe(L,Wa)};Object(ve.a)(Da,"FileNameDialog",Lc,[772]);Pf.prototype.create=function(){return new Da(this.wb,this.La,this.gf,this.KX,this.Es,this.Jga)};Object(ve.a)(Pf,
"FileNameDialogFactory",null,[732]);var Ah=b(688);Ph.prototype.Qg=function(){2===Od.AFrameworkApplication.sa.Qa.Pj?Od.AFrameworkApplication.Gb.ef(Vf.a.wIb,kh.a.frame,Object(qf.a)(this,this.VVf,"saveAsToHostActionDispatcher"),4):Od.AFrameworkApplication.Gb.fc(Vf.a.wIb,kh.a.frame,Object(qf.a)(this,this.VVf,"saveAsToHostActionDispatcher"))};Ph.prototype.VVf=function(L,oa,Wa,Rb,xc){return oa.contextId!==kh.a.frame||L!==Vf.a.wIb?2:this.wb.ra("SaveAsToHostBrsIsEnabled")?1===Wa?Ah.SessionStatusManager.instance.ywb||
Od.AFrameworkApplication.q5?8:32:2===Wa?(td.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),L=this.kIc.create(),xc&&Object.getType(xc)===Array&&2===xc.length?L.GQ(xc[0],!!xc[1]):L.GQ(null,!1),32):8:8};Object(ve.a)(Ph,"SaveAsToHostActor",null,[]);var eg=b(78);ah.prototype.fLb=function(){1!==this.gf.state&&(this.vm=this.Rkb(),this.vm.message=CommonUIStrings.l_CommentProgressTooltip,this.vm.jc=5,this.vm.Su=!1,this.vm.MAa(CommonUIStrings.l_DefaultDialogTitle,
null,null))};ah.prototype.wS=function(L){L=void 0===L?0:L;1!==this.gf.state&&this.Es.create().displayError(L,Uf.a.lr(this.bA),this.WWa)};ah.prototype.hQa=function(){var L=this.wb.appSettings.BreadcrumbFolderUrl;td.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");ye.a.vf(L,ye.a.CX(3),void 0,"UploadToHostManager.RedirectToFolder")};ah.prototype.gQa=function(L){var oa=!1,Wa=!1;this.wb&&(oa=this.wb.ra("SaveACopyIsEnabledForUiHost"),Wa=this.wb.ra("UiHostSupportsDocRebootFeatures"));
td.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",L,oa,Wa);if(oa&&Wa){td.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Rb={};Rb[Dg.a.bQa]="1";Rb[Dg.a.documentUrl]=L;Rb[Dg.a.reason]=Ne.a.saveAs;Od.AFrameworkApplication.vV().execute(function(xc){xc.Sj(Jf.a.Qta,Rb)})}else oa&&!Wa&&Od.AFrameworkApplication.Nka?ye.a.vf(L,ye.a.CX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):
ye.a.vf(L,ye.a.CX(3),void 0,"UploadToHostManager.RedirectToEditUrl")};ah.prototype.$na=function(L,oa,Wa){Wa=void 0===Wa?null:Wa;td.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.X8d&&!this.X8d()&&this.Tg&&(this.Ah&&(this.Iga=this.Ah.Hc("DialogShown","SaveAsToHostUploadTime")),this.fLb(),this.WWa=oa,this.bA=L,(this.Fh=Wa)&&"true"===this.Fh.SkipSaveToHost?this.C8b():this.OQ())};ah.prototype.OQ=function(){var L=this;32!==this.La.processAction(Vf.a.cRa,1)?(td.ULS.sendTraceTag(18989378,
219,15,"The save file change is not supported, this operation may exist data losting."),this.C8b()):this.La.Ce(Vf.a.cRa,2,[function(){td.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");L.C8b()},function(oa,Wa){td.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");L.wS(Wa)}])};ah.prototype.cVi=function(L){this.vIa();this.lDa=!1;if(L&&L.data&&L.data.ie){var oa=nh.d(L.data.ie);var Wa=oa.Ju;if(oa.returnValue)if(Wa.StatusCode!==
ih.a.kP&&Wa.StatusCode!==ih.a.orb)td.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),L={},L.FailureReason=Wa.StatusCode.toString(),L.ExtraInfo=Wa.ExtraInfo,this.vda(L),this.wS(parseInt(Wa.ExtraInfo));else{td.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.CKd();try{Wa.NewDocumentUrl&&""!==Wa.NewDocumentUrl?this.gQa(Wa.NewDocumentUrl):this.hQa()}catch(Rb){td.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",Rb.toString())}this.hFb()}else Wa=
{},td.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(Wa.ResponseData=dh.a.Eeb(L.data.ie),Wa)),L={},this.vda((L.FailureReason="Failed to deserialize response",L)),this.wS()}else td.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),L={},this.vda((L.FailureReason="null response",L)),this.wS()};ah.prototype.bVi=function(L){if(5!==L.data.status&&12!==L.data.status||this.lDa){var oa={};td.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(oa.Status=L.data.status,oa.HttpStatus=L.data.httpStatus,oa));oa={};this.vda((oa.FailureReason=L.data.httpStatus.toString(),oa));this.vIa();this.wS();this.hFb()}else td.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.lDa=!0,this.Fh&&"true"===this.Fh.SkipSaveToHost?this.C8b():this.OQ()};ah.prototype.vIa=function(){this.vm&&(this.vm.close(),this.vm=null)};ah.prototype.hFb=function(){this.Iga&&(this.Iga.stop(),this.Iga=null)};ah.prototype.CKd=function(){this.Fh&&
"VersionHistory"===this.Fh.SaveEntryPoint&&this.La.processAction(Vf.a.rtc,2)};ah.prototype.vda=function(L){this.Fh&&"VersionHistory"===this.Fh.SaveEntryPoint&&this.La.Ce(Vf.a.EKd,2,L)};ah.prototype.C8b=function(){var L=this.iFa+this.Hfa;L=eg.a.il(L,"qs",Uf.a.pf(Od.AFrameworkApplication.mj));L=eg.a.il(L,"n",Uf.a.pf((new Date).getTime().toString()));L=eg.a.il(L,"ov",Uf.a.pf(this.WWa.toString()));L=eg.a.il(L,"fn",Uf.a.pf(this.bA));this.Fh&&this.Fh.FileDownloadUrl&&(L=eg.a.il(L,"furl",Uf.a.pf(this.Fh.FileDownloadUrl)));
this.Tg.Xl(L,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(qf.a)(this,this.cVi,"onUploadFinished"),Object(qf.a)(this,this.bVi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(ve.a)(ah,"UploadToHostManager",null,[729]);var Mh=b(909);vg.prototype.init=function(){Od.AFrameworkApplication.ga.ow(Object(qf.a)(this,this.lB,"onFullAppSettingsReady"))};vg.prototype.lB=function(){Od.AFrameworkApplication.ga.ra("SaveAsToHostBrsIsEnabled")&&this.tb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Qg()};
vg.prototype.ji=function(L){this.tb=L;this.tb.register(ud,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Lc(function(){return new ud(Od.AFrameworkApplication.ga,Od.AFrameworkApplication.Gb)}).Bc();this.tb.register(ah,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Lc(function(){return new ah(Od.AFrameworkApplication.Gb,Od.AFrameworkApplication.ga,Od.AFrameworkApplication.Jd,function(){return Od.AFrameworkApplication.Ig},
function(){return(new Mh.a).create()},L.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),Od.AFrameworkApplication.sa,Od.AFrameworkApplication.sa.xD)}).Bc();this.tb.register(Pf,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Lc(function(){return new Pf(Od.AFrameworkApplication.ga,Od.AFrameworkApplication.Gb,Od.AFrameworkApplication.sa,Od.AFrameworkApplication.sa.Qa,L.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),L.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Bc();
this.tb.register(Ph,"Common.App.SaveAsToHost.SaveAsToHostActor").Lc(function(){return new Ph(Od.AFrameworkApplication.ga,L.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),L.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).Bc()};vg.prototype.dispose=function(){};vg.main=function(){jg.a.instance.sj(new vg)};Sk.Object.defineProperties(vg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(ve.a)(vg,"SaveAsToHostPackage",null,[4,5]);
var pi=Lg.StandardDialog;vm(He,pi);He.prototype.displayError=function(L,oa){this.$Ie(L,oa,Kg.a.Pkj)};He.prototype.$Ie=function(L,oa,Wa){td.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Wa);this.Jz(Wa,L,oa,null)};He.prototype.$6c=function(L,oa){td.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.Jz(Kg.a.Rkj,L,oa,null,!0)};Object(ve.a)(He,"ErrorDialog",Lg.StandardDialog,[740]);Sk.Object.defineProperties($e,{eg:{configurable:!0,
enumerable:!0,get:function(){return wh.a.Cn($e.Vj,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});$e.Vj="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(ve.a)($e,"FileNameDialogHtml",null,[]);var mg=b(12),si=b(91),Wh=b(89);vm(Bf,Lc);Bf.prototype.GQ=function(L){var oa=Uf.a.lr(Od.AFrameworkApplication.dm.zn),Wa=Od.AFrameworkApplication.breadcrumbFolderName,Rb=Od.AFrameworkApplication.breadcrumbBrandName,xc={};xc=(xc.txtFileName=L||oa,xc);var id=CommonUIStrings.L_SaveAs;2===Od.AFrameworkApplication.sa.Qa.Pj&&(id=CommonUIStrings.L_SaveACopy);this.initializeAndShow(id,Object(qf.a)(this,this.l9b,"fileNameDialogHandler"),xc);this.FIe(L,oa);this.mIa.style.width=
"450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");Od.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost")||(this.Gy=document.getElementById("anotherFolder"),L=document.getElementById("folderLocation"),this.kQc=Wh.a.Vqe(L,this.Gy,"anotherFolderDescribedBy"),this.Gy.className="WACButton WACDialogButtonNormal",L=!1,Wa&&Wa.length?(this.Jle(this.Gy,this.kQc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Rb,Wa)),
L=this.zAg(Rb,Wa)):this.Jle(this.Gy,this.kQc,CommonUIStrings.l_CurrentOnlineFolder),this.wBg(this.Gy),this.BAg(this.Gy),L?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Gy,"SaveToAnotherLocationTwo"),td.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Gy,"SaveToAnotherLocationOne"),ch.a.addHandler(this.Gy,mg.a.click,Object(qf.a)(this,this.BBd,"onSaveToAnotherLocationClick")),
ch.a.addHandler(this.Gy,mg.a.Sb,Object(qf.a)(this,this.UCf,"onSaveToAnotherLocationKeyDown")))};Bf.prototype.zAg=function(L,oa){var Wa=!1;var Rb=document.getElementById("currentLocation");Rb.innerText="";var xc=this.f1e(Rb,L),id=this.f1e(Rb,oa),rd=255,$d=255;255<xc+id&&(rd=Math.max(238,408-xc),$d=Math.max(170,408-id),Wa=!0);this.TCg(Rb,L,$d,oa,rd);return Wa};Bf.prototype.f1e=function(L,oa){var Wa=document.createElement("div");Wa.innerText=oa;Wa.style.visibility="hidden";L.appendChild(Wa);oa=Wa.clientWidth;
L.removeChild(Wa);return oa};Bf.prototype.TCg=function(L,oa,Wa,Rb,xc){oa&&(this.Hle(L,oa,Wa),this.MCg(L));Rb&&this.Hle(L,Rb,xc)};Bf.prototype.Hle=function(L,oa,Wa){var Rb=document.createElement("div");Rb.innerText=oa;Rb.title=oa;Rb.className="SaveToAnotherFolderBreadcrumb";Rb.style.maxWidth=Wa.toString()+"px";L.appendChild(Rb)};Bf.prototype.MCg=function(L){var oa=document.createElement("span");oa.id="FolderSeparator";var Wa=document.createElementNS("http://www.w3.org/2000/svg","svg");Wa.setAttribute("class",
"SeparatorCaret");var Rb=document.createElementNS("http://www.w3.org/2000/svg","polygon");Rb.setAttribute("points","1 4 1 11 5 7.5");Wa.appendChild(Rb);oa.appendChild(Wa);L.appendChild(oa)};Bf.prototype.Jle=function(L,oa,Wa){Wa=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Wa);oa&&(oa.innerText=Wa);L.tabIndex=0;L.setAttribute(Wh.a.Td,Wh.a.Qr)};Bf.prototype.BAg=function(L){var oa=document.createElement("span");oa.id="anotherFolderText";oa.innerText=this.MSg;oa.className="AnotherFolderTextSpan";
L.appendChild(oa)};Bf.prototype.wBg=function(L){var oa=document.createElement("span");oa.className="cui-img-cont-float cui-img-16by16 ";this.hqa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.hqa.setAttribute("class","FolderIconSVG");var Wa=document.createElementNS("http://www.w3.org/2000/svg","path");Wa.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.hqa.appendChild(Wa);oa.appendChild(this.hqa);
L.appendChild(oa)};Bf.prototype.UCf=function(L){!L||L.keyCode!==si.a.$h&&L.keyCode!==si.a.j1||this.BBd(L)};Bf.prototype.BBd=function(){if(this.iJ){var L=Uf.a.v4(Od.AFrameworkApplication.fileName),oa=this.iJ.value;this.hide();oa&&""!==oa&&""!==L||1===this.sa.state?(""!==L&&(oa+=L),this.m9b(oa)?this.Es.create().displayError(1,oa,!1):this.rlb.start(oa,this.xtg)):this.Es.create().displayError(2,oa,!1)}};Bf.prototype.wWg=function(L){this.Gy&&this.hqa&&(L?(this.Gy.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Gy,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.hqa,"DisabledFolderIconSVG")):(this.Gy.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Gy,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.hqa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Gy,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.hqa,"DisabledFolderIconSVG"))))};Bf.prototype.Rid=function(){Lc.prototype.Rid.call(this);this.wWg(!!this.iJ&&""!==this.iJ.value)};Bf.prototype.dispose=function(){this.Gy&&
(ch.a.removeHandler(this.Gy,mg.a.click,Object(qf.a)(this,this.BBd,"onSaveToAnotherLocationClick")),ch.a.removeHandler(this.Gy,mg.a.Sb,Object(qf.a)(this,this.UCf,"onSaveToAnotherLocationKeyDown")),this.Gy=null);Lc.prototype.dispose.call(this)};Object(ve.a)(Bf,"FileNameDialog",Lc,[776]);var qg=b(805),Ca=b(574),ua=b(184),sb=b(1040),Ld=b(129);Object(ve.a)(bf,"SaveAsDialogInput",null,[]);Object(ve.a)(pg,"SaveLocation",null,[]);var le=b(338);vf.prototype.NNh=function(){var L=new qg.a(Ca.a.Hk());L.ia("type",
"currentHost");return Object.assign(new pg,{folderName:this.Bv.breadcrumbFolderName,friendlyPath:this.Bv.breadcrumbBrandName,properties:L})};vf.prototype.zni=function(L){return!!L&&"ClassicMru"===L.type&&!!L.service_info&&!!L.service_info.service_id&&-1!==L.service_info.service_id.indexOf("SHAREPOINT")};vf.prototype.XYh=function(){if(!this.tMc||!this.cFa)return null;var L=this.tMc.value.hz("SaveAsToSharePointDialog",!1);if(!L||3!==L.state||!L.Arf)return null;L=L.Arf;for(var oa=new ua.a,Wa=0,Rb=0,
xc=0;xc<L.length;xc++){var id=L[xc];if(this.zni(id)&&(Wa++,id.sharepoint_info)){var rd=id.url,$d=id.sharepoint_info.site_url,Be=id.title;id=sb.b(id,Od.AFrameworkApplication.isRtl);if(rd&&$d&&Be&&id){Rb++;var gg=new qg.a(Ca.a.Hk());gg.ia("type","SharePoint");gg.ia("siteUrl",$d);gg.ia("folderUrl",rd);Rb++;oa.add(Object.assign(new pg,{folderName:Be,friendlyPath:id,properties:gg}))}}}xc=new Map;xc.set("NumPlaces",L.length.toString());xc.set("NumSharepointPlaces",Wa.toString());xc.set("placesWithMetadata",
Rb.toString());gh.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",0,"smartfio",xc);0<Wa&&(Rb?.5>1*Rb/Wa&&gh.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):gh.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return oa};vf.prototype.FOh=function(){var L=new ua.a;L.add(this.NNh());var oa=this.XYh();oa&&L.addRange(oa);return Object.assign(new bf,{enableMoreLocations:!Od.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost"),
fileName:this.bA,extension:Uf.a.v4(this.Bv.zn),saveLocations:L.toArray(),scenario:"SaveToSharePoint"})};vf.prototype.COh=function(){return{inputPropsCallback:Object(qf.a)(this,this.FOh,"getDialogInput")}};vf.prototype.GQ=function(L){this.bA=L;this.bA||(this.bA=String.format(CommonUIStrings.l_SaveACopy_Filename,Uf.a.lr(this.Bv.zn)));L={};L=(L.id="SaveAsDialog",L.bodyControls=this.COh(),L);var oa=CommonUIStrings.L_SaveAs;2===this.gf.Qa.Pj&&(oa=CommonUIStrings.L_SaveACopy);var Wa=new wh.a(!1,!1,!0);
Wa.jc=1;Wa.Ue="SaveAsDialog";Wa.Fc(1,CommonUIStrings.l_SaveButtonLabel);Wa.initializeAndShow(oa,Object(qf.a)(this,this.Lkj,"saveAsDialogHandler"),L)};vf.prototype.XBj=function(L,oa){L&&""!==L&&""!==oa||1===this.gf.state?this.yni()?this.Nti(L,oa):(""!==oa&&(L+=oa),this.rlb.start(L,this.Fh)):(td.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.Es.create().displayError(2,L,!1))};vf.prototype.Nti=function(L,oa){var Wa=this;gh.Health.instance.recordKpiUsage("SaveACopySFP",
0,"smartfio",null);var Rb=this.DXa.iEe(CommonUIStrings.l_PickerSaveACopyOkButton,CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.DXa.Jed(Rb).then(function(xc){if(xc&&0<xc.length){var id=xc[0][Dg.a.tZi];xc=xc[0][Dg.a.HHf];if(""!==id&&""!==xc)Wa.cFa.$na(xc,L+oa,id,Wa.Fh),gh.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{Wa.Es.create().displayError(0,L,!1);var rd=Ld.a.Wr();rd&&(rd.set("SiteUrlAvailable",""===id?"false":"true"),rd.set("FolderUrlAvailable",""===xc?"false":
"true"));gh.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",!1,!1,Object.assign(new le.a,{extendedProperties:rd}))}}else Wa.Es.create().displayError(0,L,!1),gh.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(xc){"Canceled"===xc?((xc=Ld.a.Wr())&&xc.set("IsCanceled","true"),gh.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new le.a,{extendedProperties:xc}))):gh.Health.instance.recordKpiFailure("SaveACopySFP",
xc,!1,!1,null)})};vf.prototype.yni=function(){return this.DXa?this.DXa.Kqd()&&(Od.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",!1)||"SharePointOnlineConsumer"===Od.AFrameworkApplication.ga.Ua("FileSource")):(td.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};vf.prototype.Lkj=function(L,oa){if(oa&&1===L){L=oa.fileName;var Wa=Uf.a.v4(this.Bv.zn);oa.moreLocationsSelected&&this.XBj(L,Wa);if(oa.locationCallback){var Rb=
oa.locationCallback();Rb?Rb.properties&&"currentHost"===Rb.properties.oa("type")?this.Jga.$na(L+Wa,!1,this.Fh):Rb.properties&&"SharePoint"===Rb.properties.oa("type")?(oa=Rb.properties.oa("siteUrl"),Rb=Rb.properties.oa("folderUrl"),this.cFa.$na(Rb,L+Wa,oa,this.Fh)):td.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):td.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else td.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(ve.a)(vf,"ReactSaveAsDialog",
null,[776]);wf.prototype.create=function(L){return this.gf&&this.gf.Qa.rw?new vf(this.gge,this.Es,this.Jga,Od.AFrameworkApplication.dm,this.gf,this.asg,this.cFa,this.DXa,L):new Bf(this.wb,this.La,this.gf,this.KX,this.Es,this.Jga,this.gge,L)};Object(ve.a)(wf,"FileNameDialogFactory",null,[739]);af.prototype.start=function(L){var oa=this;if(!this.HFf)if(Od.AFrameworkApplication.breadcrumbFolderUrl&&Od.AFrameworkApplication.breadcrumbFolderUrl.length)this.pkb=Od.AFrameworkApplication.breadcrumbFolderUrl;
else return td.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.Ho),!1;var Wa=this.Ttg();Wa.qCj();var Rb=Wa.IVh();if(!Rb)return td.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.lib.start(function(xc,id){Wa.hide();L(xc,id)},function(){oa.Dzd(Wa)},Rb,this.pkb);return!0};af.prototype.Dzd=function(L){L.hide();td.ULS.sendTraceTag(24664068,
216,50,"User cancelled save to another folder.")};af.prototype.cVh=function(L){L=L.toLowerCase();L.endsWith("/")||(L+="/");var oa=L.indexOf("/documents/");return-1!==oa?L.substring(0,oa+1)+"_layouts/15/onedrive.aspx":""};af.prototype.svb=function(L){this.Ho||3!==L.state||(this.Ho=L)};Sk.Object.defineProperties(af.prototype,{HFf:{configurable:!0,enumerable:!0,get:function(){this.pkb||(this.xDa.value.hz("Save As",!0),this.Ho&&this.Ho.cS&&this.Ho.cS.length&&(this.pkb=this.cVh(this.Ho.cS)));return this.pkb}}});
Object(ve.a)(af,"OneDriveFilePickerHelper",null,[738]);var nf=wh.a;vm(Nf,nf);Nf.prototype.qCj=function(){this.aHc="FilePickerDialog";this.eg="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this.Ue="PickerDialog-MsoSp";this.showDialog("",null)};Nf.prototype.IVh=function(){return document.getElementById("FilePickerDiv")};Nf.prototype.IO=function(){};Nf.prototype.VPa=function(){};Object(ve.a)(Nf,"PickerDialog",wh.a,[737]);var ug=b(973),Cf=b(23);ce.prototype.Qg=function(){var L=this,oa=this.lib.Y3a();
oa?Cf.a.cB||this.wb.ra("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.ef(Vf.a.saveToSharePoint,kh.a.frame,Object(qf.a)(this,this.oWf,"saveToSharePointActionDispatcher"),64):(oa.$7a.continueWith(function(Wa){Wa.kg&&L.lib.PAd(Wa)}),this.Y0b()):td.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};ce.prototype.Y0b=function(){ai.a.PHd(Object(qf.a)(this,this.oWf,"saveToSharePointActionDispatcher"));ai.a.A8c([new ug.a(Vf.a.saveToSharePoint,kh.a.frame,
0)],this.lib.Y3a())};ce.prototype.oWf=function(L,oa,Wa,Rb,xc){return oa.contextId!==kh.a.frame||L!==Vf.a.saveToSharePoint?2:this.l7a&&(this.cOc.HFf||this.Owe)?1===Wa?Ah.SessionStatusManager.instance.ywb||Od.AFrameworkApplication.q5?8:this.rmg()?32:8:2===Wa?(td.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(xc&&xc.SaveEntryPoint&&"VersionHistory"===xc.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Owe?(td.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),
this.kIc.create(xc).GQ(null)):(td.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.rlb.start(null,xc)),32):8:8};Sk.Object.defineProperties(ce.prototype,{l7a:{configurable:!0,enumerable:!0,get:function(){return this.wb.ra("SaveToAnotherFolderBrsIsEnabled")}},Owe:{configurable:!0,enumerable:!0,get:function(){return this.wb.ra("UserCanWriteRelative")}}});Object(ve.a)(ce,"SaveToSharePointActor",null,[]);Le.prototype.start=function(L,
oa){var Wa=this;td.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.cce=L;this.Fh=oa;this.cOc.start(function(Rb,xc){Wa.N2i(Rb,xc)})||this.ZRd()};Le.prototype.N2i=function(L,oa){if(L)this.onSuccess(oa);else this.r6(oa)};Le.prototype.ZRd=function(){1!==this.gf.state&&this.Es().$6c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};Le.prototype.onSuccess=function(L){td.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");
if(L&&L.data&&L.data.value&&L.data.value.length&&L.data.value[0].sharePoint){var oa=L.data.value[0].sharePoint.url;L=L.data.value[0].sharePoint.listUrl;var Wa=null;if(oa&&(Wa=L?this.sZh(L):this.rZh(oa))){this.cFa.$na(oa,this.cce,Wa,this.Fh);return}td.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!oa,!Wa)}td.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.ZRd()};Le.prototype.rZh=function(L){L.endsWith("/")||
(L+="/");for(var oa=0,Wa=0;Wa<L.length;Wa++)if("/"===L.charAt(Wa)&&5===++oa)return L.substr(0,Wa);return null};Le.prototype.sZh=function(L){L.endsWith("/")&&(L=L.substring(0,L.length-1));var oa=L.lastIndexOf("/");return-1!==oa?L.substring(0,oa):null};Le.prototype.r6=function(L){td.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");L&&L.error?td.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",L.error.errorCode,L.error.message):td.ULS.sendTraceTag(23881890,
216,10,"File Dialog returned empty error.");this.ZRd()};Object(ve.a)(Le,"SaveToSharePointManager",null,[736]);Ud.prototype.execute=function(L,oa){if(!Od.AFrameworkApplication.Ig&&Od.AFrameworkApplication.Jd){var Wa=this.iFa+this.Hfa;Wa=eg.a.il(Wa,"fu",Uf.a.pf(this.N8));Wa=eg.a.il(Wa,"su",Uf.a.pf(this.Gwg));Wa=eg.a.il(Wa,"fn",Uf.a.pf(this.bA));Wa=eg.a.il(Wa,"n",Uf.a.pf((new Date).getTime().toString()));this.Fh&&this.Fh.FileDownloadUrl&&(Wa=eg.a.il(Wa,"furl",Uf.a.pf(this.Fh.FileDownloadUrl)));Wa=Wa+
"&"+this.fPc;this.LVa&&this.LVa.length?Wa=eg.a.il(Wa,"fnn",Uf.a.pf(this.LVa)):td.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");td.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");Od.AFrameworkApplication.Jd.Xl(Wa,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,L,oa,null,void 0,void 0,void 0,void 0,"9")}};Object(ve.a)(Ud,"SharePointSaveAsCaller",null,[773]);dd.prototype.create=function(L,oa,Wa,Rb){return new Ud(this.jFa,this.bA,L,
oa,Wa,Od.AFrameworkApplication.mj,this.Hfa,Rb)};Object(ve.a)(dd,"SharePointUploadCallerFactory",null,[734]);var Cg=b(807);Kc.prototype.$na=function(L,oa,Wa,Rb){this.FEc=!1;td.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.fLb();this.N8=L;Rb&&Rb.SaveEntryPoint&&(this.gQc=Rb.SaveEntryPoint);this.ECa=this.BSc.create(L,oa,Wa,Rb);Rb&&"true"===Rb.SkipSaveToHost?this.OQ():this.gFh()};Kc.prototype.gFh=function(){function L(){td.ULS.sendTraceTag(23881923,
216,15,"The file change is not saved successfully, this operation may lead to data loss.");oa.OQ()}var oa=this;32!==this.La.Ce(Vf.a.cRa,2,[function(){td.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");oa.OQ()},L])&&L()};Kc.prototype.OQ=function(){td.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.ECa.execute(Object(qf.a)(this,this.rSi,"onSaveToSharePointUploadFinished"),Object(qf.a)(this,this.qSi,"onSaveToSharePointUploadFailed"))};
Kc.prototype.rSi=function(L){if(L&&L.data&&L.data.ie){var oa=nh.d(L.data.ie);var Wa=oa.Ju;if(oa.returnValue)if(Wa.StatusCode!==ih.a.kP&&Wa.StatusCode!==ih.a.orb)td.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",L.data.status,Wa.StatusCode),Wa.StatusCode!==ih.a.iTf&&this.zJe(L.data.status)||(this.vda(Wa.StatusCode.toString()),this.YAj(Wa.StatusCode));else{td.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");
this.CKd();try{Wa.NewDocumentUrl?this.gQa(Wa.NewDocumentUrl):this.hQa()}catch(Rb){td.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",Rb.toString())}}else Wa={},td.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(Wa.ResponseData=dh.a.Eeb(L.data.ie),Wa)),this.I6b()||(this.vda("Failed to deserialize response"),this.dLb())}else td.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.I6b()||(this.vda("Unknown"),this.dLb())};Kc.prototype.qSi=
function(L){L&&L.data?this.zJe(L.data.status)||(td.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.vda(Cg.a[L.data.status]),this.dLb()):(td.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.I6b()||(this.vda("Unknown"),this.dLb()))};Kc.prototype.I6b=function(){if(!this.FEc)return td.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.FEc=!0,this.OQ(),!0;td.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};
Kc.prototype.zJe=function(L){td.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",L);return this.I6b()};Kc.prototype.hQa=function(){td.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");ye.a.vf(this.N8,ye.a.CX(3),void 0,"UploadToSharePointManager.RedirectToFolder")};Kc.prototype.gQa=function(L){var oa=!1,Wa=!1;Od.AFrameworkApplication.ga&&(oa=Od.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Wa=Od.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));td.ULS.sendTraceTag(23881934,
216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",L,oa);if(oa&&Wa){td.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Rb={};Rb[Dg.a.bQa]="1";Rb[Dg.a.documentUrl]=L;Rb[Dg.a.reason]=Ne.a.saveAs;Od.AFrameworkApplication.vV().execute(function(xc){xc.Sj(Jf.a.Qta,Rb)})}else ye.a.vf(L,ye.a.CX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};Kc.prototype.fLb=function(){this.gf&&1===this.gf.state||(this.vm=this.Rkb(),
this.vm.message=CommonUIStrings.l_CommentProgressTooltip,this.vm.jc=5,this.vm.Su=!1,this.vm.MAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};Kc.prototype.vIa=function(){this.vm&&(this.vm.close(),this.vm=null)};Kc.prototype.dLb=function(){this.vi(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile)};Kc.prototype.aCj=function(){this.vi(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};Kc.prototype.dBj=function(){var L=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,
250);this.vi(CommonUIStrings.l_SaveAsFileTooLargeTitle,L,Kg.a.Mkj)};Kc.prototype.vi=function(L,oa,Wa){Wa=void 0===Wa?Kg.a.Qkj:Wa;td.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",L,oa);this.vIa();1!==this.gf.state&&this.Es().$Ie(L,oa,Wa)};Kc.prototype.YAj=function(L){td.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",L);switch(L){case ih.a.Kbg:this.aCj();break;case ih.a.iTf:this.dBj();break;default:this.dLb()}};Kc.prototype.CKd=function(){"VersionHistory"===
this.gQc&&this.La.processAction(Vf.a.rtc,2)};Kc.prototype.vda=function(L){if("VersionHistory"===this.gQc){var oa={};this.La.Ce(Vf.a.EKd,2,(oa.FailureReason=L,oa))}};Object(ve.a)(Kc,"UploadToSharePointManager",null,[728]);ac.prototype.init=function(){};ac.prototype.dispose=function(){};ac.prototype.ji=function(L){var oa=this;this.tb=L;this.QTb=xh.a.Tq(L.oc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.STb=xh.a.Tq(L.oc("Common.IEventEmitter<Common.IMruResult>"));Od.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",
!1)||"SharePointOnlineConsumer"===Od.AFrameworkApplication.ga.Ua("FileSource")?(this.vga=xh.a.Tq(L.oc("Common.App.SharedFilePicker.ISharedFilePicker")),Xg.Task.WAA.call(null,this.QTb,this.STb,this.vga).continueWith(function(){oa.AOf()})):(this.vga=null,Xg.Task.WAA.call(null,this.QTb,this.STb).continueWith(function(){oa.AOf()}))};ac.prototype.AOf=function(){var L=this;this.tb.register(dd,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Lc(function(){return new dd(Od.AFrameworkApplication.ga)}).Bc();
this.tb.register(Kc,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Lc(function(){return new Kc(Od.AFrameworkApplication.Gb,L.tb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),function(){return(new Mh.a).create()},function(){return new He},Od.AFrameworkApplication.sa)}).Bc();this.tb.register(Le,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Lc(function(){return new Le(L.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
function(){return new He},L.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),Od.AFrameworkApplication.sa)}).Bc();this.tb.register(af,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Lc(function(){return new af(L.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new Kf.a(function(){return L.QTb.result}),Od.AFrameworkApplication.sa,function(){return new Nf})}).Bc();this.tb.register(wf,
"Common.App.SaveToSharePoint.FileNameDialogFactory").Lc(function(){return new wf(Od.AFrameworkApplication.ga,Od.AFrameworkApplication.Gb,Od.AFrameworkApplication.sa,Od.AFrameworkApplication.sa.Qa,L.tb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),L.tb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),L.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new Kf.a(function(){return L.STb.result}),L.tb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),
L.vga?L.vga.result:null)}).Bc();this.tb.register(ce,"Common.App.SaveToSharePoint.SaveToSharePointActor").Lc(function(){return new ce(Od.AFrameworkApplication.ga,Od.AFrameworkApplication.Gb,L.tb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),L.tb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),L.tb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),L.tb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return Od.AFrameworkApplication.sa.NUg})}).Bc();
Od.AFrameworkApplication.ga.ra("SaveToAnotherFolderBrsIsEnabled")&&this.tb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Qg()};ac.main=function(){jg.a.instance.sj(new ac)};Sk.Object.defineProperties(ac.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(ve.a)(ac,"PackageManager",null,[4,5]);var Ag=Lg.StandardDialog;vm(qe,Ag);qe.prototype.displayError=function(L){this.Jz(L,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,
null)};Object(ve.a)(qe,"ErrorDialog",Lg.StandardDialog,[726]);Md.default=0;Object(ve.a)(Md,"SaveToCloudErrorCodes",null,[]);yd.prototype.start=function(L){this.Fh=L;if("SharePointOnlineConsumer"===this.wb.Ua("FileSource")){var oa=Qh.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(oa){oa.start(null,L);return}}this.f2.ULa?(td.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.jUg()):(td.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),
this.showSignInDialog())};yd.prototype.showSignInDialog=function(){this.zwg.create().GQ()};yd.prototype.vi=function(){this.Es().displayError(Md.default)};yd.prototype.jUg=function(){try{td.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");var L={},oa=(L.client_id=this.wb.appSettings.UploadToSkyDriveClientId,L.env="INT",L);if(1===this.VPb||2===this.VPb)L={},oa=(L.client_id=this.wb.appSettings.UploadToSkyDriveClientId,L);L={};var Wa=(L.mode="save",L.lightbox="grey",L);WL.init(oa);td.ULS.sendTraceTag(6590562,
216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(Wa).then(Object(qf.a)(this,this.onSuccess,"onSuccess"),Object(qf.a)(this,this.r6,"onFailure"))}catch(Rb){td.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Rb,Rb.stack),this.vi()}};yd.prototype.onSuccess=function(L){td.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");L&&L.data&&L.data.folders&&this.kmb.$na(L.data.folders[0].id,L.data.folders[0].urls.viewInBrowser,
null,this.Fh)};yd.prototype.r6=function(L){if(L&&L.error){if("user_canceled"===L.error.code){td.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}td.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",L.error.code,L.error.message)}else td.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.vi()};Object(ve.a)(yd,"SaveToCloudManager",null,[744]);Vc.prototype.l7a=function(){return this.wb.ra("SaveToCloudStorageUIIsEnabled")};
Vc.prototype.qXe=function(){return Vf.a.saveToCloudStorage};Vc.prototype.Y0b=function(){ai.a.PHd(Object(qf.a)(this,this.mWf,"saveToCloudActionDispatcher"));ai.a.A8c([new ug.a(Vf.a.saveToCloudStorage,kh.a.frame,0)],this.ade.Y3a())};Vc.prototype.Qg=function(){var L=this,oa=this.ade.Y3a();oa?(oa.N9(function(){L.Cae.setResult(!0)}),this.Y0b()):td.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};Vc.prototype.MNf=function(){td.ULS.sendTraceTag(6590597,
216,50,"User clicked on SaveToOneDrive button")};Vc.prototype.mWf=function(L,oa,Wa,Rb,xc){var id=this;return oa.contextId!==kh.a.frame||L!==this.qXe()?2:this.l7a()?1===Wa?Ah.SessionStatusManager.instance.ywb||Od.AFrameworkApplication.q5?8:32:2===Wa?(this.MNf(),xc&&xc.FileDownloadUrl&&td.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.Ah&&(this.nVb=this.Ah.Hc("DialogShown","SaveToOneDriveReponseTime")),this.Cae.task.continueWith(function(){id.nVb&&(id.nVb.stop(),
id.nVb=null);id.Dvg.start(xc)}),32):8:8};Object(ve.a)(Vc,"SaveToCloudStorageActor",null,[743]);var eh=b(277),jh=Lg.StandardDialog;vm(uc,jh);uc.prototype.GQ=function(){this.f2.DYa(Object(qf.a)(this,this.VDf,"onSignIn"));this.Jk(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(qf.a)(this,this.Sci,"inputHandler"))};uc.prototype.Sci=function(L){0===L?(td.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide()):this.D6()};uc.prototype.VWg=
function(){var L="2";if(this.KX)switch(this.KX.Pj){case 3:L="0";break;case 2:L="3";break;case 1:L="1"}return L};uc.prototype.hide=function(){this.f2.aHb(Object(qf.a)(this,this.VDf,"onSignIn"));jh.prototype.hide.call(this)};uc.prototype.D6=function(){var L=new eh.QueryStringBuilder("Signin.aspx");L.Hi("prompt","1");L.Hi("cbcxt",this.VWg());Od.AFrameworkApplication.Umb(L);ye.a.vf(L.toString(),"LoginWindow",void 0,"SignInDialog")};uc.prototype.VDf=function(){this.Eq&&this.hide();td.ULS.sendTraceTag(7143885,
216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.La.processAction(Vf.a.saveToCloudStorage,2)};Object(ve.a)(uc,"SignInDialog",Lg.StandardDialog,[781]);Db.prototype.create=function(){return new uc(this.La,this.f2,this.KX)};Object(ve.a)(Db,"SignInDialogFactory",null,[742]);La.prototype.execute=function(L,oa){if(!Od.AFrameworkApplication.Ig&&Od.AFrameworkApplication.Jd){var Wa=this.iFa+this.Hfa;Wa=eg.a.il(Wa,"fo",Uf.a.pf(this.cSb));Wa=eg.a.il(Wa,"fn",Uf.a.pf(this.bA));
Wa=eg.a.il(Wa,"qs",Uf.a.pf(this.fPc));Wa=eg.a.il(Wa,"n",Uf.a.pf((new Date).getTime().toString()));this.Fh&&this.Fh.FileDownloadUrl&&(Wa=eg.a.il(Wa,"furl",Uf.a.pf(this.Fh.FileDownloadUrl)));this.LVa&&(Wa=eg.a.il(Wa,"fnn",Uf.a.pf(this.LVa)));Od.AFrameworkApplication.Jd.Xl(Wa,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,L,oa,null)}};Object(ve.a)(La,"SkyDriveUploadCaller",null,[780]);qh.prototype.create=function(L,oa,Wa){return new La(this.jFa,this.bA,oa,L,Od.AFrameworkApplication.mj,
this.Hfa,Wa)};Object(ve.a)(qh,"SkydriveUploadCallerFactory",null,[741]);kg.prototype.fLb=function(){this.gf&&1===this.gf.state||(this.vm=this.Rkb(),this.vm.message=CommonUIStrings.l_CommentProgressTooltip,this.vm.jc=5,this.vm.Su=!1,this.vm.MAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};kg.prototype.vIa=function(){this.vm&&(this.vm.close(),this.vm=null)};kg.prototype.wS=function(){1!==Od.AFrameworkApplication.sa.state&&this.Es().displayError(Md.default)};kg.prototype.hQa=function(){td.ULS.sendTraceTag(6590599,
216,50,"Redirecting to OneDrive Folder.");ye.a.vf(this.N8,ye.a.CX(3),void 0,"UploadToCloudManager.RedirectToFolder")};kg.prototype.gQa=function(L){var oa=!1,Wa=!1;Od.AFrameworkApplication.ga&&(oa=Od.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Wa=Od.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));td.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",L,oa);if(oa&&Wa){td.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");
var Rb={};Rb[Dg.a.bQa]="1";Rb[Dg.a.documentUrl]=L;Od.AFrameworkApplication.vV().execute(function(xc){xc.Sj(Jf.a.Qta,Rb)})}else ye.a.vf(L,ye.a.CX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};kg.prototype.$na=function(L,oa,Wa,Rb){Wa=void 0===Wa?null:Wa;Rb=void 0===Rb?null:Rb;td.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.Ah&&(this.Iga=this.Ah.Hc("DialogShown","SaveToOneDriveUploadTime"));this.fLb();this.N8=oa;this.ECa=this.BSc.create(L,Wa,Rb);this.Fh=Rb;this.OQ()};kg.prototype.OQ=
function(){td.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.ECa.execute(Object(qf.a)(this,this.pSi,"onSaveToCloudUploadFinished"),Object(qf.a)(this,this.oSi,"onSaveToCloudUploadFailed"))};kg.prototype.pSi=function(L){this.vIa();this.lDa=!1;if(L&&L.data&&L.data.ie){var oa=nh.d(L.data.ie);var Wa=oa.Ju;if(oa.returnValue)if(Wa.StatusCode!==ih.a.kP&&Wa.StatusCode!==ih.a.orb)td.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.wS();
else{td.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Wa.NewDocumentUrl&&""!==Wa.NewDocumentUrl?this.gQa(Wa.NewDocumentUrl):this.hQa()}catch(Rb){td.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",Rb.toString())}this.hFb()}else Wa={},td.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",(Wa.ResponseData=dh.a.Eeb(L.data.ie),Wa)),this.wS()}else td.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),
this.wS()};kg.prototype.oSi=function(L){5!==L.data.status&&12!==L.data.status||this.lDa?(td.ULS.sendTraceTag(6590605,216,10,"UploadToCloudManager HTTP failure with code: {0}",L.data.status),this.vIa(),this.wS(),this.hFb()):(td.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.lDa=!0,this.OQ())};kg.prototype.hFb=function(){this.Iga&&(this.Iga.stop(),this.Iga=null)};Object(ve.a)(kg,"UploadToCloudManager",null,[730]);uf.prototype.init=function(){Od.AFrameworkApplication.ga.ra("SaveToCloudStorageUIIsEnabled")&&
this.tb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Qg()};uf.prototype.dispose=function(){};uf.prototype.ji=function(L){this.tb=L;this.tb.register(Db,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Lc(function(){return new Db(Od.AFrameworkApplication.Gb,Sg.a.instance,Od.AFrameworkApplication.sa.Qa)}).Bc();this.tb.register(qh,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Lc(function(){return new qh(Od.AFrameworkApplication.ga)}).Bc();
this.tb.register(Vc,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Lc(function(){return new Vc(L.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),L.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),Od.AFrameworkApplication.ga,Od.AFrameworkApplication.sa.xD)}).Bc();this.tb.register(kg,"Common.App.SaveToCloudStorage.UploadToCloudManager").Lc(function(){return new kg(L.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new Mh.a).create()},
function(){return new qe},Od.AFrameworkApplication.sa,Od.AFrameworkApplication.sa.xD)}).Bc();this.tb.register(yd,"Common.App.SaveToCloudStorage.SaveToCloudManager").Lc(function(){return new yd(L.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Sg.a.instance,L.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),Od.AFrameworkApplication.ga,Od.AFrameworkApplication.b2a,function(){return new qe})}).Bc()};uf.main=function(){jg.a.instance.sj(new uf)};Sk.Object.defineProperties(uf.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(ve.a)(uf,"PackageManager",null,[4,5]);Sk.Object.defineProperties(rg,{eg:{configurable:!0,enumerable:!0,get:function(){return wh.a.Cn(rg.Vj,CommonUIStrings.l_SaveACopyFileName)}}});rg.Vj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(ve.a)(rg,"FileNameDialogHtml",null,[]);var Pg=wh.a;vm(Xf,Pg);Xf.prototype.GQ=function(L,oa,Wa){this.cSb=L;this.N8=Wa;L={};oa=(L.txtFileName=Uf.a.lr(Od.AFrameworkApplication.dm.zn),L.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,oa),L);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(qf.a)(this,this.l9b,"fileNameDialogHandler"),oa);td.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};
Xf.prototype.l9b=function(L,oa){1!==L?td.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(L=oa.txtFileName.trim(),td.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),oa=Uf.a.v4(Od.AFrameworkApplication.fileName),L&&""!==L&&""!==oa&&(L+=oa),this.kmb.$na(this.cSb,this.N8,L,this.Fh))};Object(ve.a)(Xf,"FileNameDialog",wh.a,[766]);Yf.prototype.create=function(L){return new Xf(this.La,this.KX,this.kmb,L)};Object(ve.a)(Yf,"FileNameDialogFactory",
null,[727]);var te=Lg.StandardDialog;vm(Ze,te);Ze.prototype.displayError=function(L){td.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",L);this.Jz(L,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(qf.a)(this,this.JLd,"retryDialogHandler"))};Ze.prototype.JLd=function(L){1===L?(td.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(Vf.a.saveACopy,2)):td.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(ve.a)(Ze,"RetryDialog",Lg.StandardDialog,[726]);vm(Pd,Vc);Pd.prototype.l7a=function(){return this.wb.ra("SaveACopyBrsIsEnabled")};Pd.prototype.qXe=function(){return Vf.a.saveACopy};Pd.prototype.Y0b=function(){ai.a.PHd(Object(qf.a)(this,this.mWf,"saveToCloudActionDispatcher"));ai.a.A8c([new ug.a(Vf.a.saveACopy,kh.a.frame,0)],this.qtg.Y3a())};Pd.prototype.MNf=function(){td.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(ve.a)(Pd,"SaveACopyActor",Vc,
[]);vm(If,yd);If.prototype.onSuccess=function(L){L&&L.data&&L.data.folders?(td.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.Oog.create(this.Fh).GQ(L.data.folders[0].id,L.data.folders[0].name,L.data.folders[0].urls.viewInBrowser)):(td.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.vi())};If.prototype.r6=function(L){L&&L.error&&"user_canceled"===L.error.code&&td.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");
yd.prototype.r6.call(this,L)};If.prototype.vi=function(){td.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");yd.prototype.vi.call(this)};Object(ve.a)(If,"SaveACopyManager",yd,[]);vm(Yd,kg);Yd.prototype.uqd=function(){return!!this.Fh&&!!this.Fh.SaveEntryPoint&&"VersionHistory"===this.Fh.SaveEntryPoint.toString()};Yd.prototype.wS=function(){td.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");if(this.uqd()){var L={};this.La.Ce(Vf.a.EKd,2,(L.FailureReason="Unknown",
L))}kg.prototype.wS.call(this)};Yd.prototype.hQa=function(){td.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.uqd()&&this.La.processAction(Vf.a.rtc,2);kg.prototype.hQa.call(this)};Yd.prototype.gQa=function(L){td.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",L);this.uqd()&&this.La.processAction(Vf.a.rtc,2);kg.prototype.gQa.call(this,L)};Yd.prototype.OQ=function(){var L=this;this.Fh&&"true"===this.Fh.SkipSaveToHost?kg.prototype.OQ.call(this):
32!==this.La.processAction(Vf.a.cRa,1)?(td.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),kg.prototype.OQ.call(this)):this.La.Ce(Vf.a.cRa,2,[function(){td.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");kg.prototype.OQ.call(L)},function(){td.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");L.wS()}])};Object(ve.a)(Yd,"SaveACopyUploadToCloudManager",
kg,[]);ig.prototype.init=function(){Od.AFrameworkApplication.ga.ow(Object(qf.a)(this,this.lB,"onFullAppSettingsReady"))};ig.prototype.lB=function(){Od.AFrameworkApplication.ga.ra("SaveACopyBrsIsEnabled")&&this.tb.resolve("Common.App.SaveACopy.SaveACopyActor").Qg()};ig.prototype.dispose=function(){};ig.prototype.ji=function(L){this.tb=L;this.tb.register(Yd,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Lc(function(){return new Yd(Od.AFrameworkApplication.Gb,L.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
function(){return(new Mh.a).create()},function(){return new Ze(Od.AFrameworkApplication.Gb)},Od.AFrameworkApplication.sa,Od.AFrameworkApplication.sa.xD)}).Bc();this.tb.register(Yf,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Lc(function(){return new Yf(Od.AFrameworkApplication.Gb,Od.AFrameworkApplication.sa.Qa,L.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).Bc();this.tb.register(Pd,"Common.App.SaveACopy.SaveACopyActor").Lc(function(){return new Pd(L.resolve("Common.App.SaveACopy.SaveACopyManager"),
L.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),Od.AFrameworkApplication.ga,Od.AFrameworkApplication.sa.xD)}).Bc();this.tb.register(If,"Common.App.SaveACopy.SaveACopyManager").Lc(function(){return new If(L.resolve("Common.App.SaveACopy.FileNameDialogFactory"),L.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),Sg.a.instance,L.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),Od.AFrameworkApplication.ga,Od.AFrameworkApplication.b2a,function(){return new Ze(Od.AFrameworkApplication.Gb)})}).Bc()};
ig.main=function(){jg.a.instance.sj(new ig)};Sk.Object.defineProperties(ig.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(ve.a)(ig,"PackageManager",null,[4,5]);var Fg;(function(L){L[L.myFiles=0]="myFiles";L[L.recent=1]="recent";L[L.currentFolder=2]="currentFolder";L[L.yourPhone=3]="yourPhone"})(Fg||(Fg={}));Object(ve.b)("SharedFilePickerLandingLocation",Fg);bg.prototype.Y1a=function(L){this._initialized||(L.Zn(Jf.a.tNf),L.Kl(Jf.a.tNf,Object(qf.a)(this,
this.wRi,"onReceivedPickerResponse")),this._initialized=!0)};bg.prototype.Jed=function(L){var oa=this;return this.nLa=new Promise(function(Wa,Rb){var xc={};xc[Dg.a.sZi]=L;oa.fab=function(id,rd){""===rd?(td.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Wa(id)):("Canceled"===rd?td.ULS.sendTraceTag(572548164,306,50,rd):td.ULS.sendTraceTag(556901065,306,10,rd),Rb(rd))};oa.Akd.execute(function(id){oa.Y1a(id);id.Sj(Jf.a.wWi,xc)})})};bg.prototype.wRi=function(L){this.fab(L.Values[Dg.a.qnj],
void 0===L.Values[Dg.a.CDd]||null===L.Values[Dg.a.CDd]?"":L.Values[Dg.a.CDd])};bg.prototype.Kqd=function(){return Od.AFrameworkApplication.ga.ra("UiHostCommonFilePicker")};bg.prototype.iEe=function(L,oa,Wa,Rb,xc,id,rd){var $d=void 0===$d?null:$d;var Be={};Be[Dg.a.cnj]=L;Be[Dg.a.titleText]=oa;Be[Dg.a.hJg]=Wa;Be[Dg.a.iJg]=Rb;Be[Dg.a.jJg]=!1;Be[Dg.a.bgh]=!0;Be[Dg.a.ABh]=xc;Be[Dg.a.wZi]=id;Be[Dg.a.vZi]=Fg[rd];fi.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Be[Dg.a.xZi]="Dark");$d&&
(null!=$d.jWc&&(Be[Dg.a.jWc]=$d.jWc),null!=$d.rld&&(Be[Dg.a.rld]=$d.rld));return Be};Object(ve.a)(bg,"SharedFilePickerManager",null,[724]);je.prototype.ji=function(L){this.tb=L;L.register(bg,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").Bc().Lc(function(){return new bg(L.oc("Postmessage.IHostPostmessenger"))})};je.prototype.init=function(){var L=this;Od.AFrameworkApplication.ga.ow(function(){L.Fxb()})};je.prototype.Fxb=function(){this.tb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};
je.prototype.dispose=function(){};je.main=function(){jg.a.instance.sj(new je)};Sk.Object.defineProperties(je.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(ve.a)(je,"SharedFilePickerPackage",null,[4,5]);var og=b(1267),mh=b(974);ng.prototype.Ile=function(L){var oa=!1;L&&(L.y3c(),L.wSg&&(oa=!1));return oa};ng.prototype.k5g=function(){var L=Od.AFrameworkApplication.sa.Qa;L=new og.a(L.Pj,mh.a.lcc(),!1,1===L.nca);this.Ile(L)&&td.ULS.sendTraceTag(17571982,
306,50,"ChromeExtBannerDisplayed")};ng.prototype.y4b=function(L,oa,Wa,Rb,xc,id){L=new og.a(L,Wa,Rb,oa,xc,id);this.Ile(L)&&td.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};ng.prototype.lah=function(){var L=Od.AFrameworkApplication.sa.Qa,oa=Od.AFrameworkApplication.ga,Wa=L.Pj,Rb=1===L.nca;if(oa.ra(mh.a.s1h(Wa))){var xc=mh.a.lcc(),id=8<Cf.a.l5a;if(2!==Wa||2!==xc||!Rb){oa=oa.ra(mh.a.t1h(Wa));var rd=L.NVf(),$d=function(){return L.eC};oa&&!mh.a.jpd(mh.a.Bdd(Wa))&&this.y4b(Wa,Rb,xc,id,$d,rd)}}};
ng.prototype.init=function(){var L=Od.AFrameworkApplication.ga,oa=L.ra("WildFireChromeExtensionEnabled");L=L.ra("WildFireChromeExtensionBar")&&oa;mh.a.mxc&&L&&!mh.a.jpd(mh.a.Pye)?this.k5g():(document.body&&mh.a.Czj&&this.lah(),Od.AFrameworkApplication.Gb.fc(Vf.a.ftd,kh.a.frame,Object(qf.a)(this,this.ftd,"launchWildFireBusinessBar")))};ng.prototype.ftd=function(L,oa,Wa,Rb,xc){if(1===Wa)return 32;if(!xc)return 8;this.y4b(xc.app,xc.mode,xc.platform,xc.useTwoButton,null,null);return 32};ng.prototype.dispose=
function(){};ng.prototype.ji=function(){};ng.main=function(){jg.a.instance.sj(new ng)};Sk.Object.defineProperties(ng.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(ve.a)(ng,"PackageManager",null,[4,5]);var cg=b(214),li=b(1251),fh=cg.a;vm(rf,fh);rf.prototype.create=function(){this.Fb(this.$.da.Aa(5)||new li.a(this.$,!this.$.hba))};rf.ja=function(L){L.da.Ha(4,new rf(L))};Object(ve.a)(rf,"BusinessBarManagerFactory",cg.a,[]);var pf=b(10),Qf;"undefined"==
typeof Qf&&(Qf={});window.MSOJS=Qf;Qf.ggb=function(){function L(){return rd()&&(Bj()||3<=(Dh()?Xj("version/"):0))}function oa(){return 0<=window.navigator.userAgent.indexOf("Windows")}function Wa(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function Rb(){ul||(ul=!0,vl=xc("Windows Phone"))}function xc(Hf){Hf=(new RegExp(Hf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var bh=-1;return null!=Hf&&2<=Hf.length&&(bh=parseFloat(Hf[1]),isNaN(bh)&&(bh=-1)),bh}function id(){return"function"==
typeof navigator.msLaunchUri&&!Wa()&&!wj()&&!$d()}function rd(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function $d(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function Be(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function gg(){return Be()?8==window.document.documentMode:!1}function Wg(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function Dh(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}
function ei(){return 0<=window.navigator.userAgent.toLowerCase().indexOf("chrome")}function wj(){var Hf=window.navigator.userAgent.toLowerCase();return 0<=Hf.indexOf("android")&&0<=Hf.indexOf("chrome")}function Bj(){return 3<=(Wg()?Xj("firefox/"):0)}function Xj(Hf){var bh=window.navigator.userAgent.toLowerCase(),$h=bh.indexOf(Hf),Gh,Gi;return 0<=$h?(Gh=$h+Hf.length,Gi=bh.length,parseInt(bh.substring(Gh,Gi))):0}function Fi(Hf,bh,$h,Gh,Gi){if(Gh&&null!=bh)bh();else if(id())navigator.msLaunchUri(Hf,
bh,$h);else if(!(ei()||0<=window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&rd())||$d())bk(Hf,bh,$h);else if(ei()&&Gi)a:{try{window.open(Hf,"_self")}catch(Vi){null!=$h&&$h();break a}null!=bh&&bh()}else oj(Hf,bh,$h)}function oj(Hf,bh,$h){var Gh=document.getElementById("OICLinkTag"),Gi;null==Gh&&(Gh=document.createElement("a"),Gh.id="OICLinkTag",Gh.style.visibility="hidden",Gh.href="",Gh.target=0==(Zi.Options&qk.SupportsTopTargetNavigation)||
Zi.NoBrowserModalDialogs?"_blank":"_top",document.body.appendChild(Gh),null!=Gh.addEventListener&&Gh.addEventListener("click",function(Vi){null!=Vi.stopPropagation&&Vi.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Gi=function(Vi){var Ni=document.createEvent("MouseEvent");return Ni.initMouseEvent(Vi,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),Ni},Gi.prototype=Event.prototype,window.MouseEvent=Gi),Gh.href=Hf,Gh.dispatchEvent(new MouseEvent("click"))}catch(Vi){null!=$h&&$h();return}null!=
bh&&bh()}function bk(Hf,bh,$h){var Gh=document.getElementById("OICFrame");null==Gh&&(Gh=document.createElement("iframe"),Gh.className="ObjectInDialog",Gh.style.visibility="hidden",Gh.src="about:blank",document.body.appendChild(Gh),Gh.id="OICFrame");try{Gh.contentWindow.location.href=Hf}catch(Gi){null!=$h&&$h();return}null!=bh&&bh()}function vk(Hf){return 0!=(Hf.Options&qk.SkipProtocolHandler)||gg()}function Qk(Hf){return Hf===$k.ReadOnly||Hf===$k.ReadWrite}function Lk(Hf,bh,$h,Gh){var Gi,Vi;try{if(Gi=
new ActiveXObject(d),Gi)return Vi=Gi.ViewDocument3(window.self,Hf,bh,Gh),Vi?(ek(Mk.O14ActiveX),ej.None):ej.Failed}catch(Ni){}if(qk.O14Only===($h&qk.O14Only))return Zi.DescriptiveUnattemptedEnums?ej.O14AttemptFailure:ej.Unattempted;try{if(Gi=new ActiveXObject(w),Gi)return Vi=Gi.ViewDocument3(window.self,Hf,bh,Gh),Vi?(ek(Mk.O12ActiveX),ej.None):ej.Failed}catch(Ni){}if(qk.O12UpOnly===($h&qk.O12UpOnly))return Zi.DescriptiveUnattemptedEnums?ej.O12UpOnlyFail:ej.Unattempted;try{if(Gi=new ActiveXObject(I),
Gi)return Vi=Qk(bh)?Gi.ViewDocument2(window.self,Hf,Gh):Gi.EditDocument2(window.self,Hf,Gh),Vi?(ek(Mk.O11ActiveX),ej.None):ej.Failed}catch(Ni){}return Zi.DescriptiveUnattemptedEnums?ej.ActiveXUnattempted:ej.Unattempted}function il(Hf,bh,$h,Gh,Gi){var Vi,Ni,Yj;Hf==xj.Visio&&$h==$k.ReadWrite&&($h=$k.WriteOnly);Hf=Gi;(Gh=Gh||Wa()&&!(Rb(),8<=vl))||(Vi="",Vi+=Qk($h)?Pe+Af:Wf,Vi+=Of,Hf+=Rk(Vi));Hf+=Rk(bh);Zi.NewTelemetryDataIsEnabled&&(Ni=-1!==Hf.indexOf("?")?"&":"?",Ni+=Zi.SessionOrigin?"OR=wac-"+Zi.SessionOrigin+
"&":"",Ni+=Zi.ClickTime?"CT="+Zi.ClickTime+"&":"",Ni+=Zi.CorrelationId?"CID="+Zi.CorrelationId:"",Ni="?"!=Ni?Ni:"",Ni="&"!=Ni.slice(-1)?Ni:Ni.slice(0,-1),Hf+=Rk(Ni));bh=window.location.href;$h=oi;Gh=bh.toLowerCase().indexOf("&"+$h+"=");var Dj;$h=-1==Gh?void 0:(Yj=Gh+($h.length+2),Dj=bh.indexOf("&",Yj),-1==Dj)?bh.substr(Yj):bh.substring(Yj,Dj);if(null!=$h&&"undefined"!=typeof $h){Yj="";try{Yj=decodeURIComponent($h)}catch(Nk){}0<Yj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Yj)&&
(Hf+=xg,Hf+=Yj)}return Hf}function jl(Hf,bh,$h,Gh,Gi,Vi){var Ni=ql(Hf),Yj;return null==Ni?(Hk(Zi.DescriptiveUnattemptedEnums?ej.ProtocolHandlerIsNull:ej.Unattempted,Zi.Application),!1):(Yj=il(Hf,bh,$h,Gh,Ni),Fi(Yj,ol,kl,Gi,Vi),!0)}function Rk(Hf){if(rd()&&ei()){var bh="";try{bh=decodeURI(Hf)}catch($h){}if(bh==Hf)return encodeURI(Hf)}return Hf}function ol(){ek(Mk.ProtocolHandler)}function kl(){Zi.Options|=qk.SkipProtocolHandler;rl(Zi,Cj,pj)}function pl(){null!=fk&&fk(Mk.RoamingProtocolHandler)}function sl(){null!=
Zk&&Zk(ej.ControlNeeded)}function ll(){var Hf=document.getElementById(pc),bh;if(null==Hf){if(bh=ha,rd()&&3<=(Dh()?Xj("version/"):0)&&wk(wa,!0)&&(bh=wa),!wk(bh,!0))if(rd()&&wk(Ic,!0))bh=Ic;else return null;Hf=document.createElement("object");Hf.id=pc;Hf.type=bh;Hf.style.width="0px";Hf.style.height="0px";Hf.style.setProperty("visibility","hidden","");document.body.appendChild(Hf);Hf=document.getElementById(pc)}return Hf}function wk(Hf,bh){var $h=window.navigator.mimeTypes,Gh;return null==$h?!1:(Gh=
$h[Hf],Gh)?bh&&!Gh.enabledPlugin?!1:!0:!1}function Xk(Hf){try{if(null!=new ActiveXObject(Hf))return!0}catch(bh){}return!1}function hl(Hf){switch(Hf){case xj.OneNote:return ne;default:return""}}function ql(Hf){if(Hf!=xj.OneNote&&Wa()&&!(Rb(),8<=vl))return"office:";switch(Hf){case xj.Excel:return"ms-excel:";case xj.OneNote:return"onenote:";case xj.PowerPoint:return"ms-powerpoint:";case xj.Visio:return"ms-visio:";case xj.Word:return"ms-word:";case xj.Project:return"ms-project:";case xj.Publisher:return"ms-publisher:";
case xj.Infopath:return"ms-infopath:";case xj.Access:return"ms-access:";default:return""}}function tl(Hf){switch(Hf){case xj.Excel:return"root\\office15\\excel.exe";case xj.PowerPoint:return"root\\office15\\powerpnt.exe";case xj.Visio:return"root\\office15\\visio.exe";case xj.Word:return"root\\office15\\winword.exe";case xj.Project:return"root\\office15\\winproj.exe";case xj.Publisher:return"root\\office15\\mspub.exe";case xj.Infopath:return"root\\office15\\infopath.exe";case xj.Access:return"root\\office15\\msaccess.exe";
default:return null}}function rl(Hf,bh,$h){if(Zi=Hf,Cj=bh,pj=$h,Hf.DocumentUrl){var Gh=$h=bh=Hf.DocumentUrl;try{Gh=decodeURIComponent(Hf.DocumentUrl)}catch(Nk){}try{$h=encodeURI(Hf.DocumentUrl)}catch(Nk){}bh=bh+""+Hf.CorrelationIdForWinClient;Gh+=Hf.CorrelationIdForWinClient;$h+=Hf.CorrelationIdForWinClient;Hf.Mode===$k.ReadWrite&&qk.CheckoutRequired===(Hf.Options&qk.CheckoutRequired)&&(Hf.Mode=$k.ForceCheckout);qk.HostIsEditOnly===(Hf.Options&qk.HostIsEditOnly)&&(Hf.Mode=$k.WriteOnly);if(vk(Hf)?
0:rd()&&(Hf.Application==xj.OneNote||wk($a,!1)||wk(Tb,!1))||id()||wj()||!(L()||Bj()||"ActiveXObject"in window&&!Wa()||ei())||15<=Yk())jl(Hf.Application,Hf.EncodeUrl?$h:bh,Hf.Mode,Hf.Application==xj.OneNote,Hf.SilentExternalHandler,Hf.NavigateUsingWindowOpen);else{var Gi;if(Gi=gg())a:{var Vi=Hf.EncodeUrl?bh:Gh,Ni=Hf.Mode,Yj=hl(Hf.Application);try{Gi=(new ActiveXObject(ka)).ViewDocument3(window.self,Vi,Ni,Yj);break a}catch(Nk){}Gi=!1}if(Gi)ek(Mk.O15ActiveX);else{if(L()||Bj()){var Dj=Hf.EncodeUrl?bh:
Gh;Gh=Hf.Mode;Gi=hl(Hf.Application);Vi=ll();if(null==Vi)Dj=Zi.DescriptiveUnattemptedEnums?ej.PluginIsNull:ej.Unattempted;else{Ni=!1;try{Ni=Vi.ViewDocument3(window.self,Dj,Gh,Gi)}catch(Nk){}if(!Ni)try{Ni=Qk(Gh)?Vi.ViewDocument2(window.self,Dj,Gi):Vi.EditDocument2(window.self,Dj,Gi)}catch(Nk){}Dj=Ni?(ek(Mk.NpapiPlugin),ej.None):ej.Failed}}else{try{Dj=new ActiveXObject(vd),null!=Dj&&Dj.SaveSSOCreds()}catch(Nk){}Dj=Lk(Hf.EncodeUrl?bh:Gh,Hf.Mode,Hf.Options,hl(Hf.Application))}if(Dj!=ej.None){if(Gh=Hf.CouldUseRoamingApps)ml||
(ml=!0,nl=xc("Windows NT")),Gh=6.1<=nl&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(Be()||Bj()||ei());if(Gh&&Hf.Application!=xj.OneNote){if(!Qf.ggb.GZj()){Hk(ej.ControlNeeded,Zi.Application);return}if(Hf.RoamingAppsLauncher){"undefined"==typeof Hf.RoamingAppsLauncher||null==Hf.RoamingAppsLauncher?Hk(Zi.DescriptiveUnattemptedEnums?ej.RoamingLauncherIsNull:ej.Unattempted,Zi.Application):"undefined"==typeof Hf.RoamingBitsUrl||null==Hf.RoamingBitsUrl?Qf.ggb.LZj(Hf.DocumentUrl,Hf.RoamingAppsLauncher,
Hf.Application,Hf.ApplicationParameters,Cj,pj):Qf.ggb.vjg(Hf.DocumentUrl,Hf.RoamingAppsLauncher,Hf.RoamingApplicationExe,Hf.ApplicationParameters,Hf.RoamingPlatform,Hf.RoamingBitsUrl,Cj,pj);return}if(!Hf.ContinueIfLauncherIsNull){Hk(ej.LauncherNeeded,Zi.Application);return}}qk.NoProtocolHandlerFallback==(Hf.Options&qk.NoProtocolHandlerFallback)||vk(Hf)||Be()||rd()&&!(Zi.DescriptiveUnattemptedEnums?Dj>=ej.O14Unattempted&&Dj<=ej.DocumentUrlIsNull:Dj==ej.Unattempted)?Hk(Dj,Zi.Application):jl(Hf.Application,
Hf.EncodeUrl?$h:bh,Hf.Mode,Hf.Application==xj.OneNote,Hf.SilentExternalHandler,Hf.NavigateUsingWindowOpen)}}}}else Hk(Zi.DescriptiveUnattemptedEnums?ej.DocumentUrlIsNull:ej.Unattempted,Zi.Application)}function ek(Hf){null!=Cj&&Cj(Hf)}function Hk(Hf,bh){"undefined"==typeof bh&&(bh=null);null!=pj&&pj(Hf,bh)}function Yk(){var Hf=0;if(L()||Bj()||ei()){var bh=ll();try{null!=bh&&(Hf=bh.GetOfficeVersion())}catch($h){}}else Xk(ka)?Hf=15:Xk(d)?Hf=14:Xk(w)?Hf=12:Xk(I)&&(Hf=11);return Hf}function G(){return rd()&&
(wk(ha,!0)||wk(wa,!0))}var ka="SharePoint.OpenDocuments.5",d="SharePoint.OpenDocuments.4",w="SharePoint.OpenDocuments.3",I="SharePoint.OpenDocuments.2",ha="application/x-sharepoint",wa="application/x-sharepoint-webkit",$a="application/x-sharepoint-protocolhandler",Tb="application/x-sharepoint-webkit-protocolhandler",Ic="application/officelive",pc="npSharePointPlugin",vd="IDBHO.IDBHOCtrl",ne="OneNote.Notebook",Pe="ofv|",Af="ofc|",Wf="ofe|",Of="u|",xg="|f|",oi="wdlor",Sh="",mj="",tj="",Cj,pj,fk,Zk,
Zi,ml,nl,ul,vl,$k={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},qk={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},ej={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,DocumentUrlIsNull:13},
Mk={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},xj={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:$k,OpenDocumentOptions:qk,OpenDocumentFailureType:ej,OpenDocumentControl:Mk,OfficeApplication:xj,EditDocumentInClient:rl,EditDocumentInClientParams:function(){this.DocumentUrl="";this.Options=this.Mode=
0;this.Application=xj.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},OfficeVersionInstalled:Yk,
IsO14MacPluginInstalled:G,OfferOfficeInDialog:function(){return oa()&&11>=Yk()},OfferOfficeNoIntrusive:function(){return oa()&&15>Yk()},OfferMacOffice:function(){return rd()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!G()},InstallRoamingControl:function(){Wg()?window.InstallTrigger.install({Office:{URL:mj}}):bk(tj,null,null)},CanUseRoamingControl:function(){var Hf,bh,$h;if(id())return!0;if(ei())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),!!navigator.mimeTypes["application/x-vnd.officeondemand"];
if(Wg())return Hf=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Hf),bh=document.createEvent("Events"),bh.initEvent("RoamingOfficeInstalled",!0,!1),Hf.dispatchEvent(bh),!!Hf.getAttribute("installed");if(Be())try{return $h=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),$h.HrExists()}catch(Gh){}return!1},InitUrls:function(Hf,bh,$h){Sh=Hf;mj=$h;tj=bh},LaunchRoamingApps:function(Hf,bh,$h,Gh,Gi,Vi){Qf.ggb.vjg(Hf,bh,tl($h),Gh,"x86",Sh,Gi,Vi)},LaunchRoamingApps2:function(Hf,
bh,$h,Gh,Gi,Vi,Ni,Yj){var Dj="",Nk;if(null!=Gh&&(Dj+=" "+Gh),null!=Hf&&(Dj+=' "'+Hf+'"'),id()||ei())fk=Ni,Zk=Yj,Ni='office: "'+(Vi+'" "')+($h+'" "ROAMING"'),Ni+=' "'+bh+'"',Ni+=' "'+Gi+'"',Ni+=" "+Dj,Fi(Ni,pl,sl,!1,!1);else if(Wg())Hf=document.createElement("RoamingExtensionElement"),Hf.setAttribute("cabUrl",Vi),Hf.setAttribute("app",$h),Hf.setAttribute("licensingEntitlements",bh),Hf.setAttribute("platform",Gi),Hf.setAttribute("args",Dj),document.documentElement.appendChild(Hf),bh=document.createEvent("Events"),
bh.initEvent("RoamingOfficeLaunch",!0,!1),Hf.dispatchEvent(bh),null!=Ni&&Ni(Mk.RoamingFFExtension);else if(Be()){if(Nk=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Nk)try{Nk.HrConfigureSingle(Vi,$h,bh,Gi,Dj),null!=Ni&&Ni(Mk.RoamingActiveX)}catch(zl){}}else null!=Yj&&Yj(ej.Failed)},ShouldShowDialog:function(){return!Wa()},NavigateToUrlUsingClickingOnATag:oj,OpenDocumentWithProtocolHandler:jl,OpenDocumentWithProtocolHandlerNoCallBack:function(Hf,bh,$h,Gh){var Gi=ql(Hf),Vi;return null==
Gi?(Hk(Zi.DescriptiveUnattemptedEnums?ej.ProtocolHandlerNoCallbackIsNull:ej.Unattempted,Zi.Application),!1):(Vi=il(Hf,bh,$h,Gh,Gi),Fi(Vi,null,null,!1,!1),!0)}}}();Qf.ClientUtils=Qf.ggb;var $g=b(817),yg=b(56),lh=b(35),h=b(175);kf.prototype.Yc=function(){return!1};kf.prototype.executeCommand=function(L,oa,Wa){return 2!==this.Gi.Ce(Vf.a.newDocument,2,Wa)?Xg.Task.Ta(!0):h.a(oa.command)};kf.prototype.Jc=function(L,oa){return 1056925771===oa.command};kf.prototype.fd=function(L,oa,Wa){L=!0;switch(oa){case "PopulateNewMenu":this.Gi&&
this.Gi.Ce(Vf.a.Upc,2,Wa);break;default:L=!1}return L};Object(ve.a)(kf,"CreateNewCommandHandler",null,[188]);var Bb=$g.a;vm(hf,Bb);hf.prototype.Od=function(){var L=this,oa=yg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),Wa=yg.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.ub);lh.TaskExtensions.Ba(lh.TaskExtensions.ve([oa,Wa],this.ma),function(){L.Fd([new kf(Od.AFrameworkApplication.Gb)])},this.ma,3)};hf.ja=function(L){$g.a.fe(87,new hf(L))};Object(ve.a)(hf,"CreateNewCommandHandlerFactory",
$g.a,[]);var qc=b(1247),W=b(879),va=b(309),N=b(194),k=b(281),E=b(4),M=b(150),aa=b(96),na=b(77),qb=b(73),Pb=b(369),Jc=b(164),ad=b(57),ia=b(81),Qa=b(318),Nb=b(605);ee.prototype.Tse=function(){};ee.prototype.h7c=function(){this.vtg?ye.a.downloadFile(this._url):ye.a.vf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};ee.prototype.dispose=function(){};Object(ve.a)(ee,"OpenUrlInTabDialogDownloadBehavior",null,[39,3]);var tc=b(274),gd=Lg.StandardDialog;vm(Ee,gd);Ee.prototype.tXc=
function(){this.Ul&&(this.RVa||(this.RVa=Object(qf.a)(this,this.NGi,"onActionButtonClicked"),this.zy.qa(mg.a.click,this.HB,this.RVa)),this.SVa||(this.SVa=Object(qf.a)(this,this.OGi,"onActionButtonKeyUp"),this.je.qa(mg.a.Wd,this.HB,this.SVa)));gd.prototype.tXc.call(this)};Ee.prototype.NGi=function(L){this.dSe(L);return!0};Ee.prototype.OGi=function(L){return this.Ojf(L,Object(qf.a)(this,this.dSe,"executeDismissActionButtonFromArgs"))};Ee.prototype.dSe=function(L){this.Ul&&this.Ul.submit();this.wua(L.Tb)};
Ee.prototype.aud=function(){};Ee.prototype.SJe=function(){this.Kmf();this.Ul?this.Ul.submit():this.uRb.h7c();return!0};Ee.prototype.mjc=function(){return!1};Ee.prototype.dispose=function(){this.uRb.dispose();this.Phb&&(Od.AFrameworkApplication.sa.rX.za(mg.a.click,this.Phb,Object(qf.a)(this,this.SJe,"downloadLinkClicked")),this.Phb=null);this.aY&&(Od.AFrameworkApplication.sa.rX.za(mg.a.click,this.aY,Object(qf.a)(this,this.mjc,"learnMoreLinkClicked")),this.aY=null);this.zy&&this.RVa&&(this.zy.za(mg.a.click,
this.HB,this.RVa),this.RVa=null);this.je&&this.SVa&&(this.je.za(mg.a.Wd,this.HB,this.SVa),this.SVa=null);gd.prototype.dispose.call(this)};Ee.prototype.IMf=function(){this.Ul&&(document.body.appendChild(this.Ul),this.Ul.submit(),document.body.removeChild(this.Ul))};Ee.prototype.$v=function(L){1===L&&(this.aud(),this.Ul?Ee.wy&&this.IMf():this.uRb.h7c());this.dispose()};Sk.Object.defineProperties(Ee.prototype,{A$e:{configurable:!0,enumerable:!0,get:function(){return null}},OVd:{configurable:!0,enumerable:!0,
get:function(){return null}},$Na:{configurable:!0,enumerable:!0,get:function(){return null}},QAb:{configurable:!0,enumerable:!0,get:function(){return null}},U7a:{configurable:!0,enumerable:!0,get:function(){return null}},Mqf:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_Open}},S4c:{configurable:!0,enumerable:!0,get:function(){return null}},RVc:{configurable:!0,enumerable:!0,get:function(){return null}},ipe:{configurable:!0,
enumerable:!0,get:function(){return null}}});Sk.Object.defineProperties(Ee,{wy:{configurable:!0,enumerable:!0,get:function(){return Od.AFrameworkApplication.sa.Qa.rw&&Od.AFrameworkApplication.sa.Qa.Zgf}},Zwb:{configurable:!0,enumerable:!0,get:function(){return Ee.U7d},set:function(L){Ee.U7d=L}}});Ee.U7d=!1;Object(ve.a)(Ee,"ADialogWithLinkToResource",Lg.StandardDialog,[]);var Rc=b(413),Xd=b(313),pe=b(14);vm(Gd,Ee);Gd.prototype.Imf=function(){td.ULS.sendTraceTag(537162658,0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};
Gd.prototype.Kmf=function(){td.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};Gd.prototype.mjc=function(){Rc.Redirect.showHelp(Xd.a.iGi);return!0};Sk.Object.defineProperties(Gd.prototype,{$Na:{configurable:!0,enumerable:!0,get:function(){return pe.a.instance.Va(410)}},tjc:{configurable:!0,enumerable:!0,get:function(){return pe.a.instance.Va(411)}},sjc:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},QAb:{configurable:!0,
enumerable:!0,get:function(){return"#"}},U7a:{configurable:!0,enumerable:!0,get:function(){return pe.a.instance.Va(412)}},Mqf:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(ve.a)(Gd,"DownloadACopyAsOdsDialog",Ee,[]);Ed.prototype.Tse=function(L){this.dialog=L};Ed.prototype.h7c=function(){this.FGi.NFf(-1059172980)};Ed.prototype.dispose=function(){this.Ab.eHb(this.exf)};Object(ve.a)(Ed,"DownloadACopyAsOdsDialogDownloadBehavior",null,[39,3]);Object(ve.a)(Oc,"MacroRecorderWorkbookCalculationModeSetPayload",
null,[147]);Object(ve.a)(dc,"MacroRecorderWorkbookRecalculatedPayload",null,[147]);var cf=b(206),ef=b(117),jf=b(1),yf=b(304);Sk.Object.defineProperties(Rf,{eWi:{configurable:!0,enumerable:!0,get:function(){return Rf.dWi}}});Rf.dWi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(ve.a)(Rf,"OpenInAppDialogCopyHtml",null,[]);var Eg=b(370),rh=yf.a;vm(xf,rh);xf.prototype.openUrl=function(L,oa){var Wa=document.getElementById("link");Wa||(Wa=document.createElement("a"),Wa.id="link",Wa.style.visibility="hidden",Wa.href="",document.body.appendChild(Wa));Wa.target=oa;Wa.href=L;Wa.click()};xf.prototype.Hjg=function(){var L=this;td.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.Wa(this.$.da,21,137,1),function(oa){var Wa=
{};Wa.OpenInAppUrl=L.vOa;Wa.StoreUrl=L.Sq;oa.result.Sj("UI_OpenInMobileApp",Wa)},this.$.ma)};xf.prototype.fWi=function(){td.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};xf.prototype.Ch=function(){this.eg=wh.a.Cn(Rf.eWi,pe.a.instance.fa(655),pe.a.instance.fa(656),Od.AFrameworkApplication.KC,Eg.getImageClass(Od.AFrameworkApplication.ga.Ua("AppIcon")),pe.a.instance.fa(657));this.Ue="OpenInAppDialog";this.jc=5;this.initializeAndShow("",this.fWi.bind(this),null);this.Hz(this.ZH)};
xf.prototype.mv=function(L){rh.prototype.mv.call(this,L);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.ZH=document.getElementById("LinkToInstall");cf.a.instance.qa(mg.a.click,this.ZH,this.dDb);ef.KeyInputManager.instance.qa(mg.a.Wd,this.ZH,this.hma)};xf.prototype.dispose=function(){this.ZH&&(cf.a.instance.za(mg.a.click,this.ZH,this.dDb),ef.KeyInputManager.instance.za(mg.a.Wd,this.ZH,this.hma),this.ZH=null);rh.prototype.dispose.call(this)};Sk.Object.defineProperties(xf.prototype,
{Ac:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(ve.a)(xf,"OpenInAppDialogCopy",yf.a,[]);var Eh=b(26),Qg=b(27),Ng=b(353),Hh=b(9),Tg=b(272),tg=b(20),ii=b(41),Ki=b(245),$i=b(462),Y=b(377),Ra=b(48),xb=b(6),fc=b(136),bd=b(1119),Dd=b(79),Td=b(33),we=b(359),Oe=b(247);Lf.prototype.YQ=function(L,oa){L=Qg.a.hd(12,1,658,0,0,0,"Blank");L.Description=String.format(pe.a.instance.fa(659),oa);return L};Lf.prototype.H$b=function(L){switch(L){case 1:case 2:return 0;default:return 2}};
Object(ve.a)(Lf,"ReloadCloseConfirmation",null,[139]);var Te=b(145),Zf=b(606),dg=b(65),Jg=N.a;vm(ue,Jg);ue.prototype.Yc=function(){return!1};ue.prototype.executeCommand=function(L,oa,Wa,Rb){var xc=this,id=this.K6b,rd=this.$,$d=oa.command,Be=this.openInExcelOperation,gg=this.$.Ib,Wg=Wa.SourceControlId;rd.Lk.Hme($d);L=null;switch($d){case 1455037301:this.$.v5?Be.uCe():Be.L2c();break;case -2044628748:case 2004484710:this.$.v5?Be.uCe():Be.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===
Wg?(this.oBb("CellLongPress"),td.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.oBb("PencilIcon"),td.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case -2028960985:Be.q6f();break;case -1059172980:new Gd(Be.uve($d),new Ed(Be,rd.Ab));break;case -1285148982:this.clientWorkflow.qd.activityState[Td.a.QTc]=
!0;this.tAc(!1);break;case -75280711:this.tAc(!1);break;case -455164169:this.tAc(!0);break;case -1388494670:this.$.da.Za(400,function(oj){oj.lzi();xc.tAc(!1)});break;case 810888577:Od.AFrameworkApplication.rk=(new Date).getTime();td.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",Od.AFrameworkApplication.rk);break;case -1804063550:case -974518828:oa=0;E.a.lCd in Wa&&(oa=Wa[E.a.lCd]);Be.NFf($d,oa);break;case -1339961039:oa=!1;Wa&&E.a.aIb in Wa&&
(oa=Wa[E.a.aIb]);this.reloadWorkbook(!1,oa);break;case -8805455:var Dh=this.workbookContext;rd.isEditMode||(ue.Xze(rd),L=lh.TaskExtensions.Ba(this.eK.value,function(oj){oj=oj.result;var bk=oj.isEnabled();bk&&Nb.a(oj,Jf.a.copyAndEdit,ad.a.Rf.hZe(),xc.$.ea.oh.get(2))?td.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):bk&&Od.AFrameworkApplication.hfg?(bk={},bk[qc.a.dFd]=Od.AFrameworkApplication.userSessionId,
bk[Od.AFrameworkApplication.HBi]=Eh.a.Ra.Kb.getTime().toString(),td.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),oj.Sj(Jf.a.editMode,bk)):id.CopyAndEditUrl?xc.F3g():(xc.nc.supportsEditing||Dh.EditUrl)&&xc.reloadWorkbookInEditMode()},this.ma,3));break;case -723527778:rd.isEditMode&&(ue.Xze(rd),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var ei=rd.na.ta.Zb(),
wj=-1355155015===$d?1:0,Bj=function(){return new dc(wj)};L=Pb.a(this.$.userOperationManager,function(oj,bk,vk){return ia.V(rd.na.ta,wj,null,oj,bk,vk,null,ei)},function(oj){return new Jc.a(128,0,oj,void 0,Bj)},oa);tg.g(rd).Hh.XG(!1);break;case -1158102843:L=tg.g(rd).Hh.recalcSheet(oa);tg.g(rd).Hh.XG(!1);break;case -988468372:if(jf.EwaSettings.la(306))if(Rb=parseInt(Wa[na.a.ld],10),0<=Rb&&3>Rb)this.setCalculationMode(oa,Rb);else return td.ULS.sendTraceTag(537162652,0,10,"SetCalculationMode , unexpected menuItemId: {0}",
Wa[na.a.ld]),h.a($d);break;case 257398710:M.a.ntw(id.ReportAbuseUrl,rd);break;case 1800405051:this.Skj();break;case -48469327:this.saveACopy();break;case 214430355:oa=!1;Wa&&E.a.T7c in Wa&&(oa=Wa[E.a.T7c]);if(!this.Kyj(oa,Wa))break;Od.AFrameworkApplication.q5?this.businessBar.ig(40,null):this.businessBar.ig(oa?22:23,null);break;case 1389557314:L=lh.TaskExtensions.Ba(this.eK.value,function(oj){Nb.a(oj.result,Jf.a.BBh,null,xc.$.ea.oh.get(6))||M.a.ntw(id.FileVersionUrl,rd)},this.ma,3);break;case 2145659238:this.closeWorkbook();
break;case 1773624819:Wg===gg+E.a.Fjf?Be.$ri():Be.Zri();break;case 512141517:Wg===gg+E.a.Ejf?Be.jsi():Be.isi();break;case -1224038235:var Xj=W.a.On in Wa?!Wa[W.a.On]:aa.j(rd.ea.workbookContext.Options);Wa[W.a.Description]=Xj?pe.a.instance.fa(564):pe.a.instance.fa(565);L=Pb.a(this.$.userOperationManager,function(oj,bk,vk){var Qk=xc.$.na.ta,Lk=Qk.Na(9,null);Lk.isReadOnlyRecommended=!Xj;return ia.i(Qk,"SetReadOnlyRecommended",Lk,oj,bk,vk,null,0)},function(oj){return new Jc.a(129,0,oj)},oa);break;case 1118926154:if(this.$.isEditMode){var Fi=
new Lh.a;this.$.da.Za(53,function(oj){oj?(oj.Im.Tri(xc.$.Ib+E.a.Wrd),Fi.setResult(!0)):td.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});L=Fi.task}break;case -1698025133:Be.openInBrowser();break;case 520859864:L=lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.Wa(this.$.da,393,394,Rb.Rja()),function(oj){oj.result||td.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},this.$.ma,3);
break;default:L=h.a($d)}return L||Xg.Task.Ta(!0)};ue.prototype.oBb=function(L){if(jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(Hh.HelperMethods.c_){var oa=new Map;oa.set("EntryPoint",L);gh.Health.instance.recordKpiUsage(Y.a.cWi,0,$i.a.oBi,oa)}else td.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};ue.prototype.showOpenInAppDialog=function(){Od.AFrameworkApplication.isMobileMode&&(jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",
!1)?(td.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new xf(this.$)).Ch()):(td.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),Od.AFrameworkApplication.showOpenInAppDialog()))};ue.prototype.Kyj=function(L,oa){var Wa=this;return Od.AFrameworkApplication.isMobileMode&&!qb.a(this.$.ya,30)?(this.showOpenInAppDialog(),td.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),
this.oBb("CellDoubleTap"),td.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):Od.AFrameworkApplication.Sgc&&(L&&Ng.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?(td.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",
Ng.d(this.workbookContext.WorkbookFileName)?"xls":"csv",this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""),!1):va.a.any([25,26,30,31,55,32],function(Rb){return Wa.businessBar.kMa(Rb)})?(td.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),!1):oa&&E.a.f3i in oa&&!L?!1:!0};ue.prototype.Jc=function(L,oa){L=!1;switch(oa.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:L=
!0;break;case 520859864:L=jf.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?!0:!1;break;case -1285148982:case -75280711:case -455164169:L=jf.EwaSettings.la(109);break;case -1388494670:L=jf.EwaSettings.la(109);break;case 810888577:L=jf.EwaSettings.la(273);break;case -1224038235:L=this.$.ea.amIAlone;break;case -988468372:L=jf.EwaSettings.la(306);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:L=!0,td.ULS.shipAssertTag(537162642,0,this.$.Gka,
"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return L};ue.prototype.fd=function(){return!1};ue.prototype.Skj=function(){var L=this;if(this.qc){var oa=this.$;ii.a(oa).kt(new Ki.a(xb.a.fz,5,function(){oa.nI(!1,!0);var Wa=L.clientWorkflow.qd.activityState;Wa[Oe.a.Yq]=xb.a.Fda;Wa[fc.a.NT]=2;Wa[Td.a.Ls]=oa.isEditMode;Wa[fc.a.Oga]=!1}))}};ue.prototype.saveACopy=function(){var L=this;if(this.qc){var oa=this.$;ii.a(oa).kt(new Ki.a(xb.a.fz,5,function(){oa.nI(!1,
!1);var Wa=L.clientWorkflow.qd,Rb=Wa.activityState;Rb[Oe.a.Yq]=xb.a.LVf;Rb[Zf.a.hYb]=L.nc.hasUnsupportedFeaturesForEdit;Rb[fc.a.Oga]=!1;Wa.At(Qg.a.paa(L.businessBar.f8c,[-502303485]))}))}};ue.prototype.tAc=function(L){var oa=this;ii.a(this.$).kt(new Ki.a(xb.a.una,2,function(){oa.$.nI(!0,!0);var Wa=dg.a(oa.$).qd,Rb=oa.$.isEditMode;Rb=Qg.a.hd(1,1,0,0,0,Rb?-315732528:-2087635043,Rb?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Rb.ForceVersionUpgrade=L;Wa.At([Rb]);Wa=dg.a(oa.$).qd.activityState;
Wa[Oe.a.Yq]=xb.a.una;Wa[Td.a.Ls]=oa.$.isEditMode;Wa[fc.a.Oga]=!1}))};ue.prototype.closeWorkbook=function(){var L=this;if(this.qc){var oa=this.$;ad.a.Rf.Owc("2145659238")?lh.TaskExtensions.Ba(this.eK.value,function(Wa){Wa.result.Sj(Jf.a.ATe,{})},this.ma,3):ii.a(oa).kt(new Ki.a(xb.a.fz,5,function(){oa.nI(!0,!1);var Wa=L.clientWorkflow.qd.activityState;Wa[fc.a.tY]=!1;Wa[fc.a.Oga]=!1;L.nc.inViewerFromWebPart?(Qa.a.RFd(oa,L.clientWorkflow.qd),oa.Lk.Jy("InViewerFromWebPart"),Wa[Oe.a.Yq]=xb.a.E_):(Wa[Oe.a.Yq]=
xb.a.Bk,oa.Hd&32?Wa[fc.a.NT]=0:(Wa[fc.a.NT]=1,Wa[fc.a.XXb]=new bd.a),Wa[Te.a.gle]=!0)}))}};ue.prototype.F3g=function(){var L=this,oa=this.nc.vbaRemovedDuringConversion;td.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",oa);var Wa=this.$;oa?ii.a(Wa).kt(new Ki.a(xb.a.fz,5,function(){var Rb=Qg.a.hd(3,0,0,1222,0,1069271157,"XLSMacroFailure");L.clientWorkflow.qd.At([Rb]);L.clientWorkflow.qd.activityState[Oe.a.Yq]=xb.a.teb})):Od.AFrameworkApplication.hideHeader?
Hh.HelperMethods.vf(this.K6b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):M.a.ntw(this.K6b.CopyAndEditUrl,Wa)};ue.prototype.reloadWorkbookInEditMode=function(){var L=this;if(this.qc)if(jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&ad.a.Rf.UV&&ad.a.Rf.FHd(),Od.AFrameworkApplication.Sgc&&!Od.AFrameworkApplication.bla)Hh.HelperMethods.vf(this.$.apb(!0),k.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var oa=
this.$,Wa=!1,Rb=this.nc.hasUnsupportedFeaturesForEdit,xc=this.workbookContext.FileWasRepaired;Ng.d(this.workbookContext.WorkbookFileName)?(Wa=!0,td.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",Rb)):Ng.a(this.workbookContext.WorkbookFileName)&&(Wa=!0,td.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var id=oa.jg.get(59);id=!(oa.ea.nc.supportsEditing&&
id);if(Wa&&!Rb||id&&(Wa||Rb)){var rd=id?Rb?-2066104278:816071846:jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&qb.a(this.$.ya,25)&&!this.$.Bzb?765011943:-213064907;Wa=function(){var $d=Qg.a.c_a([rd]);L.clientWorkflow.qd.At($d);L.clientWorkflow.qd.activityState[Oe.a.Yq]=xb.a.teb}}else Wa=function(){oa.nI(!0,!1);var $d=L.clientWorkflow.qd,Be=$d.activityState;Be[fc.a.NT]=1;Be[we.a.bYb]=Ne.a.elc;Be[Td.a.Ls]=!0;Be[Zf.a.hYb]=L.nc.hasUnsupportedFeaturesForEdit;Be[fc.a.Oga]=
!!L.workbookContext.EditUrl;Be[Dd.a.t2]=L.workbookContext.EditUrl;if(!L.K6b.CopyAndEditUrl){var gg=[jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&qb.a(L.$.ya,25)&&!L.$.Bzb?-943219229:1821390342];$d.At(Qg.a.paa(L.businessBar.f8c,gg))}xc&&!Rb?(Ng.b(L.workbookContext.WorkbookFileName)&&jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConverterOdfFileRepairEnabled",!1)?($d=Qg.a.c_a([-425642652]),td.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):
$d=Qg.a.c_a([108482388]),L.clientWorkflow.qd.At($d),Be[Oe.a.Yq]=xb.a.$Vf):L.$.ea.x8e?(td.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),Ra.b().CTd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Be[Oe.a.Yq]=xb.a.$Eb):Be[Oe.a.Yq]=L.$.ea.Dgc?xb.a.UAb:xb.a.teb};ii.a(oa).kt(new Ki.a(xb.a.fz,5,Wa))}};ue.prototype.reloadWorkbookInViewMode=function(){var L=
this;if(this.qc){jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&ad.a.Rf.UV&&ad.a.Rf.FHd();var oa=this.$;Cf.a.ah&&tg.g(oa).yc.textBox.blur();ii.a(oa).kt(new Ki.a(xb.a.fz,5,function(){oa.nI(!oa.ea.isNamedObjectViewMode,!1);var Wa=L.clientWorkflow.qd.activityState;Wa[Oe.a.Yq]=xb.a.Yha;Wa[fc.a.NT]=1;Wa[fc.a.tY]=!0;Wa[Td.a.Ls]=!1;Wa[Td.a.Omb]=!0;Wa[we.a.bYb]=Ne.a.elc}))}};ue.prototype.reloadWorkbook=function(L,oa){var Wa=this;if(this.qc){var Rb=this.$;Rb.RM&65536&&
ii.a(Rb).kt(new Ki.a(xb.a.fz,5,function(){Rb.nI(L,!0);var xc=Wa.clientWorkflow.qd.activityState;xc[Oe.a.Yq]=xb.a.Ck;xc[Td.a.TTc]=Wa.workbookContext.NovMode;oa||(xc[fc.a.NT]=1,xc[fc.a.XXb]=new Lf)}))}};ue.prototype.setCalculationMode=function(L,oa){function Wa(){return new Oc(oa)}var Rb=this;td.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",oa);var xc=this.$.ea.workbookContext.CalcMode;this.$.ea.workbookContext.CalcMode=oa;return Pb.a(this.$.userOperationManager,
function(id,rd,$d){var Be=Rb.$.na.ta;id=Tg.b(id,ue.PSi(Rb.$,xc));rd=Tg.a(rd,ue.OSi(Rb.$,xc));var gg=Be.Na(9,null);gg.calc_type=oa;return ia.i(Be,"SetCalculationOptions",gg,id,rd,$d,null,0)},function(id){return new Jc.a(197,0,id,void 0,Wa)},L)};ue.Xze=function(L){L.Ab&&0<L.Ab.$N&&L.Ab.I$c(function(oa){oa.Du()})};ue.PSi=function(L,oa){return function(Wa){Qg.a.lh(Wa.Errors)&&(L.ea.workbookContext.CalcMode=oa,td.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",
oa,Qg.a.Tc(Wa.Errors)))}};ue.OSi=function(L,oa){return function(){L.ea.workbookContext.CalcMode=oa;td.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",oa)}};Sk.Object.defineProperties(ue.prototype,{qc:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.qc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},K6b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},
clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return dg.a(this.$)}},nc:{configurable:!0,enumerable:!0,get:function(){return this.$.nc}}});Object(ve.a)(ue,"FileOperationsCommandHandler",N.a,[188]);var Ug=b(147),Xh=$g.a;vm(ae,Xh);ae.prototype.Od=function(){var L=this,oa=this.$,Wa=[],Rb=yg.GetServiceTaskFactory.create(oa.da,56,this.ma,this.ub);Wa.push(Rb);var xc=yg.GetServiceTaskFactory.Wa(oa.da,5,4,this.ub);Wa.push(xc);lh.TaskExtensions.Ba(Xg.Task.WAA.apply(null,Wa),function(){Ug.b(Rb)&&
L.Fd([new ue(oa,Rb.result,new Kf.a(function(){return yg.GetServiceTaskFactory.create(oa.da,137,L.ma,L.ub)}),xc.result)])},this.ma,0)};ae.ja=function(L){$g.a.fe(94,new ae(L))};Object(ve.a)(ae,"FileOperationsCommandHandlerFactory",$g.a,[]);var Ef=b(43),Th;(function(L){L[L.url=0]="url";L[L.ref=1]="ref";L[L.mailto=2]="mailto"})(Th||(Th={}));Object(ve.b)("HyperlinkSelectionState",Th);var sh=b(899),Mg=b(8),Hi=b(603),R=b(82),Aa=sh.a;vm(Uc,Aa);Uc.prototype.F0e=function(L,oa){switch(oa){case 2:return L.startsWith("mailto:")?
L:"mailto:"+L;case 1:return String.format("{0}{1}",Mg.a.JIf,this.kTh(L));default:return L}};Uc.prototype.ox=function(){var L=this,oa=this.$;this.location=this.F0e(this.Mxd,this.Lxd);try{this.location=R.a.ym(this.location)}catch(xc){td.ULS.sendTraceTag(537157643,0,15,"Decoding link text failed")}td.ULS.sendTraceTag(555755667,0,50,"Committing {0} link",Th[this.Lxd]);this.cellValue=this.Kxd.length?this.Kxd:this.Mxd;oa.oy();var Wa=oa.na.ta.Zb(),Rb=Ef.s(this.selectedRange);return function(xc,id,rd){return ia.c(oa.na.ta,
Rb,L.cellValue,L.location,L.removeHyperLink,!1,123,xc,id,rd,L.mM.range,Wa)}};Uc.prototype.Zl=function(){var L=this,oa=Ef.s(this.selectedRange);return function(){return new Hi.a(oa,L.cellValue,L.location)}};Uc.prototype.gAh=function(){var L=this.mM.cell.k5a;this.mM.cell.zwb?L&&L.startsWith("mailto:")?(this.Kmb=2,L=L.substr(7)):this.Kmb=0:this.Kmb=1;return L};Uc.prototype.DLa=function(){jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.zyb=this.mM.bba:this.zyb=!!this.mM.oKa(64)||
!!this.mM.oKa(128)};Uc.prototype.mm=function(){if(this.zyb){this.x1a=this.mM.text;var L=this.gAh();L&&(this.GTc=L);this.io=pe.a.instance.fa(810);this.Mqb=this.GTc===this.x1a}else this.mM.text?(this.x1a=this.mM.text,this.Mqb=!1):(this.x1a="",this.Mqb=!0),this.Kmb=0,this.io=pe.a.instance.fa(809);this.mM.lK&&(this.Mqb=!1,this.yIe=!0,jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.x1a=this.mM.formulaBarText))};Uc.prototype.QCi=function(L){return this.ea.zb.zj(L)};
Uc.prototype.a_e=function(L,oa){return L?null:pe.a.instance.fa(oa)};Uc.prototype.kTh=function(L){var oa=Ef.Z(L,this.ea.xa);var Wa=oa.sheetName;var Rb=oa.range;oa.returnValue&&Rb&&(L=Ef.x(Rb,Wa||this.sheetName,!1));return L};Sk.Object.defineProperties(Uc.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},Rw:{configurable:!0,enumerable:!0,get:function(){return 526}}});Uc.xWj="validateLinkValues";Uc.UOg="bodyProps";Uc.wfh="disableDisplayText";Uc.mgh="displayTextValue";
Uc.Szg="activeLinkOption";Uc.Tzg="activeLinkValue";Uc.M3g="copyLinkValueToDisplay";Uc.Xsi="linkValue";Uc.onj="selectedLink";Uc.lgh="displayText";Object(ve.a)(Uc,"HyperlinkDialog",sh.a,[]);Sc.prototype.Yc=function(){return!1};Sc.prototype.Jc=function(L,oa){return 1===L&&-1583422759===oa.command};Sc.prototype.fd=function(){return!1};Sc.prototype.executeCommand=function(){this.CBj();return Xg.Task.Ta(!0)};Sc.prototype.CBj=function(){var L=Ef.v(this.gridView.ha.va.Sd,this.$),oa=tg.e(this.gridView);(!jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||
this.$.Ns([this.gridView.ha.va.Sd],!0))&&oa&&new Uc(this.$,L,oa)};Object(ve.a)(Sc,"ShowHyperlinkCommandHandler",null,[188]);var hb=$g.a;vm(Cc,hb);Cc.prototype.Od=function(){this.Fd([new Sc(this.$,tg.g(this.$))])};Cc.ja=function(L){$g.a.fe(105,new Cc(L))};Object(ve.a)(Cc,"ShowHyperlinkCommandHandlerFactory",$g.a,[]);var Ib=b(19),Bc=b(1139);Hc.create="Create";Hc.activate="Activate";Hc.close="Close";Hc.remove="Delete";Hc.duplicate="Duplicate";Object(ve.a)(Hc,"Actions",null,[]);var gc=Xg.Task;vm(nb,gc);
nb.prototype.TL=function(){this.c0d=Qg.a.hd(3,2,0,1622,0,-1244327602,"MsFormDeleteConfirmation");this.jj=ii.a(this.Bf.$).vi(this.c0d).G();this.jj.isCompleted||(this._state=2,this.jj.PN(this.moveNext));return this.pDc};nb.prototype.pDc=function(){this.e0d=this.jj.hz();0===this.e0d&&(this.Bf.$.workbookContext.Options=Hh.HelperMethods.BO(!1,this.Bf.$.workbookContext.Options,2048),this.Bf.deleteMsFormMetaDataSheet());this._state=3;this.yRa(!0)};nb.prototype.dispose=function(){};Object(ve.a)(nb,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",
Xg.Task,[3]);Ve.action="Action";Ve.SDh="FlexPane";Ve.h$b="formId";Ve.id="id";Ve.title="Title";Ve.EOb="XlWorkbookId";Ve.UFh="Fragment";Ve.host="Host";Ve.zMj="TopView";Ve.p2="auth_pvr";Object(ve.a)(Ve,"Parameters",null,[]);ze.prototype.Yc=function(L,oa){switch(oa){case -105284469:return!aa.i(this.$.lg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};ze.prototype.executeCommand=function(L,oa){L=lh.TaskExtensions.om();oa=oa.command;switch(oa){case -105284469:this.insertMsForm();
break;case -1219864912:this.previewMsForm();break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:L=this.deleteMsForm();break;default:L=h.a(oa)}return L};ze.prototype.Jc=function(L,oa){if(!this.$.ea.oh.get(61))return!1;L=!1;switch(oa.command){case -105284469:L=aa.i(this.$.lg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:L=this.hasMsForm}return L};ze.prototype.fd=function(){return!1};ze.prototype.insertMsForm=
function(){var L=Uf.a.lr(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),oa={},Wa={};oa[Ve.action]=Hc.create;oa[Ve.p2]=this.p2;Wa[Ve.action]=Hc.create;Wa[Ve.EOb]=encodeURIComponent(this.AOb);Wa[Ve.host]=this.lo;Wa[Ve.title]=encodeURIComponent(L);this.JBb(oa,Wa);this.$.workbookContext.Options=Hh.HelperMethods.BO(!1,this.$.workbookContext.Options,2048)};ze.prototype.editMsForm=function(){var L={},oa={};L[Ve.p2]=this.p2;oa[Ve.h$b]=this.tlc;oa[Ve.EOb]=encodeURIComponent(this.AOb);oa[Ve.host]=
this.lo;this.JBb(L,oa)};ze.prototype.previewMsForm=function(){var L={},oa={};L[Ve.p2]=this.p2;oa[Ve.h$b]=this.tlc;oa[Ve.EOb]=encodeURIComponent(this.AOb);oa[Ve.host]=this.lo;oa[Ve.zMj]="Preview";this.JBb(L,oa)};ze.prototype.sendMsForm=function(){var L={},oa={};L[Ve.p2]=this.p2;oa[Ve.h$b]=this.tlc;oa[Ve.SDh]="SendForm";oa[Ve.EOb]=encodeURIComponent(this.AOb);oa[Ve.host]=this.lo;this.JBb(L,oa)};ze.prototype.deleteMsForm=function(){return new nb(this)};ze.prototype.deleteMsFormMetaDataSheet=function(){var L=
this;this.$.userOperationManager.Nt(new Jc.a(158,0,function(oa,Wa,Rb){return Ae(L.$.na.ww,L.gV.Vtb,Tg.b(oa,function(){L.tdh()}),Wa,Rb,null)}))};ze.prototype.tdh=function(){var L={},oa={};L[Ve.action]=Hc.remove;L[Ve.p2]=this.p2;oa[Ve.action]=Hc.remove;oa[Ve.host]=this.lo;oa[Ve.h$b]=encodeURIComponent(this.tlc);oa[Ve.EOb]=encodeURIComponent(this.AOb);this.JBb(L,oa)};ze.prototype.JBb=function(L,oa){var Wa=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",Rb="",xc="";if(oa){for(var id in oa){var rd=id,
$d=oa[id];xc+=xc.length?"&":"";xc+=rd+"="+$d}L||(L={});L[Ve.UFh]=encodeURIComponent(xc)}if(L)for(var Be in L)oa=Be,xc=L[Be],Rb+=Rb.length?"&":"?",Rb+=oa+"="+xc;window.open(Wa+Rb,"_blank")};Sk.Object.defineProperties(ze.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return aa.c(this.$.lg)}},tlc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},AOb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},p2:{configurable:!0,
enumerable:!0,get:function(){return Ib.a.contains(this.$.Au.DocumentHostInfo.FileSource,"onedrive",!0)?"MSA":"OrgId"}}});Object(ve.a)(ze,"MsFormCommandHandler",null,[188]);var Id=$g.a;vm(oc,Id);oc.prototype.Od=function(){var L=this,oa=yg.GetServiceTaskFactory.create(this.$.da,203,this.ma,this.ub);lh.TaskExtensions.Ba(lh.TaskExtensions.ve([oa],this.ma),function(){L.Fd([new ze(L.$)])},this.ma,3)};oc.ja=function(L){L.ea.oh.get(61)&&$g.a.fe(215,new oc(L))};Object(ve.a)(oc,"MsFormCommandHandlerFactory",
$g.a,[]);var fe=cg.a;vm(Yc,fe);Yc.prototype.create=function(){var L=this;lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.create(this.$.da,164,this.ma,this.ub),function(){L.Fb(new nc)},this.ma,3)};Object(ve.a)(Yc,"NewAndOpenUXFactory",cg.a,[]);Tc.prototype.executeCommand=function(L,oa,Wa){L=2;switch(oa.command){case Vf.a.openUrlInNewTab:L=this.Gi.Ce(Vf.a.openUrlInNewTab,2,Wa);break;case Vf.a.bPa:L=this.Gi.Ce(Vf.a.bPa,2,Wa)}return 2!==L?Xg.Task.Ta(!0):h.a(oa.command)};Tc.prototype.Jc=function(L,oa){return oa.command===
Vf.a.openUrlInNewTab||oa.command===Vf.a.bPa};Tc.prototype.fd=function(L,oa,Wa){return"PopulateMruMenu"===oa?(this.Gi.Ce(Vf.a.Tpc,2,Wa),!0):!1};Tc.prototype.Yc=function(){return!1};Object(ve.a)(Tc,"OpenFromMruCommandHandler",null,[188]);var sf=$g.a;vm(Nd,sf);Nd.prototype.Od=function(){var L=this,oa=yg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),Wa=yg.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.ub);lh.TaskExtensions.Ba(lh.TaskExtensions.ve([oa,Wa],this.ma),function(){L.Fd([new Tc(L.$,
Od.AFrameworkApplication.Gb)])},this.ma,3)};Nd.ja=function(L){$g.a.fe(88,new Nd(L))};Object(ve.a)(Nd,"OpenFromMruCommandHandlerFactory",$g.a,[]);var hg=b(88),$f=b(84),th=b(241),ji=b(667),aj=b(1082),Uj=th.a;vm(Wc,Uj);Wc.prototype.execute=function(L){var oa=Object($f.a)(8,L.Ie);if(!oa.Gka)return td.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.Kmd(L),this.vh(xb.a.idle),1;this.wBb||(this.wBb=new aj.DownloadACopyOperation(this.mkc,
oa));this.wBb.Rhh();td.ULS.shipAssertTag(537154817,0,3!==dg.a(oa).yi.Ot,"The current activity should not be closed.");return 1};Wc.prototype.Kmd=function(L){var oa=Object($f.a)(8,L.Ie),Wa=new ji.a(oa);this.subscribe(L,this.sBd,function(Rb){Wa.add_disposing(Rb)});td.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Wa.initialize();Wa.mf()};Wc.prototype.dispose=function(){hg.a.Fa(this.wBb);this.wBb=null;Uj.prototype.dispose.call(this)};
Object(ve.a)(Wc,"DownloadAForkedCopyActivity",th.a,[]);var de=cg.a;vm(mc,de);mc.prototype.create=function(){var L=this;lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){L.Fb(new Wc(xb.a.D1a,xb.a.Bk,!0))},this.ma)};Object(ve.a)(mc,"DownloadACopyPreDatalossActivityFactory",cg.a,[]);var Se=cg.a;vm(yb,Se);yb.prototype.create=function(){var L=this;lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){L.Fb(new Wc(xb.a.unmergeableDownloadCopy,
xb.a.zoa))},this.ma)};Object(ve.a)(yb,"DownloadAForkedCopyActivityFactory",cg.a,[]);wc.prototype.Qg=function(){this.La.fc(Vf.a.tryMacOffice,kh.a.frame,Object(qf.a)(this,this.JUi,"onTryMacOffice"));this.La.fc(Vf.a.fbg,kh.a.frame,Object(qf.a)(this,this.cFf,"onTryMacOfficeFromViewer"));this.La.fc(Vf.a.ebg,kh.a.frame,Object(qf.a)(this,this.cFf,"onTryMacOfficeFromViewer"))};wc.prototype.JUi=function(L,oa,Wa,Rb,xc){if(1===Wa)return 32;xc?(L=xc.SourceControlId,"btnjTryMacOfficeForWordEditor"===L?ye.a.vf(eg.a.FZ(12),
"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===L&&ye.a.vf(eg.a.FZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.dlf();return 32};wc.prototype.cFf=function(L,oa,Wa){if(1===Wa)return 32;switch(L){case Vf.a.fbg:ye.a.vf(eg.a.FZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Vf.a.ebg:ye.a.vf(eg.a.FZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};wc.prototype.dlf=function(){var L=void 0===L?null:L;
var oa=0;L&&(oa=L);ye.a.vf(2===oa?"https://go.microsoft.com/fwlink/?LinkId=331579":wc.iyi,"_blank",void 0,"LaunchMacTrialWindow")};Sk.Object.defineProperties(wc.prototype,{Zwc:{configurable:!0,enumerable:!0,get:function(){return this.lrg&&Cf.a.isMac&&!Cf.a.Eli&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},Cyj:{configurable:!0,enumerable:!0,get:function(){return this.Zwc}}});Sk.Object.defineProperties(wc,{iyi:{configurable:!0,enumerable:!0,get:function(){return eg.a.rH("522401")}}});Object(ve.a)(wc,
"MacOfficeOffer",null,[792]);Wb.prototype.Qg=function(){this.La.fc(Vf.a.tryOffice,kh.a.frame,Object(qf.a)(this,this.KUi,"onTryOffice"));this.La.fc(Vf.a.tryOfficeThroughTellMe,kh.a.frame,Object(qf.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.fc(Vf.a.ibg,kh.a.frame,Object(qf.a)(this,this.jbg,"tryOfficeThroughViewer"));this.La.fc(Vf.a.hbg,kh.a.frame,Object(qf.a)(this,this.jbg,"tryOfficeThroughViewer"))};Wb.prototype.KUi=function(L,oa,Wa,Rb,xc){if(this.aXb&&1===Wa)return this.isFreemiumUpsellEnabled&&
this.BKb?32:8;2===Wa&&(xc?(L=xc.SourceControlId,"btnjTryOfficeForWordEditor"===L?ye.a.vf(eg.a.FZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===L?ye.a.vf(eg.a.FZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.kjc()):this.kjc());return 32};Wb.prototype.tryOfficeThroughTellMe=function(L,oa,Wa,Rb,xc){if(this.aXb&&1===Wa)return this.isFreemiumUpsellEnabled&&this.BKb?32:8;2===Wa&&(xc?(L=xc.SourceControlId,ye.a.vf(eg.a.rH("862405")+this.AVh(L),"_blank",
void 0,"TryOfficeThroughTellMe.WithSourceControlId")):ye.a.vf(eg.a.rH("522402"),"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};Wb.prototype.jbg=function(L,oa,Wa){if(this.aXb&&1===Wa)return this.isFreemiumUpsellEnabled&&this.BKb?32:8;if(2===Wa)switch(L){case Vf.a.ibg:ye.a.vf(eg.a.FZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Vf.a.hbg:ye.a.vf(eg.a.FZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};Wb.prototype.kjc=function(L){L=void 0===L?null:L;var oa=
0;L&&(oa=L);ye.a.vf(Wb.lTh(oa),"_blank",void 0,"LaunchOfficeOffer")};Wb.prototype.AVh=function(L){var oa=0;switch(L){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":oa=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":oa=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":oa=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":oa=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":oa=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":oa=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":oa=
7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":oa=8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":oa=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":oa=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":oa=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":oa=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":oa=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":oa=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":oa=
20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":oa=26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":oa=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":oa=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":oa=29}return 0===oa?"":String.format("&pc={0:D}",oa)};Wb.lTh=function(L){if(Cf.a.ah)switch(L){case 1:return eg.a.rH("393806");case 2:return eg.a.rH("393810");case 3:return eg.a.rH("393809");case 5:return eg.a.rH("393805")}else if(Cf.a.Vp)switch(L){case 1:return eg.a.rH("521979");
case 3:return eg.a.rH("521980");case 5:return eg.a.rH("521978");case 2:return eg.a.rH("522490")}else{if(2===L)return eg.a.rH("517778");if(1===L)return eg.a.FZ(30)}return eg.a.rH("522402")};Sk.Object.defineProperties(Wb.prototype,{Ttf:{configurable:!0,enumerable:!0,get:function(){return this.BKb}},kGi:{configurable:!0,enumerable:!0,get:function(){return this.BKb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},BKb:{configurable:!0,enumerable:!0,get:function(){return this.org&&!Cf.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,
enumerable:!0,get:function(){var L=!1;this.XEc&&(L=this.XEc.isFreemiumUpsellEnabled());return L}}});Object(ve.a)(Wb,"OfficeTrialExperience",null,[791]);tf.prototype.ji=function(L){L.register(Wb,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").Bc().Lc(function(){return new Wb(Od.AFrameworkApplication.Gb,Od.AFrameworkApplication.hzb,Od.AFrameworkApplication.lcid)});L.register(wc,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").Bc().Lc(function(){return new wc(Od.AFrameworkApplication.Gb,
Od.AFrameworkApplication.Igc,Od.AFrameworkApplication.lcid)})};Object(ve.a)(tf,"OpenInClientConfiguration",null,[5]);var Qi=b(1337),Nh=b(36),fg=b(1233),bi=b(275);Sk.Object.defineProperties(vc,{eg:{configurable:!0,enumerable:!0,get:function(){return wh.a.Cn(vc.Vj,CommonUIStrings.l_OICLaunchDialogTitle)}}});vc.Vj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(ve.a)(vc,"OICLaunchDialogHtml",null,[]);var Li=wh.a;vm(lf,Li);lf.prototype.w9a=function(){this.ACa=Ac("BtnRichClient",this.nq.asb,this.nq.wxb,this.nq.gld,CommonUIStrings.l_OICLaunchRichClient,Object(qf.a)(this,this.NCf,"onRichClientButtonClick"),Vd);document.getElementById("OICLaunchRichClient").appendChild(this.ACa);Bd(this.ACa);this.XUa=Ac("BtnReturn",this.nq.asb,this.nq.wxb,this.nq.V$e,CommonUIStrings.l_OICReturnToOnlineClient,Object(qf.a)(this,this.KCf,"onReturnButtonClick"),Vd);document.getElementById("OICReturnToApp").appendChild(this.XUa);
Bd(this.XUa)};lf.prototype.KCf=function(){this.hide();this.nq.Ibb();return!0};lf.prototype.NCf=function(){td.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();Od.AFrameworkApplication.Gb.processAction(Vf.a.OQa,2);return!0};lf.prototype.EGi=function(){this.nq.Ibb()};lf.prototype.dispose=function(){this.Opa||(this.ACa&&(bi.a.instance.za(mg.a.click,this.ACa,Object(qf.a)(this,this.NCf,"onRichClientButtonClick")),ef.KeyInputManager.instance.za(mg.a.Wd,this.ACa,Vd)),this.XUa&&
(bi.a.instance.za(mg.a.click,this.XUa,Object(qf.a)(this,this.KCf,"onReturnButtonClick")),ef.KeyInputManager.instance.za(mg.a.Wd,this.XUa,Vd)),Li.prototype.dispose.call(this),this.Opa=!0)};Object(ve.a)(lf,"OICLaunchDialog",wh.a,[]);Sk.Object.defineProperties(Re,{eg:{configurable:!0,enumerable:!0,get:function(){return wh.a.Cn(Re.Vj,CommonUIStrings.l_OICDialogTitle)}}});Re.Vj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(ve.a)(Re,"ProtocolLaunchingDialogV2Html",null,[]);var Rh=wh.a;vm(ke,Rh);ke.prototype.w9a=function(){var L=document.getElementById("Issues");if(L){hd("",this.nq.asb,this.nq.wxb,this.nq.gld,L);var oa=document.createElement("span");oa.className="WACDialogSectionTitle";oa.innerText=5===this.nq.RFf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;L.appendChild(oa);Bd(L);L.style.display="none"}Od.AFrameworkApplication.sa.Qa.kid?(this.WUa=Ac("GiveFeedback",this.nq.asb,
this.nq.wxb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(qf.a)(this,this.dnc,"onGiveFeedbackClick"),Object(qf.a)(this,this.Xyf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.WUa),Bd(this.WUa)):document.getElementById("ButtonGiveFeedback").style.display="none";0===Od.AFrameworkApplication.sa.Qa.editMode||Od.AFrameworkApplication.xfh?document.getElementById("ButtonEdit").style.display="none":(this.hfa=Ac("Edit",this.nq.asb,this.nq.wxb,
"",2===Od.AFrameworkApplication.sa.Qa.Pj?4===Od.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===Od.AFrameworkApplication.sa.Qa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(qf.a)(this,this.vxf,"onEditClick"),Object(qf.a)(this,this.Axf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.hfa),Bd(this.hfa));0===Od.AFrameworkApplication.sa.Qa.editMode&&
!Od.AFrameworkApplication.hzb&&L&&(L.style.display="none")};ke.prototype.sVe=function(){return this.tpa?(this.Hz(this.tpa),!0):!1};ke.prototype.qVe=function(){return this.hfa?(this.Hz(this.hfa),!0):!1};ke.prototype.Axf=function(L){return this.zzd(L,0)};ke.prototype.Xyf=function(L){return this.zzd(L,2)};ke.prototype.ICf=function(L){return this.zzd(L,1)};ke.prototype.zzd=function(L,oa){var Wa=!1;if(L.Ea.keyCode===si.a.$h||L.Ea.keyCode===si.a.Noa)L.Tb.click(),Wa=!0;else if(L.Ea.keyCode===Sys.UI.Key.down||
L.Ea.keyCode===Sys.UI.Key.up)switch(oa){case 1:Wa=this.qVe();break;case 0:Wa=this.sVe()}return Wa};ke.prototype.vxf=function(){this.hide();4===Od.AFrameworkApplication.sa.Qa.editMode?(td.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.nq.Ibb()):(td.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.nq.Pid());return!0};ke.prototype.dnc=function(){td.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.nq.V6e();return!0};ke.prototype.boc=
function(){td.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";Od.AFrameworkApplication.Gb.processAction(Vf.a.OQa,2);return!0};ke.prototype.NFd=function(){this.nq.Ibb()};ke.prototype.switchToBackupMode=function(){var L=document.getElementById("ProtocolLaunchingDialogTitle");if(L){L.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(L=document.getElementById("Issues"))L.style.display="block";(L=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&
!L.children.length&&(this.tpa=Ac("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(qf.a)(this,this.boc,"onRetryOICClick"),Object(qf.a)(this,this.ICf,"onRetryOICKeyUp")),L.appendChild(this.tpa),Bd(this.tpa),this.hfa||this.sVe())}};ke.prototype.dispose=function(){this.Opa||(this.hfa&&(bi.a.instance.za(mg.a.click,this.hfa,Object(qf.a)(this,this.vxf,"onEditClick")),ef.KeyInputManager.instance.za(mg.a.Wd,this.hfa,Object(qf.a)(this,this.Axf,"onEditKeyUp"))),this.WUa&&(bi.a.instance.za(mg.a.click,
this.WUa,Object(qf.a)(this,this.dnc,"onGiveFeedbackClick")),ef.KeyInputManager.instance.za(mg.a.Wd,this.WUa,Object(qf.a)(this,this.Xyf,"onGiveFeedbackKeyUp"))),this.tpa&&(bi.a.instance.za(mg.a.click,this.tpa,Object(qf.a)(this,this.boc,"onRetryOICClick")),ef.KeyInputManager.instance.za(mg.a.Wd,this.tpa,Object(qf.a)(this,this.ICf,"onRetryOICKeyUp"))),Rh.prototype.dispose.call(this),this.Opa=!0)};Object(ve.a)(ke,"ProtocolLaunchingDialog",wh.a,[]);var kj=b(429),Uh=Lg.StandardDialog;vm(od,Uh);od.prototype.dnc=
function(L){td.ULS.sendTraceTag(595342858,211,50,"Open give feedback dialog");this.Txf(L)};od.prototype.boc=function(){td.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");Od.AFrameworkApplication.Gb.processAction(Vf.a.OQa,2)};od.prototype.NFd=function(L){od.X7e?3===L?this.vUf():2===L||0===L?this.continueEditing():1===L&&this.BZg():2===L?this.vUf():(1===L||0===L)&&this.continueEditing()};od.prototype.BZg=function(){td.ULS.sendTraceTag(577783557,211,50,"Closing the document");Od.AFrameworkApplication.Gb.Ce(Vf.a.close,
2,kj.a)};od.prototype.vUf=function(){td.ULS.sendTraceTag(593602691,211,50,"OIC dialog retry");window.setTimeout(Object(qf.a)(this,this.boc,"onRetryOICClick"),0)};od.prototype.continueEditing=function(){4===Od.AFrameworkApplication.sa.Qa.editMode||Od.AFrameworkApplication.ga.ra("WordConsumptionViewToEditRedirectIsEnabled")&&1===Od.AFrameworkApplication.sa.mode?(td.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.nq.Ibb()):(td.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),
this.nq.Pid())};Sk.Object.defineProperties(od,{X7e:{configurable:!0,enumerable:!0,get:function(){return Od.AFrameworkApplication.ga.ra("OICDialogThreeActions")&&32===Od.AFrameworkApplication.Gb.processAction(Vf.a.close,1)}}});Object(ve.a)(od,"StandardProtocolLaunchingDialog",Lg.StandardDialog,[]);Object(ve.a)(Qd,"EditDocumentInClientParams",null,[]);Cd.X7c=function(L,oa,Wa,Rb,xc,id,rd,$d,Be,gg,Wg,Dh,ei,wj,Bj,Xj){rd=void 0===rd?!1:rd;$d=void 0===$d?!1:$d;Be=void 0===Be?"":Be;gg=void 0===gg?!1:gg;Wg=
void 0===Wg?!1:Wg;Dh=void 0===Dh?!1:Dh;ei=void 0===ei?"":ei;wj=void 0===wj?"":wj;Bj=void 0===Bj?"":Bj;Xj=void 0===Xj?!1:Xj;var Fi=new Qd;Fi.DocumentUrl=L;Fi.Mode=oa;Fi.Options=Wa;Fi.Application=Rb;Fi.SilentExternalHandler=rd;Fi.EncodeUrl=$d;Fi.CorrelationIdForWinClient=Be;Fi.NavigateUsingWindowOpen=gg;Fi.DescriptiveUnattemptedEnums=Wg;Fi.NoBrowserModalDialogs=Dh;Fi.SessionOrigin=ei;Fi.CorrelationId=wj;Fi.ClickTime=Bj;Fi.NewTelemetryDataIsEnabled=Xj;MSOJS.ClientUtils.EditDocumentInClient(Fi,xc,id)};
Object(ve.a)(Cd,"ClientUtils",null,[]);var bj=b(176),sg=b(961),Mf=b(75),Yh=b(178);Ec.prototype.pEi=function(){if(!Od.AFrameworkApplication.ga)return 0;switch((Od.AFrameworkApplication.ga.Ua(Od.AFrameworkApplication.Aea)||"").toLowerCase()){case "teams":var L=524288;break;case "onedrive":L=131072;break;case "owa":L=262144;break;case "assignments":L=65536;break;default:L=0}switch((Od.AFrameworkApplication.ga.Ua("FileSource")||"").toLowerCase()){case "exchangeonline":var oa=1;break;case "exchangeonlineconsumer":oa=
2;break;case "onedrivewopi":oa=4;break;case "sharepointonline":oa=8;break;default:oa=0}return oa|L};Ec.prototype.Yij=function(L,oa,Wa){return oa.contextId!==kh.a.frame?2:1===Wa?32:this.OQa()};Ec.prototype.qIj=function(){return!(2===this.application&&Od.AFrameworkApplication.ga.ra("IsEmbeddedScenario"))};Ec.prototype.closeApplication=function(){this.xUd||this.ezh()};Ec.prototype.Ibb=function(){this.tIj||this.szh()};Ec.prototype.oNf=function(L){this.qVj&&Cf.a.ah?new lf(this):this.P2b(L)};Ec.prototype.P2b=
function(L){L=this.Cri(L);var oa=L.returnValue;td.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===oa,L.uBa);return oa};Ec.prototype.sGa=function(L,oa,Wa,Rb,xc,id){this.cVa=L;this.C5d=oa;this.dga=id;this.application=Wa;this.NB=Rb;Od.AFrameworkApplication.downloadCopyOnOpenInClient?this.alf():Od.AFrameworkApplication.limitedEdit&&!Od.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?Od.AFrameworkApplication.O4f():this.XNg(xc)};Ec.prototype.OQa=function(){this.DGi&&this.uui();
return this.P2b(this.tib)};Ec.prototype.eYf=function(){var L=new sg.a(Jf.a.openInClient);L.Values["ui-language"]=Od.AFrameworkApplication.lcid.toString();L.Values[qc.a.e5c]=Od.AFrameworkApplication.userSessionId;return this.dga.value.send(L)?32:8};Ec.prototype.uui=function(){gh.Health.instance.recordQosError("UserClickedRetryOpenInDesktop",["OpenInClientFailed"],!1,!1,!1,!1,Object.assign(new le.a,{inStaging:!0}))};Ec.prototype.Ioj=function(L){var oa=new sg.a(Jf.a.HXj);oa.Values["ui-language"]=Od.AFrameworkApplication.lcid.toString();
oa.Values[qc.a.e5c]=Od.AFrameworkApplication.userSessionId;oa.Values[Dg.a.GXj]=L;this.dga.value.send(oa)};Ec.prototype.Cri=function(L){this.tib=L;this.Ioj(5===this.NB?Ec.jWi:Ec.lWi);return 5===this.NB?this.Bri():this.Gri()};Ec.prototype.Bri=function(){this.glf();return{returnValue:32,uBa:"HostEditUrl,"}};Ec.prototype.Gri=function(){var L,oa=L="";Od.AFrameworkApplication.Rme&&(oa="|f|"+Od.AFrameworkApplication.userSessionId);var Wa=Od.AFrameworkApplication.ga.ra("IsAssignmentMode")&&Od.AFrameworkApplication.ga.ra("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||
Od.AFrameworkApplication.isUnifiedHostMode||Cf.a.ala,Rb=Od.AFrameworkApplication.ga.ra("UnattemptedEnumIsEnabled"),xc=Od.AFrameworkApplication.ga.ra("NoBrowserModalDialogs");if(Od.AFrameworkApplication.Gb.Llc){var id=Od.AFrameworkApplication.Gb.KZ(3588168074);id&&(this.PVb=String.format("{0}{1}{2}",Ec.zpj.toString(),"_",this.pEi().toString()),this.JD=id.correlationId?id.correlationId:"",this.zQb=id.TriggerTime?id.TriggerTime:"")}if(Od.AFrameworkApplication.PIf){L+="NewOrder,";id=8;this.dga&&this.dga.value&&
this.dga.value.isEnabled()&&Od.AFrameworkApplication.cZd&&(L+="Post,",id=this.eYf());if(32===id)return{returnValue:id,uBa:L};td.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return Od.AFrameworkApplication.dm.d$a?(td.ULS.shipAssertTag(5566816,211,!!Od.AFrameworkApplication.dm.d$a),L+="HostUrl,",{returnValue:Od.AFrameworkApplication.sa.N8a(Od.AFrameworkApplication.dm.d$a),uBa:L}):this.cVa?(td.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",
Od.AFrameworkApplication.userSessionId),L+="DocUrl,",Cd.X7c(this.cVa,this.NB,this.options,this.application,Object(qf.a)(this,this.zxf,"onEditInClientSuccess"),Object(qf.a)(this,this.yxf,"onEditInClientFailure"),this.s5f,Od.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),oa,Wa,Rb,xc,this.PVb,this.JD,this.zQb,Od.AFrameworkApplication.Gb.Llc),{returnValue:32,uBa:L}):{returnValue:8,uBa:L}}L+="OldOrder,";if(!this.cVa&&Od.AFrameworkApplication.dm.d$a)return this.dga&&this.dga.value&&this.dga.value.isEnabled()&&
Od.AFrameworkApplication.cZd?(L+="Post,",oa=this.eYf()):(td.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),oa=8),32!==oa?(td.ULS.shipAssertTag(22595484,211,!!Od.AFrameworkApplication.dm.d$a),L+="HostUrl,",{returnValue:Od.AFrameworkApplication.sa.N8a(Od.AFrameworkApplication.dm.d$a),uBa:L}):{returnValue:oa,uBa:L};td.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",Od.AFrameworkApplication.userSessionId);L+="DocUrl,";
Cd.X7c(this.cVa,this.NB,this.options,this.application,Object(qf.a)(this,this.zxf,"onEditInClientSuccess"),Object(qf.a)(this,this.yxf,"onEditInClientFailure"),this.s5f,Od.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),oa,Wa,Rb,xc,this.PVb,this.JD,this.zQb,Od.AFrameworkApplication.Gb.Llc);return{returnValue:32,uBa:L}};Ec.prototype.vSf=function(L){Od.AFrameworkApplication.Mm.setDw(8981,L)};Ec.prototype.zxf=function(L){this.vSf(L);td.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");
6===L&&MSOJS.ClientUtils.ShouldShowDialog()?(this.t8f||this.glf(),this.Xvi()):this.xUd||this.closeApplication()};Ec.prototype.yxf=function(L,oa){oa=void 0===oa?0:oa;td.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",L,oa);if(5===L)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{var Wa=!!this.C5d&&!this.tib,Rb=0;1===L&&(Rb=2);6<=L&&13>=L&&(Rb=1,1===oa&&(this.xUd=!0));this.Kzc.kGi?(td.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",
Rb),fg.a.instance.p8g(this.tib?Object(qf.a)(this,this.juf,"oicErrorDialogHandlerCloseForced"):Object(qf.a)(this,this.kuf,"oicErrorDialogHandlerNoCloseForced"),Wa?Object(qf.a)(this,this.$zf,"onLaunchDownload"):null,this.sIe(!1)?Object(qf.a)(this,this.O8h,"iHaveOfficeButtonHandler"):null,Rb,oa)):(td.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",Rb),fg.a.instance.n8g(this.tib?Object(qf.a)(this,this.juf,"oicErrorDialogHandlerCloseForced"):Object(qf.a)(this,this.kuf,"oicErrorDialogHandlerNoCloseForced"),
Wa?Object(qf.a)(this,this.$zf,"onLaunchDownload"):null,Rb))}};Ec.prototype.Xvi=function(){try{var L=[Object.assign(new Mf.a,{name:"CorrelationId",string:this.JD}),Object.assign(new Mf.a,{name:"SessionOrigin",string:this.PVb}),Object.assign(new Mf.a,{name:"ClickTime",string:this.zQb}),Object.assign(new Mf.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];bj.a("OpenInClientCompleted",!0,0,L)}catch(oa){td.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+oa.toString())}};
Ec.prototype.glf=function(){Od.AFrameworkApplication.sa&&Od.AFrameworkApplication.sa.Qa.rw&&Od.AFrameworkApplication.ga.ra("StandardProtocolDialogIsEnabled")?new od(this):new ke(this)};Ec.prototype.juf=function(){this.closeApplication()};Ec.prototype.kuf=function(){this.Ibb()};Ec.prototype.$zf=function(){this.alf()};Ec.prototype.O8h=function(){return this.sIe(!0)};Ec.prototype.sIe=function(L){var oa=(Cf.a.mN||Cf.a.MH)&&!!Od.AFrameworkApplication.d6b;oa&&L&&(ye.a.vf(Od.AFrameworkApplication.d6b,"_blank",
void 0,"OpenInClient"),this.closeApplication());return oa};Sk.Object.defineProperties(Ec.prototype,{RFf:{configurable:!0,enumerable:!0,get:function(){return this.NB}},options:{configurable:!0,enumerable:!0,get:function(){var L=0;Od.AFrameworkApplication.Xgj&&(L|=1);Od.AFrameworkApplication.openInClientEditOnly&&(L|=4);this.qIj()&&(L|=64);return L}},asb:{configurable:!0,enumerable:!0,get:function(){return Od.AFrameworkApplication.KC}},wxb:{configurable:!0,enumerable:!0,get:function(){return Od.AFrameworkApplication.rxb}},
V$e:{configurable:!0,enumerable:!0,get:function(){return""}},gld:{configurable:!0,enumerable:!0,get:function(){return""}},t8f:{configurable:!0,enumerable:!0,get:function(){return Od.AFrameworkApplication.ga.ra("OneNoteMobileViewerIsEnabled")}},Kzc:{configurable:!0,enumerable:!0,get:function(){return this.Jce||(this.Jce=Qh.a.instance.resolve("Common.IOfficeTrialExperience"))}},DGi:{configurable:!0,enumerable:!0,get:function(){return!!Od.AFrameworkApplication.ga&&Od.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OicAshaLoggingIsEnabled",
!1)}}});Ec.lWi="OpenInDesktop";Ec.jWi="OpenInBrowser";Ec.zpj=Yh.a.lta("B5F65EF9-A5B1-4887-A968-C779537C8303");Object(ve.a)(Ec,"AOpenInClientOperation",null,[]);var Bi=b(196),Ih=b(200),Vg=b(114),ph=b(44),uj=b(42),cj=b(179),Vj=b(92),Jj=b(32),Gf=b(480),Oh=b(1178),Ej=b(607);vm(of,Ec);of.prototype.I0g=function(){this.oNf(this.FVe)};of.prototype.I2g=function(){var L=this,oa=this.$;lh.TaskExtensions.Ba(this.eK.value,function(Wa){L.sGa(oa.workbookContext.ClientUrl,Od.AFrameworkApplication.U3,1,oa.isEditMode?
2:0,!0,new Kf.a(function(){return Wa.result}))},this.ma,3)};of.prototype.Pid=function(){0!==ad.a.Rf.editMode&&(this.$.Ab.TC=!1)};of.prototype.V6e=function(){var L={};L[E.a.b9b]=!1;L[E.a.rZ]="OpenInExcel";this.$.xe(802602464,na.a.$b,8,L)};of.prototype.L2c=function(){var L=this;if(this.ea.qc){var oa=this.$;oa.isEditMode&&lh.TaskExtensions.Ba(this.eK.value,function(Wa){L.sGa(oa.workbookContext.ClientUrl,Od.AFrameworkApplication.U3,1,2,!1,new Kf.a(function(){return Wa.result}))},this.ma,3)}};of.prototype.uCe=
function(){var L=this;this.ea.qc&&lh.TaskExtensions.Ba(this.eK.value,function(oa){L.sGa(L.$.workbookContext.ClientUrl,Od.AFrameworkApplication.U3,1,L.$.isEditMode?2:0,!1,new Kf.a(function(){return oa.result}))},this.ma,3)};of.prototype.openInExcelClient=function(){var L=this;this.ea.qc&&(this.$.isEditMode||lh.TaskExtensions.Ba(this.eK.value,function(oa){L.sGa(L.$.workbookContext.ClientUrl,Od.AFrameworkApplication.U3,1,0,!1,new Kf.a(function(){return oa.result}))},this.ma,3))};of.prototype.openInBrowser=
function(){var L=this;this.ea.qc&&lh.TaskExtensions.Ba(this.eK.value,function(oa){L.sGa(L.$.workbookContext.ClientUrl,Od.AFrameworkApplication.U3,1,5,!1,new Kf.a(function(){return oa.result}))},this.ma,3)};of.prototype.downloadFile=function(L){var oa=this.uve(L);this.vaa.downloadFile(oa,L)};of.prototype.NFf=function(L,oa){oa=void 0===oa?0:oa;if(this.ea.qc){var Wa=this.$;dg.a(Wa).VLa?this.OFf(L,Wa):0<oa?this.nGj(L,Wa,oa):this.B3f(Wa)}};of.prototype.sGa=function(L,oa,Wa,Rb,xc,id){this.$.Ab.TC=!jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||
!this.$.nc.inWebPart;this.FVe=xc;this.Q2b=null;this.t7c=!1;this.bOg(L,oa,Rb,xc,id)};of.prototype.P2b=function(L){var oa=this.$.nc;td.ULS.sendTraceTag(537154775,0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",oa.inEmbedView,oa.inWebPart,oa.isDivSyndicated,this.$.isEditMode?Bi.a.edit:Bi.a.view);return of.bgf()?(this.o2b(),Cd.X7c(this.cVa,this.NB,this.options,1,this.IKi,this.HKi,!1,Od.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled")),32):
Ec.prototype.P2b.call(this,L)};of.prototype.ezh=function(){this.wTf();var L=this.$;if(!this.ea.nc.inWebPart&&this.ea.qc&&!L.isEditMode){var oa=new Vj.a(2145659238,na.a.$b,this.$.gd,0,null);this.mAe=ph.a.instance.create(function(){L.Ka.Xb(oa)},0,uj.a.mWi)}};of.prototype.dispose=function(){this.ea&&this.ea.lk(this.$c);hg.a.rc([this.Ma,this.mAe,this.xm]);this.$=this.ea=null};of.prototype.szh=function(){this.wTf()};of.prototype.alf=function(){var L=this;ph.a.instance.create(function(){L.$.Ka.Xb(new Vj.a(-2028960985,
na.a.$b,0,30,null))},0,uj.a.nWi,!0,!0)};of.prototype.XNg=function(L){var oa=this.$,Wa=dg.a(this.$).qd.activityState;Wa[Gf.a.hle]=!0;oa.isEditMode&&this.ea.qc?(this.o2b(),ii.a(oa).kt(new Ki.a(xb.a.fz,5,function(){oa.nI(!1);Wa[Oe.a.Yq]=xb.a.q2b;Wa[Gf.a.bAg]=L;Wa[fc.a.pbd]=!0;oa.isEditMode&&(Wa[fc.a.NT]=1,Wa[fc.a.tY]=!0,Wa[Te.a.fYb]=!0,Wa[Te.a.UTc]=!0);Wa[Gf.a.kle]=1455037301}))):this.oNf(L)};of.prototype.q6f=function(){var L=Od.AFrameworkApplication.U3;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.N8a(L,
!0)){var oa=this.$.ea.nc;td.ULS.sendTraceTag(537154773,0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",L,oa.inEmbedView,oa.inWebPart,oa.isDivSyndicated,this.$.isEditMode?Bi.a.edit:Bi.a.view)}}else this.vaa.downloadFile(L,-2028960985);this.t7c=!0;this.o2b()};of.prototype.Zri=function(){this.Kzc.Ttf&&this.Kzc.kjc(1)};of.prototype.$ri=function(){this.Kzc.Ttf&&Hh.HelperMethods.vf(eg.a.FZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};of.prototype.isi=
function(){Hh.HelperMethods.vf(eg.a.FZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};of.prototype.jsi=function(){Hh.HelperMethods.vf(eg.a.FZ(34),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};of.prototype.uve=function(L){var oa=new Sys.StringBuilder,Wa=this.$.workbookContext,Rb=this.$.ya;oa.append(this.$.Pda);oa.append(Rb.FileHandlerRelativeUri);oa.append("?id=");oa.append(encodeURIComponent(Ih.a.ZGb(Wa.WorkbookUri,"sc")));this.$.ea.qc&&(oa.append("&sessionId="),
oa.append(encodeURIComponent(this.$.ea.sessionId)));switch(L){case -974518828:oa.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:oa.append("&workbookType=FullWorkbook");break;case -1059172980:oa.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:oa.clear()}Vg.a.fGa(oa,Rb);return oa.toString()};of.prototype.p1g=function(){Qi.a.instance.zXg();var L=this.$.ya;MSOJS.ClientUtils.InitUrls(L.RoamingAppsX86RootUrl,L.RoamingAppsControlInstallerUrl,L.RoamingAppsFirefoxExtensionUrl)};
of.prototype.wTf=function(){var L=this.$;this.ea.qc||Qa.a.RFd(L,dg.a(L).qd);this.o2b();this.Q2b&&this.Q2b(this,this.t7c);L.frame.rt.am(this.$.frame.Naa());L.frame.rX.am(this.$.frame.Naa());L.Ab.TC=!1;tg.g(L).focus()};of.prototype.bOg=function(L,oa,Wa,Rb,xc){var id=this.$;Od.AFrameworkApplication.sa&&!of.bgf()&&(id.frame.rt.fn(id.frame.Naa()),id.frame.rX.fn(id.frame.Naa()));Ec.prototype.sGa.call(this,L,oa,1,Wa,Rb,xc)};of.prototype.o2b=function(){var L=this.$;dg.a(L).yi.activityName===xb.a.openInExcelClient&&
dg.a(L).qd.JJ()};of.prototype.$Aj=function(){var L=Qg.a.hd(1,0,668,669,0,1341525452,"OpenInExcelActiveXError");ii.a(this.$).nv([L])};of.prototype.nGj=function(L,oa,Wa){var Rb=this,xc=null,id=window.setTimeout(function(){dg.a(oa).zsc(xc);Rb.B3f(oa)},Wa);xc=function(){dg.a(oa).VLa&&(dg.a(oa).zsc(xc),window.clearTimeout(id),Rb.OFf(L,oa))};dg.a(oa).XUc(xc)};of.prototype.B3f=function(L){var oa=Qg.a.hd(1,1,0,683,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");ii.a(L).nv([oa])};of.prototype.OFf=
function(L,oa){var Wa=this;ii.a(oa).kt(new Ki.a(xb.a.fz,5,function(){oa.nI(!1);var Rb=dg.a(oa).qd,xc=Rb.activityState;xc[Oe.a.Yq]=xb.a.RJe;xc[Zf.a.hYb]=oa.ea.nc.hasUnsupportedFeaturesForEdit;xc[Ej.a.OTc]=L;Rb.At(Qg.a.paa(Wa.businessBar.f8c,[1437034227]))}))};of.bgf=function(){return 1<ad.a.getRegisteredEwaInstances().length};Sk.Object.defineProperties(of.prototype,{V$e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},ma:{configurable:!0,enumerable:!0,get:function(){this.xm=
this.xm||new cj.a;return this.xm.token}},gld:{configurable:!0,enumerable:!0,get:function(){return"excel32"}},t8f:{configurable:!0,enumerable:!0,get:function(){return this.ea.nc.inWebPart}}});Object(ve.a)(of,"OpenInExcelOperation",Ec,[745,3]);var Vh=cg.a;vm(ge,Vh);ge.prototype.create=function(){var L=this;if(this.$.da.Aa(55))this.Fb(this.$.da.Aa(55));else{var oa=yg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),Wa=yg.GetServiceTaskFactory.Wa(this.$.da,5,4,this.ub);lh.TaskExtensions.Ba(Xg.Task.WAA(oa,
Wa),function(){L.Fb(new of(L.$,new Kf.a(function(){return yg.GetServiceTaskFactory.create(L.$.da,137,L.ma,L.ub)}),Wa.result))},this.ma,3)}};ge.o1g=function(){ge.muf||(ge.muf=!0,(new tf).ji(Qh.a.instance),Qh.a.instance.resolve("Common.IOfficeTrialExperience").Qg(),Qh.a.instance.resolve("Common.IMacOfficeOffer").Qg())};ge.muf=!1;Object(ve.a)(ge,"OpenInClientFactory",cg.a,[]);var Nj=b(110),xk=b(390),ck=Nj.a;vm(kd,ck);kd.prototype.execute=function(L){var oa=Object($f.a)(8,L.Ie);lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.create(oa.da,
56,oa.ma,0),function(Wa){oa.downloadCopyOnOpenInClient?(L.activityState[xk.a.ile]=!0,Wa.result.q6f()):Wa.result.I2g()},oa.ma,3);return 1};Object(ve.a)(kd,"OpenInExcelClientActivity",Nj.a,[]);var ik=cg.a;vm(ie,ik);ie.prototype.create=function(){var L=this;lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){L.Fb(new kd(xb.a.openInExcelClient,xb.a.idle))},this.ma)};Object(ve.a)(ie,"OpenInExcelClientActivityFactory",cg.a,[]);var hj=th.a;vm(Zd,hj);Zd.prototype.initialize=
function(L){hj.prototype.initialize.call(this,L)};Zd.prototype.execute=function(L){this.zi=L;L=Object($f.a)(8,this.zi.Ie);this.erb(L);return 1};Zd.prototype.SI=function(L){hj.prototype.SI.call(this,L)};Zd.prototype.erb=function(){var L=this;this.subscribe(this.zi,this.DYi,function(oa){L.gDd.add_disposing(oa)})};Zd.prototype.aFb=function(L){this.unsubscribe(function(oa){L.remove_disposing(oa)});this.zi.activityState[Td.a.u2]=0};Object(ve.a)(Zd,"PasswordProtectedFileActivity",th.a,[]);var ui=b(371),
jk=ui.a;vm(mf,jk);mf.prototype.uab=function(L){this.Mpa=L};mf.prototype.v3=function(){var L={};L[ui.a.description]=pe.a.instance.fa(1923);L[ui.a.yma]=pe.a.instance.fa(1919);L[ui.a.dHf]=pe.a.instance.fa(1941);L[ui.a.bHf]=pe.a.instance.fa(1942);L[ui.a.cHf]=pe.a.instance.fa(1920);L[ui.a.tld]=pe.a.instance.fa(1926);L[ui.a.jte]=pe.a.instance.fa(1621);L[ui.a.RWj]=pe.a.instance.Va(25);L[ui.a.dgg]=Object(qf.a)(this,this.bUa,"verifySubmittedPassword");return L};mf.prototype.jta=function(){var L={};L[yf.a.$y]=
this.Ac;L[ui.a.uue]=this.v3();return L};mf.prototype.Ch=function(){this.jc=1;this.initializeAndShow(this.io,this.w6i,this.jta())};Sk.Object.defineProperties(mf.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"PasswordDialog"}},Rrb:{configurable:!0,enumerable:!0,get:function(){return this.Mpa}},io:{configurable:!0,enumerable:!0,get:function(){return pe.a.instance.fa(1922)}}});Object(ve.a)(mf,"PasswordProtectedFilePasswordInputDialog",ui.a,[]);var fj=b(303);vm(Sf,mf);Sf.prototype.uab=
function(L,oa){mf.prototype.uab.call(this,L,oa);td.ULS.sendTraceTag(537154755,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",L)};Sf.prototype.bUa=function(L,oa){this.passwordToModify=L;var Wa={};Wa.FileModifyPassword=Uf.a.pf(L);ia.ob(this.$.na.ta,Wa,this.gVi(oa),this.fVi(oa),null,null)};Sf.prototype.v3=function(){var L=mf.prototype.v3.call(this);L[ui.a.tld]=pe.a.instance.fa(1927);L[ui.a.description]=pe.a.instance.Va(24);return L};
Sf.prototype.Ch=function(){Ra.b().y8c("PasswordToModifyDialogShown");td.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");mf.prototype.Ch.call(this)};Sf.prototype.gVi=function(L){var oa=this;return function(Wa){Qg.a.kh(Wa.Errors,[-2019873242])&&oa.n6b(oa.Xqb());if(!Wa||fj.a(Wa))if(0<oa.ELd)oa.BMf(L);else{td.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",
Qg.a.Tc(Wa.Errors));oa.$.ea.np(Wa.Errors);oa.hide();return}oa.T9d=Wa.Result;oa.$gc&&(Ra.b().CTd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password","PasswordToModifyPasswordVerifiedTillInteractive"),td.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));L(oa.$gc?0:1)}};Sf.prototype.fVi=function(L){var oa=this;return function(){0<oa.ELd?oa.BMf(L):
(td.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),L(3))}};Sf.prototype.BMf=function(L){--this.ELd;this.bUa(this.passwordToModify,L)};Sf.prototype.Xqb=function(){return Qg.a.hd(1,0,1620,1621,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};Sk.Object.defineProperties(Sf.prototype,{$gc:{configurable:!0,enumerable:!0,get:function(){return this.T9d}},io:{configurable:!0,enumerable:!0,
get:function(){return pe.a.instance.fa(1924)}}});Object(ve.a)(Sf,"PasswordProtectedFileModifyPasswordInputDialog",mf,[]);vm(Qe,Zd);Qe.prototype.erb=function(L){this.gDd=new Sf(L);Zd.prototype.erb.call(this,L)};Qe.prototype.aFb=function(L,oa){var Wa=L.Rrb,Rb=L.$gc,xc=L.passwordToModify;Zd.prototype.aFb.call(this,L,oa);this.zi.Xxa([2001366804]);switch(Wa){case 1:Rb?(oa=Object($f.a)(8,this.zi.Ie),this.zi.activityState[Td.a.yle]=Uf.a.pf(xc),this.zi.activityState[Td.a.qYa]=!0,L.passwordToModify="",this.vh(oa.isEditMode?
xb.a.Qj:this.JM)):td.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");this.jp();break;case 0:this.zi.activityState[Td.a.Ls]=!1;this.vh(this.VJ);this.jp();break;default:td.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",Wa)}};Object(ve.a)(Qe,"PasswordProtectedFileModifyActivity",Zd,[]);var vj=
cg.a;vm(sd,vj);sd.prototype.create=function(){this.Fb(new Qe(this.activityName,this.JM,this.VJ))};sd.ja=function(L){L.da.Ha(434,new sd(xb.a.$Eb,xb.a.teb,xb.a.WGa,L))};Object(ve.a)(sd,"PasswordProtectedFileModifyActivityFactory",cg.a,[]);vm(be,mf);be.prototype.bUa=function(L,oa){this.password=L;oa(0)};be.prototype.v3=function(){var L=mf.prototype.v3.call(this);this.fjf&&(L[ui.a.smh]=1);return L};be.prototype.Ch=function(){td.ULS.sendTraceTag(537154722,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",
this.fjf);mf.prototype.Ch.call(this);ii.a(this.$).Ape()};Object(ve.a)(be,"PasswordProtectedFileOpenPasswordInputDialog",mf,[]);vm(me,Zd);me.prototype.erb=function(L){var oa=Qg.a.kh(this.zi.errors,[1217361942]);this.gDd=new be(L,oa);L.jfc||L.lIe();Zd.prototype.erb.call(this,L)};me.prototype.aFb=function(L,oa){var Wa=L.password;L.password="";var Rb=L.Rrb;Zd.prototype.aFb.call(this,L,oa);this.zi.activityState[Td.a.YTc]=Uf.a.pf(Wa);this.zi.activityState[Td.a.qYa]=!0;this.zi.Xxa([110414285,1217361942]);
td.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",Rb);switch(Rb){case 1:this.vh(this.JM);this.jp();break;case 0:this.vh(this.VJ),this.jp()}};Object(ve.a)(me,"PasswordProtectedFileOpenActivity",Zd,[]);var yj=cg.a;vm(nd,yj);nd.prototype.create=function(){this.Fb(new me(this.activityName,this.JM,this.VJ))};nd.ja=function(L){L.da.Ha(386,new nd(xb.a.rpc,xb.a.Qj,xb.a.Bk,L))};Object(ve.a)(nd,"PasswordProtectedFileOpenActivityFactory",
cg.a,[]);var Bh=b(381),kk=Bh.a;vm(rc,kk);rc.prototype.LO=function(L,oa){this.Mpa=L;kk.prototype.LO.call(this,L,oa)};rc.prototype.Ar=function(){kk.prototype.Ar.call(this);this.jc=9;var L=this.cTh();this.Fc(1,pe.a.instance.fa(1619));this.Fc(2,pe.a.instance.fa(963));this.Jk(pe.a.instance.fa(689),R.a.ym(L),this.icon,this.MO)};rc.prototype.cTh=function(){return String.format(pe.a.instance.fa(690))};Sk.Object.defineProperties(rc.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},
Rrb:{configurable:!0,enumerable:!0,get:function(){return this.Mpa}}});Object(ve.a)(rc,"LegacySharedWorkbookDialog",Bh.a,[]);var Zj=th.a;vm(Wd,Zj);Wd.prototype.initialize=function(L){Zj.prototype.initialize.call(this,L)};Wd.prototype.execute=function(L){this.zi=L;this.Y5g();return 1};Wd.prototype.SI=function(L){Zj.prototype.SI.call(this,L)};Wd.prototype.Y5g=function(){var L=Object($f.a)(8,this.zi.Ie),oa=Qg.a.c_a([-573864504]);oa[0].HelpDescription=pe.a.instance.fa(692);oa[0].HelpTopicId=Xd.a.Hsi;var Wa=
new rc(L,oa[0]);this.subscribe(this.zi,this.Gsi,function(Rb){Wa.add_disposing(Rb)})};Object(ve.a)(Wd,"LegacySharedWorkbookActivity",th.a,[]);var $c=cg.a;vm(rb,$c);rb.prototype.create=function(){this.Fb(new Wd(this.activityName,this.JM,this.VJ))};rb.ja=function(L){L.da.Ha(460,new rb(xb.a.UAb,xb.a.teb,xb.a.WGa,L))};Object(ve.a)(rb,"LegacySharedWorkbookActivityFactory",cg.a,[]);ld.prototype.Yc=function(){return!1};ld.prototype.Jc=function(L,oa){if(!jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",
!1))return!1;switch(oa.command){case 642419866:return!0;case 588342182:return this.presentModeManager.nz;default:return!1}};ld.prototype.executeCommand=function(L,oa){L=lh.TaskExtensions.om();oa=oa.command;switch(oa){case 642419866:this.presentModeManager.Fxc(!this.presentModeManager.nz);this.presentModeManager.sh("TogglePresentMode");break;case 588342182:this.presentModeManager.b7a=!this.presentModeManager.b7a;this.presentModeManager.B4f(this.presentModeManager.b7a,"TogglePresentModeOverlay");this.presentModeManager.sh("TogglePresentModeOverlay");
break;default:L=h.a(oa)}return L};ld.prototype.fd=function(){return!1};Object(ve.a)(ld,"PresentModeCommandHandler",null,[188]);var De=$g.a;vm(zc,De);zc.prototype.Od=function(){var L=this;lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.Wa(this.$.da,423,424,this.ub),function(oa){L.Fd([new ld(L.$,oa.result)])},this.ma,3)};zc.ja=function(L){$g.a.fe(420,new zc(L))};Object(ve.a)(zc,"PresentModeCommandHandlerFactory",$g.a,[]);var vi=b(121),yh=b(109);qd.Dsh="ewa-presentMode-overlay";qd.Esh="ewa-presentMode-panel-container";
qd.Fsh="ewa-presentMode-rowHdrParent-container";Object(ve.a)(qd,"CssClassNames",null,[]);var O=b(16),Fa=b(143),Gb=b(283),yc=b(126),Xc=b(119),xe=b(436),Ie=b(11),Xe=b(94),ff=b(341),zf=b(127),Yg=b(415),Hg=b(255),Gg=b(244),Zh=b(185);bc.prototype.dispose=function(){this.$=this.EEd=this.FEd=this.Pca=this.EPa=null};bc.prototype.dbi=function(){var L=this;window.requestAnimationFrame(function(){L.Pca=document.createElement("div");L.$.Vv.insertBefore(L.Pca,L.$.Vv.lastChild);L.Pca.id=L.$.Ib+E.a.R9b;L.Pca.classList.add(qd.Esh);
L.FEd=document.getElementById(L.$.Ib+E.a.O5c);L.EEd=[L.$.Qy];L.isInitialized=!0});this.EPa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.EPa.initializePresentModeFloatie()};bc.prototype.u_h=function(){var L={};L.PollingCountPerCaller=yh.a.toJSON(this.Qpc);L.PollingDurationPerCaller=yh.a.toJSON(this.Rpc);return L};bc.prototype.YRd=function(L){this.isInitialized?L?(this.EPa.showPresentModeFloatie(this.Pca,this.FEd,this.EEd),this.sh("ShowOrHideFloatiePanel"),
this.M9i()):(this.EPa.hidePresentModeFloatie(),this.sQj()):td.ULS.sendTraceTag(537154326,0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};bc.prototype.sh=function(L){this.cIf=Hh.HelperMethods.kc();this.APa=L;this.Nse=Zh.AsyncMethodContext.Zy(this.Il,100,uj.a.t1i+L,this.Nse)};bc.prototype.Ne=function(L,oa){if(oa)return!1;L=Ie.DOMElementExtensions.Cl(this.Pca.querySelectorAll(Ie.DOMElementExtensions.Rp));if(!L)return td.ULS.sendTraceTag(537154325,0,10,
"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),!1;L.focus();return!0};bc.prototype.Yf=function(L){return Ie.DOMElementExtensions.Oe(this.Jb,L)};bc.prototype.gi=function(){};bc.prototype.Qh=function(){};bc.prototype.M9i=function(){var L=this;Hg.a(this.$).Rg(this);this.$.da.Za(15,function(oa){L.ewaAccessibilityManager=oa;L.ewaAccessibilityManager.mode=5});ef.KeyInputManager.instance.qa(mg.a.Sb,this.Jb,this.onKeyDown)};bc.prototype.sQj=function(){Hg.a(this.$).Dz(this);
tg.g(this.$).F0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0);ef.KeyInputManager.instance.za(mg.a.Sb,this.Jb,this.onKeyDown)};bc.prototype.jlj=function(){var L=Hh.HelperMethods.kc()-this.cIf,oa=this.Rpc[this.APa]?this.Rpc[this.APa]:0;this.Rpc[this.APa]=oa>L?oa:L;this.Qpc[this.APa]=this.Qpc[this.APa]?this.Qpc[this.APa]+1:1};Sk.Object.defineProperties(bc.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return this.Pca}},canReceiveFocus:{configurable:!0,enumerable:!0,
get:function(){this.EPa.updatePresentModeFloatieShyState(2);return!!this.Pca}},Zd:{configurable:!0,enumerable:!0,get:function(){return Gg.a.oJf}}});Object(ve.a)(bc,"PresentModeFloatieManager",null,[669,112,3]);var Wi=b(58);Object(ve.a)(Ke,"OverlayCavityInfo",null,[]);Object(ve.a)(oe,"OverlayContainerInfo",null,[]);Object(ve.a)(se,"PresentModeOverlayProps",null,[]);Sd.prototype.Nbi=function(){var L=this;this.GEd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(function(){L.n_a=
Array(5);for(var oa,Wa,Rb=1;4>=Rb;Rb++)oa=document.createElement("div"),Ie.DOMElementExtensions.setVisible(oa,!1),oa.id=String.format("{0}-{1}","PresentModeOverlay",Rb),Ie.DOMElementExtensions.toggleCssClass(oa,qd.Dsh,!0),Wa=L.gridView.Sf(Rb).domElement,Wa.insertBefore(oa,Wa.firstChild),L.n_a[Rb]=oa})};Sd.prototype.A4f=function(L){L&&this.GTj();for(var oa=1;4>=oa;oa++)this.xgf(oa)&&Ie.DOMElementExtensions.setVisible(this.n_a[oa],L);Ie.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-overlay",
L)};Sd.prototype.GTj=function(){for(var L=this.VTg(),oa,Wa=1;4>=Wa;Wa++)oa=Wa,L[oa]&&this.GEd.showOverlayWithCavity(this.n_a[oa],L[oa])};Sd.prototype.dispose=function(){this.GEd=this.n_a=this.gridView=this.$=null};Sd.prototype.VTg=function(){for(var L,oa,Wa=tg.g(this.$).rtl,Rb,xc=Array(5),id=1;4>=id;id++)oa=id,this.xgf(id)&&(L=this.gridView.Sf(id),Rb=this.gridView.ha.Pa.i5?this.BQh(id,L,Wa):this.tRh(id,L,Wa),L=this.z8g(L),xc[oa]=this.S8g(this.n_a[oa].id,L,Rb));return xc};Sd.prototype.xgf=function(L){return this.gridView.$a.mK(L)};
Sd.prototype.z8g=function(L){return Object.assign(new oe,{width:L.pn.width,height:L.pn.height})};Sd.prototype.S8g=function(L,oa,Wa){return Object.assign(new se,{containerId:L,overlayContainerInfo:oa,overlayCavityInfos:Wa?[Wa]:null})};Sd.prototype.BQh=function(L,oa,Wa){var Rb=tg.g(this.$).ha.Pa.lc;if(!Rb)return td.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;var xc=Rb.extension.EQh(L);L=xc.SBa;Rb=xc.rotation;
var id=xc.translateX;var rd=xc.translateY;return xc.returnValue?(xc=L.x-oa.pn.x,Object.assign(new Ke,{left:(Wa?oa.pn.width-(xc+L.width):xc)-3+1,top:L.y-oa.pn.y-3+1,width:L.width+5,height:L.height+5,angle:Rb,translateX:id,translateY:rd})):null};Sd.prototype.tRh=function(L,oa,Wa){L=this.gridView.Nb.Aub(this.gridView.ha.va.activeRange,L)||Wi.a.d4;if(!L.zf(oa.pn))return null;var Rb=L.x-oa.pn.x;return Object.assign(new Ke,{left:Wa?oa.pn.width-(Rb+L.width)-2:Rb-3,top:L.y-oa.pn.y-3,width:L.width+5,height:L.height+
5})};Object(ve.a)(Sd,"PresentModeOverlayRenderer",null,[668,3]);var qi=ui.a;vm(Jd,qi);Jd.prototype.hide=function(){qi.prototype.hide.call(this);vi.a.pv(E.a.F4f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};Sk.Object.defineProperties(Jd.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(ve.a)(Jd,"PresentModeWelcomeDialog",ui.a,[]);Ue.requestFullscreen=function(L){L.webkitRequestFullscreen?L.webkitRequestFullscreen():L.msRequestFullscreen?
L.msRequestFullscreen():L.mozRequestFullScreen?L.mozRequestFullScreen():L.requestFullscreen?L.requestFullscreen():td.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};Ue.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():td.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};
Sk.Object.defineProperties(Ue,{vGh:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},wGh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":
"undefined"!==typeof document.mozFullScreenEnabled?"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},dji:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(ve.a)(Ue,"FullscreenUtils",null,[]);Me.prototype.Fxc=function(L){var oa=this;this.nz!==L&&(this.W9d=L,this.b7a=this.nz,this.ncf(),this.IKb=this.n3f(),window.requestAnimationFrame(function(){Ie.DOMElementExtensions.toggleCssClass(oa.$.dr,
"ewr-presentMode-transition",!0);$addHandler(oa.k2a,"transitionend",oa.uoa);oa.gCj(!L);oa.pXi();Ie.DOMElementExtensions.toggleCssClass(oa.$.dr,"ewr-presentMode-on",L);oa.fCj(L);Fa.b(oa.$).y4f(oa.nz);Fa.c(oa.$).y4f(oa.nz);oa.$.ana();oa.GPa.A4f(oa.IKb);if(oa.nz){oa.zZa();vi.a.get(E.a.F4f)?oa.Qca.YRd(oa.nz):oa.mqc=new Jd(oa.$,oa.Qca);var Wa=Yg.b(oa.$);Wa&&(oa.MLd=Wa.n8c(!1));oa.nJf=Hh.HelperMethods.kc()}else oa.Qca.YRd(L),oa.MLd&&(Wa=Yg.b(oa.$))&&(Wa.n8c(!0),oa.MLd=!1),oa.S5b(),oa.lwi()}))};Me.prototype.B4f=
function(L,oa){this.cSd=L;this.Eea(oa)};Me.prototype.sh=function(L){this.Qca.sh(L)};Me.prototype.dispose=function(){this.S5b();this.GPa&&(this.GPa.dispose(),this.GPa=null);this.gridView=this.$=null};Me.prototype.gCj=function(L){var oa=this.$.da.Aa(25);void 0===oa||null===oa?td.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):L?oa.zxc():oa.Adc()};Me.prototype.pXi=function(){var L=this;Ie.DOMElementExtensions.toggleCssClass(document.getElementById(Od.AFrameworkApplication.s2a),
O.a.Xo,this.nz);Ie.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-on",this.nz);this.jCj(this.nz);this.gridView.Jod=!this.nz;this.WTj();this.$.da.Za(32,function(oa){oa.pUj(L.nz)});Xc.b(this.$,function(oa){oa.Gdg(L.nz)})};Me.prototype.jCj=function(L){if(this.EFb)if(L){if(L=Object($f.a)(Xe.a,this.$.pa))Ie.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-on-headers-off",!L.headersVisible),Ie.DOMElementExtensions.toggleCssClass(this.$.dr,"ewr-presentMode-on-rtl",tg.g(this.$).rtl);
this.kBc(0)}else this.$.dr.classList.remove("ewr-presentMode-on-headers-off"),this.$.dr.classList.remove("ewr-presentMode-on-rtl"),this.kBc(1)};Me.prototype.kBc=function(L){var oa=Object($f.a)(Xe.a,this.$.pa);if(oa){var Wa=parseInt(this.$.Vv.style.right,10);if(1===L||2===L){if(isNaN(Wa)||Wa<this.U0a)return;Wa-=this.U0a}if(0===L||2===L)L=oa.headersVisible,oa=tg.g(this.$).rtl,L=L?oa?0:32:12,Wa=isNaN(Wa)?L:Wa+L,this.U0a=L;this.$.Vv.style.right=Hh.HelperMethods.Qb(Wa);this.lCe=Wa}};Me.prototype.WTj=function(){var L=
document.getElementById(this.$.Ib+E.a.s5b).parentNode;Ie.DOMElementExtensions.toggleCssClass(L,qd.Fsh,this.nz)};Me.prototype.initialize=function(L){this.GPa=new Sd(L);this.GPa.Nbi();this.Qca=new bc(L);this.Qca.dbi();this.k2a=document.getElementById("MainApp");this.kWe=this.ILi;$addHandler(this.k2a,Ue.vGh,this.kWe);$addHandler(this.k2a,Ue.wGh,this.JLi);this.EFb||(this.EFb=document.createElement("div"),this.EFb.className="ewa-presentMode-right-frame",this.$.Qy.appendChild(this.EFb));this.uoa=this.jbj};
Me.prototype.zZa=function(){this.gridView.ha.O9(this.tr);this.gridView.ha.I2(this.Yh);this.gridView.pc.Yl(this.fj);this.gridView.pc.Mo(this.Kg);this.gridView.cE(this.lp);this.gridView.view.Ms(this.yw);this.gridView.IYb(this.qya);this.gridView.Ca.KG(this.Fm);this.gridView.Ca.sq(this.Re);this.$.xa.Qf(this.ii);this.$.xa.CYa(this.oca);this.$.xa.$ga(this.gEb);this.$.nA(this.ej);this.$.Qk(this.rd);var L=Object($f.a)(ff.a,this.$.xa);L=yl(L.items);for(var oa=L.next();!oa.done;oa=L.next())oa.value.Cnb(this.Kya)};
Me.prototype.S5b=function(){this.gridView&&(this.gridView.ha.rda(this.tr),this.gridView.ha.m0(this.Yh),this.gridView.pc.ol(this.fj),this.gridView.pc.Pn(this.Kg),this.gridView.UF(this.lp),this.gridView.view.Nq(this.yw),this.gridView.usc(this.qya),this.gridView.Ca.oI(this.Fm),this.gridView.Ca.pp(this.Re));if(this.$){this.$.xa.ug(this.ii);this.$.xa.Wab(this.oca);this.$.xa.Tma(this.gEb);this.$.mD(this.ej);this.$.pl(this.rd);var L=Object($f.a)(ff.a,this.$.xa);L=yl(L.items);for(var oa=L.next();!oa.done;oa=
L.next())oa.value.OJd(this.Kya)}};Me.prototype.n3f=function(){if(!this.nz||!this.b7a)return!1;if(1===this.gridView.ha.Ve){var L=this.$.pa.activeRange.isSingle,oa=1===this.$.pa.selectedRanges.length&&!L,Wa=this.gridView.isEditing,Rb=this.Dqd;oa||td.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",L);return this.cSd&&oa&&!Wa&&!Rb}return this.cSd};Me.prototype.fCj=function(L){L?Ue.requestFullscreen(this.k2a):
Ue.exitFullscreen()};Me.prototype.Eea=function(L,oa,Wa){var Rb=this;Wa=void 0===Wa?!1:Wa;void 0!==oa&&oa||(this.IKb=this.n3f());td.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",L,this.IKb,Wa);if(this.yNb&&Wa)td.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",this.xNb),window.cancelAnimationFrame(this.xNb),this.xNb=0;else if(this.yNb){td.ULS.sendTraceTag(543023558,
0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",L);return}Wa?this.pYd(Hh.HelperMethods.kc(),L):(this.xNb=window.requestAnimationFrame(function(xc){Rb.pYd(xc,L)}),this.yNb=!0)};Me.prototype.pYd=function(L,oa){var Wa=this,Rb=Hh.HelperMethods.kc();if(Rb-L>this.Vlj)this.xNb=window.requestAnimationFrame(function(id){Wa.pYd(id,oa)}),this.yNb=!1,td.ULS.sendTraceTag(537154319,0,50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",Rb-
L);else{this.GPa.A4f(this.IKb);this.yNb=!1;var xc=Hh.HelperMethods.kc();L=Hh.HelperMethods.kc()-L;Rb=xc-Rb;this.Ykj(L,oa);td.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",Rb,L)}};Me.prototype.ncf=function(){var L=this;Pb.a(this.$.userOperationManager,function(oa,Wa,Rb){var xc=L.$.na.ta,id=L.nz,rd=xc.Na(41,null);rd.shouldEnablePresentMode=id;return ia.i(xc,"SetPresentMode",rd,oa,Wa,Rb,null,0)},function(oa){return new Jc.a(252,
0,oa)},null)};Me.prototype.gWf=function(){var L=xe.a(this.gridView.Ve);1!==this.gridView.Ve||this.$.pa.activeRange.isSingle||(L="Range");this.Wuc[L]=this.Wuc[L]?this.Wuc[L]+1:1};Me.prototype.Ykj=function(L,oa){var Wa=this.$oc[oa]?this.$oc[oa]:0;this.$oc[oa]=Wa>L?Wa:L;this.Zoc[oa]=this.Zoc[oa]?this.Zoc[oa]+1:1};Me.prototype.lwi=function(){var L={},oa=Hh.HelperMethods.kc()-this.nJf;L.PresentModeDuration=oa;L.SelectionCountPerObject=yh.a.toJSON(this.Wuc);L.OverlayCountPerCaller=yh.a.toJSON(this.Zoc);
L.OverlayDurationPerCaller=yh.a.toJSON(this.$oc);oa=this.Qca.u_h();for(var Wa in oa)L[Wa]=oa[Wa];zf.b(this.$).ee(yc.a.s1i,L,void 0,!0)};Sk.Object.defineProperties(Me.prototype,{nz:{configurable:!0,enumerable:!0,get:function(){return this.W9d}}});Object(ve.a)(Me,"PresentModeManager",null,[659,3]);var qj=b(335),rj=cg.a;vm(Ad,rj);Ad.prototype.create=function(){var L=this,oa=yg.GetServiceTaskFactory.Wa(this.$.da,283,284,1);lh.TaskExtensions.Ba(oa,function(){lh.TaskExtensions.Ba(qj.c(oa.result.Un.loadScript("presentMode")),
function(){var Wa=L.$.da.Aa(423);Wa||(Wa=new Me(L.$),L.$.da.Ha(423,Wa));L.Fb(Wa)},L.$.ma,3)},this.$.ma,3)};Ad.ja=function(L){L.da.Ha(424,new Ad(L))};Object(ve.a)(Ad,"PresentModeManagerFactory",cg.a,[]);var ij=b(169),Ig=b(158),Oj=b(675),Kj=b(83),Ti=b(28);xd.gth="ewa-resizehdr-row-hidden";xd.fth="ewa-resizehdr-col-hidden";Object(ve.a)(xd,"CssClassNames",null,[]);var Ii=b(60),Gj=b(24),lk=b(141),mk=b(53),Ci=b(69),ri=b(246),yk=b(372);Object(ve.a)(fd,"HeaderEventCachedInfo",null,[]);Qb.prototype.LCe=function(L){return Math.max(0,
Math.min(Qb.fqf,Hh.HelperMethods.HDd(L)))};Qb.prototype.CCe=function(L){return this.QZi(L)};Qb.prototype.l_g=function(L){return Math.round(this.J7c*L+2*this.PZe()+1)};Qb.prototype.QZi=function(L){return Math.max(0,Math.min(Qb.Ppf,(Math.max(0,Math.min(Mg.a.Gkc,L))-2*this.PZe()-1)/this.J7c))};Qb.prototype.PZe=function(){return Math.floor(Math.max((this.J7c+3)/4,2))};Qb.prototype.qbc=function(L,oa){return oa?L?Qb.fqf:Mg.a.Zvd:L?Qb.Ppf:Mg.a.Gkc};Qb.fqf=409;Qb.Ppf=255;Object(ve.a)(Qb,"ResizeHeadersConverter",
null,[]);var rk=b(34),al=Kj.a;vm(Zc,al);Zc.prototype.KOa=function(L,oa,Wa){this.h1i(L,oa,Wa);L=this.Lxc();this.Ycd(this.ISa,L,!0);this.Vza||(ij.a.instance.qa(mg.a.fh,this.domElement.ownerDocument.body,this.Zzd),this.Vza=!0)};Zc.prototype.dispose=function(){this.I0c();this.grid.ha&&(this.grid.ha.qda(this.Yh),this.grid.ha.rda(this.tr));this.grid.pt(this.Yh);ii.a(this.grid.$)&&ii.a(this.grid.$).sg.Uma(this.GF);bi.a.instance.za(mg.a.hk,this.domElement,this.rca);ij.a.instance.za(mg.a.Yd,this.domElement.ownerDocument.body,
this.Smc);Ig.a.instance.za(mg.a.ye,this.domElement.ownerDocument.body,this.Smc);Cf.a.Xp||(ij.a.instance.za(mg.a.pointerDown,this.domElement,this.WN),ij.a.instance.za(mg.a.fh,this.domElement,this.YR));this.Vza&&(ij.a.instance.za(mg.a.fh,this.domElement.ownerDocument.body,this.q9a),Ig.a.instance.za(mg.a.xg,this.domElement.ownerDocument.body,this.q9a),this.Vza=!1);this.nG&&(ij.a.instance.za(mg.a.pointerDown,this.nG,this.WN),bi.a.instance.za(mg.a.hk,this.nG,this.rca),this.I0c(),this.nG=null);this.YTf&&
(Ie.DOMElementExtensions.Tf(Zc.Gbb),Zc.Gbb=null);this.qf=null;al.prototype.dispose.call(this)};Zc.prototype.j9i=function(){bi.a.instance.qa(mg.a.hk,this.domElement,this.rca);ij.a.instance.qa(mg.a.Yd,this.domElement.ownerDocument.body,this.Smc);Ig.a.instance.qa(mg.a.ye,this.domElement.ownerDocument.body,this.Smc);Cf.a.Xp||(ij.a.instance.qa(mg.a.pointerDown,this.domElement,this.WN),ij.a.instance.qa(mg.a.fh,this.domElement,this.YR))};Zc.prototype.cmh=function(){if(!Zc.Gbb){document.getElementById(Zc.XTf);
this.YTf=!0;var L=Zc.Gbb=document.createElement("div");this.grid.$.frame.Naa().appendChild(L);L.id=Zc.XTf;L.className=Ti.a.hth;Ie.DOMElementExtensions.setVisible(L,!1)}};Zc.prototype.PLe=function(){this.Vza&&(ij.a.instance.za(mg.a.fh,this.domElement.ownerDocument.body,this.q9a),Ig.a.instance.za(mg.a.xg,this.domElement.ownerDocument.body,this.q9a),this.Vza=!1);this.Eba=!1;this.bjj();this.UId();yk.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};Zc.prototype.bjj=function(){this.grid.Nb.ll([this.isRow?
13:14]);this.grid.Nb.qdb()};Zc.prototype.Zzd=function(){return!0};Zc.prototype.Ycd=function(L,oa,Wa){this.eN&&Wa&&(td.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.UId());this.eN||Wa||td.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.xud&&this.xud(function(){var Rb={};return Rb.Location=
"canvas",Rb});this.eN?this.jXe(oa):(this.eN=document.createElement("div"),this.eN.id=this.e7h,this.jXe(oa),this.eN.className=Ti.a.arh,oa=document.getElementById(this.grid.$.Ib+E.a.Jrf),oa.insertBefore(this.eN,oa.firstChild),L=rk.a(this.grid.$).Oja(L),this.eN.style.left=(this.rtl?Math.max(L.x-this.eN.offsetWidth,0):L.x-Math.max(L.x+this.eN.offsetWidth-oa.offsetWidth,0)).toString()+"px",oa=document.getElementById(E.a.eGa),this.eN.style.top=(L.y-(Od.AFrameworkApplication.sa&&Od.AFrameworkApplication.sa.Qa.ph?
0:oa.offsetHeight)-this.eN.offsetHeight).toString()+"px")};Zc.prototype.UId=function(){Ie.DOMElementExtensions.Tf(this.eN);this.eN=null};Zc.prototype.jXe=function(L){var oa=new Qb(this.grid.$.workbookContext.DxDigitNormal);this.eN.innerText=String.format("{0} {1} ({2} {3})",this.isRow?this.a7h:this.j7h,this.isRow?oa.LCe(L).toFixed(2):oa.CCe(L).toFixed(2),L.toString(),this.d7h)};Zc.prototype.$If=function(L,oa){var Wa;if(-1!==this.grid.ha.selectionType||2===L.yb&&L.Ea.button!==Sys.UI.MouseButton.leftButton||
!this.Lrd(Wa=this.jfd(L))||!this.ohf)return!1;Ci.g(L.Ea);this.ISa=this.G7a=new Sys.UI.Point(L.clientPoint.x,L.clientPoint.y);this.pTg(Wa,oa);if(!this.vq)return!1;this.Eba=!0;this.Ami(this.vq,Wa)&&this.Z$h();return this.aJf(oa)};Zc.prototype.h1i=function(L,oa,Wa){this.vq=L;this.ISa=this.G7a=new Sys.UI.Point(oa,Wa);this.aJf(!1)};Zc.prototype.aJf=function(L){var oa={};zf.b(this.grid.$).ee(yc.a.Thj,(oa.IsResizingHiddenHeader=this.rWa,oa.IsAutoFitting=L,oa.NumberOfSelectedRanges=this.grid.ha.va.TK,oa.Location=
"canvas",oa));this.CIb=this.grid.Sx?this.rPh():this.wed();this.offset=this.vq.Vaa();this.em=this.vq.Gja();if(this.em===Mg.a.I5a)return!1;yk.c(this.grid.$,!1,"HeaderResizeBehavior:prepareResizeOperationInternal");return!0};Zc.prototype.Ami=function(L,oa){var Wa=this.vq.dK();if(!Wa)return td.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),!1;Wa=Wa.nextSibling;if(!Wa)return!1;L=L.getRange();Wa=this.qf.fva(Wa).getRange();if(!L||!Wa)return td.ULS.shipAssertTag(537154048,
2,!1,"IsResizingHidden: range is null"),!1;var Rb=jf.EwaSettings.isChangeGateEnabled("OfficeVSO:6101474_EnableUnhideRowByMouseDrag");L=Rb&&this.isRow?L.bottom:L.right;Wa=Rb&&this.isRow?Wa.bottom:Wa.right;return L+1!==Wa&&L!==Wa&&this.Lrd(oa,!0)};Zc.prototype.Z$h=function(){var L=this.vq.dK(),oa=this.qf.fva(L.nextSibling);Zc.Bmi(oa,this.isRow)?(this.vq=oa,this.c7=this.vq.getRange()):(this.tBg(L),this.vq=oa,L=this.vq.getRange(),this.c7=this.isRow?new Gj.Range(L.top-1,L.left,L.top-1,L.right,!1,!0):new Gj.Range(L.top,
L.left-1,L.bottom,L.left-1,!1,!0),this.rWa=!0)};Zc.prototype.tBg=function(L){var oa=this.qf.fva(L.nextSibling),Wa=Zc.a7g(oa,this.isRow,this.rtl);Wa&&L.parentNode.insertBefore(Wa,oa.dK())};Zc.prototype.V2e=function(L){var oa=this.c7,Wa=L.ha.va.selectedRanges;if(L.ha.va.fsb(oa))if(this.isRow){if(va.a.all(Wa,function(Rb){return Rb.isRow}))return Wa}else if(va.a.all(Wa,function(Rb){return Rb.Sh}))return Wa;return[oa]};Zc.prototype.rPh=function(){return this.vq.Gja()-Zc.Dcc};Zc.prototype.wed=function(){var L=
this.vq.dK().style;return Math.max(0,Math.min(this.Rpf,0|parseInt(this.isRow?L.height:L.width,10)))};Zc.prototype.Lxc=function(L){L=void 0===L?0:L;var oa=this.grid,Wa=this.qf.wj.paneType;Wa=this.isRow?3===Wa?[3,2]:[1,4]:4===Wa?[2,4]:[1,3];var Rb=oa.view.visibleArea.bottomRight,xc=this.vq.Gja();xc===Mg.a.I5a&&(xc=0);L=this.rWa?Math.max(this.wed(),0):Math.max(xc+L,0);Rb=this.isRow?new Wi.a(0,this.offset,Rb.x,L):new Wi.a(this.offset,0,L,Rb.y);xc=[this.isRow?13:14];oa.Nb.Nl(Gj.Range.kd(1,1),xc,!1);oa.Nb.ys(xc,
Rb,Wa);return L};Zc.prototype.I0c=function(){this.c7=this.ISa=this.G7a=null;if(this.S0){var L=this.S0.parentNode;if(L)for(L.removeChild(this.S0);this.S0.firstChild;)L.appendChild(this.S0.firstChild);this.S0=null}this.vq=null;Ie.DOMElementExtensions.setVisible(Zc.Gbb,!1);this.Eba=!1;this.UId();Ie.DOMElementExtensions.setVisible(this.nG,!1)};Zc.prototype.jfd=function(L){if(Ie.DOMElementExtensions.lz(L.Tb,"a"))return null;var oa=this.Kif(L.Ea);if(oa&&this.grid.ha.va.qh){var Wa=this.grid.ha.va.Sd;Wa=
this.qf.Vs(Gj.Range.kd(Wa.bottom,Wa.right))}else Wa=this.qf.fva(L.Tb);if(!Wa)return null;var Rb=Wa.dK(),xc=new Sys.UI.Bounds(Rb.offsetLeft,Rb.offsetTop,Rb.offsetWidth,Rb.offsetHeight),id=Ie.DOMElementExtensions.getBoundingClientRect(L.Tb);id=new Sys.UI.Point(L.clientPoint.x-id.x,L.clientPoint.y-id.y);this.isRow&&!oa&&(id.y+=Hh.HelperMethods.YA(L.Tb,Rb,this.rtl).y);return new fd(Rb,id,xc,Wa.getRange(),Math.max(Zc.lBi,Math.min(Zc.Yzi,(this.isRow?xc.height:xc.width)*Zc.cij)),oa,!this.isRow&&0<Rb.getElementsByTagName("input").length)};
Zc.prototype.Lrd=function(L,oa){oa=void 0===oa?!1:oa;if(!L||this.grid.isEditing)return!1;if(L.Jif)return!0;var Wa=L.tOa,Rb=L.Fbb,xc=this.qf.wj.paneType,id=this.grid.Sf(xc).Kh,rd=!!id&&id.top===L.Kjd.top,$d=!!id&&id.left===L.Kjd.left;xc=!!id&&id.bottom===L.Kjd.bottom&&(3===xc||2===xc);this.isRow?($d=L.bCb.y,L=$d<=Rb&&!rd,Wa=$d>=Wa.height-Rb-(xc?Zc.oGh:0),oa=oa?L:Wa||L):(xc=L.i6h,rd=this.rtl,id=L.bCb.x,L=id<=Rb&&(!$d||rd)&&(!xc||!rd),Wa=id>=Wa.width-Rb&&(!rd||!$d)&&(!xc||rd),oa=oa?rd?Wa:L:L||Wa);return oa};
Zc.prototype.pTg=function(L,oa){var Wa=this.isRow;if(L.Jif)this.vq=this.qf.fva(L.Uva);else if(Wa&&L.bCb.y<=L.Fbb&&L.tOa.height>L.Fbb||!Wa&&L.tOa.width>L.Fbb&&(!this.rtl&&L.bCb.x<=L.Fbb||this.rtl&&L.bCb.x>=L.tOa.width-L.Fbb)){if(this.vq=L.Uva.previousSibling?this.qf.fva(L.Uva.previousSibling):this.TSh(),oa&&L.Uva.classList.contains(Wa?Ti.a.NRe:Ti.a.MRe)&&(L=this.qf.fva(L.Uva)))L=L.getRange(),this.c7=Wa?new Gj.Range(L.top-1,L.left,L.top-1,L.right,!1,!0):new Gj.Range(L.top,L.left-1,L.bottom,L.left-1,
!1,!0)}else this.vq=this.qf.fva(L.Uva);!this.c7&&this.vq&&(this.c7=this.vq.getRange())};Zc.prototype.TSh=function(){var L=this.isRow?1:0;return(L=this.qf.wj.qG(this.qf.wj.Ca.Hg(this.grid.$.pa,Ii.a.GM(this.qf.position.X+L-1,this.qf.position.Y-L,this.qf.position.PaneType))))?L.SSh():null};Zc.prototype.aci=function(){var L=this.dij;Ie.DOMElementExtensions.setVisible(L,!0);L.style.cursor=this.isRow?Ti.a.YOe:Ti.a.qNe;this.Lxc()};Zc.prototype.ulh=function(L){var oa={};this.grid.$.xe(this.isRow?745189930:
-445963340,na.a.$b,30,(oa.resizeRowColumnParameters=L,oa))};Zc.prototype.S$g=function(){var L=document.createElement("div");L.className=Ti.a.guh;var oa=document.createElement("div");oa.className=O.a.gr;L.appendChild(oa);var Wa=document.createElement("img");Wa.src=mk.a.Ee(0);Wa.className=this.isRow?O.a.eth:O.a.$sh;oa.appendChild(Wa);this.qf.tA.domElement.parentNode.insertBefore(L,this.qf.tA.domElement);ij.a.instance.qa(mg.a.pointerDown,L,this.WN);bi.a.instance.qa(mg.a.hk,L,this.rca);Ie.DOMElementExtensions.setVisible(L,
!1);this.nG=L};Zc.prototype.jsc=function(){this.I0c();this.nG&&(this.qf.tA.domElement.parentNode.removeChild(this.nG),this.nG=null)};Zc.prototype.Kif=function(L){return Ie.DOMElementExtensions.Oe(this.nG,L.target)};Zc.prototype.Bpb=function(){this.Eba&&(this.PLe(),Ie.DOMElementExtensions.KTa(this.vq.dK(),!this.isRow,this.CIb),this.jsc(),this.rWa=!1)};Zc.prototype.Sef=function(){return jf.EwaSettings.la(707)};Zc.prototype.N$e=function(L){(L=L.Ea.rawEvent)&&L.detail===Zc.Mmj&&(L.type===mg.a.aq?(this.Eba=
!1,this.MXc=!0):L.type===mg.a.eI&&(this.Eba=!0,this.MXc=!1))};Zc.X6g=function(L,oa){return new Zc(L,oa)};Zc.dPd=function(L,oa,Wa){if(oa)for(L.ColumnWidth=-1,L.RowHeight=Wa,L=yl(L.SheetMultiRange.Ranges),oa=L.next();!oa.done;oa=L.next())oa=oa.value,oa.FirstColumn=0,oa.LastColumn=0;else for(L.RowHeight=-1,L.ColumnWidth=Wa,L=yl(L.SheetMultiRange.Ranges),oa=L.next();!oa.done;oa=L.next())oa=oa.value,oa.FirstRow=0,oa.LastRow=0};Zc.Bmi=function(L,oa){if(!L||!L.dK())return td.ULS.shipAssertTag(537154014,
2,!1,"header after hidden headers is null"),!1;var Wa=L.getRange();L=L.dK().style;if(!Wa||!L)return td.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;L=oa?L.height:L.width;return(oa?Wa.top:Wa.left)===(oa?Mg.a.Lh:Mg.a.Xh)&&L===Zc.Ahg};Zc.a7g=function(L,oa,Wa){if(!L)return td.ULS.shipAssertTag(537154012,2,!1,"header after hidden is null"),null;var Rb=L.dK();if(!Rb||!Rb.style)return td.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;L=document.createElement("div");
var xc=Rb.style;L.style.top=oa?xc.top:Zc.Ahg;oa||(Wa?L.style.right=xc.right:L.style.left=xc.left);L.classList.add(oa?xd.gth:xd.fth);L.classList.add(oa?Ti.a.jtb:Ti.a.itb);Wa=document.createElement("div");Wa.classList.add(oa?Ti.a.BRe:Ti.a.t$c);Rb=oa?Number.parseInvariant(Rb.innerText):Gj.Range.b0a(Rb.innerText);Wa.innerText=oa?(Rb-1).toString():Gj.Range.vU(Rb-1);L.appendChild(Wa);return L};Sk.Object.defineProperties(Zc.prototype,{ohf:{configurable:!0,enumerable:!0,get:function(){var L=(new lk.a(this.grid.$.xa)).te(this.isRow?
16:8),oa=this.grid.$.Ab.TC,Wa=this.grid.Ci,Rb=ii.a(this.grid.$).Dq();return L&&!oa&&!Wa&&!Rb}},dij:{configurable:!0,enumerable:!0,get:function(){this.cmh();return Zc.Gbb}}});Zc.lBi=0;Zc.Yzi=5;Zc.Dcc=1;Zc.oGh=3;Zc.cij=.1;Zc.XTf="ewa-rszrbg";Zc.Ahg="0px";Zc.Mmj=2;Zc.Gbb=null;Object(ve.a)(Zc,"HeaderResizeBehavior",Kj.a,[658]);var Tk=cg.a;vm(jd,Tk);jd.prototype.create=function(){this.Fb(Zc.X6g)};jd.ja=function(L){L.da.Ha(136,new jd)};Object(ve.a)(jd,"HeaderResizeBehaviorFactory",cg.a,[]);var Ik=b(418),
Fj=b(521),Bk=b(67);Object(ve.a)(md,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[147]);Object(ve.a)(jc,"MacroRecorderSheetRowsColumnsResizedPayload",null,[147]);var Ck=ui.a;vm(Yb,Ck);Yb.prototype.tV=function(L,oa){var Wa={};return Wa[Yb.a5]=this.Ac,Wa[Yb.Nmi]=this.isRow,Wa[Yb.wai]=L,Wa[Yb.vai]=oa,Wa[Yb.Oji]=this.Hzb,Wa[Yb.xfd]=this.mvb,Wa};Yb.prototype.QTg=function(){var L=this.tJh();try{return this.QNh(L)}finally{L&&L.dispose()}};Yb.prototype.D4g=function(L){var oa={};oa.SheetMultiRange=Ef.r(this.gridView.ha.va.selectedRanges,
this.$);Yb.dPd(oa,this.isRow,L);L={};this.$.xe(this.isRow?745189930:-445963340,na.a.$b,8,(L.resizeRowColumnParameters=oa,L))};Yb.prototype.O4e=function(L,oa){return Ib.a.s5(L)?oa?this.p3g(L):this.r3g(L):Yb.pba};Yb.prototype.r3g=function(L){return Math.floor(parseFloat(L))};Yb.prototype.p3g=function(L){L=parseFloat(L);return 0>L?Yb.pba:L?this.isRow?Hh.HelperMethods.YZi(L):this.Etc.l_g(L):0};Yb.prototype.s3g=function(L){return L===Yb.pba?"":this.isRow?this.Etc.LCe(L).toString():this.Etc.CCe(L).toFixed(2)};
Yb.prototype.q3g=function(L){return L===Yb.pba?"":L.toString()};Yb.prototype.QNh=function(L){if(!L||!L.$$mn()||!L.ho)return Yb.pba;var oa=Object($f.a)(248,L.ho);if(!oa)return Yb.pba;for(oa=this.isRow?oa.Jxb:oa.Mld;L.$$mn();){var Wa=Object($f.a)(248,L.ho);if(Wa&&(this.isRow?Wa.Jxb:Wa.Mld)!==oa)return Yb.pba}return oa};Yb.prototype.tJh=function(){for(var L=[],oa=yl(this.gridView.ha.va.selectedRanges),Wa=oa.next();!Wa.done;Wa=oa.next()){Wa=Wa.value.clone();var Rb=this.gridView.Sf(this.gridView.$a.oj(Wa));
Rb=Wa.zf(Rb.Kh);if(!Rb)return null;this.isRow?Wa.right=Wa.left=Rb.left:Wa.top=Wa.bottom=Rb.top;Array.add(L,Wa)}return L.length?this.gridView.N$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",L):null};Yb.prototype.yfd=function(L){if(!Ib.a.s5(L))return 1;L=this.O4e(L,this.Hzb);return!L&&this.zmi()?3:this.ppi(L)?0:2};Yb.prototype.zmi=function(){var L=this.gridView.ha.va.selectedRanges;return this.isRow&&Ef.P(L)||!this.isRow&&Ef.O(L)};Yb.prototype.Rcd=function(L){var oa="";switch(L){case 0:oa=
"";break;case 1:oa=pe.a.instance.fa(754);break;case 2:L=this.Hzb;oa=String.format(pe.a.instance.Cb(98),0,this.qbc(L));break;case 3:oa=pe.a.instance.fa(755)}return oa};Yb.prototype.ppi=function(L){return 0<=L&&L<=this.qbc(!1)};Yb.prototype.qbc=function(L){return this.Etc.qbc(L,this.isRow)};Yb.dPd=function(L,oa,Wa){if(oa)for(L.ColumnWidth=Yb.pba,L.RowHeight=Wa,L=yl(L.SheetMultiRange.Ranges),oa=L.next();!oa.done;oa=L.next())oa=oa.value,oa.FirstColumn=0,oa.LastColumn=0;else for(L.RowHeight=Yb.pba,L.ColumnWidth=
Wa,L=yl(L.SheetMultiRange.Ranges),oa=L.next();!oa.done;oa=L.next())oa=oa.value,oa.FirstRow=0,oa.LastRow=0};Sk.Object.defineProperties(Yb.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},Hzb:{configurable:!0,enumerable:!0,get:function(){return Yb.h$d},set:function(L){Yb.h$d=L}}});Yb.a5="id";Yb.Nmi="isRow";Yb.wai="initialSizeInPx";Yb.vai="initialSizeInDefaultUnits";Yb.Oji="isInitialUnitsDefaultUnits";Yb.xfd="getInputErrorIfInvalid";Yb.zDj="size";Yb.Dhi="isDefaultUnits";
Yb.pba=-1;Yb.h$d=!0;Object(ve.a)(Yb,"ResizeHeadersDialog",ui.a,[]);var Lj=b(586);Ua.prototype.Yc=function(L,oa){L=!0;switch(oa){case -445963340:case 1391094586:L=this.te(8);break;case 745189930:case 146338636:L=this.te(16)}return!L};Ua.prototype.executeCommand=function(L,oa,Wa){var Rb=lh.TaskExtensions.om();var xc=tg.g(this.$);L=Yh.a.create().toString();var id=oa.command;switch(id){case 1391094586:case 146338636:var rd=1391094586===id;(L=Wa.autoFitRanges)&&L.Ranges&&L.Ranges.length||(L=Ef.r(xc.ha.va.selectedRanges,
this.$));Rb=this.Xgh(rd?1:0,L,oa);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:rd=-445963340===id||-706918724===id||369708605===id;if(-445963340===id||745189930===id)rd=Ik.a(oa.command),xc.Mi.C7(16,L,rd),Wa=Wa.resizeRowColumnParameters;else{var $d=xc.ha.va.selectedRanges;if(-706918724===id&&6===oa.af&&Ef.O($d)){td.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");
break}if(1051390410===id&&6===oa.af&&Ef.P($d)){td.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}xc=369708605===id||1542466017===id?-2:0;Wa={};Wa.SheetMultiRange=Ef.r($d,this.$);if(rd)for(Rb=yl(Wa.SheetMultiRange.Ranges),id=Rb.next();!id.done;id=Rb.next())id=id.value,id.FirstRow=0,id.LastRow=0;else for(Rb=yl(Wa.SheetMultiRange.Ranges),id=Rb.next();!id.done;id=Rb.next())id=id.value,id.FirstColumn=0,
id.LastColumn=0;Wa.RowHeight=rd?-1:xc;Wa.ColumnWidth=rd?xc:-1}Rb=this.rhh(Wa,oa,L);break;case 957527587:case 2040891415:new Yb(this.$,oa)}return Rb};Ua.prototype.Jc=function(L,oa,Wa,Rb){if(L=!!Wa&&!!Rb&&1===Rb.xA)switch(oa.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:L=!1}return L};Ua.prototype.fd=function(){return!1};Ua.prototype.Evi=function(L){td.ULS.sendTraceTag(537154004,
0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",L.success,Object(Lj.c)(L)?void 0:L.reason)};Ua.prototype.te=function(L){return(new lk.a(this.$.xa)).te(L)};Ua.prototype.Xgh=function(L,oa,Wa){function Rb(){return new md(rd,oa)}var xc=this,id=this.$.na.ta.Zb(),rd=0===L;return Pb.a(this.$.userOperationManager,function($d,Be,gg){var Wg=xc.$.na.ta,Dh=Wg.Na(41,id);Dh.isRow=rd;Dh.autoFitRanges=oa;return ia.i(Wg,"AutoFit",Dh,$d,Be,gg,null,0)},function($d){return new Jc.a(135,
0,$d,void 0,Rb)},Wa)};Ua.prototype.rhh=function(L,oa,Wa){function Rb(){return new jc(L)}function xc(Wg,Dh,ei){id.$.oy();Ef.i(rd,",",id.$,!1);var wj=id.$.na.ta;Wg=Tg.b(Wg,id.MRi);var Bj=wj.Na(41,void 0===gg?null:gg);Bj.resizeRowColumnParameters=L;return ia.i(wj,"ResizeRowsColumns",Bj,Wg,Dh,ei,Wa,0)}var id=this,rd=Ef.g(L.SheetMultiRange.Ranges),$d=oa.command;if(745189930===$d||-445963340===$d){td.ULS.shipAssertTag(537154002,0,this.$.activeItemName===L.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");
var Be=tg.g(this.$);$d=745189930===$d;Be=this.Gh.JBj(Be,rd,$d?L.RowHeight:L.ColumnWidth,$d);this.Evi(Be);Object(Lj.c)(Be)&&tg.g(this.$).Mi.O0(Wa,Bk.BasicTelemetryCalculator.hR)}var gg=this.$.na.ta.Zb(!0);return Be&&Object(Lj.c)(Be)?jf.EwaSettings.sc()?Pb.a(this.$.userOperationManager,xc,function(Wg){return new Jc.a(136,0,Wg,64,Rb)},oa):Pb.a(this.$.userOperationManager,xc,function(Wg){return new Fj.a(136,0,Wg,void 0,Rb)},oa):Pb.a(this.$.userOperationManager,xc,function(Wg){return new Jc.a(136,0,Wg,
void 0,Rb)},oa)};Object(ve.a)(Ua,"ResizeCommandHandler",null,[188]);var Pj=$g.a;vm(sa,Pj);sa.prototype.Od=function(){var L=this,oa=yg.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.ub);lh.TaskExtensions.Ba(oa,function(){L.Fd([new Ua(L.$,oa.result)])},this.ma,3)};sa.ja=function(L){$g.a.fe(113,new sa(L))};Object(ve.a)(sa,"ResizeCommandHandlerFactory",$g.a,[]);Lb.prototype.Yc=function(){return!1};Lb.prototype.executeCommand=function(L,oa,Wa){L=2;switch(oa.command){case -309686558:L=this.Gi.Ce(Vf.a.saveACopy,
2,Wa);break;case 617689800:L=this.Gi.Ce(Vf.a.saveToCloudStorage,2,Wa);break;case -1244760097:L=this.Gi.Ce(Vf.a.saveToSharePoint,2,Wa)}return 2===L&&oa?h.a(oa.command):Xg.Task.Ta(!0)};Lb.prototype.Jc=function(L,oa){L=!1;switch(oa.command){case -1244760097:case -309686558:case 617689800:L=!0,td.ULS.shipAssertTag(537153984,0,this.$.Gka,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return L};Lb.prototype.fd=function(){return!1};Object(ve.a)(Lb,"SaveToHostCommandHandler",
null,[188]);var Hj=$g.a;vm(Hb,Hj);Hb.prototype.Od=function(){var L=this;lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){L.Fd([new Lb(L.$,Od.AFrameworkApplication.Gb)])},this.ma,3);Od.AFrameworkApplication.Gb.fc(Vf.a.cRa,kh.a.frame,this.fFh)};Hb.ja=function(L){$g.a.fe(267,new Hb(L))};Object(ve.a)(Hb,"SaveToHostCommandHandlerFactory",$g.a,[]);Gc.prototype.Yc=function(L){switch(L){case -309686558:return 8===this.Gi.processAction(Vf.a.saveACopy,1,null);case 617689800:return 8===
this.Gi.Ce(Vf.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.Gi.Ce(Vf.a.saveToSharePoint,1,null)}return!1};Gc.prototype.dispose=function(){this.$=null};Object(ve.a)(Gc,"SaveToHostManager",null,[656,3]);var gj=cg.a;vm(Kb,gj);Kb.prototype.create=function(){this.Fb(this.$.da.Aa(393)||new Gc(this.$,Od.AFrameworkApplication.Gb))};Kb.ja=function(L){L.da.Ha(394,new Kb(L))};Object(ve.a)(Kb,"SaveToHostManagerFactory",cg.a,[]);var sk=Nj.a;vm(Sa,sk);Sa.prototype.execute=function(L){var oa=Object($f.a)(8,
L.Ie);td.ULS.shipAssertTag(537153921,0,Qg.a.$nb(L.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");oa.nI(!0,!0);L.activityState[Td.a.aYb]=oa.ea.sessionId;L.activityState[Td.a.Nmb]=!0;L.activityState[Td.a.gYb]=!0;td.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(ve.a)(Sa,"SessionReloadActivity",Nj.a,[]);var dj=cg.a;vm(gb,dj);gb.prototype.create=function(){this.Fb(new Sa(xb.a.kcb,
xb.a.Ck))};gb.ja=function(L){L.da.Ha(142,new gb)};Object(ve.a)(gb,"SessionReloadActivityFactory",cg.a,[]);var zk=b(54),bl=b(259),Uk=b(106),Dk=b(46),Xi=b(243),Wj=b(111),Jk=Nj.a;vm(Sb,Jk);Sb.prototype.execute=function(L){var oa=Object($f.a)(8,L.Ie);L.activityState[Td.a.Jra]=!0;var Wa=Sb.oZh(L);if(Sb.vxj(L,Wa))return Sb.nzi(L),Wa=50,0<L.errors.length&&(Wa=15),td.ULS.sendTraceTag(537153891,0,Wa,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",Qg.a.Tc(L.errors)),
L.activityState[Td.a.Jra]=!1,this.vh(xb.a.idle),3;switch(Wa){case 1:case 3:this.Jci(L,Wa);break;case 2:this.Ici(L);break;case 0:L.activityState[Td.a.rYa]=null}td.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",Wa,this.activityName,this.I_,oa.ea.O7);var Rb=Jj.a.yg(L.activityState,Wj.a.yeb);td.ULS.shipAssertTag(40502925,0,!Rb||Rb&&(1===Wa||3===Wa),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",
Rb,Wa);oa=oa.Lk.reloadCount;return 0!==Wa&&0<oa?(Rb=bl.a.Ava(oa,200),td.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",Wa,oa,Rb,this.activityName),ph.a.instance.create(function(){Sb.JJ(L)},Rb,uj.a.Apj),1):3};Sb.prototype.Jci=function(L,oa){td.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var Wa=Object($f.a)(8,L.Ie);L.activityState[Td.a.Nmb]=
!0;Wa.jfc||Dk.PageLoadTrackingInfo.instance.Kj("ReopenOnLoad");!Sb.isEditMode(L)&&Qg.a.$nb(L.errors)&&(td.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),L.activityState[Td.a.aYb]=Wa.ea.sessionId,L.activityState[Td.a.gYb]=!0);L.Nvd();3===oa?(Wa.ea.Ng()||Wa.ea.$Ei(),Wa.nI(!0,!0),this.vh(this.BMj),L.activityState[Td.a.ole]=Wa.workbookContext.CalcMode):(jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&
1===oa&&Wa.nI(!0,!0),L.activityState[Td.a.QTc]=!1,this.vh(this.Rxc))};Sb.prototype.Ici=function(L){td.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");L.activityState[Td.a.rYa]=null;L.Nvd();this.vh(this.sDj);L=Object($f.a)(8,L.Ie);L.jfc||(Dk.PageLoadTrackingInfo.instance.Kj("RefreshOnLoad"),L.EHb())};Sb.JJ=function(L){L.JJ()};Sb.oZh=function(L){var oa=Object($f.a)(8,L.Ie),Wa=oa.ea,Rb=Sb.isEditMode(L),xc=Qg.a.kh(L.errors,Rb?Sb.zvd:Sb.Avd),
id=Qg.a.kh(L.errors,Rb?Sb.gpf:Sb.hpf),rd=oa.iR,$d=oa.Lk.reloadCount,Be=oa.ya.MaxConsecutiveSilentReloadAllowed,gg=oa.Lk.s8e(),Wg=Qg.a.Tc(L.errors),Dh=Qg.a.Tc(L.qza),ei=0<Qg.a.SM(function(Xj){return!Xj.triggerSilentReopenOnly},L.errors).length,wj=xc,Bj=Jj.a.yg(L.activityState,Wj.a.yeb);Bj&&(wj=!0);xc={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:Rb,isSilentReopenError:xc,isSilentRefreshError:id};xc.reloadSequenceCount=oa.Lk.nQa;xc.reloadCount=$d;xc.maxReloads=Be;xc.stopSilentReloads=
gg;xc.errorNames=Wg;xc.processedErrorNames=Dh;xc.isClientDirty=rd;xc.errorsForSilentReopenOnly=ei;xc.triggerSilentReloadAfterTokenRefresh=Bj;xc.IsReopenDisabled=oa.IMa;rd=zk.a.Kc(xc);td.ULS.sendTraceTag(21837004,0,50,rd);if(!gg){if(wj&&(Rb?Sb.lxj(L):Sb.nxj(L)))return Xi.a.k2f(L,oa)?3:oa.IMa?2:1;if(id&&(Rb||!Wa.yab))return 2}return 0};Sb.vxj=function(L,oa){for(var Wa=yl(L.errors),Rb=Wa.next();!Rb.done;Rb=Wa.next())if(Rb=Rb.value,-1337545025===Rb.MessageId||-238814601===Rb.MessageId)return!1;return Qg.a.SM(function(xc){return!xc.triggerSilentReopenOnly},
L.errors).length?3!==oa:!1};Sb.nzi=function(L){var oa=Qg.a.SM(function(Rb){return!Rb.triggerSilentReopenOnly},L.errors);oa=yl(oa);for(var Wa=oa.next();!Wa.done;Wa=oa.next())L.Ala(Wa.value)};Sb.isEditMode=function(L){var oa=Object($f.a)(8,L.Ie);return oa.ea.qc?oa.Uu&&!!(oa.Hd&64):Jj.a.yg(L.activityState,Td.a.Ls)};Sb.nxj=function(L){var oa=Object($f.a)(8,L.Ie),Wa=Qg.a.paa(L.errors,Sb.Avd);if(Uk.b(Wa,function(Rb){return Rb.ForceVersionUpgrade}))return!1;L=Qg.a.$nb(L.errors);return!oa.ea.yab||L?!0:!1};
Sb.lxj=function(L){L=Qg.a.paa(L.errors,Sb.zvd);return!Uk.b(L,function(oa){return oa.ForceVersionUpgrade})};Sb.Avd=null;Sb.zvd=null;Sb.hpf=null;Sb.gpf=null;Object(ve.a)(Sb,"SessionReloadSilentActivity",Nj.a,[]);var wg=cg.a;vm(zb,wg);zb.prototype.create=function(){this.Fb(new Sb(this.activityName,this.JM,xb.a.Ck,xb.a.rj,xb.a.QMb))};zb.ja=function(L){L.da.Ha(143,new zb(xb.a.una,xb.a.X_b));L.da.Ha(144,new zb(xb.a.wvc,xb.a.cPa));L.da.Ha(145,new zb(xb.a.xvc,xb.a.nCd));L.da.Ha(154,new zb(xb.a.lcb,xb.a.dP))};
Object(ve.a)(zb,"SessionReloadSilentActivityFactory",cg.a,[]);kc.prototype.getSheetName=function(){return this.sheetName};kc.prototype.getValue=function(){return this.value};Object(ve.a)(kc,"MacroRecorderSheetOptionToggledPayload",null,[147]);Ia.prototype.Yc=function(){return!1};Ia.prototype.executeCommand=function(L,oa){function Wa(){return new kc(Rb.SheetName,gg)}var Rb={};this.$.Cj(Rb);L=oa.command;var xc=Object($f.a)(Xe.a,this.$.xa.getItemByName(Rb.SheetName));if(!xc)return h.a(L);switch(L){case 705559150:case -1411193626:var id=
16;var rd=!xc.hideGridLines;var $d=lb;var Be=183;var gg=xc.hideGridLines;break;case -2052321504:case 515737500:id=4;rd=!xc.headersVisible;$d=Va;Be=184;gg=!xc.headersVisible;break;case -1478455630:id=2;rd=!xc.displayRtl;$d=bb;Be=185;gg=!xc.displayRtl;tg.g(this.$).Ca.tRj(rd);break;default:return h.a(L)}xc.Jpb(id,rd);var Wg=this.$.na.ta;return Pb.a(this.$.userOperationManager,function(Dh,ei,wj){return $d(Wg,Rb.SheetName,gg,Tg.b(Dh,function(Bj){Ia.mEb(Bj,xc,id,rd)}),Tg.a(ei,function(){Ia.sDb(xc,id,rd)}),
wj,null)},function(Dh){return new Jc.a(Be,0,Dh,void 0,Wa)},oa)};Ia.prototype.Jc=function(L,oa){L=!1;switch(oa.command){case -1411193626:case 515737500:case -1478455630:L=!0;break;case 705559150:case -2052321504:L=yk.a(this.$)}return L};Ia.prototype.fd=function(){return!1};Ia.mEb=function(L,oa,Wa,Rb){Qg.a.er(L.Errors)&&oa.Jpb(Wa,!Rb)};Ia.sDb=function(L,oa,Wa){L.Jpb(oa,!Wa)};Object(ve.a)(Ia,"SheetOptionsToggleCommandHandler",null,[188]);var tk=$g.a;vm(ta,tk);ta.prototype.Od=function(){this.Fd([new Ia(this.$)])};
ta.ja=function(L){$g.a.fe(100,new ta(L))};Object(ve.a)(ta,"SheetOptionsToggleCommandHandlerFactory",$g.a,[]);var xi=b(61),Ok=b(202),Ak=Ok.a;vm(ra,Ak);ra.prototype.initialize=function(){var L=this.$.Ib+"iframeDialog_frame",oa=this.$.Ib+"iframeDialog";var Wa=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',L,this.F_e(oa));this.Ob.style.margin=Hh.HelperMethods.Qb(0);this.Ob.style.marginBottom=Hh.HelperMethods.Qb(-2);this.Ob.innerHTML=Wa;this.NJc=document.getElementById(L);
this.domElement.id=oa;this.onResize(null,Sys.EventArgs.Empty);Cf.a.Agc&&ph.a.instance.create(this.Glh,50,uj.a.M8h,!0,!0);Ak.prototype.initialize.call(this)};ra.prototype.dispose=function(){this.$&&this.$.mD(this.onResize);Ak.prototype.dispose.call(this)};ra.prototype.setFocus=function(){Ie.DOMElementExtensions.setFocus(this.qLa)};ra.prototype.onHide=function(){this.qLa.contentWindow.close();Ie.DOMElementExtensions.Tf(this.qLa);this.NJc=null;Ak.prototype.onHide.call(this)};ra.prototype.dSj=function(L){var oa=
this.domElement.style;oa.width=Hh.HelperMethods.Qb(L.x);oa.marginLeft=Hh.HelperMethods.Qb(-L.x/2)};ra.prototype.XRh=function(){var L=Ie.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*L.width),this.mHe.x),Math.min(Math.floor(.9*L.height),this.mHe.y))};Sk.Object.defineProperties(ra.prototype,{qLa:{configurable:!0,enumerable:!0,get:function(){return this.NJc}}});Object(ve.a)(ra,"IFrameDialog",Ok.a,[]);vm(Ba,ra);Ba.prototype.F_e=function(L){var oa=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);
Ih.a.Xf(oa,E.a.Nnh,L);qb.a(this.$.ya,34)&&Ih.a.Xf(oa,E.a.rNe,"1");qb.a(this.$.ya,35)&&Ih.a.Xf(oa,E.a.sNe,"1");return oa.toString()};Ba.prototype.onShow=function(){td.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");ra.prototype.onShow.call(this)};Sk.Object.defineProperties(Ba.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(ve.a)(Ba,"EmbeddingDialog",ra,[]);P.A1f="FrameDialog_ShareFromEdit";P.view="FrameDialog_View";
P.Tze="FrameDialog_CloseAndRefresh";P.uwj="FrameDialog_ShareFromView";P.edit="FrameDialog_Edit";P.A8i="FrameDialog_RefreshGrid";P.FZg="FrameDialog_CloseMe";P.cAe="FrameDialog_CloseMeError";P.ready="FrameDialog_Ready";P.XZi="FrameDialog_PleaseClose";P.vH="GotoRange";Object(ve.a)(P,"PostMessageConstants",null,[]);var Vk=b(105);Object(ve.a)(Ob,"SessionUpdateContext",null,[]);vm(cc,ra);cc.prototype.JFg=function(L){this.addHandler(cc.otd,L)};cc.prototype.Tcj=function(L){this.removeHandler(cc.otd,L)};cc.prototype.dispose=
function(){hg.a.Fa(this.M0a);this.M0a=null;ra.prototype.dispose.call(this)};cc.prototype.initialize=function(){ra.prototype.initialize.call(this);var L=eg.a.Saa(this.$.ya.FormLightBoxUrl),oa=this.M0a=new qc.a(this.qLa.contentWindow,L);oa.isEnabled()&&oa.vFa(L)&&(this.Oma(P.A1f,this.zoc),this.Oma(P.view,this.zoc),this.Oma(P.Tze,this.zoc),this.Oma(P.uwj,this.aTi),this.Oma(P.edit,this.JKi),this.Oma(P.A8i,this.zoc),this.Oma(P.ready,this.rRi),this.Oma(P.FZg,this.ewf),this.Oma(P.cAe,this.ewf))};cc.prototype.close=
function(L){L===this.closeAction&&this.Dff&&this.M0a.send(new sg.a(P.XZi))||ra.prototype.close.call(this,L)};cc.prototype.F_e=function(){return this.gEe(this.ohc)};cc.prototype.gEe=function(L){var oa=this.$.ya,Wa=new Sys.StringBuilder(oa.FormLightBoxUrl);Ih.a.Xf(Wa,E.a.CFh,this.$.ea.sessionId);Ih.a.Xf(Wa,E.a.AFh,L?E.a.BFh:E.a.zFh);Vg.a.fGa(Wa,oa);return Wa.toString()};cc.prototype.Keg=function(L){this.aLc=!1;this.qLa.src=this.gEe(L);this.X9d=L};cc.prototype.Oma=function(L,oa){this.M0a.Zn(L);this.M0a.Kl(L,
oa)};cc.prototype.rnc=function(L){var oa=this.$.ea.xa.getItemByName(L.vH.SheetName);oa&&0===oa.uy&&tg.g(this.$).Vg(L.vH,null,null,null,20,Vk.a.kFh)};Sk.Object.defineProperties(cc.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},Dff:{configurable:!0,enumerable:!0,get:function(){return this.aLc}},ohc:{configurable:!0,enumerable:!0,get:function(){return this.X9d}}});cc.Tch=900;cc.uch=1200;cc.otd="lightBoxReady";Object(ve.a)(cc,"FormDialog",ra,[226]);var Di;(function(L){L[L.comment=
10]="comment";L[L.range=12]="range";L[L.table=13]="table";L[L.chart=14]="chart"})(Di||(Di={}));Object(ve.b)("NavigationType",Di);var nk=b(1015),ak=b(112),cl=b(580),gk=b(1072),Ek=b(278),dk=b(851),Fk=dk.a;vm(Jb,Fk);Jb.prototype.initialize=function(){var L="<div class='"+ak.a.ko+"'>\r\n\t<div class='"+ak.a.HNe+"'>\r\n\t\t<div class='"+O.a.Y0c+"'>\r\n\t\t\t<img src='{0}' class='"+O.a.XQe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+ak.a.LNe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";
L=String.format(L,mk.a.Ee(13),pe.a.instance.fa(25),pe.a.instance.fa(this.message));this.Ob.innerHTML=L;this.addButton(0,this.GGi);this.addButton(1);Fk.prototype.initialize.call(this)};Jb.prototype.ox=function(){return this.m_d};Sk.Object.defineProperties(Jb.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"WebMethodConfirmationDialog"}},Rw:{configurable:!0,enumerable:!0,get:function(){return 1005}},Tsa:{configurable:!0,enumerable:!0,get:function(){return this.operationFlags}}});Object(ve.a)(Jb,
"WebMethodConfirmationDialog",dk.a,[]);var hk=nk.a;vm(ic,hk);ic.prototype.dispose=function(){this.BTa&&this.BTa.mda(this.gFf);hg.a.rc([this.textBox,this.jRa,this.BTa]);this.BTa=this.jRa=this.textBox=null;hk.prototype.dispose.call(this)};ic.prototype.initialize=function(){var L="<div class='"+ak.a.ko+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+ak.a.$sb+"'>\r\n\t<input type='text' id='{1}' class='"+ak.a.xC+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";
L=String.format(L,pe.a.instance.fa(1229),"sfd_input","sfd_unshare",O.a.Xo,pe.a.instance.fa(1230));this.Ob.innerHTML=L;this.textBox=new Ek.a(this.getElementById("sfd_input"));this.jRa=new gk.a(this.textBox.domElement);this.BTa=cl.a.create(this.getElementById("sfd_unshare"));this.BTa.D2(this.gFf);this.textBox.text=pe.a.instance.fa(723);this.textBox.enabled=!1;this.textBox.readOnly=!Cf.a.ah;this.addButton(1,10);hk.prototype.initialize.call(this)};ic.prototype.Aha=function(){var L=this;return function(oa,
Wa,Rb){var xc=L.$.na.ta.Zb(),id=L.$.na.ta;oa=L.vja(oa);Wa=L.Jaa(Wa);xc=id.Na(1,xc);return ia.i(id,"ShareForm",xc,oa,Wa,Rb,null,0)}};ic.prototype.$x=function(L,oa,Wa){this.textBox.text=L.Result;this.textBox.enabled=!0;Ie.DOMElementExtensions.setVisible(this.BTa.domElement,!0);hk.prototype.$x.call(this,L,oa,Wa)};ic.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(L){}hk.prototype.setFocus.call(this)};Sk.Object.defineProperties(ic.prototype,{Ac:{configurable:!0,
enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(ve.a)(ic,"ShareFormDialog",nk.a,[]);var dl=b(668),Yi=b(133),el=b(250),di=b(15),Qj=N.a;vm(Ub,Qj);Ub.prototype.Yc=function(L,oa){L=this.$.workbookContext.FullDocumentInfo;switch(oa){case 353606613:case -1099009678:case 192430811:return!jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.ea.isNamedObjectViewMode||this.$.isMobileMode;case 869186573:return oa=el.a()&&this.$.ea.oh.get(5),!L.FileSharingUrl&&
!oa;case -1570751769:case 1986648902:return 131072!==(this.$.RM&131072);case 330035228:return!(this.V2a(!0)&&this.$Cc);case -509039657:return!(this.V2a()&&this.$Cc);case 1334518759:return!(this.V2a()&&this.$Cc&&this.Jwe())}return!1};Ub.prototype.executeCommand=function(L,oa,Wa){L=this.$.workbookContext.FullDocumentInfo;var Rb=Vf.a.workflow,xc=lh.TaskExtensions.om(),id=oa.command;if(id===Rb||-266099===id)return this.T5h(oa,Rb,L);switch(id){case 1986648902:this.N0f();break;case -1570751769:this.E3h(oa);
break;case 869186573:oa=Vf.a.twj;xc=Od.AFrameworkApplication.ga.ra("ShareMenuIsEnabled");Rb=null;(jf.EwaSettings.la(580)||xc)&&Wa&&"CopyLink"===Wa.SourceControlId?(Rb={},Rb[Dg.a.hKb]="copy",oa=Vf.a.z1f):xc&&Wa&&"ManageAccess"===Wa.SourceControlId?(Rb={},Rb[Dg.a.hKb]="manageAccess",oa=Vf.a.vwj):Wa&&"LinkToComment"===Wa.SourceControlId&&(Rb={},Rb[Dg.a.hKb]="copy",Rb[Dg.a.B1f]=Wa.navId,oa=Vf.a.z1f);xc=this.U4f(L,Rb);bj.c(oa);break;case -1099009678:xc=this.OPd(12,L);break;case 192430811:xc=this.OPd(13,
L);break;case 353606613:xc=this.OPd(14,L);break;case -59906385:case 1197060601:this.f5h(oa,L);break;case 1305810481:this.R6e(!1,oa);break;case 330035228:this.R6e(!0,oa);break;case -509039657:this.deleteForm();break;case 1334518759:oa.yyb=!0;this.shareForm();break;case 710925581:ad.a.Rf.Owc("710925581")&&(xc=lh.TaskExtensions.Ba(this.eK.value,function(rd){rd.result.Sj(Jf.a.conversation,{})},this.ma,3));break;case 327119921:this.u3h();break;default:xc=h.a(id)}return xc};Ub.prototype.Jc=function(L,oa){L=
!1;oa=oa.command;if(oa===Vf.a.workflow)return!0;switch(oa){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:L=!0;break;case 353606613:case -1099009678:case 192430811:L=jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.ea.isNamedObjectViewMode}return L};Ub.prototype.fd=function(L,oa,Wa){if("PopulateFormMenu"===oa){oa=this.$Cc?
this.Jwe()?Ub.wzh:Ub.xzh:Ub.PDi;L=this.Sa.Mc();for(var Rb=0;Rb<oa.length;Rb++)Array.add(L.buttons,this.Sa.Bb(oa[Rb]));oa=this.Sa.Lp("Forms.Flyout");Array.add(oa.zc,L);Wa.MenuItems=oa.aC();return!0}return!1};Ub.prototype.T5h=function(L,oa,Wa){return this.xMd&&L.command===oa?(this.vMd(L,-266099),lh.TaskExtensions.H4()):lh.TaskExtensions.Ba(this.eK.value,function(Rb){Nb.a(Rb.result,Jf.a.workflow,null,Wa.WorkflowPostMessage)||Hh.HelperMethods.vf(Wa.WorkflowUrl,"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},
this.ma,3)};Ub.prototype.Jwe=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.ea.oh.get(26)};Ub.prototype.u3h=function(){var L=Yh.a.create().toString();td.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+L);var oa=this.$.frame,Wa=oa.N8a,Rb=this.$,xc=new eh.QueryStringBuilder(Od.AFrameworkApplication.ga.Ua("TeamsMeetingShareEndpoint"));xc.Hi("deeplinkId",L);xc.Hi("lm","deeplink");L=xc.Hi;var id={};var rd=new eh.QueryStringBuilder(Od.AFrameworkApplication.ga.Ua("TeamsAppSharingUrl"));
rd.Hi("auth","2");rd.Hi("flight","officeunihost");rd.Hi("source","TEAMS-ELECTRON.meetingStage.deeplink");var $d={};$d.fileType=Uf.a.v4(Rb.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);$d.objectUrl=Rb.workbookContext.FullDocumentInfo.WorkbookPath;$d.baseUrl=Rb.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;Rb=Rb.workbookContext.WorkbookFileVersionId;for(var Be=decodeURIComponent(Rb);Rb!=Be;)Rb=Be,Be=decodeURIComponent(Rb);0>Rb.indexOf("{")||0>Rb.indexOf("}")?(td.ULS.sendTraceTag(528250338,
306,15,"Decoded fileId does not match expected format. Decoded id: "+Rb),Rb=""):Rb=Rb.substring(Rb.indexOf("{")+1,Rb.indexOf("}")).toLowerCase();$d.fileId=Rb;$d=nh.c(nh.c($d));rd.Hi("subEntityId",$d.substring(1,$d.length-1));id.appSharingUrl=rd.toString();id.appId=Od.AFrameworkApplication.ga.Ua("TeamsAppId");id=JSON.stringify(id);L.call(xc,"appContext",id);Wa.call(oa,xc.toString(),!0)};Ub.prototype.E3h=function(L){this.xMd?this.vMd(L,1986648902):this.N0f()};Ub.prototype.R6e=function(L,oa){!L&&this.$.ya.SurveyRedirectUrl?
this.g3i():(L=new cc(this.$,L,oa),L.initialize(),L.mf())};Ub.prototype.f5h=function(L,oa){var Wa=this;this.xMd&&1197060601===L.command?this.vMd(L,-59906385):lh.TaskExtensions.Ba(this.eK.value,function(Rb){Rb=Rb.result;Rb&&Nb.a(Rb,Jf.a.replyWithChanges,null,Wa.$.ea.oh.get(8))||(Rb=new Sys.StringBuilder(oa.ReplyWithChangesUrl),Ih.a.Xf(Rb,kj.e,kj.d),M.a.ntw(Rb.toString(),Wa.$))},this.ma,3)};Ub.prototype.vMd=function(L,oa){var Wa=this,Rb=dg.a(this.$).qd.activityState,xc=new Vj.a(oa,L.method,L.mode,L.af,
L.tabName);ii.a(this.$).kt(new Ki.a(xb.a.fz,5,function(){Rb[Oe.a.Yq]=xb.a.PVf;Rb[dl.a.MTc]=xc;Wa.$.Lk.Jy("SocialSharingSaveBeforeCommand");Wa.$.Lk.Hme(xc.command)}))};Ub.prototype.N0f=function(){var L=this,oa=this.$.ya.DocumentHostInfo;oa.HostEmbeddedViewUrl||this.Awe?this.M3f():this.$.jg.get(53)&&lh.TaskExtensions.Ba(this.eK.value,function(Wa){L.$Oj(Wa.result)||M.a.ntw(oa.FileEmbedCommandUrl,L.$)},this.ma,3)};Ub.prototype.$Oj=function(L){return L.isEnabled()&&(this.zwe||(this.zwe=L.Kl(Jf.a.ywe,this.aIi)))?
L.Sj(Jf.a.dBh,null):!1};Ub.prototype.M3f=function(){if(Cf.a.Xp)M.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var L=new Ba(this.$);L.initialize();L.mf()}};Ub.prototype.deleteForm=function(){var L=this.$,oa=new Jb(L,1234,1235,1227,function(Wa,Rb,xc){var id=L.na.ta.Zb(),rd=L.na.ta;id=rd.Na(9,id);id.surveyId=null;return ia.i(rd,"DeleteSurvey",id,Wa,Rb,xc,null,0)});oa.initialize();oa.mf()};Ub.prototype.shareForm=function(){var L=this,oa=this.$.workbookContext.FullDocumentInfo;if(this.$.ea.oh.get(26)){var Wa=
new ic(this.$);Wa.initialize();Wa.mf()}else lh.TaskExtensions.Ba(this.eK.value,function(Rb){var xc={};Nb.a(Rb.result,Jf.a.shareForm,(xc[Dg.a.xIj]=L.$.workbookContext.SurveyTitle,xc),L.$.ea.oh.get(10))||M.a.ntw(oa.ShareFormCommandUrl,L.$)},this.ma,3)};Ub.prototype.g3i=function(){var L=this.$;L.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var oa=new Sys.StringBuilder(L.ya.SurveyRedirectUrl);Ih.a.Xf(oa,"startupDialog","FormEdit");var Wa=dg.a(this.$),Rb=Wa.qd.activityState;
Rb[Dd.a.t2]=oa.toString();Rb[Dd.a.nM]=Dd.a.sxd;this.$.Lk.Jy("SocialSharingEnvironmentChange");ii.a(L).kt(new Ki.a(xb.a.fz,5,function(){var xc=Qg.a.hd(3,2,1279,1280,1281,554412057,"FossEnvironmentUnsupported");Wa.qd.At([xc]);Rb[Oe.a.Yq]=xb.a.Hcg}))};Ub.prototype.V2a=function(L){return(this.$.ea.isEditMode||(void 0===L?!1:L))&&this.$.ea.oh.get(25)&&el.a()};Ub.prototype.YYh=function(L){var oa=void 0===oa?null:oa;var Wa=tg.g(this.$).ha;var Rb=this.$.xa.pa?xi.d(this.$.xa.pa):null;if(!Rb)return td.ULS.sendTraceTag(537151649,
0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",Di[L]),null;14===L?oa=this.xYh(Wa):12===L?(oa=Wa.uia,oa=Ib.a.contains(oa,"!",!0)?oa.split("!")[1]:oa):13===L&&(Wa=Wa.va.selectedRanges,Wa[0]&&(Wa=tg.g(this.$).Rb.Xj(Wa[0])))&&(oa=Wa.ij);if(!oa)return td.ULS.sendTraceTag(537151648,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",Di[L]),null;Wa={};Wa[Dg.a.hKb]="copy";Wa[Dg.a.B1f]=
this.wPh(L,oa,Rb);td.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",Di[L],oa,Rb);return Wa};Ub.prototype.xYh=function(L){if(L.Pa.i5&&(L=L.Pa.lc.floatingObject)&&0===L.type){var oa=L.id.split(".");if(1<oa.length)return oa[1];td.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",L.id)}return null};
Ub.prototype.wPh=function(L,oa,Wa){L=btoa(L+"_"+oa+"_"+Wa);L=L.replace(RegExp("\\+","g"),"-");L=L.replace(RegExp("\\/","g"),"_");return L=L.replace(RegExp("\\=+$","g"),"")};Ub.prototype.U4f=function(L,oa){var Wa=this;return lh.TaskExtensions.Ba(this.eK.value,function(Rb){Nb.a(Rb.result,Jf.a.sharing,oa,Wa.$.ea.oh.get(5))?td.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",oa?oa[Dg.a.hKb]:""):Hh.HelperMethods.vf(L.FileSharingUrl,
"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ma,3)};Ub.prototype.OPd=function(L,oa){if(!jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.$.isMobileMode)return null;var Wa=this.YYh(L);if(Wa)return this.U4f(oa,Wa);td.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",Di[L]);return null};Sk.Object.defineProperties(Ub.prototype,{$Cc:{configurable:!0,enumerable:!0,
get:function(){return aa.b(this.$.lg)}},xMd:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.ea.njh||this.$.iR)}}});Ub.PDi=[103];Ub.wzh=[107,104,105,106];Ub.xzh=[104,105];Ub.oWg=[new di.a(xb.a.aAe,554412057,0,0,1282),new di.a(xb.a.idle,554412057,0,1)];Object(ve.a)(Ub,"SocialSharingCommandHandler",N.a,[188]);var Z=$g.a;vm(pb,Z);pb.prototype.Od=function(){var L=this,oa=new Kf.a(function(){return yg.GetServiceTaskFactory.create(L.$.da,137,L.ma,L.ub)});lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.create(this.$.da,
102,this.ma,this.ub),function(Wa){L.Fd([new Ub(L.$,Wa.result,oa)])},this.ma,3)};pb.ja=function(L){$g.a.fe(114,new pb(L))};Object(ve.a)(pb,"SocialSharingCommandHandlerFactory",$g.a,[]);Object(ve.a)(Oa,"MacroRecorderRangeCustomSortedPayload",null,[147]);var xa=b(1089),fb=b(1090),Zb=b(972),Fc=b(877),cd=b(201);Xb.prototype.show=function(){var L=new Lg.StandardDialog;L.jc=11;L.Fc(1,pe.a.instance.fa(2066));L.Fc(2,pe.a.instance.fa(2067));L.J4f(pe.a.instance.fa(2065),pe.a.instance.Va(645),this.$v)};Xb.prototype.KNa=
function(L){td.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",L)};Object(ve.a)(Xb,"ExpandSortSelectionDialog",null,[]);sc.isValid=function(L){return Array.contains(sc.Izh,L.Position)?!0:(td.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",L.Position),!1)};sc.Izh=[0,.5,1];Object(ve.a)(sc,"FillGradientStopExtension",null,[]);Object(ve.a)(mb,"GradientLine",null,[]);Za.isValid=function(L){if(!(L.Degree.toString()in
Za.Gzh))return td.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",L.Degree),!1;if(!L.GradientStops)return td.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(L.GradientStops.length<Za.gBi||L.GradientStops.length>Za.Hzi)return td.ULS.shipAssertTag(537159827,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",L.GradientStops.length),!1;L=yl(L.GradientStops);for(var oa=L.next();!oa.done;oa=
L.next())if(!sc.isValid(oa.value))return!1;return!0};Za.gBi=2;Za.Hzi=3;var ed={};Za.Gzh=(ed["0"]=new mb(0,0,1,0),ed["180"]=new mb(1,0,0,0),ed["90"]=new mb(0,0,0,1),ed["270"]=new mb(0,1,0,0),ed["45"]=new mb(0,0,1,1),ed["225"]=new mb(1,1,0,0),ed["135"]=new mb(1,0,0,1),ed["315"]=new mb(0,1,1,0),ed);Object(ve.a)(Za,"FillGradientExtension",null,[]);var Nc=Bh.a;vm(ub,Nc);ub.prototype.LO=function(L,oa){if(1===L){var Wa=Ef.v(this.WBb,this.$);tg.g(this.$).Vg(Wa,null,null,null,0,Vk.a.OEj)}Wa={};Wa=(Wa.DialogButton=
L,Wa.Location="dialog",Wa);zf.b(this.$).ee(yc.a.QEj,Wa,null,!0);Nc.prototype.LO.call(this,L,oa)};ub.prototype.Ar=function(){Nc.prototype.Ar.call(this);var L=this.NEj();this.jc=1;this.Fc(1,pe.a.instance.fa(2176));this.Jk(pe.a.instance.fa(2177),R.a.ym(L),1,this.MO)};ub.prototype.NEj=function(){return String.format(pe.a.instance.Cb(165),this.WBb.toString())};ub.prototype.Wcd=function(){var L=this.error.Description.split("_");return new Gj.Range(Number.parseInvariant(L[1])+1,Number.parseInvariant(L[2])+
1,Number.parseInvariant(L[3])+1,Number.parseInvariant(L[4])+1,!0,!1)};Sk.Object.defineProperties(ub.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(ve.a)(ub,"SortMergedCellsErrorDialog",Bh.a,[]);var Pc=b(595),wd=b(655),Kd=Zb.a;vm(ib,Kd);ib.prototype.dispose=function(){this.Rfc||(this.Rfc=!0,this.k1b(),this.C6=null,jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(this.Tbb.dispose(),this.Tbb=null));Kd.prototype.dispose.call(this)};
ib.prototype.BHh=function(L){var oa=this;return function(Wa){if(fj.b(Wa,-901005882))dg.a(oa.$).qd.ZD(-901005882),oa.KFd();else if(fj.b(Wa,-569193796))dg.a(oa.$).qd.ZD(-569193796),oa.hide(),new ub(oa.$,Wa.Errors[0]);else if(fj.a(Wa))td.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),oa.hide();else{Wa=Wa.Result;oa.$.Cj(Wa.SortRange);var Rb=jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");
Wa&&ec(Wa)&&tb(Wa)&&Ya(Wa,Rb)?L(Wa):oa.n6b(ib.Xqb())}}};ib.prototype.lIh=function(L,oa){var Wa=this;return function(Rb,xc){if(Wa.Rfc)td.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!Rb||fj.a(Rb))td.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",Qg.a.Tc(Rb.Errors)),Wa.$.ea.np(Rb.Errors),Wa.hide();else{Rb=
Rb.Result;var id=L.RangeType,rd=L.HeaderRowSize,$d=L.SortTopToBottom;Rb&&$b(Rb,L.ConditionType)&&pd(Rb,id,rd,$d)?(Rb.ColumnInfo.ColumnOffset=xc,void 0!==Rb.HeaderColumnInfo&&null!==Rb.HeaderColumnInfo&&(Rb.HeaderColumnInfo.ColumnOffset=xc),oa(Rb,L.ConditionType,L.SortTopToBottom)):(td.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),Wa.n6b(ib.Xqb()))}}};ib.prototype.Myj=function(L){return!!this.namedSheetViewPublic&&
(!L||3===L)};ib.prototype.R6g=function(L){var oa={};oa.SelectedRange=this.selectedRange;oa.ActiveCell=this.Noc;oa.SortInfoMode=L;oa.ExpandSortSelection=this.sUg;oa.ExpandSortSelectionSupported=!0;return oa};ib.prototype.jta=function(L){var oa={};oa[yf.a.$y]=this.Ac;oa.fromAutoFilter=L.FromAutoFilter;oa.gridRTL=tg.g(this.$).rtl;oa.activeCell=L.ActiveCell;oa.selectedRange=L.SelectedRange;oa.invokeGetSortInfo=this.Iei;oa.invokeGetSortConditionColorsOrIcons=this.Hei;oa.highlightSortRange=this.g8h;oa.getColorName=
this.getColorName;return oa};ib.prototype.Hoa=function(L,oa){L=Ef.D(L);this.ha.va.Sd.equals(L)||this.ha.updateSelection(L,Ef.C(oa),0,void 0,void 0,void 0,!0)};ib.prototype.KFd=function(){var L=this;(new Xb(function(oa){var Wa={};Wa.ActiveCell=L.Noc;Wa.SelectedRange=L.selectedRange;Wa.ExpandSelection=oa;Wa.FromAutoFilter=!1;oa={};L.$.xe(-207540907,na.a.$b,8,(oa.SortCommandData=Wa,oa))})).show()};ib.prototype.k1b=function(){if(void 0!==this.C6&&null!==this.C6)for(var L=yl(this.C6),oa=L.next();!oa.done;oa=
L.next())this.$.na.ta.Feb(oa.value.Ft)};ib.YLf=function(L,oa){var Wa={};L.xe(1659552324,na.a.$b,8,(Wa.CustomSortCommandData=oa,Wa))};ib.Xqb=function(){return Qg.a.hd(1,0,26,0,1,-1517197771,"CustomSortValidationError")};Sk.Object.defineProperties(ib.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"CustomSortDialog"}},ha:{configurable:!0,enumerable:!0,get:function(){return tg.g(this.$).ha}}});Object(ve.a)(ib,"CustomSortDialog",Zb.a,[]);var re=b(1180);vb.prototype.getSelection=function(){return this.selection};
Object(ve.a)(vb,"MacroRecorderRangeAutoFilterClearedPayload",null,[147]);Object(ve.a)(Dc,"MacroRecorderRangeFilterReappliedPayload",null,[147]);var We=b(900),df=b(901),ag=b(135),lg=b(39);cb.prototype.Yc=function(L,oa){return!this.pqd(L,oa)};cb.prototype.executeCommand=function(L,oa,Wa){L=null;var Rb=oa.command;switch(Rb){case -864298118:L=this.dhh(oa,Wa);break;case -1010737776:L=this.m7c(!0,oa,Wa);break;case 2123420468:L=this.m7c(!1,oa,Wa);break;case -207540907:case -1677817820:L=this.gridView.Rb.Ska(this.gridView.ha.va.activeCell)?
this.h3i():this.e3i(oa,Wa);break;case 1659552324:L=this.ahh(oa,Wa);break;case 368460465:L=this.thh(oa);break;case 529856798:L=this.Ygh(oa);break;case 644342024:L=this.ohh(oa)}return L||h.a(Rb)};cb.prototype.Jc=function(L,oa){if(L=1===L)switch(oa.command){case -864298118:case -1010737776:case 2123420468:case 368460465:case 529856798:case 1659552324:case 644342024:case -207540907:case -1677817820:break;default:L=!1}return L};cb.prototype.fd=function(){return!1};cb.prototype.ha=function(){return this.$&&
this.gridView?this.gridView.ha:null};cb.prototype.DOf=function(L){L?this.gridView.ar(this.onContentReady):this.gridView.pt(this.onContentReady);this.tdf=L};cb.prototype.Qzj=function(L){return!!this.sortOptions&&Ib.a.equals(this.Nkf,L.uia,!0)};cb.prototype.pqd=function(L,oa){var Wa=tg.g(this.$).ha.va.selectedRanges;return(new lk.a(this.$.xa)).Hn(L,oa,Wa,this.gridView)};cb.prototype.m7c=function(L,oa,Wa){var Rb={OperationType:0};Rb.IsAscending=L;Rb.HasHeader=!0;Rb.GuessHeader=!0;Rb.SortTopToBottom=
!0;Rb.ExpandSortSelectionSupported=!0;Wa&&void 0!==Wa[cb.ySa]&&null!==Wa[cb.ySa]?(Wa=Wa[cb.ySa],Rb.ActiveCell=Wa.ActiveCell,Rb.SelectedRange=Wa.SelectedRange,Rb.ExpandSortSelection=Wa.ExpandSelection):(Rb.ActiveCell=Ef.o(this.ha().va.activeCell,this.$),Rb.SelectedRange=Ef.v(this.ha().va.Sd,this.$),Rb.ExpandSortSelection=null);return this.Xqd([Ef.D(Rb.SelectedRange)])?this.gridView.Rb.Ska(Ef.D(Rb.SelectedRange))?this.lhh(L):this.qcf(Rb,oa):lh.TaskExtensions.om()};cb.prototype.dhh=function(L,oa){var Wa=
null,Rb=this.ha();Rb&&(this.Qzj(Rb)?this.Xqd(Rb.va.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Wa=this.qcf(this.sortOptions,L)):Wa=this.m7c(!0,L,oa));return Wa};cb.prototype.Xqd=function(L){return jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&(jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||this.$.isEditMode)?this.$.isEditMode?this.$.Ns(L,!0,1):this.$.UWc(L,!0,1):!0};cb.prototype.lhh=
function(L){this.NVh(L);return Xg.Task.Ta(!0)};cb.prototype.YQg=function(L){if(jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var oa=this.gridView.Rb.Xj(this.ha().va.Sd,!1);if(oa){var Wa=oa.name;oa=oa.usedRange;oa=this.ha().va.activeCell.left-oa.left;return new fb.a(Wa,oa,L.IsAscending)}}return new xa.a(L)};cb.prototype.qcf=function(L,oa){function Wa(){return Rb.YQg(L)}var Rb=this;this.gridView.Hh.XG(!1);return this.$Le(function(xc,id,rd){return Mb(Rb.$.na.ta,
L,Tg.b(xc,Rb.DTi),id,rd,L)},function(xc){return new Jc.a(141,0,xc,void 0,Wa)},oa,this.Lyj(L))};cb.prototype.Lyj=function(L){if(!this.namedSheetViewPublic)return!1;var oa=this.ha().va.Sd,Wa=Ef.v(this.ha().va.Sd,this.$),Rb=this.gridView.Rb.axa(oa,!0),xc=this.ha().va.jxa()&&this.gridView.Rb.Vgf(Wa),id=this.gridView.Rb.Vli(Wa);L=!oa.C5&&!oa.i_||oa.isSingle||null!=L.ExpandSortSelection?L.ExpandSortSelection&&this.gridView.Rb.Vgf(Wa):!1;return Rb||xc||id||L};cb.prototype.h3i=function(){return this.$.xe(-1556797033,
na.a.$b,8,null)};cb.prototype.e3i=function(L,oa){L=8===L.af&&oa&&void 0!==oa[cb.ySa]&&null!==oa[cb.ySa]?oa[cb.ySa]:19===L.af&&oa&&void 0!==oa[na.a.Ug]&&null!==oa[na.a.Ug]?zk.a.pi(oa[na.a.Ug]):this.U5g();if(!this.Xqd([Ef.D(L.SelectedRange)]))return lh.TaskExtensions.om();tg.g(this.$).Hh.XG(!1);var Wa=null;(oa=oa.TopCellAddress)&&(Wa=Ef.o(oa,this.$));new ib(this.$,L,this.namedSheetViewPublic,Wa);return Xg.Task.Ta(!0)};cb.prototype.ahh=function(L,oa){function Wa(){return new Oa(rd.SortOptions)}function Rb(){rd.ShouldRestoreSelection&&
id.Hoa(rd.SelectedRange,rd.OriginalActiveCell);td.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",L.af)}function xc($d){jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&id.t8e($d)?id.d7e($d.Errors[0]):(rd.ShouldRestoreSelection&&id.Hoa(rd.SelectedRange,rd.OriginalActiveCell),td.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",
L.af),rd.TopCellAddress?$d=Ef.C(rd.TopCellAddress):($d=rd.OriginalActiveCell,$d=new Gj.Range($d.FirstRow+1,$d.FirstColumn+1,$d.FirstRow+1,$d.FirstColumn+1,!0,!1)),id.JL($d))}var id=this,rd=oa[cb.Xah];return Pb.a(this.$.userOperationManager,function($d,Be,gg){return Mb(id.$.na.ta,rd.SortOptions,Tg.b($d,xc),Tg.a(Be,Rb),gg,id.sortOptions)},function($d){return new Jc.a(187,0,$d,void 0,Wa)},null)};cb.prototype.Hoa=function(L,oa){L=Ef.D(L);tg.g(this.$).ha.va.Sd.equals(L)||tg.g(this.$).ha.updateSelection(L,
Ef.C(oa),0,void 0,void 0,void 0,!0)};cb.prototype.U5g=function(){var L={};L.ActiveCell=Ef.o(this.ha().va.activeCell,this.$);L.SelectedRange=Ef.v(this.ha().va.Sd,this.$);L.FromAutoFilter=!1;L.ExpandSelection=null;return L};cb.prototype.thh=function(L){function oa(){return new re.a(Rb)}var Wa=this,Rb=this.fKa();if(!Rb)return Xg.Task.Ta(!1);var xc=this.$.na.ta.Zb();return jf.EwaSettings.sc()?Pb.a(this.$.userOperationManager,function(id,rd,$d){return ia.kb(Wa.$.na.ta,Rb,We.a.Dva(ag.a.HZa,df.a.toggleAutoFilter,
id),rd,$d,null,xc)},function(id){return new Jc.a(516,0,id,64,oa)},L):Pb.a(this.$.userOperationManager,function(id,rd,$d){return ia.kb(Wa.$.na.ta,Rb,We.a.Dva(ag.a.HZa,df.a.toggleAutoFilter,id),rd,$d,null,xc)},function(id){return new Fj.a(516,0,id,void 0,oa)},L)};cb.prototype.Ygh=function(L){function oa(){return new vb(Rb)}var Wa=this,Rb=this.fKa();if(!Rb)return Xg.Task.Ta(!1);var xc=this.gridView.Rb.Xj(this.ha().va.Sd,!0);xc&&td.ULS.sendTraceTag(537151574,0,50,"DoClearAutoFilter for namedObject: Type : {0}",
xc.type.toString());var id=this.$.na.ta.Zb();xc=jf.EwaSettings.sc()?function(rd){return new Jc.a(517,0,rd,64,oa)}:function(rd){return new Fj.a(517,0,rd,void 0,oa)};return this.$Le(function(rd,$d,Be){var gg=Wa.$.na.ta;rd=We.a.Dva(ag.a.ksa,df.a.clearAutoFilter,rd);var Wg=gg.Na(41,void 0===id?null:id);Wg.selectedRange=Rb;return ia.i(gg,"ClearAutoFilter",Wg,rd,$d,Be,null,0)},xc,L,!!this.namedSheetViewPublic)};cb.prototype.$Le=function(L,oa,Wa,Rb){var xc=this;return Rb?this.namedSheetViewPublic.LAa().continueWith(function(id){id.result&&
Pb.a(xc.$.userOperationManager,L,oa,Wa)}):Pb.a(this.$.userOperationManager,L,oa,Wa)};cb.prototype.ohh=function(L){function oa(){return new Dc(Rb)}var Wa=this,Rb=this.fKa();if(!Rb)return Xg.Task.Ta(!1);var xc=this.$.na.ta.Zb();return jf.EwaSettings.sc()?Pb.a(this.$.userOperationManager,function(id,rd,$d){return lc(Wa.$.na.ta,Rb,We.a.Dva(ag.a.ksa,df.a.xMf,id),rd,$d,null,xc)},function(id){return new Jc.a(518,0,id,64,oa)},L):Pb.a(this.$.userOperationManager,function(id,rd,$d){return lc(Wa.$.na.ta,Rb,
We.a.Dva(ag.a.ksa,df.a.xMf,id),rd,$d,null,xc)},function(id){return new Fj.a(518,0,id,void 0,oa)},L)};cb.prototype.t8e=function(L){return fj.b(L,-569193796)};cb.prototype.d7e=function(L){dg.a(this.$).qd.ZD(-569193796);new ub(this.$,L)};cb.prototype.KFd=function(L){var oa=this;(new Xb(function(Wa){var Rb={};Rb.ActiveCell=L.ActiveCell;Rb.SelectedRange=L.SelectedRange;Rb.ExpandSelection=Wa;Wa={};oa.$.xe(L.IsAscending?-1010737776:2123420468,na.a.$b,8,(Wa[cb.ySa]=Rb,Wa))})).show()};cb.prototype.XCj=function(){var L=
this.ha();L.updateSelection(this.jyc,L.va.activeCell,0,void 0,void 0,void 0,!0);this.DOf(!0)};cb.prototype.fKa=function(){var L=this.ha();if(!L)return td.ULS.shipAssertTag(537151573,0,!!L,"SelectionManger is null"),null;this.gridView.Hh.XG(!1);return Ef.v(L.va.Sd,this.$)};cb.prototype.wJb=function(){this.Uc&&this.Uc.Qo&&(this.ag=this.Uc.Qo,this.Db=this.Uc.yac())};cb.prototype.NVh=function(L){var oa=this;if(this.$.isEditMode&&(this.Uc=this.gridView.Rb.$o(this.gridView.ha.va.activeCell))){this.activeCell=
Ef.o(this.gridView.ha.va.activeCell,this.$);if(this.Uc&&this.Uc.Qo){var Wa=this.Uc.Qo.CurrentCol;if(this.Uc.Qo.CurrentRow===this.activeCell.FirstRow&&Wa===this.activeCell.FirstColumn){this.wJb();this.applyPivotSort(L);return}}this.$.na.ta.Zb();Wa=new Jc.a(228,0,function(Rb,xc,id){return ia.C(oa.$.na.ta,oa.activeCell,Tg.b(Rb,oa.XMi),Tg.a(xc,oa.WMi),id,L)},16);this.$.userOperationManager.hc(Wa,null)}};cb.prototype.applyPivotSort=function(L){var oa=this;if(this.Uc&&this.Db&&this.activeCell&&this.ag){var Wa=
8===this.ag.CellArea,Rb=1===this.ag.CellArea||2===this.ag.CellArea;(Wa||Rb)&&8!==this.ag.CellType&&4!==this.ag.CellType&&(Wa?Pb.a(this.$.userOperationManager,function(xc,id,rd){return ia.e(oa.$.na.ta,oa.activeCell,L?1:2,oa.Db.Caption,xc,id,rd,null)},function(xc){return new Jc.a(1015,0,xc,void 0,null)},null):(Wa=1===this.ag.CellArea?1:2,this.$.la(724)?M.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Uc.externalSourceIndex,this.Db.Index.toString(),this.Db.Caption,
this.Uc.isOlap?"":this.Db.Caption,Wa,L):M.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Uc.externalSourceIndex,this.Db.Index.toString(),L)))}};cb.prototype.JL=function(L){(jf.EwaSettings.isChangeGateEnabled("OfficeVSO:6063473_PTPSDisableLive")?lg.a.Rka(this.$):jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1))&&lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.Wa(this.$.da,430,431,1),function(oa){oa.result.yea(L);td.ULS.sendTraceTag(537151571,
306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ma,3)};cb.prototype.KWd=function(L){jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1)&&lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.Wa(this.$.da,476,475,0),function(oa){oa.result.KWd(L,0);td.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.ma,3)};cb.Xah="CustomSortCommandData";
cb.ySa="SortCommandData";Object(ve.a)(cb,"SortCommandHandler",null,[188]);var oh=$g.a;vm(Ga,oh);Ga.prototype.Od=function(){var L=this;lh.TaskExtensions.Ba(yg.GetServiceTaskFactory.Wa(this.$.da,309,310,this.ub),function(oa){L.Fd([new cb(L.$,oa.result)])},this.$.ma,3)};Ga.ja=function(L){$g.a.fe(160,new Ga(L))};Object(ve.a)(Ga,"SortCommandHandlerFactory",$g.a,[]);za.prototype.m$g=function(L,oa){new ub(L,oa)};Object(ve.a)(za,"SortUtil",null,[649]);var zh=cg.a;vm(ya,zh);ya.prototype.create=function(){var L=
this.$.da.Aa(446);L||(L=new za(this.$),this.$.da.Ha(446,L));this.Fb(L)};ya.ja=function(L){L.da.Ha(447,new ya(L))};Object(ve.a)(ya,"SortUtilFactory",cg.a,[]);eb.prototype.executeCommand=function(L,oa,Wa){return 2!==this.Gi.Ce(Vf.a.tryOfficeThroughTellMe,2,Wa)?Xg.Task.Ta(!0):h.a(oa.command)};eb.prototype.Jc=function(L,oa){return 215809929===oa.command};eb.prototype.fd=function(){return!1};eb.prototype.Yc=function(){return!1};Object(ve.a)(eb,"TryOfficeThroughTellMeCommandHandler",null,[188]);var uh=
$g.a;vm(Cb,uh);Cb.prototype.Od=function(){this.Fd([new eb(Od.AFrameworkApplication.Gb)])};Cb.ja=function(L){$g.a.fe(207,new Cb(L))};Object(ve.a)(Cb,"TryOfficeThroughTellMeCommandHandlerFactory",$g.a,[]);var Ji=b(157);ob.XM=function(){return wh.a.Cn(ob.Vj,Ji.a.Va(433))};ob.Vj="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";
Object(ve.a)(ob,"NamedSheetViewTeachingDialogHtml",null,[]);var yi=yf.a;vm(Ta,yi);Ta.prototype.Ch=function(){this.jc=4;this.stopwatch=this.$.Vb.Hc("UserAction",this.Ac);var L=pe.a.instance.fa(1861);this.eg=ob.XM();this.Wo=new Lh.a;this.initializeAndShow(L,this.ZCi,{});return this.Wo.task};Ta.prototype.mv=function(L){yi.prototype.mv.call(this,L);this.Fc(1,pe.a.instance.fa(1863));this.Fc(2,pe.a.instance.Va(446))};Ta.prototype.C1i=function(){this.$.ea.Elc=!1};Ta.prototype.Vvi=function(L){var oa={};oa.a=
this.$.ya.UserSessionId;oa.b="NamedSheetViewTeachingDialogClose";oa.c=L;oa.e=!0;this.stopwatch&&(this.stopwatch.stop(),oa.d=this.stopwatch.Dc);Ra.b().Pe(53,oa,!0)};Sk.Object.defineProperties(Ta.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(ve.a)(Ta,"NamedSheetViewTeachingDialog",yf.a,[]);var Oi=b(186);Ka.prototype.LAa=function(){if(this.mzj()){if(jf.EwaSettings.la(606)){this.$.xa.pa.Be.cRd=!0;var L=new Lh.a;this.$.Ka.Xb(new Vj.a(-2050946363,
na.a.$b,2,0,null)).continueWith(function(oa){L.setResult(!Ug.a(oa)&&oa.result)});return L.task}return(new Ta(this.$)).Ch()}return Xg.Task.Ta(!0)};Ka.prototype.mzj=function(){var L=this.$.xa.pa;return this.$.ea.$8a&&this.$.ea.Elc&&!L.Be.NC&&this.$.ea.MM&&!Oi.c(this.$)};Object(ve.a)(Ka,"NamedSheetViewPublic",null,[648]);var Pi=cg.a;vm(ma,Pi);ma.prototype.create=function(){this.Fb(this.$.da.Aa(309)||new Ka(this.$))};ma.ja=function(L){L.da.Ha(310,new ma(L))};Object(ve.a)(ma,"NamedSheetViewPublicFactory",
cg.a,[]);var Mi=b(1315),zj=b(999),lj=b(585);Object(ve.a)(hc,"NamedSheetViewTeachingCalloutContent",null,[]);Sk.Object.defineProperties(jb.prototype,{f9f:{configurable:!0,enumerable:!0,get:function(){return this.Fie}},o3i:{configurable:!0,enumerable:!0,get:function(){return this.f9f<this.h9f.count?this.h9f.oa(this.Fie++):null}}});Object(ve.a)(jb,"NamedSheetViewTeachingCalloutList",null,[]);var Zg=b(1181);Ja.prototype.kai=function(L){var oa=this;this.g9f=L;var Wa=Object.assign(new ua.a,{});Ja.Gii(L)?
(Wa.add(new hc(pe.a.instance.Va(435),pe.a.instance.Va(436),pe.a.instance.fa(1891),function(){oa.$H(2,"Continue");oa.SJ(!0)},pe.a.instance.fa(1892),function(){oa.SJ();oa.$H(1,"ExitGuide")},Zg.a())),1===L&&Wa.add(new hc(pe.a.instance.fa(1893),pe.a.instance.Va(438),pe.a.instance.fa(1891),function(){oa.$H(2,"FirstEnterTempViewContinueSecond");oa.SJ(!0)},pe.a.instance.fa(1892),function(){oa.SJ();oa.$H(1,"FirstEnterTempViewExitGuideSecond")},Zg.a())),Wa.add(new hc(pe.a.instance.Va(439),pe.a.instance.Va(440),
pe.a.instance.fa(1891),function(){oa.$H(2,"FirstEnterExitCalloutContinue");oa.SJ(!0)},pe.a.instance.fa(1892),function(){oa.SJ();oa.$H(1,"FirstEnterExitCalloutGuide")},Ja.k1e())),Wa.add(new hc(pe.a.instance.fa(1894),pe.a.instance.Va(437),pe.a.instance.fa(1895),function(){oa.t4f();oa.SJ();oa.$H(1,"LearnMore")},pe.a.instance.fa(1896),function(){oa.SJ();oa.$H(1,"Done")},Ja.j1e()))):2===L?Wa.add(new hc(pe.a.instance.fa(1893),pe.a.instance.Va(438),pe.a.instance.fa(1890),function(){oa.SJ();oa.$H(1,"EnterTempViewAfterPersistedView")},
null,null,Zg.a())):3===L&&(Wa.add(new hc(pe.a.instance.Va(435),pe.a.instance.fa(1902),pe.a.instance.fa(1891),function(){oa.$H(2,"AutoOptInExitCalloutContinue");oa.SJ(!0)},pe.a.instance.fa(1892),function(){oa.SJ();oa.$H(1,"AutoOptInExitGuide")},Ja.k1e())),Wa.add(new hc(pe.a.instance.fa(1893),pe.a.instance.Va(438),pe.a.instance.fa(1891),function(){oa.$H(2,"Continue");oa.SJ(!0)},pe.a.instance.fa(1892),function(){oa.SJ();oa.$H(1,"ExitGuide")},Zg.a())),Wa.add(new hc(pe.a.instance.fa(1894),pe.a.instance.Va(437),
pe.a.instance.fa(1895),function(){oa.t4f();oa.SJ();oa.$H(1,"LearnMore")},pe.a.instance.fa(1896),function(){oa.SJ();oa.$H(1,"Done")},Ja.j1e())));this.fVd=new jb(Wa)};Ja.prototype.t4f=function(){var L=new Vj.a(-859308420,na.a.$b,this.$.gd,9,null),oa={};oa=(oa[na.a.Ug]="HelpID=SheetViews",oa.InputMethod=na.a.$b,oa[na.a.ld]=E.a.MZ,oa.ShouldCanvasTakeFocus=!0,oa);this.$.Ka.Xb(L,oa)};Ja.prototype.show=function(L){this.kai(L);this.kdb()};Ja.prototype.Msj=function(L){this.VZb=L};Ja.prototype.kdb=function(){var L=
this,oa=this.fVd.o3i;if(oa){var Wa=Object.assign(new Mi.a,{label:oa.N1i,onExecute:oa.primaryButtonAction}),Rb=null;oa.qXf&&(Rb=Object.assign(new Mi.a,{label:oa.qXf,onExecute:oa.secondaryButtonAction}));oa=Object.assign(new zj.a,{target:oa.targetObject,content:oa.body,title:oa.title,showCloseIcon:!0,primaryButtonProps:Wa,secondaryButtonProps:Rb,useTeachingStyles:!0});oa=this.VZb.callout(oa);Wa=Object.assign(new lj.a,{onShow:function(){L.$H(0)}});this.Bzc=this.VZb.addNotification(oa,Wa);this.SWc||(this.$.Oqd=
!0)}};Ja.prototype.dismiss=function(){this.SJ();this.$H(1,"DismissedByOthers")};Ja.prototype.SJ=function(L){L=void 0===L?!1:L;this.Bzc&&(this.SWc||(this.$.Oqd=!1),this.VZb.removeNotification(this.Bzc),this.Bzc=null);L&&this.kdb()};Ja.prototype.$H=function(L,oa){var Wa={};Wa.a=this.$.ya.UserSessionId;Wa.b=this.g9f;Wa.c=this.fVd.f9f;Wa.d=L;Wa.e=void 0===oa?null:oa;0===L?this.stopwatch=this.$.Vb.Hc("UserAction","ShowNamedSheetViewTeachingCallout"):(this.stopwatch&&(this.stopwatch.stop(),Wa.f=this.stopwatch.Dc,
this.stopwatch=null),2===L&&(this.stopwatch=this.$.Vb.Hc("UserAction","ShowNamedSheetViewTeachingCalloutNext")));Ra.b().Pe(52,Wa,!0)};Ja.j1e=function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};Ja.k1e=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};Ja.Gii=function(L){return 0===L||1===L};Object(ve.a)(Ja,"NamedSheetViewTeachingCallout",null,[647]);var ci=cg.a;vm(db,ci);db.prototype.create=function(){var L=this.$.da.Aa(322);
L||(L=new Ja(this.$),jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.da.Ha(322,L));this.Fb(L)};db.ja=function(L){L.da.Ha(323,new db(L))};Object(ve.a)(db,"NamedSheetViewTeachingCalloutFactory",cg.a,[]);var Ui=b(99),Ri=b(172),Ij=b(1182),mi=b(87),Si=b(1068),wi=Lg.StandardDialog;vm(Na,wi);Na.prototype.GQ=function(){this.jc=5;this.width=40;var L=document.createElement("span");L.id=this.ri("DirectPrintHeaderContent");var oa=document.createElement("span");oa.innerText=CommonUIStrings.l_DirectPrintDialogHeader;
Sys.UI.DomElement.addCssClass(oa,"DirectPrintHeader");this.HP=document.createElement("iframe");this.HP.name="pdfObjectFrame";this.HP.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.HP.onload=Object(qf.a)(this,this.Z1i,"printablePdfLoaded");if(this.HVb&&0<this.HVb.count){var Wa=eg.a.ogd(this.tUb,this.HVb),Rb=eg.a.QId(this.tUb,this.HVb);this.Ul=document.createElement("form");this.Ul.id="printPreviewPostForm";this.Ul.method="POST";this.Ul.target=this.HP.name;this.Ul.action=Rb;Wa=yl(Wa);for(Rb=Wa.next();!Rb.done;Rb=
Wa.next()){Rb=Rb.value;var xc=document.createElement("input");xc.type="hidden";xc.name=Rb.key;xc.value=Rb.value;this.Ul.appendChild(xc)}}else this.HP.setAttribute("src",this.tUb);Sys.UI.DomElement.addCssClass(this.HP,Ri.a.Dce);this.aqg?(Sys.UI.DomElement.addCssClass(this.HP,"DirectPrintPdfObjectHidden"),oa.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Wh.a.Yg(this.HP,Wh.a.ZB,Wh.a.vj)):(Sys.UI.DomElement.addCssClass(this.HP,"DirectPrintPdfObject"),this.Sm.push(this.HP));L.appendChild(oa);
L.appendChild(document.createElement("br"));L.appendChild(this.HP);this.Ul&&L.appendChild(this.Ul);L.appendChild(document.createElement("br"));L.appendChild(this.M1g(this.Ul?"#":this.tUb));this.Mlb.start();this.XBb(CommonUIStrings.l_AppTitle,null,null,null,null,L);this.gX(this.ri("DirectPrintHeaderContent"));this.Ul&&this.Ul.submit();this.H6g();td.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};Na.prototype.M1g=function(L){var oa=document.createElement("span"),Wa=document.createElement("span");
Wa.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;oa.appendChild(Wa);Od.AFrameworkApplication.ga&&(2===Od.AFrameworkApplication.sa.Qa.Pj&&Od.AFrameworkApplication.ga.ra("PPTDisableDirectPrintDialogDownloadPDFLink")||1===Od.AFrameworkApplication.sa.Qa.Pj&&Od.AFrameworkApplication.ga.ra("XLODisableDirectPrintDialogOpenPDFLink"))?(L=document.createElement("span"),2===Od.AFrameworkApplication.sa.Qa.Pj?L.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===Od.AFrameworkApplication.sa.Qa.Pj&&
(L.innerText=CommonUIStrings.l_InternalError_Directive,td.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),this.Zpa=L,oa.appendChild(document.createElement("br")),oa.appendChild(L)):(Wa=document.createElement("a"),Wa.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,Wa.href=L,Wa.target="_blank",Wa.id="PrintPDFLink",Wa.className="AllowBrowserClick",this.Zpa=Wa,oa.appendChild(document.createElement("br")),oa.appendChild(Wa),this.Ul&&ch.a.addHandler(Wa,
"click",Object(qf.a)(this,this.roc,"onSubmit")),this.AP.qa(mg.a.click,this.Zpa,Object(qf.a)(this,this.UJe,"downloadPDFLinkClicked"),null));this.Sm.push(this.Zpa);return oa};Na.prototype.roc=function(L){this.Ul&&(this.Ul.target="_blank",this.Ul.submit());L.preventDefault()};Na.prototype.H6g=function(){if(0<this.Sm.length){var L=new Ij.a(this.Sm),oa=Ui.FocusManager.instance().XQ();oa&&(this.Zpa.focus(),oa.jf=L,oa.v_=!0)}};Na.prototype.UJe=function(){td.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");
return!1};Na.prototype.aud=function(){td.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};Na.prototype.Z1i=function(){td.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Mlb&&this.Mlb.stop()};Na.prototype.dispose=function(){this.Zpa&&(this.AP.za(mg.a.click,this.Zpa,Object(qf.a)(this,this.UJe,"downloadPDFLinkClicked")),this.Zpa=null);mi.a.l0(this.HP);this.HP=null;wi.prototype.dispose.call(this)};Object(ve.a)(Na,"DirectPrintDialog",Lg.StandardDialog,
[666]);Xa.prototype.MOh=function(L,oa,Wa){return new Na(this.AP,L,oa,void 0===Wa?null:Wa)};Object(ve.a)(Xa,"DirectPrintDialogFactory",null,[650]);vm(Ha,Ee);Ha.prototype.Imf=function(){td.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};Ha.prototype.Kmf=function(){Od.AFrameworkApplication.Mm.Bxb(9540);td.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")};Ha.prototype.aud=function(){td.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};Sk.Object.defineProperties(Ha.prototype,
{A$e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},OVd:{configurable:!0,enumerable:!0,get:function(){return Ha.PTa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},$Na:{configurable:!0,enumerable:!0,get:function(){return Ha.PTa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},RVc:{configurable:!0,enumerable:!0,get:function(){var L=[];Array.add(L,CommonUIStrings.l_PrintDialogCanCloseDocument);if(Ee.Zwb){var oa=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;
""!==Od.AFrameworkApplication.sa.Qa.iGe&&(oa=Od.AFrameworkApplication.sa.Qa.iGe);Array.add(L,oa)}return Ha.PTa?L:null}},tjc:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},sjc:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},S4c:{configurable:!0,enumerable:!0,get:function(){return Od.AFrameworkApplication.dIe?"UIFontDialogTextLarge":
null}}});Sk.Object.defineProperties(Ha,{PTa:{configurable:!0,enumerable:!0,get:function(){return!!Od.AFrameworkApplication.sa&&Od.AFrameworkApplication.sa.Qa.rw&&Od.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Cf.a.MC||Cf.a.Af||Cf.a.Df||Cf.a.T6a)&&!Od.AFrameworkApplication.isUnifiedHostMode&&Od.AFrameworkApplication.ga.ra("ShouldHostDefaultToNativeBrowserPrintExperience")},set:function(){}}});Object(ve.a)(Ha,"PrintDialogWithLinkToPdf",Ee,[]);Pa.P6c=",";Object(ve.a)(Pa,
"DirectPrintBrsSettings",null,[]);Object(ve.a)(pa,"DirectPrintProbeResults",null,[]);qa.prototype.start=function(){};qa.prototype.Y3i=function(){var L=Array(this.rC.SSa.length);if(void 0!==this.fkb&&null!==this.fkb)for(var oa=0;oa<this.rC.SSa.length;oa++)L[oa]=this.rC.SSa[oa]in this.fkb&&this.crg(this.fkb[this.rC.SSa[oa]]);return L};qa.prototype.Z3i=function(){for(var L=Array(this.rC.TSa.length),oa=!(void 0===this.DNc||null===this.DNc),Wa=0;Wa<this.rC.TSa.length;Wa++){var Rb=this.rC.TSa[Wa];L[Wa]=
oa&&Rb in this.DNc?!0:this.Frg(Rb)}return L};qa.prototype.f_h=function(){for(var L=this.Y3i(),oa=Array(L.length),Wa=0;Wa<L.length;Wa++)oa[Wa]=L[Wa]?this.jAh(this.fkb[this.rC.SSa[Wa]]):null;return oa};qa.prototype.jAh=function(L){if(void 0===L||null===L)return null;L=L.enabledPlugin;return void 0===L||null===L?null:L.name};qa.prototype.zWh=function(){for(var L=this.f_h(),oa=this.Z3i(),Wa={},Rb={},xc=0;xc<this.rC.SSa.length;xc++)Wa[this.rC.SSa[xc]]=L[xc];for(L=0;L<this.rC.TSa.length;L++)Rb[this.rC.TSa[L]]=
oa[L];return new pa(Wa,Rb)};qa.prototype.$zj=function(){return this.Nrg||!this.rC.isEnabled||Od.AFrameworkApplication.isUnifiedHostMode?!1:this.fIj()};qa.prototype.oxc=function(){if(null!=this.dXb)return this.dXb;var L=qa.Wdf(this.rC);return this.dXb=this.rC.Xdf&&L||this.Jgi()};qa.prototype.Jgi=function(){return Cf.a.ep&&this.rC.Kgi&&Cf.a.Rye>=this.rC.MXg?!0:!1};qa.prototype.fIj=function(){if(!this.Grg(this.rC))return!1;var L=yh.a.Vhd(this.YOc.value.k8f);L=yl(L);for(var oa=L.next();!oa.done;oa=L.next())if(oa=
oa.value,void 0!==oa&&null!==oa)return!0;L=yh.a.Vhd(this.YOc.value.TSa);L=yl(L);for(oa=L.next();!oa.done;oa=L.next())if(oa.value)return!0;return!1};qa.prototype.s6h=function(){var L=yh.a.Vhd(this.YOc.value.k8f);L=yl(L);for(var oa=L.next();!oa.done;oa=L.next())if(va.a.contains(this.rC.E9h,oa.value))return!0;return!1};qa.prototype.H4f=function(L){var oa=void 0===oa?!1:oa;var Wa=void 0===Wa?null:Wa;Od.AFrameworkApplication.sa&&Od.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")?
this.tae(L,Wa):this.$zj()?this.dgh(L,this.s6h()&&!oa,Wa):this.tae(L,Wa)};qa.prototype.dgh=function(L,oa,Wa){Wa=void 0===Wa?null:Wa;var Rb=this.Vwg.Hc("UserAction","OpenDirectPrintDialog");this.uVa.MOh(L,oa,Wa).GQ();Rb.stop()};qa.iif=function(L){try{return new ActiveXObject(L),!0}catch(oa){td.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",L)}return!1};qa.Ydf=function(L){return void 0===L||null===L?!1:!(void 0===L.enabledPlugin||null===L.enabledPlugin)};qa.create=
function(L){var oa=new Pa(Od.AFrameworkApplication.ga.appSettings),Wa=null;try{Wa=window.navigator.mimeTypes}catch(gg){td.ULS.sendTraceTag(573923532,328,15,"Failed to get Window.Navigator.mimeTypes")}var Rb=null;try{Rb=window.navigator.plugins}catch(gg){td.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var xc=qa.Ydf,id=qa.iif;L=L.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var rd=Od.AFrameworkApplication.sa.xD,$d=qa.jif,Be=!!Od.AFrameworkApplication.sa&&
Od.AFrameworkApplication.sa.Qa.rw&&!Od.AFrameworkApplication.ga.ra("PrintDialogFallbackLinkEnabled");return new qa(oa,Wa,Rb,xc,id,L,rd,$d,function(gg,Wg){return new Ha(gg,!1,Wg,!0,Be)},Od.AFrameworkApplication.iMa)};qa.jif=function(L){return Cf.a.ep||Cf.a.Af&&L.Wji||L.Xdf&&qa.Wdf(L)?!0:!1};qa.Wdf=function(L){var oa=Cf.a.wsb;if(oa){var Wa=oa.split(".");if(2===Wa.length)return oa=parseInt(Wa[0]),Wa=parseInt(Wa[1]),oa>L.Cwd||oa===L.Cwd&&Wa>=L.Uqf}return!1};Sk.Object.defineProperties(qa.prototype,{rC:{configurable:!0,
enumerable:!0,get:function(){return this.Tng}}});Object(ve.a)(qa,"DirectPrintManager",null,[645]);ea.prototype.ji=function(L){var oa=this;this.tb=L;L.register(Xa,"Common.App.DirectPrint.DirectPrintDialogFactory").Bc().Lc(function(){return new Xa(Od.AFrameworkApplication.sa.rX)});L.register(645,"Common.App.DirectPrint.IDirectPrintManager").Bc().Lc(function(){return qa.create(oa.tb)})};ea.prototype.init=function(){this.n5d=this.tb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.n5d.start()};
ea.prototype.dispose=function(){};Sk.Object.defineProperties(ea.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});Object(ve.a)(ea,"PackageManager",null,[4,5]);var zi=b(594),Ei=nk.a;vm(ja,Ei);ja.prototype.setFocus=function(){this.Yv.checked?Ie.DOMElementExtensions.setFocus(this.Yv):Ie.DOMElementExtensions.setFocus(this.getButton(0).get_element())};Sk.Object.defineProperties(ja.prototype,{ae:{configurable:!0,enumerable:!0,get:function(){return this.EQb}}});
ja.a5b="printCurrentSelection";Object(ve.a)(ja,"BasePrintDialog",nk.a,[]);var Ai=b(224);vm(da,ja);da.prototype.initialize=function(){td.ULS.sendTraceTag(537154316,0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.kbi();this.vYa(1175);this.addButton(1);ja.prototype.initialize.call(this)};da.prototype.Aha=function(){var L=this;return function(oa,Wa,Rb){var xc=L.$.na.ta,id=L.Gm;oa=L.vja(oa);Wa=L.Jaa(Wa);var rd=L.ae,$d=xc.Na(1,null);$d.printOptions=id;return ia.i(xc,"ValidatePrint",
$d,oa,Wa,Rb,rd,0)}};da.prototype.commit=function(){this.l0g();return!0};da.prototype.$x=function(L,oa,Wa){var Rb,xc=L.Result;if(xc&&oa){var id=0,rd=0;(null===(Rb=xc.SelectedRanges)||void 0===Rb?0:Rb.Ranges)&&0<xc.SelectedRanges.Ranges.length&&xc.SelectedRanges.Ranges[0]&&(id=Math.min(da.O1f(xc.SelectedRanges.Ranges[0]),65535));xc.UsedRange&&(rd=Math.min(da.O1f(Ef.j(Ef.D(xc.UsedRange))),65535));Ai.h(oa,id);Ai.i(oa,rd)}this.Gm=xc;ja.prototype.$x.call(this,L,oa,Wa)};da.prototype.setFocus=function(){this.Nsb.checked?
Ie.DOMElementExtensions.setFocus(this.Nsb):ja.prototype.setFocus.call(this)};da.prototype.kbi=function(){this.Ob.innerHTML=da.S0i(this.$.ea.isNamedObjectViewMode);this.Yv=Ie.DOMElementExtensions.getElementById(this.Ob,ja.a5b);this.Nsb=Ie.DOMElementExtensions.getElementById(this.Ob,"printEntireItem");0!==this.Gm.Type&&this.Gm.UseSelection?(this.Yv.checked=!0,this.Nsb.disabled=!this.Gm.SheetName):(this.Nsb.checked=!0,this.Yv.disabled=0===this.Gm.Type||!tg.g(this.$).ha.va.qh)};da.prototype.l0g=function(){td.ULS.sendTraceTag(51499290,
0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var L=new Sys.StringBuilder;this.vIh(L);var oa=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",Cf.a.Df?0:1);Hh.HelperMethods.vf(L.toString(),"",oa,"PrintDialog.PrintViewUrl")||td.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};da.prototype.vIh=function(L){var oa=this.$.ya;L.append(this.$.Pda+oa.LayoutsRelativeUri+
"/xlprintview.aspx?");Ih.a.Xf(L,E.a.t3i,this.Gm.SessionId);Ih.a.Xf(L,E.a.v3i,this.Yv.checked?"1":"0");if(0===this.Gm.Type)Ih.a.Xf(L,E.a.q3i,this.Gm.ObjectId);else{if(!this.Gm.UsedRangeTooBig){var Wa=Ef.D(this.Gm.UsedRange);(Wa=Ef.x(Wa,this.Gm.SheetName))&&Ih.a.Xf(L,E.a.w3i,Wa)}1===this.Gm.Type?Ih.a.Xf(L,E.a.r3i,this.Gm.ObjectId):(Wa=Ef.B(this.Gm.SelectedRanges.Ranges[0]),Wa=Ef.x(Wa,this.Gm.SheetName),Ih.a.Xf(L,E.a.s3i,Wa))}Vg.a.fGa(L,oa);Ih.a.Xf(L,E.a.u3i,this.Gm.Title)};da.S0i=function(L){return String.format("<div class='"+
ak.a.ko+"'>{0}</div>\r\n\t<div class='"+ak.a.p9c+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",pe.a.instance.fa(1176),ja.a5b,pe.a.instance.fa(1179),"printEntireItem",L?pe.a.instance.fa(1178):pe.a.instance.fa(1177))};da.O1f=function(L){return(L.LastColumn-L.FirstColumn+1)*(L.LastRow-L.FirstRow+1)};Sk.Object.defineProperties(da.prototype,{Ac:{configurable:!0,
enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(ve.a)(da,"HtmlPrintDialog",ja,[]);var vh=b(576),ki=b(64),Og=b(1184),Rj=b(897),Tj=b(285),Pk=b(1012),Wk=b(852);K.prototype.getSheetName=function(){return this.sheetName};K.prototype.getPrintSettings=function(){return this.printSettings};Object(ve.a)(K,"MacroRecorderSheetPrintSettingsSavedPayload",null,[147]);vm(S,ja);S.prototype.initialize=function(){this.z7&&jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&
S.p7g(this.Ob);this.Me?this.QBe(990,null):(this.Wk(),this.vYa(990));ja.prototype.initialize.call(this)};S.prototype.dispose=function(){this.zPj();ja.prototype.dispose.call(this)};S.prototype.close=function(L){td.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",this.Z_,0===L?"with":"without");this.klj();if(this.ns){var oa=this.ONh();!this.QSd&&!this.gaa.checked&&this.$.isEditMode&&this.Djd(oa)&&this.blj(oa)}ja.prototype.close.call(this,
L)};S.prototype.Aha=function(){var L=this;return function(oa,Wa,Rb){return fa(L.$.na.ta,L.$.xa.pa.name,L.locale,L.vja(oa),L.Jaa(Wa),Rb,null)}};S.prototype.$x=function(L,oa,Wa){this.ns=L.Result;this.EIb=this.ns.ScalingWidth;this.DIb=this.ns.ScalingHeight;this.sbd();this.Sai();ja.prototype.$x.call(this,L,oa,Wa)};S.prototype.Wk=function(){td.ULS.sendTraceTag(537154315,0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.lbi();ja.prototype.Wk.call(this)};S.prototype.commit=
function(){this.k0g();return!0};S.prototype.setFocus=function(){this.Me?Ok.a.CAc(this.Tca):this.Tca.checked?Ie.DOMElementExtensions.setFocus(this.Tca):ja.prototype.setFocus.call(this)};S.prototype.Bci=function(){switch(this.dO.xv){case 1:this.Tca.checked=!0;break;case 0:this.Yv.disabled?this.Tca.checked=!0:this.Yv.checked=!0;break;case 2:this.gaa.checked=!0;break;default:td.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.dO.xv),this.dO.xv=1,this.Tca.checked=
!0}};S.prototype.klj=function(){this.dO.xv=this.AZc();this.z7&&(this.dO.ignorePrintArea=this.r5a.checked)};S.prototype.sbd=function(){if(100!==this.ns.ScalingPercent||this.ns.FitToPage&&(1<this.ns.ScalingWidth||1<this.ns.ScalingHeight))this.QSd=!0,this.ns.ScalingWidth=S.k6c,this.ns.ScalingHeight=S.j6c,this.ns.ScalingPercent=S.B5b,this.ns.FitToPage=S.d6c;this.ns.PaperSize.toString()in this.VCd||(this.QSd=!0,this.ns.PaperSize=this.ns.PaperSize===S.ENg?34:S.Irb)};S.prototype.Sai=function(){this.oza=
this.ns.IsLandscape?2:1;this.Y_=this.ns.FitToPage?1===this.ns.ScalingWidth&&1===this.ns.ScalingHeight?1:this.ns.ScalingWidth||1!==this.ns.ScalingHeight?2:3:0;this.Gma=this.ns.PaperSize;this.m8c(this.gaa.checked?!0:!1);this.vOd(this.gaa.checked?!0:!1)};S.prototype.zbi=function(){this.gec.disabled=this.Yv.checked;this.OFb=this.r5a.checked=this.dO.ignorePrintArea};S.prototype.P9g=function(L){this.fAa=document.createElement("select");this.fAa.style.width=224+ki.a.kf;this.fAa.style.height=32+ki.a.kf;this.fAa.setAttribute(E.a.fE,
"scalingElementId");this.eAa=new Wk.a(this.fAa,!0);for(var oa=0,Wa=S.scalingOptions.length;oa<Wa;++oa){var Rb=pe.a.instance.fa(S.Llj[oa]);this.eAa.oM(Rb,S.scalingOptions[oa].toString(),!1)}L.appendChild(this.fAa)};S.prototype.XEe=function(L){this.Zya=document.createElement("select");this.Zya.style.width=224+ki.a.kf;this.Zya.style.height=32+ki.a.kf;this.Zya.setAttribute(E.a.fE,"paperSizeElementId");this.Yya=new Wk.a(this.Zya,!0);for(var oa=0,Wa=S.paperSizeOptions.length;oa<Wa;++oa){var Rb=pe.a.instance.fa(S.GXi[oa]);
this.Yya.oM(Rb,S.paperSizeOptions[oa].toString(),!1)}L.appendChild(this.Zya)};S.prototype.ONh=function(){var L={};L.IsLandscape=2===this.oza;L.PaperSize=this.Gma;L.ScalingWidth=this.EIb;L.ScalingHeight=this.DIb;L.ScalingPercent=100;L.FitToPage=0===this.Y_?!1:!0;return L};S.prototype.CHa=function(){var L=new Sys.StringBuilder;L.append(Pk.a(this.$,"Pdf",!0));this.zia.oxc()&&Ih.a.Xf(L,Mg.a.mfg,"1");Ih.a.Xf(L,Mg.a.YFd,""+this.H6);Ih.a.Xf(L,Mg.a.mLf,this.$.xa.pa.name);0===this.H6&&(Ih.a.Xf(L,Mg.a.lLf,
this.selectedRange),Ih.a.Xf(L,Mg.a.fLf,this.activeCell));Ih.a.Xf(L,Mg.a.gLf,""+this.oza);Ih.a.Xf(L,Mg.a.hLf,""+this.Gma);Ih.a.Xf(L,Mg.a.kLf,""+this.Y_);Ih.a.Xf(L,Mg.a.jLf,"1");Ih.a.Xf(L,Mg.a.eLf,this.OFb?"1":"0");Ih.a.Xf(L,Mg.a.iLf,"1");td.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",L.toString());return L.toString()};S.prototype.ayb=function(){var L=this,oa=null;td.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");
this.$.userOperationManager.hc(new Jc.a(223,0,function(Wa,Rb,xc){Wa=new Tj.a(Wa,null,Rb,xc,null,!0,!1,"GetFileCopyFileHandler","");Wa.correlationID=Yh.a.create().toString();oa=Wa;Od.AFrameworkApplication.Jd.I9(L.CHa(),1,null,null,S.Kad,!1,2,L.nAd,L.mAd,oa,void 0,void 0,void 0,12E4);return Xg.Task.Ta(!0)},16),null)};S.prototype.lbi=function(){td.ULS.sendTraceTag(537154312,0,50,"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.R0i(this.Ob);this.m8c(!0);this.vOd(!0);this.Yv=
Ie.DOMElementExtensions.getElementById(this.Ob,ja.a5b);this.Tca=Ie.DOMElementExtensions.getElementById(this.Ob,"printActiveSheet");this.gaa=Ie.DOMElementExtensions.getElementById(this.Ob,"printEntireWorkbook");this.z7&&(this.gec=Ie.DOMElementExtensions.getElementById(this.Ob,"ignorePrintAreaCheckboxButtonId"),this.r5a=new Rj.a(this.gec));this.Rwc()&&(this.Yv.disabled=!0,this.Gm.SheetName=this.sheetName);this.Bci();this.z7&&this.zbi();this.J9i()};S.prototype.Rwc=function(){return!!this.Gm.ObjectId||
!tg.g(this.$).ha.va.qh};S.prototype.J9i=function(){vh.a.instance.qa(mg.a.change,this.Tca,this.n9a);vh.a.instance.qa(mg.a.change,this.gaa,this.n9a);vh.a.instance.qa(mg.a.change,this.Yv,this.n9a);vh.a.instance.qa(mg.a.change,this.sxa,this.Cmc);vh.a.instance.qa(mg.a.change,this.M$a,this.Cmc);vh.a.instance.qa(mg.a.change,this.Zya,this.Ivf);vh.a.instance.qa(mg.a.change,this.fAa,this.Jvf);this.z7&&this.r5a.knb(this.Hvf)};S.prototype.zPj=function(){vh.a.instance.za(mg.a.change,this.Tca,this.n9a);vh.a.instance.za(mg.a.change,
this.gaa,this.n9a);vh.a.instance.za(mg.a.change,this.Yv,this.n9a);vh.a.instance.za(mg.a.change,this.sxa,this.Cmc);vh.a.instance.za(mg.a.change,this.M$a,this.Cmc);vh.a.instance.za(mg.a.change,this.Zya,this.Ivf);vh.a.instance.za(mg.a.change,this.fAa,this.Jvf);this.z7&&this.r5a.lda(this.Hvf)};S.prototype.R0i=function(L){L.classList.add(Og.a.Q1i);if(!this.Me){document.getElementById("ewaDialogTitle").classList.add(Og.a.printDialogTitle);var oa=document.getElementById("ewaDialogCloseButtonLink");oa.style.top=
32+ki.a.kf;this.rtl?oa.style.left=32+ki.a.kf:oa.style.right=32+ki.a.kf}oa=S.Xy(Og.a.R1i);L.appendChild(oa);var Wa=S.Xy(Og.a.bab,1183);Wa.style.marginBottom=12+ki.a.kf;Wa.id="whatToPrintTitleElementId";oa.appendChild(Wa);Wa=S.Xy(Og.a.aab);oa.appendChild(Wa);S.hrb(Wa,this.rtl,"printActiveSheet",1187,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");oa.appendChild(document.createElement("BR"));Wa=S.Xy(Og.a.aab);oa.appendChild(Wa);
S.hrb(Wa,this.rtl,"printEntireWorkbook",1180,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");oa.appendChild(document.createElement("BR"));Wa=S.Xy(Og.a.aab);oa.appendChild(Wa);S.hrb(Wa,this.rtl,ja.a5b,1179,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.z7?(Wa=S.Xy(Og.a.bab,1212),Wa.style.marginTop=24+ki.a.kf,Wa.id="printAreaElementId",
oa.appendChild(Wa),jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(Wa.style.marginBottom=12+ki.a.kf,Wa=S.Xy(ak.a.q9c),Wa.id="ignorePrintAreaCheckboxWarpperId",Ie.DOMElementExtensions.setVisible(Wa,!0),oa.appendChild(Wa),oa=this.getElementById("ignorePrintAreaCheckboxButtonId"),Ie.DOMElementExtensions.setVisible(oa,!0),Wa.appendChild(oa),oa=this.getElementById("ignorePrintAreaCheckboxLabelId"),Ie.DOMElementExtensions.setVisible(oa,!0),Wa.appendChild(oa)):(Wa=
S.Xy(Og.a.aab),oa.appendChild(Wa),S.i5g(Wa,this.rtl))):(Wa=S.Xy(Og.a.bab,1185),Wa.style.marginTop=24+ki.a.kf,Wa.id="paperSizeElementId",oa.appendChild(Wa),Wa=S.Xy(Og.a.hFd),this.XEe(Wa),oa.appendChild(Wa));oa=S.Xy(Og.a.S1i);L.appendChild(oa);L=S.Xy(Og.a.bab,1184);L.style.marginBottom=12+ki.a.kf;L.id="orientationTitleElementId";oa.appendChild(L);L=S.Xy(Og.a.aab);oa.appendChild(L);S.hrb(L,this.rtl,"portraitRadioButtonId",1190,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId",
"orientationTitleElementId");oa.appendChild(document.createElement("BR"));L=S.Xy(Og.a.aab);oa.appendChild(L);S.hrb(L,this.rtl,"landscapeRadioButtonId",1189,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.z7&&(L=S.Xy(Og.a.bab,1185),L.style.marginTop=12+ki.a.kf,L.id="paperSizeElementId",oa.appendChild(L),L=S.Xy(Og.a.hFd),this.XEe(L),oa.appendChild(L));L=S.Xy(Og.a.bab,1186);L.style.marginTop=(this.z7?10:74)+ki.a.kf;L.id="scalingElementId";
oa.appendChild(L);L=S.Xy(Og.a.hFd);this.P9g(L);oa.appendChild(L);this.Me||document.getElementById("buttonarea").classList.add(Og.a.P1i);this.sxa=Ie.DOMElementExtensions.getElementById(this.Ob,"landscapeRadioButtonId");this.M$a=Ie.DOMElementExtensions.getElementById(this.Ob,"portraitRadioButtonId")};S.prototype.k0g=function(){var L=this;td.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.H6=this.AZc();2!==this.H6&&(this.oza=this.lwe(),this.Yya&&
(this.Gma=S.paperSizeOptions[this.Yya.selectedIndex]),this.eAa&&(this.Y_=S.scalingOptions[this.eAa.selectedIndex]));if(this.$.Gwa&&jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var oa=this.$.na.ta.Zb();this.$.userOperationManager.hc(new Jc.a(133,0,function(Wa,Rb,xc){var id={};id.WhatToPrint=L.H6;id.UseNamedAction=L.zia.oxc();id.SelectedSheetName=L.$.xa.pa.name;id.ActiveCell=L.activeCell;id.SelectedRanges=[L.selectedRange];id.IsPdfDocumentRequired=
!1;id.Orientation=L.oza;id.PaperSize=L.Gma;id.Scaling=L.Y_;id.RichValuesEnabled=!0;L.z7&&(id.IgnorePrintArea=L.OFb);return X(L.$.na.ta,id,Tg.b(L.iDb,Wa),Rb,xc,oa)},16),null)}else this.ayb()};S.prototype.m8c=function(L){this.M$a.disabled=L;this.sxa.disabled=L;this.Yya.Rn.disabled=L;this.eAa.Rn.disabled=L};S.prototype.vOd=function(L){L?(this.sxa.checked=!1,this.M$a.checked=!1,this.Yya.selectedIndex=-1,this.eAa.selectedIndex=-1):(2===this.oza?this.sxa.checked=!0:this.M$a.checked=!0,this.Yya.selectedIndex=
this.VCd[this.Gma.toString()],this.eAa.selectedIndex=this.Y_)};S.prototype.blj=function(L){var oa=this;td.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var Wa=this.$.xa.pa.name,Rb=this.$.na.ta.Zb();this.$.userOperationManager.hc(new Jc.a(226,0,function(xc,id,rd){return ca(oa.$.na.ta,Wa,L,xc,id,rd,Rb)},void 0,function(){return new K(Wa,L)}),null)};S.prototype.Djd=function(L){return this.ns.IsLandscape!==
L.IsLandscape||this.ns.PaperSize!==L.PaperSize||this.ns.FitToPage!==L.FitToPage||this.ns.ScalingHeight!==L.ScalingHeight||this.ns.ScalingWidth!==L.ScalingWidth?!0:!1};S.prototype.lwe=function(){return this.sxa&&this.sxa.checked?2:1};S.prototype.AZc=function(){return this.Yv.checked?0:this.Tca.checked?1:this.gaa.checked?2:1};S.Xy=function(L,oa){L=void 0===L?null:L;oa=void 0===oa?0:oa;var Wa=document.createElement("div");L&&(Wa.className=L);0!==oa&&(Wa.innerHTML=pe.a.instance.fa(oa));return Wa};S.p7g=
function(L){var oa=document.createElement("input");oa.setAttribute("type","checkbox");oa.className=ak.a.zNe;oa.id="ignorePrintAreaCheckboxButtonId";oa.setAttribute("name","ignorePrintAreaCbName");oa.style.height=16+ki.a.kf;oa.style.width=16+ki.a.kf;Ie.DOMElementExtensions.setVisible(oa,!1);var Wa=pe.a.instance.fa(1212),Rb=pe.a.instance.fa(1213);oa.setAttribute(E.a.Et,Wa+ki.a.space+Rb);L.appendChild(oa);oa=document.createElement("label");oa.setAttribute("for","ignorePrintAreaCheckboxButtonId");oa.id=
"ignorePrintAreaCheckboxLabelId";oa.innerHTML=Rb;oa.setAttribute(E.a.XP,"true");oa.style.position="relative";oa.style.marginLeft=15+ki.a.kf;Ie.DOMElementExtensions.setVisible(oa,!1);L.appendChild(oa)};S.i5g=function(L,oa){var Wa=document.createElement("input");Wa.setAttribute("type","checkbox");Wa.id="ignorePrintAreaCheckboxButtonId";Wa.setAttribute("name","ignorePrintAreaCbName");Wa.setAttribute(E.a.fE,"printAreaElementId"+ki.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");Wa.style.height=
16+ki.a.kf;Wa.style.width=16+ki.a.kf;oa?Wa.style.marginRight=0+ki.a.kf:Wa.style.marginLeft=0+ki.a.kf;L.appendChild(Wa);oa=document.createElement("label");oa.setAttribute("for","ignorePrintAreaCheckboxButtonId");oa.setAttribute(E.a.XP,"true");oa.style.position="relative";oa.style.marginLeft=15+ki.a.kf;L.appendChild(oa);L=S.Xy(Og.a.WJf,1213);L.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";oa.appendChild(L)};S.hrb=function(L,oa,Wa,Rb,xc,id,rd,$d){var Be=document.createElement("input");Be.setAttribute("type",
"radio");Be.id=Wa;Be.setAttribute("name",xc);Be.setAttribute(E.a.fE,$d+ki.a.space+rd);Be.style.height=16+ki.a.kf;Be.style.width=16+ki.a.kf;oa?Be.style.marginRight=0+ki.a.kf:Be.style.marginLeft=0+ki.a.kf;L.appendChild(Be);oa=document.createElement("label");oa.setAttribute("for",Wa);oa.style.position="relative";L.appendChild(oa);L=Eg.createClusteredImage(32,32,id,Og.a.Y1i,!0,pe.a.instance.fa(Rb));Rb=S.Xy(Og.a.WJf,Rb);Rb.id=rd;Rb.setAttribute(E.a.XP,"true");rd=S.Xy(Og.a.X1i);rd.appendChild(Rb);oa.appendChild(rd);
oa.appendChild(L)};Sk.Object.defineProperties(S.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"PdfPrintDialog"}}});S.k6c=1;S.j6c=0;S.B5b=100;S.Irb=9;S.d6c=!0;S.ENg=13;S.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];S.GXi=[1192,1193,1200,1194,1195,1196,1197,1198,1191,1201,1202,1203,1204,1205,1206,1207];S.scalingOptions=[0,1,2,3];S.Llj=[1208,1209,1210,1211];S.Kad=["Content-Type"];Object(ve.a)(S,"PdfPrintDialog",ja,[]);Sk.Object.defineProperties(H.prototype,{xv:{configurable:!0,
enumerable:!0,get:function(){return this.H6},set:function(L){0<=L&&2>=L?this.H6=L:(td.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.H6=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.m8d},set:function(L){L||!L?this.m8d=L:td.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});Object(ve.a)(H,"PdfPrintDialogBrowserSessionState",null,[]);var jj=b(1366);Object(ve.a)(T,"MacroRecorderPrintAreaSetPayload",
null,[147]);Object(ve.a)(ba,"MacroRecorderPageBreakInsertedPayload",null,[147]);Object(ve.a)(la,"MacroRecorderPageBreakRemovedPayload",null,[147]);Q.prototype.getSheetName=function(){return this.sheetName};Object(ve.a)(Q,"MacroRecorderPageBreaksAllResetPayload",null,[147]);U.prototype.getSheetName=function(){return this.sheetName};Object(ve.a)(U,"MacroRecorderPrintAreaClearedPayload",null,[147]);var Aj=b(155),nj=b(276);Object(ve.a)(V,"PageBreaksInformation",null,[]);Object(ve.a)(D,"RowColBreak",null,
[]);Object(ve.a)(v,"SharedRange",null,[]);var ni=b(123);J.prototype.executeCommand=function(L,oa,Wa,Rb,xc,id,rd){xc=void 0===xc?null:xc;id=void 0===id?null:id;rd=void 0===rd?null:rd;this.JWd();this.ribbonCommandInfo=oa;this.MFj(oa.command);L=Tg.b(xc,this.sNj);td.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",oa.command);switch(oa.command){case 78661008:return this.u7e(oa,L,id,rd,!1);case 275604654:return this.u7e(oa,L,id,rd,!0);case -13332329:return this.s6e(oa,
L,id,rd);case -837651977:return this.l4h(oa,L,id,rd);case -1778266776:return this.d5h(oa,L,id,rd);case 845325699:return this.p7e(oa,L,id,rd)}return h.a(oa.command)};J.prototype.Jc=function(L,oa){switch(oa.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===L;case 845325699:case -13332329:return!0}return!1};J.prototype.l0f=function(L,oa,Wa){var Rb=tg.g(this.$),xc=Rb.Ca,id=Ef.r(Rb.ha.va.selectedRanges,this.$);if((xc=xc.XE())&&xc.length){xc=yl(xc);for(var rd=xc.next();!rd.done;rd=
xc.next()){rd=rd.value;var $d=rd.Cf;if($d){for(var Be=Ef.j(rd.Zf),gg=[],Wg=yl(id.Ranges),Dh=Wg.next();!Dh.done;Dh=Wg.next()){var ei=Dh.value;ei.FirstRow>Be.LastRow+1||ei.LastRow<Be.FirstRow||ei.FirstColumn>Be.LastColumn+1||ei.LastColumn<Be.FirstColumn||(Dh=this.pWh(Be,ei,$d),ei=this.oWh(Be,ei,$d),gg.push(Object.assign(new v,{FirstRow:Dh.FirstRow,FirstColumn:ei.FirstColumn,LastRow:Dh.LastRow,LastColumn:ei.LastColumn})))}0<gg.length&&!Wa?$d.setPrintArea(gg):0<gg.length&&Wa?$d.addToPrintArea(gg):!Wa&&
$d.hasPrintArea()&&$d.clearPrintArea();!$d.isDirty()&&$d.hasPageLayout()&&$d.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+rd.Xd,4)}}this.WMb(Rb,L,oa)}};J.prototype.HYg=function(L,oa){var Wa=tg.g(this.$),Rb=tg.g(this.$).Ca.XE();if(Rb&&Rb.length){Rb=yl(Rb);for(var xc=Rb.next();!xc.done;xc=Rb.next()){xc=xc.value;var id=xc.Cf;id&&(id.clearPrintArea(),!id.isDirty()&&id.hasPageLayout()&&id.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+xc.Xd,4))}this.WMb(Wa,
L,oa)}};J.prototype.idi=function(L,oa){var Wa=tg.g(this.$),Rb=Wa.Ca,xc=Ef.o(Wa.ha.va.activeCell,this.$);if(xc){var id=Rb.XE();if(id&&id.length){Rb=null;for(var rd=yl(id),$d=rd.next();!$d.done;$d=rd.next()){$d=$d.value;var Be=$d.Cf;if(Be){var gg=Ef.j($d.Zf);if(!(xc.FirstRow>gg.LastRow||xc.FirstRow<gg.FirstRow||xc.FirstColumn>gg.LastColumn||xc.FirstColumn<gg.FirstColumn)&&(Rb=this.A8g(Be,gg,xc),Be.insertPageBreak(Rb),!Be.isDirty()&&Be.hasPageLayout()&&Be.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+
$d.Xd,4),Rb))break}}if(!Rb)for(id=yl(id),$d=id.next();!$d.done;$d=id.next())if(Rb=$d.value,rd=Rb.Cf)Rb=Ef.j(Rb.Zf),Rb=this.WEe(rd,Rb,xc),rd.insertPageBreak(Rb);this.WMb(Wa,L,oa)}}};J.prototype.Yaj=function(L,oa){var Wa=tg.g(this.$),Rb=Wa.Ca,xc=Ef.o(Wa.ha.va.activeCell,this.$);if(xc&&(Rb=Rb.XE())&&Rb.length){Rb=yl(Rb);for(var id=Rb.next();!id.done;id=Rb.next()){id=id.value;var rd=id.Cf;if(rd){var $d=Ef.j(id.Zf);($d=this.WEe(rd,$d,xc))&&rd.removePageBreak($d);!rd.isDirty()&&rd.hasPageLayout()&&rd.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+
id.Xd,4)}}this.WMb(Wa,L,oa)}};J.prototype.$gj=function(L,oa){var Wa=tg.g(this.$),Rb=Wa.Ca.XE();if(Rb&&Rb.length){Rb=yl(Rb);for(var xc=Rb.next();!xc.done;xc=Rb.next()){xc=xc.value;var id=xc.Cf;id&&(id.resetAllPageBreak(),!id.isDirty()&&id.hasPageLayout()&&id.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+xc.Xd,4))}this.WMb(Wa,L,oa)}};J.prototype.u7e=function(L,oa,Wa,Rb,xc){if(!xc){var id=this.$.zb.getItemByName("PRINT_AREA");if(id&&(td.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",
id.type),2===id.type))return this.Pei(),Xg.Task.Ta(!0)}id=tg.g(this.$).ha.va;var rd=Ef.r(id.selectedRanges,this.$);if(1===rd.Ranges.length&&!xc){if(id.jxa())return this.s5h(L,rd,oa,Wa,Rb,xc),Xg.Task.Ta(!0);if(Ef.R(rd.Ranges[0]))return this.$.xa.pa.hasPrintArea?this.s6e(L,oa,Wa,Rb):Xg.Task.Ta(!0)}this.l0f(L.command,Rb,xc);return this.pcf(L,oa,Wa,rd,xc)};J.prototype.s6e=function(L,oa,Wa,Rb){this.HYg(L.command,Rb);return this.Aei(L,oa,Wa)};J.prototype.l4h=function(L,oa,Wa,Rb){this.idi(L.command,Rb);
return this.Mei(L,oa,Wa)};J.prototype.d5h=function(L,oa,Wa,Rb){if(jf.EwaSettings.isChangeGateEnabled("OfficeVSO:4767450_ResetAllPageBreaksOnSelectAllAndRemovePageBreak")){var xc=Ef.r(tg.g(this.$).ha.va.selectedRanges,this.$);if(Ef.R(xc.Ranges[0]))return this.p7e(L,oa,Wa,Rb)}this.Yaj(L.command,Rb);return this.Rei(L,oa,Wa)};J.prototype.p7e=function(L,oa,Wa,Rb){this.$gj(L.command,Rb);return this.Tei(L,oa,Wa)};J.prototype.pcf=function(L,oa,Wa,Rb,xc){function id(){return new T(Rb,xc)}function rd(Be,gg,
Wg){Be=Tg.b(Be,oa);gg=Tg.a(gg,Wa);var Dh=$d.Na(1,null);Dh.selectedRanges=Rb;Dh.addToPrintArea=xc;return ia.i($d,"SetPrintArea",Dh,Be,gg,Wg,null,0)}var $d=this.$.na.ta;return jf.EwaSettings.sc()?Pb.a(this.$.userOperationManager,rd,function(Be){return new Jc.a(241,0,Be,64,id)},L):Pb.a(this.$.userOperationManager,rd,function(Be){return new Fj.a(241,0,Be,void 0,id)},L)};J.prototype.Aei=function(L,oa,Wa){function Rb(){return new U(id)}function xc($d,Be,gg){$d=Tg.b($d,oa);Be=Tg.a(Be,Wa);var Wg=rd.Na(1,
null);Wg.sheetName=id;return ia.i(rd,"ClearPrintArea",Wg,$d,Be,gg,null,0)}var id=this.$.xa.pa.name,rd=this.$.na.ta;return jf.EwaSettings.sc()?Pb.a(this.$.userOperationManager,xc,function($d){return new Jc.a(243,0,$d,64,Rb)},L):Pb.a(this.$.userOperationManager,xc,function($d){return new Fj.a(243,0,$d,void 0,Rb)},L)};J.prototype.Mei=function(L,oa,Wa){function Rb(){return new ba($d)}function xc(Be,gg,Wg){var Dh=id.$.na.ta;Be=Tg.b(Be,oa);gg=Tg.a(gg,Wa);var ei=Dh.Na(9,null);ei.sheetCell=$d;return ia.i(Dh,
"InsertPageBreak",ei,Be,gg,Wg,null,0)}var id=this,rd=tg.g(this.$),$d=Ef.o(rd.ha.va.activeCell,this.$);return jf.EwaSettings.sc()?Pb.a(this.$.userOperationManager,xc,function(Be){return new Jc.a(244,0,Be,64,Rb)},L):Pb.a(this.$.userOperationManager,xc,function(Be){return new Fj.a(244,0,Be,void 0,Rb)},L)};J.prototype.Rei=function(L,oa,Wa){function Rb(){return new la($d)}function xc(Be,gg,Wg){var Dh=id.$.na.ta;Be=Tg.b(Be,oa);gg=Tg.a(gg,Wa);var ei=Dh.Na(9,null);ei.sheetCell=$d;return ia.i(Dh,"RemovePageBreak",
ei,Be,gg,Wg,null,0)}var id=this,rd=tg.g(this.$),$d=Ef.o(rd.ha.va.activeCell,this.$);return jf.EwaSettings.sc()?Pb.a(this.$.userOperationManager,xc,function(Be){return new Jc.a(245,0,Be,64,Rb)},L):Pb.a(this.$.userOperationManager,xc,function(Be){return new Fj.a(245,0,Be,void 0,Rb)},L)};J.prototype.Tei=function(L,oa,Wa){function Rb(){return new Q(rd)}function xc($d,Be,gg){var Wg=id.$.na.ta;$d=Tg.b($d,oa);Be=Tg.a(Be,Wa);var Dh=Wg.Na(9,null);Dh.sheetName=rd;return ia.i(Wg,"ResetAllPageBreaks",Dh,$d,Be,
gg,null,0)}var id=this,rd=this.$.xa.pa.name;return jf.EwaSettings.sc()?Pb.a(this.$.userOperationManager,xc,function($d){return new Jc.a(246,0,$d,64,Rb)},L):Pb.a(this.$.userOperationManager,xc,function($d){return new Fj.a(246,0,$d,void 0,Rb)},L)};J.prototype.pWh=function(L,oa,Wa){if(!L||!oa||!Wa)return null;var Rb=new v;Rb.FirstRow=oa.FirstRow===L.LastRow+1?Wa.getRowIndex(L.LastRow+1)+1:oa.FirstRow<L.FirstRow?0:Wa.getRowIndex(oa.FirstRow+1);Rb.LastRow=oa.FirstRow===L.LastRow+1||oa.LastRow>L.LastRow?
Wa.getRowIndex(L.LastRow+1)+1:Wa.getRowIndex(oa.LastRow+1);return Rb};J.prototype.oWh=function(L,oa,Wa){if(!L||!oa||!Wa)return null;var Rb=new v;Rb.FirstColumn=oa.FirstColumn===L.LastColumn+1?Wa.getColumnIndex(L.LastColumn+1)+1:oa.FirstColumn<L.FirstColumn?0:Wa.getColumnIndex(oa.FirstColumn+1);Rb.LastColumn=oa.FirstColumn===L.LastColumn+1||oa.LastColumn>L.LastColumn?Wa.getColumnIndex(L.LastColumn+1)+1:Wa.getColumnIndex(oa.LastColumn+1);return Rb};J.prototype.A8g=function(L,oa,Wa){if(!oa||!Wa||!L)return null;
var Rb=L.getPrintArea();if(!Rb||!Rb.length)return null;var xc=L.getRowIndex(Wa.FirstRow+1),id=L.getColumnIndex(Wa.FirstColumn+1),rd=null,$d=null;Rb=yl(Rb);for(var Be=Rb.next();!Be.done;Be=Rb.next())if(Be=Be.value,xc>=Be.FirstRow&&xc<=Be.LastRow&&id>=Be.FirstColumn&&id<=Be.LastColumn){if(Wa.FirstRow===Be.FirstRow&&Wa.FirstColumn===Be.FirstColumn)return new V;xc>Be.FirstRow&&(rd=Object.assign(new D,{Index:xc-1,Min:Be.FirstColumn-1,Max:Math.min(Be.LastColumn,L.getColumnIndex(oa.LastColumn+1))}));id>
Be.FirstColumn&&($d=Object.assign(new D,{Index:id-1,Min:Be.FirstRow-1,Max:Math.min(Be.LastRow,L.getRowIndex(oa.LastRow+1))}));break}return rd||$d?Object.assign(new V,{Row:rd?[rd]:null,Col:$d?[$d]:null}):null};J.prototype.L9g=function(L,oa,Wa){if(!oa||!Wa||!L)return null;var Rb=null;Wa.FirstRow>oa.FirstRow&&Wa.FirstRow<=oa.LastRow?Rb=Object.assign(new D,{Index:L.getRowIndex(Wa.FirstRow+1)-1,Min:-1,Max:-1}):Wa.FirstRow===oa.LastRow+1&&(Rb=Object.assign(new D,{Index:L.getRowIndex(oa.LastRow+1),Min:-1,
Max:-1}));return Rb};J.prototype.o5g=function(L,oa,Wa){if(!oa||!Wa||!L)return null;var Rb=null;Wa.FirstColumn>oa.FirstColumn&&Wa.FirstColumn<=oa.LastColumn?Rb=Object.assign(new D,{Index:L.getColumnIndex(Wa.FirstColumn+1)-1,Min:-1,Max:-1}):Wa.FirstColumn===oa.LastColumn+1&&(Rb=Object.assign(new D,{Index:L.getColumnIndex(oa.LastColumn+1),Min:-1,Max:-1}));return Rb};J.prototype.WEe=function(L,oa,Wa){if(!Wa||!L||!oa)return null;var Rb=this.L9g(L,oa,Wa);L=this.o5g(L,oa,Wa);return Rb||L?Object.assign(new V,
{Row:Rb?[Rb]:null,Col:L?[L]:null}):null};J.prototype.Pei=function(){var L=new Lg.StandardDialog;L.jc=0;L.Fc(1,pe.a.instance.fa(4));L.Jk(pe.a.instance.fa(562),pe.a.instance.fa(563),1,null)};J.prototype.MFj=function(L){if(this.Kva.xb(L)&&(Hh.HelperMethods.c_&&(this.GEb=this.$.Vb.Hc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.NKa.xb(L)&&this.NKa.remove(L),this.NKa.add(L,Yh.a.create().toString()),tg.g(this.$).Mi)){var oa=Ra.b()?Ra.b().ui(L):"";tg.g(this.$).Mi.C7(this.Kva.oa(L),this.NKa.oa(L),
oa)}};J.prototype.RWg=function(L){if(this.GEb&&L){var oa=this.GEb.Dc;this.GEb.stop();this.GEb=null;switch(L){case "SetPrintArea":this.Opb(oa,1700,L);break;case "ClearPrintArea":this.Opb(oa,1500,L);break;case "InsertPageBreak":this.Opb(oa,1500,L);break;case "RemovePageBreak":this.Opb(oa,1600,L);break;case "ResetAllPageBreaks":this.Opb(oa,1700,L)}}};J.prototype.Opb=function(L,oa,Wa){L>oa&&(oa=Object.assign(new nj.a,{extendedProperties:new Map}),oa.extendedProperties.set("OperationName",Wa),oa.extendedProperties.set("OperationExecutionTime",
L.toString()),gh.Health.instance.recordQosError(Aj.a.zEj,[ag.a.uEj],!1,!0,!0,!1,oa))};J.prototype.s5h=function(L,oa,Wa,Rb,xc,id){var rd=this,$d=new Lg.StandardDialog,Be=new jj.a(pe.a.instance.fa(560),pe.a.instance.fa(561),pe.a.instance.fa(6),pe.a.instance.fa(5));$d.jc=1;$d.Fc(1,Be.confirmButton);$d.Fc(0,Be.cancelButton);$d.Jk(Be.title,Be.body,3,function(gg){1===gg&&(rd.l0f(L.command,xc,id),rd.pcf(L,Wa,Rb,oa,id))})};J.prototype.WMb=function(L,oa,Wa){Wa();this.NKa.xb(oa)&&L.Mi.O0(this.NKa.oa(oa),Bk.BasicTelemetryCalculator.hR)};
J.prototype.JWd=function(){this.Xpd&&this.$.xe(-1753588160,-1,0,null)};Object(ve.a)(J,"PrintAreaBreakManager",null,[696]);var sj=b(387);r.prototype.equals=function(L){return L?this.orientation===L.orientation&&this.Dca===L.Dca&&this.v0===L.v0&&this.margin===L.margin&&this.sheetPrintOptions===L.sheetPrintOptions&&this.E1a===L.E1a&&this.NoColor===L.NoColor:!1};r.ZCe=function(L,oa){L&&oa&&(oa.xv=L.xv,oa.orientation=L.orientation,oa.Dca=L.Dca,oa.v0=L.v0,oa.margin=L.margin,oa.ignorePrintArea=L.ignorePrintArea,
oa.sheetPrintOptions=L.sheetPrintOptions,oa.E1a=L.E1a,oa.NoColor=L.NoColor)};Object(ve.a)(r,"PrintSettingsContainer",null,[]);var Sj=b(148),Mj=b(339),ok=b(946),Gk=b(908),Kk=b(686);Object(ve.a)(C,"PrintSettingMarginOption",null,[]);Object(ve.a)(u,"PrintSettingMarginValue",null,[]);Object(ve.a)(z,"PrintSettingOption",null,[]);B.prototype.dispose=function(){};B.prototype.Evb=function(L){if(!L)return null;var oa=new u;oa.left=L.Left;oa.right=L.Right;oa.top=L.Top;oa.bottom=L.Bottom;oa.header=L.Header;
oa.footer=L.Footer;return oa};B.prototype.r4c=function(L){td.ULS.shipAssertTag(537154186,0,6===L.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");var oa={};oa.Top=L[0];oa.Bottom=L[1];oa.Left=L[2];oa.Right=L[3];oa.Header=L[4];oa.Footer=L[5];return oa};B.prototype.Wbi=function(){this.Zje=[Object.assign(new z,{printSettingOptionKey:1,printSettingOptionText:this.Lm.fa(1187)}),Object.assign(new z,{printSettingOptionKey:2,printSettingOptionText:this.Lm.fa(1180)}),
Object.assign(new z,{printSettingOptionKey:0,printSettingOptionText:this.Lm.fa(1179)})];this.ide=[Object.assign(new z,{printSettingOptionKey:1,printSettingOptionText:this.Lm.fa(1190)}),Object.assign(new z,{printSettingOptionKey:2,printSettingOptionText:this.Lm.fa(1189)})];this.zde=[Object.assign(new z,{printSettingOptionKey:1,printSettingOptionText:this.Lm.fa(1192)}),Object.assign(new z,{printSettingOptionKey:5,printSettingOptionText:this.Lm.fa(1193)}),Object.assign(new z,{printSettingOptionKey:6,
printSettingOptionText:this.Lm.fa(1200)}),Object.assign(new z,{printSettingOptionKey:7,printSettingOptionText:this.Lm.fa(1194)}),Object.assign(new z,{printSettingOptionKey:8,printSettingOptionText:this.Lm.fa(1195)}),Object.assign(new z,{printSettingOptionKey:9,printSettingOptionText:this.Lm.fa(1196)}),Object.assign(new z,{printSettingOptionKey:11,printSettingOptionText:this.Lm.fa(1197)}),Object.assign(new z,{printSettingOptionKey:12,printSettingOptionText:this.Lm.fa(1198)}),Object.assign(new z,{printSettingOptionKey:13,
printSettingOptionText:this.Lm.fa(1199)}),Object.assign(new z,{printSettingOptionKey:3,printSettingOptionText:this.Lm.fa(1191)})];this.lge=[Object.assign(new z,{printSettingOptionKey:0,printSettingOptionText:this.Lm.fa(1208)}),Object.assign(new z,{printSettingOptionKey:1,printSettingOptionText:this.Lm.fa(1209)}),Object.assign(new z,{printSettingOptionKey:2,printSettingOptionText:this.Lm.fa(1210)}),Object.assign(new z,{printSettingOptionKey:3,printSettingOptionText:this.Lm.fa(1211)})];this.ebe=[Object.assign(new C,
{printSettingOption:Object.assign(new z,{printSettingOptionKey:0,printSettingOptionText:this.Lm.fa(1214)}),marginValue:this.Evb(this.normal)}),Object.assign(new C,{printSettingOption:Object.assign(new z,{printSettingOptionKey:1,printSettingOptionText:this.Lm.fa(1215)}),marginValue:this.Evb(this.wide)}),Object.assign(new C,{printSettingOption:Object.assign(new z,{printSettingOptionKey:2,printSettingOptionText:this.Lm.fa(1216)}),marginValue:this.Evb(this.narrow)}),Object.assign(new C,{printSettingOption:Object.assign(new z,
{printSettingOptionKey:3,printSettingOptionText:this.Lm.fa(1217)}),marginValue:this.Evb(this.G6)})]};B.prototype.Obi=function(){this.normal=this.r4c(this.oEi);this.narrow=this.r4c(this.dDi);this.wide=this.r4c(this.sYj)};Sk.Object.defineProperties(B.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.Zje}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.ide}},paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.zde}},
scalingOptions:{configurable:!0,enumerable:!0,get:function(){return this.lge}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.ebe}}});B.Sch=1;B.Ech=1;B.Irb=9;B.Jch=2;B.Cch=0;B.vch=!1;B.rch=!1;B.dIa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(ve.a)(B,"PrintSettingsManagerBase",null,[3]);var pk=b(120);t.prototype.getSheetName=function(){return this.sheetName};Object(ve.a)(t,"MacroRecorderSheetPrintOptionsSavedPayload",null,[147]);vm(y,
B);y.prototype.Fei=function(L){var oa=this;this.Gei(function(Wa){L&&(Wa=oa.uWh(Wa),L(Wa))})};y.prototype.zMd=function(L,oa){if(L){var Wa=new H(L.xv,L.ignorePrintArea);this.alj(Wa);!oa||this.G5f?td.ULS.sendTraceTag(593294034,0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",oa?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"):(oa=this.wWh(L.v0),oa.IsLandscape=2===L.orientation,oa.PaperSize=L.Dca,this.isUniversalPrintEnabled&&(oa.NoColor=
L.NoColor),this.Ywa&&(oa.PageMargin=this.ygd(L.margin)),oa.SheetPrintOptions=B.dIa,oa.SheetPrintOptions.PrintGrid=L.sheetPrintOptions.PrintGrid,oa.SheetPrintOptions.HorizontalCenter=L.sheetPrintOptions.HorizontalCenter,oa.SheetPrintOptions.VerticalCenter=L.sheetPrintOptions.VerticalCenter,oa.SheetPrintOptions.PrintHeaders=L.sheetPrintOptions.PrintHeaders,this.$kj(oa))}else td.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};
y.prototype.ygd=function(L){var oa={};0===L?oa=this.normal:1===L?oa=this.wide:2===L?oa=this.narrow:3===L&&(oa=this.G6);return oa};y.prototype.Xei=function(L){var oa=this;if(L){td.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");var Wa=function(){return new t(oa.$.xa.pa.name,L)},Rb=this.$.na.ta,xc=this.$.na.ta.Zb(),id=function(rd,$d,Be){var gg=oa.$.xa.pa.name;rd=Tg.b(oa.rBd,rd);$d=Tg.a(oa.ABd,$d);var Wg=Rb.Na(1,null);
Wg.sheetName=gg;Wg.printOptions=L;return ia.i(Rb,"SetPrintOptions",Wg,rd,$d,Be,xc,0)};Wa=jf.EwaSettings.sc()?new Jc.a(598,0,id,64,Wa):new Fj.a(598,0,id,void 0,Wa);this.$.userOperationManager.hc(Wa,null)}else td.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};y.prototype.dispose=function(){this.Md||(this.Md=!0,this.$.userOperationManager.jv(this.HF),this.oY())};y.prototype.alj=function(L){this.dO.xv=L.xv;this.dO.ignorePrintArea=
L.ignorePrintArea};y.prototype.Gei=function(L){function oa($d,Be,gg){return fa(xc.$.na.ta,xc.sheetName,xc.locale,Tg.b($d,Rb),Tg.a(Be,Wa),gg,id)}function Wa($d){$d=Vg.a.og($d.data);td.ULS.sendTraceTag(537154194,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Qg.a.Tc($d));L(null)}function Rb($d){fj.a($d)?td.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Qg.a.Tc($d.Errors)):
(td.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),L($d.Result))}var xc=this,id=this.$.na.ta.Zb();var rd=jf.EwaSettings.sc()?new Jc.a(247,0,oa,80):new Fj.a(247,0,oa,16);rd=this.$.userOperationManager.hc(rd,null);this.ev.add(rd)};y.prototype.$kj=function(L){var oa=this;td.ULS.sendTraceTag(593294031,0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var Wa=this.$.na.ta.Zb();
this.$.userOperationManager.hc(new Jc.a(226,0,function(Rb,xc,id){return ca(oa.$.na.ta,oa.sheetName,L,Tg.b(Rb,oa.nSi),Tg.a(xc,oa.mSi),id,Wa)},void 0,function(){return new K(oa.sheetName,L)}),null)};y.prototype.Lli=function(L){return this.Ddf(L)||!this.ygf(L.PaperSize)};y.prototype.sbd=function(L){this.Ddf(L)&&(td.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),L.ScalingWidth=y.k6c,L.ScalingHeight=y.j6c,L.ScalingPercent=y.B5b,
L.FitToPage=y.d6c);this.ygf(L.PaperSize)||(td.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",L.PaperSize.toString()),L.PaperSize=y.Irb);return L};y.prototype.sWh=function(L){if(L.FitToPage){if(1===L.ScalingWidth&&1===L.ScalingHeight)return 1;if(!L.ScalingWidth&&1===L.ScalingHeight)return 3}else return 0;return 2};y.prototype.rWh=function(L){return this.Hpd(L,this.normal)?0:this.Hpd(L,this.wide)?
1:this.Hpd(L,this.narrow)?2:3};y.prototype.Hpd=function(L,oa){return L.Left===oa.Left&&L.Right===oa.Right&&L.Top===oa.Top&&L.Bottom===oa.Bottom&&L.Header===oa.Header&&L.Footer===oa.Footer};y.prototype.wWh=function(L){var oa={};oa.ScalingPercent=y.B5b;oa.FitToPage=0!==L;2===L?(oa.ScalingWidth=1,oa.ScalingHeight=0):3===L?(oa.ScalingWidth=0,oa.ScalingHeight=1):1===L&&(oa.ScalingWidth=1,oa.ScalingHeight=1);return oa};y.prototype.ygf=function(L){return this.FXi.contains(L.toString())};y.prototype.Ddf=
function(L){return 100!==L.ScalingPercent||L.FitToPage&&(1<L.ScalingWidth||1<L.ScalingHeight)};y.prototype.f3g=function(){for(var L=new Kk.a(Ca.a.Hk()),oa=0;oa<this.paperSizeOptions.length;oa++)L.add(this.paperSizeOptions[oa].printSettingOptionKey.toString());return L};y.prototype.uWh=function(L){var oa=null;if(L){var Wa=this.dO.xv,Rb=this.dO.ignorePrintArea;this.Lli(L)&&(this.G5f=!0,L=this.sbd(L));oa=new r;oa.xv=Wa;oa.ignorePrintArea=Rb;oa.orientation=L.IsLandscape?2:1;oa.Dca=L.PaperSize;oa.v0=this.sWh(L);
oa.sheetPrintOptions=B.dIa;oa.sheetPrintOptions.PrintGrid=L.SheetPrintOptions.PrintGrid;oa.E1a=L.Draft;this.isUniversalPrintEnabled&&(oa.NoColor=L.NoColor);oa.sheetPrintOptions.HorizontalCenter=L.SheetPrintOptions.HorizontalCenter;oa.sheetPrintOptions.VerticalCenter=L.SheetPrintOptions.VerticalCenter;oa.sheetPrintOptions.PrintHeaders=L.SheetPrintOptions.PrintHeaders;this.Ywa&&(oa.margin=this.rWh(L.PageMargin),jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&td.ULS.sendTraceTag(553965398,
0,50,"PageMargin received : {0}",oa.margin),3===oa.margin&&(this.G6={},this.G6.Left=L.PageMargin.Left,this.G6.Right=L.PageMargin.Right,this.G6.Top=L.PageMargin.Top,this.G6.Bottom=L.PageMargin.Bottom,this.G6.Header=L.PageMargin.Header,this.G6.Footer=L.PageMargin.Footer))}return oa};y.prototype.oY=function(){if(this.ev){for(var L=yl(this.ev),oa=L.next();!oa.done;oa=L.next())oa=oa.value,this.$&&this.$.userOperationManager&&(oa.operation&&td.ULS.sendTraceTag(537154187,0,50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",
pk.a(oa.operation.operationName)),this.$.userOperationManager.iIa(oa)),this.ev.remove(oa);this.ev=null}};y.k6c=1;y.j6c=0;y.B5b=100;y.Irb=9;y.d6c=!0;Object(ve.a)(y,"PrintSettingsManager",B,[]);Object(ve.a)(x,"PrintSettingsTaskPaneCallbacks",null,[]);Object(ve.a)(f,"SelectedPrintSettings",null,[]);Object(ve.a)(m,"PrintOperationCallbacks",null,[]);Object(ve.a)(n,"PrintPreviewPaneCallbacks",null,[]);var uk=b(1183);Object(ve.a)(l,"UniversalPrintAppSettings",null,[]);var fl=b(376);e.prototype.JGg=function(L){this.Ma.addHandler("ppocek",
L)};e.prototype.Hdj=function(L){this.Ma.removeHandler("ppocek",L)};e.prototype.uCj=function(L,oa){this.xhj();this.$.userOperationManager.lx(this.HF);this.Gm=L;this.Ma.raiseEvent("ppocek");this.Gm.SelectedRanges&&this.Gm.SelectedRanges.Ranges&&0<this.Gm.SelectedRanges.Ranges.length&&this.Gm.SelectedRanges.Ranges[0]&&(this.selectedRange=Ef.B(this.Gm.SelectedRanges.Ranges[0]).toString());td.ULS.shipAssertTag(537154268,0,!this.fv,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");
this.fv=new y(this,this.$,oa,this.$.xa.pa.name,pe.a.instance,this.isUniversalPrintEnabled);td.ULS.shipAssertTag(537154267,0,!this.tg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.tg=new Gk.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.tg.vgh();this.tg.wCj();this.tg.$Fg(this.aBf)};e.prototype.HTh=function(){this.fv.G6&&4<=this.fv.marginDetailedOptions.length&&(this.fv.marginDetailedOptions[3].marginValue=this.fv.Evb(this.fv.G6));
return this.fv.marginDetailedOptions};e.prototype.Rwc=function(){return!!this.Gm&&!!this.Gm.ObjectId||!tg.g(this.$).ha.va.qh};e.prototype.xWh=function(){var L=Object.assign(new f,{selectedWhatToPrint:B.Sch,selectedOrientation:B.Ech,selectedPaperSize:B.Irb,selectedScaling:B.Jch,selectedMargin:B.Cch,selectedIgnorePrintArea:B.vch,selectedPrintGridlines:B.dIa.PrintGrid,selectedDraft:B.rch,selectedHorizontalCenter:B.dIa.HorizontalCenter,selectedVerticalCenter:B.dIa.VerticalCenter,selectedRowAndColumnHeadings:B.dIa.PrintHeaders});
this.DH?(L.selectedWhatToPrint=this.DH.xv,L.selectedOrientation=this.DH.orientation,L.selectedPaperSize=this.DH.Dca,L.selectedScaling=this.DH.v0,this.Ywa&&(L.selectedMargin=this.DH.margin),L.selectedIgnorePrintArea=this.DH.ignorePrintArea,L.selectedPrintGridlines=this.DH.sheetPrintOptions.PrintGrid,L.selectedDraft=this.DH.E1a,this.isUniversalPrintEnabled&&(L.selectedColor=this.DH.NoColor?0:1),L.selectedHorizontalCenter=this.DH.sheetPrintOptions.HorizontalCenter,L.selectedVerticalCenter=this.DH.sheetPrintOptions.VerticalCenter,
L.selectedRowAndColumnHeadings=this.DH.sheetPrintOptions.PrintHeaders):td.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return L};e.prototype.u2e=function(){var L=this;return Object.assign(new n,{onBackToSheet:function(){L.$la()}})};e.prototype.tWh=function(){var L=this;return Object.assign(new uk.a,{backActionButtonText:pe.a.instance.fa(1167),printPreviewPaneCallbacks:this.u2e(),logger:new sj.a,disableTellMeControl:!0,printOperationCallbacks:Object.assign(new m,
{onClosePreviewer:function(){L.$la()},getGraphServiceAuthorizationToken:this.R$b(),onLocalPrint:function(){L.SBf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object.assign(new l,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.dgi()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,appName:"Excel"})})};e.prototype.vWh=function(){var L=this;return Object.assign(new x,{onSettingChange:function(oa){L.ZQi(oa)},
onPrint:function(){L.SBf()}})};e.prototype.ZQi=function(L){this.Z_++;L?(this.tg&&this.tg.nDj(),this.tk.xv=L.selectedWhatToPrint,this.tk.v0=L.selectedScaling,this.tk.orientation=L.selectedOrientation,this.tk.Dca=L.selectedPaperSize,this.isUniversalPrintEnabled&&(this.tk.NoColor=!L.selectedColor),this.Ywa&&(this.tk.margin=L.selectedMargin),this.tk.ignorePrintArea=L.selectedIgnorePrintArea,this.$sj(L.selectedPageStart,L.selectedPageEnd),this.fv&&this.C6h(this.tk,L)?(this.tk.sheetPrintOptions=B.dIa,this.tk.sheetPrintOptions.PrintGrid=
L.selectedPrintGridlines,this.tk.sheetPrintOptions.HorizontalCenter=L.selectedHorizontalCenter,this.tk.sheetPrintOptions.VerticalCenter=L.selectedVerticalCenter,this.tk.sheetPrintOptions.PrintHeaders=L.selectedRowAndColumnHeadings,this.fv.Xei(this.tk.sheetPrintOptions)):this.ayb()):td.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};e.prototype.$la=function(){this.$5a&&(this.ULb=!0);td.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",
this.Z_);this.RBf();this.$ye()};e.prototype.SBf=function(){td.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",this.Z_);this.Ywa&&jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&td.ULS.sendTraceTag(543024129,0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.tk.margin,this.DH.margin);if(this.useMSPdfViewer)this.SJf();else if(this.F6a)try{this.tg.printPdf(),
this.l1c()}catch(L){td.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.SJf()}else this.zia.H4f(this.CHa(!0)),this.l1c()};e.prototype.SJf=function(){var L=this.CHa(!0);this.l1c();Hh.HelperMethods.vf(L,void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};e.prototype.dispose=function(){hg.a.Fa(this.Ma)};e.prototype.ayb=function(){var L=this;if(this.$.Gwa)this.Cei();else{this.oY();this.AUf();var oa=null;this.obi();td.ULS.sendTraceTag(593266766,
0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var Wa=function(Rb,xc,id){Rb=new Tj.a(Rb,null,xc,id,null,!0,!1,"GetFileCopyFileHandler","");Rb.correlationID=Yh.a.create().toString();oa=Rb;L.Sba=L.i3.I9(L.CHa(L.F6a?!1:!0,L.Xfi?"Base64":"Pdf"),1,null,null,e.Kad,!1,2,L.nAd,L.mAd,oa,void 0,void 0,void 0,12E4);Rb.requestId=L.Sba;td.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",L.Sba);return Xg.Task.Ta(!0)};
this.hNa=jf.EwaSettings.sc()?this.$.userOperationManager.hc(new Jc.a(223,0,Wa,80),null):this.$.userOperationManager.hc(new Fj.a(223,0,Wa,16),null)}};e.prototype.l1c=function(){this.RBf();this.$ye()};e.prototype.rBd=function(L){Qg.a.er(L.Errors)?this.tg.showErrorMessageForPrintOptions(pe.a.instance.fa(1218)):(td.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.ayb(),this.tg&&this.tg.hideErrorMessageForPrintOptions())};
e.prototype.ABd=function(L){this.tg&&this.tg.showErrorMessageForPrintOptions(pe.a.instance.fa(1218));L=Vg.a.og(L.data);td.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",Qg.a.Tc(L))};e.prototype.Cei=function(){function L(Rb,xc,id){var rd={};rd.WhatToPrint=oa.tk.xv;rd.UseNamedAction=oa.zia.oxc();rd.SelectedSheetName=oa.$.xa.pa.name;rd.ActiveCell=oa.activeCell;rd.SelectedRanges=[oa.selectedRange];rd.IsPdfDocumentRequired=
!1;rd.Orientation=oa.tk.orientation;rd.PaperSize=oa.tk.Dca;rd.Scaling=oa.tk.v0;rd.RichValuesEnabled=!0;rd.IgnorePrintArea=oa.tk.ignorePrintArea;rd.Preview=!0;oa.isUniversalPrintEnabled&&(rd.NoColor=oa.tk.NoColor);oa.i2f()&&(rd.PaginationStartPage=oa.Wya,rd.PaginationEndPage=oa.tma,rd.OutputTotalPdfPageCount=!0);if(oa.Ywa){var $d=oa.fv.ygd(oa.tk.margin);$d&&(rd.PageMargin={},rd.PageMargin.Top=$d.Top,rd.PageMargin.Bottom=$d.Bottom,rd.PageMargin.Left=$d.Left,rd.PageMargin.Right=$d.Right,rd.PageMargin.Header=
$d.Header,rd.PageMargin.Footer=$d.Footer)}oa.H7a=X(oa.$.na.ta,rd,Tg.b(oa.KJi,Rb),Tg.a(oa.JJi,xc),id,Wa);return oa.H7a}var oa=this;td.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.oY();var Wa=this.$.na.ta.Zb();jf.EwaSettings.sc()?this.hNa=this.$.userOperationManager.hc(new Jc.a(133,0,L,80),null):this.hNa=this.$.userOperationManager.hc(new Fj.a(133,0,L,16),null)};e.prototype.$ye=function(){this.$.userOperationManager.jv(this.HF);
this.oY();this.AUf();td.ULS.shipAssertTag(537154261,0,!!this.tg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.tg&&(this.tg.idj(this.aBf),this.tg.Egh(),this.tg=null);this.Gm=null;this.fv&&(this.fv.dispose(),this.fv=null);this.b3a=this.TEb=null;this.iLc=!1;this.Ma&&this.Ma.raiseEvent("ppocek")};e.prototype.cyj=function(){return this.$.isEditMode&&!!this.DH&&!!this.tk&&2!==this.tk.xv&&this.Djd()};e.prototype.zMd=function(){td.ULS.shipAssertTag(537154260,0,
!!this.fv,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.fv&&this.fv.zMd(this.tk,this.cyj())};e.prototype.CHa=function(L,oa){oa=void 0===oa?"Pdf":oa;var Wa=new Sys.StringBuilder;Wa.append(Pk.a(this.$,oa,!0));Ih.a.Xf(Wa,Mg.a.YFd,""+this.tk.xv);L&&this.zia.oxc()&&Ih.a.Xf(Wa,Mg.a.mfg,"1");Ih.a.Xf(Wa,Mg.a.mLf,this.$.xa.pa.name);0===this.tk.xv&&(Ih.a.Xf(Wa,Mg.a.lLf,this.selectedRange),Ih.a.Xf(Wa,Mg.a.fLf,this.activeCell));Ih.a.Xf(Wa,Mg.a.gLf,""+this.tk.orientation);
Ih.a.Xf(Wa,Mg.a.hLf,""+this.tk.Dca);Ih.a.Xf(Wa,Mg.a.kLf,""+this.tk.v0);Ih.a.Xf(Wa,Mg.a.jLf,"1");Ih.a.Xf(Wa,Mg.a.eLf,this.tk.ignorePrintArea?"1":"0");Ih.a.Xf(Wa,Mg.a.iLf,"1");this.nKg(Wa);this.isUniversalPrintEnabled&&Ih.a.Xf(Wa,Mg.a.S3i,this.tk.NoColor?"1":"0");this.Ywa&&this.mKg(Wa);Ib.a.equals(oa,"Pdf",!0)&&(Wa.append("&#toolbar=0"),Wa.append("&zoom=100"));L=Wa.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");td.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url {0}",
L);return L};e.prototype.$sj=function(L,oa){L||oa?(this.qyb=!0,this.Wya=L,this.tma=oa):this.OTf()};e.prototype.nKg=function(L){this.i2f()&&(Ih.a.Xf(L,Mg.a.U3i,""+this.Wya),Ih.a.Xf(L,Mg.a.T3i,""+this.tma),Ih.a.Xf(L,Mg.a.V3i,"1"),td.ULS.sendTraceTag(537154258,0,50,"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",this.Wya,this.tma))};e.prototype.i2f=function(){return null!=this.Wya&&0<this.Wya&&null!=this.tma&&0<this.tma};e.prototype.mKg=function(L){if(this.fv&&
this.tk){var oa=this.fv.ygd(this.tk.margin);oa&&Ih.a.Xf(L,Mg.a.R3i,""+oa.Top+" "+oa.Bottom+" "+oa.Left+" "+oa.Right+" "+oa.Header+" "+oa.Footer)}};e.prototype.iDb=function(L,oa,Wa,Rb){this.tg&&(td.ULS.shipAssertTag(537154255,0,!!this.$.xa.pa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),this.$.xa.pa&&(this.F6a?(Rb||(Rb=this.CHa(!1)),this.tg.Dti(Rb)):this.oCj()))};e.prototype.Djd=function(){return!this.DH.equals(this.tk)};e.prototype.RBf=function(){!this.ULb&&
0<this.Z_&&(this.Ypd?this.zMd():td.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));td.ULS.shipAssertTag(537154250,0,!!this.tg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.tg&&this.tg.M7h();this.JWd()};e.prototype.vi=function(){td.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.tg){var L=this.bAa(pe.a.instance.fa(1));this.Sna(L,
1)}else L=Qg.a.hd(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),jf.EwaSettings.oz()?new Mj.a(this.$,L):(new Sj.ErrorDialog(this.$,L)).mf()};e.prototype.vCj=function(L){L?(0===L.xv&&this.Rwc()&&(td.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",this.Gm.ObjectId?"floatingObject":"discontinuousRange"),L.xv=1),r.ZCe(L,this.DH),r.ZCe(L,this.tk),td.ULS.shipAssertTag(537154248,0,!!this.tg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),
this.tg&&(this.Ypd=!0,this.tg.xCj(),this.ayb())):(td.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.vi())};e.prototype.$_c=function(L,oa,Wa){L>oa&&(oa=Object.assign(new nj.a,{extendedProperties:new Map}),oa.extendedProperties.set("WtpSelectedValue",Wa),oa.extendedProperties.set("FullyRenderedPdfLoadTime",L.toString()),gh.Health.instance.recordQosError(Aj.a.xEj,[ag.a.O5f],!1,!0,!0,!1,oa))};e.prototype.oY=function(){this.hNa&&
(0<this.Sba||this.H7a)&&(td.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.Sba),this.$.userOperationManager.iIa(this.hNa),this.H7a?Vg.a.ou(this.H7a.Ft):this.i3.ou(this.Sba),this.eLd())};e.prototype.eLd=function(){this.H7a=this.hNa=null};e.prototype.obi=function(){this.uKd&&this.tk&&(this.b3a=this.$.Vb.Hc("UserAction",(1===this.tk.xv?"ActiveSheet":0===this.tk.xv?"CurrentSelection":"EntireWorkbook")+"FullyRenderedPdfLoadTimeStopwatch"))};
e.prototype.OTf=function(){this.qyb=!1;this.Wya=1;this.tma=this.kFd};e.prototype.bAa=function(L){if(L)return L.replace("&#39;","'");td.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return L};e.prototype.oCj=function(){td.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");if(this.kzb)if(this.ahc)td.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");
else{var L=this.bAa(pe.a.instance.fa(1172));this.Sna(L,2)}else L=this.bAa(pe.a.instance.fa(1173)),this.Sna(L,3)};e.prototype.Sna=function(L,oa,Wa){this.tg.Jz(L,oa,void 0===Wa?null:Wa)};e.prototype.Abi=function(){this.ahc=this.Iye();this.kzb=this.nXg();this.F6a=this.oXg();td.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentBrowser : {0}, isPdfPreviewSupportedInCurrentHost: {1}, isPdfPreviewSupportedInPreviewer: {2}",this.ahc,this.kzb,
this.F6a)};e.prototype.xhj=function(){this.E7a=null;this.eLd();this.OTf();this.TEb=this.$.Vb.Hc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.pa.activeCell.toString();this.Z_=0;this.Ypd=this.$5a=this.ULb=!1;this.iLc=!0};e.prototype.bAj=function(){var L=this.soi()||this.Fif()&&jf.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!0:!1;td.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",L);return L};e.prototype.Iye=function(){return!Cf.a.cB};
e.prototype.XWg=function(){var L=15;Cf.a.MH&&Cf.a.wsb&&(L=parseFloat(Cf.a.wsb));return this.Iye()&&14<L&&this.kzb};e.prototype.nXg=function(){return this.Fif()&&!jf.EwaSettings.isChangeGateEnabled("OfficeVSO:6059097_EnablePreviewer3rdParty")?!1:!0};e.prototype.soi=function(){return Cf.a.MC||Od.AFrameworkApplication.isUnifiedHostMode};e.prototype.oXg=function(){return this.ahc&&this.kzb};e.prototype.Fif=function(){return!this.$.jg.get(111)};e.prototype.AUf=function(){this.E7a&&(URL.revokeObjectURL(this.E7a),
this.E7a=null)};e.prototype.d5g=function(L){var oa=L.data.ie;L=this.$.Vb.Hc("UserAction","PrintPreviewBlobFileCreation");var Wa=window.self.atob(oa);oa=new Uint8Array(oa.length);for(var Rb=0;Rb<Wa.length;Rb++)oa[Rb]=Wa.charCodeAt(Rb)&255;Wa=new Blob([oa],{type:"application/pdf"});this.E7a=URL.createObjectURL(Wa);td.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",L.Dc,Wa.size);L.stop();return this.E7a+
"#toolbar=0&zoom=100"};e.prototype.Z7i=function(L){if(this.uKd&&Qg.a.kh(L,e.RYi)){var oa=Object.assign(new nj.a,{extendedProperties:new Map});oa.extendedProperties.set("ErrorMessageIdName",L[0].MessageIdName);gh.Health.instance.recordQosError(Aj.a.QJf,[ag.a.RJf],!1,!0,!0,!1,oa)}};e.prototype.C6h=function(L,oa){return L.sheetPrintOptions.PrintGrid!==oa.selectedPrintGridlines||L.sheetPrintOptions.HorizontalCenter!==oa.selectedHorizontalCenter||L.sheetPrintOptions.VerticalCenter!==oa.selectedVerticalCenter||
L.sheetPrintOptions.PrintHeaders!==oa.selectedRowAndColumnHeadings};e.prototype.JWd=function(){this.Xpd&&this.$.xe(-1753588160,-1,0,null)};e.prototype.dgi=function(){return!!this.$.ya&&!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};e.prototype.getToken=function(){return this.Pyd.FS("Print",this.graphServiceEndpoint).then(function(L){return L?(L.IsSuccess||td.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",
L.ErrorCode,L.ErrorMessage),L):Object.assign(new ok.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(L){var oa=new ok.a;Object.getType(L)===Object.getType(oa)?oa=L:(oa.ErrorMessage=L.toString(),oa.ErrorCode="exception");return Promise.resolve(oa)})};e.prototype.R$b=function(){var L=this;return function(){var oa=Promise.resolve("");try{if(L.Pyd&&L.Pyd.TLa())return L.getToken().then(function(Wa){return Wa.IsSuccess?Promise.resolve(Wa.Token):oa},function(){return oa})}catch(Wa){td.ULS.sendTraceTag(537154211,
0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",Wa)}return oa}};e.prototype.onNotifyPrintJobStatus=function(L,oa){L=fl.a.Iy.notificationBar.M$(L,!1);"pending"==oa&&(L.displayTimeoutSeconds=3);L.image=0;fl.a.Iy.notificationBar.$D(L)};Sk.Object.defineProperties(e.prototype,{Kli:{configurable:!0,enumerable:!0,get:function(){return this.iLc}}});e.RYi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,
-2077518688,1348242499,2030854436,-1831476778];e.Kad=["Content-Type","Total-Pdf-PageCount"];Object(ve.a)(e,"PrintPreviewManager",null,[694,3,695]);c.prototype.Yc=function(){return!1};c.prototype.executeCommand=function(L,oa,Wa,Rb){var xc=oa.command;return 1588554917===xc?(oa.yyb=!0,yk.a(this.$)&&this.$.da.Aa(423).Fxc(!1),this.mhh(oa)?Xg.Task.Ta(!0):h.a(xc)):this.OJf.executeCommand(L,oa,Wa,Rb,this.FQi,this.EQi,this.mNj)};c.prototype.Jc=function(L,oa){return 1588554917===oa.command?(td.ULS.shipAssertTag(537154305,
0,this.$.Gka,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.OJf.Jc(L,oa)};c.prototype.fd=function(){return!1};c.prototype.mhh=function(L){return this.$.ea.qc?this.nhh(L):!1};c.prototype.nhh=function(L){td.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var oa=this.$.Vb.Hc("UserAction","DoPrintHtml"),Wa=this.$,Rb=this.ea.isNamedObjectViewMode?Wa.zb.pa.sheetName:Wa.xa.pa.name,xc=this.ea.isNamedObjectViewMode,id=!xc;Wa=this.qWh(Wa,Rb,
id);var rd=!0;!jf.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.Gwa&&(rd=!1);id?rd?zi.a(this.$)?td.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.jD.uCj(Wa,this.dO),td.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):((new S(this.$,pe.a.instance.fa(1181),3,Wa,L,this.zia,Rb,this.dO)).mf(),td.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",
oa.Dc)):((new da(this.$,pe.a.instance.fa(1181),3,Wa,L)).mf(),td.ULS.sendTraceTag(591196514,0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",oa.Dc,xc));oa.stop();this.cjd();return!0};c.prototype.qWh=function(L,oa,Wa){var Rb={};Rb.SessionId=this.ea.sessionId;Rb.UsedRangeTooBig=!1;var xc=tg.g(L),id=xc.ha,rd=id.Ve;if(xi.e(L.pa))Rb.Type=0,Rb.ObjectId=L.pa.name,Rb.UseSelection=!1;else if(xi.g(L.pa))Rb.Type=1,Rb.ObjectId=L.pa.nka,Rb.UseSelection=
!0;else if(2===rd||4===rd||64===rd)xc=id.Pa.lc.floatingObject,Rb.Type=1,Rb.SheetName=oa,Rb.ObjectId=xc.id,Rb.UseSelection=!0;else if(Wa&&rd&470)Rb.ObjectId=id.Pa.lc.floatingObject.id,Rb.SheetName=oa;else if(xi.i(L.pa)){Rb.Type=2;Rb.SheetName=oa;if(id.va.qh)if(Wa=id.va.Sd,Rb.SelectedRanges=Ef.q(Wa,L),20<Wa.pU)Rb.UseSelection=!0;else{oa=0;xc=xc.xl("PrintCommandHandler.DoPrintHtml",Wa);try{for(xc.$$rst();xc.$$mn()&&2>oa;)xc.$$cu().text&&oa++;Rb.UseSelection=2<=oa}finally{xc&&xc.dispose()}}else Rb.UseSelection=
!1,Rb.SelectedRanges=Ef.q(id.va.activeRange,L);this.ea.isNamedObjectViewMode&&(Rb.UsedRange=Ef.v(L.pa.usedRange,L))}Rb.Title=L.workbookContext.WorkbookFileName;return Rb};c.prototype.cjd=function(){tg.g(this.$);if(!this.s2f){this.NQc=!0;var L=this.$.Vb.Hc("UserAction","HandlePageLayoutRendering");this.BNj();td.ULS.sendTraceTag(537154274,0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",L.Dc);L.stop()}};c.prototype.BNj=function(){for(var L=tg.g(this.$).Ca,oa=L.XE(),
Wa=!1,Rb=0,xc=0;xc<oa.length;xc++){var id=oa[xc],rd=id.Cf;rd&&rd.hasPageLayout()&&(Wa=!0,rd.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+id.Xd,4),Rb++)}Wa&&(td.ULS.sendTraceTag(537154273,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",oa.length,Rb),L.wyd())};Sk.Object.defineProperties(c.prototype,{s2f:{configurable:!0,enumerable:!0,get:function(){return this.NQc}}});Object(ve.a)(c,"PrintCommandHandler",
null,[188,674]);var gl=$g.a;vm(a,gl);a.prototype.Od=function(){var L=this,oa=Od.AFrameworkApplication.ga.appSettings,Wa=this.$.ya.DirectPrintSetting;oa.DirectPrintIsEnabled=Wa.DirectPrintIsEnabled.toString();oa.DirectPrintProbeIsEnabled=Wa.DirectPrintProbeIsEnabled.toString();oa.DirectPrintEnabledForInternetExplorer=Wa.DirectPrintEnabledForInternetExplorer.toString();oa.DirectPrintSupportedMimeTypes=Wa.DirectPrintSupportedMimeTypes;oa.DirectPrintSupportedPlugins=Wa.DirectPrintSupportedPlugins;oa.DirectPrintImmersivePreviewPlugins=
Wa.DirectPrintImmersivePreviewPlugins;oa.DirectPrintMinimalSupportedEdgeVersion=Wa.DirectPrintMinimalSupportedEdgeVersion;oa.DirectPrintEnabledForEdge=Wa.DirectPrintEnabledForEdge.toString();oa=new Pa(oa);var Rb=null;Wa=null;try{Wa=window.navigator.mimeTypes}catch(rd){td.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}var xc=null;try{xc=window.navigator.plugins}catch(rd){td.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}Rb=new qa(oa,Wa,xc,qa.Ydf,
qa.iif,new Xa(Od.AFrameworkApplication.sa.rX),Od.AFrameworkApplication.sa.xD,qa.jif,function(rd,$d){return new Ha(rd,!1,$d)},!1);if(jf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.jg.get(116)){var id=yg.GetServiceTaskFactory.Wa(this.$.da,349,350,this.ub);lh.TaskExtensions.Ba(id,function(){var rd=new c(L.$,Rb,id.result);L.Fd([rd])},this.$.ma)}else this.Fd([new c(this.$,Rb,null)])};a.ja=function(L){$g.a.fe(73,new a(L))};Object(ve.a)(a,"PrintCommandHandlerFactory",
$g.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");Fd.a.$i(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Type.registerNamespace("CADWLTR");Ye.main();Type.registerNamespace("Common.App.NewAndOpen.UX");jg.a.instance.sj(new nc);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Ce.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SaveAsToHost");vg.main();Type.registerNamespace("Common.App.SaveToSharePoint");ac.main();Type.registerNamespace("Common.App.SaveToCloudStorage");uf.main();Type.registerNamespace("Common.App.SaveACopy");
ig.main();Type.registerNamespace("Common.App.SharedFilePicker");je.main();Type.registerNamespace("Common.App.WildFire");ng.main();pf.a.Ga(rf.ja);pf.a.Ga(hf.ja);pf.a.Ga(ae.ja);Fd.a.$i(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}");
pf.a.Ga(Cc.ja);Fd.a.$i(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){pf.a.Ga(function(L){oc.ja(L)})})();(function(){pf.a.Ga(function(L){L.da.Ha(165,new Yc(L))})})();pf.a.Ga(Nd.ja);(function(){pf.a.Ga(function(L){L.da.Ha(57,new ie(L));L.da.Ha(60,new yb(L));L.da.Ha(63,new mc(L))})})();pf.a.Ga(nd.ja);pf.a.Ga(sd.ja);pf.a.Ga(rb.ja);Fd.a.$i(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}");
(function(){pf.a.Ga(function(L){Ad.ja(L);zc.ja(L)})})();Fd.a.$i('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}');
Fd.a.$i(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(function(){pf.a.Ga(function(L){jd.ja(L);sa.ja(L)})})();pf.a.Ga(Hb.ja);pf.a.Ga(Kb.ja);(function(){pf.a.Ga(function(L){gb.ja(L);zb.ja(L)})})();pf.a.Ga(ta.ja);pf.a.Ga(pb.ja);(function(){pf.a.Ga(function(L){Ga.ja(L);ya.ja(L)})})();pf.a.Ga(Cb.ja);(function(){pf.a.Ga(function(L){ma.ja(L);db.ja(L)})})();Type.registerNamespace("Common.App.DirectPrint");jg.a.instance.sj(new ea);pf.a.Ga(a.ja)},830:function(A,
F,b){function a(D,V){var U=v.call(this,document.createElement("div"))||this;U.tx=null;U.XS=null;U.n8=null;U.Uba=null;U.n2b=null;U.zke=null;U.bqe=null;U.zlf=null;U.Wwb=!1;U.hw=!1;U.O4=!1;U.XKa=!1;U.UIi=function(Q){U.BF(Q)};U.ZIi=function(Q){13===Q.keyCode&&U.BF(Q)};U.fzd=function(Q){U.kp(Q.yb);return!0};U.mzd=function(Q){U.l6(Q.yb);return!0};U.SAd=function(Q){U.ima(Q.yb);return!0};U.v1=D;U.fH=V;U.PXc=V.f_a.toString();U.title=V.title;U.message=V.message;U.set_visibilityMode(1);return U}b.d(F,"a",function(){return a});
A=b(0);var c=b(13),e=b(88),l=b(275),n=b(12),m=b(117),f=b(91);F=b(230);var x=b(1171),y=b(16),t=b(4),B=b(317),z=b(53),u=b(11),C=b(69),r=b(14),J=b(20),v=F.a;vm(a,v);a.prototype.dispose=function(){e.a.rc([this.n2b,this.XS,this.n8]);this.hw&&this.XS&&(l.a.instance.za(n.a.click,this.XS.domElement,this.fzd),m.KeyInputManager.instance.vv(this.domElement,this.zke));this.O4&&this.n8&&(l.a.instance.za(n.a.click,this.n8.domElement,this.mzd),m.KeyInputManager.instance.vv(this.domElement,this.bqe));this.XKa&&this.Uba&&
(l.a.instance.za(n.a.click,this.Uba,this.SAd),m.KeyInputManager.instance.vv(this.domElement,this.zlf));this.Uba=this.tx=this.v1=this.n8=this.XS=null;v.prototype.dispose.call(this)};a.prototype.update=function(){};a.prototype.wRj=function(){this.VEe(!0)};a.prototype.y3c=function(){this.VEe(!1)};a.prototype.VEe=function(D){var V="<div class='"+x.a.cnh+"' id='{0}'><div class='"+x.a.anh+"'><a class='"+x.a.inh+"' title='{1}'><span class='"+y.a.l2b+" "+x.a.enh+"' id='{2}'>";this.Nj.length&&(V+="<img class='{3}' src='{4}'/>");
V+="</span></a><span class='"+x.a.hnh+"' id='{5}'>{6}</span><span class='"+x.a.gnh+"' id='message'>{7}</span><a id='link' href='#' class='"+x.a.fnh+"'>{8}</a><span class='"+x.a.kNe+"'><button type='button' id='action' class='"+x.a.jNe+"'>{9}</button></span><span class='"+x.a.kNe+"'><button type='button' id='altAction' class='"+x.a.jNe+"'>{10}</button></span></div><a class='"+x.a.dnh+"' tabindex='0' role='button'><span id='close' class='"+y.a.gr+"'><img class='"+y.a.f$c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";
D||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var U=this.businessBar.$.Ib;D=U+"ewaBusinessBarEntryBody"+this.PXc;var Q=U+"ewaBusinessBarEntryTitle"+this.PXc;U=U+"ewaBusinessBarEntryIcon"+this.PXc;this.domElement.className=x.a.bnh;this.domElement.innerHTML=String.format(V,D,this.alt,U,this.Nj,z.a.Ee(0),Q,this.title,this.message,this.linkText,this.actionButton,this.fZa,z.a.Ee(13),r.a.instance.fa(776));u.DOMElementExtensions.us(this.domElement,t.a.csa,Q,D);
this.Uba=$get("link",this.domElement);u.DOMElementExtensions.setVisible(this.Uba,this.XKa);this.XKa&&(l.a.instance.qa(n.a.click,this.Uba,this.SAd),this.zlf=m.KeyInputManager.instance.ps(this.Uba,this.SAd,f.a.$h,f.a.j1));this.XS=new B.a(u.DOMElementExtensions.getElementById(this.domElement,"action"));this.XS.isVisible=this.hw;this.n8=new B.a(u.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.n8.isVisible=this.O4;this.hw&&(l.a.instance.qa(n.a.click,this.XS.domElement,this.fzd),
this.zke=m.KeyInputManager.instance.ps(this.XS.domElement,this.fzd,f.a.$h,f.a.j1),this.O4&&(l.a.instance.qa(n.a.click,this.n8.domElement,this.mzd),this.bqe=m.KeyInputManager.instance.ps(this.XS.domElement,this.mzd,f.a.$h,f.a.j1)));this.tx=$get("close",this.domElement);this.n2b=this.Pd.Dd(this.tx);this.n2b.ja("click",this.UIi);this.n2b.ja("keydown",this.ZIi);u.DOMElementExtensions.setVisible(this.tx,!this.Wwb)};a.prototype.kp=function(){c.ULS.sendTraceTag(21517968,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",
this.fH.hash,this.fH.U8c);J.g(this.businessBar.$).Rq(!0)};a.prototype.l6=function(){c.ULS.sendTraceTag(537170257,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.fH.hash);J.g(this.businessBar.$).Rq(!0)};a.prototype.ima=function(){c.ULS.sendTraceTag(537170256,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.fH.hash);J.g(this.businessBar.$).Rq(!0)};a.prototype.BF=function(D){c.ULS.sendTraceTag(21517971,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",
this.fH.hash,this.fH.U8c);this.set_visible(!1);this.businessBar.removeEntry(this.ySg);C.g(D)};Sk.Object.defineProperties(a.prototype,{ySg:{configurable:!0,enumerable:!0,get:function(){return this.fH.f_a}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.v1}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.fH?this.fH.actionButton:""}},fZa:{configurable:!0,enumerable:!0,get:function(){return this.fH?this.fH.fZa:""}},linkText:{configurable:!0,enumerable:!0,
get:function(){return this.fH?this.fH.link:""}},Nj:{configurable:!0,enumerable:!0,get:function(){return this.fH?this.fH.Nj:""}},alt:{configurable:!0,enumerable:!0,get:function(){return this.fH?this.fH.alt:""}}});Object(A.a)(a,"BusinessBarEntry",F.a,[])},908:function(A,F,b){function a(K,da,fa,X){var ca=S.call(this)||this;ca.OF=null;ca.kD=null;ca.xW=null;ca.Aw=null;ca.PFb=null;ca.YK=null;ca.Cjc=null;ca.eBb=null;ca.dBb=!1;ca.Lwa=!0;ca.vpc=null;ca.ewaAccessibilityManager=null;ca.jFd=null;ca.iFd=null;
ca.mFd=null;ca.Snd=!1;ca.Dzf=function(){y.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",ca.dBb);ca.dBb&&(ca.U7h(),ca.YK.style.visibility="visible",ca.Cjc?ca.Cjc.stop():y.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),ca.raiseEvent(a.ECb,new x(1)),ca.DOd(),ca.dBb=!1)};ca.$=K;ca.jD=da;ca.Y8g();ca.useMSPdfViewer=fa;ca.isUniversalPrintEnabled=X;return ca}function c(){this.msPdfViewerFileUrl=
null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function e(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=null}function l(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=
null}function n(K){this.tg=K}function m(K){this.tg=K}function f(K){this.tg=K}function x(K){var da=V.call(this)||this;da.U1i=K;return da}b.r(F);A=b(0);var y=b(13),t=b(5);b(23);var B=b(387),z=b(36),u=b(56),C=b(11),r=b(122),J=b(1),v=b(14),D=b(20),V=Sys.EventArgs;vm(x,V);Object(A.a)(x,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var U=b(255),Q=b(244);f.prototype.Rg=function(){U.a(this.tg.$).aN(this.Zd)||U.a(this.tg.$).Rg(this)};f.prototype.Y7=function(){U.a(this.tg.$).aN(this.Zd)&&U.a(this.tg.$).Dz(this)};
f.prototype.Yf=function(K){return C.DOMElementExtensions.Oe(this.Jb,K)};f.prototype.gi=function(){this.tg.$.frame.Se.ek(this.tg.$.frame.Se.zE)};f.prototype.Qh=function(){};f.prototype.Ne=function(K,da){return da?!1:(this.tg.enterPrintPreviewHeaderFocusTrapZone(),!0)};Sk.Object.defineProperties(f.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return Q.a.TJf}},Jb:{configurable:!0,enumerable:!0,get:function(){var K=b(908).PrintPreviewPane;return document.getElementById(K.T1i)}},canReceiveFocus:{configurable:!0,
enumerable:!0,get:function(){return!0}}});Object(A.a)(f,"PrintPreviewHeaderKeyboardAccessibleSection",null,[112]);m.prototype.Rg=function(){U.a(this.tg.$).aN(this.Zd)||U.a(this.tg.$).Rg(this)};m.prototype.Y7=function(){U.a(this.tg.$).aN(this.Zd)&&U.a(this.tg.$).Dz(this)};m.prototype.Yf=function(K){return C.DOMElementExtensions.Oe(this.Jb,K)};m.prototype.gi=function(){this.tg.$.frame.Se.ek(this.tg.$.frame.Se.zE)};m.prototype.Qh=function(){};m.prototype.Ne=function(K,da){return da?!1:(this.tg.useMSPdfViewer?
(K=document.getElementById(b(908).PrintPreviewPane.hDd))&&C.DOMElementExtensions.setFocus(K,!0):C.DOMElementExtensions.setFocus(this.tg.YK),!0)};Sk.Object.defineProperties(m.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return Q.a.UJf}},Jb:{configurable:!0,enumerable:!0,get:function(){var K=b(908).PrintPreviewPane;return this.tg.useMSPdfViewer?document.getElementById(b(908).PrintPreviewPane.hDd):document.getElementById(K.oHf)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});
Object(A.a)(m,"PrintPreviewKeyboardAccessibleSection",null,[112]);n.prototype.Rg=function(){U.a(this.tg.$).aN(this.Zd)||U.a(this.tg.$).Rg(this)};n.prototype.Y7=function(){U.a(this.tg.$).aN(this.Zd)&&U.a(this.tg.$).Dz(this)};n.prototype.Yf=function(K){return C.DOMElementExtensions.Oe(this.Jb,K)};n.prototype.gi=function(){this.tg.$.frame.Se.ek(this.tg.$.frame.Se.zE)};n.prototype.Qh=function(){};n.prototype.Ne=function(K,da){return da?!1:(this.tg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};Sk.Object.defineProperties(n.prototype,
{Zd:{configurable:!0,enumerable:!0,get:function(){return Q.a.XJf}},Jb:{configurable:!0,enumerable:!0,get:function(){var K=b(908).PrintPreviewPane;return document.getElementById(K.lFd)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(A.a)(n,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[112]);Object(A.a)(l,"MSPdfViewerFileUrl",null,[]);Object(A.a)(e,"PrintSettingsTaskPaneProps",null,[]);Object(A.a)(c,"ViewerPaneProps",null,[]);var la=b(1183),ba=b(379),T=b(4),
H=b(1184);b.d(F,"PrintPreviewPane",function(){return a});var S=z.a;vm(a,S);a.prototype.$Fg=function(K){this.addHandler(a.ECb,K)};a.prototype.idj=function(K){this.removeHandler(a.ECb,K)};a.prototype.wCj=function(){this.T8g()};a.prototype.xCj=function(){var K=this.$.Vb.Hc("UserAction","createSettingsPaneStopwatch"),da=document.getElementById(a.lFd);this.Z8g();var fa=this.$8g();this.kD.createPrintSettingsTaskPane(da,fa);K.stop();this.dBb=!1;if(this.isUniversalPrintEnabled&&this.Aw){K="A4";switch(fa.selectedPrintSettingsValues.selectedPaperSize){case 8:K=
"A3";break;case 9:K="A4";break;case 11:K="A5";break;case 12:K="JIS B4";break;case 13:K="JIS B5";break;case 5:K="North America Legal";break;case 1:K="North America Letter";break;case 6:K="North America Invoice";break;case 7:K="North America Executive";break;case 3:K="North America Ledger"}this.OF.setDocumentSettings({mediaSize:K,orientation:2===fa.selectedPrintSettingsValues.selectedOrientation?"landscape":"portrait",colorMode:1===fa.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.YHd()};
a.prototype.setPageRangeSettings=function(K,da,fa,X,ca){this.kD&&(this.kD.setPageRangeSettings(K,da,fa,X,ca),this.$_f(String.format(v.a.instance.Cb(195),X,ca,K)))};a.prototype.M7h=function(){this.Aw&&(this.Aw.style.display="none")};a.prototype.Egh=function(){this.dispose();this.CXd();this.vPj();this.OF&&this.OF.closePrintPreviewPane();this.xW=this.kD=this.OF=this.Aw=null};a.prototype.Dti=function(K){y.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?
((this.eBb=this.$.Vb.Hc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||y.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.xW.renderPdf(K)):this.YK&&((this.Cjc=this.$.Vb.Hc("UserAction","loadPdfStopwatch"))||y.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.dBb=!0,this.YK.src&&this.YK.src===K?this.Dzf(null):this.YK.src=K);if(this.isUniversalPrintEnabled&&this.Aw){var da=ba.b(this.$.workbookContext);
this.OF.setFileUrl(K,da)}};a.prototype.onPdfLoad=function(){this.eBb?(y.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.eBb.Dc,this.Lwa),this.eBb.stop()):y.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.ECb,new x(1));this.hideWaitCursor();this.DOd()};a.prototype.printPdf=function(){C.DOMElementExtensions.setFocus(this.YK);this.YK.contentWindow.print()};a.prototype.nDj=
function(){this.showSpinner();this.showWaitCursor();this.$_f("")};a.prototype.U7h=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.Jz=function(K,da,fa){this.Aw&&this.xW&&(this.Snd=!1,this.xW.showErrorDetails(da,K,void 0===fa?null:fa),this.jD.$5a=!0,this.YK&&(this.YK.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.uli(da)&&(this.Snd=!0,this.IQi()))};a.prototype.hidePreviewError=function(){this.jD.$5a=!1;this.xW.hidePreviewError();this.enablePrintButton()};a.prototype.vgh=
function(){(this.PFb=document.getElementById(a.VJf))&&this.PFb.parentNode&&this.PFb.parentNode.removeChild(this.PFb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.kD&&this.kD.hideErrorMessageForPrintOptions()};a.prototype.showErrorMessageForPrintOptions=function(K){this.kD&&this.kD.showErrorMessageForPrintOptions(K)};a.prototype.showSpinner=function(){this.jD.$5a||J.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.Snd?this.hidePreviewError():
this.YK&&(this.YK.style.visibility="hidden");this.xW&&this.xW.showSpinner()};a.prototype.hideSpinner=function(){this.xW&&this.xW.hideSpinner()};a.prototype.enablePrintButton=function(){this.kD&&this.kD.enablePrintButton();this.isUniversalPrintEnabled&&this.Aw&&this.OF.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.kD&&this.kD.disablePrintButton();this.isUniversalPrintEnabled&&this.Aw&&this.OF.updatePrintButtonEnableDisableState(!1)};a.prototype.showWaitCursor=
function(){this.kD&&this.kD.showWaitCursor();this.isUniversalPrintEnabled&&this.Aw&&this.OF.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.kD&&this.kD.hideWaitCursor();this.isUniversalPrintEnabled&&this.Aw&&this.OF.updatePrintButtonEnableDisableState(!0)};a.prototype.W8g=function(){if(this.Aw)y.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");else if(this.Aw=document.createElement("div"),
this.Aw.id=a.VJf,this.Aw.classList.add(a.V1i),this.$.dr.insertBefore(this.Aw,this.$.dr.firstChild),t.AFrameworkApplication.sa&&t.AFrameworkApplication.sa.Qa.ph){var K=document.getElementById(T.a.eGa);K&&(this.Aw.style.top=K.clientHeight+"px",this.Aw.style.height="calc(100% - "+K.clientHeight+"px)")}};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.OF.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=function(){this.OF.enterPrintSettingsTaskPaneFocusTrapZone()};
a.prototype.H_i=function(){var K=this;this.$.da.Za(15,function(da){K.ewaAccessibilityManager=da;K.ewaAccessibilityManager.mode=3})};a.prototype.Y8g=function(){this.mFd=new n(this);this.jFd=new m(this);this.iFd=new f(this)};a.prototype.YHd=function(){this.mFd.Rg();this.jFd.Rg();this.iFd.Rg();this.H_i()};a.prototype.CXd=function(){this.mFd.Y7();this.jFd.Y7();this.iFd.Y7();D.g(this.$).F0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0)};a.prototype.iL=function(){this.vpc=r.a.instance.Dd(this.YK);
this.vpc.ja("load",this.Dzf)};a.prototype.vPj=function(){this.vpc&&this.YK&&this.vpc.detach("load")};a.prototype.DOd=function(){if(this.Lwa){var K=document.getElementById(a.lFd);K&&(K=C.DOMElementExtensions.getElementById(K,a.PJf))&&(this.Lwa=!1,K.focus())}};a.prototype.IQi=function(){this.jD.$5a=!1;this.enablePrintButton();this.DOd()};a.prototype.T8g=function(){var K=this;if(J.EwaSettings.isChangeGateEnabled("OfficeVSO:6068952_FixJSCrahInPrintPreview")){var da=u.GetServiceTaskFactory.Wa(this.$.da,
283,284,0).result.Un;da.loadScript("excel-print-preview-sprite").then(function(){da.loadScript("printPreviewer").then(function(){da.loadScript("excelPrintPreviewer").then(function(){K.cFe()})},function(){y.ULS.sendTraceTag(525358669,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load printPreviewer script required for excelPrintPreviewer.")})},function(){y.ULS.sendTraceTag(525358668,0,10,"PrintPreviewPane.createPreviewerPanes: Failed to load excelPrintPreviewSprite script required for excelPrintPreviewer.")})}else u.GetServiceTaskFactory.Wa(this.$.da,
283,284,0).result.Un.loadScript("excelPrintPreviewer").then(function(){K.cFe()})};a.prototype.cFe=function(){var K=this,da=this.$.Vb.Hc("UserAction","createEmptyPreviewerStopwatch");this.W8g();this.X8g();this.isUniversalPrintEnabled?this.OF.createEmptyPrintPreviewPaneAsync(this.Aw,this.bFe()).then(function(){da.stop();K.PBe();K.OF.updatePrintButtonEnableDisableState(!1)}):(this.OF.createEmptyPrintPreviewPane(this.Aw,this.bFe()),da.stop(),this.PBe())};a.prototype.PBe=function(){var K=this.$.Vb.Hc("UserAction",
"createPdfPreviewPaneStopwatch"),da=document.getElementById(a.hDd);this.useMSPdfViewer&&(da.tabIndex=0);this.G8g();this.F8g(da);K.stop();this.raiseEvent(a.ECb,new x(0))};a.prototype.X8g=function(){this.OF||(this.OF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.OF||y.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};a.prototype.Z8g=function(){this.kD||(this.kD=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());
this.kD||y.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};a.prototype.G8g=function(){this.xW||(this.xW=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.xW||y.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};a.prototype.F8g=function(K){this.xW.createPrintPreviewPane(K,this.iah());this.useMSPdfViewer||
(this.YK=C.DOMElementExtensions.getElementById(this.Aw,a.oHf),this.YK.title=v.a.instance.fa(1169),this.iL())};a.prototype.$8g=function(){var K="en-US";var da=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?K=this.$.ya.DataCultureTag:y.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object.assign(new e,{whatToPrintOptions:this.jD.fv.whatToPrintOptions,orientationOptions:this.jD.fv.orientationOptions,
paperSizeOptions:this.jD.fv.paperSizeOptions,scalingOptions:this.jD.fv.scalingOptions,marginDetailedOptions:this.jD.HTh(),selectedPrintSettingsValues:this.jD.xWh(),printSettingsTaskPaneCallbacks:this.jD.vWh(),logger:new B.a,shouldDisableCurrentSelection:this.jD.Rwc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:da,dataCultureTag:K,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.bFe=function(){return this.isUniversalPrintEnabled?this.jD.tWh():Object.assign(new la.a,
{backActionButtonText:v.a.instance.fa(1167),printPreviewPaneCallbacks:this.jD.u2e(),logger:new B.a,disableTellMeControl:!0})};a.prototype.iah=function(){var K=this;return this.useMSPdfViewer?Object.assign(new c,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.V7g(),onPdfLoad:function(){K.onPdfLoad()}}):Object.assign(new c,{useMSPdfViewer:!1})};a.prototype.V7g=function(){return Object.assign(new l,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,
msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};a.prototype.$_f=function(K){this.Aw&&this.OF.setAdditionalHeaderText(K)};a.uli=function(K){return 3===K||2===K};a.VJf="PrintPreviewerContainer";a.lFd="printSettingsTaskPaneId";a.hDd="previewId";a.oHf="printpreviewiframe";a.T1i="printPreviewHeaderId";a.PJf="printButton";a.V1i=H.a.Aw;a.ECb="pppnosu";Object(A.a)(a,"PrintPreviewPane",z.a,[714])},974:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);var c=b(13),e=b(5),l=b(47),
n=b(23);a.OXe=function(m,f){switch(m){case 3:return a.w1h(f);case 2:return a.xVh(f);case 1:return a.KPh(f)}return""};a.w1h=function(m){switch(m){case 1:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString()}return""};a.xVh=function(m){switch(m){case 1:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString()}return""};
a.KPh=function(m){switch(m){case 1:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString();case 2:return e.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};a.openInClient=function(m,f,x){if(n.a.ah||n.a.Vp)window.setTimeout(function(){a.YNf(x,a.lcc())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.Mqe(x),m,0,!1)};a.bZg=function(m,f,x,y){f&&y&&y();a.openInClient(m,f,x)};a.lcc=function(){return n.a.ah?1:n.a.Vp?2:n.a.v7a?
3:n.a.isMac?4:0};a.s1h=function(m){switch(m){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";case 1:return"WildFireExcelBizBar";default:return""}};a.t1h=function(m){switch(m){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}};a.YNf=function(m,f){1===f?(c.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),m=a.OXe(m,f),8<n.a.l5a?l.a.vf(m,void 0,void 0,"RedirectToAppStore"):
l.a.fV(m)):document.hidden||(a.Ggc?(m=e.AFrameworkApplication.ga.appSettings.WildFireUrlChinaStoreAndroid.toString())?(c.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),l.a.fV(m)):c.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(c.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.OXe(m,f),null,null)))};a.Mqe=function(m){switch(m){case 3:return 5;case 2:return 3;case 1:return 1;
default:return 0}};a.Bdd=function(m){switch(m){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";default:return""}};a.jpd=function(m){return(m=a.DSh(m))&&""!==m?Boolean.parse(m):!1};a.tPd=function(m){a.lsj(m)};a.DSh=function(m){try{return localStorage.getItem(m)}catch(f){return c.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+f.message),null}};a.lsj=function(m){try{localStorage.setItem(m,"true")}catch(f){c.ULS.sendTraceTag(18416669,
306,50,"WildFire LocalStorage SetItem Failed with exception : "+f.message)}};Sk.Object.defineProperties(a,{Ggc:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},mxc:{configurable:!0,enumerable:!0,get:function(){return(n.a.v7a||n.a.isMac)&&n.a.ep}},Czj:{configurable:!0,enumerable:!0,get:function(){return n.a.ah||n.a.Vp}}});a.Pye="ChromeExtensionBarDismiss";Object(A.a)(a,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kmhv.js.map/bc30fcd6b2a6823a58d31db3f0c3fadf/EwaDS.kmhv.js.map