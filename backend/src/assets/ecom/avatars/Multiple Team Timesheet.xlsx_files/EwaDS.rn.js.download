(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[34],{1390:function(A,F,b){function a(Sa){return gb.call(this,Sa)||this}function c(Sa){this.Gi=Sa}function e(Sa){var Kb=Sb.call(this)||this;Kb.renameFileManager=null;Kb.ZY=null;Kb.$=Sa;Kb.dc();return Kb}function l(Sa,Kb){var Gc=kc.call(this)||this;Gc.$5c=null;Gc.JRf=null;Gc.VJd=null;Gc.dda=null;Gc.eka=function(){var Hb=Gc.$.ea.Dm;if(Hb&&Hb.WorkbookFileName){var Lb=Xa.a.lr(Hb.WorkbookFileName),sa=!!Ia.a.compare(Gc.$.workbookContext.WorkbookFileName,
Hb.WorkbookFileName,!1),Ua=ta.EwaSettings.la(564)&&!!Hb.BreadcrumbFolderUrl&&!!Ia.a.compare(Gc.$.workbookContext.FullDocumentInfo.BreadcrumbFolderUrl,Hb.BreadcrumbFolderUrl,!1);if(sa||Ua)Gc.dda={},Gc.dda.NewFileName=Lb,Gc.dda.EditDocInClientUrl=Hb.EditDocInClientUrl,Gc.dda.DirectInvokeDAVUrl=Hb.DirectInvokeDAVUrl,Gc.dda.DownloadACopyUrl=Hb.DownloadACopyUrl,ta.EwaSettings.la(564)&&Hb.BreadcrumbFolderUrl&&(Gc.dda.BreadcrumbFolderName=Hb.BreadcrumbFolderName,Gc.dda.BreadcrumbFolderUrl=Hb.BreadcrumbFolderUrl),
Hb=Ha.AFrameworkApplication.Gb.Ce(db.a.fileNameUpdate,2,Lb),Gc.dda=null,ja.ULS.shipAssertTag(537154064,0,32===Hb,"RenameFileManager.HandleWorkbookMetadataChanged - Workbook Name Update Failed")}};Gc.XKi=function(Hb,Lb,sa){Gc.JRf=Lb;Gc.VJd=sa;Lb={};Gc.$.Ka.Xb(new Ba.a(1897077126,cc.a.$b,2,3,null),(Lb.newFileName=Hb,Lb))};Gc.WKi=function(Hb){Gc.dda&&Hb(Gc.O2e(Gc.dda),Gc.gs)};Gc.aEb=function(Hb){ra.a(Hb)||!Hb.Result?(Hb=l.yIh(Hb),lb.a(Gc.$).qd.ZD([-414480287,650565124,-782844485,1223808266,-62451516,
1636785843]),Gc.VJd(Hb)):Gc.JRf(Gc.O2e(Hb.Result),Gc.gs)};Gc.DRi=function(){Gc.VJd(5)};Gc.$=Sa;Gc.gs=Kb;Gc.$.ea.Dt(Gc.eka);return Gc}function n(Sa){this.$=Sa}function m(Sa){return lc.call(this,Sa)||this}function f(Sa){this.renameFileManager=Sa}function x(){this.wb=this.tb=null}function y(Sa,Kb,Gc,Hb,Lb,sa,Ua,Yb,jc,md){var jd=B.call(this,Sa,Gc,Hb,Lb,sa,jc)||this;jd.lXb=null;jd.dlb=null;jd.Utg=Kb;jd.La=Ua;jd.me=Yb;md&&md.execute(function(Zc){jd.I$i(Zc)});return jd}function t(Sa,Kb,Gc,Hb,Lb,sa,Ua,Yb){Sa=
B.call(this,Sa,Kb,Gc,Hb,Lb,sa)||this;Sa.bfe=Lb;Sa.Oug=Ua;Sa.mqg=Yb;return Sa}function B(Sa,Kb,Gc,Hb,Lb,sa){this.tl=!1;this.nMc=new Ya.a;this.AVa=Kb;this.$L=Gc;this.Cmg=Hb;this.wb=Lb;this.The=sa}function z(Sa,Kb,Gc,Hb,Lb){this.pGc=Lb;this.a$d=Gc;this.$9d=Hb;this.Ayg=Sa;this.mqa=Kb}function u(Sa){this.La=Sa}function C(Sa){this.G8=null;this.$pa=0;this.La=Sa;this._initialized=!1}function r(Sa,Kb,Gc){var Hb=ub.call(this)||this;Hb.La=Sa;Hb.Bv=Kb;Hb.$pa=Gc;Hb.Ue="RenameDialog";Hb.eg=J.eg;return Hb}function J(){}
function v(Sa,Kb,Gc){this.dialog=null;this.La=Sa;this.Bv=Kb;this.$pa=Gc}function D(Sa,Kb){this.La=Sa;this.uVa=Kb}function V(){}function U(Sa,Kb,Gc,Hb,Lb,sa,Ua,Yb,jc,md,jd,Zc){this.$9d=Sa;this.La=Kb;this.pGc=Gc;this.Bv=Hb;this.WDa=Lb;this.wyg=sa;this.Bra=Ua;this.oje=Yb;this.Qug=jc;this.mqa=md;this.wb=jd;this.Pug=Zc}function Q(){this.NDi=this.JDi=this.Lah=null}function la(){}function ba(Sa,Kb,Gc,Hb,Lb,sa,Ua,Yb,jc,md,jd,Zc){this._initialized=!1;this._element=null;this.cEa=0;this.tQc=this.YJc=!1;this.La=
Sa;this.nFc=Kb;this.je=Gc;this.gA=Hb;this.G8=Lb;this.ige=sa;this.DVb=Ua;this.fGc=Yb;this.S8=jc;this.O9d=md;this.oWa=jd;this.PKc=Zc}function T(Sa,Kb){this.cEa=0;this.La=Sa;this.G8=Kb}function H(Sa,Kb,Gc,Hb,Lb){var sa=Pa.call(this)||this;sa.R1=new fa(Sa,Kb,Gc);sa.Bra=Hb;sa.mqa=Lb;sa.Ue="RenameDisabledDialog";sa.jc=0;sa.Fc(1,CommonUIStrings.l_DialogClose);sa.eg=S.eg;sa.showDialog(CommonUIStrings.l_RenameFileRenameDisabledTitle,null);sa.gX("RenameRow");return sa}function S(){}function K(Sa,Kb,Gc,Hb,Lb){return da.call(this,
Sa,Kb,Gc,Hb,Lb)||this}function da(Sa,Kb,Gc,Hb,Lb){var sa=qa.call(this)||this;sa.oVd=[];sa.R1=new fa(Sa,Kb,Gc);sa.Bra=Hb;sa.mqa=Lb;sa.Ue="RenameDisabledDialog";sa.jc=0;sa.Fc(1,CommonUIStrings.l_DialogClose);sa.Muj();sa.Pej();return sa}function fa(Sa,Kb,Gc){this.TRd=this.URd=this.VRd=!1;this.mSd=!Sa&&!Kb;this.nSd=!Sa&&!Gc;this.mSd||this.nSd||(this.VRd=!Sa,this.URd=!Kb,this.TRd=!Gc)}b.r(F);A=b(0);var X=b(80),ca=b(685),ja=b(13),ea=b(128);Object(A.a)(fa,"RenameDisabledDialogInfo",null,[]);var qa=ea.StandardDialog;
vm(da,qa);da.prototype.Muj=function(){this.R1.mSd?this.bLb(this.Bra?this.mqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull):this.R1.nSd?this.bLb(CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.HBg();this.Kra(this.oVd)};da.prototype.bLb=function(Sa){Array.add(this.oVd,Sa)};da.prototype.HBg=function(){var Sa=[];this.R1.VRd||Array.add(Sa,CommonUIStrings.l_RenameFileRenameDisabledSignIn);
this.R1.URd||Array.add(Sa,CommonUIStrings.l_RenameFileRenameDisabledPermission);this.R1.TRd||Array.add(Sa,CommonUIStrings.l_RenameFileRenameDisabledCoauth);0<Sa.length&&Array.add(this.oVd,Sa)};Object(A.a)(da,"ReactRenameDisabledDialogBase",ea.StandardDialog,[]);vm(K,da);K.prototype.Pej=function(){this.XBb(CommonUIStrings.l_RenameFileRenameDisabledTitle,null,null,null,null,null)};Object(A.a)(K,"ReactRenameDisabledDialog",da,[]);var pa=b(140);Sk.Object.defineProperties(S,{eg:{configurable:!0,enumerable:!0,
get:function(){return pa.a.Cn(S.Vj,CommonUIStrings.l_RenameFileRenameDisabled,CommonUIStrings.l_RenameFileRenameDisabledSignIn,CommonUIStrings.l_RenameFileRenameDisabledPermission,CommonUIStrings.l_RenameFileRenameDisabledCoauth)}}});S.Vj="<div class='WACDialogRow' id='RenameRow'> <label id='labelDisabledMessage' class='WACDialogLabel' >{0}</label> <div class='WACDialogRow' id='MultipleSuggestionsRow'> <ul id='ulRenameFileDisabled' class='WACDialogUList'> <li id='liRenameFileRenameDisabledSignIn'>{1}</li> <li id='liRenameFileRenameDisabledPermission'>{2}</li> <li id='liRenameFileRenameDisabledCoauth'>{3}</li> </ul> </div> </div>";
Object(A.a)(S,"RenameDisabledDialogHtml",null,[]);var Pa=pa.a;vm(H,Pa);H.prototype.w9a=function(){if(this.R1.mSd){var Sa=this.Bra?this.mqa?CommonUIStrings.l_RenameFileRenameReadOnlyRecommended:CommonUIStrings.l_RenameFileRenameNotEveryoneSupportsRename:CommonUIStrings.l_RenameFileRenameDisabledCoauthFull;H.bLb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),Sa)}else this.R1.nSd?H.bLb(document.getElementById("ulRenameFileDisabled"),document.getElementById("labelDisabledMessage"),
CommonUIStrings.l_RenameFileRenameDisabledPermissionFull):this.T7h()};H.prototype.T7h=function(){this.R1.VRd&&(document.getElementById("liRenameFileRenameDisabledSignIn").style.display="none");this.R1.URd&&(document.getElementById("liRenameFileRenameDisabledPermission").style.display="none");this.R1.TRd&&(document.getElementById("liRenameFileRenameDisabledCoauth").style.display="none")};H.bLb=function(Sa,Kb,Gc){Sa.style.display="none";Kb.innerText=Gc};Object(A.a)(H,"RenameDisabledDialog",pa.a,[]);
var Ha=b(5),Xa=b(29),Na=b(104),db=b(30);T.prototype.initialize=function(Sa){if(!this.La||!this.G8)return!1;this.cEa=Sa;this.Qg();return!0};T.prototype.Qg=function(){this.La.fc(db.a.cia,Na.a.frame,Object(X.a)(this,this.cia,"commitNewDocumentTitle"))};T.prototype.cia=function(Sa,Kb,Gc,Hb,Lb){if(1===Gc)return this.La.processAction(db.a.renameFile,1);Sa=Xa.a.lr(this.G8.zn);Lb=(0,Lb.getNewDocumentTitle)();Lb.length>this.cEa&&(Lb=Lb.substr(0,this.cEa));if(32!==this.La.Ce(db.a.renameFile,2,Lb))return this.zX(Sa),
8;this.zX(Lb);return 32};T.prototype.zX=function(Sa){appChrome.api.dispatch(appChrome.actions.updateDocumentTitle(Sa))};T.zfd=function(){return new T(Ha.AFrameworkApplication.Gb,Ha.AFrameworkApplication.dm)};Object(A.a)(T,"ReactRenameUIHandler",null,[460]);var Ja=b(833),jb=b(920),hc=b(576),ma=b(12),Ka=b(117),Ta=b(169),ob=b(89),Cb=b(47),eb=b(23),ya=b(86);ba.prototype.initialize=function(Sa,Kb,Gc){if(!(this.La&&this.G8&&this.ige&&this.DVb&&this.fGc&&Kb)||0>=Sa)return!1;this._element=Kb;this._element.title=
Gc;this._element.setAttribute(ob.a.Td,ob.a.Qr);this._element.setAttribute("Unselectable","on");this.cEa=Sa;this.hv();return this._initialized=!0};ba.prototype.hv=function(){this.nFc&&(this.nFc.qa(ma.a.blur,this._element,Object(X.a)(this,this.onBlur,"onBlur")),this.nFc.qa(ma.a.paste,this._element,Object(X.a)(this,this.onPaste,"onPaste")));this.je.qa(ma.a.Sb,this._element,Object(X.a)(this,this.onKeyDown,"onKeyDown"));this.gA.qa(ma.a.pointerDown,this._element,Object(X.a)(this,this.onPointerDown,"onPointerDown"));
this.gA.qa(ma.a.Yd,this._element,Object(X.a)(this,this.Og,"onPointerUp"))};ba.prototype.onBlur=function(){this.isActive&&!this.YJc&&(this.O9d||this.fGc(this._element),this.jBe(),this.S5c(!1));return this.YJc=!1};ba.prototype.onPaste=function(){ja.ULS.sendTraceTag(4281482,203,15,"Attempting to paste into the document title");return!0};ba.prototype.onKeyDown=function(Sa){return this.isActive?this.MOi(Sa):this.NOi(Sa)};ba.prototype.MOi=function(Sa){var Kb=!1;switch(Sa.Ea.keyCode){case Sys.UI.Key.enter:this.jBe();
this.S5c(this.oWa||this.PKc);Kb=!0;break;case Sys.UI.Key.tab:this.O9d&&this.fGc(this._element);break;case Sys.UI.Key.esc:this.xLd(),this.S5c(this.oWa||this.PKc),Kb=!0}return Kb};ba.prototype.NOi=function(Sa){var Kb=!1;switch(Sa.Ea.keyCode){case Sys.UI.Key.enter:case Sys.UI.Key.space:this.Gag(this.PKc),this.isActive&&this.DVb(this._element),Kb=!0}return Kb};ba.prototype.onPointerDown=function(){this.isActive||(this.Gag(!1),this.isActive&&(this._element.focus(),this.DVb(this._element),this.tQc=!0));
return!1};ba.prototype.Og=function(){return this.tQc?(this.DVb(this._element),this.tQc=!1,!0):!1};ba.prototype.O6a=function(){return 32===this.La.processAction(db.a.renameFile,1)};ba.prototype.jBe=function(){var Sa=Xa.a.lr(this.G8.zn),Kb=this._element.innerText.trim();Kb.length>this.cEa&&(Kb=Kb.substr(0,this.cEa));Kb!==Sa&&""!==Kb?32!==this.La.Ce(db.a.renameFile,2,Kb)?this.xLd():this.zX(Kb):this.xLd()};ba.prototype.xLd=function(){this.zX(Xa.a.lr(this.G8.zn))};ba.prototype.zX=function(Sa){this._initialized&&
(this._element.innerText=Sa,this.ige())};ba.prototype.Gag=function(Sa){this.O6a()?this.isActive||(Sa&&(this.YJc=!0,this._element.blur()),this._element.setAttribute("contentEditable","true"),this._element.removeAttribute("Unselectable"),this._element.setAttribute(ob.a.Td,ob.a.gXc),this._element.style.width="auto",Sys.UI.DomElement.addCssClass(this._element,Ja.CuiHelper.EKe),this.S8&&this.S8.execute(function(Kb){Kb.bMf(!0)}),Sa&&this._element.focus(),ja.ULS.sendTraceTag(9234188,203,50,"Rename document from header.")):
this.La.processAction(db.a.odb,2)};ba.prototype.S5c=function(Sa){this._element.removeAttribute("contentEditable");this._element.setAttribute("Unselectable","on");this._element.setAttribute(ob.a.Td,ob.a.Qr);Sys.UI.DomElement.removeCssClass(this._element,Ja.CuiHelper.EKe);this.S8&&this.S8.execute(function(Kb){Kb.bMf(!1)});Sa&&(this._element.blur(),this._element.focus())};ba.ny=function(){jb.a.ny(Ha.AFrameworkApplication.isRtl)};ba.zfd=function(){return new ba(Ha.AFrameworkApplication.Gb,hc.a.instance,
Ka.KeyInputManager.instance,Ta.a.instance,Ha.AFrameworkApplication.dm,ba.ny,Cb.a.anj,Cb.a.LYg,ya.a.instance.oc("Common.App.Header.HeaderEventSource"),eb.a.OH,eb.a.ah,eb.a.Df)};Sk.Object.defineProperties(ba.prototype,{isActive:{configurable:!0,enumerable:!0,get:function(){return"true"===this._element.getAttribute("contentEditable")}}});Object(A.a)(ba,"RenameUIHandler",null,[460]);Sk.Object.defineProperties(la,{instance:{configurable:!0,enumerable:!0,get:function(){return Ha.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled?
la.Oa||(la.Oa=T.zfd()):la.Oa||(la.Oa=ba.zfd())}}});la.Oa=null;Object(A.a)(la,"RenameUIHandlerFactory",null,[]);var za=b(95),Ga=b(129);Object(A.a)(Q,"RenameMruEntryProperties",null,[]);var cb=b(373),Mb=b(170),Dc=b(689),vb;(function(Sa){Sa[Sa.unknown=-1]="unknown";Sa[Sa.success=0]="success";Sa[Sa.renameInvalidFileName=1]="renameInvalidFileName";Sa[Sa.renameInCoauthNotSupported=2]="renameInCoauthNotSupported";Sa[Sa.renameNotSupportedInViewMode=3]="renameNotSupportedInViewMode";Sa[Sa.permissionDenied=
4]="permissionDenied";Sa[Sa.serverCommunicationFailure=5]="serverCommunicationFailure";Sa[Sa.fileNameTooLong=6]="fileNameTooLong"})(vb||(vb={}));Object(A.b)("CommonOperationResult",vb);U.prototype.Qg=function(){Ha.AFrameworkApplication.sa&&Ha.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled||this.Gi.fc(db.a.Pxb,Na.a.frame,Object(X.a)(this,this.Pxb,"initializeRenameUIHandler"));this.Gi.fc(db.a.odb,Na.a.frame,Object(X.a)(this,this.odb,"showRenameDisabledDialog"));this.Gi.fc(db.a.renameFile,
Na.a.frame,Object(X.a)(this,this.renameFile,"renameFile"));this.Gi.ef(db.a.fileNameUpdate,Na.a.frame,Object(X.a)(this,this.z8i,"refreshFilename"),64);this.Gi.ef(db.a.qlc,Na.a.frame,Object(X.a)(this,this.qlc,"moveToFolderCompleteByHost"),64);this.Gi.fc(db.a.gOa,Na.a.frame,Object(X.a)(this,this.gOa,"moveToFolder"));Ha.AFrameworkApplication.sa&&(Ha.AFrameworkApplication.ga.ra("PostMessageEmbedded")||Ha.AFrameworkApplication.ga.ra("IsJsApi"))&&Ha.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MoveRenameProcess",
!0)&&Ha.AFrameworkApplication.vV().execute(function(Sa){Sa.Zn(Mb.a.wrf);Sa.Kl(Mb.a.wrf,U.w7i);Sa.Zn(Mb.a.Mad);Sa.Kl(Mb.a.Mad,U.u7i)})};U.prototype.O6a=function(){return 0===this.Pug.N2e()?32:8};U.prototype.BVj=function(){return this.Ry?this.Bra?this.Ry.EJe:this.Ry.rub:!0};U.prototype.Pxb=function(){return la.instance.initialize(Ha.AFrameworkApplication.n9b,Ha.AFrameworkApplication.z1a,Ha.AFrameworkApplication.WJd||CommonUIStrings.l_RenameFileTooltip)?32:8};U.prototype.odb=function(){var Sa=this.BVj(),
Kb=this.wyg();ja.ULS.sendTraceTag(4059649,203,50,"ShowRenameDisabledDialog: userIsAnonymous = {0}, userCanRename = {1}, userCanRenameInCurrentSession = {2}, userCanRenameInCoauthSessionsWithRenameCapableUsers = {3}",this.WDa,Kb,Sa,this.Bra);Ha.AFrameworkApplication.sa&&Ha.AFrameworkApplication.sa.Qa.rw&&Ha.AFrameworkApplication.ga.ra("ReactRenameDisabledDialogIsEnabled")?new K(this.WDa,!Kb,!Sa,this.Bra,this.mqa()):new H(this.WDa,!Kb,!Sa,this.Bra,this.mqa());return 32};U.prototype.renameFile=function(Sa,
Kb,Gc,Hb,Lb){if(1===Gc)return this.O6a();if(!Ha.AFrameworkApplication.F8b)return 8;if(8===this.O6a())return this.Gi.processAction(db.a.odb,2),8;ja.ULS.sendTraceTag(38114562,203,50,"RenameFileAttempt");Ha.AFrameworkApplication.F8b(Lb,Object(X.a)(this,this.aEb,"onRenameFileSuccess"),Object(X.a)(this,this.ERi,"onRenameFileFailure"));return 32};U.prototype.aEb=function(Sa,Kb){Sa?0!==Sa.OperationResult?this.J6e(Sa.OperationResult):(this.woj(Kb,Sa.NewName),this.kRj(Sa,Object(X.a)(Ha.AFrameworkApplication.sa.Qa,
Ha.AFrameworkApplication.sa.Qa.feg,"updateOpenInClientDocumentUrl")),Ha.AFrameworkApplication.ga.ra("DocumentNameInJewelInfoMenuIsEnabled")&&Ha.AFrameworkApplication.sa.updateCommandUI(),this.Qug.Kcg()):this.J6e(5)};U.prototype.woj=function(Sa,Kb){var Gc={};Gc[cb.a.sBh]=Kb;Sa.Sj(Mb.a.Mad,Gc)};U.prototype.kRj=function(Sa,Kb){this.vRj(Sa);Ha.AFrameworkApplication.d6b=Sa.DirectInvokeDavUrl;Kb=Kb(Sa.EditDocInClientUrl);var Gc=new Q;Gc.NDi=this.Bv.zn;Gc.Lah=Kb;Gc.JDi=Sa.EditDocInClientUrl;this.Gi.Ce(db.a.renameMostRecentlyUsedFileEntry,
2,Gc)};U.prototype.J6e=function(Sa){switch(Sa){case 1:Sa=new ea.StandardDialog,Sa.jc=0,Sa.mX(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null),this.qUf()}};U.prototype.vRj=function(Sa){this.Bv.zn=U.dKg(this.Bv.zn,Sa.NewName);Sa.BreadcrumbFolderName&&(this.Bv.breadcrumbFolderName=Sa.BreadcrumbFolderName);Sa.BreadcrumbFolderUrl&&(this.Bv.breadcrumbFolderUrl=Sa.BreadcrumbFolderUrl);this.oje(Sa.NewName)};U.prototype.ERi=function(Sa){var Kb=new ea.StandardDialog;
Kb.jc=0;switch(Sa){case 1:ja.ULS.sendTraceTag(38114563,203,50,"OnRenameFileFailure: InvalidFileName");Kb.KAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileInvalidName,null);break;case 6:ja.ULS.sendTraceTag(38114564,203,50,"OnRenameFileFailure: FileNameTooLong");Kb.KAa(CommonUIStrings.l_RenameFileInvalidNameTitle,CommonUIStrings.l_RenameFileNameTooLong,null);break;default:var Gc={};ja.ULS.sendTraceTag(38114565,203,15,"OnRenameFileFailure: {0}",(Gc.Result=Sa,Gc));Kb.KAa(CommonUIStrings.l_RenameFileGenericErrorTitle,
CommonUIStrings.l_RenameFileGenericError,null)}Ha.AFrameworkApplication.vV().execute(function(Hb){var Lb={};Hb.Sj(Mb.a.rBh,(Lb.FailureMessage=vb[Sa],Lb))});this.qUf()};U.prototype.z8i=function(Sa,Kb,Gc){if(1===Gc)return this.O6a();if(!Ha.AFrameworkApplication.iJa)return 8;Ha.AFrameworkApplication.iJa(Object(X.a)(this,this.Xnc,"onRefreshFilenameSuccess"),Object(X.a)(this,this.Wnc,"onRefreshFilenameFailure"),!1);return 32};U.prototype.gOa=function(Sa,Kb,Gc,Hb,Lb){if(1===Gc)return Ha.AFrameworkApplication.ga.ra("UiHostSupportsMoveToFolder")?
32:8;if(2===Gc){var sa={};Sa=Ha.AFrameworkApplication.bla;Kb=Ha.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures");Sa=(!Sa||Sa&&Kb)&&Ha.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1);sa[cb.a.eIj]=Sa;Lb&&Lb.MoveButtonClickedTime&&(sa[cb.a.eCi]=Lb.MoveButtonClickedTime.getTime());Ha.AFrameworkApplication.vV().execute(function(Ua){Ua.Sj(Mb.a.gOa,sa)});if(Lb&&Lb.MoveButtonClickedTime){if(Sa=Ga.a.Wr())Lb=(new Date).getTime()-Lb.MoveButtonClickedTime.getTime(),
Sa.set("MovePostDuration",Lb.toString());za.Health.instance.recordKpiUsage("MoveToFolder",0,"smartfio",Sa)}return 32}return 8};U.prototype.qlc=function(Sa,Kb,Gc,Hb,Lb){if(1===Gc)return Ha.AFrameworkApplication.ga.ra("UiHostSupportsMoveToFolder")?this.O6a():8;if(2===Gc){if(!Ha.AFrameworkApplication.XXf)return za.Health.instance.recordKpiFailure("MoveToFolder","Null SendFileNameAndLocationUpdateNotification",!1,!1,null),8;if(!Lb)return za.Health.instance.recordKpiFailure("MoveToFolder","Null actiondata",
!1,!1,null),8;if(Lb[cb.a.phi])if(Lb[cb.a.bfg])if(Sa=Lb[cb.a.bfg].toLowerCase(),Kb=Ha.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"),Gc=Ha.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CrossSiteMove",!1),Kb&&Ha.AFrameworkApplication.bla&&Gc){var sa={};sa[cb.a.bQa]="1";sa[cb.a.documentUrl]=Sa;sa[cb.a.reason]=Dc.a.saveAs;za.Health.instance.recordKpiSuccess("MoveToFolder",null);Ha.AFrameworkApplication.vV().execute(function(Ua){Ua.Sj(Mb.a.Qta,sa)})}else if(!Ha.AFrameworkApplication.bla&&
Gc)za.Health.instance.recordKpiSuccess("MoveToFolder",null),Cb.a.vf(Sa,Cb.a.CX(3),void 0,"RenameActor.MoveToFolderCompleteByHost");else return za.Health.instance.recordKpiFailure("MoveToFolder","CrossSite Unsupported",!1,!1,null),8;else za.Health.instance.recordKpiFailure("MoveToFolder","Null newDocUrl",!1,!1,null);else Ha.AFrameworkApplication.iJa(Object(X.a)(this,this.Xnc,"onRefreshFilenameSuccess"),Object(X.a)(this,this.Wnc,"onRefreshFilenameFailure"),!1),Ha.AFrameworkApplication.XXf(),za.Health.instance.recordKpiSuccess("MoveToFolder",
null)}return 32};U.prototype.Xzj=function(Sa,Kb){return Sa&&Kb?Sa!==this.Bv.breadcrumbFolderName||Kb!==this.Bv.breadcrumbFolderUrl:!1};U.prototype.Xnc=function(Sa,Kb){Sa&&(Sa.NewName!==Xa.a.lr(this.Bv.zn)||this.Xzj(Sa.BreadcrumbFolderName,Sa.BreadcrumbFolderUrl))&&this.aEb(Sa,Kb)};U.prototype.Wnc=function(){};U.prototype.qUf=function(){this.oje(Xa.a.lr(this.Bv.zn))};U.tub=function(){return new U(Ha.AFrameworkApplication.P6a,new ca.a(function(){return Ha.AFrameworkApplication.Gb}),new ca.a(function(){return Ha.AFrameworkApplication.Ry}),
Ha.AFrameworkApplication.dm,Ha.AFrameworkApplication.limitedEdit,function(){return Ha.AFrameworkApplication.userCanRename},Ha.AFrameworkApplication.Wsc,Object(X.a)(la.instance,la.instance.zX,"updateTitle"),ya.a.instance.resolve("Common.App.Rename.IRenamedFileChecker"),function(){return Ha.AFrameworkApplication.isReadOnlyRecommended},Ha.AFrameworkApplication.ga,ya.a.instance.resolve("Common.IRenameProps"))};U.dKg=function(Sa,Kb){Sa=Xa.a.v4(Sa);return Kb+Sa};U.w7i=function(Sa){var Kb=Sa.Values[cb.a.Pki];
ja.ULS.sendTraceTag(560820289,204,50,"Host_MoveToFolder Received IsSuccessful: {0}",Kb);Kb?Ha.AFrameworkApplication.Gb.Ce(db.a.qlc,2,Sa.Values):za.Health.instance.recordKpiFailure("MoveToFolder","MoveToFolder Server Failure",!1,!1,null)};U.u7i=function(Sa){Ha.AFrameworkApplication.Gb.Ce(db.a.renameFile,2,Sa.Values.NewName)};Sk.Object.defineProperties(U.prototype,{Gi:{configurable:!0,enumerable:!0,get:function(){return this.La.value}},Ry:{configurable:!0,enumerable:!0,get:function(){return this.pGc.value}}});
Sk.Object.defineProperties(U,{instance:{configurable:!0,enumerable:!0,get:function(){return U.Oa||(U.Oa=U.tub())}}});U.Oa=null;Object(A.a)(U,"RenameActor",null,[]);b(939);Object(A.a)(function(){},"ActivityEventName",null,[]);V.compatMode="CompatMode";V.noSelection="NoSelection";Object(A.a)(V,"ActivityEventReason",null,[]);var ib=b(688);D.prototype.Qg=function(){this.La.fc(db.a.N4f,Na.a.frame,Object(X.a)(this,this.KCj,"showRenameDialogAction"))};D.prototype.KCj=function(Sa,Kb,Gc){Sa=32;if(1===Gc)return ib.SessionStatusManager.instance.ywb||
Ha.AFrameworkApplication.q5?8:32;2===Gc&&(32!==this.La.processAction(db.a.renameFile,1)?(this.La.processAction(db.a.odb,2),Sa=8):32===this.La.processAction(db.a.hSd,1)?this.La.processAction(db.a.hSd,2):this.uVa.value.create().qxc());return Sa};Object(A.a)(D,"RenameDialogActor",null,[448]);v.prototype.uXh=function(){var Sa={},Kb={};Sa.nameInputProps=(Kb.type="AppInputProps",Kb.id=v.y1a,Kb.label=CommonUIStrings.l_RenameDialogLabel,Kb.value=Xa.a.lr(this.Bv.zn),Kb.maxLength=this.$pa,Kb);return Sa};v.prototype.qxc=
function(){var Sa=this.uXh(),Kb={};Sa=(Kb.id="RenameDialog",Kb.bodyControls=Sa,Kb);this.dialog=new pa.a(!1,!1,!0);this.dialog.jc=1;this.dialog.Ue="RenameDialog";this.dialog.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(X.a)(this,this.UJd,"renameDialogHandler"),Sa)};v.prototype.UJd=function(Sa,Kb){Kb&&1===Sa&&Kb[v.y1a]&&(Sa=Xa.a.lr(this.Bv.zn),Kb=(Kb[v.y1a]||"").trim(),Kb!==Sa&&""!==Kb&&this.La.Ce(db.a.renameFile,2,Kb))};v.y1a="txtDocumentName";Object(A.a)(v,"ReactRenameDialog",null,
[461]);Sk.Object.defineProperties(J,{eg:{configurable:!0,enumerable:!0,get:function(){return pa.a.Cn(J.Vj,CommonUIStrings.l_RenameDialogLabel)}}});J.Vj="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblDocumentName' class='WACDialogLabel' for='txtDocumentName' >{0}</label> <input type='text' id='txtDocumentName' class='WACDialogInput' autocomplete=\"off\"/> </div>";Object(A.a)(J,"RenameDialogHtml",null,[]);var ub=pa.a;vm(r,ub);r.prototype.qxc=function(){var Sa={};Sa=(Sa.txtDocumentName=
Xa.a.lr(this.Bv.zn),Sa);this.initializeAndShow(CommonUIStrings.l_RenameDialogTitle,Object(X.a)(this,this.UJd,"renameDialogHandler"),Sa);Sa=document.getElementById(r.y1a);0<this.$pa&&(Sa.maxLength=this.$pa);Sa.focus()};r.prototype.UJd=function(Sa,Kb){1===Sa&&(Sa=Xa.a.lr(this.Bv.zn),Kb=(Kb[r.y1a]||"").trim(),Kb!==Sa&&""!==Kb&&this.La.Ce(db.a.renameFile,2,Kb))};r.y1a="txtDocumentName";Object(A.a)(r,"RenameDialog",pa.a,[461]);C.prototype.initialize=function(Sa,Kb){this.G8=Sa;this.$pa=Kb;this._initialized=
!0};C.prototype.create=function(){return this._initialized?Ha.AFrameworkApplication.sa&&Ha.AFrameworkApplication.sa.Qa.rw&&Ha.AFrameworkApplication.ga.ra("ReactRenameDialogIsEnabled")?new v(this.La,this.G8,this.$pa):new r(this.La,this.G8,this.$pa):null};Object(A.a)(C,"RenameDialogFactory",null,[447]);var Eb=b(168);u.prototype.Qg=function(){this.La.fc(db.a.hSd,Na.a.frame,Object(X.a)(this,this.LCj,"showRenameFlyoutAction"))};u.prototype.JUg=function(){return Eb.d("setDocumentTitleFlyoutOpened")&&Ha.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled};
u.prototype.LCj=function(Sa,Kb,Gc){if(1===Gc)return this.JUg()?32:8;appChrome.api.dispatch(appChrome.actions.setDocumentTitleFlyoutOpened(!0));return 32};Object(A.a)(u,"RenameFlyoutActor",null,[446]);z.prototype.N2e=function(){if(!this.$9d())return 5;if(this.mqa())return 1;if(this.Ry){if(this.a$d&&!this.Ry.EJe)return 3;if(!this.a$d&&!this.Ry.rub)return 4}return this.Ayg()?0:2};Sk.Object.defineProperties(z.prototype,{Ry:{configurable:!0,enumerable:!0,get:function(){return this.pGc.value}}});Object(A.a)(z,
"RenameProps",null,[445]);b(184);var Ya=b(100);B.prototype.enable=function(){this.tl||(this.Kcg(),this.GTd(),this.tl=!0)};B.prototype.generateKey=function(Sa,Kb,Gc){return String.format("{0}/{1}/{2}",Gc,Sa,Kb)};B.prototype.ISh=function(){var Sa=Xa.a.lr(this.AVa().zn);return this.generateKey(this.AVa().breadcrumbFolderName,this.AVa().breadcrumbFolderUrl,Sa)};B.prototype.JSh=function(Sa,Kb,Gc){return Sa&&Kb?this.generateKey(Sa,Kb,Gc):Gc};B.prototype.ffh=function(Sa,Kb,Gc){return Sa&&Sa!==this.AVa().breadcrumbFolderName||
Kb&&Kb!==this.AVa().breadcrumbFolderUrl?!0:Gc!==Xa.a.lr(this.AVa().zn)};B.prototype.Kcg=function(){var Sa=this.ISh();this.nMc.ia(Sa,new Date)};B.prototype.xDd=function(Sa){this.Fyj(Sa)&&this.xke(Sa)};B.prototype.Fyj=function(Sa){var Kb=this.Cmg();return Kb?this.The&&this.The.Zyb||!Kb.pef||!Ha.AFrameworkApplication.iJa?(this.j7f(Sa),this.tl=!1):!0:!1};B.prototype.jEf=function(Sa,Kb,Gc,Hb){var Lb=this.ffh(Sa,Kb,Gc);Sa=this.JSh(Sa,Kb,Gc);Kb=this.nMc.Gc(Sa).returnValue;Lb&&!Kb&&(this.K6e(Hb),ja.ULS.sendTraceTag(591734297,
203,50,"{0} forced FileNameUpdate",this.rud));Lb||this.nMc.ia(Sa,this.$L())};Object(A.a)(B,"ARenamedFileChecker",null,[399]);vm(t,B);t.prototype.GTd=function(){this.bfe.rVc(Object(X.a)(this,this.v7e,"handleSettingsRefresh"))};t.prototype.v7e=function(Sa,Kb){Kb&&Kb.sCb&&Kb.IGi&&(Kb.Y6a("BreadcrumbDocName")||Kb.Y6a("BreadcrumbFolderName")||Kb.Y6a("BreadcrumbFolderUrl")||Kb.Y6a("DirectInvokeDAVUrl")||Kb.Y6a("EditDocInClientUrl"))&&(ja.ULS.sendTraceTag(591229211,203,50,"{0}: Possible rename detected.",
this.rud),this.xDd(Kb))};t.prototype.j7f=function(){this.bfe.sdj(Object(X.a)(this,this.v7e,"handleSettingsRefresh"))};t.prototype.xke=function(Sa){if(Sa&&Sa.sCb){var Kb=Sa.sCb;this.jEf(Kb.Ua("BreadcrumbFolderName"),Kb.Ua("BreadcrumbFolderUrl"),Kb.Ua("BreadcrumbDocName"),Sa)}};t.prototype.K6e=function(Sa){var Kb=this,Gc={OperationResult:0,classId:1};Sa=Sa.sCb;Gc.BreadcrumbFolderName=Sa.Ua("BreadcrumbFolderName");Gc.BreadcrumbFolderUrl=Sa.Ua("BreadcrumbFolderUrl");Gc.DirectInvokeDavUrl=Sa.Ua("DirectInvokeDAVUrl");
Gc.EditDocInClientUrl=Sa.Ua("EditDocInClientUrl");Sa=Sa.Ua("BreadcrumbDocName");Gc.NewName=Ha.AFrameworkApplication.AIa?Sa:Xa.a.lr(Sa);this.mqg.execute(function(Hb){Kb.Sei(Gc,Hb)})};t.prototype.Sei=function(Sa,Kb){this.Oug().aEb(Sa,Kb)};Sk.Object.defineProperties(t.prototype,{rud:{configurable:!0,enumerable:!0,get:function(){return"RenamedFileCheckerUsingSettingsRefresh"}}});Object(A.a)(t,"RenamedFileCheckerUsingSettingsRefresh",B,[]);var tb=b(108);vm(y,B);y.prototype.I$i=function(Sa){this.lXb=Sa;
this.lXb.AGg(Object(X.a)(this,this.jjd,"handleVisibilityChange"))};y.prototype.jjd=function(Sa,Kb){!this.tl||0!==Kb.newState&&1!==Kb.newState||this.dlb||(this.GTd(),this.xDd(this.dlb))};y.prototype.GTd=function(){this.dlb=new tb.a(3,2,this.Utg(),Object(X.a)(this,this.xDd,"performRenameFileCheckTick"),89);this.me.Zg(this.dlb)};y.prototype.j7f=function(Sa){this.me.Np(Sa)};y.prototype.xke=function(Sa){this.lXb&&2===this.lXb.D_j?this.Gaj(Sa):Ha.AFrameworkApplication.iJa(Object(X.a)(this,this.Xnc,"onRefreshFilenameSuccess"),
Object(X.a)(this,this.Wnc,"onRefreshFilenameFailure"),!0)};y.prototype.Gaj=function(Sa){this.me.Np(Sa);this.dlb=null};y.prototype.Xnc=function(Sa){Sa&&this.jEf(Sa.BreadcrumbFolderName,Sa.BreadcrumbFolderUrl,Sa.NewName,null)};y.prototype.K6e=function(){this.La.processAction(db.a.fileNameUpdate,2)};y.prototype.Wnc=function(){};Sk.Object.defineProperties(y.prototype,{rud:{configurable:!0,enumerable:!0,get:function(){return"RenamedFileCheckerUsingTask"}}});Object(A.a)(y,"RenamedFileCheckerUsingTask",
B,[]);x.prototype.ji=function(Sa){var Kb=this;this.tb=Sa;this.wb=Ha.AFrameworkApplication.ga;this.tb.register(D,"Common.App.Rename.RenameDialogActor").as("Common.App.Rename.IRenameDialogActor").Lc(function(){return new D(Ha.AFrameworkApplication.Gb,Kb.tb.rLd("Common.App.Rename.IRenameDialogFactory"))}).Bc();this.tb.register(C,"Common.App.Rename.RenameDialogFactory").as("Common.App.Rename.IRenameDialogFactory").Lc(function(){return new C(Ha.AFrameworkApplication.Gb)}).Bc();this.tb.register(399,"Common.App.Rename.IRenamedFileChecker").Lc(function(){return Kb.u9g()}).Bc();
this.tb.register(u,"Common.App.Rename.RenameFlyoutActor").as("Common.App.Rename.IRenameFlyoutActor").Lc(function(){return new u(Ha.AFrameworkApplication.Gb)}).Bc()};x.prototype.u9g=function(){var Sa=this;if(this.wb.ra("RenamedFileCheckerWithSettingsRefreshIsEnabled")){var Kb=this.tb.Oh("Common.IRefreshableAppSettings");if(Kb&&Kb.rmi)return new t(function(){return Kb.Ad("RenamedFileCheckerMaxCachedAgeInMs",48E4)},function(){return Ha.AFrameworkApplication.dm},function(){return new Date},function(){return Ha.AFrameworkApplication.Ry},
Kb,this.tb.Oh("Common.ISessionStatus"),function(){return U.instance},this.tb.oc("Postmessage.IHostPostmessenger"))}return new y(function(){return Sa.wb.Ad("RenamedFileCheckerMaxCachedAgeInMs",48E4)},function(){return Sa.wb.Ad("RenamedFileCheckerPingIntervalInMs",12E4)},function(){return Ha.AFrameworkApplication.dm},function(){return new Date},function(){return Ha.AFrameworkApplication.Ry},Ha.AFrameworkApplication.ga,Ha.AFrameworkApplication.Gb,Ha.AFrameworkApplication.hj,this.tb.Oh("Common.ISessionStatus"),
this.tb.oc("Common.App.VisibilityManagement.IVisibilityManager"))};x.prototype.init=function(){this.wb.ow(Object(X.a)(this,this.lB,"onFullAppSettingsReady"))};x.prototype.lB=function(){var Sa=Ha.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled;Ha.AFrameworkApplication.P6a()&&la.instance.initialize(Ha.AFrameworkApplication.n9b,Sa?null:Ha.AFrameworkApplication.z1a,Sa?null:Ha.AFrameworkApplication.WJd||CommonUIStrings.l_RenameFileTooltip)&&(this.tb.register(z,"Common.App.Rename.RenameProps").as("Common.IRenameProps").Lc(function(){return new z(function(){return Ha.AFrameworkApplication.userCanRename},
function(){return Ha.AFrameworkApplication.isReadOnlyRecommended},Ha.AFrameworkApplication.Wsc,Ha.AFrameworkApplication.P6a,new ca.a(function(){return Ha.AFrameworkApplication.Ry}))}).Bc(),U.instance.Qg(),this.wb.ra("RenameDialogIsEnabled")&&(this.tb.resolve("Common.App.Rename.RenameDialogFactory").initialize(Ha.AFrameworkApplication.dm,Ha.AFrameworkApplication.n9b),this.tb.resolve("Common.App.Rename.IRenameDialogActor").Qg()),this.tb.resolve("Common.App.Rename.IRenameFlyoutActor").Qg(),Ha.AFrameworkApplication.Wsc&&
this.tb.resolve("Common.App.Rename.IRenamedFileChecker").enable())};x.prototype.dispose=function(){};Sk.Object.defineProperties(x.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.RenameFile"}}});Object(A.a)(x,"PackageManager",null,[4,5]);F=b(273);var ec=b(10),Za=b(817),mb=b(56),sc=b(35),pd=b(57),$b=b(175),Xb=b(52);f.prototype.executeCommand=function(Sa,Kb,Gc){switch(Kb.command){case db.a.cia:return pd.a.Rf.isReactSharedHeaderUxEnabled?2!==Ha.AFrameworkApplication.Gb.Ce(db.a.cia,
2,Gc)?Xb.Task.Ta(!0):$b.a(Kb.command):$b.a(Kb.command);case 1897077126:return this.renameFileManager.renameFile(Gc,Kb),Xb.Task.Ta(!0);default:return $b.a(Kb.command)}};f.prototype.Jc=function(Sa,Kb,Gc,Hb){switch(Kb.command){case db.a.cia:return pd.a.Rf.isReactSharedHeaderUxEnabled;case 1897077126:return!!Hb&&2===Hb.xA}return!1};f.prototype.fd=function(){return!1};f.prototype.Yc=function(){return!1};f.prototype.dispose=function(){this.renameFileManager=null};Object(A.a)(f,"RenameFileCommandHandler",
null,[188,3]);var lc=Za.a;vm(m,lc);m.prototype.Od=function(){var Sa=this,Kb=mb.GetServiceTaskFactory.create(this.$.da,119,this.ma,this.ub);sc.TaskExtensions.Ba(Kb,function(){Sa.Fd([new f(Kb.result)])},this.ma,3)};m.ja=function(Sa){Za.a.fe(118,new m(Sa))};Object(A.a)(m,"RenameFileCommandHandlerFactory",Za.a,[]);var Oa=b(88),pb=b(214),Ub=b(220),ic=b(74),Jb=b(379),cc=b(77),Ob=b(369),P=b(164),Ba=b(92),ra=b(303),ta=b(1),Ia=b(19),bb=b(272);Sk.Object.defineProperties(n.prototype,{pef:{configurable:!0,enumerable:!0,
get:function(){return this.$.workbookContext.FileCoauthorable}},Zyb:{configurable:!0,enumerable:!0,get:function(){return!1}},rub:{configurable:!0,enumerable:!0,get:function(){return this.$.ea.amIAlone}},EJe:{configurable:!0,enumerable:!0,get:function(){if(this.rub)return!0;for(var Sa=yl(this.$.ea.km),Kb=Sa.next();!Kb.done;Kb=Sa.next())if(!Kb.value.SupportsRename)return!1;return!0}}});Object(A.a)(n,"EwaCoauthManager",null,[893]);var Va=b(81),lb=b(65),kc=ic.a;vm(l,kc);l.prototype.initialize=function(){Ha.AFrameworkApplication.F8b=
this.XKi;Ha.AFrameworkApplication.iJa=this.WKi;this.$5c=Ha.AFrameworkApplication.Ry;Ha.AFrameworkApplication.Ry=new n(this.$)};l.prototype.dispose=function(){Ha.AFrameworkApplication.F8b=null;Ha.AFrameworkApplication.iJa=null;this.$.ea.Ew(this.eka);Ha.AFrameworkApplication.Ry=this.$5c;this.$=this.$5c=null;kc.prototype.dispose.call(this)};l.prototype.renameFile=function(Sa,Kb){var Gc=this,Hb=Sa.newFileName;if(Hb){var Lb=this.$.na.ta.Zb();Ob.a(this.$.userOperationManager,function(sa,Ua,Yb){var jc=Gc.$.na.ta;
sa=bb.b(sa,Gc.aEb);Ua=bb.a(Ua,Gc.DRi);var md=jc.Na(9,Lb);md.newFileName=Hb;return Va.i(jc,"RenameFile",md,sa,Ua,Yb,null,0)},function(sa){return new P.a(134,0,sa)},Kb)}};l.prototype.$gi=function(){return 32===Ha.AFrameworkApplication.Gb.processAction(db.a.cia,1)};l.prototype.O2e=function(Sa){var Kb=this.$.workbookContext;Ha.AFrameworkApplication.U3=Sa.DownloadACopyUrl;var Gc=ta.EwaSettings.la(564)&&!!Sa.BreadcrumbFolderUrl;Gc&&(Ha.AFrameworkApplication.dm.breadcrumbFolderName=Sa.BreadcrumbFolderName,
Ha.AFrameworkApplication.dm.breadcrumbFolderUrl=Sa.BreadcrumbFolderUrl,Kb.FullDocumentInfo.BreadcrumbFolderUrl=Sa.BreadcrumbFolderUrl,Kb.FullDocumentInfo.BreadcrumbFolderName=Sa.BreadcrumbFolderName);Kb.FullDocumentInfo.BreadcrumbDocName=Sa.NewFileName;Jb.d(Kb,Sa.NewFileName);Kb={};Kb.NewName=Sa.NewFileName;Kb.DirectInvokeDavUrl=Sa.DirectInvokeDAVUrl;Kb.EditDocInClientUrl=Sa.EditDocInClientUrl;Gc&&(Kb.BreadcrumbFolderName=Sa.BreadcrumbFolderName,Kb.BreadcrumbFolderUrl=Sa.BreadcrumbFolderUrl);Kb.OperationResult=
0;return Kb};l.yIh=function(Sa){switch(Sa.Errors[0].MessageId){case -414480287:Sa=2;break;case 650565124:Sa=1;break;case 1636785843:Sa=6;break;case -782844485:Sa=4;break;default:Sa=5}return Sa};Object(A.a)(l,"RenameFileManager",ic.a,[876,3]);var zb=b(48),Sb=pb.a;vm(e,Sb);e.prototype.create=function(){var Sa=this;if(!this.ZY){var Kb=Ub.a.K0a(zb.b(),this.ma,"Task","IRenameFileManager");this.ZY=Kb.task;var Gc=mb.GetServiceTaskFactory.create(this.$.da,137,this.ma,this.ub),Hb=mb.GetServiceTaskFactory.create(this.$.da,
155,this.ma,this.ub);sc.TaskExtensions.Ba(sc.TaskExtensions.ve([Hb,Gc],this.ma),function(){var Lb=new l(Sa.$,Gc.result);Sa.$.da.Ha(120,Lb);Kb.setResult(Lb)},this.ma,3)}this.ZY.continueWith(function(Lb){Sa.Fb(Lb.result)})};e.prototype.dispose=function(){Oa.a.Fa(this.renameFileManager);this.$=this.renameFileManager=null;Sb.prototype.dispose.call(this)};e.ja=function(Sa){Sa.da.Ha(119,new e(Sa))};Object(A.a)(e,"RenameFileManagerServiceFactory",pb.a,[]);c.prototype.Yc=function(){return!1};c.prototype.executeCommand=
function(Sa,Kb,Gc){return 2!==this.Gi.Ce(db.a.N4f,2,Gc)?Xb.Task.Ta(!0):$b.a(Kb.command)};c.prototype.Jc=function(Sa,Kb){return 1204860550===Kb.command};c.prototype.fd=function(){return!1};Object(A.a)(c,"RenameFileDialogCommandHandler",null,[188]);var gb=Za.a;vm(a,gb);a.prototype.Od=function(){var Sa=this;sc.TaskExtensions.Ba(mb.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.ub),function(){Sa.Fd([new c(Ha.AFrameworkApplication.Gb)])},this.ma,3)};a.ja=function(Sa){Za.a.fe(131,new a(Sa))};Object(A.a)(a,
"RenameFileDialogCommandHandlerFactory",Za.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Rename");F.a.instance.sj(new x,7);(function(){ec.a.Ga(function(Sa){e.ja(Sa);m.ja(Sa)})})();ec.a.Ga(a.ja)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.rn.js.map/12ad7784f2b10956e2d5018c2ff4ca78/EwaDS.rn.js.map