(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[18],{1209:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);a.KDc="b-ring_Apc_Trans";a.kig="cdn_static_resource_ewa_image";Object(A.a)(a,"ResourceHosts",null,[])},1255:function(A,F,b){function a(){}function c(x,y,t,B,z){this.url="";this.y5a=!1;this.P7=-1;this.testIteration=0;this.baseUrl=t;this.qwf=B;this.wkd=y;this.result=new e(y,z)}function e(x,y){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=
this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=x;this.caller=y;this.reset()}A=b(0);var l=b(54),n=b(13),m=b(277);e.prototype.reset=function(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null};Object(A.a)(e,"NetworkTestResult",null,[]);var f=b(598);c.prototype.oMd=function(){try{if(this.y5a)n.ULS.sendTraceTag(537155206,0,
50,"NetworkTestReq.RunTest: a test for the host {0} is already mid way, not starting a new one.",this.wkd);else{this.reset();this.y5a=!0;this.result.startTimeMs=Date.now();var x=new m.QueryStringBuilder(this.baseUrl);x.G9("tid",this.result.startTimeMs.toString());this.url=x.toString();this.Unj();this.testIteration++;this.result.testIteration=this.testIteration}}catch(y){this.wtb("Exeption: "+y.message)}};c.prototype.reset=function(){this.url="";this.result.reset();this.y5a=!1;this.P7=-1};c.prototype.clearTimeout=
function(){-1!==this.P7&&(window.clearTimeout(this.P7),this.P7=-1)};c.prototype.Unj=function(){var x=this;try{var y=new XMLHttpRequest;y.onreadystatechange=function(){4===y.readyState&&(200===y.status?x.lDh():x.wtb(String.format("Error when downloading resource. status code: {0}, status text: {1}",y.status,y.statusText),y.status.toString()))};y.onerror=function(){x.wtb(String.format("Client error when attempting to download resource. status code: {0}, response: {1}",y.status,y.statusText))};this.P7=
window.setTimeout(function(){x.P7=-1;x.wtb("Request timeout")},1E4);y.open("GET",this.url,!0);y.send(null)}catch(t){this.wtb("Exeption: "+t.message)}};c.prototype.lDh=function(){this.y5a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=f.a(this.url),this.result.isSuccess=!0,this.O2b())};c.prototype.wtb=function(x,y){y=void 0===y?null:y;this.y5a&&(this.clearTimeout(),this.result.errorMessage=x,this.result.isSuccess=!1,this.result.errorStatusCode=
y,this.O2b())};c.prototype.O2b=function(){this.y5a=!1;this.qwf&&this.qwf(this.result,this.wkd)};Object(A.a)(c,"NetworkTestReq",null,[]);b.d(F,"a",function(){return a});a.Vcd=function(x,y,t,B){B=void 0===B?null:B;a.Glc||(a.Glc=Array.isArray(l.a.pi(t.ya.NetworkMeasurementUrlList))?l.a.pi(t.ya.NetworkMeasurementUrlList):null);for(var z=[],u=0;u<a.Glc.length;u++){var C=a.Glc[u],r=C.key;r||(r=C.Key);if(!B||Array.contains(B,r)){var J=C.value;J||(J=C.Value);r&&J&&z.push(new c(t,r,J,x,y))}}return z};a.Glc=
null;Object(A.a)(a,"NetworkConnectionHelpers",null,[])},1374:function(A,F,b){function a(Y){var Ra=$i.call(this)||this;Ra.$=Y;Ra.dc();return Ra}function c(){}function e(Y,Ra,xb,fc,bd,Dd,Td){Y=n.call(this,Y,Ra,xb,fc,bd,!1)||this;Y.$Yd=!1;Y.T0=Td;Y.iec=e.wHh(Dd);Dd=Y.zZd(Y.iec.name,Y.iec.size);if(0!==Dd)return Y.RRd(Dd),Y.T0.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),Y.dispose(),Y;Y.Hj=new t(Y.$.domElement,Object(Ve.a)(Y,Y.uEb,"onUploadFrameInitialized"),Object(Ve.a)(Y,Y.Koa,
"uploadResponseReceived"),fc,!1,Y.$);return Y}function l(Y,Ra){this.filename=Y;this.blob=Ra}function n(Y,Ra,xb,fc,bd,Dd){Dd=void 0===Dd?!0:Dd;Y=x.call(this,Y,xb,fc,bd,!1)||this;Y.ae=Ra;Dd&&Y.showDialog();return Y}function m(Y,Ra){this.dataUri=this.sheetName=null;this.sheetName=Y;this.dataUri=Ra}function f(Y,Ra,xb,fc,bd,Dd){Dd=void 0===Dd?!0:Dd;Ra=x.call(this,Y,Ra,xb,fc,!1)||this;Ra.qBh=bd;Ra.o9b=Y.Vb.Wh("LoadResource","FileReaderUploaderLoadResource");Dd&&Ra.showDialog();return Ra}function x(Y,Ra,
xb,fc,bd){bd=void 0===bd?!0:bd;var Dd=Ya.call(this,null,Ra,xb)||this;Dd.Cr=null;Dd.raa=null;Dd.Nzb=!1;Dd.DDd=null;Dd.Koa=function(Td){Dd.q_d.stop();Dd.I_b.cancel();if(t.tii(Td))Dd.Xzc?Dd.D6e(4):(Td=new Eh.a(0,2,null,null,!1,null,null,null),Td.status=8,Dd.GWd(new Qg.a(Td),null,"InsertPictureWebMethod")),oc.ULS.sendTraceTag(526399121,0,50,"Http Error occurred, isTimeoutError: {0}",Dd.Xzc);else{var we=x.zWj(Td);0!==we?(oc.ULS.sendTraceTag(526399122,0,50,"Server returned error, response: {0}",Td),Dd.D6e(we)):
Dd.A5h(Td)}Dd.Aoc();Dd.dispose()};Dd.fLi=function(Td){Dd.NBa(Td,Dd.Hj)&&Dd.finalizeUpload(Dd.Hj,null)};Dd.uEb=function(Td){oc.ULS.sendTraceTag(526399120,0,50,"Upload frame initialized");Dd.Hj=Td;if(!Dd.s1a){if(Dd.$Yd){if(x.Dwe()||Dd.L8a&&Oc.a.sF){Td.E6b(Dd.fLi);return}var we=Td.E6b(null);if(!Dd.NBa(we,Td))return}Dd.finalizeUpload(Td,null)}};Dd.vUi=function(){Dd.Xzc=!0};Dd.vb=Y;Dd.q_d=Y.Vb.Wh("WebServiceCall","InsertPictureOperation");Dd.I_b=dh.a.instance.create(Dd.vUi,1E5,Qh.a.RNg,!1);Dd.Xzc=!1;Dd.Fkc=
Dd.$.ya.InsertPictureMaxFileSizeBytes;fc&&(Dd.Nzb="TestOnly"in fc);bd&&Dd.showDialog();return Dd}function y(Y,Ra,xb){var fc=u.call(this,Y,!1)||this;fc.bV=null;fc.YAa=!1;fc.Pmc=function(){fc.cYd("");fc.UAc();return!1};fc.$=Ra;fc.aCc=Y;fc.fR=tg.a.instance;fc.ga=xb;fc.P0f();fc.Xld();fc.$.Ab.TC=!0;return fc}function t(Y,Ra,xb,fc,bd,Dd,Td){Y=B.call(this,Y,Ra,xb,fc,bd,"UploadFrame",Dd.ea.sessionId,"image/*",!1,null,void 0===Td?!1:Td)||this;Y.$=Dd;Y.lfg=!0;Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?
Y.ibf():Y.Zqe();return Y}function B(Y,Ra,xb,fc,bd,Dd,Td,we,Oe,Te,Zf){Oe=void 0===Oe?!0:Oe;Zf=void 0===Zf?!1:Zf;this.ITe="FileUpload.ashx";this.Vn=null;this._initialized=!1;this.Lg=this.jib=this.iIc=this.Hga=this.SRb=this.Wq=this.Fs=null;this.tm=!1;this.JD=this.TRb=this.DSc=null;this._parent=Y;this.Eqg=Ra;this.evg=xb;this.k7d=bd;this.AQc=Td;this.e1d=we;this.c3d=void 0===Te?null:Te;this.CSc=!1;this.Xqg=fc.ra("CanaryRenewalForFileUploadIsEnabled");this.lfg=!1;(this.Nqa=Zf)||this.A4g(Dd);Oe&&this.ibf()}
function z(Y,Ra,xb){if(Y){var fc=0;do{try{Y();break}catch(bd){if(oc.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",fc,xb,bd.message,bd.stack),fc>=Ra)break}fc++}while(1)}}function u(Y,Ra){return r.call(this,Y,void 0===Ra?!0:Ra)||this}function C(){}function r(Y,Ra){Ra=void 0===Ra?!0:Ra;var xb=Tg.call(this,!1,!1,r.wy)||this;xb.fXa=null;xb.E6d=!1;xb.Sm=[];xb.Hj=null;xb.$Wb=Y;xb.Uvg=Ra;xb.rie=!1;xb.Cv=!1;xb.Hga=null;xb.jIc=!1;xb.eg=
xb.Seh;xb.Ue="InsertFileDialog";xb.Fc(1,xb.zXb);if(r.wy){Y={};Ra={};var fc={};xb.fXa=(fc.id=xb.Ue,fc.bodyControls=(Ra.uploadButtonProps=(Y.label=CommonUIStrings.l_DialogChooseFile,Y.onExecute=Object(Ve.a)(xb,xb.$Ui,"onUploadButtonClick"),Y),Ra),fc.uploadStatusLabel=CommonUIStrings.l_DialogNoFileChosen,fc.onFrameReady=Object(Ve.a)(xb,xb.HLi,"onFrameReady"),fc);xb.initializeAndShow(xb.titleText,Object(Ve.a)(xb,xb.Oec,"insertDialogHandler"),xb.fXa);xb.tRb=!0}else xb.showDialog(xb.titleText,Object(Ve.a)(xb,
xb.Oec,"insertDialogHandler")),Ra&&xb.P0f(),(Y=xb.kV(1))&&xb.Sm.push(Y),(Y=xb.kV(0))&&xb.Sm.push(Y),xb.Ydg(),xb.tRb=!1;return xb}function J(Y){var Ra=rh.call(this)||this;Ra.$=Y;Ra.dc();return Ra}function v(Y,Ra,xb,fc){var bd=this;this.hL=null;this.oeg=function(){bd.hL&&(bd.e_d=aa.a.Ra.he.m,bd.hide(),dh.a.instance.create(function(){bd.STj()},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",void 0,!0))};this.TIe=function(Dd){10===Dd&&bd.tIa()};this.Rfh=function(){if(bd.hL){var Dd=document.getElementById("PasteRecoveryUI");
Dd&&Je.a.vj===Dd.getAttribute(Je.a.zY)&&Dd.click();bd.tIa()}};this.UIe=function(){bd.tIa()};this.VIe=function(){bd.tIa()};this.onKeyUp=function(Dd){if(bd.hL){if(bd.m_)return!1;if(17===Dd.Ea.keyCode&&bd.M8b){Dd=document.getElementById("PasteRecoveryUI");if(!Dd)return oc.ULS.shipAssertTag(537154070,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;var Td=Dd.getAttribute(Je.a.zY)||"";if(Je.a.Po===Td)return Dd.click(),!0}}return!1};this.onKeyDown=function(Dd){if(bd.hL){bd.M8b=!1;bd.m_=
Dd.ctrlKey;Dd=Dd.Ea.keyCode;if(27===Dd)return bd.tIa(),!0;if(17===Dd)return bd.M8b=!0}return!1};this.J_=function(Dd,Td){Dd=Td.ae;bd.nAb=Dd;-1027730316!==Dd.command&&-1059615499!==Dd.command?bd.tIa():(Td=Td.properties)&&Td.launcherId!==bd.$Sh()&&bd.tIa()};this.$=Y;this.$qc=Ra;this.qr=xb;this.pk=fc;this.Fsd=this.nAb=this.qsd=null;this.m_=this.M8b=this.k6b=this.ydc=!1;this.e_d=0;this.$.da.Ha(406,this)}function D(Y){var Ra=jf.call(this)||this;Ra.$=Y;Ra.dc();return Ra}function V(Y,Ra,xb){xb=void 0===xb?
!0:xb;var fc=ef.call(this)||this;fc.pSa=null;fc.Tna=null;fc.sOa=null;fc.a3b=null;fc.M0=null;fc.jsf=0;fc.Lab=!1;fc.Kab=!1;fc.Mrc=!1;fc.documentVisibilityObserver=null;fc.ksf=null;fc.uDj=null;fc.Mfa=!1;fc.N7=0;fc.pld=0;fc.tzb=!1;fc.t5f=0;fc.NQd=!1;fc.X0=null;fc.PDb=function(){oc.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");fc.glc(1,!1)};fc.vya=function(){fc.Hka||fc.rBb?window.setTimeout(function(){fc.XVd()},fc.jsf):fc.XVd();fc.documentVisibilityObserver.fHb(fc.vya);
fc.tzb=!1};fc.Kg=function(){oc.ULS.sendTraceTag(537155218,0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:{0}, IsInDuringWorkSilentReopenMode:{1}",fc.rBb&&fc.Vwc,fc.ckc&&!fc.Mfa&&fc.xKb);fc.rBb&&fc.Vwc&&fc.Jke();fc.ckc&&!fc.Mfa&&fc.xKb&&fc.Fke();bf.g(fc.$).pc.Pn(fc.Kg);fc.Kab=!1;fc.Lab=!1};fc.XAf=function(){oc.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");fc.glc(1,!0);fc.Kab&&!fc.Lab&&bf.g(fc.$).pc.Pn(fc.Kg);
fc.Kab=!1};fc.yca=function(bd,Dd){fc.pld=fc.N7;fc.N7=Dd.Szc};fc.$Df=function(){fc.$&&(fc.Mrc||($g.a(fc.$).WQ(Qf.a.cPa).SEg(fc.hBf),fc.$.Qk(fc.rd),fc.Mrc=!0),fc.Mfa=fc.Tfi(),fc.glc(2,!1))};fc.hBf=function(){var bd=$g.a(fc.$).yi,Dd=bd.bLg();bd=ti.f(bd.Ds.qd.errors,function(Td){return Td.MessageIdName});oc.ULS.sendTraceTag(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:{0}, IsB2W:{1}, Errors: {2}",Dd,fc.Mfa,kh.a.Kc(bd));Dd&&(fc.pSa?(fc.Mfa=
!1,fc.KGe(),fc.RAc()):fc.Tna&&(fc.LGe(),fc.RAc()))};fc.rd=function(){fc.$?(oc.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),fc.Mfa=!1,Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&fc.M0&&fc.M0.fp&&(ih.a.Fa(fc.M0),fc.M0=null),Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&fc.X0&&fc.X0.fp&&(ih.a.Fa(fc.X0),fc.X0=null),fc.glc(2,!0),
fc.RAc()):oc.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};fc.ywf=function(){fc.drf(!0)};fc.zwf=function(){fc.drf(!1)};fc.KVb=ca.fti;fc.s2c=ca.connected;fc.$=Y;fc.sf=Y.na.sf;fc.x2f=Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");fc.xKb=Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5798300_SilentReopenDuringWorkUIEnabled");fc.Vwc=Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");
xb&&(fc.ksf=new la(Y,Ra));Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&fc.$.da.Za(291,function(bd){fc.documentVisibilityObserver=bd});fc.Vwc&&(Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||fc.$.da.Za(291,function(bd){fc.documentVisibilityObserver=bd}),fc.jsf=fc.$.ya.ExcelNetworkCheckAfterTabActivationDelayMs,fc.sf.YFg(fc.PDb),fc.sf.unb(fc.XAf),fc.sf.zne(fc.ywf),fc.sf.xEg(fc.zwf));if(fc.x2f||fc.xKb)fc.uDj=
new U(fc.$,fc);fc.Snf=fc.$.ya.LongInactivityTimePeriodSeconds;fc.$.ea.GVc(fc.$Df);fc.$.ea.wf.Qra(fc.yca);fc.xKb&&(fc.t5f=fc.$.ya.SilentReopenDuringWorkDelayMs);return fc}function U(Y){var Ra=this;this.B7=null;this.aEf=function(xb,fc){Ra.YDf(fc,3)};this.sAf=function(xb,fc){Ra.YDf(fc,2)};this.$=Y;this.sg=Nb.a(this.$).sg;this.sg.foe(this.sAf);this.sg.mHg(this.aEf)}function Q(Y,Ra,xb,fc){Y=X.call(this,Y,Ra,xb)||this;Y.wasInteruptedByOfflineMode=!1;Y.type=fc;Y.wasInteruptedByOfflineMode=!1;return Y}function la(Y,
Ra){this.Lla=this.Gxd=this.iuf=null;this.$=Y;!Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Oc.a.Df||(this.iuf=new ba(Y,Ra));Kc.EwaSettings.la(213)&&(this.Gxd=new S(this.$),this.Gxd.G$h());!Kc.EwaSettings.la(586)||Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&Oc.a.Df||(this.Lla=new Rc.NetworkConnectionHealthChecker(this.$));this.H1g=new K(this.$)}
function ba(Y,Ra){var xb=this;this.rOa=this.FU=null;this.$Ed=-1;this.Ktb=null;this.Ikf=Xf.Task.delay(0);this.K9a=function(fc,bd){bd.PP?xb.vQi(bd.goa):xb.wQi()};this.zca=function(fc,bd){5===bd.$Gf&&xb.N2a()};this.YVf=function(fc,bd){xb.FU.lrj(bd.aV)};this.N2a=function(){xb.rOa.ZRj();xb.nlj(ba.eDd,Sys.Serialization.JavaScriptSerializer.serialize(xb.rOa))};this.kgj=function(fc){if(fc=fc.result)xb.Ggg=!0,oc.ULS.sendTraceTag(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: {0}",
fc)};this.raj=function(){xb.Ggg&&(xb.$?Fb.TaskExtensions.Ba(xb.indexedDB.t6c(ba.eDd),function(){oc.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},xb.$.ma):oc.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.yOa=function(){if(xb.rOa&&0<xb.rOa.count){var fc=Sys.Serialization.JavaScriptSerializer.serialize(xb.rOa);
oc.ULS.sendTraceTag(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: {0}",fc)}};this.$=Y;this.indexedDB=Ra;this.Ggg=!1;this.indexedDB.rg()&&(this.indexedDB.initialize(ba.wld,ba.xld),this.Ffj(),this.rOa=new H(this.$.ya.UserSessionId),Nb.a(this.$).sg.mVc(this.K9a));this.pk=Fh.a.instance.rE();this.pk.ja("beforeunload",this.yOa)}function T(Y,Ra,xb){Y=X.call(this,Y,Ra,xb)||this;Y.timeFromLastOffline=0;Y._errorDataDuringOfflineMode=null;Y.timeFromLastOffline=
-1;Y.type=5;return Y}function H(Y){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=Y}function S(Y){var Ra=this;this.aVf=null;this.Asd=this.Fwd=this.LCb=this.MCb=0;this.UQd=!1;this.i2c=this.uSa=this.eyc=this.Q8a=null;this.x2c=0;this.Ynj=function(){if(12E4>Ra.$.ea.wf.feb)for(var xb=yl(Ra.eyc),fc=xb.next();!fc.done;fc=xb.next())fc.value.oMd();else Ra.MTd("UserInactive")};this.ugj=function(xb){xb=
Sys.Serialization.JavaScriptSerializer.serialize(xb);oc.ULS.sendTraceTag(388821830,0,50,xb)};this.Kfj=function(xb){if(xb){var fc=Ra.i2c[xb.testIteration.toString()];fc?fc.push(xb):(fc=[xb],Ra.i2c[xb.testIteration.toString()]=fc);if(fc.length===Ra.aVf.length){fc=Sys.Serialization.JavaScriptSerializer.serialize(fc);if(Ra.$&&Ra.$.sf){if(xb.EstimatedLatency=Ra.$.sf.Gte,Ra.$.sf.Gte>Ra.$.Au.ExcelRountripThresholdMs){oc.ULS.sendTraceTag(570712144,0,50,"Periodic ping tests results when network is slow: {0}, consequtive slow ping iteration #: {1}",
fc,Ra.x2c++);return}}else oc.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");oc.ULS.sendTraceTag(570712142,0,50,"Periodic ping tests results: {0}",fc);Ra.x2c=1}}};this.Nh=function(xb,fc){xb=fc.context.methodName;if(xb===Ud.a.Gvb||xb===Ud.a.wKa)Ra.LCb++,xb=Date.now(),Ra.xyj(xb)&&(Ra.LCb=0,Ra.Asd=xb,Ra.xGj())};this.yca=function(){Ra.tTd("OnThrottledUserActivity")};this.mW=function(){Ra.MTd("OnDocumentHidden")};this.vya=function(){Ra.tTd("OnDocumentUnhidden")};
this.$=Y;if(this.VQd=Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5186511_SendSlowNetworkPingTests")&&this.iXg())this.aVf=[pe.a.KDc],this.x2c=1,this.i2c={},this.$.ea.wf.Qra(this.yca),this.$.da.Za(291,function(xb){xb.DFa(Ra.mW);xb.nnb(Ra.vya)})}function K(Y){var Ra=this;this.Ric=this.data=null;this.had=0;this.$Be=null;this.Awf=function(xb,fc){fc.PP?(Ra.data=new fa(aa.a.Ra.Kb,Ra.$,5===fc.goa,0!==fc.goa,Ra.$.sf.disconnectionSource,Ra.$Be),Ra.Ric=Ra.$.sf.Okf,Ra.had=1,Ra.$.na.sf.NHg(Ra.Mn),gd.a(Ra.$).YUc(Ra.XVf)):
(Ra.data.oJi(Ra.$,5===fc.goa),Ra.$.na.sf.FRf(Ra.Mn),Ra.data.lastFailedRequestToOnlineTimeGapSec=ia.getElapsedSeconds(Ra.Ric,aa.a.Ra.Kb),Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?af.b().hJb(557682689,0,50,da.connectivityIssues,Ra.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",kh.a.Kc(Ra.data)):oc.ULS.sendTraceTag(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",
kh.a.Kc(Ra.data)),Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&Ra.data&&Ra.data.isToastShown&&Cc.Health.instance.recordQosError(Ea.a.WYg,[kb.a.qjc],!0,!1,!1,!1,null),gd.a(Ra.$).kJd(Ra.XVf),Ra.data=null)};this.XVf=function(xb,fc){Ra.data.krj(fc.aV)};this.Mn=function(xb,fc){Ra.data.P7i(fc.context.methodName);xb=aa.a.Ra.Kb;fc=ia.getElapsedSeconds(Ra.Ric,xb);Ra.Ric=xb;fc>Ra.data.longestDurationBetweenFailedRequestsSec&&(Ra.data.longestDurationBetweenFailedRequestsSec=
fc);Ra.had++;Ra.data.averageDurationBetweenFailedRequestsSec=Ra.DTg(fc)};this.xwf=function(xb,fc){Ra.$Be=fc.NNj};this.$=Y;Nb.a(this.$).sg.Ane(this.Awf);this.$.sf.zne(this.xwf)}function da(){}function fa(Y,Ra,xb,fc,bd,Dd){Y=X.call(this,Y,Ra,fc)||this;Y.swappedByOffline=!1;Y.swappedOffline=!1;Y.averageDurationBetweenFailedRequestsSec=0;Y.longestDurationBetweenFailedRequestsSec=0;Y.lastFailedRequestToOnlineTimeGapSec=0;Y.disconnectionSource=null;Y.errorDataDuringConnectivityIssuesMode=null;Y.failedRequests=
[];Y.triggeringRequest=null;Y.type=4;Y.swappedOffline=xb;Y.disconnectionSource=Enum.toString(tc.a,bd);Y.triggeringRequest=Dd;return Y}function X(Y,Ra,xb){var fc=this,bd;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=
this.isTaskPaneShown=this.isDialogShown=!1;this.nvf=function(Dd,Td){fc.blockedOperationsCount++;Dd=String.format("{0}_{1}_{2})",Td.componentName,Td.actionName,Td.details);fc.blockedActions[Dd]=fc.blockedActions[Dd]?fc.blockedActions[Dd]+1:1;fc.isToastShown&&fc.blockedUserOperationsWhileToastShown++};this.dCd=function(Dd){fc.durationUntilUserInactive=ia.getElapsedSeconds(fc.startTime,aa.a.Ra.Kb);Dd.TJd(fc.dCd)};this.mW=function(){fc.hasTabbedOut=!0};this.zca=function(Dd,Td){Td.$Gf!==fc.type||fc.isToastShown||
(fc.durationUntilToastShownMs=Qa.a(aa.a.Ra,fc.startTime),fc.toastRaiser=Td.toastRaiser,fc.isToastShown=!0)};this.startTime=Y;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=xb;if(null===(bd=Ra.ea)||void 0===bd?0:bd.wf)this.wasUserActiveOnPIStart=Ra.ea.wf.pr;this.cl(Ra);Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5340853_ImprovePIData")?(this.isDialogShown=0<Ra.Ab.$N,Y=Ra.da.Aa(183),this.isTaskPaneShown=!!Y&&Y.isVisible&&!Y.isCollapsed,this.isTaskPaneCollapsed=!!Y&&Y.isVisible&&
Y.isCollapsed):this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1}function ca(){}function ja(Y){var Ra=ad.call(this)||this;Ra.Oc=Y;Ra.dc();return Ra}function ea(Y,Ra,xb){xb=void 0===xb?null:xb;var fc=Jc.call(this)||this;fc.D_a=null;fc.p5a=null;fc.uec=null;fc.ICa=null;oc.ULS.sendTraceTag(537155417,0,50,"MergeSuspensionManager.ctor started");fc.$=Y;fc.Ekb=new hc(Y);fc.bai(Y,xb);fc.Xfa=new ma(fc.ICa,fc.Ekb);fc.GKd=new qa(Y,fc.Xfa,Ra);Kc.EwaSettings.la(256)&&(fc.uec=new Cb(Y,fc));oc.ULS.sendTraceTag(588276810,
0,50,"MergeSuspensionManager created");return fc}function qa(Y,Ra,xb,fc){fc=void 0===fc?null:fc;var bd=Pb.call(this)||this;bd.wJe=null;bd.Kda=null;bd.fAb=0;bd.z7a=null;bd.gAb=null;bd.kCf=function(Dd,Td){bd.wJe.aZi(Td.Fla)};bd.rEb=function(Dd,Td){Td.Zwa?bd.eGj():bd.Gyc()};bd.xAf=function(){bd.fAb=0};bd.$Xf=function(){var Dd=bd.Y5.Nfd();Na(bd.ta,null!=Dd.SuspensionStartTimestamp?Dd.SuspensionStartTimestamp:0,null,function(){bd.IOi(Dd)},null,null,bd.ta.Zb())};bd.g8=function(Dd,Td){if(Td){Td.XFa.MergeCount=
bd.Y5.Nfd();var we=bf.g(bd.$).jBi();Dd=we.min;we=we.max;Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Td.XFa.ClientRevisions=Object.assign(new jb,{Min:Dd,Max:we,MaxFromBlockCache:bf.g(bd.$).Ca.dqf}):Td.XFa.ClientRevisions=Object.assign(new jb,{Min:Dd,Max:we})}};bd.$=Y;bd.fsa=xb;bd.unj=Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjust",!1);bd.unj&&(bd.Kda=new pa(bd.$));bd.Y5=Ra;bd.Y5.KGg(bd.kCf);bd.Y5.hZb(bd.rEb);bd.Y5.SFg(bd.xAf);bd.$.na.P9(bd.g8);
bd.ta=bd.$.na.ta;bd.LKd=bd.$.ya.MergeSuspensionRequestThrottlingTimeInMs;bd.Lqi=bd.$.ya.KeepBlockingPendingMergesRequestIntervalMs;bd.wJe=fc||new Xa(bd.ta,bd.$,null,null,bd.Kda);oc.ULS.sendTraceTag(588276807,0,50,"RequestController initialized");return bd}function pa(Y){var Ra=this;this.Byc=0;this.dE=this.LC=null;this.wY=new Ha;this.XH=0;this.Jg=function(){Ra.hte(!0)};this.m9a=function(){Ra.hte(!1)};this.$=Y;this.gridView=bf.g(this.$);this.gridView.Ca.Fp(this.Jg);this.gridView.Ca.sq(this.m9a);this.gridView.Ca.rne(this.m9a);
this.gridView.Ca.Yga(this.m9a);this.vgj=Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportSelections",!1);this.JXf=Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:6065693_SelectionAdjustManagerRefactor");Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:6005376_SelectionAdjustTelemetryUpdates")&&this.$.da.Za(276,function(){na.a(Ra.$).H9(Ra.wY)})}function Pa(Y,Ra,xb,fc,bd){this.sG=Ra;this.u9=xb;this.UVb=fc;this.Bkg=bd;this.igb&&(this.p2d=bf.g(Y).Ca.q3a(this.selectedRanges[0],bd))}function Ha(){this.totalRequests=
this.parallel=this.errors=this.nonContinuous=this.divergence=this.adjusted=this.adjustedDidntChange=0}function Xa(Y,Ra,xb,fc,bd){var Dd=this;this.Vic=null;this.iCd=0;this.documentVisibilityObserver=null;this.ta=Y;this.LKd=Ra.ya.MergeSuspensionRequestThrottlingTimeInMs;var Td=Ra.ya.GetRangeContentPrefetchDelayForMergeInMs;this.oy=function(){Ra.KWf(Td)};this.mh=(void 0===xb?null:xb)||aa.a.Ra;this.qZd=0;this.TO=void 0===fc?null:fc;this.Kda=void 0===bd?null:bd;this.oGe=Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DPMHiddenTabRequestThrottling",
!1);this.KDj=Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:6101783_SkipVirtualGetRangeForDPMWhenTabHidden");this.oGe&&(this.s7h=Ra.ya.MergeSuspensionHiddenTabRequestThrottlingTimeInMs,Ra.da.Za(291,function(we){Dd.documentVisibilityObserver=we}))}function Na(Y,Ra,xb,fc,bd,Dd,Td){Td=Y.Na(1,void 0===Td?null:Td);Td.suspensionStartTimestamp=Ra;return he.i(Y,"KeepBlockingPendingMerges",Td,xb,fc,bd,Dd,0)}function db(Y,Ra,xb,fc,bd,Dd,Td){Td=Y.Na(1,void 0===Td?null:Td);Td.viewportState=Ra;return he.i(Y,"DoPendingMergeWithSelectionAdjust",
Td,xb,fc,bd,Dd,0)}function Ja(Y,Ra,xb,fc,bd,Dd){Dd=Y.Na(1,void 0===Dd?null:Dd);return he.i(Y,"DoPendingMerge",Dd,Ra,xb,fc,bd,0)}function jb(){}function hc(Y){var Ra=E.call(this)||this;Ra.W1=null;Ra.Wic=0;Ra.f8=function(xb,fc){var bd;if(null===(bd=null===fc||void 0===fc?void 0:fc.ud)||void 0===bd?0:bd.MergeCount)gf.a.equals(fc.ud.SessionId,Ra.$.ea.sessionId,!1)?Ra.OOa(fc.ud.MergeCount,hc.G7c):oc.ULS.sendTraceTag(579737049,0,50,"Stale merge counter ({0}/{1})",fc.ud.MergeCount.Current,fc.ud.MergeCount.Pending)};
Ra.UBb=function(xb,fc){(null===fc||void 0===fc?0:fc.Fla)&&Ra.OOa(fc.Fla,hc.r_d)};Ra.vvc=function(){Ra.MTf();Ra.SLf(Ra.W1)};Ra.s9a=function(xb,fc){fc.mBe&&Ra.W1.SuspensionStartTimestamp&&oc.ULS.sendTraceTag(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter {0}",ob(Ra.W1))};Ra.MTf();Ra.$=Y;Ra.$.na.uq(Ra.f8);Ra.$.ea.Uj(Ra.vvc);Ra.$.ea.RP(Ra.vvc);bf.g(Ra.$).yc.Mo(Ra.s9a);Ra.$.da.Za(292,function(xb){xb.tnb(Ra.UBb);oc.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")});
return Ra}function ma(Y,Ra){var xb=k.call(this)||this;xb.IDb=function(fc,bd){fc=xb.getState();var Dd=xb.Gla;xb.Gla=bd.Fla;bd=xb.getState();xb.ewi(fc,bd,Dd);xb.raiseEvent(ma.twd);xb.AUe(fc,bd)};xb.ROa=function(fc,bd){fc=xb.getState();xb.GK=bd.GK;bd=xb.getState();xb.AUe(fc,bd)};xb.Tha=Y;xb.Tha.eZb(xb.ROa);xb.y$a=Ra;xb.y$a.tnb(xb.IDb);xb.Gla=Object.assign(new W.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});xb.GK=xb.H$h();return xb}function Ka(Y){var Ra=va.call(this)||this;Ra.Zwa=Y;return Ra}
function Ta(Y){return(null===Y||void 0===Y?void 0:Y.SuspensionStartTimestamp)&&Y.Pending>Y.Current}function ob(Y){return Y?String.format("{0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp):null}function Cb(Y,Ra){var xb=qc.call(this)||this;xb.statusBarManager=null;xb.Txd=!1;xb.IDb=function(fc,bd){fc=String.format("{0}{1}",bd.Fla.Current===bd.Fla.Pending?"\u26ad":"\u26ae",bd.Fla.Current);gf.a.equals(xb.Jlc,fc,!1)||(xb.Jlc=fc,xb.vz())};xb.ROa=function(fc,bd){fc=0==bd.GK;xb.Txd!==fc&&(xb.Txd=
fc,xb.vz())};xb.mergeSuspensionManager=Ra;xb.mergeSuspensionManager.y$a.tnb(xb.IDb);xb.Jlc="";lh.a.x2(1905775613,h.a.Ic,0,1);xb.Ka=Y.Ka;xb.GMb=new eb;Y.da.Za(29,function(fc){xb.mergeSuspensionManager&&(xb.statusBarManager=fc,fc.xJ(xb),xb.mergeSuspensionManager.Tha.eZb(xb.ROa))});xb.Ka.y2(xb.GMb);return xb}function eb(){return Bb.call(this)||this}function ya(Y,Ra){Ra=void 0===Ra?null:Ra;var xb=yg.call(this,1)||this;xb.Pfa=!1;xb.SN=function(){xb.refresh()};xb.Kwf=function(){xb.refresh()};xb.$=Y;xb.i8d=
Ra||$g.a(Y).WQ(Qf.a.idle);$g.a(Y).XUc(xb.Kwf);xb.o5a.tq(xb.SN);xb.refresh();return xb}function za(){var Y=pf.call(this)||this;Y.Gkf=null;Y.$Qa=new rf.a;return Y}function Ga(Y,Ra){this.handler=null;this.publisher=Y;this.GK=Ra}function cb(Y){var Ra=li.call(this,1)||this;Ra.Pfa=!1;Ra.Fvf=function(){Ra.refresh()};Ra.Gvf=function(){Ra.refresh()};Ra.gridView=bf.g(Y);Ra.gridView.yc.Yl(Ra.Gvf);Ra.gridView.yc.Mo(Ra.Fvf);Ra.refresh();return Ra}function Mb(Y){return Pg.call(this,Y)||this}function Dc(Y,Ra){this.$=
Y;this.uploaderCreator=Ra}function vb(Y,Ra,xb,fc,bd,Dd){var Td=Ya.call(this,null,xb,fc)||this;Td.$nf=0;Td.PQi=function(we){qg.a(we)?oc.ULS.sendTraceTag(537155799,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: {0}",zd.a.Tc(we.Errors)):(oc.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),we.Result?gi.a(Td.$).ona(1,we.Result):oc.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};
Td.OQi=function(){oc.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};Td.$=Y;Td.ae=Ra;Td.T0=Dd;Td.Dqe=ee.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Td.showDialog();return Td}function ib(Y,Ra,xb,fc,bd,Dd){var Td=Ag.call(this)||this;Td.xgc=!1;Td.swa=null;Td.eS=null;Td.uNa=null;Td.cIi=function(){Td.wua(Td.Wob)};Td.ksd=function(we){we.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==we.target.id||we.shiftKey?"KeepFocusStartDiv"===
we.target.id&&we.shiftKey&&(we.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(we.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};Td.ZOi=function(){Td.Qnb&&(Td.Qnb.launchUpsellExperience("stockimages"),oc.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};Td.io=Dd;Td.$=Y;Td.ubf=Ra;Td.Qnb=xb;Td.kAa=[];Td.vqf=fc;Td.Teh=bd;Td.Ype=Td.$.ya.InsertOnlinePictureMaxCountOfImagesToInsert;Td.eg=Td.q7g();return Td}function ub(){}function Eb(Y,
Ra){return Cf.call(this,Y,ug.a.Saa(Ra))||this}function Ya(Y,Ra,xb){Y=tb.call(this,Y,Ra,xb)||this;Y.Ara=null;Y.CUb=null;return Y}function tb(Y,Ra,xb){this.Hj=this.aCd=null;this.JEa=this.fra=0;this.URb=null;this.cT=Y;this.me=Ra;this.wb=xb;this.s1a=!1;this.$Yd=!0;this.Ahj();this.L8a=this.ga.ra("NativeFileOpenDialogIsEnabled")}function ec(Y){var Ra=ch.call(this)||this;Ra.nld=null;Ra.$=Y;Ra.dc();return Ra}function Za(Y){var Ra=zg.call(this)||this;Ra.$=Y;Ra.dc();return Ra}function mb(Y,Ra){this.PUe=Y;this.GDh=
Ra}function sc(Y){this.$=Y}function pd(Y){var Ra=Sg.call(this)||this;Ra.$=Y;Ra.dc();return Ra}function $b(Y,Ra,xb){var fc=ai.call(this)||this;fc.statusBarManager=null;fc.DIe=function(){fc.g6b()};fc.zfh=function(){fc.g6b()};fc.CIe=function(bd){10===bd&&fc.g6b()};fc.onKeyDown=function(bd){if(13===bd.Ea.keyCode){bd=new Rg.a(237279923,1,2,6,null);var Dd={};fc.$.Ka.Xb(bd,(Dd[Je.a.skipClipboardAccess]=!0,Dd[Je.a.BMe]=!0,Dd));return!0}return!1};fc.$=Y;fc.qr=Ra;fc.pk=xb;fc.R8c=!1;fc.l3f=Kc.EwaSettings.getBooleanFeatureGate(He.a.JPa,
!1);fc.gif=Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:6082903_PasteToEnterKeyDownEventForGrid");fc.l3f&&fc.$.da.Za(29,function(bd){fc.statusBarManager=bd;bd.xJ(fc)});return fc}function Xb(Y){var Ra=Lg.call(this)||this;Ra.$=Y;Ra.Lm=ce.a.instance;Ra.dc();return Ra}function lc(Y){var Ra=this;this.X4b="";this.s2=this.Ps=null;this.iqc=!1;this.i9e=function(xb,fc){Ra.hide(void 0===xb?null:xb,void 0===fc?null:fc)};this.gridView=bf.g(Y);this.gridView.ha.OG(this.i9e)}function Oa(){}function pb(Y,Ra){var xb=
Jh.call(this,Y)||this;xb.Wo=null;xb.Zci=function(fc,bd){1===fc?(fc=pb.qfh[bd[pb.pfh]],oc.ULS.sendTraceTag(537167683,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = {0}",0===fc?"Horizontal":"Vertical"),xb.Wo.setResult(fc)):(oc.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),xb.Wo.gu())};xb.Ch(Ra);return xb}function Ub(Y){this.$Ec=this.iPc=null;this.$=Y}function ic(){}
function Jb(){}function cc(){}function Ob(){}function P(Y){this.c3c=this.eta=null;this.v$a=15;this.$=Y}function Ba(Y,Ra){this.$=Y;this.job=Ra}function ra(Y,Ra,xb,fc){Y=Yb.call(this,Y)||this;Y.isFromCurrentSession=!1;Y.top=0;Y.left=0;Y.isFromCurrentSession=Ra;Y.top=xb;Y.left=fc;return Y}function ta(Y,Ra,xb,fc,bd){bd=void 0===bd?null:bd;var Dd=Sa.call(this,Y,"ArtCopyPasteHandler")||this;Dd.pZg="XLO";Dd.qZg="3";Dd.NU=new zb(Y);Dd.v$=Ra;Dd.vZa=xb;Dd.ha=bf.g(Y).ha;Dd.e3c=bd||new gb(Dd.v$);Dd.FYi=new Ia(xb,
Y);Dd.job=fc;return Dd}function Ia(Y,Ra){this.KHb=new Qc.a;this.vZa=Y;this.$=Ra;this.j3i=function(xb){return Promise.resolve(xb)};this.VDb=function(xb){return Promise.reject(xb)}}function bb(Y,Ra,xb,fc,bd,Dd,Td,we,Oe){this.promise=null;this.ribbonCommandInfo=Y;this.destination=Ra;this.OHe=xb;this.jZd=bd;this.H0=Dd;this.item=Td;this.pasteContext=we;this.NNa=xb||Ra.FirstRow+"_"+Ra.FirstColumn;this.uff=!0;this.Ize=Oe}function Va(Y,Ra,xb,fc,bd,Dd,Td){this.floatingObjectId=Y;this.commandParameters=Ra;
this.Cr=xb;this.$ah=fc;this.l4=void 0===Dd?null:Dd;this.jZd=void 0===Td?null:Td;this.E3g=bd}function lb(Y,Ra,xb,fc){Ra=Sb.call(this,Y,Ra,xb,"AcrossSessionRangeCopyPasteHandler",void 0===fc?null:fc)||this;Ra.NU=new zb(Y);return Ra}function kc(Y,Ra){Ra=void 0===Ra?null:Ra;var xb=Dg.call(this,fi[Y])||this;xb.copyErrorName=0;xb.ewaErrors=null;xb.copyErrorName=Y;xb.ewaErrors=Ra;if(null===Ra||void 0===Ra?0:Ra.length)xb.innerError=new ye.a(Ra,null);return xb}function zb(Y){this.NU=new gh.a(!0);this.$=Y}
function Sb(Y,Ra,xb,fc,bd){bd=void 0===bd?null:bd;fc=Sa.call(this,Y,fc)||this;fc.O3g=Ra;fc.v$=xb;fc.f3c=bd||new gb(fc.v$);fc.gridView=bf.g(Y);fc.ha=fc.gridView.ha;fc.clipboardRangeFactory=Y.da.Aa(169);return fc}function gb(Y){this.clipboardItems=this.key=null;this.v$=Y}function Sa(Y,Ra){this._name=Ra;this.$=Y;this.Lm=ce.a.instance;this.Vr=new sa(Y,bf.g(Y))}function Kb(Y){return Y.shadowWorkbookSizeExceedsLimit?!0:Gc(Y)>Ud.a.Ikc}function Gc(Y){return Y?Y.shadowWorkbookSizeExceedsLimit&&void 0!==Y.shadowWorkbookBlockedSize&&
null!==Y.shadowWorkbookBlockedSize?Y.shadowWorkbookBlockedSize:Y.shadowWorkbookBase64?Y.shadowWorkbookBase64.length:0:0}function Hb(){}function Lb(Y){var Ra={};this.C7f=(Ra["SourceItemType.Range"]=0,Ra["SourceItemType.Art"]=1,Ra);this.xLb={};Ra={};this.y7f=(Ra["FloatingObjectType.Unknown"]=99,Ra["FloatingObjectType.CardView"]=6,Ra["FloatingObjectType.Chart"]=0,Ra["FloatingObjectType.Group"]=7,Ra["FloatingObjectType.Image"]=1,Ra["FloatingObjectType.Ink"]=8,Ra["FloatingObjectType.InteractiveReport"]=
4,Ra["FloatingObjectType.ModernOfficeExtension"]=3,Ra["FloatingObjectType.Shape"]=5,Ra["FloatingObjectType.Slicer"]=2,Ra["FloatingObjectType.Unsupported"]=100,Ra);Ra={};this.jXc=(Ra["99"]="FloatingObjectType.Unknown",Ra["6"]="FloatingObjectType.CardView",Ra["0"]="FloatingObjectType.Chart",Ra["7"]="FloatingObjectType.Group",Ra["1"]="FloatingObjectType.Image",Ra["8"]="FloatingObjectType.Ink",Ra["4"]="FloatingObjectType.InteractiveReport",Ra["3"]="FloatingObjectType.ModernOfficeExtension",Ra["5"]="FloatingObjectType.Shape",
Ra["2"]="FloatingObjectType.Slicer",Ra["100"]="FloatingObjectType.Unsupported",Ra);Ra={};this.B7f=(Ra["RibbonCommand.Copy"]=-911352779,Ra["RibbonCommand.Cut"]=-1985798686,Ra);Ra={};this.OLd=(Ra["-911352779"]="RibbonCommand.Copy",Ra["-1985798686"]="RibbonCommand.Cut",Ra);Ra={};this.A7f=(Ra["InputManager.InputMethod.NotDefined"]=-1,Ra["InputManager.InputMethod.Unknown"]=0,Ra["InputManager.InputMethod.Keyboard"]=1,Ra["InputManager.InputMethod.Mouse"]=2,Ra["InputManager.InputMethod.Touch"]=3,Ra["InputManager.InputMethod.CrossSlide"]=
9,Ra);this.vka={};Ra={};this.z7f=(Ra["FrameMode.None"]=0,Ra["FrameMode.Reading"]=1,Ra["FrameMode.Edit"]=2,Ra);this.Z2a={};Ra={};this.D7f=(Ra["UILocation.Unknown"]=0,Ra["UILocation.UpperRibbon"]=1,Ra["UILocation.Ribbon"]=2,Ra["UILocation.QAT"]=3,Ra["UILocation.Jewel"]=4,Ra["UILocation.NavigationPane"]=5,Ra["UILocation.KeyboardShortcut"]=6,Ra["UILocation.StatusBar"]=7,Ra["UILocation.Dialog"]=8,Ra["UILocation.Floatie"]=9,Ra["UILocation.NotificationBar"]=10,Ra["UILocation.StandaloneCuiRoot"]=11,Ra["UILocation.TaskPane"]=
12,Ra["UILocation.HeroDock"]=13,Ra["UILocation.SingleLineRibbon"]=14,Ra["UILocation.MultilineRibbon"]=15,Ra["UILocation.Overflow"]=16,Ra["UILocation.TellMe"]=17,Ra["UILocation.FarPeripheralControls"]=18,Ra["UILocation.ContextMenu"]=19,Ra["UILocation.DialogMenu"]=20,Ra["UILocation.Header"]=21,Ra["UILocation.FileMenu"]=22,Ra["UILocation.Toolbar"]=26,Ra["UILocation.Canvas"]=30,Ra);this.Hr={};this.$=Y;this.vka.notDefined="InputManager.InputMethod.NotDefined";this.vka.unknown="InputManager.InputMethod.Unknown";
this.vka.keyboard="InputManager.InputMethod.Keyboard";this.vka.mouse="InputManager.InputMethod.Mouse";this.vka.touch="InputManager.InputMethod.Touch";this.vka.crossSlide="InputManager.InputMethod.CrossSlide";this.Z2a.none="FrameMode.None";this.Z2a.reading="FrameMode.Reading";this.Z2a.edit="FrameMode.Edit";this.Hr.unknown="UILocation.Unknown";this.Hr.upperRibbon="UILocation.UpperRibbon";this.Hr.ribbon="UILocation.Ribbon";this.Hr.QAT="UILocation.QAT";this.Hr.jewel="UILocation.Jewel";this.Hr.navigationPane=
"UILocation.NavigationPane";this.Hr.keyboardShortcut="UILocation.KeyboardShortcut";this.Hr.statusBar="UILocation.StatusBar";this.Hr.dialog="UILocation.Dialog";this.Hr.floatie="UILocation.Floatie";this.Hr.notificationBar="UILocation.NotificationBar";this.Hr.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.Hr.taskPane="UILocation.TaskPane";this.Hr.heroDock="UILocation.HeroDock";this.Hr.singleLineRibbon="UILocation.SingleLineRibbon";this.Hr.multilineRibbon="UILocation.MultilineRibbon";this.Hr.overflow=
"UILocation.Overflow";this.Hr.tellMe="UILocation.TellMe";this.Hr.farPeripheralControls="UILocation.FarPeripheralControls";this.Hr.header="UILocation.Header";this.Hr.fileMenu="UILocation.FileMenu";this.Hr.contextMenu="UILocation.ContextMenu";this.Hr.dialogMenu="UILocation.DialogMenu";this.Hr.toolbar="UILocation.Toolbar";this.Hr.canvas="UILocation.Canvas";this.xLb.range="SourceItemType.Range";this.xLb.art="SourceItemType.Art"}function sa(Y,Ra){this.Nic=this.eNa=null;this.Ifc=Kc.EwaSettings.getBooleanFeatureGate(He.a.D4b,
!1);this.Mmd=Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:6024798_AbortOutstandingCopyOperation");this.vMa=Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);this.$=Y;this.gridView=Ra;this.Ygc=Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeHideCutCopyHighlight",!1);this.Mmd&&(this.$.userOperationManager.lx(Object(Ve.a)(this,this.HF,"onQueueChanged")),this.ev=new rf.a)}function Ua(Y){this.parameters=null;this.parameters=Y}function Yb(Y){this.pasteParameters=
null;this.pasteParameters=Y}function jc(Y,Ra){this.content=this.destinationRange=null;this.destinationRange=Y;this.content=Ra}function md(Y,Ra,xb){this.destinationRange=this.sourceRange=null;this.pasteFlags=0;this.sourceRange=Y;this.destinationRange=Ra;this.pasteFlags=xb}function jd(Y,Ra,xb,fc,bd,Dd,Td,we){we=void 0===we?null:we;Td=Y.Na(1,void 0===Td?null:Td);Td.pasteParameters=Ra;return he.i(Y,"Paste",Td,xb,fc,bd,Dd,64,we)}function Zc(Y,Ra,xb,fc,bd,Dd,Td,we){we=void 0===we?null:we;Td=Y.Na(1,void 0===
Td?null:Td);Td.copyParameters=Ra;return he.i(Y,"Copy",Td,xb,fc,bd,Dd,0,we)}function Qb(Y,Ra,xb,fc,bd,Dd,Td,we,Oe){Oe=void 0===Oe?null:Oe;we=Y.Na(9,we);we.destinationRange=Ra;we.source=xb;return he.i(Y,"PasteString",we,fc,bd,Dd,Td,64,Oe)}function fd(Y,Ra,xb,fc,bd,Dd,Td,we){we=void 0===we?null:we;Td=Y.Na(1,Td);Td.pasteHtmlParameters=Ra;return he.i(Y,"PasteHtmlContent",Td,xb,fc,bd,Dd,64,we)}function xd(){this.T_a=this.Mze=null}function Ad(Y,Ra,xb,fc,bd,Dd,Td,we,Oe){Oe=void 0===Oe?null:Oe;var Te=Ab.call(this)||
this;Te.pasteShortcutManager=null;Te.gdf=Kc.EwaSettings.KH();Te.vMa=Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);Te.K9f=null;Te.Z6a=!1;Te.Rff=Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:6004791_MergedCellOverlapTelemetry");Te.ZAd=function(Zf){Te.yxj(Zf)&&(Te.Vr.Xwb(),oc.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};
Te.Lwi=function(Zf,dg){oc.ULS.sendTraceTag(537167768,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",Zf,dg);Te.gridView.focus()};Te.rd=function(Zf,dg){dg.wK||dg.Ng||Te.Ur("OnWorkbookOpened",!1).catch(function(){})};Te.ii=function(Zf,dg){Zf=bc(Te.HK);var Jg=Te.Vr.Kvb(Zf);Jg&&(dg.pa&&dg.pa.sheetName===Jg.sheetName&&Jg.isFromCurrentSession(Te.$)?Te.Vr.H9e(Jg.ranges,Zf.commandParameters.commandType):Te.Vr.Xwb())};Te.qnc=
function(Zf,dg){Zf=bc(Te.HK);(Zf=Te.Vr.Kvb(Zf))&&dg.item&&dg.item.sheetName===Zf.sheetName&&Zf.isFromCurrentSession(Te.$)&&Te.Ur("OnItemDeleting",!1).catch(function(){})};Te.lEb=function(Zf,dg){Te.gdf?Te.K9f(Zf,dg):Te.oEf()};Te.ZR=function(Zf,dg){1===dg.Bw&&dg.Pg.operation.flags&2&&Te.Ur("OnQueueItemChanged/ItemRemoved",!1).catch(function(){})};Te.$=Y;Te.Gh=xb;Te.gridView=bf.g(Y);Te.Vr=bd;Te.Yci=Dd;Te.HK=Ra;Te.B3b=fc;Te.getStringifiedError=Oe||copyPasteInfra.getStringifiedError;Te.j3f=1===we;Te.cl();
Te.copyPasteShortcutDialogFactory=Te.$.da.Aa(85);oc.ULS.shipAssertTag(537167825,0,!!Te.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");Td||(oc.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),Td=Ad.Rch);Te.userHash=Yf.a.Qv(Td);Te.VAi="CultureTag: "+ce.a.instance.Krb+" HASH: ";Te.HK.addMetadataChangeListener(Ad.Nqf,Te.ZAd);Te.Uvd=Te.$.ya.MaxCopyPasteLength;Te.WNa=Te.vMa?Kc.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",
Te.$.ya.CopyPasteMaxPayloadLength):Ud.a.WNa;Te.so=Kc.EwaSettings.getBooleanFeatureGate(He.a.JPa,!1);Te.so&&Y.da.Za(478,function(Zf){Te.pasteShortcutManager=Zf});Te.gdf&&(Te.K9f=Ce.a(function(){Te.oEf()},1,Te.$.ma,"CopyPasteInfrastructure.OnStartEditInternal",!0));return Te}function Me(Y){if(!Y)return"null";var Ra=[];Y=yl(Y.get());for(var xb=Y.next();!xb.done;xb=Y.next())xb=xb.value,xb=String.format("{0}({1})",xb.clipboardDataFormat,xb.data.length),Array.add(Ra,xb);Ra.sort();return Ra.join(",")}function Ue(Y){switch(Y){case 0:return"None";
case 2:return"Art";case 1:return"Range";default:return"Unknown"}}function Jd(Y,Ra){return Y?Ra&&Ra.ya?Y.sessionId!==Ra.ya.UserSessionId:(oc.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(oc.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1)}function Sd(){}function se(){}function oe(){}function Ke(Y,Ra,xb,fc){this.$=Y;this.originalDestinations=Ra;this.L8b=xb;this.Lkg=fc;this.Iug=this.originalDestinations;this.Cog=this.L8b;this.Yrg="PasteRecoveryUI"}function bc(Y){return Y&&
(Y=Y.getCachedMetadata(),null===Y||void 0===Y?0:Y.lastCopy)?Y.lastCopy:null}function qd(Y){return Y.clipboardItems&&(Y=Y.clipboardItems.getItem(rb.Pgi))&&"1"===Y?!0:!1}function zc(Y){return ld(Y)&&!(void 0===Y.clipboardItems||null===Y.clipboardItems)&&!!Y.clipboardItems.getItem(rb.png)&&!Y.clipboardItems.getItem(rb.zW)}function ld(Y){return Y.clipboardItems&&(Y=Y.clipboardItems.getItem(rb.lki))&&"1"===Y?!0:!1}function rb(){}function Wd(){}function rc(Y){return!!Y&&Object.getType(Y)===nd}function nd(Y,
Ra,xb,fc,bd){fc=be.call(this,fc,bd)||this;oc.ULS.shipAssertTag(537167645,0,!!Ra&&0<Ra.length,"RangeSourceItem.ctor: ranges should not be null or empty");fc.$=Y;fc.ranges=Ra;fc.sheetName=xb;return fc}function me(Y,Ra,xb,fc,bd){xb=be.call(this,xb,fc)||this;xb.activeFloatingObjectControlId=Y;xb.sheetName=Ra;xb.type=bd;return xb}function be(Y,Ra){var xb=this;this.kHh=function(){var fc={};fc.SourceItem=xb.toString();return fc};this.sessionStateId=Y;this.sessionId=Ra;this.toJSON=this.kHh}function sd(Y,
Ra,xb,fc,bd){var Dd=Y.Stopwatch,Td={};Td.a=bd;Td.e=Dd.id;Td.c="RearrangeRowColumn";Td.b="mouse";Td.d=Y.OperationId.toString();Td.f=xb.toString();Td.g=fc.toString();Td.h=Ra.toString();Td.i=Y.DragDropIsShiftKeyDown;Td.j=!0;Td.o=Dd.Dc;Td.q=!1;Td.r=Y.CopyPasteTargetType.toString();Td.s=Y.EncounteredDeploymentErrors;return Td}function Qe(Y){Y=Nf.call(this,Y)||this;Y.oZg=function(){oc.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};oc.ULS.sendTraceTag(537167828,0,
50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");Y.jc=0;Y.Fc(1,ce.a.instance.fa(2191));var Ra=ce.a.instance.fa(2189),xb=Y.tV();Y.initializeAndShow(Ra,Y.oZg,xb);return Y}function Sf(){this.tb=null}function mf(){this.pib=this.ZRb=this.Gv=null}function Zd(Y,Ra,xb,fc,bd){this.Gv=Y;this.Cib=Ra;this.yib=xb;this.dee=void 0===fc?null:fc;this.Mkb=void 0===bd?null:bd}function ie(){this.tb=null}function kd(Y){this.mc=Y}function ge(){this.$ie=0;this.FWa=Array(5);this.FWa[0]=10;this.FWa[1]=
15;this.FWa[2]=50;this.FWa[3]=100;this.FWa[4]=200}function of(Y,Ra,xb,fc,bd){this.o$b=!1;this.Trb=null;this.La=Y;this.VXa=Ra;this.jVb=xb;this.t1=fc;this.SEc=bd}function Ec(){this.iPf=this.ZTf=this.Z8f=this.ijc=this.instance=null}function Cd(Y,Ra,xb){this.La=Y;this.gf=Ra;this.BSb=xb}function Qd(){this.completed=this.W$i=!1}function od(){this.vhe=this.Ibe=this.c2d=!0;this.zfj=this.VZi=null;this.HCi=!1;this.locale=null;this.Ebg={}}function ke(){}function Re(){this.IUb=this.YRb=null}function lf(Y){return Ze.call(this,
Y)||this}function vc(){this.tb=null}function hd(Y,Ra){if(void 0===Y||null===Y||void 0===Ra||null===Ra)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.wb=Y;this.Tg=Ra;this.DQc=this.Ae=null}function Ac(){this.PJe=this.ufg=this.It=0;this.QJe=this.vfg=this.vHa="";this.oRc=this.Kea=2}function Vd(Y,Ra){this.$Fc=0;this.r2b=null;this.Oib=new Nd(Y,Ra);this.wb=Y;Ra=Y.Ua("HostAuthType");this.oEa=Y.ra("OcpsIsEnabled")&&Y.ra("IsO365CommercialHost")&&!(void 0===Ra||null===Ra)&&"aad"===
Ra.toLowerCase();this.Fce=Lf.b(Y.Ua("OcpsDefaultSettings")||"{}");this.Ejb=this.ibc();Ra=this.wb.Ty("ServicesControlsMicrosoftControllerServicesList")?this.wb.fw("ServicesControlsMicrosoftControllerServicesList")||[]:[];this.SQb=new xf.a;for(var xb=0;xb<Ra.length;xb++)this.SQb.add(Ra[xb]);this.oEa&&!Y.ra("IsAnonymousUser")&&Y.ra("SideCarIsEnabled")?this.r2b=this.DOj():this.r2b=this.woa(this.oEa,this.mva("/afhs/CloudPolicySettings.ashx"),Object(Ve.a)(this,this.ZXi,"parseCloudPolicySettingsResponse"));
this.r2b.then(function(){return null}).catch(function(fc){oc.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(fc))})}function Bd(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}function tf(){}function Wb(Y,Ra){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=Y.PolicySettings;Y=new Date;Y.setMinutes(Y.getMinutes()+Ra);this.ExpirationTime=Y.getTime()}function wc(Y,Ra,xb,fc,bd){var Dd=this;xb=void 0===xb?null:xb;fc=void 0===fc?null:fc;bd=void 0===bd?null:bd;
this.zua=this.mVb=this.nfe=this.wqa=this.sWb=null;this.Oib=new Nd(Y,Ra);this.wb=Y;this.csg=Y.Ad("LicensingMaxRetryAttempts",0);this.fLc=Y.ra("IsO365ConsumerHost");this.eLc=Y.ra("IsO365CommercialHost");this.SSb=Y.ra("PremiumUpsellIsEnabled");this.B3d=xb;this.Eje=fc;this.La=bd;this.vqa=Y.ra("LicensingIsEnabled");this.oEa=Y.ra("OcpsIsEnabled")&&this.eLc;this.HSc=Y.ra("ShowPrivacyDialog")&&!!fc;this.T8d=Y.ra("IsAnonymousUser");this.kad=new Promise(function(Td){Td(!1)});this.vBa=new Promise(function(Td){Td(!0)});
this.yua=new ze.a(Ae.a.Hk());this.gXb=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1);this.vae=this.jTh();this.Bpd()&&!this.T8d?(void 0!==Uc.AFrameworkApplication.sa&&null!==Uc.AFrameworkApplication.sa&&(this.sWb=Uc.AFrameworkApplication.sa.xD,void 0!==this.sWb&&null!==this.sWb&&(this.wqa=this.sWb.Wh("WebServiceCall","ApplicationFeatureHelperService"))),this.zua=this.$Wd()):this.zua=new Promise(function(Td){Td({})});this.zua.catch(function(Td){oc.ULS.sendTraceTag(42513088,
3004,10,JSON.stringify(Td))});this.gXb&&(this.SSb=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(function(Td){Dd.SSb=Dd.wb.ra("PremiumUpsellIsEnabled")&&Td;return null}))}function yb(Y,Ra,xb){this.featureName=null;this.isEnabled=!1;this.tierName=0;this.featureName=Y;this.isEnabled=Ra;this.tierName=xb}function mc(Y,Ra){this.aMj=3E5;if(void 0===Y||null===Y||void 0===Ra||null===Ra)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.wb=Y;this.RPb=new ze.a(Ae.a.Hk());this.Oib=
new Nd(Y,Ra);void 0!==ue.a.Nud&&null!==ue.a.Nud&&void 0!==ue.a.bkc&&null!==ue.a.bkc&&0<ue.a.bkc&&(Y=new Wc,Y.Token=ue.a.Nud,Y.ExpirationTime=ue.a.bkc,this.RPb.ia("loki",Y))}function Wc(){this.Token=null;this.ExpirationTime=0}function Nd(Y,Ra){this.wb=Y;this.Tg=Ra}function Tc(){this.message=null;this.Xdc=0}b.r(F);var Yc=b(0),oc=b(13),ze=b(805),Ae=b(574),Ve=b(80),nb=b(84),Hc;(function(Y){Y[Y.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";Y[Y.cloudPolicySettings=1]="cloudPolicySettings";
Y[Y.alternateAuthToken=2]="alternateAuthToken"})(Hc||(Hc={}));Object(Yc.b)("ApplicationFeatureHelperRequestType",Hc);Object(Yc.a)(Tc,"HttpRequstToPromiseRejectData",null,[]);var Cc=b(95),Sc=b(231);Nd.prototype.Z3c=function(Y,Ra,xb,fc,bd,Dd,Td,we){var Oe=this;fc=void 0===fc?null:fc;bd=void 0===bd?null:bd;Dd=void 0===Dd?null:Dd;Td=void 0===Td?null:Td;we=void 0===we?null:we;var Te=Hc[xb],Zf=Te+"RequestFailure";Cc.Health.instance.recordKpiUsage(Zf,0,"jpittsdirects",null);return new Promise(function(dg,
Jg){oc.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",Te);var Ug=null!=Td?Td:Oe.wb.Ad("ApplicationFeatureHelperRequestQueueTimeout",15E3),Xh=null!=we?we:Oe.wb.Ad("ApplicationFeatureHelperRequestSentTimeout",3E4);Oe.Tg.I9(Y,1,null,Oe.NRh(xb,fc),Dd,!1,1,function(Ef){oc.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",Te);try{if(void 0===Ef||null===Ef||void 0===
Ef.data||null===Ef.data||void 0===Ef.data.ie||null===Ef.data.ie){Cc.Health.instance.recordKpiFailure(Zf,"Invalid RequestSucceededEventArgs",!1,!0,null);var Th=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",Te);Jg(Oe.Lvb(Th,Ef))}else if(Ef.data.httpStatus!==Sc.a.kP){Cc.Health.instance.recordKpiFailure(Zf,"HttpStatusCode_"+Ef.data.httpStatus.toString(),!1,!0,null);var sh=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",
Ef.data.httpStatus,Te);Jg(Oe.Lvb(sh,Ef))}else{void 0!==bd&&null!==bd&&void 0!==Ef.data.responseHeaders&&null!==Ef.data.responseHeaders&&bd(Ef.data.responseHeaders);var Mg=Ra(Ef.data.ie);if(Mg)oc.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",Te),dg(Mg);else{Cc.Health.instance.recordKpiFailure(Zf,"Parse Failure",!1,!0,null);var Hi=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",
Te);Jg(Oe.Lvb(Hi,Ef))}}}catch(R){Cc.Health.instance.recordKpiFailure(Zf,"Unexpected Failure",!1,!0,null),Th=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",R,Te),Jg(Oe.Lvb(Th,Ef))}},function(Ef){oc.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",Te);if(Ef.data){Cc.Health.instance.recordKpiFailure(Zf,"HttpStatusCode_"+Ef.data.httpStatus.toString(),!1,!0,null);var Th=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",
Ef.data.httpStatus,Ef.data.ie||"No Data",Te)}else Cc.Health.instance.recordKpiFailure(Zf,"Invalid RequestFailedEventArgs",!1,!0,null),Th=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",Te);Jg(Oe.Lvb(Th,Ef))},null,void 0,void 0,Ug,Xh)})};Nd.prototype.Lvb=function(Y,Ra){var xb=new Tc;xb.message=Y;xb.Xdc=Ra&&Ra.data?Ra.data.httpStatus:-1;return xb};Nd.prototype.NRh=function(Y,Ra){var xb={};xb["x-UserDataSignature"]=this.wb.Ua("UserDataSignature");
xb["x-LicensingIsEnabled"]=this.wb.ra("LicensingIsEnabled").toString();xb["x-CacheIsEnabled"]=this.wb.ra("LicensingRedisIsEnabled").toString();xb["x-OcpsIsEnabled"]=this.wb.ra("OcpsIsEnabled").toString();xb["x-LicensingAADIdIsEnabled"]=this.wb.ra("LicensingAadIdIsEnabled").toString();0===Y&&(xb["x-LicenseCheckOnTenantEnabled"]=this.wb.ra("LicensingForSafeLinksIsEnabled").toString(),xb["x-SupportUserConsentDependentFeatures"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",
!1).toString(),xb["x-AFHUserConsentGroupValue"]=this.wb.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),xb["x-UseShellServiceForUserConsentGroup"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),xb["x-UseSALForLicensing"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),xb["x-SMBUserLicensingEnabled"]=this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",
!1).toString());if(Ra){Y=yl(Ra.keys);for(var fc=Y.next();!fc.done;fc=Y.next())fc=fc.value,xb[fc]=Ra.oa(fc)}return xb};Object(Yc.a)(Nd,"HttpRequestToPromiseUtility",null,[]);var Uc=b(5),ae;(function(Y){Y[Y.loki=0]="loki";Y[Y.augloopACLP=1]="augloopACLP"})(ae||(ae={}));Object(Yc.b)("AlternateAuthSupportApp",ae);var ue=b(857),Lf=b(40);Object(Yc.a)(Wc,"WacAlternateAuthToken",null,[]);mc.prototype.cKh=function(){var Y=null;this.RPb.xb(ae[0])&&(Y=this.RPb.oa(ae[0]));return void 0===Y||null===Y||this.ord(Y)?
this.QAh():Promise.resolve(Y.Token)};mc.prototype.ord=function(Y){return Y.ExpirationTime-Date.now()<this.aMj};mc.prototype.QAh=function(){var Y=this,Ra=new ze.a(Ae.a.Hk());Ra.ia("X-AlternateAuthApp",ae[0]);return this.Oib.Z3c(this.mva("/afhs/AlternateAuthHelperHandler.ashx"),Object(Ve.a)(this,this.VXi,"parseAlternateAuthTokenResponse"),2,Ra).then(function(xb){oc.ULS.sendTraceTag(545821456,3004,50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",ae[0]);
Y.RPb.ia(ae[0],xb);return xb.Token},function(xb){xb=Object(nb.a)(Tc,xb);oc.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",xb.message,xb.Xdc);return null})};mc.prototype.VXi=function(Y){var Ra=Lf.d(Y).Ju;oc.ULS.sendTraceTag(545821457,3004,Ra?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",Y);return Ra};mc.prototype.mva=function(Y){return String.format("{0}{1}?{2}",this.wb.Ua("WebServiceBase"),Y,Uc.AFrameworkApplication.mj)};
Object(Yc.a)(mc,"AlternateAuthHelper",null,[385]);var xf=b(460);Object(Yc.a)(yb,"FeatureStateChangeArgs",null,[]);var Rf=b(129),dc=b(277),Oc=b(23),Ed=b(109),Gd=b(178),Ee;(function(Y){Y[Y.Enabled=0]="Enabled";Y[Y.Disabled=1]="Disabled"})(Ee||(Ee={}));Object(Yc.b)("FeatureState",Ee);var ee=b(86),hf=b(30),kf=b(338);wc.prototype.jTh=function(){for(var Y=this.wb.Ty("AllLicensedFeatures")?this.wb.fw("AllLicensedFeatures"):[],Ra=new xf.a,xb=0;xb<Y.length;xb++)Ra.add(Y[xb]);return Ra};wc.prototype.Bpd=function(){return this.eLc||
this.fLc};wc.prototype.$Wd=function(Y,Ra){var xb=this;Y=void 0===Y?0:Y;Ra=void 0===Ra?!1:Ra;oc.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Ra);var fc=Rf.a.Wr();fc&&(fc.set("retryAttempt",Y.toString()),fc.set("forceRefresh",Ra.toString()),fc.set("isO365ConsumerHost",this.fLc.toString()),fc.set("isO365CommercialHost",this.eLc.toString()),fc.set("isFreemiumUpsellEnabled",this.SSb.toString()));Cc.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest",
"waclicensing",fc);Cc.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",fc);void 0!==this.wqa&&null!==this.wqa&&this.wqa.start();var bd=null;Ra&&(bd=new ze.a(Ae.a.Hk()),bd.ia("x-LicensingForceRefresh","true"));this.nfe=new Date;return(this.vqa?this.Oib.Z3c(this.mva("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(Ve.a)(this,this.YXi,"parseApplicationFeatureHelperResponse"),0,bd,Object(Ve.a)(this,this.l2i,"processApplicationFeatureHelperResponseHeaders"),["Date"]):
Promise.resolve({})).then(function(Dd){var Td=Object.assign(new kf.a,{durationMs:xb.X6f()});Td.extendedProperties=fc;Td.extendedProperties&&Dd&&(Td.extendedProperties.set("featureCount",Ed.a.count(Dd).toString()),Td.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Dd).toString()),Td.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in Dd).toString()),xb.mVb&&Td.extendedProperties.set("fromCache",(xb.mVb<xb.nfe).toString()));Cc.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",
Td);return Dd},function(Dd){var Td=Object.assign(new kf.a,{durationMs:xb.X6f()}),we=Object(nb.a)(Tc,Dd);if(!we)return oc.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),Cc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",!1,!0,Td),new Promise(function(Oe,Te){Te(Dd)});Td.extendedProperties=fc;Td.extendedProperties&&Td.extendedProperties.set("status",we.Xdc.toString());
Cc.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Td);return 408===we.Xdc&&++Y<=xb.csg?xb.$Wd(Y):new Promise(function(Oe,Te){Te(we)})})};wc.prototype.YXi=function(Y){(Y=Lf.b(Y))?(oc.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),oc.ULS.sendTraceTag(50938594,3004,50,"{0}",Y)):oc.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");
return Y.Features};wc.prototype.mva=function(Y){var Ra=String.format("{0}{1}",this.wb.Ua("WebServiceBase"),Y);this.wb.Ty("ApplicationFeatureHelperHttpCachingEnabled")&&this.wb.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(Y=wc.ibc(this.wb))&&0<Y.length&&(this.gXb&&(Y+="ucbf"),Ra=new dc.QueryStringBuilder(Ra),Ra.Hi("afhskey",Y),Ra=Ra.toString());return Ra};wc.prototype.isFeatureEnabled=function(Y,Ra){var xb=this;if(!this.oEa&&!this.HSc&&!this.vqa)return this.vBa;oc.ULS.sendTraceTag(42513091,3004,
50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",Y);if("ConnectedServices"===Y){var fc=this.oEa?this.B3d.$J("ControllerConnectedServicesEnabled"):this.vBa,bd=this.HSc?this.Eje.getSettings().then(function(we){return 2!==we.It},function(){return Ra}):this.vBa;return fc.then(function(we){return we?bd:xb.kad})}fc=null;fc=this.oEa?this.B3d.isFeatureEnabled(Y):this.vBa;var Dd=null;Dd=this.vqa?this.vii(Y,Ra):this.vBa;var Td=null;Td=this.HSc?this.Eje.isFeatureEnabled(Y):
this.vBa;return fc.then(function(we){return we?Td.then(function(Oe){return Oe?Dd:xb.kad}):xb.kad}).then(function(we){xb.Qmf(Y,we,!0);return we},function(){xb.Qmf(Y,Ra,!1);return Ra})};wc.prototype.Qmf=function(Y,Ra,xb){oc.ULS.sendTraceTag(526713106,3004,50,"FeatureName={0}, IsEnabled={1}, IsSuccess={2}",Y,Ra,xb)};wc.prototype.getFeatureTier=function(Y,Ra){var xb=this;if(!this.vqa)return new Promise(function(fc){fc(2)});oc.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",
Y);return this.zua.then(function(fc){return xb.dcc(Y,fc,Ra)},function(){return Ra})};wc.prototype.isFreemiumUpsellEnabled=function(){return this.SSb&&this.fLc&&!this.T8d};wc.prototype.launchUpsellExperience=function(Y,Ra){Ra=void 0===Ra?null:Ra;oc.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",Y));var xb=Rf.a.Wr();xb&&(xb.set("experienceId",Y),Ra&&xb.set("campaignId",Ra));Cc.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",
1,"waclicensing",xb);if(xb=ee.a.instance.Oh("Common.IInProductMessagingUIManager")){var fc=Object(Ve.a)(this,this.A3h,"handleDimeTaskComplete");xb.$kf(Y,fc,Ra)}else oc.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),Cc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),Ra={},this.La.Ce(hf.a.p$b,2,(Ra.experience=Y,Ra))};wc.prototype.Fza=function(Y,Ra){if(!this.vqa)return null;if(!Y||!Ra)return oc.ULS.sendTraceTag(594564813,
3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;var xb=Gd.a.create().toString();this.yua.xb(Y)||this.yua.ia(Y,new ze.a(Ae.a.Hk()));this.yua.oa(Y).add(xb,Ra);oc.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",xb,Y));return xb};wc.prototype.AId=function(Y,Ra){this.vqa&&(Y&&this.yua.xb(Y)?Ra&&Gd.a.isValid(Ra)?this.yua.oa(Y).xb(Ra)?(oc.ULS.sendTraceTag(594564808,
3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",Ra,Y)),this.yua.oa(Y).remove(Ra)):oc.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Ra,Y)):oc.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Ra,Y)):oc.ULS.sendTraceTag(594564811,
3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",Y)))};wc.prototype.dcc=function(Y,Ra,xb){return this.gXb?Y in Ra?Ra[Y].LicenseTier:xb:Y in Ra?this.vYi(Ra[Y],xb):xb};wc.prototype.vYi=function(Y,Ra){switch(Y.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Ra}};wc.prototype.A3h=function(){var Y=this;oc.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");
this.zua.then(function(Ra){Y.nOf(Ra)}).catch(function(){Y.nOf({})})};wc.prototype.nOf=function(Y){var Ra=this;oc.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var xb=this.$Wd(0,!0);xb.then(function(fc){Ra.zua=xb;Ed.a.count(fc)>Ed.a.count(Y)?Cc.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):Cc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(var bd=yl(Ra.yua.keys),Dd=bd.next();!Dd.done;Dd=
bd.next())if(Dd=Dd.value,Dd in fc){var Td=Ra.dcc(Dd,fc,0);Dd in Y?Ra.dcc(Dd,Y,0)!==Td&&Ra.tyd(Dd,!0,Td):Ra.tyd(Dd,!0,Td)}else Dd in Y&&Ra.tyd(Dd,!1,Ra.dcc(Dd,Y,0))}).catch(function(fc){Cc.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);oc.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(fc))})};wc.prototype.tyd=function(Y,Ra,xb){oc.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",
Y,Ra,xb);Ra=new yb(Y,Ra,xb);xb=this.yua.oa(Y);xb=yl(xb);for(var fc=xb.next();!fc.done;fc=xb.next()){fc=fc.value;try{fc.value(Ra)}catch(bd){oc.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",Y,fc.key,bd.message))}}};wc.prototype.te=function(Y,Ra){var xb=this;if(this.vqa){var fc=this.vae.contains(Y),bd=!0,Dd="",Td=!1;return this.zua.then(function(we){Y in we?
(we=we[Y],Dd=Ee[we.FeatureState],bd=1!==we.FeatureState):bd=!fc;xb.Ymf(Y,fc,Dd,Td,Ra,bd);return bd},function(){Td=!0;fc&&(bd=Ra);xb.Ymf(Y,fc,Dd,Td,Ra,bd);return bd})}return this.vBa};wc.prototype.Ymf=function(Y,Ra,xb,fc,bd,Dd){oc.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",Y,Ra,fc,xb,bd,Dd)};wc.prototype.vii=function(Y,Ra){if(this.gXb)return this.te(Y,Ra);if(this.vqa){if(this.vae.contains(Y))return this.zua.then(function(xb){return Y in
xb},function(){return Ra});oc.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",Y)}return this.vBa};wc.prototype.l2i=function(Y){try{Y&&"Date"in Y&&(this.mVb=new Date(Y.Date),oc.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.mVb.toString()))}catch(Ra){oc.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",
Ra)}};wc.prototype.X6f=function(){if(void 0!==this.wqa&&null!==this.wqa){var Y=this.wqa.Dc;this.wqa.stop();return Y}return null};wc.ibc=function(Y){try{if(Oc.a.rIj){var Ra=Y.Ua("UserDataSignature").split(".");if(1<Ra.length){var xb=window.self.atob(Ra[1]),fc=JSON.parse(xb).LocalStorageKey;if(void 0!==fc&&null!==fc&&0<fc.length)return fc}}}catch(bd){oc.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",bd.toString())}return null};Object(Yc.a)(wc,"ApplicationFeatureHelper",null,
[386]);var rf=b(184);Object(Yc.a)(Wb,"CloudPolicySettingsCacheData",null,[]);var ng=b(951),je=b(375),bg=b(219);tf.k5f=function(){return Uc.AFrameworkApplication.ga.ra("SideCarIsEnabled")?tf.zuc&&tf.Vnd?new Promise(function(Y){Y(!0)}):new Promise(function(Y,Ra){tf.zuc=bg.a.create(Uc.AFrameworkApplication.ga.Ua("SideCarUrl"));je.a.Kia(tf.zuc);tf.zuc.N9(function(xb,fc){(tf.Vnd=fc.succeeded)?Y(fc.succeeded):Ra(fc.succeeded)})}):new Promise(function(Y){Y(!1)})};tf.Vnd=!1;tf.zuc=null;Object(Yc.a)(tf,"SideCarLoader",
null,[]);Object(Yc.a)(Bd,"CloudPolicySettingsData",null,[]);Vd.prototype.$J=function(Y,Ra){Ra=void 0===Ra?!0:Ra;if(!this.oEa){var xb=this;return new Promise(function(Td){Td(xb.xvb(Y))})}var fc=this,bd=this,Dd=this.r2b.then(function(Td){try{var we=null;Td.PolicySettings&&"unknown"in Td.PolicySettings&&(we=Td.PolicySettings.unknown);if(we){if(Y in we&&void 0!==we[Y]&&null!==we[Y])return new Promise(function(Te){Te("0"!==we[Y])});var Oe=Y.toLowerCase();if(Oe in we&&void 0!==we[Oe]&&null!==we[Oe])return new Promise(function(Te){Te("0"!==
we[Oe])});oc.ULS.sendTraceTag(51512667,3004,50,"Policy"+Y+" not found, using default");return new Promise(function(Te){Te(fc.xvb(Y))})}return new Promise(function(Te){Te(fc.xvb(Y))})}catch(Te){return oc.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+Y+" policy value. Error Message: {0}",Te.message),fc.handleError(Te.toString(),Ra,fc.xvb(Y))}},function(Td){return bd.handleError(Td,Ra,bd.xvb(Y))});Dd.then(function(Td){oc.ULS.sendTraceTag(50651667,3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",
Y,Td);return null});return Dd};Vd.prototype.isFeatureEnabled=function(Y,Ra){Ra=void 0===Ra?!0:Ra;if(this.wb.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.xii(Y,Ra);var xb=new Promise(function(bd){bd(!0)}),fc="";this.SQb.contains(Y)&&(fc="ControllerConnectedServicesEnabled",xb=this.$J(fc,Ra));xb.then(function(bd){oc.ULS.sendTraceTag(50651668,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",
Y,bd,fc);return null});return xb};Vd.prototype.xii=function(Y,Ra){Ra=void 0===Ra?!0:Ra;var xb=new Promise(function(bd){bd(!0)}),fc="";"mso_sendASmile"===Y?fc="Enabled":"Survey"===Y||"FloodgateSurvey"===Y?fc="SurveyEnabled":this.SQb.contains(Y)&&(fc="ControllerConnectedServicesEnabled");""!==fc&&(xb=this.$J(fc,Ra));xb.then(function(bd){oc.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",Y,bd,fc);return null});return xb};
Vd.prototype.handleError=function(Y,Ra,xb){return Ra?new Promise(function(fc){fc(xb)}):new Promise(function(fc,bd){bd(Y)})};Vd.prototype.woa=function(Y,Ra,xb){var fc=this;if(!Y)return Promise.resolve(new Bd);var bd=!1,Dd=null;Cc.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var Td=this.v3c("GetCloudPolicySettings");return(new Promise(function(we,Oe){if(void 0!==fc.Ejb&&null!==fc.Ejb&&0<fc.Ejb.length){var Te=fc.nOj();if(void 0!==Te&&null!==Te){bd=!0;we(Te);return}}fc.Oib.Z3c(Ra,
xb,1,null,Object(Ve.a)(fc,fc.p2i,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],fc.wb.Ad("CloudPolicySettingsRequestQueueTimeout",15E3),fc.wb.Ad("CloudPolicySettingsRequestSentTimeout",3E4)).then(function(Zf){oc.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");fc.bPj(Zf);we(Zf);return Zf},function(Zf){Oe(Zf);return null})})).then(function(we){var Oe=fc.Dyc(Td);Td=Oe.stopwatch;Dd=Oe.returnValue;(Oe=Rf.a.Wr())&&Oe.set("FromCache",bd.toString());Oe=
Object.assign(new kf.a,{durationMs:Dd,extendedProperties:Oe});Cc.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Oe);return we})};Vd.prototype.DOj=function(){return tf.k5f().then(function(){oc.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})};Vd.prototype.mva=function(Y){return String.format("{0}{1}",this.wb.Ua("WebServiceBase"),Y)};Vd.prototype.ZXi=function(Y){var Ra=
Lf.d(Y).Ju;oc.ULS.sendTraceTag(50622687,3004,Ra?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",Y);return Ra};Vd.prototype.p2i=function(Y){try{if(void 0!==Y&&null!==Y&&"CheckIn-Interval"in Y){var Ra=parseInt(Y["CheckIn-Interval"]);void 0!==Ra&&null!==Ra&&0<Ra&&(this.$Fc=Ra)}}catch(xb){oc.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",xb)}};Vd.prototype.xvb=function(Y){return Y in this.Fce?"0"!==this.Fce[Y]:!0};Vd.prototype.nOj=
function(){try{var Y=ng.a.instance.getItem(this.Ejb);if(void 0===Y||null===Y)return oc.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;oc.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",Y);var Ra=JSON.parse(Y);if(void 0===Ra||null===Ra)return oc.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===
Ra.ExpirationTime||null===Ra.ExpirationTime)return oc.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(Ra.ExpirationTime)).getTime()<Date.now())return oc.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var xb=new Bd;xb.PolicySettings=Ra.PolicySettings;xb.ControllerConnectedServicesFeatureNames=new rf.a;this.wb.Ty("ServicesControlsMicrosoftControllerServicesList")&&
this.wb.fw("ServicesControlsMicrosoftControllerServicesList");for(var fc=yl(this.SQb),bd=fc.next();!bd.done;bd=fc.next())xb.ControllerConnectedServicesFeatureNames.add(bd.value);oc.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return xb}catch(Dd){return oc.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",Dd.toString()),null}};Vd.prototype.bPj=function(Y){try{if(void 0===Y||null===Y||void 0===Y.PolicySettings||
null===Y.PolicySettings)oc.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.$Fc)oc.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var Ra=new Wb(Y,this.$Fc),xb=JSON.stringify(Ra);oc.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",xb);ng.a.instance.setItem(this.Ejb,xb);oc.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(fc){oc.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",fc.toString())}};Vd.prototype.ibc=function(){var Y=wc.ibc(this.wb);return Y&&0<Y.length?"OCPS"+Y:null};Vd.prototype.v3c=function(Y){var Ra=ee.a.instance.Oh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==Ra&&null!==Ra?Ra.Hc("WebServiceCall",Y):null};Vd.prototype.Dyc=function(Y){if(void 0!==Y&&null!==Y){var Ra=Y.Dc;Y.stop();return{returnValue:Ra,stopwatch:null}}return{returnValue:null,stopwatch:Y}};Object(Yc.a)(Vd,
"CloudPolicySettingsHelper",null,[383]);Ac.prototype.clone=function(){var Y=new Ac;Y.It=this.It;Y.ufg=this.ufg;Y.PJe=this.PJe;Y.vHa=this.vHa;Y.vfg=this.vfg;Y.QJe=this.QJe;Y.Kea=this.Kea;Y.oRc=this.src;return Y};Ac.prototype.serialize=function(Y){Y=void 0===Y?null:Y;var Ra={};if(!Y||Y.contains(Ac.qOa))Ra[Ac.qOa]=this.It;if(!Y||Y.contains(Ac.QCb))Ra[Ac.QCb]=this.vHa;if(!Y||Y.contains(Ac.RCb))Ra[Ac.RCb]=this.Kea;return JSON.stringify(Ra)};Ac.create=function(Y,Ra){Ra=void 0===Ra?null:Ra;var xb=new Ac;
xb.oRc=Y;void 0!==Ra&&null!==Ra&&(Ac.qOa in Ra&&(xb.It=Ra[Ac.qOa]),Ac.QCb in Ra&&(xb.vHa=Ra[Ac.QCb]),Ac.RCb in Ra&&(xb.Kea=Ra[Ac.RCb]));return xb};Ac.deserialize=function(Y,Ra){try{var xb=JSON.parse(Y);if(void 0!==xb&&null!==xb)return Ac.create(Ra,xb);oc.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",Y);throw Error.argument("settingsData");}catch(fc){throw oc.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",fc.toString()),
fc;}};Sk.Object.defineProperties(Ac.prototype,{src:{configurable:!0,enumerable:!0,get:function(){return this.oRc}}});Ac.qOa="CCS";Ac.QCb="CCSTime";Ac.RCb="OfficePrivacyRoamedNoticeShown";Object(Yc.a)(Ac,"UserPrivacySettings",null,[]);var ig=b(121);hd.prototype.mva=function(Y){var Ra=String.format("{0}RoamingServiceHandler.ashx?action=",this.wb.appSettings.RoamingServiceHandlerWebServiceBase||"");Ra=new Sys.StringBuilder(Ra);Ra.append(Y);Ra.append("&");Ra.append(Uc.AFrameworkApplication.mj);return Ra.toString()};
hd.prototype.executeRequest=function(Y,Ra,xb,fc){return this.Tg.CYb(Y,Ra,void 0===fc?null:fc,null,xb,"33",!1,null,6E4)};hd.prototype.saveSettings=function(Y){var Ra=this;return new Promise(function(xb,fc){try{if(void 0===Ra.Ae||null===Ra.Ae||void 0===Y||null===Y)oc.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),fc("Can't determine setting changes to save");else{var bd=Ra.Ae.It!==Y.It;if(2===Ra.Ae.src&&bd)Ra.hlj(Y),xb(!0);else{var Dd=Ra.ipj(Y);
if(void 0===Dd||null===Dd||!Dd.length)oc.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),fc("No changes to save");else if(1===Ra.Ae.src)xb(Ra.obg(Dd));else if(0===Ra.Ae.src){oc.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Dd);var Td=Ra.executeRequest(Ra.mva("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Dd);Td.continueWith(function(){if(Td.Ih||Td.kg)oc.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),
xb(!1);else{var we=Td.result;void 0!==we.Bh&&null!==we.Bh&&void 0!==we.Bh.data&&null!==we.Bh.data&&we.Bh.data.httpStatus===Sc.a.kP?(oc.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),xb(!0)):(oc.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),xb(!1))}})}}}}catch(we){oc.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",we.toString()),xb(!1)}})};hd.prototype.ipj=function(Y){if(void 0===this.Ae||null===
this.Ae||void 0===Y||null===Y)throw Error.invalidOperation("User Privacy settings have not been initialized");var Ra=new rf.a;0===Y.src?(this.Ae.It!==Y.It&&(Ra.add(Ac.qOa),Ra.add(Ac.QCb)),this.Ae.Kea!==Y.Kea&&Ra.add(Ac.RCb)):1===Y.src&&this.Ae.It!==Y.It&&Ra.add(Ac.qOa);return Ra.count?Y.serialize(Ra):(oc.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)};hd.prototype.getSettings=function(){if(!this.DQc){var Y=this;this.DQc=new Promise(function(Ra){try{Y.Ae?
Ra(Y.Ae.clone()):Y.vOj().then(function(xb){Y.Ae=xb;Ra(Y.Ae.clone());return null},function(){Y.tOj().then(function(xb){Y.Ae=xb;Ra(Y.Ae.clone());return null},function(){Y.uOj().then(function(xb){Y.Ae=xb;Ra(Y.Ae.clone());return null},function(){oc.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");Y.Ae=new Ac;Ra(Y.Ae.clone());return null});return null});return null})}catch(xb){oc.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",
xb.toString()),Y.Ae=new Ac,Ra(Y.Ae.clone())}})}return this.DQc};hd.prototype.vOj=function(){var Y=this;return new Promise(function(Ra,xb){try{var fc=-1!==window.location.href.indexOf("&wd_pn=2");if(Y.wb.ra("PrivacyDialogShouldCheckRoaming")||fc){var bd=Y.executeRequest(Y.mva("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");bd.continueWith(function(){try{if(bd.Ih||bd.kg)oc.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");else{var Dd=bd.result;
if(Dd&&Dd.Bh&&Dd.Bh.data)if(Dd.Bh.data.httpStatus!==Sc.a.kP)oc.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Dd.Bh.data.httpStatus);else{if(Dd.Bh.data.ie){Ra(hd.parse(Dd.Bh.data.ie,0));oc.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Dd.Bh.data.ie);return}oc.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else oc.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");xb("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Td){oc.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Td.toString()),xb("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else oc.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),xb("Roaming should not be used")}catch(Dd){oc.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",Dd.toString()),xb("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})};hd.prototype.tOj=function(){var Y=this;return new Promise(function(Ra,xb){try{var fc=ig.a.get("WacUPToggleState"),bd=null;void 0!==fc&&null!==fc&&0<fc.length&&(bd=decodeURIComponent(fc));if(void 0!==bd&&null!==bd&&0<bd.length){var Dd=hd.parse(bd,1);oc.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Dd.toString());
Ra(Dd)}else{var Td=Ac.create(1),we=new rf.a;we.add(Ac.qOa);var Oe=Td.serialize(we);Y.obg(Oe)?(oc.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Oe),Ra(Td)):(oc.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Oe),xb("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(Te){oc.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
Te.toString()),xb("UserPrivacySettings TryGetSettingsFromCookie Eception")}})};hd.prototype.uOj=function(){return new Promise(function(Y){try{var Ra=-1!==window.location.href.indexOf("&wdccsoff=1"),xb=Ac.create(2);Ra?(xb.It=2,Uc.AFrameworkApplication.wIe(),oc.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",xb.toString())):(xb.It=1,oc.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
xb.toString()));Y(xb)}catch(fc){oc.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",fc.toString()),Ra=Ac.create(2),Ra.It=1,Y(Ra)}})};hd.prototype.hlj=function(Y){oc.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===Y.It?Uc.AFrameworkApplication.wIe():Uc.AFrameworkApplication.Qkh();oc.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",Y)};hd.prototype.obg=function(Y){try{oc.ULS.sendTraceTag(51258455,
3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",Y);var Ra=this.wb.Ua("PrivacyCookieDomain")||"";if(!Ra||!Ra.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");oc.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",Y);return ig.a.yPd("WacUPToggleState",Y,ig.a.iW,"/",Ra)}catch(xb){return oc.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",xb.toString()),!1}};hd.prototype.isFeatureEnabled=
function(Y){var Ra=this;return this.getSettings().then(function(xb){for(var fc=Ra.wb.Ty("ServicesControlsMicrosoftControllerServicesList")?Ra.wb.fw("ServicesControlsMicrosoftControllerServicesList"):[],bd=new xf.a,Dd=0;Dd<fc.length;Dd++)bd.add(fc[Dd]);return bd.contains(Y)?2!==xb.It:!0},function(){oc.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",Y);return!0})};hd.parse=function(Y,Ra){try{return oc.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
Y,Ra),Ac.deserialize(Y,Ra)}catch(xb){throw oc.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",xb.toString()),xb;}};Object(Yc.a)(hd,"UserPrivacySettingsHelper",null,[384]);var Yd=b(273);vc.prototype.ji=function(Y){var Ra=this;this.tb=Y;this.tb.register(383,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").Bc().Lc(function(){return new Vd(Uc.AFrameworkApplication.ga,Uc.AFrameworkApplication.Jd)});this.tb.register(384,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").Bc().Lc(function(){return new hd(Uc.AFrameworkApplication.ga,
Uc.AFrameworkApplication.Jd)});this.tb.register(385,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").Bc().Lc(function(){return new mc(Uc.AFrameworkApplication.ga,Uc.AFrameworkApplication.Jd)});this.tb.register(386,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").Bc().Lc(function(){return new wc(Uc.AFrameworkApplication.ga,Uc.AFrameworkApplication.Jd,Ra.tb.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),Ra.tb.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
Uc.AFrameworkApplication.Gb)})};vc.prototype.init=function(){var Y=this;Uc.AFrameworkApplication.ga.ow(function(){var Ra=Y.tb.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Uc.AFrameworkApplication.ga.ra("LicensingIsEnabled")&&(Ra.isFeatureEnabled("LicensingTestFeature",!1).then(function(xb){oc.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",xb,Uc.AFrameworkApplication.ga.Ua("IsAnonymousUser"));
return null}),Ra.getFeatureTier("LicensingTestFeature",0).then(function(xb){oc.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",xb,Uc.AFrameworkApplication.ga.Ua("IsAnonymousUser"));return null}));Y.tb.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");Y.PJj()})};vc.prototype.dispose=function(){};vc.prototype.PJj=function(){try{Uc.AFrameworkApplication.ga.ra("SideCarIsEnabled")&&tf.k5f().then(function(Y){oc.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",Y);return Y})}catch(Y){}};vc.main=function(){Yd.a.instance.sj(new vc)};Sk.Object.defineProperties(vc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}}});Object(Yc.a)(vc,"ApplicationFeatureHelperPackage",null,[4,5]);var If=b(142),Pd=b(397),Ze=Pd.a;vm(lf,Ze);lf.prototype.createElement=function(){var Y=document.createElement("link");Y.setAttribute("rel",
"stylesheet");Y.setAttribute("type","text/css");Y.setAttribute("href",this.cu);return Y};lf.prototype.X3c=function(){return null};lf.prototype.Rrc=function(){this.element.setAttribute("href","");this.element.setAttribute("href",this.rI.cu)};Sk.Object.defineProperties(lf.prototype,{G3b:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(Yc.a)(lf,"CssResource",Pd.a,[]);var Yf=b(29),Xf=b(52);Re.prototype.sti=function(){this.YRb||(oc.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),
this.YRb=Xf.Task.WAA(Re.yti(),Re.pti()),this.YRb.continueWith(function(Y){oc.ULS.sendTraceTag(21030599,324,10,"{0}",Yf.a.Aed(Y.exception))},5));return this.YRb};Re.prototype.uti=function(){if(!this.IUb)try{oc.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.IUb=Xf.Task.WAA(Re.z8c(bg.a.create(Uc.AFrameworkApplication.ga.Ua("DimeUrl"),null,null))),this.IUb.continueWith(function(Y){oc.ULS.sendTraceTag(39978391,324,10,"{0}",Yf.a.Aed(Y.exception))},5)}catch(Y){oc.ULS.sendTraceTag(594874951,
324,10,"{0}",Yf.a.Aed(Y))}return this.IUb};Re.yti=function(){var Y=Re.fcc("inproductmessaging.js");Y=bg.a.create(Y,null,null);return Re.z8c(Y)};Re.pti=function(){var Y=Re.fcc("inproductmessaging.css");Y=new lf(Y);return Re.z8c(Y)};Re.fcc=function(Y){return If.a.L2b(String.format("ipm/{0}",Y))};Re.z8c=function(Y){je.a.Kia(Y);return Y.$7a};Object(Yc.a)(Re,"DependencyDownloader",null,[859]);ke.iXi="inProductMessagingOverlayDiv";ke.UZi="PlayButtonImage";ke.yfj="ReplayButtonImage";Object(Yc.a)(ke,"Constants",
null,[]);od.prototype.ktj=function(){this.gne(ke.UZi,this.VZi);this.gne(ke.yfj,this.zfj)};od.prototype.gne=function(Y,Ra){Ra&&(this.Ebg[Y]=Ra)};Sk.Object.defineProperties(od.prototype,{lNg:{configurable:!0,enumerable:!0,get:function(){return this.c2d},set:function(Y){this.c2d=Y}},LBi:{configurable:!0,enumerable:!0,get:function(){return this.Ibe},set:function(Y){this.Ibe=Y}},MBj:{configurable:!0,enumerable:!0,get:function(){return this.vhe},set:function(Y){(this.vhe=Y)&&this.ktj()}}});Object(Yc.a)(od,
"FirstRunExperienceUISettings",null,[858]);Object(Yc.a)(Qd,"FirstRunExperienceViewData",null,[857]);var rg=b(171),uf=b(104);Cd.prototype.Qg=function(){this.La.ef(hf.a.HDh,uf.a.frame,Object(Ve.a)(this,this.FDh,"firstRunExperienceHandler"),64);this.La.fc(hf.a.OUe,uf.a.frame,Object(Ve.a)(this,this.J9h,"inProductMessagingTabHandler"));this.La.fc(hf.a.NUe,uf.a.frame,Object(Ve.a)(this,this.I9h,"inProductMessagingShiftTabHandler"));this.La.fc(hf.a.kfh,uf.a.frame,Object(Ve.a)(this,this.lfh,"dimeLaunchHandler"));
this.La.fc(hf.a.ASf,uf.a.frame,rg.ActionManager.ng);this.La.fc(hf.a.Xfj,uf.a.frame,rg.ActionManager.ng);this.La.fc(hf.a.Yfj,uf.a.frame,rg.ActionManager.ng);this.gf&&this.gf.updateCommandUI()};Cd.prototype.FDh=function(Y,Ra,xb,fc,bd){2===xb&&this.BSb.Sri(bd);return 32};Cd.prototype.lfh=function(Y,Ra,xb,fc,bd){2===xb&&this.BSb.Qri(bd);return 32};Cd.prototype.J9h=function(Y,Ra,xb){return 2===xb?this.BSb.Twd():32};Cd.prototype.I9h=function(Y,Ra,xb){return 2===xb?this.BSb.Rwd():32};Object(Yc.a)(Cd,"InProductMessagingActor",
null,[]);Object(Yc.a)(Ec,"DimeExperienceUISettings",null,[]);var kg=b(168),qh=b(588);of.prototype.rbi=function(Y){kg.b("getHeaderApi")?Y.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Ra){var xb=Y.isFreemiumUpsellEnabled();xb&&(appChrome.getHeaderApi().then(function(fc){fc.updatePremiumStatus(Ra,xb);return null}),Y.Fza("MsoPremiumBadge",function(fc){appChrome.getHeaderApi().then(function(bd){bd.updatePremiumStatus(fc.isEnabled,xb);return null})}));return null}):oc.ULS.sendTraceTag(593859840,
324,10,"getHeaderApi not available")};of.prototype.Sri=function(Y){var Ra=this;this.jVb.sti().continueWith(function(){Ra.VXa.iDj(Y)})};of.prototype.Qri=function(Y){function Ra(){}var xb="gopremium",fc=null;Y?(Y.experience&&""!==Object(nb.a)(String,Y.experience)&&(xb=Object(nb.a)(String,Y.experience)),Y.onTaskComplete&&(Ra=Y.onTaskComplete),Y.campaignId&&""!==Object(nb.a)(String,Y.campaignId)&&(fc=Object(nb.a)(String,Y.campaignId))):oc.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");
this.$kf(xb,Ra,fc)};of.prototype.$kf=function(Y,Ra,xb){var fc=this;xb=void 0===xb?null:xb;if(this.o$b&&this.Trb){var bd={};bd.experience=Y||"gopremium";bd.campaignId=xb||qh.b(this.t1,this.SEc,Object(nb.a)(String,bd.experience),!0);this.La.processAction(hf.a.ASf,2);oc.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+bd.experience);try{var Dd=Object.assign(new Ec,{instance:this.Trb,ijc:bd,Z8f:Ra||function(){},ZTf:function(Td){oc.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+
Td.status)},iPf:function(){oc.ULS.sendTraceTag(51675406,324,10,"Dime launch error");fc.o$b=!1;fc.Trb=null}});this.VXa.qBj(Dd)}catch(Td){oc.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Td.message),this.o$b=!1,this.Trb=null,Y={},this.La.Ce(hf.a.p$b,2,(Y.experience=bd.experience,Y))}}else oc.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),bd={},this.La.Ce(hf.a.p$b,2,(bd.experience=Y,bd))};of.prototype.Qlf=function(){var Y=this;this.jVb.uti().continueWith(function(){try{var Ra=
Yf.a.Ol(Uc.AFrameworkApplication.uiCulture),xb=qh.c(Y.t1);if(xb){Ra={partnerId:xb,language:Ra};Ra.sessionId=Uc.AFrameworkApplication.userSessionId;Ra.authHint=Uc.AFrameworkApplication.ga.Ua("UserPrincipalName");var fc=Uc.AFrameworkApplication.ga.Ua("Puid")||"";""!==fc&&(Ra.userInfo={puid:fc});Y.Trb=new Dime(Ra);Y.o$b=!0;oc.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else oc.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(bd){oc.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+
bd.message)}},3)};of.prototype.Twd=function(){return this.VXa.Twd()};of.prototype.Rwd=function(){return this.VXa.Rwd()};Object(Yc.a)(of,"InProductMessagingUIManager",null,[854]);ge.prototype.Init=function(Y){this.$ie=Y};ge.prototype.SendTrace=function(Y,Ra){oc.ULS.sendTraceTag(34182235,this.$ie,this.FWa[Y],"{0}",Ra)};Object(Yc.a)(ge,"DefaultNetworkingManager",null,[875]);var La=b(274),Db=b(374),uc=b(99);kd.prototype.iDj=function(Y){Y&&(InProductMessaging.Networking.NetworkingMgr=new ge,InProductMessaging.Networking.NetworkingMgr.Init(387),
InProductMessaging.Init(Y.MBj,Y.LBi,Y.lNg,Y.HCi,Y.locale,Object(Ve.a)(this,this.oKi,"onDismissFirstRunExperience"),Y.Ebg),this.FRa(ke.iXi,!0))};kd.prototype.qBj=function(Y){var Ra=this;if(Y&&Y.instance&&Y.ijc){var xb=document.getElementById("wacDimeContainer");xb||(xb=document.createElement("div"),xb.id="wacDimeContainer",document.body.appendChild(xb));Uc.AFrameworkApplication.ga.ra("DimeFocusManagerIsEnabled")&&this.FRa("wacDimeContainer",!1);Y.ijc.parentElementId="wacDimeContainer";Y.instance.launch(Y.ijc,
Y.Z8f).then(function(fc){Ra.SGb();document.body.removeChild(xb);Y.ZTf(fc)}).catch(function(fc){Ra.SGb();document.body.removeChild(xb);Y.iPf(fc)})}else throw Error.argument("DimeExperienceUISettings");};kd.prototype.FRa=function(Y,Ra){if(this.mc&&Y&&(Y=document.getElementById(Y),this.hbi(Y),Y=this.mc.$M("InProductMessagingFocusId"))){var xb=this.mc.Li;xb&&"InProductMessagingFocusId"===xb.name||this.mc.fS("InProductMessagingFocusId",!1);Ra&&this.pNf(Y.scope)}};kd.prototype.hbi=function(Y){var Ra=!1;
Ra=void 0===Ra?!0:Ra;var xb=this.mc.Bi("InProductMessagingFocusId");xb.parent=La.AFrame.dU;var fc=new Db.DOMFocusListing(function(){return Y});fc.Oab=Ra;fc.ao(3);fc.ao(2);fc.ao(4);Ra=this.mc.vsa(function(){return Y},xb,fc);Ra.NGb();Ra.v_=!0;Ra.oHa=!0};kd.prototype.pNf=function(Y){Y.Pk(uc.FocusManager.instance().i2);Y.Pk(uc.FocusManager.instance().j2);Y.bindAction(uc.FocusManager.instance().i2,hf.a.OUe);Y.bindAction(uc.FocusManager.instance().j2,hf.a.NUe)};kd.prototype.SGb=function(){this.mc&&(this.mc.Nca("InProductMessagingFocusId"),
this.mc.sQa("InProductMessagingFocusId"))};kd.prototype.oKi=function(Y,Ra){this.SGb();Y=Object.assign(new Qd,{completed:Y,W$i:Ra});Uc.AFrameworkApplication.Gb.Ce(hf.a.EDh,2,Y)};kd.prototype.Twd=function(){var Y=document.activeElement,Ra=this.mc.XQ();return Y&&Ra&&Ra.jf&&Y===Ra.jf.to?(Ra.jf.rl(Y),Ra.cya()?32:8):4};kd.prototype.Rwd=function(){var Y=document.activeElement,Ra=this.mc.XQ();return Y&&Ra&&Ra.jf&&Y===Ra.jf.firstElement?(Ra.jf.rl(Y),Ra.fOa()?32:8):4};Object(Yc.a)(kd,"InProductMessagingUIWrapper",
null,[853]);var Vc=b(144);ie.prototype.ji=function(Y){Y.register(Re,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").Bc().Lc(function(){return new Re});Y.register(kd,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").Bc().Lc(function(){return new kd(uc.FocusManager.instance())});Y.register(of,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").Bc().Lc(function(){return new of(Uc.AFrameworkApplication.Gb,
Y.resolve("Common.IInProductMessagingUIWrapper"),Y.resolve("Common.App.InProductMessaging.IDependencyDownloader"),Uc.AFrameworkApplication.sa.Qa.Pj,Uc.AFrameworkApplication.sa.Qa.nca)});Y.register(Cd,"Common.App.InProductMessaging.InProductMessagingActor").Bc().Lc(function(){return new Cd(Uc.AFrameworkApplication.Gb,Uc.AFrameworkApplication.sa,Y.resolve("Common.IInProductMessagingUIManager"))});Y.register(od,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").Bc().Lc(function(){return new od});
Y.register(Qd,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").Bc().Lc(function(){return new Qd});this.tb=Y};ie.prototype.init=function(){var Y=this;this.tb.resolve("Common.App.InProductMessaging.InProductMessagingActor").Qg();Uc.AFrameworkApplication.ga.ow(function(){Uc.AFrameworkApplication.sa.Qa.isReactSharedHeaderUxEnabled&&Vc.a.get_instance().kl(15,function(){Y.tb.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ra){Y.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").rbi(Ra)})});
Uc.AFrameworkApplication.ga.ra("FreemiumUpsellShowDialogIsEnabled")&&qh.a()&&!Oc.a.cB&&1!==Uc.AFrameworkApplication.sa.Qa.Pj&&Y.tb.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ra){Ra.isFeatureEnabled("MsoPremiumBadge",!0).then(function(xb){!xb&&Ra.isFreemiumUpsellEnabled()&&Y.tb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Qlf();return null})})})};ie.prototype.dispose=function(){};ie.main=function(){Yd.a.instance.sj(new ie)};Sk.Object.defineProperties(ie.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.InProductMessaging"}}});Object(Yc.a)(ie,"InProductMessagingPackage",null,[4,5]);Zd.prototype.J$c=function(Y){var Ra=new Sys.StringBuilder(this.Gv.fIb);Ra.append("RoamingServiceHandler.ashx?action=");Ra.append("getFirstRunExperienceSettings");Ra.append("&");Ra.append(this.Agd(Y));Ra.append("&");Ra.append(Uc.AFrameworkApplication.mj);Uc.AFrameworkApplication.Jd.Xl(Ra.toString(),1,null,null,!0,2,Object(Ve.a)(this,this.AKa,"getRequestSuccessCallback"),
Object(Ve.a)(this,this.Qja,"getRequestFailureCallback"),null)};Zd.prototype.K$c=function(Y){var Ra=new Sys.StringBuilder(this.Gv.fIb);Ra.append("RoamingServiceHandler.ashx?action=");Ra.append("saveFirstRunExperienceSettings");Ra.append("&");Ra.append(Uc.AFrameworkApplication.mj);Ra=Ra.toString();Y=Lf.c(Y);Uc.AFrameworkApplication.Jd.Xl(Ra,2,Y,null,!0,4,Object(Ve.a)(this,this.n0i,"postRequestSuccessCallback"),Object(Ve.a)(this,this.CPa,"postRequestFailureCallback"),null)};Zd.prototype.AKa=function(Y){var Ra=
!1,xb=null;try{if(0<Y.data.ie.length){var fc=Object(nb.a)(Object,Lf.a(Y.data.ie)),bd=fc?fc[this.Gv.xWc]:null;bd&&(xb=Object(nb.a)(Object,Lf.a(bd.toString())))}Ra=!0}catch(Dd){this.Qja(null)}Ra&&this.Cib&&this.Cib(Y.data,xb)};Zd.prototype.Qja=function(Y){this.yib&&this.yib(Y?Y.data:null)};Zd.prototype.n0i=function(Y){this.dee&&this.dee(Y?Y.data:null)};Zd.prototype.CPa=function(Y){this.Mkb&&this.Mkb(Y?Y.data:null)};Zd.prototype.Agd=function(Y){for(var Ra=new Sys.StringBuilder("requestedsettings="),
xb=0;xb<Y.count;xb++)Ra.append(Y.oa(xb)),xb<Y.count-1&&Ra.append(";");return Ra.toString()};Object(Yc.a)(Zd,"FirstRunExperienceRequestHandler",null,[]);mf.prototype.LRd=function(Y){Y?(this.Gv=Y,this.Dki()&&(oc.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),Y=new rf.a,Y.add(this.Gv.xWc),this.ZRb=new Zd(this.Gv,Object(Ve.a)(this,this.AKa,"getRequestSuccessCallback"),Object(Ve.a)(this,this.Qja,"getRequestFailureCallback"),null,Object(Ve.a)(this,
this.CPa,"postRequestFailureCallback")),this.ZRb.J$c(Y)),(this.Gv.Nzb||Uc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.MRd()):oc.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")};mf.prototype.Dki=function(){try{if(this.Gv.Nzb)return!0;if(!Uc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||Uc.AFrameworkApplication.ga.ra("IsAnonymousUser"))return!1;if(this.Gv.yhi||
this.Gv.l7a||Uc.AFrameworkApplication.ga.ra("IsO365ConsumerHost"))return!0;var Y=Uc.AFrameworkApplication.ga.Ua("FlightId");return-1!==(Y?Y.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Ra){oc.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Ra?Ra.toString():null)}return!1};mf.prototype.ZVf=function(Y){var Ra={},xb={};xb.FREDisplayedDate=(new Date).toUTCString();xb.VersionDisplayed=Y;xb.RemindMeLater=!1;Ra[this.Gv.xWc]=Lf.c(xb);oc.ULS.sendTraceTag(51675533,306,50,
"Initiating call to save FRE data for current user from Roaming Settings Service");this.ZRb&&this.ZRb.K$c(Ra)};mf.prototype.AKa=function(Y,Ra){Y=Y?+Y.q3-+Y.iF:-1;Y>this.Gv.QUf?oc.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",Y,this.Gv.QUf):Ra?this.eAj(Ra)?(oc.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.Gv.Vqf),this.MRd()):oc.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(oc.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.MRd())};mf.prototype.Qja=function(Y){oc.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",Y?Y.httpStatus:-1)};mf.prototype.CPa=function(Y){oc.ULS.sendTraceTag(51675542,306,
10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",Y?Y.httpStatus:-1)};mf.prototype.MRd=function(){var Y=this,Ra=ee.a.instance.Oh("Common.ISystemInitiatedFeedback");Ra?this.Z3f(Ra):(oc.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),Uc.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Ra=ee.a.instance.oc("Common.ISystemInitiatedFeedback"))?Ra.execute(function(xb){Y.Z3f(xb)}):
oc.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))};mf.prototype.Z3f=function(Y){if(Y){var Ra=this.Gv.UDh;Ra&&(Uc.AFrameworkApplication.sla(Ra),Uc.AFrameworkApplication.Rjc(Ra));oc.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Ra);Y.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.pib=Object(Ve.a)(this,this.mLi,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",
this.pib,!0),window.addEventListener("FRELaunchedEvent",this.pib,!0)):(oc.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.ZVf(this.Gv.currentVersion))}else oc.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")};mf.prototype.mLi=function(Y){if(Y){var Ra=Y.detail;Y=Y.type;var xb=this.Gv&&this.Gv.campaignId?this.Gv.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===Y||xb&&Ra&&Ra.id&&-1!==Ra.id.indexOf(xb))Ra.success&&(oc.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.ZVf(this.Gv.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.pib,!0),window.removeEventListener("FRELaunchedEvent",this.pib,!0))}};mf.prototype.eAj=function(Y){if("RemindMeLater"in Y&&"FREDisplayedDate"in Y){if("true"===Y.RemindMeLater.toString()&&(+new Date-+new Date(Y.FREDisplayedDate.toString()))/36E5>this.Gv.Vqf)return!0}else if(Uc.AFrameworkApplication.ga.ra("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in Y&&Y.VersionDisplayed<this.Gv.currentVersion)return oc.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1};Object(Yc.a)(mf,"FirstRunExperienceLauncher",null,[832]);Sf.prototype.ji=function(Y){this.tb=Y;this.tb.register(832,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").Bc().Lc(function(){return new mf})};Sf.prototype.init=function(){};Sf.prototype.dispose=function(){};Sf.main=function(){Yd.a.instance.sj(new Sf)};
Sk.Object.defineProperties(Sf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.FirstRunExperienceLauncher"}}});Object(Yc.a)(Sf,"FirstRunExperienceLauncherPackage",null,[4,5]);var yd=b(214),Md=b(351),qe=b(309),ac=b(354),Kc=b(1),dd=b(36),Ud=b(8),Le=b(371),ce=b(14),Nf=Le.a;vm(Qe,Nf);Qe.prototype.tV=function(){var Y={};Y.id=this.Ac;var Ra=ce.a.instance.fa(2190);Y.DialogMessage=Ra;return Y};Sk.Object.defineProperties(Qe.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"ClipboardReadPermissionAskDialog"}}});
Object(Yc.a)(Qe,"ClipboardReadPermissionAskDialog",Le.a,[]);var af=b(48);be.prototype.bef=function(Y){return Y?this.sessionStateId===Y.sessionStateId&&this.sessionId===Y.sessionId:!1};be.prototype.isFromCurrentSession=function(Y){return this.sessionId===Y.ya.UserSessionId};Object(Yc.a)(be,"SourceItem",null,[]);vm(me,be);me.prototype.isEqual=function(Y){return Y&&Object.getType(Y)===me?this.bef(Y)&&this.activeFloatingObjectControlId===Y.activeFloatingObjectControlId&&this.sheetName===Y.sheetName:!1};
me.prototype.toString=function(){return this.type.toString()};Object(Yc.a)(me,"ArtSourceItem",be,[]);var wf;(function(Y){Y[Y.valid=0]="valid";Y[Y.notPairwiseDisjoint=1]="notPairwiseDisjoint";Y[Y.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";Y[Y.notValidForm=3]="notValidForm";Y[Y.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(wf||(wf={}));Object(Yc.b)("CopySourceValidationOptions",wf);var vf=b(43);vm(nd,be);nd.prototype.isEqual=function(Y){return Y&&Object.getType(Y)===
nd?this.bef(Y)&&vf.Q(this.ranges,Y.ranges)&&this.sheetName===Y.sheetName:!1};nd.prototype.toString=function(){return vf.i(this.ranges,",",this.$,!1)};Object(Yc.a)(nd,"RangeSourceItem",be,[]);Wd.HVj="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(Yc.a)(Wd,"ExpectedErrorNames",null,[]);rb.zW="text/plain";rb.html="text/html";rb.png="image/png";rb.EO="data/shadow-workbook";rb.lki="metadata/is-last-copy-was-external";rb.Pgi="metadata/is-last-copy-was-external-XLO-source";rb.LXg="metadata/chrome-extension-id";
rb.g3c="copyId";rb.eIg="metadata/additional-signature-data-attributes";Object(Yc.a)(rb,"ClipboardDataFormat",null,[]);var pg=b(45),bf=b(20),Bf=b(34);Ke.prototype.eKa=function(){return Ke.MYi};Ke.prototype.QOh=function(){return this.L8b&&1===this.L8b.length?this.ROh(this.L8b[0]):null};Ke.prototype.ROh=function(Y){var Ra=bf.g(this.$),xb=Ra.$a.oj(Y),fc=Ra.pg(Y,xb);Ra=Ra.rtl;if(!fc)return null;Y=bf.g(this.$).Sf(xb);var bd=Y.pn;if(!bd.Qd(fc))return null;fc=bd.zf(fc);var Dd=fc.topLeft.y,Td=fc.bottomRight.y,
we=Ra?fc.bottomRight.x:fc.topLeft.x;fc=Ra?fc.topLeft.x:fc.bottomRight.x;var Oe=new pg.a(fc+(Ra?-81:81),Td+38+6);if(bd.rHa(Oe))return this.c4a(Y,bd,xb,fc,Td,Ra?12:-3,66);Oe=new pg.a(fc+(Ra?-81:81),Td);if(bd.rHa(Oe))return this.c4a(Y,bd,xb,fc,Td,Ra?20:3,22);Oe=new pg.a(fc,Td+38+6);if(bd.rHa(Oe))return this.c4a(Y,bd,xb,fc,Td,-81+(Ra?18:0),66);fc=new pg.a(we+(Ra?81:-81),Td);if(bd.rHa(fc))return this.c4a(Y,bd,xb,we,Td,-81+(Ra?12:-6),22);Td=new pg.a(we,Dd-38-6);return bd.rHa(Td)?this.c4a(Y,bd,xb,we,Dd,
Ra?15:0,16):this.c4a(Y,bd,xb,Ra?bd.topLeft.x:bd.bottomRight.x,bd.bottomRight.y,-81+(Ra?15:-6),22)};Ke.prototype.c4a=function(Y,Ra,xb,fc,bd,Dd,Td){var we=bf.g(this.$),Oe=we.rtl;Y=Sys.UI.DomElement.getLocation(Y.domElement);fc=new Sys.UI.Point(fc+(Oe?0:Y.x)-Ra.topLeft.x,bd+Y.y-Ra.topLeft.y);Oe&&(we=we.view.visibleArea,fc.x=we.bottomRight.x-we.topLeft.x-fc.x,2===xb||4===xb)&&(fc.x+=Ra.bottomRight.x);fc=Bf.a(this.$).Oja(fc);return new Sys.UI.Point(fc.x+Dd,fc.y+Td)};Sk.Object.defineProperties(Ke.prototype,
{dIg:{configurable:!0,enumerable:!0,get:function(){return this.Lkg}},lsi:{configurable:!0,enumerable:!0,get:function(){return this.Yrg}},i8i:{configurable:!0,enumerable:!0,get:function(){return this.Iug}},Fzh:{configurable:!0,enumerable:!0,get:function(){return this.Cog}}});Ke.MYi=["PasteRecoveryUI"];Object(Yc.a)(Ke,"PasteRecoveryUI",null,[877]);var $e=b(77),He=b(307);oe.Vzg="ActiveSelection";oe.EO="ShadowWorkbook";oe.ijg="GVML";oe.zW="PlainText";oe.html="Html";oe.uOg="Bitmap";Object(Yc.a)(oe,"PayloadType",
null,[]);se.RDj="Slice4";se.SDj="Slice5";se.TDj="Slice6";Object(Yc.a)(se,"SliceName",null,[]);Sd.uEi="NotCalled";Sd.success="Success";Sd.failed="Failed";Object(Yc.a)(Sd,"SucceededPopulatingSystemClipboardOptions",null,[]);var vg=b(356),ah;(function(Y){Y[Y.valid=0]="valid";Y[Y.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";Y[Y.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";Y[Y.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";
Y[Y.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";Y[Y.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";Y[Y.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";Y[Y.copySourceNotValid=7]="copySourceNotValid";Y[Y.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";Y[Y.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";
Y[Y.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";Y[Y.unknown=100]="unknown"})(ah||(ah={}));Object(Yc.b)("PasteValidationOptions",ah);var Ph=b(56),Pf=b(39),Da=b(141),Fb=b(35),Lc=b(148),ud=b(339),zd=b(27),Ce=b(378),Ge=b(9),gf=b(19),Df=b(105),Ea=b(155),kb=b(135),Vb=b(584),Qc=b(100),Mc=b(335),Ab=dd.a;vm(Ad,Ab);Ad.prototype.sGg=function(Y){this.addHandler(Ad.TBd,Y)};Ad.prototype.tdj=function(Y){this.removeHandler(Ad.TBd,Y)};Ad.prototype.copy=function(Y){var Ra=this;Y.stopwatch=this.$.Vb.Hc("UserAction",
af.b().ui(Y.ribbonCommandInfo.command)+"ClientSide");if(this.so){var xb=Ph.GetServiceTaskFactory.Wa(this.$.da,478,479,0);Fb.TaskExtensions.Ba(xb,function(){Ra.pasteShortcutManager=xb.result},this.ma,3)}var fc=!!bc(this.HK);Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Oc.a.MC&&(this.Z6a=!1);this.Ur("Copy/before/"+Md.a[Y.ribbonCommandInfo.method],!1,void 0,!0,Y.copyPasteTargetType).catch(function(){});var bd=-1985798686===Y.ribbonCommandInfo.command;
if(1===this.gridView.Ve&&(bd=this.Vr.udf(this.gridView.ha.va.selectedRanges,bd),0!==bd)){var Dd=Ad.V2g(bd);this.hza(Dd,wf[bd],!1);return Promise.reject(!1)}Y.userHash=this.userHash;Y.id=Gd.a.create().toString();var Td=this,we=this;return this.B3b.onCopy(Y).then(function(Oe){Oe.isAsyncCopy||Y.stopwatch.stop();Td.pasteIndicationManager.VJe();oc.ULS.sendTraceTag(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",vg.d(Y));Td.Qui(Oe,fc);!Y.isFormatPainter&&Td.so&&
(Td.pasteShortcutManager?Td.pasteShortcutManager.Vkh():oc.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},function(Oe){var Te=!1,Zf="none",dg=Ad.Hrb,Jg=!0,Ug=-1,Xh=Ad.copyErrorName+Ad.UIa,Ef=!1,Th=null;if(Oe){Th=Oe.copyContext;Ug=Oe.reason;Xh+=Ad.lKa(Oe);Oe.message&&(dg=Oe.message);var sh=Ad.U2g(Oe);if(sh)if(3===sh.copyErrorName)Te=!0,dg=Zf="Async Copy canceled by the user.",Jg=!1;else if(zd.a.er(sh.ewaErrors))if(dg=we.Oac(sh.ewaErrors),zd.a.kh(sh.ewaErrors,
Ad.operationSucceededWithAlert))Ef=Te=!0;else if(zd.a.kh(sh.ewaErrors,Ad.pasteDataLimitHit)||zd.a.kh(sh.ewaErrors,Ad.copyThrottlingError))Te=!0;13===Oe.reason?(Te=!0,Jg=!1):11===Oe.reason&&(Jg=!1)}Te?oc.ULS.sendTraceTag(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",Jg,Zf,Oe?we.getStringifiedError(Oe):"null",vg.d(Y)):oc.ULS.sendTraceTag(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",
Jg,Oe?we.getStringifiedError(Oe):"null",vg.d(Y));Jg&&we.Ur("Copy/fail/"+Md.a[Y.ribbonCommandInfo.method],!0,void 0,void 0,Y.copyPasteTargetType).catch(function(){});we.Pui(Y,Te,dg,Xh,Ug,Ef,Th);return Promise.reject(Oe)})};Ad.prototype.paste=function(Y){var Ra=this;Y.stopwatch=this.$.Vb.Hc("UserAction",af.b().ui(Y.ribbonCommandInfo.command)+"ClientSide");Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Oc.a.MC&&(oc.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),
this.Z6a=!1,Y.clipboardPicklingApiDataFormatsToRead=[rb.EO]);bf.g(this.$).Mi&&bf.g(this.$).Mi.C7(this.egd(Y.ribbonCommandInfo.command),Y.stopwatch.id);if(Y.isPasteCommandFromRecoveryUI){var xb=this.$.da.Aa(406);var fc=qe.a.clone(xb.Fsd);xb=xb.qsd;Y.pasteRecoveryCachedClipboardItems=xb?xb[Ad.lHf]:null}else fc=qe.a.clone(this.gridView.ha.va.selectedRanges);Y.originalDestinations=fc;Y.expandDestinations=this.CZc(Y.originalDestinations,Y.commandType);if(this.QZc(Y.commandType,Y.expandDestinations)||this.KUg())return Y.userHash=
this.userHash,Y.id=Gd.a.create().toString(),Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!Oc.a.MC&&(Y.clipboardReadPermissionPromptShown=!1,Y.clipboardAsyncApiDataFormatsToRead=[rb.zW+"Async"],this.B3b.shouldShowClipboardReadPermissionDialog().then(function(bd){bd&&(Y.clipboardReadPermissionPromptShown=!0,new Qe(Ra.$));return Promise.resolve(!0)},function(){return Promise.resolve(!0)})),this.B3b.onPaste(Y).then(function(bd){return Ra.Pnc(bd,Y)},
function(bd){return Ra.VDb(Y,bd)});this.$.xe(927125067,$e.a.$b,30,null);oc.ULS.sendTraceTag(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',vf.i(Y.expandDestinations,",",this.$,!1),Y.commandType,Y.copyPasteTargetType);return Promise.resolve(!0)};Ad.prototype.egd=function(Y){if(Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(Y){case 1804571062:return 6;
case -185374993:return 7;case 1766348718:return 8}return 3};Ad.prototype.KUg=function(){return!!bf.g(this.$).ha.Pa.activeFloatingObjectControlId&&this.$.Ns(null,!1,470)};Ad.prototype.CAb=function(){var Y=bc(this.HK);return Y&&Y.commandParameters?Y.commandParameters.copyPasteTargetType:0};Ad.prototype.kki=function(){return!!bc(this.HK)&&Jd(bc(this.HK),this.$)};Ad.prototype.Ur=function(Y,Ra,xb,fc,bd){var Dd=this;xb=void 0===xb?!1:xb;fc=void 0===fc?!1:fc;bd=void 0===bd?0:bd;try{this.so&&this.pasteShortcutManager&&
this.pasteShortcutManager.g6b();var Td=bd,we=this.iri();if(!fc&&2===we)return oc.ULS.sendTraceTag(537167821,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ra,xb,fc,bd,we),Promise.reject(null);0===Td&&(Td=we);var Oe=this.$.Vb.Hc("UserAction","ClearCopyState"),Te=Oe.id;oc.ULS.sendTraceTag(537167820,
0,50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Ra,xb,fc,bd,we);this.Vr.Xwb();this.m5i();return this.B3b.onCancelCopy(Ra).then(function(){Ra&&Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Oc.a.MC&&(Dd.Z6a=!1);Oe.stop();Dd.Fmf(Y,Te,!0,xb,Ra,"","",Oe.Dc,Td);return Promise.resolve(!0)},
function(Zf){oc.ULS.sendTraceTag(24150915,0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",Zf?Dd.getStringifiedError(Zf):"null");Oe.stop();var dg=Ad.ZUg+Ad.UIa,Jg=Ad.Hrb;Zf&&(dg+=Ad.lKa(Zf),Zf.message&&(Jg=Zf.message));Dd.Fmf(Y,Te,!1,xb,Ra,Jg,dg,Oe.Dc,Td);return Promise.reject(Zf)})}catch(Zf){return Promise.reject(null)}};Ad.prototype.b2b=function(Y,Ra,xb,fc,bd){xb=void 0===xb?!1:xb;fc=void 0===fc?!1:fc;bd=void 0===bd?0:bd;return fc||!Kc.EwaSettings.la(684)||
this.Chh()?this.Ur(Y,Ra,xb,fc,bd):(oc.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))};Ad.prototype.hza=function(Y,Ra,xb){oc.ULS.sendTraceTag(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",Ra);var fc=new Qc.a;fc.ia("reason",Ra);Vb.a(Ea.a.discontinuousSelectionBlocking,
[xb?kb.a.HYi:kb.a.K3g],!0,!0,!1,!1,fc);Y=zd.a.hd(1,1,738,Y,0,371863010,"DiscontinuousSelectionBlocking");Kc.EwaSettings.oz()?new ud.a(this.$,Y):(Y=new Lc.ErrorDialog(this.$,Y),Y.initialize(),Y.mf())};Ad.prototype.iri=function(){var Y=bc(this.HK);return Y&&Y.sourceItem?Object.getType(Y.sourceItem)===me?2:1:0};Ad.prototype.dragDropCells=function(Y,Ra,xb,fc,bd){var Dd=this;bd=void 0===bd?!1:bd;Y.stopwatch=this.$.Vb.Hc("UserAction","DragDropClientSide");this.Ur("DragDrop/before/"+Md.a[Y.ribbonCommandInfo.method],
!1,void 0,void 0,Y.copyPasteTargetType).catch(function(){});var Td=bd?2:1,we=0;we=bd?4:fc?256:128;var Oe={encounteredDeploymentErrors:!1};Oe.commandParameters=Y;Y.userHash=this.userHash;Y.id=Gd.a.create().toString();return this.Vr.pasteRange(Y.ribbonCommandInfo,vf.q(Ra,this.$),vf.q(xb,this.$),Td,we,[Y.stopwatch],Oe,!1).then(function(){oc.ULS.sendTraceTag(537167818,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',Y.copyPasteTargetType);Dd.gridView.ha.selectionType=-1;
Dd.bud(Y,Td,Ra,xb,Oe);return Promise.resolve(!0)},function(Te){oc.ULS.sendTraceTag(537167817,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',Te?Dd.getStringifiedError(Te):"null",Y.copyPasteTargetType);return Dd.dAd(Te,Y,Td,Ra,xb,Oe)})};Ad.prototype.Xhh=function(Y,Ra,xb,fc,bd){var Dd=this;bd=void 0===bd?!1:bd;Y.stopwatch=this.$.Vb.Hc("UserAction","DragDropReplaceClientSide");this.b2b("DragDropReplace/before/"+Md.a[Y.ribbonCommandInfo.method],!1,void 0,void 0,Y.copyPasteTargetType).catch(function(){});
var Td=bd?2:1,we=0;we=bd?4:fc?256:128;var Oe={encounteredDeploymentErrors:!1};Oe.commandParameters=Y;Kc.EwaSettings.getBooleanFeatureGate(He.a.S6b,!1)&&(Y.isDragInsert=!1);Y.userHash=this.userHash;Y.id=Gd.a.create().toString();return this.Vr.pasteRange(Y.ribbonCommandInfo,vf.q(Ra,this.$),vf.q(xb,this.$),Td,we,[Y.stopwatch],Oe,!1).then(function(){oc.ULS.sendTraceTag(537167816,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',Y.copyPasteTargetType);Dd.gridView.ha.selectionType=
-1;Dd.bud(Y,Td,Ra,xb,Oe);return Promise.resolve(!0)},function(Te){oc.ULS.sendTraceTag(537167815,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',Te?Dd.getStringifiedError(Te):"null",Y.copyPasteTargetType);return Dd.dAd(Te,Y,Td,Ra,xb,Oe)})};Ad.prototype.Whh=function(Y,Ra,xb,fc,bd){var Dd=this;bd=void 0===bd?!1:bd;Y.stopwatch=this.$.Vb.Hc("UserAction","DragDropInsertClientSide");this.b2b("DragDropInsert/before/"+Md.a[Y.ribbonCommandInfo.method],!1,void 0,void 0,Y.copyPasteTargetType).catch(function(){});
var Td=bd?2:1,we=vf.K(this.CZc([xb],Td)),Oe=this.$.ea.pa.sheetName,Te=this.$.ea.pa.sheetName,Zf=vf.v(Ra,this.$);Zf.SheetName=Oe;Oe=vf.v(we,this.$);Oe.SheetName=Te;fc=we.isRow||Ra.isRow||fc?1:0;var dg={encounteredDeploymentErrors:!1};Y.isDragInsert=!0;dg.commandParameters=Y;Y.userHash=this.userHash;Y.id=Gd.a.create().toString();bd=this.Vr.$hh(dg,Zf,Oe,bd,fc,Y.ribbonCommandInfo);var Jg=this;return Mc.c(bd.then(function(){oc.ULS.sendTraceTag(537167814,0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',
Y.copyPasteTargetType);Dd.gridView.ha.selectionType=-1;Dd.bud(Y,Td,Ra,xb,dg);return Promise.resolve(!0)},function(Ug){oc.ULS.sendTraceTag(537167813,0,10,'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',Ug?Jg.getStringifiedError(Ug):"null",Y.copyPasteTargetType);return Jg.dAd(Ug,Y,Td,Ra,xb,dg)})).CWR(function(){return!0})};Ad.prototype.Xci=function(Y,Ra){var xb=this,fc=bc(this.HK);if(!fc)return oc.ULS.sendTraceTag(537167812,0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),
Xf.Task.Ta(!1);if(!rc(fc.sourceItem))return oc.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),Xf.Task.Ta(!1);var bd=fc.sourceItem;if(!bd)return oc.ULS.shipAssertTag(537167810,0,!!bd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),Xf.Task.Ta(!1);if(!bd.isFromCurrentSession(this.$))return oc.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),Xf.Task.Ta(!1);if(1<bd.ranges.length)return oc.ULS.sendTraceTag(537167808,
0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.hza(2128,"InsertCopiedCutCells",!0),Xf.Task.Ta(!1);fc=vf.K(bd.ranges);var Dd=this.gridView.ha.va.Sd.clone();Y=vf.K(this.CZc([Dd],Y));var Td=this.xkf();bd=bd.sheetName;Dd=this.$.ea.pa.sheetName;var we=vf.v(fc,this.$);we.SheetName=bd;var Oe=vf.v(Y,this.$);Oe.SheetName=Dd;return(Y.Sh||fc.Sh?Xf.Task.Ta(0):Y.isRow||fc.isRow?Xf.Task.Ta(1):this.Yci.S3b(this.$,bf.g(this.$).rtl)).CWR(function(Te){return xb.Vr.executeInsertCopiedCutCellsOperation(we,
Oe,Td,Te.result,Ra)}).continueWith(function(){Td?xb.Vr.Xwb():xb.Ur("InsertCopiedCutCells/success/"+Md.a[Ra.method],!0)})};Ad.prototype.Wod=function(){var Y=bc(this.HK),Ra=this.gridView.ha.va.qh;return!!Y&&rc(Y.sourceItem)&&Ra&&1===Y.sourceItem.ranges.length};Ad.prototype.xkf=function(){return this.ykf(-911352779)};Ad.prototype.Yic=function(){return this.ykf(-1985798686)};Ad.prototype.QZc=function(Y,Ra){var xb=new Da.a(this.$.xa),fc=36===Y,bd=xb.te(4);Y=2===this.CAb()&&xb.te(1);fc=fc&&bd;xb=!xb.Oj||
!this.Yic()||!Da.a.G6b(Ra,bf.g(this.$));return fc||Y||this.$.Ns(Ra,!0)&&xb};Ad.prototype.mgc=function(Y,Ra){return this.Vr.mgc(Y,Ra)};Ad.prototype.dispose=function(){Ab.prototype.dispose.call(this);this.un();this.HK.removeMetadataChangeListener(Ad.Nqf)};Ad.prototype.j7c=function(Y,Ra,xb,fc,bd,Dd){if(!this.YYg(Y.commandParameters.ribbonCommandInfo.command))return Y.cseStatus=2,!1;if(Dd&&Ra.Qd(fc))return Y.cseStatus=4,!1;if(xb!==bd)return Y.cseStatus=6,!1;if(Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&
(fc.width%Ra.width||fc.height%Ra.height))return Y.cseStatus=16,!1;if(Kc.EwaSettings.getBooleanFeatureGate(He.a.OFe,!1)){if(xb=Ra,Ra=null===Ra.zf(this.gridView.Kh),bd=Y.commandParameters.ribbonCommandInfo.command,Ra&&1804571062!==bd&&-185374993!==bd)return Y.cseStatus=7,!1}else if(xb=Ra.zf(this.gridView.Kh),fc=fc.zf(this.gridView.Kh),!xb||!fc)return Y.cseStatus=7,!1;Ra=vf.v(xb,this.$);Ra=this.Gh.KYi(this.gridView,Ra,vf.v(fc,this.$),Y.commandParameters.ribbonCommandInfo.command,Y.commandParameters.stopwatch);
1===Ra&&(Dd&&(this.Gh.G0c(xb,!1),this.Gh.G0c(xb,!0)),-185374993===Y.commandParameters.ribbonCommandInfo.command&&bf.g(this.$).Z4i(),this.pasteIndicationManager.Vjd(Y.commandParameters.id),this.Ruc(Y.commandParameters.expandDestinations,Y.commandParameters.isPasteCommandFromRecoveryUI),this.yze("DoPasteClientEstimation/"+Md.a[Y.commandParameters.ribbonCommandInfo.method],Y));Y.cseStatus=Ra;return 1===Ra};Ad.prototype.xIf=function(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,!1,
!1,this.Lwi)};Ad.prototype.swi=function(Y,Ra,xb,fc){Y=sd(Y,Ra,xb,fc,this.$.ya.UserSessionId);Y.k=!0;af.b().Pe(45,Y,!0)};Ad.prototype.tRi=function(Y,Ra,xb,fc,bd){var Dd=!1,Td=!1,we=Ad.Hrb,Oe=Ad.$Je+Ad.UIa;Y&&(Oe+=Ad.lKa(Y),zd.a.er(Y.ewaErrors)?(we=this.Oac(Y.ewaErrors),zd.a.kh(Y.ewaErrors,[-103190598])&&(Dd=!0)):Y.message&&(we=Y.message));Td||(Td=this.ood(Y));Ra=sd(Ra,xb,fc,bd,this.$.ya.UserSessionId);Ra.k=!1;Ra.l=Td;Ra.n=we;Ra.p=Oe;Ra.q=Dd;af.b().Pe(45,Ra,!0);return Promise.reject(Y)};Ad.prototype.YYg=
function(Y){switch(Y){case 237279923:case 808159687:return He.a.rli;case -185374993:return!0;case 1804571062:return!0;default:return!1}};Ad.prototype.ykf=function(Y){var Ra=bc(this.HK);if(!Ra)return!1;var xb=Ra.sourceItem;return xb&&!xb.isFromCurrentSession(this.$)?(oc.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):Ra.commandParameters.ribbonCommandInfo.command===Y};Ad.prototype.Chh=function(){var Y=bc(this.HK);
return Y?(Y=Y.sourceItem)&&!Y.isFromCurrentSession(this.$)?(oc.ULS.sendTraceTag(537167778,0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1};Ad.prototype.yxj=function(Y){return Y&&Y.lastCopy?Jd(Y.lastCopy,this.$):!0};Ad.prototype.LZe=function(Y,Ra,xb,fc,bd){var Dd={};Dd.a=this.$.ya.UserSessionId;Dd.e=Y.stopwatch.id;Dd.c=af.b().ui(Y.ribbonCommandInfo.command);Dd.b=Md.a[Y.ribbonCommandInfo.method];Dd.d=Y.id;Dd.f=xb.toString();
Dd.g=fc.toString();Dd.h=Ra.toString();Dd.o=Y.stopwatch.Dc;Dd.q=!1;Dd.r=Y.copyPasteTargetType.toString();Dd.s=bd.encounteredDeploymentErrors;Kc.EwaSettings.getBooleanFeatureGate(He.a.S6b,!1)&&(Dd.i=bd.commandParameters.dragDropIsShiftKeyDown,Dd.j=bd.commandParameters.isDragInsert);return Dd};Ad.prototype.bud=function(Y,Ra,xb,fc,bd){Y=this.LZe(Y,Ra,xb,fc,bd);Y.k=!0;af.b().Pe(45,Y,!0)};Ad.prototype.Wui=function(Y,Ra,xb,fc,bd,Dd,Td,we,Oe){Y=this.LZe(Y,Ra,xb,fc,Oe);Y.k=!1;Y.l=bd;Y.n=Dd;Y.p=Td;Y.q=we;af.b().Pe(45,
Y,!0)};Ad.prototype.Fmf=function(Y,Ra,xb,fc,bd,Dd,Td,we,Oe){var Te={};Te.a=this.$.ya.UserSessionId;Te.b=Ra;Te.c=Y;Te.f=xb;Te.e=fc;Te.d=bd;Te.g=Dd;Te.h=Td;Te.i=we;Te.j=Oe.toString();af.b().Pe(46,Te,!0)};Ad.prototype.Qui=function(Y,Ra){Y=this.iZe(Y.commandParameters,Y);Y.l=!0;Y.j=Ra;af.b().Pe(43,Y,!0)};Ad.prototype.Pui=function(Y,Ra,xb,fc,bd,Dd,Td){Y=this.iZe(Y,Td);Y.l=!1;Y.m=Ra;Y.o=xb;Y.y=fc;Y.x=bd;Y.z=Dd;af.b().Pe(43,Y,!0);oc.ULS.sendTraceTag(537167776,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",
Y.y,Y.x,Y.m,Y.z,Y.o)};Ad.prototype.iZe=function(Y,Ra){var xb={};xb.a=this.$.ya.UserSessionId;xb.f=Y.stopwatch.id;xb.g=Y.id;xb.c=af.b().ui(Y.ribbonCommandInfo.command);xb.b=Md.a[Y.ribbonCommandInfo.method];xb.q=Y.stopwatch.Dc;xb.bd=Ad.X$b();xb.bg=Y.copyPasteHandlerName;xb.bj=void 0===Y.ribbonCommandInfo.af||null===Y.ribbonCommandInfo.af?null:ac.a[Y.ribbonCommandInfo.af];xb.bq=Y.uploadToClipService;xb.br=Y.floatingObjectType;xb.s=Y.copyPasteTargetType.toString();xb.bc=Ue(Y.copyPasteTargetType);xb.z=
!1;if(Ra){xb.bk=Ra.id;xb.bl=Ra.serverRequestTimeInMs;Ra.requestTelemetryData&&(xb.bm=Ra.requestTelemetryData.EcsOperationDuration,xb.bn=Ra.requestTelemetryData.EcsRequestDuration,xb.bo=Ra.requestTelemetryData.WfeRequestDuration);xb.d=Ra.sourceItem?Ra.sourceItem.toString():null;xb.e=-1;if(rc(Ra.sourceItem)){xb.e=0;Y=yl(Ra.sourceItem.ranges);for(var fc=Y.next();!fc.done;fc=Y.next())xb.e+=fc.value.pU}xb.h=Ra.isAsyncCopy;xb.i=Ra.isFromCache;xb.k=Ra.isSelectionAllowed;xb.r=Ra.plainTextPayloadSize;xb.u=
Ra.htmlPayloadSize;xb.v=Ra.htmlSizeExceedsLimit;xb.w=Ra.copyTotalSizeExceedsLimit;xb.t=Ra.shadowWorkbookPayloadSize;xb.p=Ra.clientSideCopyTime;xb.ba=Ra.encounteredDeploymentErrors;xb.bb=Ra.shadowWorkbookSizeExceedsLimit;xb.be=Ra.syncClipboardItemsKeys;xb.bf=Ra.asyncClipboardItemsKeys;xb.bh=this.QCe(Ra.succeededPopulatingSystemClipboardSync);xb.bi=this.QCe(Ra.succeededPopulatingSystemClipboardAsync)}return xb};Ad.prototype.Ruc=function(Y,Ra){Ra=void 0===Ra?!1:Ra;if(!this.gridView.isEditing&&!this.gridView.Ci){var xb=
this.gridView.ha.va,fc=!Ra&&1===Y.length&&vf.Q(Y,xb.selectedRanges),bd=fc?xb.activeCell:Y[0].topLeft;Y[0].contains(bd)||(oc.ULS.shipAssertTag(537167775,0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges {0}, IndexOfActiveRange {1}, ActiveCell {2}, calculatedDestinationRanges {3}, keepThePreviousActiveCell {4}, newActiveCell {5}, isPasteCommandFromRecoveryUI {6}",xb.selectedRanges,xb.aB,xb.activeCell,Y,fc,bd,Ra),bd=Y[0].topLeft);this.gridView.ha.uD(Y,0,bd,0,void 0,Df.a.P3g)}};Ad.prototype.b2e=
function(Y,Ra){var xb={};xb.a=this.$.ya.UserSessionId;xb.g=Y.stopwatch.id;xb.t=Y.stopwatch.Dc;xb.bz=!1;Ra&&(xb.bv=Ra.id,xb.bw=Ra.serverRequestTimeInMs,xb.n=Ra.commandParameters.clipboardFormatReadTimes,xb.o=Ra.commandParameters.clipboardFormatReadStatus,xb.p=Ra.commandParameters.clipboardReadPermissionPromptShown,xb.q=Ra.commandParameters.asyncApiReadTimedOut,Ra.requestTelemetryData&&(xb.cb=Ra.requestTelemetryData.EcsOperationDuration,xb.cc=Ra.requestTelemetryData.EcsRequestDuration,xb.cd=Ra.requestTelemetryData.WfeRequestDuration));
xb.x=Y.copyPasteTargetType.toString();xb.bl=Ue(Y.copyPasteTargetType);xb.br=Y.copyPasteHandlerName;xb.i=vf.i(Y.expandDestinations,",",this.$,!1);xb.h=vf.i(Y.originalDestinations,",",this.$,!1);xb.e=Y.id;xb.d=Y.commandType;xb.c=af.b().ui(Y.ribbonCommandInfo.command);xb.b=Md.a[Y.ribbonCommandInfo.method];xb.bf=!1;xb.bg=!1;xb.bp=Ad.X$b();xb.bt=void 0===Y.ribbonCommandInfo.af||null===Y.ribbonCommandInfo.af?null:ac.a[Y.ribbonCommandInfo.af];xb.cj=Y.isPasteCommandFromEnterShortcut;if(xb.ca=Y.isPasteCommandFromRecoveryUI)xb.cf=
Y.pasteRecoveryUndoStopwatch.id,xb.cg=Y.pasteRecoveryUndoStopwatch.Dc;if(Ra){if((Y=Ra.copyContextSnapshot)&&!Ra.wasLastCopyExternal){xb.f=Y.commandParameters.id;xb.j=Y.sourceItem.toString();xb.k=-1;if(rc(Y.sourceItem)){xb.k=0;for(var fc=yl(Y.sourceItem.ranges),bd=fc.next();!bd.done;bd=fc.next())xb.k+=bd.value.pU}xb.bg=1===Y.commandParameters.commandType}else Ra.clipboardItems?xb.f=Ra.clipboardItems.getItem(rb.g3c):oc.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");
xb.bz=Ra.pasteRecoveryUIDisplayed;xb.ci=Ra.cseStatus}else oc.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return xb};Ad.prototype.cwi=function(Y,Ra,xb,fc,bd,Dd,Td,we,Oe){Y=this.b2e(Y,we);Y.l=!1;Y.m=Ra;Y.s=xb;Y.bc=fc;Y.be=bd;Y.bd=Dd;Y.bf=Td;we?(Y.y=ld(we)||!we.copyContextSnapshot,Y.bi=!Y.y&&Jd(we.copyContextSnapshot,this.$),Y.bj=we.shadowWorkbookSizeExceedsLimit,Y.v=we.shadowWorkbookPayloadSize,Y.w=we.htmlPayloadSize,Y.bq=Me(we.clipboardItems),
Y.bb=we.activeSelectionType,Y.bs=we.isSameSession,Y.bn=we.payloadOrigin,Y.bo=we.payloadType,Y.bu=we.externalAppSource,Y.bx=we.indicationDisplayScheduled,Y.by=we.pasteIndicationDisplayStatus,Y.ck=we.pasteDestinationHasMergedCells):Y.bi=Jd(Oe,this.$);af.b().Pe(44,Y,!0);oc.ULS.sendTraceTag(537167772,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",Y.be,Y.bd,Y.m,Y.bf,Y.s)};Ad.prototype.dwi=function(Y){var Ra=
this.b2e(Y.commandParameters,Y);Ra.y=Y.wasLastCopyExternal;Ra.l=!0;Ra.u=Y.plainTextPayloadSize;Ra.v=Y.shadowWorkbookPayloadSize;Ra.w=Y.htmlPayloadSize;Ra.z=Y.isClipboardDataContainShadowWorkbook;Ra.ba=Y.isShadowWorkbookParsedSuccessfully;Ra.bb=Y.activeSelectionType;Ra.bc=Y.pasteResult;Ra.bh=Y.encounteredDeploymentErrors;Ra.bj=Y.shadowWorkbookSizeExceedsLimit;Ra.bk=qd(Y);Ra.bq=Me(Y.clipboardItems);Ra.bs=Y.isSameSession;Ra.bn=Y.payloadOrigin;Ra.bo=Y.payloadType;Ra.bu=Y.externalAppSource;Ra.bx=Y.indicationDisplayScheduled;
Ra.by=Y.pasteIndicationDisplayStatus;Ra.ck=Y.pasteDestinationHasMergedCells;Ra.bm=Y.clipboardItems?Y.clipboardItems.getItem(rb.LXg):null;Ra.bi=!Y.isSameSession&&!Y.wasLastCopyExternal;af.b().Pe(44,Ra,!0)};Ad.prototype.cl=function(){this.$.xa.Qf(this.ii);this.$.xa.Wne(this.qnc);this.$.userOperationManager.lx(this.ZR);this.$.Qk(this.rd);bf.g(this.$).yc.Yl(this.lEb)};Ad.prototype.un=function(){this.$&&this.$.xa&&(this.$.xa.ug(this.ii),this.$.xa.WQf(this.qnc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.jv(this.ZR);
this.gridView&&this.gridView.yc&&this.gridView.yc.ol(this.lEb)};Ad.prototype.VDb=function(Y,Ra){var xb=null,fc=!1,bd=null,Dd="UnknownFailure",Td=-1,we=Ad.Hrb,Oe=Ad.pasteErrorName+Ad.UIa,Te=!1;this.pasteIndicationManager.Vjd(Y.id);this.Rff&&this.pasteDestinationHasMergedCells(Y.expandDestinations)&&(Ra.pasteContext.pasteDestinationHasMergedCells=!0);var Zf=bc(this.HK);(Y.clearStateOnFinish||Y.clearSystemClipboard)&&this.Ur("Paste/fail/"+Md.a[Y.ribbonCommandInfo.method],!0,void 0,void 0,Y.copyPasteTargetType).catch(function(){});
if(Ra){Td=Ra.reason;Oe+=Ad.lKa(Ra);Ra.message&&(we=Ra.message);if(xb=Ad.g3g(Ra))if(1===xb.pasteErrorName)fc=!0,Dd="CopyPasteLengthTooLongPopup",we=bd="The pasted content is too long. Popup a dialog to the user.",oc.ULS.sendTraceTag(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',bd,Y.copyPasteTargetType),xb=zd.a.hd(1,0,26,677,0,1306609195,"CopyPasteOversizeError"),Kc.EwaSettings.oz()?new ud.a(this.$,xb):(xb=new Lc.ErrorDialog(this.$,xb),xb.initialize(),xb.mf());
else if(7===xb.pasteErrorName)fc=!0,Dd="No-Op",we=bd="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",oc.ULS.sendTraceTag(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',bd,Y.copyPasteTargetType);else if(8===xb.pasteErrorName)fc=!0,Dd="UseShortcutsPopup",we=bd="Unable to paste content from the system clipboard. Popup dialog to the user.",oc.ULS.sendTraceTag(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',
bd,Y.copyPasteTargetType),this.xIf();else if(18===xb.pasteErrorName){fc=!0;Dd="PasteExternalNotSupportMultipleSelectionPopup";we="Paste external not support multiple selection.";bd="Unknown";var dg=2128;100!==xb.validationFailureReason&&(bd=ah[xb.validationFailureReason],dg=Ad.JCe(xb.validationFailureReason));this.hza(dg,bd,!0)}else 20===xb.pasteErrorName||19===xb.pasteErrorName?(fc=!0,20===xb.pasteErrorName?(Dd="PasteAcrossSessionNotSupportMultipleSelectionPopup",we="Paste across session does not support multiple selection."):
(Dd="PasteInSameSessionNotSupportMultipleSelectionPopup",we="This kind of multiple selection is not supported for same session paste."),bd="Unknown",dg=2128,100!==xb.validationFailureReason&&(bd=ah[xb.validationFailureReason],dg=Ad.JCe(xb.validationFailureReason)),xb=6===xb.validationFailureReason,this.QZc(Y.commandType,Y.expandDestinations)&&xb&&this.Ruc(Y.expandDestinations),this.hza(dg,bd,!0)):6===xb.pasteErrorName?(fc=!0,Dd="No-Op",we=bd="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",
oc.ULS.sendTraceTag(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',bd,Y.copyPasteTargetType)):17===xb.pasteErrorName?(fc=!0,Dd="No-Op",we=bd="Paste text on Art is not yet a supported operation",oc.ULS.sendTraceTag(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',bd,Y.copyPasteTargetType)):16===xb.pasteErrorName?(fc=!0,Dd="No-Op",we=bd="Paste has failed because the previous copy has failed",oc.ULS.sendTraceTag(537167771,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',
bd,Y.copyPasteTargetType,this.getStringifiedError(xb))):zd.a.er(xb.ewaErrors)?(zd.a.b$(xb.ewaErrors)||zd.a.kh(xb.ewaErrors,zd.a.scc())?(fc=!0,Dd="CommunicationError",bd=zd.a.Tc(xb.ewaErrors),oc.ULS.sendTraceTag(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',we,Y.copyPasteTargetType)):zd.a.kh(xb.ewaErrors,Ad.ulj)?(fc=!0,Dd="SavingWorkbookError",bd=zd.a.Tc(xb.ewaErrors),oc.ULS.sendTraceTag(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',
we,Y.copyPasteTargetType)):zd.a.kh(xb.ewaErrors,Ad.operationSucceededWithAlert)&&(Te=fc=!0,Dd="OperationSucceededWithAlert",bd=zd.a.Tc(xb.ewaErrors),oc.ULS.sendTraceTag(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',we,Y.copyPasteTargetType)),fc||(we=this.Oac(xb.ewaErrors),fc=this.ood(Ra))):11===xb.pasteErrorName&&(fc=!0,Dd="No-Op",we="Paste has failed because user try copy cross-session oart object");15===Ra.reason&&(fc=!0,Dd="No-Op",we="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
gf.a.equals(Oe,Wd.HVj,!1)&&(fc=!0,Dd="No-Op",we="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}fc||oc.ULS.sendTraceTag(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Ra?this.getStringifiedError(Ra):"null",Y.copyPasteTargetType);this.cwi(Y,fc,we,Dd,Oe,Td,Te,Ra.pasteContext,Zf);return Promise.reject(Ra)};Ad.prototype.Pnc=function(Y,Ra){var xb;oc.ULS.sendTraceTag(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',
Ra.copyPasteTargetType);this.pasteIndicationManager.Vjd(Ra.id);if(this.PYi(Ra.copyPasteTargetType,Y)){Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Oc.a.MC&&Y.wasLastCopyExternal&&Y.payloadType===oe.EO&&(this.Z6a=!0);var fc=null;(null===(xb=Y.pastedRange)||void 0===xb?0:xb.Ranges)&&0<Y.pastedRange.Ranges.length?fc=vf.g(Y.pastedRange.Ranges):Y.wasLastCopyExternal||(fc=Ra.expandDestinations);this.jnj(Y,fc);if(this.uzj(Y,fc)){xb=qe.a.clone(Ra.originalDestinations);
fc=1028===Ra.commandType?qe.a.clone(Ra.expandDestinations):qe.a.clone(fc);var bd=null;Y.wasLastCopyExternal&&(Ra.isKeyboardEvent||Ra.isPasteCommandFromRecoveryUI)&&(bd={},bd=(bd[Ad.lHf]=Y.clipboardItems,bd));this.Rff&&this.pasteDestinationHasMergedCells(Ra.expandDestinations)&&(Y.pasteDestinationHasMergedCells=!0);Y.pasteRecoveryUIDisplayed=!0;var Dd=new Ke(this.$,xb,fc,bd),Td=Ph.GetServiceTaskFactory.Wa(this.$.da,406,405,0);Fb.TaskExtensions.Ba(Td,function(){var we=Td.result;we.tOg(Dd);we.GCj(Ra.ribbonCommandInfo.method)},
this.ma,3)}}this.yze("Paste/success/"+Md.a[Ra.ribbonCommandInfo.method],Y);this.dwi(Y);this.j3f&&(!Ra.isKeyboardEvent||qd(Y))&&this.$.ea.oh.get(66)&&(oc.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.j3f=!1,this.G4g());return Promise.resolve(!0)};Ad.prototype.uzj=function(Y,Ra){return!Ra||1!==Ra.length||Y.commandParameters.clearSystemClipboard||Y.commandParameters.clearStateOnFinish||Y.commandParameters.skipClipboardAccess?!1:
ld(Y)&&(Ra=Y.clipboardItems.getItem(rb.zW),Y=Y.clipboardItems.getItem(rb.html),void 0===Ra||null===Ra||Ra.length>this.Uvd||void 0===Y||null===Y||Y.length>this.WNa)?(oc.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0};Ad.prototype.PYi=function(Y,Ra){return 1===Y||Ra.payloadType===oe.zW||Kc.EwaSettings.la(162)&&Ra.payloadType===oe.html||Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!Oc.a.MC&&Ra.payloadType===oe.EO};Ad.prototype.pasteDestinationHasMergedCells=function(Y){var Ra=bf.g(this.$).Ca.XE();if(!Ra||!Ra.length)return!1;Ra=yl(Ra);for(var xb=Ra.next();!xb.done;xb=Ra.next())if(xb.value.gw(Y[0]))return!0;return!1};Ad.prototype.yze=function(Y,Ra){var xb=this,fc;(function(){var bd=xb.Ngi(Ra);fc=bd.SGa;return bd})().returnValue&&this.Ur(Y,fc,void 0,void 0,Ra.commandParameters.copyPasteTargetType).catch(function(){})};Ad.prototype.dAd=function(Y,Ra,xb,fc,bd,Dd){oc.ULS.sendTraceTag(24150918,
0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",Y?this.getStringifiedError(Y):"null");var Td=!1,we=!1,Oe=!1,Te=Ad.Hrb,Zf=Ad.$Je+Ad.UIa;Y&&(Zf+=Ad.lKa(Y),zd.a.er(Y.ewaErrors)?(Te=this.Oac(Y.ewaErrors),zd.a.kh(Y.ewaErrors,Ad.operationSucceededWithAlert)&&(Td=!0),zd.a.kh(Y.ewaErrors,Ad.dragDropNonEmptyRange)&&(we=Oe=!0)):Y.message&&(Te=Y.message));Oe||(Oe=this.ood(Y));we?this.gridView.ha.selectionType=-1:this.Vr.l8i(bd);this.Wui(Ra,xb,fc,bd,Oe,Te,Zf,Td,Dd);return Promise.reject(Y)};Ad.prototype.CZc=
function(Y,Ra){var xb=Y,fc=this.WSh();if(null===fc||void 0===fc?0:fc.ranges)xb=this.Vr.WTg(Ra,fc.ranges,Y);return xb};Ad.prototype.WSh=function(){var Y=bc(this.HK);return Y&&rc(Y.sourceItem)?Y.sourceItem:null};Ad.prototype.m5i=function(){this.raiseEvent(Ad.TBd,null)};Ad.prototype.jnj=function(Y,Ra){var xb=Y.commandParameters.originalDestinations;Ra&&(vf.Q(this.gridView.ha.va.selectedRanges,xb)?(this.Ruc(Ra),oc.ULS.sendTraceTag(537167767,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",
Ge.HelperMethods.hob(Ra))):Y.commandParameters.isPasteCommandFromRecoveryUI?(this.Ruc(Ra,!0),oc.ULS.sendTraceTag(537167766,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: {0}, active cell: {1}",Ra,Ra[0].topLeft)):oc.ULS.sendTraceTag(537167765,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}",Ge.HelperMethods.hob(xb)))};
Ad.prototype.Ngi=function(Y){if(Y.isPlainTextPaste||Y.isHtmlPaste||zc(Y)||Y.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,SGa:!1};var Ra=Y.copyContextSnapshot;if(Y.commandParameters.clearStateOnFinish)return{returnValue:!0,SGa:!0};if(Ra&&rc(Ra.sourceItem)){var xb=Ra.sourceItem;if(!xb.isFromCurrentSession(this.$))return{returnValue:!1,SGa:!0};Ra=-1985798686===Ra.commandParameters.ribbonCommandInfo.command;if(!(1<xb.ranges.length||1<Y.commandParameters.expandDestinations.length)){var fc=
vf.K(xb.ranges);Y=vf.K(Y.commandParameters.expandDestinations);var bd=this.$.ea.pa.sheetName;xb=xb.sheetName;if(xb===bd&&Y.equals(fc))return{returnValue:!1,SGa:!0};if(xb===bd&&Y.zf(fc))return{returnValue:!0,SGa:!1}}return{returnValue:Ra,SGa:!0}}return{returnValue:!1,SGa:!0}};Ad.prototype.oEf=function(){var Y=bc(this.HK);(Y=this.Vr.Kvb(Y))&&Y.isFromCurrentSession(this.$)&&this.Ur("OnStartEdit",!1).catch(function(){})};Ad.prototype.Oac=function(Y){Y=zd.a.FPh(Y,Ad.UIa);return this.VAi+Yf.a.Qv(Y).toString()};
Ad.prototype.ood=function(Y){Y=Ad.lKa(Y);return!!Y&&gf.a.T1a(Y,Ad.UAi)};Ad.prototype.G4g=function(){var Y=zd.a.hd(1,2,328,329,Oc.a.ep?330:Oc.a.MH?331:332,530046625,"ActivateLocalStorage"),Ra=Ph.GetServiceTaskFactory.Wa(this.$.da,5,4,0);Fb.TaskExtensions.Ba(Ra,function(){Ra.result.ig(41,Y)},this.ma,3)};Ad.prototype.QCe=function(Y){return void 0===Y||null===Y?Sd.uEi:Y?Sd.success:Sd.failed};Ad.g3g=function(Y){var Ra=Y.innerError;return Ra&&0!==Ra.pasteErrorName?Y.innerError:null};Ad.U2g=function(Y){var Ra=
Y.innerError;return Ra&&0!==Ra.copyErrorName?Y.innerError:null};Ad.lKa=function(Y){var Ra="";if(!Y)return Ad.aHe;Y.errorName&&(Ra=Y.errorName,Y.innerError&&(Ra+=Ad.UIa+Ad.lKa(Y.innerError)));Ra||(Ra=Y&&Y.name?Y.name:Ad.aHe);return Ra};Ad.X$b=function(){Ad.nLb||(Pf.a.egf()?Ad.nLb=se.TDj:Pf.a.wpd()?Ad.nLb=se.SDj:Ad.nLb=se.RDj);return Ad.nLb};Ad.JCe=function(Y){switch(Y){case 7:case 1:return 2135;case 5:return 2132;case 6:return 2131;case 8:case 3:case 2:case 4:case 9:case 10:return 2128;default:return oc.ULS.shipAssertTag(537167764,
0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",Y),2135}};Ad.V2g=function(Y){switch(Y){case 3:return 2129;case 1:return 2130;case 2:case 4:return 2128;default:return oc.ULS.shipAssertTag(537167763,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",Y),2135}};Sk.Object.defineProperties(Ad.prototype,{pasteIndicationManager:{configurable:!0,enumerable:!0,get:function(){return this.$.da.Aa(373)}}});
Ad.Nqf="EwaJsMetadataChangeListenerId";Ad.TBd="cpiOSC";Ad.Rch="cpiDID";Ad.Hrb="Unknown";Ad.aHe="UnknownError";Ad.UIa="_";Ad.$Je="DragAndDropError";Ad.pasteErrorName="PasteError";Ad.ZUg="CancelError";Ad.copyErrorName="CopyError";Ad.UAi="MergedCellOverlap";Ad.lHf="PasteRecoveryCachedClipboardItems";Ad.ulj=[1352631530,1679665408];Ad.operationSucceededWithAlert=[-103190598];Ad.pasteDataLimitHit=[1306609195];Ad.copyThrottlingError=[-386183710];Ad.dragDropNonEmptyRange=[563945982];Ad.nLb=null;Object(Yc.a)(Ad,
"CopyPasteInfrastructure",dd.a,[861,862,3]);Object(Yc.a)(xd,"ClipboardPlatformInitializationResult",null,[]);var nc=b(686),Rd=b(120),Je=b(4),he=b(81);Object(Yc.a)(md,"MacroRecorderPasteRangePayload",null,[147]);jc.prototype.getContent=function(){return this.content};Object(Yc.a)(jc,"MacroRecorderPasteStringPayload",null,[147]);var Ff=b(61);Object(Yc.a)(Yb,"MacroRecorderPastePayload",null,[147]);var Fe=b(603),Tf=b(911),Hd=b(521),Ye=b(164),Fd=b(200),ve=b(114),jg=b(272),Kf=b(336);Ua.prototype.getParameters=
function(){return this.parameters};Object(Yc.a)(Ua,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[147]);var td=b(369);sa.prototype.copy=function(Y,Ra,xb,fc,bd){function Dd(Te,Zf,dg){var Jg={CopyPasteTargetType:1};Jg.SourceRanges=Y;Jg.CopyOperationId=Ra.id;oc.ULS.sendTraceTag(537167756,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : {0}, CopyOperationId : {1}",Td.vMa,Jg.CopyOperationId);Td.eNa=Td.vMa?Zc(Td.$.na.xx,Jg,jg.b(Te,xb),fc?jg.a(Zf,fc):Zf,dg,Ra.ribbonCommandInfo,we,bd):
Zc(Td.$.na.ta,Jg,jg.b(Te,xb),fc?jg.a(Zf,fc):Zf,dg,Ra.ribbonCommandInfo,we,bd);return Td.eNa}var Td=this;fc=void 0===fc?null:fc;bd=void 0===bd?null:bd;var we=this.$.na.ta.Zb();this.Mmd&&this.oY();this.Nic=we.ClientRequestId;var Oe=Kc.EwaSettings.sc()?new Ye.a(505,0,Dd,80):new Hd.a(505,0,Dd,16);Oe=this.$.userOperationManager.hc(Oe,Ra.ribbonCommandInfo);this.Mmd&&this.ev.add(Oe)};sa.prototype.kHf=function(Y,Ra,xb,fc,bd,Dd){var Td=this;return new Promise(function(we,Oe){var Te,Zf=Dd.commandParameters.stopwatch.Dc,
dg=2;20===Dd.commandParameters.commandType&&(dg=16);36===Dd.commandParameters.commandType&&(dg=32);Pf.a.wpd()&&68===Dd.commandParameters.commandType&&(dg=64);Pf.a.Jrd(Td.$)&&1028===Dd.commandParameters.commandType&&(dg=1024);var Jg=null;if(null===(Te=Dd.copyContextSnapshot)||void 0===Te?0:Te.commandParameters)Jg=Dd.copyContextSnapshot.commandParameters.id;sa.INd(Td.$,Y,fc,Ra,xb,null,function(Ug){sa.Qcc(Ug,Dd,we,Oe,Zf,Td.$)},function(Ug){Dd.serverRequestTimeInMs=Dd.commandParameters.stopwatch.Dc-Zf;
Ug=ve.a.og(Ug.data);Oe(new Tf.a(5,Ug))},bd,dg,Jg,Dd.commandParameters.id)})};sa.prototype.pasteRange=function(Y,Ra,xb,fc,bd,Dd,Td,we){var Oe=this;return new Promise(function(Te,Zf){var dg=Td.commandParameters.stopwatch.Dc;sa.yoj(Oe.$,Y,Ra,xb,fc|-5&bd,function(Jg){sa.Qcc(Jg,Td,Te,Zf,dg,Oe.$)},function(Jg){Td.serverRequestTimeInMs=Td.commandParameters.stopwatch.Dc-dg;Jg=ve.a.og(Jg.data);Zf(new Tf.a(5,Jg))},Dd,we)})};sa.prototype.I2i=function(Y,Ra,xb,fc,bd,Dd,Td){var we=this;return new Promise(function(Oe,
Te){if(Ra)if(Ra.length>we.WNa){var Zf=Td.clipboardItems.getItem(rb.zW),dg=-1;void 0!==Zf&&null!==Zf&&(dg=Zf.length);oc.ULS.sendTraceTag(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}, PlainTextLength: {2}",Ra.length,we.WNa,dg);Te(new Tf.a(1))}else Zf=function(Jg,Ug,Xh){we.$.oy();var Ef=Td.commandParameters.stopwatch.Dc;Jg=jg.b(Jg,function(Hi){sa.Qcc(Hi,Td,Oe,Te,Ef,we.$,Ra)});Ug=jg.a(Ug,function(Hi){Td.serverRequestTimeInMs=
Td.commandParameters.stopwatch.Dc-Ef;Hi=ve.a.og(Hi.data);Te(new Tf.a(3,Hi))});var Th=we.$.na.ta.Zb(),sh=vf.v(Y,we.$),Mg={};Mg.SourceHtml=Ra;Mg.DestinationRanges=sh?vf.s(sh):null;Mg.CopyOperationId=xb;Mg.PasteId=fc;oc.ULS.sendTraceTag(537167755,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",we.vMa,Mg.PasteId);return we.vMa?fd(we.$.na.xx,Mg,Jg,Ug,Xh,null,Th,Dd):fd(we.$.na.ta,Mg,Jg,Ug,Xh,null,Th,Dd)},Zf=Kc.EwaSettings.sc()?new Ye.a(204,0,Zf,65):new Hd.a(204,
0,Zf,1),we.$.userOperationManager.hc(Zf,bd);else Oe("")})};sa.prototype.J2i=function(Y,Ra,xb,fc,bd){var Dd=this;return new Promise(function(Td,we){oc.ULS.sendTraceTag(537167754,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",bd.id);Ra&&(Ra=gf.a.trimEnd(Ra,"\n","\r"));oc.ULS.sendTraceTag(537167753,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",bd.id);if(Ra){var Oe=Dd.Uvd;if(Ra.length>
Oe)oc.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Ra.length,Oe),we(new Tf.a(1));else{var Te=vf.v(Y,Dd.$);oc.ULS.sendTraceTag(537167752,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",bd.id);Oe=!Dd.$.ea.isNamedObjectViewMode&&!Ra.includes("\n")&&!Ra.includes("\t");oc.ULS.sendTraceTag(537167751,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",
bd.id,Oe);Oe=Oe&&gf.a.Fff(Ra);oc.ULS.sendTraceTag(537167750,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",bd.id,Oe);var Zf=Dd.$.na.ta.Zb();if(Oe){var dg=526;oc.ULS.sendTraceTag(537167749,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",bd.id);var Jg=Fd.a.tbd(Ra);oc.ULS.sendTraceTag(537167748,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",
bd.id);var Ug=vf.s(Te);Oe=function(Ef,Th,sh){var Mg=bd.commandParameters.stopwatch.Dc;Ef=jg.b(Ef,function(Hi){oc.ULS.sendTraceTag(537167747,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",bd.id);bd.requestTelemetryData=Hi.RequestTelemetryData;bd.serverRequestTimeInMs=bd.commandParameters.stopwatch.Dc-Mg;Hi.Errors&&0<Hi.Errors.length?we(new Tf.a(2,Hi.Errors)):Td(Ra)});Th=jg.a(Th,function(Hi){bd.serverRequestTimeInMs=bd.commandParameters.stopwatch.Dc-
Mg;Hi=ve.a.og(Hi.data);we(new Tf.a(2,Hi))});Dd.$.oy();oc.ULS.sendTraceTag(537167746,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",bd.id);return he.c(Dd.$.na.ta,Ug,Ra,Jg,!1,!1,63,Ef,Th,sh,Y,Zf,fc)};var Xh=function(){return new Fe.a(Ug,Ra,Jg)}}else dg=180,Oe=function(Ef,Th,sh){Dd.$.oy();var Mg=bd.commandParameters.stopwatch.Dc;Ef=jg.b(Ef,function(Hi){oc.ULS.sendTraceTag(537167745,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",
bd.id);sa.Qcc(Hi,bd,Td,we,Mg,Dd.$,Ra)});Th=jg.a(Th,function(Hi){bd.serverRequestTimeInMs=bd.commandParameters.stopwatch.Dc-Mg;Hi=ve.a.og(Hi.data);we(new Tf.a(4,Hi))});oc.ULS.sendTraceTag(537167744,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",bd.id);return Qb(Dd.$.na.ta,Te,Ra,Ef,Th,sh,null,Zf,fc)},Xh=function(){return new jc(Te,Ra)};oc.ULS.sendTraceTag(537167715,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",
bd.id);Oe=Kc.EwaSettings.sc()?new Ye.a(dg,0,Oe,65,Xh):new Hd.a(dg,0,Oe,1,Xh);oc.ULS.sendTraceTag(537167714,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",bd.id);Dd.$.userOperationManager.hc(Oe,xb)}}else Td("")})};sa.prototype.H9e=function(Y,Ra){Ra=[1===Ra?4:5];this.gridView.Nb.ry(Kf.a.Z0(Ff.d(this.$.pa),Y),Ra,!0);this.gridView.Nb.ys(Ra);this.gridView.Nb.update(!0)};sa.prototype.Xwb=function(){var Y=[4,5];this.gridView.Nb.ll(Y,!1,!this.Ygc);this.gridView.Nb.Nl(null,
Y,!this.Ygc);1===this.gridView.ha.Ve&&this.gridView.ys(!1,!this.Ygc);this.Ygc&&this.gridView.Nb.update(!1,!1)};sa.prototype.WTg=function(Y,Ra,xb){var fc=[];xb=yl(xb);for(var bd=xb.next();!bd.done;bd=xb.next())Array.add(fc,this.ZTg(Y,Ra,bd.value));return fc};sa.prototype.oY=function(){if(this.ev)for(var Y=yl(this.ev),Ra=Y.next();!Ra.done;Ra=Y.next())Ra=Ra.value,this.$&&this.$.userOperationManager&&(Ra.operation&&oc.ULS.sendTraceTag(526758675,0,50,"CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",
Rd.a(Ra.operation.operationName)),this.XUg(),this.$.userOperationManager.iIa(Ra))};sa.prototype.XUg=function(){if(this.eNa){var Y=this.eNa.Ft;oc.ULS.sendTraceTag(526758674,0,15,"Cancelling pending copy request with Id={0}",Y);ve.a.ou(Y);this.Nic&&he.j(this.$.na.ta,this.Nic,null,null,null);this.Nic=this.eNa=null}};sa.prototype.HF=function(Y,Ra){2===Ra.Bw?(this.ev.clear(),this.eNa=null):1===Ra.Bw&&this.ev&&this.ev.contains(Ra.Pg)&&(oc.ULS.sendTraceTag(526758673,0,50,"CopyPasteUtils.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",
Rd.a(Ra.Pg.operation.operationName),Ra.Pg.dequeueUtcTime.getTime()-Ra.Pg.enqueueUtcTime.getTime()),this.ev.remove(Ra.Pg),this.eNa=null)};sa.prototype.ZTg=function(Y,Ra,xb){oc.ULS.shipAssertTag(537167713,0,!!Ra,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");oc.ULS.shipAssertTag(537167712,0,0<Ra.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");var fc=0,bd=0,Dd=new Set,Td=new Set;Ra=yl(Ra);for(var we=Ra.next();!we.done;we=Ra.next()){we=
we.value;var Oe=String.format("{0}_{1}",we.left,we.right),Te=String.format("{0}_{1}",we.top,we.bottom);Td.has(Oe)||(Td.add(Oe),bd+=we.width);Dd.has(Te)||(Dd.add(Te),fc+=we.height)}if(36===Y)return xb.isSingle?sa.xSe(bd,fc,xb):xb.clone();516===Y&&(Y=fc,fc=bd,bd=Y);Y=!(xb.width%bd)&&!(xb.height%fc);Dd=xb.i_&&!(xb.height%fc);xb.C5&&!(xb.width%bd)||Dd?xb=sa.xSe(bd,fc,xb):Y?xb=xb.clone():(xb=xb.clone(),xb.bottom=Math.min(Ud.a.Lh,xb.top+fc-1),xb.right=Math.min(Ud.a.Xh,xb.left+bd-1));return xb};sa.prototype.oLg=
function(Y,Ra,xb,fc,bd,Dd,Td,we,Oe,Te,Zf){if(!fc||!fc.length)return 1;if(1<fc.length){if(!this.Ifc&&Dd)return 3;if(Te)return 0;if(we)return 9;if(Oe)return 8;if(Zf)return 2;if(1<Ra.length)return 4;var dg=Ra[0];if(!Td&&!qe.a.all(fc,function(Jg){return Jg.isSingle||!(Jg.width%dg.width)&&!(Jg.height%dg.height)}))return 5;if((!this.Ifc||!Dd)&&gf.a.equals(Y,xb,!0))for(bd=yl(bd),Y=bd.next();!Y.done;Y=bd.next())if(Y=Y.value,Y.Qd(dg)&&!Y.equals(dg))return 6}else if(Ra&&0<Ra.length){if(0!==this.udf(Ra,Oe))return 7;
if(1<Ra.length){if(!this.Ifc&&Dd)return 3;if((!this.Ifc||!Dd)&&gf.a.equals(Y,xb,!0))for(Y=yl(Ra),Ra=Y.next();!Ra.done;Ra=Y.next())if(Ra=Ra.value,xb=bd[0],Ra.Qd(xb)&&!Ra.equals(xb))return 6}}return 0};sa.prototype.udf=function(Y,Ra){if(!Y||1>=Y.length)return 0;if(Ra)return 2;if(!vf.S(Y))return 1;Ra=new nc.a(Ae.a.Hk());for(var xb=yl(Y),fc=xb.next();!fc.done;fc=xb.next()){fc=fc.value;for(var bd=yl(Y),Dd=bd.next();!Dd.done;Dd=bd.next()){Dd=Dd.value;var Td=fc.top===Dd.top&&fc.bottom===Dd.bottom,we=fc.left===
Dd.left&&fc.right===Dd.right,Oe=Math.max(fc.left,Dd.left)<Math.min(fc.right,Dd.right);if(Math.max(fc.top,Dd.top)<Math.min(fc.bottom,Dd.bottom)&&!Td||Oe&&!we)return 3;Ra.add(String.format("{0}-{1}-{2}-{3}",fc.top,fc.bottom,Dd.left,Dd.right));Ra.add(String.format("{0}-{1}-{2}-{3}",Dd.top,Dd.bottom,fc.left,fc.right))}}Y=yl(Y);for(xb=Y.next();!xb.done;xb=Y.next())xb=xb.value,Ra.remove(String.format("{0}-{1}-{2}-{3}",xb.top,xb.bottom,xb.left,xb.right));return 0<Ra.count?3:0};sa.prototype.l8i=function(Y){var Ra=
this.gridView.ha;Ra.updateSelection(Y,Y.topLeft,0);Ra.selectionType=-1};sa.prototype.Kvb=function(Y){if(null===Y||void 0===Y?0:Y.sourceItem){if(!rc(Y.sourceItem))return null;if((Y=Y.sourceItem)&&vf.cb(Y.ranges,!0))return Y}return null};sa.prototype.mgc=function(Y,Ra){oc.ULS.shipAssertTag(537167711,0,!!Y,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Ra&&Je.a.CI in Ra||Y.tabName?!1:1===Y.method};sa.yoj=function(Y,Ra,xb,fc,bd,Dd,Td,we,Oe){function Te(){return new md(xb,
fc,bd)}function Zf(Jg,Ug,Xh){Y.oy();var Ef=Y.na.ta;Jg=jg.b(Jg,Dd);Ug=jg.a(Ug,Td);var Th=we;Th=void 0===Th?null:Th;var sh=Ef.Na(9,dg);sh.sourceRanges=xb;sh.destinationRanges=fc;sh.flags=bd;return he.i(Ef,"PasteRange",sh,Jg,Ug,Xh,null,64,Th)}var dg=Y.na.ta.Zb(Oe);Oe=Kc.EwaSettings.sc()?new Ye.a(506,0,Zf,65,Te):new Hd.a(506,0,Zf,1,Te);Y.userOperationManager.hc(Oe,Ra)};sa.Qcc=function(Y,Ra,xb,fc,bd,Dd,Td){Td=void 0===Td?null:Td;oc.ULS.sendTraceTag(537167710,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",
Ra.id);Ra.requestTelemetryData=Y.RequestTelemetryData;Ra.serverRequestTimeInMs=Ra.commandParameters.stopwatch.Dc-bd;zd.a.lh(Y.Errors)?zd.a.iha(Y.Errors)?(Ra&&(Ra.encounteredDeploymentErrors=!0),oc.ULS.sendTraceTag(537167707,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",zd.a.Tc(Y.Errors))):fc(new Tf.a(5,Y.Errors)):Y.Result?(fc=!!Y&&!!Y.RequestTelemetryData,bf.g(Dd).Mi.Bla(Ra.commandParameters.stopwatch.id,
Y.StateId,fc?Y.RequestTelemetryData.EcsOperationDuration:0,fc?Y.RequestTelemetryData.EcsRequestDuration:0,fc?Y.RequestTelemetryData.WfeRequestDuration:0),Ra.pastedRange=Y.Result.SheetMultiRange,oc.ULS.sendTraceTag(537167708,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",Ra.id),xb(!0)):(oc.ULS.sendTraceTag(537167709,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",
Ra.id),xb(Td||!0))};sa.INd=function(Y,Ra,xb,fc,bd,Dd,Td,we,Oe,Te,Zf,dg){function Jg(){return new Yb(Ef)}function Ug(Th,sh,Mg){Y.oy();return jd(Y.na.ta,Ef,jg.b(Th,Td),jg.a(sh,we),Mg,Dd,Xh,Oe)}var Xh=Y.na.ta.Zb(),Ef=sa.E8g(xb,fc,bd,Te,Zf,dg);xb=Kc.EwaSettings.sc()?new Ye.a(503,0,Ug,65,Jg):new Hd.a(503,0,Ug,1,Jg);Y.userOperationManager.hc(xb,Ra)};sa.E8g=function(Y,Ra,xb,fc,bd,Dd){var Td={};Td.ShadowWorkbookBase64=Y.shadowWorkbookBase64;Td.SourceRanges={};Td.SourceRanges.Ranges=Array(1);Td.SourceRanges.Ranges[0]=
{};Td.SourceRanges.Ranges[0].FirstRow=Y.rangeRowStart;Td.SourceRanges.Ranges[0].LastRow=Y.rangeRowEnd;Td.SourceRanges.Ranges[0].FirstColumn=Y.rangeColumnStart;Td.SourceRanges.Ranges[0].LastColumn=Y.rangeColumnEnd;Kc.EwaSettings.getBooleanFeatureGate(He.a.D4b,!1)?xb?Td.DestinationRanges=vf.u(xb.SheetName,xb.NamedObjectName,vf.g(xb.Ranges)):(oc.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),Td.DestinationRanges=null):Td.DestinationRanges=
Ra?vf.s(Ra):null;Td.CopyPasteTargetType=1;Td.PasteType=fc;Td.CopyOperationId=bd;Td.PasteId=Dd;Td.SourceClientPath=Y.sourceClientPath;Td.SourceSheetName=Y.sourceSheetName;Td.SourceWorkbookName=Y.sourceWorkbookName;if(!Y.originalSourceRangesCountExceedsLimit&&Y.originalSourceRanges&&0<Y.originalSourceRanges.length&&1024===fc){Td.OriginalSourceMultiRange={};Ra=Array(Y.originalSourceRanges.length);for(xb=0;xb<Ra.length;++xb)Ra[xb]={},Ra[xb].FirstRow=Y.originalSourceRanges[xb][0],Ra[xb].FirstColumn=Y.originalSourceRanges[xb][1],
Ra[xb].LastRow=Y.originalSourceRanges[xb][2],Ra[xb].LastColumn=Y.originalSourceRanges[xb][3];Td.OriginalSourceMultiRange.Ranges=Ra}return Td};sa.xSe=function(Y,Ra,xb){xb=xb.clone();xb.height<Ra&&(xb.bottom=Math.min(Ud.a.Lh,xb.top+Ra-1));xb.width<Y&&(xb.right=Math.min(Ud.a.Xh,xb.left+Y-1));return xb};sa.prototype.executeInsertCopiedCutCellsOperation=function(Y,Ra,xb,fc,bd,Dd,Td){function we(){return new Ua(Oe)}Dd=void 0===Dd?null:Dd;Td=void 0===Td?null:Td;var Oe={};Oe.InsertDirection=fc;Oe.SourceRange=
Y;Oe.DestRange=Ra;Oe.CopyCutOperation=xb?0:1;var Te=this.$.na.ta;return td.a(this.$.userOperationManager,function(Zf,dg,Jg){Zf=Dd?jg.b(Zf,Dd):Zf;dg=Td?jg.a(dg,Td):dg;var Ug=Te.Na(41,null);Ug.insertCopiedCutCellsParameters=Oe;return he.i(Te,"InsertCopiedCutCells",Ug,Zf,dg,Jg,null,4)},function(Zf){return new Ye.a(104,0,Zf,void 0,we)},bd)};sa.prototype.$hh=function(Y,Ra,xb,fc,bd,Dd){var Td=this;return new Promise(function(we,Oe){function Te(dg){dg=ve.a.og(dg.data);Oe(new Tf.a(21,dg))}function Zf(dg){Y.requestTelemetryData=
dg.RequestTelemetryData;dg.Errors&&0<dg.Errors.length?Oe(new Tf.a(21,dg.Errors)):we(!0)}Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:6126613_RemoveClearingRunningAntsICCCForDragInsert")?Td.executeInsertCopiedCutCellsOperation(Ra,xb,fc,bd,Dd,Zf,Te):Td.executeInsertCopiedCutCellsOperation(Ra,xb,fc,bd,Dd,Zf,Te).continueWith(function(){if(fc)Td.Xwb();else{var dg=Td.$.da.Aa(254);dg&&dg.b2b("DragDropInsert/success/"+Md.a[Dd.method],!0)}})})};Sk.Object.defineProperties(sa.prototype,{Uvd:{configurable:!0,
enumerable:!0,get:function(){oc.ULS.sendTraceTag(537167757,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.$.ya.MaxCopyPasteLength);return this.$.ya.MaxCopyPasteLength}},WNa:{configurable:!0,enumerable:!0,get:function(){return this.vMa?Kc.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.ya.CopyPasteMaxPayloadLength):Ud.a.WNa}}});Object(Yc.a)(sa,"CopyPasteUtils",null,[860]);var qf=b(498),Ch;
(function(Y){Y[Y.range=0]="range";Y[Y.art=1]="art"})(Ch||(Ch={}));Object(Yc.b)("SourceItemType",Ch);var Uf=b(24),Rg=b(92);Lb.prototype.serializeSourceItem=function(Y){var Ra={};if(Y&&Object.getType(Y)===nd)Ra.sheetName=Y.sheetName,Ra.topArray=qe.a.map(Y.ranges,function(xb){return xb.top}),Ra.leftArray=qe.a.map(Y.ranges,function(xb){return xb.left}),Ra.bottomArray=qe.a.map(Y.ranges,function(xb){return xb.bottom}),Ra.rightArray=qe.a.map(Y.ranges,function(xb){return xb.right}),Ra.sessionStateId=Y.sessionStateId,
Ra.sessionId=Y.sessionId,Ra.sourceItemType=this.pYf(0);else if(Y&&Object.getType(Y)===me)Ra.activeFloatingObjectControlId=Y.activeFloatingObjectControlId,Ra.sheetName=Y.sheetName,Ra.sessionStateId=Y.sessionStateId,Ra.sessionId=Y.sessionId,Ra.floatingObjectType=this.$oj(Y.type),Ra.sourceItemType=this.pYf(1);else return oc.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(Ra)};Lb.prototype.serializeCommandParameters=
function(Y){if(!Y)return oc.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var Ra={};Ra.id=Y.id;Ra.commandType=Y.commandType;Ra.copyPasteTargetType=Y.copyPasteTargetType;Y.ribbonCommandInfo&&(Ra.ribbonCommandName=this.hpj(Y.ribbonCommandInfo.command),Ra.inputMethodName=this.bpj(Y.ribbonCommandInfo.method),Ra.frameModeName=this.apj(Y.ribbonCommandInfo.mode),Ra.uiLocationName=this.kpj(Y.ribbonCommandInfo.af),Ra.tabName=Y.ribbonCommandInfo.tabName);
return JSON.stringify(Ra)};Lb.prototype.deserializeSourceItem=function(Y){if(!Y)return null;try{var Ra=JSON.parse(Y);if(!Ra)return oc.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),null;var xb=null;switch(this.Rdh(Ra.sourceItemType)){case 0:xb=new nd(this.$,this.Odh(Ra),Ra.sheetName,Ra.sessionStateId,Ra.sessionId);break;case 1:xb=new me(Ra.activeFloatingObjectControlId,Ra.sheetName,Ra.sessionStateId,Ra.sessionId,this.Ldh(Ra.floatingObjectType))}return xb}catch(fc){return oc.ULS.sendTraceTag(537167702,
0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",Y?Y.length:0,fc),null}};Lb.prototype.deserializeCommandParameters=function(Y){if(!Y)return null;try{var Ra=JSON.parse(Y);if(!Ra)return oc.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;var xb=vg.a();xb.id=Ra.id;xb.ribbonCommandInfo=this.Qdh(Ra);xb.commandType=Ra.commandType;xb.copyPasteTargetType=
Ra.copyPasteTargetType;return xb}catch(fc){return oc.ULS.sendTraceTag(537167700,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",Y?Y.length:0,fc),null}};Lb.prototype.Odh=function(Y){var Ra=[];oc.ULS.shipAssertTag(537167699,0,!!Y.topArray&&0<Y.topArray.length,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",Y.topArray?"empty":"null");oc.ULS.shipAssertTag(537167698,0,!!Y.leftArray&&
0<Y.leftArray.length,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",Y.leftArray?"empty":"null");oc.ULS.shipAssertTag(537167697,0,!!Y.bottomArray&&0<Y.bottomArray.length,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",Y.bottomArray?"empty":"null");oc.ULS.shipAssertTag(537167696,0,!!Y.rightArray&&0<Y.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",Y.rightArray?"empty":"null");if(!(Y.topArray&&
Y.leftArray&&Y.bottomArray&&Y.rightArray))return Ra;oc.ULS.shipAssertTag(537167695,0,Y.topArray.length===Y.bottomArray.length&&Y.topArray.length===Y.leftArray.length&&Y.topArray.length===Y.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",Y.topArray.length,Y.bottomArray.length,Y.leftArray.length,Y.rightArray.length);for(var xb=Math.min(Y.topArray.length,Y.bottomArray.length,Y.leftArray.length,
Y.rightArray.length),fc=0;fc<xb;fc++)Array.add(Ra,new Uf.Range(Y.topArray[fc],Y.leftArray[fc],Y.bottomArray[fc],Y.rightArray[fc],!1,!1));return Ra};Lb.prototype.Qdh=function(Y){return new Rg.a(this.Pdh(Y.ribbonCommandName),this.Ndh(Y.inputMethodName),this.Mdh(Y.frameModeName),this.Sdh(Y.uiLocationName),Y.tabName)};Lb.prototype.hpj=function(Y){return void 0!==Y&&null!==Y&&Y.toString()in this.OLd?this.OLd[Y.toString()]:(oc.ULS.shipAssertTag(537167694,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",
-911352779,-1985798686,Y),this.OLd["-911352779"])};Lb.prototype.Pdh=function(Y){return Y&&Y in this.B7f?this.B7f[Y]:(oc.ULS.shipAssertTag(537167693,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,Y),-911352779)};Lb.prototype.bpj=function(Y){return void 0!==Y&&null!==Y&&Md.a[Y]in this.vka?this.vka[Md.a[Y]]:(oc.ULS.shipAssertTag(537167692,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",
Y),this.vka.unknown)};Lb.prototype.Ndh=function(Y){return Y&&Y in this.A7f?this.A7f[Y]:(oc.ULS.shipAssertTag(537167691,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",Y),0)};Lb.prototype.apj=function(Y){return void 0!==Y&&null!==Y&&qf.a[Y]in this.Z2a?this.Z2a[qf.a[Y]]:(oc.ULS.shipAssertTag(537167690,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",Y),this.Z2a.edit)};Lb.prototype.Mdh=function(Y){return Y&&Y in this.z7f?this.z7f[Y]:
(oc.ULS.shipAssertTag(537167689,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",Y),2)};Lb.prototype.pYf=function(Y){return void 0!==Y&&null!==Y&&Ch[Y]in this.xLb?this.xLb[Ch[Y]]:(oc.ULS.shipAssertTag(537167688,0,!1,"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",Y),this.xLb.range)};Lb.prototype.Rdh=function(Y){return Y&&Y in this.C7f?this.C7f[Y]:(oc.ULS.shipAssertTag(537167687,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",
Y),0)};Lb.prototype.$oj=function(Y){return void 0!==Y&&null!==Y&&Y.toString()in this.jXc?this.jXc[Y.toString()]:(oc.ULS.shipAssertTag(537167686,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",Y),this.jXc["99"])};Lb.prototype.Ldh=function(Y){return Y&&Y in this.y7f?this.y7f[Y]:(oc.ULS.shipAssertTag(537167685,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",Y),99)};Lb.prototype.kpj=function(Y){return void 0!==Y&&
null!==Y&&ac.a[Y]in this.Hr?this.Hr[ac.a[Y]]:(oc.ULS.shipAssertTag(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",Y),this.Hr.ribbon)};Lb.prototype.Sdh=function(Y){return Y&&Y in this.D7f?this.D7f[Y]:(oc.ULS.shipAssertTag(537167684,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",Y),2)};Object(Yc.a)(Lb,"EnvironmentSerializationHelper",null,[]);Hb.HVf="SameSession";Hb.PFe="CrossSession";Hb.klf="LegacyCrossSession";Hb.external=
"External";Object(Yc.a)(Hb,"PayloadOrigin",null,[]);Sa.prototype.shouldWaitForCopyToComplete=function(){return!1};Sa.prototype.onDeferredPasteStarted=function(){};Sa.prototype.onDeferredPasteCompleted=function(){};Sa.prototype.beforePaste=function(){};Sa.prototype.MOj=function(Y){var Ra=null;try{var xb=Y.getItem(rb.EO);if(!xb)return{returnValue:!1,H0:Ra};Ra=JSON.parse(xb);return{returnValue:this.npi(Ra),H0:Ra}}catch(fc){return oc.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+
fc),{returnValue:!1,H0:Ra}}};Sa.prototype.npi=function(Y){return!!Y&&(!!Y.shadowWorkbookBase64||Y.shadowWorkbookSizeExceedsLimit)&&void 0!==Y.rangeRowStart&&void 0!==Y.rangeRowEnd&&void 0!==Y.rangeColumnStart&&void 0!==Y.rangeColumnEnd};Sa.prototype.spc=function(Y){Y.wasLastCopyExternal=!0;if(Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!Oc.a.MC&&516!==Y.commandParameters.commandType&&1028!==Y.commandParameters.commandType){var Ra=this.MOj(Y.clipboardItems);
var xb=Ra.H0;if(Ra.returnValue)return Y.isShadowWorkbookParsedSuccessfully=!0,this.IYi(Y,xb)}return 516!==Y.commandParameters.commandType&&36!==Y.commandParameters.commandType?Kc.EwaSettings.la(162)&&20!==Y.commandParameters.commandType&&(null===this.$.shortcutKeyManager||this.$.shortcutKeyManager.Ofc)&&(xb=Y.clipboardItems.getItem(rb.html),void 0!==xb&&null!==xb&&xb&&xb.trim()!==this.nXc&&(xb.startsWith("<")||Oc.a.Df&&xb.startsWith("\n<")))?(Ra=Y.clipboardItems.getItem(rb.g3c),this.GYi(Y,xb,void 0===
Ra?null:Ra)):this.gHf(Y):Promise.reject(new Tf.a(6))};Sa.prototype.IYi=function(Y,Ra){oc.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");Y.pasteResult="SystemClipboardShadowWorkbookPaste";Y.payloadType=oe.EO;Y.payloadOrigin=Hb.external;Y.shadowWorkbookPayloadSize=Gc(Ra);Y.shadowWorkbookSizeExceedsLimit=Kb(Ra);var xb=null,fc=null,bd=Y.commandParameters.originalDestinations;Kc.EwaSettings.getBooleanFeatureGate(He.a.D4b,
!1)?xb=vf.r(bd,this.$):fc=vf.v(vf.K(bd),this.$);Ra.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Y.originalSourceRangesCountExceedsLimit=Ra.originalSourceRangesCountExceedsLimit);if(Y.shadowWorkbookSizeExceedsLimit)return oc.ULS.sendTraceTag(537167833,0,15,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",Y.shadowWorkbookPayloadSize,Ud.a.Ikc,Ra.shadowWorkbookSizeExceedsLimit),
Promise.reject(new Tf.a(1));oc.ULS.sendTraceTag(537167832,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId={0}",Y.commandParameters.id);return this.Vr.kHf(Y.commandParameters.ribbonCommandInfo,fc,xb,Ra,[Y.commandParameters.stopwatch],Y)};Sa.prototype.gHf=function(Y){var Ra=Y.clipboardItems.getItem(rb.zW);if(void 0!==Ra&&null!==Ra&&Ra.trim()===this.nXc)return Promise.reject(new Tf.a(7));void 0!==Ra&&null!==Ra&&(Y.plainTextPayloadSize=Ra.length);
Y.isPlainTextPaste=!0;Y.pasteResult="SystemClipboardPaste";Y.payloadOrigin=qd(Y)?Hb.klf:Hb.external;Y.payloadType=oe.zW;oc.ULS.sendTraceTag(537167831,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}, PasteOperationId={1}",Y.id,Y.commandParameters.id);Ra=this.Vr.J2i(vf.K(Y.commandParameters.originalDestinations),Ra,Y.commandParameters.ribbonCommandInfo,[Y.commandParameters.stopwatch],Y);oc.ULS.sendTraceTag(537167830,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",
Y.id);return Ra};Sa.prototype.GYi=function(Y,Ra,xb){Y.htmlPayloadSize=Ra.length;Y.isHtmlPaste=!0;Y.pasteResult="SystemClipboardHtmlPaste";Y.payloadType=oe.html;Y.payloadOrigin=qd(Y)?Hb.klf:Hb.external;oc.ULS.sendTraceTag(42071711,0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId={0}",Y.commandParameters.id);return this.Vr.I2i(vf.K(Y.commandParameters.originalDestinations),Ra,xb,Y.commandParameters.id,Y.commandParameters.ribbonCommandInfo,[Y.commandParameters.stopwatch],
Y)};Sa.prototype.nFe=function(Y){var Ra={};Y&&(Ra.shadowWorkbookBase64=Y.ShadowWorkbookBase64,Ra.shadowWorkbookSizeExceedsLimit=Y.ShadowWorkbookSizeExceedsLimit,Ra.originalSourceRangesCountExceedsLimit=Y.OriginalSourceRangesCountExceedsLimit,Ra.originalSourceRangesCount=Y.OriginalSourceRangesCount,Ra.shadowWorkbookBlockedSize=Y.ShadowWorkbookBlockedSize);return Ra};Sa.prototype.Sfg=function(Y,Ra){var xb=ld(Y),fc=32===(Y.commandParameters.commandType&32),bd=1024===(Y.commandParameters.commandType&
1024),Dd=!1,Td=null,we=null,Oe=!1;if(!xb){Dd=-1985798686===Y.commandParameters.ribbonCommandInfo.command;var Te=Y.copyContextSnapshot;if(Ra)Oe=!Te.sourceItem.isFromCurrentSession(this.$);else if(Te=this.Vr.Kvb(Te))Td=Te.ranges,we=Te.sheetName,Oe=!Y.isSameSession}return this.Vr.oLg(we,Td,this.$.pa.sheetName,Y.commandParameters.originalDestinations,Y.commandParameters.expandDestinations,Oe,fc,bd,Dd,Ra,xb)};Sk.Object.defineProperties(Sa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},
nXc:{configurable:!0,enumerable:!0,get:function(){return this.Lm.Va(5)}}});Object(Yc.a)(Sa,"BaseCopyPasteHandler",null,[901,902,903]);gb.prototype.getValue=function(Y){return this.key&&this.key.isEqual(Y)?this.createClipboardItems(this.clipboardItems):null};gb.prototype.setValue=function(Y,Ra){this.key=Y;this.clipboardItems=this.createClipboardItems(Ra)};gb.prototype.createClipboardItems=function(Y){var Ra=this.v$.create(),xb=Y.getItem(rb.zW);xb&&Ra.setItem(rb.zW,xb);(xb=Y.getItem(rb.EO))&&Ra.setItem(rb.EO,
xb);(Y=Y.getItem(rb.html))&&Ra.setItem(rb.html,Y);return Ra};Object(Yc.a)(gb,"CopyCache",null,[]);var Od=b(67);vm(Sb,Sa);Sb.prototype.getSourceItem=function(){var Y=qe.a.clone(this.gridView.ha.va.selectedRanges);return new nd(this.$,Y,this.$.ea.pa.sheetName,this.$.ea.uf,this.$.ya.UserSessionId)};Sb.prototype.beforeSerialize=function(Y){var Ra=this;Y.isSelectionAllowed=!1;Y.isAsyncCopy=!1;Y.isFromCache=!1;Y.encounteredDeploymentErrors=!1;Y.plainTextPayloadSize=0;Y.shadowWorkbookPayloadSize=0;Y.htmlPayloadSize=
0;Y.clientSideCopyTime=0;var xb=new Da.a(this.$.xa),fc=Y.sourceItem;Y.isSelectionAllowed=qe.a.all(fc.ranges,function(bd){return Ra.isSelectionAllowed(xb,bd)});Y.isSelectionAllowed&&this.Vr.H9e(fc.ranges,Y.commandParameters.commandType)};Sb.prototype.GMa=function(Y){return this.gridView.Ca.HH()&&bf.i(this.gridView,Y)};Sb.prototype.dZi=function(Y,Ra,xb,fc){var bd=!1,Dd=1===Ra.commandParameters.commandType,Td=fc[0].pU;1===xb.ranges.length&&1===fc.length?Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&
Dd&&1!==Td&&Td!==xb.ranges[0].pU?Y.cseStatus=17:bd=this.O3g.j7c(Y,vf.K(xb.ranges),xb.sheetName,vf.K(Y.commandParameters.expandDestinations),this.$.ea.pa.sheetName,Dd):Y.cseStatus=5;bd&&bf.g(this.$).Mi.O0(Y.commandParameters.stopwatch.id,Od.BasicTelemetryCalculator.hR);return this.NYi(Y,xb,vf.u(this.$.pa.sheetName,null,fc),Ra.commandParameters.commandType,bd)};Sb.prototype.isSelectionAllowed=function(Y,Ra){return Y.Gzb(Ra,this.gridView)};Sb.prototype.NYi=function(Y,Ra,xb,fc,bd){Ra=vf.u(Ra.sheetName,
null,Ra.ranges);Y.pasteResult="SameSessionPaste";Y.payloadOrigin=Hb.HVf;Y.payloadType=oe.Vzg;oc.ULS.sendTraceTag(537167829,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId={0}",Y.commandParameters.id);return this.Vr.pasteRange(Y.commandParameters.ribbonCommandInfo,Ra,xb,fc,Y.commandParameters.commandType,[Y.commandParameters.stopwatch],Y,bd)};Object(Yc.a)(Sb,"BaseRangeCopyPasteHandler",Sa,[]);var gh=b(32);zb.prototype.onDeferredPasteStarted=function(Y){this.NU.xb(Y.id)||
this.NU.add(Y.id,!0);if(0<this.NU.count){var Ra=Ph.GetServiceTaskFactory.Wa(this.$.da,5,4,0);Fb.TaskExtensions.Ba(Ra,function(){Ra.result.ig(28,null)},this.$.ma,3)}};zb.prototype.onDeferredPasteCompleted=function(Y){var Ra=0<this.NU.count;this.NU.xb(Y.id)&&this.NU.remove(Y.id);if(Ra&&!this.NU.count){var xb=Ph.GetServiceTaskFactory.Wa(this.$.da,5,4,0);Fb.TaskExtensions.Ba(xb,function(){xb.result.removeEntry(28)},this.$.ma,3)}};Object(Yc.a)(zb,"DeferredPasteTracker",null,[]);var fi;(function(Y){Y[Y.none=
0]="none";Y[Y.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";Y[Y.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";Y[Y.asyncCopyCanceled=3]="asyncCopyCanceled";Y[Y.loadCopiedArtDataFromServerFailed=4]="loadCopiedArtDataFromServerFailed"})(fi||(fi={}));Object(Yc.b)("CopyErrorType",fi);var hh=b(1053),ye=b(1208),Dg=hh.a;vm(kc,Dg);Object(Yc.a)(kc,"CopyInnerError",hh.a,[]);vm(lb,Sb);lb.prototype.serialize=function(Y){var Ra=Y.sourceItem,xb={},fc=this.f3c.getValue(Ra);
if(fc)xb.synchronousResult=fc,Y.isFromCache=!0,Y.clientSideCopyTime=Y.commandParameters.stopwatch.Dc;else{var bd=null,Dd=vf.F(Ra.ranges);if(!Pf.a.dff()&&this.GMa(Dd)){oc.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");Dd=this.clipboardRangeFactory.create(Dd);try{bd=Dd.toString(),fc=this.v$.create(),fc.setItem(rb.zW,bd),this.f3c.setValue(Ra,fc),xb.synchronousResult=fc,Y.clientSideCopyTime=Y.commandParameters.stopwatch.Dc}finally{Dd&&
Dd.dispose()}}else Y.isAsyncCopy=!0,xb.synchronousResult=this.v$.create(),xb.synchronousResult.setItem(rb.zW,this.nXc);xb.asynchronousResult=this.fed(Y,Ra,bd)}Y.syncClipboardItemsKeys=Me(xb.synchronousResult);return xb};lb.prototype.shouldWaitForCopyToComplete=function(Y){if(!Y||!Y.copyContextSnapshot)return oc.ULS.sendTraceTag(537167907,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;oc.ULS.shipAssertTag(537167906,
0,!!this.$.ya,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(Y.copyContextSnapshot.sessionId===this.$.ya.UserSessionId)return oc.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),!1;oc.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};lb.prototype.onDeferredPasteStarted=
function(Y){this.NU.onDeferredPasteStarted(Y)};lb.prototype.onDeferredPasteCompleted=function(Y){this.NU.onDeferredPasteCompleted(Y)};lb.prototype.deserialize=function(Y){Y.isClipboardDataContainShadowWorkbook=!(void 0===Y.clipboardItems.getItem(rb.EO)||null===Y.clipboardItems.getItem(rb.EO));if(bf.g(this.$).ha.Ve&326)return ld(Y)&&(Y.wasLastCopyExternal=!0),Promise.reject(new Tf.a(17));var Ra=this.Sfg(Y,!1);if(0!==Ra)return Promise.reject(new Tf.a(ld(Y)?18:Y.isSameSession?19:20,void 0,void 0,void 0,
Ra));var xb=Y.copyContextSnapshot,fc=this.Vr.Kvb(xb);if(ld(Y))return this.spc(Y);Ra=Y.commandParameters.originalDestinations;if(fc&&Y.isSameSession)return this.dZi(Y,xb,fc,Ra);if(516!==Y.commandParameters.commandType){fc=this.LOj(Y.clipboardItems);xb=fc.H0;if(fc.returnValue){Y.isShadowWorkbookParsedSuccessfully=!0;var bd=fc=null;Kc.EwaSettings.getBooleanFeatureGate(He.a.D4b,!1)?fc=vf.r(Ra,this.$):bd=vf.v(vf.K(Ra),this.$);return this.EYi(Y,bd,fc,xb)}if(Y.isClipboardInaccessible)return Promise.reject(new Tf.a(8));
if(36!==Y.commandParameters.commandType)return this.gHf(Y)}return Promise.reject(new Tf.a(6))};lb.prototype.beforePaste=function(Y){this.$.da.Aa(373).Qlj(Y);Y.indicationDisplayScheduled=!0};lb.prototype.gOj=function(Y){if(!(Y&&Y.SourceRanges&&Y.SourceRanges.Ranges&&Y.SourceRanges.Ranges.length&&(Y.OriginalSourceRangesCountExceedsLimit||Y.OriginalSourceMultiRange&&Y.OriginalSourceMultiRange.Ranges&&Y.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,H0:null};var Ra=Y.SourceRanges.Ranges[0];
if(!Y.ShadowWorkbookBase64&&!Y.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,H0:null};var xb=this.nFe(Y);xb.rangeRowStart=Ra.FirstRow;xb.rangeRowEnd=Ra.LastRow;xb.rangeColumnStart=Ra.FirstColumn;xb.rangeColumnEnd=Ra.LastColumn;xb.sourceClientPath=Y.SourceClientPath;xb.sourceSheetName=Y.SourceSheetName;xb.sourceWorkbookName=Y.SourceWorkbookName;if(!Y.OriginalSourceRangesCountExceedsLimit)for(Y=Y.OriginalSourceMultiRange.Ranges,xb.originalSourceRanges=Array(Y.length),Ra=0;Ra<Y.length;++Ra)xb.originalSourceRanges[Ra]=
[Y[Ra].FirstRow,Y[Ra].FirstColumn,Y[Ra].LastRow,Y[Ra].LastColumn];return{returnValue:!0,H0:xb}};lb.prototype.LOj=function(Y){var Ra=null;Y=Y.getItem(rb.EO);if(!Y)return{returnValue:!1,H0:Ra};Ra=JSON.parse(Y);return{returnValue:this.mpi(Ra),H0:Ra}};lb.prototype.mpi=function(Y){return!!Y&&(!!Y.shadowWorkbookBase64||Y.shadowWorkbookSizeExceedsLimit)&&void 0!==Y.rangeRowStart&&void 0!==Y.rangeRowEnd&&void 0!==Y.rangeColumnStart&&void 0!==Y.rangeColumnEnd};lb.prototype.EYi=function(Y,Ra,xb,fc){oc.ULS.shipAssertTag(537167903,
0,!!fc,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");Uc.AFrameworkApplication.CK("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");Y.pasteResult="CrossSessionPaste";Y.payloadOrigin=Hb.PFe;Y.payloadType=oe.EO;Y.shadowWorkbookPayloadSize=Gc(fc);Y.shadowWorkbookSizeExceedsLimit=Kb(fc);fc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(Y.originalSourceRangesCountExceedsLimit=fc.originalSourceRangesCountExceedsLimit);
if(Y.shadowWorkbookSizeExceedsLimit)return oc.ULS.sendTraceTag(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",Y.shadowWorkbookPayloadSize,Ud.a.Ikc,fc.shadowWorkbookSizeExceedsLimit),Promise.reject(new Tf.a(1));if(1028===Y.commandParameters.commandType&&Y.originalSourceRangesCountExceedsLimit)return oc.ULS.sendTraceTag(572617859,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count({0}) is over the limit({1}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: {2}",
fc.originalSourceRangesCount,Ud.a.Dzi,fc.originalSourceRangesCountExceedsLimit),Promise.reject(new Tf.a(1));oc.ULS.sendTraceTag(537167902,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId={0}",Y.commandParameters.id);return this.Vr.kHf(Y.commandParameters.ribbonCommandInfo,Ra,xb,fc,[Y.commandParameters.stopwatch],Y)};lb.prototype.fed=function(Y,Ra,xb){var fc=this;oc.ULS.shipAssertTag(537167901,0,!!Y,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");
var bd=Y.commandParameters.stopwatch.Dc;return new Promise(function(Dd,Td){oc.ULS.sendTraceTag(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",Y.id);var we=vf.u(Ra.sheetName,null,Ra.ranges);fc.Vr.copy(we,Y.commandParameters,function(Oe){Y.requestTelemetryData=Oe.RequestTelemetryData;Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Dc-bd;if(zd.a.lh(Oe.Errors))zd.a.iha(Oe.Errors)?(Y.encounteredDeploymentErrors=
!0,oc.ULS.sendTraceTag(537167898,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",zd.a.Tc(Oe.Errors),Y.id)):(oc.ULS.sendTraceTag(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",zd.a.Tc(Oe.Errors),Y.id),Td(new kc(2,Oe.Errors)));else if(oc.ULS.sendTraceTag(537167900,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",
Y.id),Y.markForCancellation)Td(new kc(3,Oe.Errors));else{Oe=Oe.Result;var Te=Oe.PlainTextResult;void 0!==xb&&null!==xb&&(Te=xb);void 0!==Te&&null!==Te&&(Y.plainTextPayloadSize=Te.length);var Zf=fc.v$.create(),dg=fc.gOj(Oe);var Jg=dg.H0;dg.returnValue&&(Y.shadowWorkbookPayloadSize=Gc(Jg),Y.shadowWorkbookSizeExceedsLimit=Kb(Jg),Y.originalSourceRangesCountExceedsLimit=Oe.OriginalSourceRangesCountExceedsLimit,Jg=JSON.stringify(Jg),Zf.setItem(rb.EO,Jg));Zf.setItem(rb.zW,Te);Pf.a.dff()&&(Te=Oe.HtmlResult,
Y.htmlSizeExceedsLimit=Oe.HtmlSizeExceedsLimit,void 0!==Te&&null!==Te&&(Y.htmlPayloadSize=Te.length),Zf.setItem(rb.html,Te));Y.copyTotalSizeExceedsLimit=Oe.CopyTotalSizeExceedsLimit;Zf.setItem(rb.g3c,Y.commandParameters.id);fc.f3c.setValue(Ra,Zf);Y.asyncClipboardItemsKeys=Me(Zf);Dd(Zf)}},function(Oe){Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Dc-bd;Oe=ve.a.og(Oe.data);oc.ULS.sendTraceTag(537167897,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",
zd.a.Tc(Oe),Y.id);Td(new kc(2,Oe))},[Y.commandParameters.stopwatch])})};Object(Yc.a)(lb,"AcrossSessionRangeCopyPasteHandler",Sb,[]);Object(Yc.a)(Va,"CopyArtRequest",null,[]);Object(Yc.a)(bb,"PasteArtRequest",null,[]);Ia.prototype.g5h=function(Y){if(this.sli(Y.NNa)){oc.ULS.sendTraceTag(537167681,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",Y.NNa);var Ra=this.KHb.oa(Y.NNa);this.KHb.ia(Y.NNa,Y);var xb=Ra.promise;Ra.uff=!1;return this.tlh(Y,
xb)}this.KHb.ia(Y.NNa,Y);return this.dsi(Y)};Ia.prototype.sli=function(Y){return this.KHb.xb(Y)};Ia.prototype.dsi=function(Y){var Ra=this;return new Promise(function(xb,fc){Y.promise=Ra.vZa.fHf(Y).then(function(bd){xb(null);return Ra.Pnc(Y,bd)},function(bd){fc(null);return Ra.VDb(bd)})})};Ia.prototype.tlh=function(Y,Ra){var xb=this;return new Promise(function(fc,bd){Y.promise=Ra.then(function(Dd){xb.LTj(Y,Dd);return xb.vZa.fHf(Y).then(function(Td){fc(null);return xb.Pnc(Y,Td)},function(Td){bd(null);
return xb.VDb(Td)})},function(Dd){return xb.VDb(Dd)})})};Ia.prototype.Pnc=function(Y,Ra){Y.uff&&(this.vYg(Y.NNa),this.kNd(Y,Ra));return this.j3i(Ra)};Ia.prototype.vYg=function(Y){this.KHb.remove(Y)};Ia.prototype.kNd=function(Y,Ra){var xb=this.wYh();Y.NNa===xb&&this.vZa.kNd(Y.destination,Ra,Y.item.type)};Ia.prototype.wYh=function(){var Y=bf.g(this.$).ha.Pa.activeFloatingObjectControlId;Y||(Y=vf.v(bf.g(this.$).ha.va.activeCell,this.$),Y=Y.FirstRow+"_"+Y.FirstColumn);return Y};Ia.prototype.LTj=function(Y,
Ra){Y.destination=null;Y.OHe=Ra};Object(Yc.a)(Ia,"PasteArtRequestManager",null,[]);var Jf=b(187),Ne=b(115),gi=b(102);vm(ta,Sa);ta.prototype.getSourceItem=function(){oc.ULS.shipAssertTag(537167896,0,!!this.ha.Pa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");oc.ULS.sendTraceTag(537167895,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.ha.Pa.activeFloatingObjectControlId);return new me(this.ha.Pa.activeFloatingObjectControlId,
this.$.ea.pa.sheetName,this.$.ea.uf,this.$.ya.UserSessionId,this.ha.Pa.lc.floatingObject.type)};ta.prototype.beforeSerialize=function(Y){Y&&Y.commandParameters?(Y?(Y.isAsyncCopy=!1,Y.isSelectionAllowed=!1,Y.isFromCache=!1,Y.plainTextPayloadSize=0,Y.shadowWorkbookPayloadSize=0,Y.htmlPayloadSize=0,Y.htmlSizeExceedsLimit=!1,Y.clientSideCopyTime=0,Y.encounteredDeploymentErrors=!1,Y.shadowWorkbookSizeExceedsLimit=!1,Y.originalSourceRangesCountExceedsLimit=!1,Y.copyTotalSizeExceedsLimit=!1):oc.ULS.sendTraceTag(537167826,
0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),Y.commandParameters.copyPasteTargetType=2):oc.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")};ta.prototype.serialize=function(Y){var Ra=Y.sourceItem,xb={};if(!Ra)return oc.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),xb;if(!this.eoi())return oc.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),
xb;oc.ULS.sendTraceTag(537167892,0,50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",Ra.activeFloatingObjectControlId);this.pEd();var fc=this.e3c.getValue(Ra);if(fc)xb.synchronousResult=fc,Y.isFromCache=!0,Y.isAsyncCopy=!1,Y.clientSideCopyTime=Y.commandParameters.stopwatch.Dc,1===Y.commandParameters.commandType&&this.$.xe(2045211913,Y.commandParameters.ribbonCommandInfo.method,Y.commandParameters.ribbonCommandInfo.af,null);else{Y.isFromCache=!1;Y.isAsyncCopy=
!0;fc=this.v$.create();if(Y.commandParameters.uploadToClipService){var bd={};bd["data-clipservice-ccpid"]=Y.commandParameters.id;bd["data-pkey"]=Y.commandParameters.pKey;bd["data-clipservice-type"]=Y.commandParameters.clipServiceDataType;bd["data-clipservice-count"]=Y.commandParameters.objectCount.toString();bd["data-clipservice-dc"]=Y.commandParameters.clipServiceDataCenter;bd["data-clipservice-client"]=this.pZg;bd["data-TimeStamp"]=(new Date).toUTCString();bd["data-clipservice-version"]=this.qZg;
fc.setItem(rb.eIg,JSON.stringify(bd))}xb.synchronousResult=this.yBg(fc);xb.asynchronousResult=this.fed(Y,Ra,fc)}Y.syncClipboardItemsKeys=Me(xb.synchronousResult);return xb};ta.prototype.yBg=function(Y){oc.ULS.shipAssertTag(537167891,0,!!this.ha.Pa.lc,"Expecting a floating object to be currently selected for copy");Y||(Y=this.v$.create());var Ra=this.ha.Pa.lc.kub();Ra&&(Ra=String.format("<img src='{0}'>",Ra),Y.setItem(rb.html,Ra));return Y};ta.prototype.pEd=function(){var Y=this.ha.Pa.lc;this.job.pEd(Ne.a.fqb(Y.floatingObject),
Ne.a.sZg(Y.Lt))};ta.prototype.shouldWaitForCopyToComplete=function(){oc.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};ta.prototype.onDeferredPasteStarted=function(Y){this.NU.onDeferredPasteStarted(Y)};ta.prototype.onDeferredPasteCompleted=function(Y){this.NU.onDeferredPasteCompleted(Y)};ta.prototype.deserialize=function(Y){var Ra=ld(Y),xb=null,fc=null,bd=!1;if(!Ra){xb=Y.copyContextSnapshot;fc=xb.sourceItem;if(!fc)return Promise.reject(new Tf.a(10));
bd=fc.isFromCurrentSession(this.$)}var Dd=this.Sfg(Y,!0);if(0!==Dd)return Promise.reject(new Tf.a(Ra?18:bd?19:20,void 0,void 0,void 0,Dd));if(Ra)return this.spc(Y);if(!bd&&!ta.ohi(fc))return Y=String.format("User attempted to paste art of type [{0}] between sessions.",fc.type),oc.ULS.sendTraceTag(537167889,0,50,Y),Promise.reject(new Tf.a(11,void 0,void 0,Y));if(xb.isAsyncSerializeFailed)return Promise.reject(new Tf.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));
try{var Td=Y.clipboardItems.getItem(rb.EO);var we=JSON.parse(Td)}catch(Oe){return oc.ULS.sendTraceTag(537167888,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(Oe)),Promise.reject(new Tf.a(12,void 0,Oe))}we.floatingObjectId!==fc.activeFloatingObjectControlId?oc.ULS.sendTraceTag(537167887,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",
fc.activeFloatingObjectControlId,we.floatingObjectId):oc.ULS.sendTraceTag(537167886,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",fc.activeFloatingObjectControlId,we.floatingObjectId);if(!we||!we.shadowWorkbookBase64)return Promise.reject(new Tf.a(13,void 0,void 0,String.format("shadowWorkbookPayload is null = {0}",!we)));Y.isShadowWorkbookParsedSuccessfully=!0;Y.shadowWorkbookPayloadSize=
Gc(we);Y.shadowWorkbookSizeExceedsLimit=Kb(we);Y.payloadOrigin=bd?Hb.HVf:Hb.PFe;Y.payloadType=oe.ijg;if(Kb(we))return Y=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",Y.shadowWorkbookPayloadSize,Ud.a.Ikc,we.shadowWorkbookSizeExceedsLimit),oc.ULS.sendTraceTag(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",Y),Promise.reject(new Tf.a(1,void 0,void 0,Y));xb=Ra=null;bf.g(this.$).ha.Ve&326?xb=bf.g(this.$).ha.Pa.activeFloatingObjectControlId:
Ra=this.$.pa&&this.$.pa.activeCell?vf.v(this.$.pa.activeCell,this.$):vf.v(vf.K(Y.commandParameters.originalDestinations),this.$);bd=null;if(this.job.N2f(fc))try{bd=this.job.j7c()}catch(Oe){oc.ULS.sendTraceTag(537167885,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(Oe))}return this.FYi.g5h(new bb(Y.commandParameters.ribbonCommandInfo,Ra,xb,Y.commandParameters.commandType,[Y.commandParameters.stopwatch],
we,fc,Y,bd))};ta.prototype.spc=function(Y){Y.wasLastCopyExternal=!0;if(Y.clipboardItems.getItem("image/png")){var Ra=Y.commandParameters.stopwatch.Dc;Y.payloadType=oe.uOg;var xb={};return Mc.b(this.$.xe(1403967063,Y.commandParameters.ribbonCommandInfo.method,Y.commandParameters.ribbonCommandInfo.af,(xb.dataUrl=Y.clipboardItems.getItem("image/png"),xb))).then(function(fc){Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Dc-Ra;return fc?Promise.resolve(null):Promise.reject(new Tf.a(15))},function(){Y.serverRequestTimeInMs=
Y.commandParameters.stopwatch.Dc-Ra;return Promise.reject(new Tf.a(15))})}oc.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return Sa.prototype.spc.call(this,Y)};ta.prototype.eoi=function(){var Y=bf.g(this.$).ha;return Y.Pa.activeFloatingObjectControlId&&Y.Pa.lc&&Y.Pa.lc.floatingObject?Y.Pa.lc.floatingObject.rUd():!1};ta.prototype.fed=function(Y,Ra,xb){var fc=this;return new Promise(function(bd,Dd){var Td=Y.commandParameters.stopwatch.Dc;
oc.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");fc.vZa.G3g(new Va(Ra.activeFloatingObjectControlId,Y.commandParameters,function(we){Y.requestTelemetryData=we.RequestTelemetryData;Y.serverRequestTimeInMs=Y.commandParameters.stopwatch.Dc-Td;if(zd.a.lh(we.Errors))zd.a.iha(we.Errors)?(Y.encounteredDeploymentErrors=!0,oc.ULS.sendTraceTag(537167879,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",
zd.a.Tc(we.Errors))):(oc.ULS.sendTraceTag(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",zd.a.Tc(we.Errors)),Dd(new kc(4,we.Errors)));else if(oc.ULS.sendTraceTag(537167883,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",Ra.activeFloatingObjectControlId),Y.markForCancellation)Dd(new kc(3,we.Errors));else{zd.a.er(we.Errors)&&oc.ULS.sendTraceTag(537167882,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",
zd.a.Tc(we.Errors));var Oe=we.Result;if(Oe){Oe=fc.nFe(Oe);Oe.floatingObjectId=Ra.activeFloatingObjectControlId;Y.shadowWorkbookPayloadSize=Gc(Oe);Y.shadowWorkbookSizeExceedsLimit=Kb(Oe);try{var Te=JSON.stringify(Oe)}catch(Zf){Dd(new Tf.a(14,void 0,Zf,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",Y.shadowWorkbookPayloadSize,Oe.floatingObjectId)));return}oc.ULS.shipAssertTag(537167881,0,!!xb,"Expecting syncClipboardItems to be defined");
xb.setItem(rb.EO,Te);1===Y.commandParameters.commandType&&(fc.Q0i(Ra.type,Ra.activeFloatingObjectControlId,we.StateId),fc.deleteFloatingObject(Ra.activeFloatingObjectControlId,Ra.type));fc.e3c.setValue(Ra,xb);Y.asyncClipboardItemsKeys=Me(xb);bd(xb)}else oc.ULS.sendTraceTag(537167880,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",Ra.activeFloatingObjectControlId),bd(fc.e3c.getValue(Ra))}},Y.commandParameters.commandType,Ra.type,function(we){Y.serverRequestTimeInMs=
Y.commandParameters.stopwatch.Dc-Td;we=ve.a.og(we.data);1===Y.commandParameters.commandType&&fc.vZa.JPj(Ra.type,Ra.activeFloatingObjectControlId);oc.ULS.sendTraceTag(537167878,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",zd.a.Tc(we));Dd(new kc(4,we))},[Y.commandParameters.stopwatch]))})};ta.prototype.deleteFloatingObject=function(Y,Ra){Y=Jf.a.Yy(Ra,Y);if(Y=gi.a(this.$).Up(Y))gi.a(this.$).deleteFloatingObject(Y,14,!0),bf.g(this.$).ha.Pa.pC=null};ta.prototype.Q0i=
function(Y,Ra,xb){var fc=this.$.da.Aa(277);if(fc){var bd=null;Y=Jf.a.Yy(Y,Ra);Y=gi.a(this.$).Up(Y);if(null===Y||void 0===Y?0:Y.Wi)bd=Y.Wi.block;if(bd){var Dd=Y.floatingObject.Hg();fc.qYb(function(){return!bd.Yi.xb(Dd)},xb,"CutArt")}}};ta.ohi=function(Y){return 1===Y.type||5===Y.type};Object(Yc.a)(ta,"ArtCopyPasteHandler",Sa,[]);var kh=b(54);vm(ra,Yb);Object(Yc.a)(ra,"MacroRecorderPasteArtPayload",Yb,[]);Ba.prototype.s$h=function(Y,Ra,xb,fc,bd,Dd,Td){var we=this;Dd=void 0===Dd?null:Dd;Td=void 0===
Td?null:Td;var Oe=this.$.na.ta.Zb(),Te=null,Zf={CopyPasteTargetType:2};Zf.FloatingObjectId=Y;Zf.CopyOperationId=xb.id;xb.floatingObjectType=Ra;Zf.UploadToClipService=xb.uploadToClipService;Zf.PKey=xb.pKey;Zf.ClipServiceDataCenter=xb.clipServiceDataCenter;var dg=0;2===bd?(bd=505,dg=16,Te=function(Jg,Ug,Xh){return Zc(we.$.na.ta,Zf,jg.b(Jg,fc),Dd?jg.a(Ug,Dd):Ug,Xh,xb.ribbonCommandInfo,Oe,Td)}):(bd=179,Te=function(Jg,Ug,Xh){we.bhh(Ra,Y);we.$.oy();var Ef=we.$.na.ta;Jg=jg.b(Jg,fc);Ug=Dd?jg.a(Ug,Dd):Ug;
var Th=xb.ribbonCommandInfo,sh=Td;sh=void 0===sh?null:sh;var Mg=Ef.Na(1,void 0===Oe?null:Oe);Mg.copyParameters=Zf;return he.i(Ef,"Cut",Mg,Jg,Ug,Xh,Th,0,sh)});Kc.EwaSettings.sc()?this.$.userOperationManager.hc(new Ye.a(bd,0,Te,dg|64),xb.ribbonCommandInfo):this.$.userOperationManager.hc(new Hd.a(bd,0,Te,dg),xb.ribbonCommandInfo)};Ba.prototype.bhh=function(Y,Ra){var xb=Jf.a.Yy(Y,Ra);(xb=gi.a(this.$).Up(xb))?(bf.g(this.$).ha.Pa.bH(xb),xb.isVisible=!1):oc.ULS.sendTraceTag(537167876,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",
Y,Ra)};Ba.prototype.JPj=function(Y,Ra){Y=Jf.a.Yy(Y,Ra);if(Y=gi.a(this.$).Up(Y))Y.isVisible=!0};Ba.prototype.G3g=function(Y){this.s$h(Y.floatingObjectId,Y.E3g,Y.commandParameters,Y.Cr,Y.$ah,Y.l4,Y.jZd)};Ba.prototype.S$h=function(Y,Ra,xb,fc,bd,Dd,Td,we,Oe){var Te=this;we=void 0===we?null:we;Oe=void 0===Oe?!0:Oe;return new Promise(function(Zf,dg){var Jg=Dd.commandParameters.stopwatch.Dc;Te.INd(Y,bd,Ra,xb,function(Ug){Dd.requestTelemetryData=Ug.RequestTelemetryData;Dd.serverRequestTimeInMs=Dd.commandParameters.stopwatch.Dc-
Jg;if(zd.a.iha(Ug.Errors))Dd&&(Dd.encounteredDeploymentErrors=!0),oc.ULS.sendTraceTag(537167875,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",zd.a.Tc(Ug.Errors));else if(zd.a.lh(Ug.Errors))oc.ULS.sendTraceTag(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",zd.a.Tc(Ug.Errors)),dg(new Tf.a(9,Ug.Errors));else if(Ug.Result){var Xh=Ug.Result;oc.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");
Te.d1i(Td,Xh.FloatingObjectId,Ug.StateId);Zf(Ba.eld(Xh.FloatingObjectId))}else oc.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),dg(new Tf.a(9,Ug.Errors))},function(Ug){Dd.serverRequestTimeInMs=Dd.commandParameters.stopwatch.Dc-Jg;Ug=ve.a.og(Ug.data);oc.ULS.sendTraceTag(537167872,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",zd.a.Tc(Ug));dg(new Tf.a(9,Ug))},fc,we,Oe)})};Ba.prototype.d1i=function(Y,Ra,xb){var fc=
this,bd=this.$.da.Aa(277);if(bd){var Dd=Jf.a.Yy(Y,Ba.eld(Ra));bd.qYb(function(){return!!gi.a(fc.$).Up(Dd)},xb,"PasteArt")}};Ba.prototype.rXd=function(Y,Ra){Ra&&this.job.rXd(Y,Jf.a.Yy(Y.type,Ra))};Ba.prototype.fHf=function(Y){var Ra=this;return this.S$h(Y.ribbonCommandInfo,Y.destination,Y.OHe,Y.jZd,Y.H0,Y.pasteContext,Y.item.type,Y.Ize,Y.item.isFromCurrentSession(this.$)).then(function(xb){return xb},function(xb){Ra.rXd(Y.item,Y.Ize);return Promise.reject(xb)})};Ba.prototype.kNd=function(Y,Ra,xb){Y||
(Y=vf.v(bf.g(this.$).ha.va.activeCell,this.$));bf.g(this.$).vhc(vf.D(Y),1)?gi.a(this.$).ona(xb,Ra,!0):bf.g(this.$).ha.Pa.Hsa(Y,Ra,xb).continueWith(function(fc){fc.result?oc.ULS.sendTraceTag(537167843,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",Ra):oc.ULS.sendTraceTag(537167842,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",Ra)})};Ba.prototype.INd=function(Y,Ra,xb,fc,bd,Dd,Td,we,Oe){function Te(){if(Oe){var Xh=
kh.a.pi(kh.a.Kc(Ug));Xh.FloatingObjectId=Ra.floatingObjectId;Ug.DestinationRanges||(Xh.DestinationRanges=vf.p(dg.$.xa.pa.sheetName,"",0,0,0,0));return new ra(Xh,Oe,0,0)}return new ra(Ug,Oe,0,0)}function Zf(Xh,Ef,Th){we||dg.$.oy();return jd(dg.$.na.ta,Ug,jg.b(Xh,bd),jg.a(Ef,Dd),Th,null,Jg,Td)}var dg=this;Oe=void 0===Oe?!0:Oe;var Jg=this.$.na.ta.Zb(),Ug={};Ug.ShadowWorkbookBase64=Ra.shadowWorkbookBase64;Ug.FloatingObjectId=fc;Ug.DestinationRanges=xb?vf.s(xb):null;Ug.CopyPasteTargetType=2;Ug.ClientEstimationFloatingObjectId=
we;xb=Kc.EwaSettings.sc()?new Ye.a(503,0,Zf,void 0,Te):new Hd.a(503,0,Zf,void 0,Te);xb.flags=Kc.EwaSettings.sc()?65:1;this.$.userOperationManager.hc(xb,Y)};Ba.eld=function(Y){return String.format("{0}.{{{1}}}",Y.length+2,Y.toUpperCase())};Object(Yc.a)(Ba,"ArtCopyPasteUtils",null,[891]);var Vf=b(237);P.prototype.pEd=function(Y,Ra){this.eta=Y;this.c3c=Ra};P.prototype.j7c=function(){if(!this.eta||!this.c3c)return oc.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),
"";var Y=Ne.a.fqb(new Jf.a(this.eta));Y.Id=Ba.eld(Gd.a.create().toString());Y.Version=-1;Y.Name="";Y.IsClientEstimation=!0;var Ra=this.ebi(Y);if(!Ra)return null;var xb=new Jf.a(Y);Ra.block.Yi.add(xb);xb.PHb();var fc=gi.a(this.$);fc.Q3b(xb,Ra);Ra=fc.Up(Jf.a.DRh(Y));!Ra||Ra.floatingObject.pMa||Ra.floatingObject.MMa||Ra.BRa(this.c3c);fc.ona(Y.Type,Y.Id,!0);return Y.Id};P.prototype.N2f=function(Y){return Kc.EwaSettings.la(223)&&Y.isFromCurrentSession(this.$)&&!bf.g(this.$).rtl&&!bf.g(this.$).$a.aj};P.prototype.rXd=
function(Y,Ra){this.N2f(Y)&&(Y=gi.a(this.$).Up(Ra))&&(oc.ULS.sendTraceTag(537167840,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",Ra,Y.floatingObject.type),gi.a(this.$).deleteFloatingObject(Y,15,!0),Y.Wi&&Y.Pab(Y.Wi,!1))};P.prototype.ebi=function(Y){if(!Y)return oc.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),null;
if(bf.g(this.$).ha.Pa.activeFloatingObjectControlId){var Ra=bf.g(this.$).ha.Pa.pC.floatingObject;Y.OriginDeltaX=Ra.offsetX+this.v$a;Y.OriginDeltaY=Ra.offsetY+this.v$a;Y.AbsoluteLeft+=this.v$a;Y.AbsoluteTop+=this.v$a;Y.AbsoluteRight+=this.v$a;Y.AbsoluteBottom+=this.v$a;Y.ZOrder=Ra.xy+1;return bf.g(this.$).ha.Pa.pC.Wi}if(!this.$.pa||!this.$.pa.activeCell)return oc.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),
null;var xb=this.$.pa.activeCell;Ra=bf.g(this.$).k1(xb);if(!Ra)return oc.ULS.sendTraceTag(537167837,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",xb.toString()),null;var fc=Ge.HelperMethods.tKa(Ra.domElement,Ra.wj.domElement);xb=Ra.gridView.pg(xb,2);if(!fc||!xb)return oc.ULS.sendTraceTag(537167836,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",
!fc,!xb),null;Y.OriginDeltaX=xb.topLeft.x-fc.x;Y.OriginDeltaY=xb.topLeft.y-fc.y;Y.AbsoluteLeft=xb.topLeft.x;Y.AbsoluteTop=xb.topLeft.y;Y.AbsoluteRight=Y.AbsoluteLeft+Math.abs(this.eta.AbsoluteRight-this.eta.AbsoluteLeft);Y.AbsoluteBottom=Y.AbsoluteTop+Math.abs(this.eta.AbsoluteBottom-this.eta.AbsoluteTop);Y.ZOrder=this.eta.ZOrder+100;return new Vf.a(Ra.gridView.Ca.Vk(Ra.hashCode),Ra.hashCode)};Object(Yc.a)(P,"ArtPasteClientEstimation",null,[890]);Ob.prototype.create=function(){var Y=window.clipboardPlatform;
return Y?Y.createClipboardItems():null};Object(Yc.a)(Ob,"ClipboardItemsFactory",null,[889]);cc.undefined="Undefined";Object(Yc.a)(cc,"CCPTelemetryConsts",null,[]);Jb.cells="Cells";Jb.floatingObject="FloatingObject";Jb.unknown="Unknown";Object(Yc.a)(Jb,"ActiveSelection",null,[]);ic.fgh="DisplayNotInvoked";ic.a7c="Displayed";ic.p1i="PrerequisitesNotReady";Object(Yc.a)(ic,"PasteIndicationDisplayStatus",null,[]);var ti=b(106);Ub.prototype.getCopyFlowHandler=function(Y){var Ra=this.yNh(bf.g(this.$).Ve);
Y.commandParameters.copyPasteHandlerName=Ra.name;return Ra};Ub.prototype.getPasteFlowHandler=function(Y){var Ra=Y.copyContextSnapshot;Ra=zc(Y)?this.iXc:ld(Y)?this.sGd:(null===Ra||void 0===Ra?0:Ra.sourceItem)&&Object.getType(Ra.sourceItem)===me?this.iXc:this.sGd;Y.commandParameters.copyPasteHandlerName=Ra.name;return Ra};Ub.prototype.initializePasteContext=function(Y){if(Y&&(Y.isSameSession=!1,Y.isShadowWorkbookParsedSuccessfully=!1,Y.pasteResult=cc.undefined,Y.payloadOrigin=cc.undefined,Y.payloadType=
cc.undefined,Y.encounteredDeploymentErrors=!1,Y.shadowWorkbookSizeExceedsLimit=!1,Y.originalSourceRangesCountExceedsLimit=!1,Y.activeSelectionType=this.uJh(),Y.indicationDisplayScheduled=!1,Y.pasteDestinationHasMergedCells=!1,Y.pasteIndicationDisplayStatus=ic.fgh,Y.copyContextSnapshot)){var Ra=Y.copyContextSnapshot,xb=rc(Ra.sourceItem),fc=Ra.sourceItem;var bd=!!fc&&Object.getType(fc)===me;fc=0;var Dd=!1;xb?(Dd=Ra.sourceItem,Y.isSameSession=Dd.isFromCurrentSession(this.$),fc=1,Dd=this.tli(Dd,Y)):bd&&
(Y.isSameSession=Ra.sourceItem.isFromCurrentSession(this.$),fc=2);if(Y.copyContextSnapshot.commandParameters){bd=-1985798686===Ra.commandParameters.ribbonCommandInfo.command;var Td=Y.commandParameters;var we=this.$;Ra?we&&we.ya?Ra=Ra.sessionId===we.ya.UserSessionId:(oc.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Ra=!1):(oc.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Ra=!1);Td.clearSystemClipboard=Ra&&bd&&xb&&!Dd;Y.commandParameters.copyPasteTargetType=fc}}};
Ub.prototype.getSessionId=function(){return this.$.ya.UserSessionId};Ub.prototype.tli=function(Y,Ra){var xb=ti.b(Y.ranges,function(fc){return fc.Sh})&&ti.b(Ra.commandParameters.originalDestinations,function(fc){return 1!==fc.top});return ti.b(Y.ranges,function(fc){return fc.isRow})&&ti.b(Ra.commandParameters.originalDestinations,function(fc){return 1!==fc.left})||xb};Ub.prototype.yNh=function(Y){switch(Y){case 1:return this.sGd;case 64:case 4:case 2:case 256:return this.iXc;default:throw Error.invalidOperation("Unsupported selection");
}};Ub.prototype.uJh=function(){return bf.g(this.$).ha.Ve&470?Jb.floatingObject:1===bf.g(this.$).ha.Ve?Jb.cells:Jb.unknown};Sk.Object.defineProperties(Ub.prototype,{sGd:{configurable:!0,enumerable:!0,get:function(){if(!this.iPc){var Y=this.$.da.Aa(254,!0);Y&&(this.iPc=new lb(this.$,Y,new Ob))}return this.iPc}},iXc:{configurable:!0,enumerable:!0,get:function(){if(!this.$Ec&&this.$.da.Aa(254,!0)){var Y=new P(this.$);this.$Ec=new ta(this.$,new Ob,new Ba(this.$,Y),Y)}return this.$Ec}}});Object(Yc.a)(Ub,
"ExcelCopyPasteApplicationHost",null,[851]);var Kh=b(139),Jh=Le.a;vm(pb,Jh);pb.prototype.Ch=function(Y){this.Wo=new Kh.a;var Ra=ce.a.instance.fa(16);Y=this.tV(Y);this.initializeAndShow(Ra,this.Zci,Y)};pb.prototype.tV=function(Y){var Ra={};return Ra[pb.$y]=this.Ac,Ra[pb.Rmi]=Y,Ra};Sk.Object.defineProperties(pb.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"InsertCopiedCutCellsDialog"}}});pb.pfh="direction";pb.Rmi="isRtl";var nh={};pb.qfh=(nh.Vertical=1,nh.Horizontal=0,nh);Object(Yc.a)(pb,
"InsertCopiedCutCellsDialog",Le.a,[]);Oa.prototype.S3b=function(Y,Ra){return(new pb(Y,Ra)).Wo.task};Object(Yc.a)(Oa,"InsertCopiedCutCellsDialogFactory",null,[850]);var ih=b(88),dh=b(44),Qh=b(42);lc.prototype.VJe=function(){var Y=this;this.iqc||(oc.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.$E(function(Ra){Ra.$ua(0).then(function(){Y.iqc=!0})}))};lc.prototype.Qlj=function(Y){var Ra=this,xb=Y.commandParameters.id;
oc.ULS.sendTraceTag(537167651,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",xb,!this.Ps,this.iqc);this.VJe();this.X4b=xb;xb=!this.usf();if(!this.Ps||xb)this.Twe(),this.Ps=dh.a.instance.create(function(){Ra.egh(Y)},void 0===Y.timeoutToShowSpinnerInMs||null===Y.timeoutToShowSpinnerInMs?100:Y.timeoutToShowSpinnerInMs,Qh.a.JYi);this.s2=Y.commandParameters.originalDestinations};lc.prototype.egh=function(Y){this.iqc?(this.display(Y.commandParameters.originalDestinations),
Y.pasteIndicationDisplayStatus=ic.a7c):(oc.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),Y.pasteIndicationDisplayStatus=ic.p1i)};lc.prototype.display=function(Y){oc.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.Nb.ry(Kf.a.Z0(Ff.d(this.gridView.$.pa),Y),lc.tpc,!0);this.gridView.Nb.ys(lc.tpc)};lc.prototype.Vjd=function(Y){oc.ULS.sendTraceTag(537167648,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",
Y,this.X4b);Y&&gf.a.equals(Y,this.X4b,!1)&&this.hide()};lc.prototype.hide=function(Y){this.s2&&(void 0===Y?0:Y)&&this.usf()&&oc.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.X4b="";this.Twe();this.s2=null;this.gridView.Nb.ll(lc.tpc);this.gridView.Nb.Nl(null,lc.tpc)};lc.prototype.usf=function(){return vf.Q(this.gridView.ha.va.selectedRanges,this.s2)};lc.prototype.Twe=
function(){this.Ps&&(ih.a.Fa(this.Ps),this.Ps=null)};lc.prototype.dispose=function(){this.hide();this.gridView.ha.WF(this.i9e)};lc.tpc=[30];Object(Yc.a)(lc,"PasteIndicationManager",null,[849,3]);var xh=b(1127),Xg=b(53),Lg=yd.a;vm(Xb,Lg);Xb.prototype.create=function(){var Y=this,Ra=Xg.a.s_([51,52],4,this.ub,void 0,void 0,void 0,Xb.qRa),xb=Ph.GetServiceTaskFactory.create(this.$.da,18,this.$.ma,this.ub);Fb.TaskExtensions.Ba(Fb.TaskExtensions.ve([xb,Ra],this.ma),function(){var fc=new xh.a,bd=null;Y.l1g(fc).then(function(Dd){bd=
Dd.Mze;var Td=copyPasteInfra.createCopyPasteInfra(bd,new Ub(Y.$),fc,Y.$);oc.ULS.shipAssertTag(537167762,0,!!Y.$.ya,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");oc.ULS.shipAssertTag(537167761,0,!!Y.$.ya&&!!Y.$.ya.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");var we=bd.getMetadataManager();Y.Fb(new Ad(Y.$,we,xb.result,Td,new sa(Y.$,bf.g(Y.$)),new Oa,Y.$.ya.DocumentHostInfo.UserId,
bd.getInitializationError()));Dd.T_a?oc.ULS.sendTraceTag(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}",Ad.X$b(),Dd.T_a.dataClipboardStrategyType,JSON.stringify(Dd.T_a.dataClipboardCapabilities),Dd.T_a.clipboardStrategiesToInitialize[0].clipboardStrategyType===Dd.T_a.dataClipboardStrategyType,void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?
"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString()):oc.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(Dd){oc.ULS.shipAssertTag(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",Ad.X$b(),Dd?copyPasteInfra.getStringifiedError(Dd):
"null")})},this.ma,3)};Xb.prototype.dispose=function(){Lg.prototype.dispose.call(this)};Xb.prototype.l1g=function(Y){var Ra=null,xb=window.clipboardPlatform;xb&&(Ra=xb.getClipboardPlatformEnvironment());if(!Ra)return oc.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);xb=this.$.ya;var fc=[xb.OfficeOnlineChromeExtensionId,xb.ChromeClipboardAccessExtensionId],
bd=this.Lm.Va(5),Dd=this.$.jg.get(57),Td=!Dd&&this.$.jg.get(5),we=this.$.ea.nc;we&&(we.inWebPart||we.inViewerFromWebPart||we.isDivSyndicated)&&(Td=!1);Dd=this.uMh(Td,!Dd);oc.ULS.shipAssertTag(537167758,0,!!xb.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Ra.init(this.$,Y,fc,xb.SharedClipboardHostingApp,xb.SharedClipboardHostingApps,xb.SharedClipboardHostingEnvironments,xb.SharedClipboardOverrideOrigin,
xb.SharedClipboardSchemaVersion,xb.SharedClipboardExpirationInMinutes,xb.ClipboardPromiseTimeoutInMinutes,bd,xb.MachineCluster,new Lb(this.$),Dd,xb.DocumentHostInfo.UserId,xb.ClipboardTtlInMS,Kc.EwaSettings.la(315),xb.UserSessionId).then(function(Oe){return Object.assign(new xd,{Mze:Ra,T_a:Oe})},function(Oe){return Promise.reject(Oe)})};Xb.prototype.uMh=function(Y,Ra){var xb=[];Y&&Ra&&Array.add(xb,this.A$g());Ra&&(Array.add(xb,this.L4c(7)),Array.add(xb,this.L4c(0)));Y&&Array.add(xb,this.wEe());Array.add(xb,
{clipboardStrategyType:4});oc.ULS.sendTraceTag(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",Y,Ra,xb?xb.join(","):"[]");return xb};Xb.prototype.wEe=function(){var Y=this.$.ya,Ra={clipboardStrategyType:5};Ra.sessionId=Y.UserSessionId;Ra.useSharedClipboardIframe=!0;Ra.sharedClipboardHostingApp=Y.SharedClipboardHostingApp;Ra.sharedClipboardHostingApps=
Y.SharedClipboardHostingApps;Ra.sharedClipboardHostingEnvironments=Y.SharedClipboardHostingEnvironments;Ra.sharedClipboardOverrideOrigin=Y.SharedClipboardOverrideOrigin;Ra.sharedClipboardSchemaVersion=Y.SharedClipboardSchemaVersion;Ra.sharedClipboardExpirationInMinutes=Y.SharedClipboardExpirationInMinutes;Ra.wacCluster=Y.MachineCluster;return Ra};Xb.prototype.A$g=function(){var Y={clipboardStrategyType:6};Y.localStorageStrategyParameters=this.wEe();Y.systemClipboardStrategyParameters=this.L4c(0);
return Y};Xb.prototype.L4c=function(Y){var Ra={};Ra.clipboardStrategyType=Y;Ra.skipFilesIfPlainTextExists=!0;return Ra};Xb.ja=function(Y){Y.da.Ha(373,new lc(Y));Y.da.Ha(Xb.qRa,new Xb(Y))};Xb.qRa=255;Object(Yc.a)(Xb,"CopyPasteInfrastructureFactory",yd.a,[]);var hi=b(10),Lh=b(117),Kg=b(12),ai=dd.a;vm($b,ai);$b.prototype.dispose=function(){this.un();this.pk=this.qr=this.$=null;this.statusBarManager&&(this.statusBarManager.RF(this),this.statusBarManager=null)};$b.prototype.kn=function(){return this.l3f};
$b.prototype.$r=function(Y,Ra){if("QueryPasteShortcutEnabledLabel"!==Y&&!Array.contains($b.SGj,Y))return!1;var xb=this.so();"QueryPasteShortcutEnabledLabel"===Y?(Ra.Visible=xb,oc.ULS.sendTraceTag(537167636,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",xb,Y)):(Ra.Visible=!xb,oc.ULS.sendTraceTag(537167635,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",!xb,Y));return!0};$b.prototype.Vkh=function(){this.cl();this.raiseEvent("pasteShortcutStatusChanged")};
$b.prototype.g6b=function(){this.un();this.raiseEvent("pasteShortcutStatusChanged")};$b.prototype.so=function(){return this.R8c};$b.prototype.tq=function(Y){this.addHandler("pasteShortcutStatusChanged",Y)};$b.prototype.Mq=function(Y){this.removeHandler("pasteShortcutStatusChanged",Y)};$b.prototype.cl=function(){if(!this.so()){this.R8c=!0;bf.g(this.$).yj.Yl(this.DIe);this.pk.ja("blur",this.zfh);var Y=this.$.da.Aa(65);Y&&Y.o3&&Y.o3.registerForCommentEvents(this.CIe);this.qr.ot(Kg.a.Sb,this.gif?this.$.Vv:
this.$.domElement,this.onKeyDown,!0)}};$b.prototype.un=function(){if(this.so()){this.R8c=!1;bf.g(this.$).yj.ol(this.DIe);this.pk.detach("blur");var Y=this.$.da.Aa(65);Y&&Y.o3&&Y.o3.unregisterForCommentEvents(this.CIe);this.qr.ut(Kg.a.Sb,this.gif?this.$.Vv:this.$.domElement,this.onKeyDown,!0)}};$b.SGj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(Yc.a)($b,"PasteShortcutManager",dd.a,[848,185,186,3]);var Fh=b(122),Sg=yd.a;vm(pd,Sg);pd.prototype.create=function(){var Y=this.$;this.Fb(Y.da.Aa(478)||
this.$.da.Ha(478,new $b(Y,Lh.KeyInputManager.instance,Fh.a.instance.rE())))};pd.ja=function(Y){Y.da.Ha(479,new pd(Y))};Object(Yc.a)(pd,"PasteShortcutManagerFactory",yd.a,[]);sc.prototype.isEnabled=function(){if(Uc.AFrameworkApplication.ga?Uc.AFrameworkApplication.ga.ra("IsAnonymousUser"):1)return!1;var Y=Uc.AFrameworkApplication.Yb?Object(nb.a)(String,Uc.AFrameworkApplication.Yb.AudienceGroup):"";return"Unknown"!==Y&&"Automation"!==Y};Sk.Object.defineProperties(sc.prototype,{xWc:{configurable:!0,
enumerable:!0,get:function(){return"Excel"}},campaignId:{configurable:!0,enumerable:!0,get:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}},version:{configurable:!0,enumerable:!0,get:function(){return 1}},currentVersion:{configurable:!0,enumerable:!0,get:function(){return 0}},yhi:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.la(347)}},l7a:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.la(349)}},Nzb:{configurable:!0,enumerable:!0,
get:function(){return this.$.la(348)}},UDh:{configurable:!0,enumerable:!0,get:function(){return null}},Vqf:{configurable:!0,enumerable:!0,get:function(){return 24}},QUf:{configurable:!0,enumerable:!0,get:function(){return 4E3}},fIb:{configurable:!0,enumerable:!0,get:function(){return this.$.ya.WebServiceBase||""}}});Object(Yc.a)(sc,"FirstRunExperienceLauncherSettings",null,[847]);mb.prototype.LRd=function(){this.PUe&&this.PUe.LRd(this.GDh)};Object(Yc.a)(mb,"FirstRunExperienceManager",null,[846]);
var zg=yd.a;vm(Za,zg);Za.prototype.create=function(){this.Fb(this.$.da.Aa(311)||this.D6g())};Za.prototype.D6g=function(){var Y=new sc(this.$);Y=new mb(ee.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),Y);Y.LRd();return Y};Za.ja=function(Y){Y.da.Ha(312,new Za(Y))};Object(Yc.a)(Za,"FirstRunExperienceManagerFactory",yd.a,[]);var wh=b(57),ch=yd.a;vm(ec,ch);ec.prototype.create=function(){this.Fb(this.$.da.Aa(361)||this.n7g())};ec.prototype.n7g=function(){var Y=
this;this.nld=ee.a.instance.Oh("Common.IInProductMessagingUIManager");wh.a.Rf.isReactSharedHeaderUxEnabled?Vc.a.get_instance().kl(16,function(){Y.lbf()}):this.lbf();return this.nld};ec.prototype.lbf=function(){var Y=this;ee.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Ra){Ra.isFeatureEnabled("MsoPremiumBadge",!0).then(function(xb){!xb&&Ra.isFreemiumUpsellEnabled()&&Y.nld.Qlf();return null})})};ec.ja=function(Y){Y.da.Ha(362,new ec(Y))};Object(Yc.a)(ec,
"InProductMessagingManagerFactory",yd.a,[]);var Bg=b(817),Ah=b(98),eg=b(175),Mh=b(108);tb.prototype.uEb=function(Y){this.Hj=Y;if(!this.s1a){if(this.$Yd){if(this.L8a&&Oc.a.sF){this.URb=Y.E6b(Object(Ve.a)(this,this.lAd,"onFileChosen"));return}this.URb=Y.E6b(null);if(!this.NBa(this.URb,Y))return}this.finalizeUpload(Y,null)}};tb.prototype.lAd=function(Y){if(this.NBa(Y,this.Hj)){if(Oc.a.sF||Oc.a.Df)this.URb=Y;this.finalizeUpload(this.Hj,null)}};tb.prototype.Aoc=function(){this.aCd&&this.aCd()};tb.prototype.Ahj=
function(){this.fra=0;this.JEa=this.ga.Ad("Box4UploadRetryDelayStart",200);this.Hj&&(this.Hj.dispose(),this.Hj=null)};Sk.Object.defineProperties(tb.prototype,{context:{configurable:!0,enumerable:!0,get:function(){return this.cT}},ga:{configurable:!0,enumerable:!0,get:function(){return this.wb}},retryCount:{configurable:!0,enumerable:!0,get:function(){return this.fra}},ILd:{configurable:!0,enumerable:!0,get:function(){return this.JEa}}});Object(Yc.a)(tb,"FileUploader",null,[]);var pi=b(416),mg=b(909),
si=b(128);vm(Ya,tb);Ya.prototype.$Ze=function(Y){switch(Y){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}};Ya.prototype.Qfg=function(Y){return Ya.NBa(Y,this.W0h())};Ya.prototype.W0h=function(){return Ya.Ije};Ya.prototype.NBa=function(Y,Ra){Y=this.Qfg(Y);return 0!==Y?(Ra&&Ra.Ule(),2===Y&&this.vi(0,this.$Ze(Y)),!1):!0};Ya.prototype.finalizeUpload=function(Y,Ra){oc.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");
this.aCd=Ra;this.RBj();pi.a.mark(5576);this.CUb=this.OO.Hc("LoadResource","PictureUploadTime")};Ya.prototype.vi=function(Y,Ra){var xb=new si.StandardDialog;xb.jc=0;xb.Jz(Y,CommonUIStrings.l_ImageUploadFailedTitle,Ra,null)};Ya.prototype.Aoc=function(){oc.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");tb.prototype.Aoc.call(this);this.CUb&&(this.CUb.stop(),this.CUb=null);this.EZg()};Ya.prototype.RBj=function(){this.Ara=(new mg.a).create();this.Ara.message=CommonUIStrings.l_ImageUploadWait;
this.Ara.jc=5;this.Ara.Su=!1;this.Ara.MAa(null,null,null)};Ya.prototype.EZg=function(){this.Ara&&(this.Ara.close(),this.Ara=null)};Ya.P6h=function(Y,Ra){Y=Yf.a.Ol(Y);for(var xb=0;xb<Ra.length;++xb)if(Y.endsWith(Ra[xb]))return!0;return!1};Ya.NBa=function(Y,Ra){Ra=void 0===Ra?null:Ra;Ra||(Ra=Ya.Ije);return Y?Ya.P6h(Y,Ra)?0:2:1};Sk.Object.defineProperties(Ya.prototype,{OO:{configurable:!0,enumerable:!0,get:function(){return Uc.AFrameworkApplication.sa.xD}}});Ya.Ije=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");
Object(Yc.a)(Ya,"PictureUploader",tb,[]);var Wh=b(579),qg=b(303),Ca=b(140),ua=b(89),sb=b(170),Ld=b(172),le=b(82),nf=b(1247),ug=b(78),Cf=nf.a;vm(Eb,Cf);Eb.prototype.Frc=function(Y,Ra){this.isEnabled()&&this.vFa(this.targetOrigin)&&(this.Zn(Y),this.Kl(Y,Ra))};Object(Yc.a)(Eb,"InsertMediaCrossDocumentMessenger",nf.a,[897,379,3]);Object(Yc.a)(ub,"OnlineMediaSearchResult",null,[]);var Cg=b(306),Ag=Ca.a;vm(ib,Ag);ib.prototype.EBj=function(Y){var Ra=this;this.xgc=!1;this.showDialog(this.io,null);this.swa=
document.getElementById(this.ri("InsertMediaFrame"));if(!this.swa)throw this.wua(this.Wob),Error.invalidOperation("Couldn't get InsertMediaIframe.");var xb=document.getElementById(this.ri("WACDialogPanel"));xb&&xb.setAttribute(ua.a.Td,ua.a.rZa);xb=document.createElement("div");xb.id="KeepFocusStartDiv";xb.tabIndex=0;xb.className="keep-focus-start";this.swa.parentNode.insertBefore(xb,this.swa.parentNode.firstChild);xb=document.createElement("div");xb.id="KeepFocusDiv";xb.tabIndex=0;xb.className="keep-focus";
this.swa.parentNode.appendChild(xb);$addHandler(this.mIa,"keydown",this.ksd);this.swa.src=this.ubf;this.swa.frameBorder="0";xb=document.getElementById(this.ri("WACDialogButtonPanel"));if(!xb)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");xb.className="display-none";xb=document.getElementById(this.ri("WACDialogTitleText"));if(!xb)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");xb.className="display-none";2===this.vqf&&(document.getElementById(this.ri("WACDialogTitlePanel")).className=
"display-none",document.getElementById(this.ri("WACDialogBodyPanel")).className="padding-zero");uc.FocusManager.instance().XQ().scope.yR=!0;this.eS=new Eb(this.swa.contentWindow,this.ubf);this.eS.Frc(sb.a.EBg,function(fc){Ra.WGi(fc,Object(Ve.a)(Y,Y.Koa,"uploadResponseReceived"))});this.eS.Frc(sb.a.insert,function(){Ra.nOi(Object(Ve.a)(Y,Y.Koa,"uploadResponseReceived"))});this.eS.Frc(sb.a.YZc,this.cIi);2===this.vqf&&0===this.Teh&&(this.eS.Frc(sb.a.Vri,this.ZOi),this.uNa=this.Qnb.Fza("MsoPremiumStockImages",
function(fc){oc.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");if(fc.isEnabled){var bd={};Ra.eS.Sj(sb.a.fVj,(bd.LicenseTier=fc.toString(),bd))}else oc.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))};ib.prototype.dispose=function(){this.kAa=null;this.Qnb&&this.uNa&&this.Qnb.AId("MsoPremiumStockImages",this.uNa);this.eS&&(this.eS.dispose(),this.eS=null);Ag.prototype.dispose.call(this)};ib.prototype.hide=
function(){Ag.prototype.hide.call(this);le.a.Vvc(this.$)};ib.prototype.WGi=function(Y,Ra){Y=Y&&Y.Values?(Y=Y.Values)?Object.assign(new ub,{Action:Y.action||"",Caption:Y.caption||"",ContentType:Y.contentType||"",FileExtension:Y.extension||"",PageUrl:Y.pageUrl||"",SourceUrl:Y.sourceUrl||"",ThumbnailUrl:Y.thumbnailUrl||"",LicenseUrl:Y.licenseUrl||"",LicenseDisplayName:Y.licenseDisplayName||"",Height:Y.height||0,Width:Y.width||0}):null:null;Y&&(Array.add(this.kAa,Y),this.xgc&&(oc.ULS.sendTraceTag(537155809,
0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),Ra(this.kAa),this.xgc=!1,this.wua(this.Wob)))};ib.prototype.nOi=function(Y){this.kAa&&0<this.kAa.length?this.kAa.length<=this.Ype?(Y(this.kAa),this.wua(this.Wob)):(this.Jz(),oc.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),Array.clear(this.kAa)):this.xgc=!0};ib.prototype.q7g=function(){var Y=document.createElement("div");Y.id="InsertMediaDialog";Y.className=Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",
!0)?"insert-media-dialog":"insert-media-dialog-old";var Ra=document.createElement("div");Ra.id="InsertMediaPanel";Ra.className=Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";var xb=document.createElement("iframe");xb.id="InsertMediaFrame";xb.className="insert-media-frame";Y.appendChild(Ra);Ra.appendChild(xb);return Cg.b(Y)};ib.prototype.Jz=function(){var Y=zd.a.hd(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");
Y.Description=String.format(ce.a.instance.Cb(196),this.Ype.toLocaleString());Kc.EwaSettings.oz()?new ud.a(this.$,Y):(new Lc.ErrorDialog(this.$,Y)).mf()};Sk.Object.defineProperties(ib.prototype,{t4:{configurable:!0,enumerable:!0,get:function(){return Ld.a.Y5b+"/InsertMediaDialog"}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(Yc.a)(ib,"InsertMediaDialog",Ca.a,[]);var eh=b(462),jh=b(377);vm(vb,Ya);vb.prototype.Koa=function(Y){var Ra=this;if(Y){for(var xb=Array(Y.length),
fc=0;fc<Y.length;fc++){var bd=Y[fc];xb[fc]={};xb[fc].SourceUrl=bd.SourceUrl;Yf.a.Qwa(bd.LicenseUrl)&&Yf.a.Qwa(bd.PageUrl)&&(xb[fc].LicenseUrl=bd.LicenseUrl,xb[fc].LicenseDisplayName=bd.LicenseDisplayName,xb[fc].PageUrl=bd.PageUrl);xb[fc].AltText=-2053056795===this.ae.command?bd.Caption:""}var Dd=-2009825598===this.ae.command?"bing":"M365";fc=bf.g(this.$);var Td=vf.o(fc.ha.va.activeCell,this.$);td.a(this.$.userOperationManager,function(we,Oe,Te){return he.M(Ra.$.na.ta,Td,xb,Dd,jg.b(we,Ra.PQi),jg.a(Oe,
Ra.OQi),Te,null)},function(we){return new Ye.a(595,0,we)},this.ae);Ge.HelperMethods.c_?(fc=new Map,fc.set("MediaProvider",Dd),fc.set("ImagesCount",Y.length.toString()),fc.set("TimeTakenToOpenDialog",this.$nf.toString()),Cc.Health.instance.recordKpiUsage(jh.a.gdi,1,eh.a.l9f,fc)):oc.ULS.sendTraceTag(537155805,0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.Aoc()}else oc.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};
vb.prototype.dispose=function(){this.$=null};vb.prototype.showDialog=function(){var Y=this,Ra=null;Ra=this.$.Vb.Hc("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.ae.command){case -2009825598:this.QAj();break;case -2053056795:this.Dqe.execute(function(xb){xb.isFeatureEnabled("MsoPremiumStockImages",!1).catch(function(fc){return oc.ULS.sendTraceTag(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: {0}",fc)}).then(function(fc){Y.RAj(fc);
return null})})}Ra.stop();this.$nf=Ra.Dc};vb.prototype.QAj=function(){var Y=this.$.ya.BingPictureEndpoint,Ra=Wh.a.cK(Uc.AFrameworkApplication.lcid),xb=Gd.a.create();Y?(Y=0<Y.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(Y,1,1):String.format(Y,1,Uc.AFrameworkApplication.lcid,Ra?Ra.name:"en-us",Uc.AFrameworkApplication.buildVersion,xb.toString(),1,this.$.ya.DocumentHostInfo.LoggableUserId),this.S3b(Y,1,-1,ce.a.instance.fa(1714))):(oc.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),
this.T0.setException(Error.create("Failed to access the Bing service endpoint")))};vb.prototype.RAj=function(Y){var Ra=this.$.ya.M365PictureEndpoint,xb=Gd.a.create();if(Ra){var fc=this.$.ya.DocumentHostInfo.UserId;fc=fc?Yf.a.Qv(fc).toString():"0";var bd=this.Dqe.instance.isFreemiumUpsellEnabled();Y=Y?1:bd?0:-1;xb=xb.toString();bd=Wh.a.cK(Uc.AFrameworkApplication.lcid).name;Ra=String.format(Ra,Uc.AFrameworkApplication.lcid,bd,Uc.AFrameworkApplication.buildVersion,xb,1,fc,Y,1);this.S3b(Ra,2,Y,ce.a.instance.fa(1713))}else oc.ULS.sendTraceTag(537155803,
0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.T0.setException(Error.create("Failed to access the M365 service endpoint"))};vb.prototype.S3b=function(Y,Ra,xb,fc){try{(new ib(this.$,Y,ee.a.instance.Oh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Ra,xb,fc)).EBj(this),this.T0.setResult(!0)}catch(bd){oc.ULS.sendTraceTag(537155802,0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : {0}] [MediaProvider : {1}] [DialogLicenseTier : {2}]",
bd,Ra,xb),this.T0.setException(bd)}};Object(Yc.a)(vb,"OnlinePictureUploaderWrapper",Ya,[3]);Dc.prototype.executeCommand=function(Y,Ra,xb){Y=Ra.command;switch(Y){case 1403967063:if(xb&&"dataUrl"in xb)return Ra=new Kh.a,this.uploaderCreator&&this.uploaderCreator.Qai(this.$,Ah.a.instance,Uc.AFrameworkApplication.ga,xb,xb.dataUrl,Ra),Ra.task;this.uploaderCreator&&this.uploaderCreator.Sbi(this.$,Ra,Ah.a.instance,Uc.AFrameworkApplication.ga,xb);return Xf.Task.Ta(!0);case -2053056795:case -2009825598:return Y=
new Kh.a,new vb(this.$,Ra,Ah.a.instance,Uc.AFrameworkApplication.ga,xb,Y),Y.task;default:return eg.a(Y)}};Dc.prototype.Jc=function(Y,Ra){if(Y=this.$.isEditMode)switch(Ra.command){case 1403967063:Y=!0;break;case -2053056795:Y=!0;break;case -2009825598:Y=Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures");break;default:Y=!1}return Y};Dc.prototype.fd=function(){return!1};Dc.prototype.Yc=function(){return!1};Object(Yc.a)(Dc,"PictureCommandHandler",null,[188]);var Pg=Bg.a;vm(Mb,
Pg);Mb.prototype.Od=function(){var Y=this;Fb.TaskExtensions.Ba(Ph.GetServiceTaskFactory.Wa(this.$.da,484,485,1),function(Ra){Y.Fd([new Dc(Y.$,Ra.result)])},this.$.ma,3)};Mb.ja=function(Y){Bg.a.fe(90,new Mb(Y))};Object(Yc.a)(Mb,"PictureCommandHandlerFactory",Bg.a,[]);var te=b(516),Fg=b(411),og=b(74),mh=b(555),cg=b(595),li=mh.a;vm(cb,li);cb.prototype.DPd=function(Y){this.Pfa!==Y&&(this.Pfa=Y,this.bGb())};cb.prototype.dispose=function(){this.gridView.yc.ol(this.Gvf);this.gridView.yc.Pn(this.Fvf);this.gridView=
null;li.prototype.dispose.call(this)};cb.prototype.bGb=function(){this.nGd(this.Pfa)};cb.prototype.refresh=function(){this.DPd(!this.gridView.isEditing)};Sk.Object.defineProperties(cb.prototype,{GK:{configurable:!0,enumerable:!0,get:function(){return this.Zkc(this.Pfa)}},name:{configurable:!0,enumerable:!0,get:function(){return cg.a.cellEdit}}});Object(Yc.a)(cb,"CellEditSafeStatePublisher",mh.a,[]);Object(Yc.a)(Ga,"SafeStatePublisherState",null,[]);var fh=b(656),pf=dd.a;vm(za,pf);za.prototype.eZb=
function(Y){this.addHandler(za.ZQa,Y)};za.prototype.Osc=function(Y){this.removeHandler(za.ZQa,Y)};za.prototype.Hza=function(Y,Ra){function xb(Dd,Td){bd.GK=Td.GK;fc.qGd()}var fc=this,bd=new Ga(Y,Ra);this.$Qa.add(bd);Y.eZb(xb);bd.handler=xb;this.qGd()};za.prototype.EXd=function(Y){for(var Ra=null,xb=yl(this.$Qa),fc=xb.next();!fc.done;fc=xb.next())if(fc=fc.value,fc.publisher===Y){this.Dcg(fc);Ra=fc;break}Ra&&(this.$Qa.remove(Ra),this.qGd())};za.prototype.dispose=function(){for(var Y=yl(this.$Qa),Ra=
Y.next();!Ra.done;Ra=Y.next())this.Dcg(Ra.value);this.$Qa.clear();pf.prototype.dispose.call(this)};za.prototype.P$b=function(){return ea.P$b(this.$Qa.toArray().map(function(Y){return Y.GK}))};za.prototype.Dcg=function(Y){Y.publisher.Osc(Y.handler)};za.prototype.qGd=function(){var Y=this.P$b();Y!==this.Gkf&&(this.raiseEvent(za.ZQa,new fh.a(Y)),this.Gkf=Y)};Sk.Object.defineProperties(za.prototype,{LQj:{configurable:!0,enumerable:!0,get:function(){return ti.f(ti.c(this.$Qa.toArray(),function(Y){return 0!=
Y.GK}),function(Y){return Y.publisher.name})}}});za.ZQa="SSC";Object(Yc.a)(za,"ClientStateMonitor",dd.a,[]);var Qf=b(6),$g=b(65),yg=mh.a;vm(ya,yg);ya.prototype.DPd=function(Y){Y!==this.Pfa&&(this.Pfa=Y,this.bGb())};ya.prototype.dispose=function(){$g.a(this.$).zsc(this.Kwf);this.o5a.Mq(this.SN);this.i8d=null;yg.prototype.dispose.call(this)};ya.prototype.bGb=function(){this.nGd(this.Pfa)};ya.prototype.refresh=function(){this.DPd(1===this.o5a.Ot||$g.a(this.$).yi===this.o5a)};Sk.Object.defineProperties(ya.prototype,
{GK:{configurable:!0,enumerable:!0,get:function(){return this.Zkc(this.Pfa)}},name:{configurable:!0,enumerable:!0,get:function(){return cg.a.o5a}},o5a:{configurable:!0,enumerable:!0,get:function(){return this.i8d}}});Object(Yc.a)(ya,"IdleActivitySafeStatePublisher",mh.a,[]);var lh=b(308),h=b(3),Bb=og.a;vm(eb,Bb);eb.prototype.Yc=function(){return!1};eb.prototype.executeCommand=function(){return Xf.Task.Ta(!0)};eb.prototype.Jc=function(Y,Ra){return 1905775613===Ra.command};eb.prototype.fd=function(){return!1};
Object(Yc.a)(eb,"ToggleMergeSuspensionSafeState",og.a,[188]);var qc=dd.a;vm(Cb,qc);Cb.prototype.tq=function(Y){this.addHandler(Cb.ywd,Y)};Cb.prototype.Mq=function(Y){this.removeHandler(Cb.ywd,Y)};Cb.prototype.vz=function(){this.raiseEvent(Cb.ywd)};Cb.prototype.kn=function(Y){return Y===Cb.J3i&&!!this.mergeSuspensionManager};Cb.prototype.$r=function(Y,Ra){if(!this.kn(Y))return!1;this.mergeSuspensionManager&&(Ra.LabelText=this.Jlc,Ra.On=this.Txd);return!0};Cb.prototype.dispose=function(){this.GMb&&
(this.Ka.Rab(this.GMb),this.GMb.dispose(),this.GMb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.y$a.oHb(this.IDb),this.mergeSuspensionManager.Tha.Osc(this.ROa),this.mergeSuspensionManager=null);this.statusBarManager&&(this.statusBarManager.RF(this),this.statusBarManager=null);this.Jlc=null;qc.prototype.dispose.call(this)};Cb.ywd="MSMSC";Cb.J3i="QueryMergeSuspensionStatus";Object(Yc.a)(Cb,"MergeSuspensionIndicatorManager",dd.a,[185,186,3]);var W=b(1022),va=Sys.EventArgs;vm(Ka,va);
Object(Yc.a)(Ka,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);var N=b(1023),k=dd.a;vm(ma,k);ma.prototype.H$h=function(){return Object(Fg.a)(za,this.Tha)?Object(nb.a)(za,this.Tha).P$b():1};ma.prototype.hZb=function(Y){this.addHandler(ma.YVd,Y)};ma.prototype.Psc=function(Y){this.removeHandler(ma.YVd,Y)};ma.prototype.KGg=function(Y){this.addHandler(ma.XGd,Y)};ma.prototype.Idj=function(Y){this.removeHandler(ma.XGd,Y)};ma.prototype.SFg=function(Y){this.addHandler(ma.twd,Y)};ma.prototype.bdj=
function(Y){this.removeHandler(ma.twd,Y)};ma.prototype.n5i=function(){this.lGd(1===this.getState())};ma.prototype.dispose=function(){this.Tha.Osc(this.ROa);this.Tha=null;this.y$a.oHb(this.IDb);this.y$a=null;k.prototype.dispose.call(this)};ma.prototype.Nfd=function(){return Object.assign(new W.a,{Current:this.Gla.Current,Pending:this.Gla.Pending,SuspensionStartTimestamp:this.Gla.SuspensionStartTimestamp})};ma.prototype.getState=function(){return Ta(this.Gla)?0==this.GK?2:1:0};ma.prototype.AUe=function(Y,
Ra){Y!==Ra&&(1===Ra?this.lGd(!0):1===Y&&this.lGd(!1));2===Ra&&this.raiseEvent(ma.XGd,new N.a(this.Gla))};ma.prototype.ewi=function(Y,Ra,xb){0===Y&&0!==Ra?(Y=1===Ra,oc.ULS.sendTraceTag(252760283,0,50,"MergeSuspensionState.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: {0} publisher: {1} counter: {2}",Y,Y?this.Tha.LQj.join(","):"",ob(this.Gla))):0!==Y&&0===Ra&&oc.ULS.sendTraceTag(252760284,0,50,"MergeSuspensionState.LogPendingMergesStatusChanged: No pending changes. counter: {0}",
ob(xb))};ma.prototype.lGd=function(Y){this.raiseEvent(ma.YVd,new Ka(Y))};ma.YVd="TPMBBC";ma.XGd="RFPMU";ma.twd="MCC";Object(Yc.a)(ma,"MergeSuspensionState",dd.a,[]);var E=dd.a;vm(hc,E);hc.prototype.tnb=function(Y){this.addHandler("MCU",Y)};hc.prototype.oHb=function(Y){this.removeHandler("MCU",Y)};hc.prototype.OOa=function(Y,Ra){Ra=void 0===Ra?"":Ra;var xb=this.W1.Current<Y.Current||this.W1.Pending<Y.Pending;if(Y.SuspensionStartTimestamp&&this.Wic!==Y.SuspensionStartTimestamp){if(this.Wic>Y.SuspensionStartTimestamp){xb&&
oc.ULS.sendTraceTag(553736149,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via {0}. S: {1}, C: {2}",Ra,hc.TBb(Y),hc.TBb(this.W1));return}xb||oc.ULS.sendTraceTag(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: {0}, C: {1}",hc.TBb(Y),hc.TBb(this.W1))}else if(!xb)return;this.W1=Y;this.SLf(Y)};hc.prototype.dispose=function(){this.$.ea.lk(this.vvc);this.$.ea.QW(this.vvc);this.$.na.yr(this.f8);
bf.g(this.$).yc.Pn(this.s9a);var Y=this.$.da.Aa(292);Y&&Y.oHb(this.UBb);E.prototype.dispose.call(this)};hc.prototype.SLf=function(Y){Ta(Y)&&Y.SuspensionStartTimestamp>this.Wic&&(oc.ULS.sendTraceTag(537155416,0,50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: {0}",ob(Y)),this.Wic=Y.SuspensionStartTimestamp);this.raiseEvent("MCU",new N.a(Y))};hc.prototype.MTf=function(){oc.ULS.sendTraceTag(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was {0}",
hc.TBb(this.W1));this.W1=Object.assign(new W.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})};hc.TBb=function(Y){return Y?String.format("({0}/{1} @{2})",Y.Current,Y.Pending,Y.SuspensionStartTimestamp):"null"};Sk.Object.defineProperties(hc.prototype,{Gla:{configurable:!0,enumerable:!0,get:function(){return this.W1}}});hc.r_d="PMM.RTC";hc.G7c="PMM.EwaResult";Object(Yc.a)(hc,"PendingMergeMonitor",dd.a,[]);Object(Yc.a)(jb,"ClientRevisions",null,[]);var M=b(199),aa=b(26);Xa.prototype.aZi=function(Y){var Ra=
this;if(this.KKb(Y))(new Kh.a).setResult(!0);else{var xb=this.bZi(Y);this.Vic=Y;this.iCd++;xb.CWCT(function(){Ra.sKi()},M.a.none,0,this.TO)}};Xa.prototype.bZi=function(Y){function Ra(){var Td;null===(Td=xb.Kda)||void 0===Td?void 0:Td.YGi();oc.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeThrottler.performDoPendingMergeInternal: request failed {0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp)}var xb=this,fc=this.ta.Zb();this.KDj&&this.isDocumentHidden||this.oy();this.qZd=this.mh.Lea;
oc.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeThrottler.performDoPendingMergeInternal: Sending DoPendingMerge {0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp);if(this.Kda){var bd=yl(this.Kda.qVi()),Dd=bd.next().value;bd=bd.next().value;return db(this.ta,bd,Dd?null:this.tKi.bind(this),Ra,null,null,fc)}return Ja(this.ta,null,Ra,null,null,fc)};Xa.prototype.KKb=function(Y){if(this.oGe&&this.isDocumentHidden)return this.mh.Lea-this.qZd<this.s7h;if(!this.Vic||Y.SuspensionStartTimestamp>
this.Vic.SuspensionStartTimestamp)return this.MLa&&oc.ULS.sendTraceTag(528561877,0,50,"DoPendingMergeThrottler.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: {0} / {1} @{2}",Y.Current,Y.Pending,Y.SuspensionStartTimestamp),!1;if(this.MLa)Y=!0;else{var Ra=this.Vic;Y=(Y||Ra?Y&&Ra?Y.Current===Ra.Current&&Y.Pending===Ra.Pending&&Y.SuspensionStartTimestamp===Ra.SuspensionStartTimestamp:!1:!0)&&this.mh.Lea-this.qZd<this.LKd}return Y};Xa.prototype.sKi=function(){this.iCd--};
Xa.prototype.tKi=function(Y){this.Kda&&this.Kda.ZGi(Y.Result,Y.StateId)};Sk.Object.defineProperties(Xa.prototype,{MLa:{configurable:!0,enumerable:!0,get:function(){return 0<this.iCd}},isDocumentHidden:{configurable:!0,enumerable:!0,get:function(){return!!this.documentVisibilityObserver&&this.documentVisibilityObserver.Di}}});Object(Yc.a)(Xa,"DoPendingMergeThrottler",null,[463]);Sk.Object.defineProperties(Ha.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return"SelectionAdjust"}}});
Object(Yc.a)(Ha,"SelectionAdjustSessionEndsReport",null,[285]);Pa.prototype.ugg=function(Y){if(!this.p2d)return oc.ULS.sendTraceTag(525135954,0,10,"Selection.viewportBlocksReadyForAdjust: _blockCacheItems undefined"),!1;for(var Ra=yl(this.p2d),xb=Ra.next();!xb.done;xb=Ra.next())if(xb=xb.value,xb.ik&&xb.ke.Revision<Y)return!1;return!0};Pa.prototype.FLj=function(){var Y;if(this.igb)return{SheetName:this.sheetName,ActiveCell:null===(Y=this.activeCell)||void 0===Y?void 0:Y.toString(),SelectedRange:this.selectedRanges[0].toString(),
TopLeft:void 0}};Pa.prototype.toString=function(){var Y,Ra;return String.format("active cell: {0} selection: {1}",null!==(Ra=null===(Y=this.activeCell)||void 0===Y?void 0:Y.toString())&&void 0!==Ra?Ra:"null",ti.f(this.selectedRanges,function(xb){var fc;return null!==(fc=null===xb||void 0===xb?void 0:xb.toString())&&void 0!==fc?fc:"null"}).join(","))};Pa.prototype.equals=function(Y){return Y?this.activeCell.equals(Y.activeCell)&&vf.Q(this.selectedRanges,Y.selectedRanges)&&this.sheetName===Y.sheetName:
!1};Sk.Object.defineProperties(Pa.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return this.sG}},selectedRanges:{configurable:!0,enumerable:!0,get:function(){return this.u9}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.UVb}},activeItemName:{configurable:!0,enumerable:!0,get:function(){return this.Bkg}},igb:{configurable:!0,enumerable:!0,get:function(){return 1===this.selectedRanges.length}}});Object(Yc.a)(Pa,"SelectionState",null,[]);var na=b(207),qb;
(function(Y){Y[Y.none=0]="none";Y[Y.waitingForAdjusted=1]="waitingForAdjusted";Y[Y.invalid=2]="invalid";Y[Y.nonContinuous=3]="nonContinuous";Y[Y.noAdjustRequired=4]="noAdjustRequired";Y[Y.waitingForViewport=5]="waitingForViewport";Y[Y.adjusted=6]="adjusted";Y[Y.divergence=7]="divergence";Y[Y.exception=8]="exception"})(qb||(qb={}));Object(Yc.b)("SelectionAdjustState",qb);pa.prototype.qVi=function(){this.wY.totalRequests++;if(this.xfi())return this.wY.parallel++,oc.ULS.sendTraceTag(526390086,0,15,"SelectionAdjustManager.onWaitingForAdjustedSelection: Skipping parallel request. Current adjustedSelection is defined : {0}",
!!this.dE),[!0,null];oc.ULS.shipAssertTag(525135961,0,0===this.XH,"SelectionAdjustManager.onWaitingForAdjustedSelection: unexpected state");this.dE&&(this.wY.errors++,oc.ULS.sendTraceTag(526960090,0,10,"SelectionAdjustManager.onWaitingForAdjustedSelection: About to ignore a defined Adjusted selection: {0}",this.dE.toString()));this.dE=null;this.LC=this.fKa();var Y=null,Ra=this.LC.FLj();Ra&&(Y={ActiveSheetName:this.LC.sheetName,SheetViewportStateChanges:[Ra]});this.XH=1;return[!1,Y]};pa.prototype.YGi=
function(){oc.ULS.shipAssertTag(525135960,0,1===this.XH,"SelectionAdjustManager.onAdjustedRequestFailed: unexpected state");this.wY.errors++;this.XH=2;this.Ur()};pa.prototype.ZGi=function(Y,Ra){try{oc.ULS.shipAssertTag(525135959,0,1===this.XH,"SelectionAdjustManager.onAdjustedSelectionReady: unexpected state"),this.Byc=Ra,Ra=2,this.LC?Y?(this.dE=this.Wwj(Y))?(Ra=5,this.LC.igb)?this.LC.equals(this.dE)&&(this.wY.adjustedDidntChange++,Ra=4):(this.wY.nonContinuous++,Ra=3):this.wY.errors++:(this.wY.errors++,
oc.ULS.sendTraceTag(537155412,0,15,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: {0}",this.LC.toString())):(this.wY.errors++,oc.ULS.sendTraceTag(537155413,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: {0}, SelectedRange: {1}",null===Y||void 0===Y?void 0:Y.ActiveCell,null===Y||void 0===Y?void 0:Y.SelectedRange)),this.XH=Ra}catch(xb){this.XH=8,oc.ULS.sendTraceTag(525135958,
0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: caught Exception {0}",xb)}finally{5!=this.XH&&this.Ur()}};pa.prototype.dispose=function(){this.gridView.Ca.Kq(this.Jg);this.gridView.Ca.pp(this.m9a);this.gridView.Ca.uQf(this.m9a);this.gridView.Ca.Xab(this.m9a)};pa.prototype.Wwj=function(Y){var Ra=this,xb,fc;return function(){var bd=vf.Z(Y.ActiveCell,Ra.$.xa);xb=bd.range;return bd}().returnValue?function(){var bd=vf.Z(Y.SelectedRange,Ra.$.xa);fc=bd.range;return bd}().returnValue?new this.LXf(this.$,
xb,[fc],Y.SheetName,this.LC.activeItemName):(oc.ULS.sendTraceTag(537155410,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract selected range {0}",Y.SelectedRange),null):(oc.ULS.sendTraceTag(537155411,0,10,"SelectionAdjustManager.sheetViewportStateToSelectionState: Unable to extract active cell {0}",Y.ActiveCell),null)};pa.prototype.fKa=function(){var Y=this.$.pa;if((null===Y||void 0===Y?0:Y.activeCell)&&Y.selectedRanges&&Y.sheetName)return new this.LXf(this.$,Y.activeCell,
Y.selectedRanges,Y.sheetName,this.$.activeItemName);this.JXf&&oc.ULS.sendTraceTag(525135957,0,10,"SelectionAdjustManager.getCurrentSelection: invalid activeItem. activeItem null: {0}, activeCell null: {1}, selectedRanges null: {2}, sheetName null: {3}",!Y,!(null===Y||void 0===Y?0:Y.activeCell),!(null===Y||void 0===Y?0:Y.selectedRanges),!(null===Y||void 0===Y?0:Y.sheetName));return null};pa.prototype.hte=function(Y){if(this.jmi(Y))try{oc.ULS.shipAssertTag(525135956,0,5===this.XH,"SelectionAdjustManager.attemptAdjustSelection: unexpected state"),
this.LC.equals(this.fKa())?(this.wY.adjusted++,this.gridView.wV(this.dE.selectedRanges,0,this.dE.sheetName,null,this.dE.activeCell,null,null,0,Df.a.tnj),this.XH=6):(this.wY.divergence++,this.Ofj(),this.XH=7)}catch(Ra){this.XH=8,oc.ULS.sendTraceTag(525135955,0,10,"SelectionAdjustManager.attemptAdjustSelection: caught Exception {0}",Ra)}finally{this.Ur()}};pa.prototype.jmi=function(Y){if(!this.dE)return!1;if(!this.LC)return oc.ULS.sendTraceTag(537155409,0,10,"SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: {0}",
this.dE.toString()),!1;if(Y){if(bf.g(this.$).Ca.dqf<this.Byc)return!1;this.LC.igb&&oc.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust")}else if(!this.LC.igb||!this.LC.ugg(this.Byc)||!this.dE.ugg(this.Byc))return!1;return!0};pa.prototype.Ur=function(){var Y,Ra,xb,fc;this.vgj&&2!=this.XH&&oc.ULS.sendTraceTag(526792898,0,50,"SelectionAdjustManager.clearState: initial: {0}, adjusted: {1}, state: {2}",null!==
(Ra=null===(Y=this.LC)||void 0===Y?void 0:Y.toString())&&void 0!==Ra?Ra:"null",null!==(fc=null===(xb=this.dE)||void 0===xb?void 0:xb.toString())&&void 0!==fc?fc:"null",qb[this.XH]);this.LC=this.dE=null;this.XH=0};pa.prototype.Ofj=function(){var Y=this.fKa();oc.ULS.sendTraceTag(537155408,0,50,"SelectionAdjustManager.ReportDivergence: initial: {0} current: {1} adjusted: {2} sheetSameBetweenInitialAndAdjusted: {3} sheetSameBetweenInitialAndCurrent: {4}",this.LC.toString(),Y?Y.toString():"",this.dE.toString(),
this.LC.sheetName===this.dE.sheetName,this.LC.sheetName===(Y?Y.sheetName:null))};pa.prototype.xfi=function(){return this.JXf?1===this.XH||5===this.XH:!!this.LC||!!this.dE};Sk.Object.defineProperties(pa.prototype,{LXf:{configurable:!0,enumerable:!0,get:function(){return Pa}}});Object(Yc.a)(pa,"SelectionAdjustManager",null,[462,3]);var Pb=dd.a;vm(qa,Pb);qa.prototype.dispose=function(){this.$.na.tda(this.g8);this.Gyc();this.Y5.Idj(this.kCf);this.Y5.Psc(this.rEb);this.Y5.bdj(this.xAf);this.Y5=null;this.Kda&&
this.Kda.dispose();Pb.prototype.dispose.call(this)};qa.prototype.eGj=function(){this.Gyc();if(this.pIe()){var Y=this.Y5.Nfd();oc.ULS.sendTraceTag(537155414,0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter {0} fail count: {1}",ob(Y),this.fAb)}else this.gAb=this.fsa.create(this.$Xf,this.LKd,Qh.a.gAb),this.z7a=this.fsa.nC(this.$Xf,this.Lqi,Qh.a.z7a)};qa.prototype.Gyc=function(){this.z7a&&(this.gAb.cancel(),
this.z7a.cancel(),this.z7a=this.gAb=null)};qa.prototype.IOi=function(Y){var Ra=" fail count: "+this.fAb;this.fAb++;this.pIe()&&this.Gyc();oc.ULS.sendTraceTag(542229773,0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed {0}{1}",ob(Y),Ra)};qa.prototype.pIe=function(){return this.fAb>qa.Kzi};qa.Kzi=5;Object(Yc.a)(qa,"RequestController",dd.a,[]);var Jc=og.a;vm(ea,Jc);ea.prototype.hZb=function(Y){this.Xfa.hZb(Y)};ea.prototype.Psc=function(Y){this.Xfa&&this.Xfa.Psc(Y)};ea.prototype.Hza=
function(Y,Ra){this.ICa.Hza(Y,Ra)};ea.prototype.EXd=function(Y){this.ICa.EXd(Y)};ea.prototype.OOa=function(Y,Ra){this.Ekb.OOa(Y,void 0===Ra?"":Ra)};ea.prototype.dispose=function(){this.uec&&(this.uec.dispose(),this.uec=null);this.GKd&&(this.GKd.dispose(),this.GKd=null);this.Xfa&&(this.Xfa.dispose(),this.Xfa=null);this.Ekb.dispose();this.Ekb=null;this.ICa.dispose();this.ICa=null;this.D_a&&(this.D_a.dispose(),this.D_a=null);this.p5a&&(this.p5a.dispose(),this.p5a=null);this.$=null;Jc.prototype.dispose.call(this)};
ea.prototype.bGb=function(){this.Xfa.n5i()};ea.P$b=function(Y){var Ra=0;Y=yl(Y);for(var xb=Y.next();!xb.done;xb=Y.next()){xb=xb.value;if(2==xb)return 2;1==xb&&(Ra=1)}return Ra};ea.prototype.bai=function(Y,Ra){this.ICa=new za;Ra?Object(Fg.a)(ya,Ra)?this.Hza(Ra,Object(nb.a)(ya,Ra).GK):Object(Fg.a)(cb,Ra)?this.Hza(Ra,Object(nb.a)(cb,Ra).GK):this.Hza(Ra,0):(this.D_a=new cb(Y),this.p5a=new ya(Y),this.Hza(this.D_a,this.D_a.GK),this.Hza(this.p5a,this.p5a.GK))};Sk.Object.defineProperties(ea.prototype,{Tha:{configurable:!0,
enumerable:!0,get:function(){return this.ICa}},y$a:{configurable:!0,enumerable:!0,get:function(){return this.Ekb}},Y5:{configurable:!0,enumerable:!0,get:function(){return this.Xfa}}});Object(Yc.a)(ea,"MergeSuspensionManager",og.a,[402,3]);var ad=yd.a;vm(ja,ad);ja.prototype.create=function(){oc.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.Fb(this.Oc.da.Aa(343)||this.Oc.da.Ha(343,new ea(this.Oc,dh.a.instance)))};ja.ja=function(Y){oc.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");
Y.da.Ha(344,new ja(Y))};Object(Yc.a)(ja,"MergeSuspensionFactory",yd.a,[]);ca.fti=3;ca.connected=0;Object(Yc.a)(ca,"ConnectionStateConstants",null,[]);var ia=b(107),Qa=b(113),Nb=b(41);X.prototype.KZf=function(){this.durationMs=Qa.a(aa.a.Ra,this.startTime)};X.prototype.mBd=function(Y){var Ra=this,xb;this.KZf();Nb.a(Y).Msc(this.nvf);Nb.a(Y).sg.Nsc(this.zca);Y.da.Za(291,function(fc){fc.Zab(Ra.mW)});if(null===(xb=Y.ea)||void 0===xb?0:xb.wf)Y.ea.wf.TJd(this.dCd),this.wasUserActiveOnPIEnd=Y.ea.wf.pr};X.prototype.cl=
function(Y){var Ra=this;Nb.a(Y).aZb(this.nvf);this.isToastShown?this.toastRaiser="Immediate":Nb.a(Y).sg.vVc(this.zca);Y.da.Za(291,function(xb){Ra.hasTabbedOut=xb.Di;xb.DFa(Ra.mW)});this.wasUserActiveOnPIStart&&Y.ea.wf.Yoe(this.dCd)};Object(Yc.a)(X,"PartialInteractivityData",null,[]);var tc=b(1210);vm(fa,X);fa.prototype.oJi=function(Y,Ra){this.swappedByOffline=Ra;this.mBd(Y)};fa.prototype.krj=function(Y){this.errorDataDuringConnectivityIssuesMode=Y};fa.prototype.P7i=function(Y){10>this.failedRequests.length&&
(Y=Y+"_"+ia.getElapsedSeconds(this.startTime,aa.a.Ra.Kb).toString(),this.failedRequests.push(Y))};Object(Yc.a)(fa,"ConnectivityIssuesData",X,[]);var gd=b(166);da.Eih="DuringWork";da.connectivityIssues="ConnectivityIssues";da.offline="Offline";Object(Yc.a)(da,"UnavailabilityTypes",null,[]);K.prototype.dispose=function(){this.$&&(Nb.a(this.$).sg.EQf(this.Awf),this.$.sf&&this.$.sf.DQf(this.xwf));this.data&&this.$.na.sf.FRf(this.Mn);this.$=null};K.prototype.DTg=function(Y){var Ra=this.had-1;return(this.data.averageDurationBetweenFailedRequestsSec*
(Ra-1)+Y)/Ra};Object(Yc.a)(K,"ConnectivityIssuesTelemetryManager",null,[3]);var Rc=b(989),Xd=b(1255),pe=b(1209);S.prototype.dispose=function(){this.$&&(this.UQd&&this.$.na&&0<this.Q8a.count&&this.$.na.yr(this.Nh),this.VQd&&(this.MTd("Dispose"),this.$.ea.wf.Pza(this.yca)))};S.prototype.G$h=function(){Kc.EwaSettings.la(213)&&this.H0i();this.VQd&&this.I0i()};S.prototype.cai=function(){this.LCb=this.MCb;this.Asd=0;var Y={};if(!this.Q8a){this.Q8a=new rf.a;var Ra=Xd.a.Vcd(this.ugj,"InitSampleMeasurement",
this.$);Ra=yl(Ra);for(var xb=Ra.next();!xb.done;xb=Ra.next())xb=xb.value,Y[xb.wkd]=xb.baseUrl,this.Q8a.add(xb)}Y=Sys.Serialization.JavaScriptSerializer.serialize(Y);oc.ULS.sendTraceTag(537155210,0,50,"Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: {0}, numberOfRequestFromTheLastNetworkMeasurement: {1}, testParams: {2} ",this.MCb,this.LCb,Y);0<this.Q8a.count&&this.$.na.uq(this.Nh)};S.prototype.xGj=function(){for(var Y=yl(this.Q8a),Ra=Y.next();!Ra.done;Ra=Y.next())Ra.value.oMd()};
S.prototype.tTd=function(Y){this.uSa&&this.uSa.fp||(oc.ULS.sendTraceTag(537155208,0,50,"NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: {0}",Y),this.uSa=dh.a.instance.nC(this.Ynj,5E3,Qh.a.vEj),this.uSa.Cka())};S.prototype.MTd=function(Y){this.uSa&&this.uSa.fp&&(oc.ULS.sendTraceTag(537155207,0,50,"NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: {0}",Y),this.uSa.cancel())};S.prototype.xyj=function(Y){return this.LCb>=this.MCb&&Y-this.Asd>this.Fwd};
S.prototype.iXg=function(){return S.RUf(this.$.ya.SlowNetworkMeasurementsSamplePercentage)};S.prototype.H0i=function(){this.MCb=this.$.ya.NumberOfRequestToWaitPerNetworkMeasurement;this.Fwd=1E3*this.$.ya.MinTimeBetweenNetworkMeasurementInSec;var Y=this.$.ya.NetworkMeasurementsSamplePercentage;0<this.MCb&&0<this.Fwd&&(this.UQd=S.RUf(Y))&&this.cai()};S.prototype.I0i=function(){if(!this.eyc){this.eyc=new rf.a;var Y=Xd.a.Vcd(this.Kfj,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[pe.a.KDc]);
Y=yl(Y);for(var Ra=Y.next();!Ra.done;Ra=Y.next())this.eyc.add(Ra.value);this.$.ea.wf.pr&&this.tTd("PrepareAndInitSlowNetworkTests")}};S.RUf=function(Y){return 100*Math.random()<Y};Object(Yc.a)(S,"NetworkMeasurement",null,[3]);var cf=b(913);H.prototype.ZRj=function(){this.FU&&this.FU.KZf()};H.prototype.iCg=function(Y){this.allOfflinePartialInteractivitiesDataInSession.push(Y);this._count++};Sk.Object.defineProperties(H.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}},
FU:{configurable:!0,enumerable:!0,get:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}}});Object(Yc.a)(H,"OfflinePartialInteractivitiesDataForLog",null,[]);vm(T,X);T.prototype.Ouj=function(Y){this.timeFromLastOffline=Y};T.prototype.lrj=function(Y){this._errorDataDuringOfflineMode=Y};Object(Yc.a)(T,"OfflinePartialInteractivityData",X,[]);ba.prototype.dispose=function(){this.$&&Nb.a(this.$)&&Nb.a(this.$).sg.zJd(this.K9a);
ih.a.Fa(this.Ktb);this.$=this.Ktb=null};ba.prototype.vQi=function(Y){this.FU=new T(aa.a.Ra.Kb,this.$,0!==Y);this.FU.Ouj(-1!==this.$Ed?window.performance.now()-this.$Ed:-1);this.rOa.iCg(this.FU);Nb.a(this.$).sg.vVc(this.zca);this.N2a();this.Ktb=dh.a.instance.nC(this.N2a,ba.uEh,Qh.a.N2a);gd.a(this.$).YUc(this.YVf)};ba.prototype.wQi=function(){this.FU.mBd(this.$);this.N2a();ih.a.Fa(this.Ktb);this.Ktb=null;this.$Ed=window.performance.now();Nb.a(this.$).sg.Nsc(this.zca);gd.a(this.$).kJd(this.YVf);this.Lfj()};
ba.prototype.nlj=function(Y,Ra){var xb=this;this.$?this.Ikf=Fb.TaskExtensions.Ba(this.Ikf,function(){xb.indexedDB.Vbb(new cf.a(Y,Ra))},this.$.ma):oc.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")};ba.prototype.Ffj=function(){var Y=this.$.ma;Fb.TaskExtensions.Ba(Fb.TaskExtensions.Ba(this.indexedDB.kKa(ba.eDd),this.kgj,Y),this.raj,Y)};ba.prototype.Lfj=function(){if(this.FU){var Y=Sys.Serialization.JavaScriptSerializer.serialize(this.FU);
Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?af.b().hJb(560791645,0,50,da.offline,this.FU.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Y):oc.ULS.sendTraceTag(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",Y)}Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&
this.FU&&this.FU.isToastShown&&Cc.Health.instance.recordQosError(Ea.a.KVj,[kb.a.qjc],!0,!1,!1,!1,null)};ba.wld="NetworkAvailability";ba.xld="NetworkAvailabilityData";ba.eDd="partialInteractivityData";ba.uEh=3E3;Object(Yc.a)(ba,"OfflineModeTelemetryManager",null,[3]);la.prototype.dispose=function(){ih.a.Fa(this.iuf);ih.a.Fa(this.Gxd);ih.a.Fa(this.Lla);ih.a.Fa(this.H1g);this.$=null};Object(Yc.a)(la,"NetworkConnectionTelemetryManager",null,[3]);vm(Q,X);Q.prototype.K9a=function(){this.wasInteruptedByOfflineMode=
!0};Object(Yc.a)(Q,"SilentReopenData",X,[]);U.prototype.dispose=function(){this.sg.dRf(this.sAf);this.sg.hej(this.aEf);this.B7=this.sg=this.$=null};U.prototype.YDf=function(Y,Ra){Y.PP?this.B7=new Q(aa.a.Ra.Kb,this.$,0!==Y.goa,Ra):(5===Y.goa&&(this.B7.wasInteruptedByOfflineMode=!0),3!==Y.goa&&2!==Y.goa||oc.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.B7.mBd(this.$),
2===Ra?Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?af.b().iJb(571289604,0,50,da.offline,this.B7.durationMs,this.B7):oc.ULS.sendTraceTag(571289604,0,50,kh.a.Kc(this.B7)):Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?af.b().iJb(542782150,0,50,da.Eih,this.B7.durationMs,this.B7):oc.ULS.sendTraceTag(542782150,0,50,kh.a.Kc(this.B7)),this.B7=null)};Object(Yc.a)(U,"SilentReopenPartialInteractivityTelemetryManager",
null,[3]);var ef=dd.a;vm(V,ef);V.prototype.dispose=function(){this.sf&&(this.Vwc&&(this.sf.gdj(this.PDb),this.sf.qHb(this.XAf)),this.sf.DQf(this.ywf),this.sf.Ubj(this.zwf));this.tzb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.fHb(this.vya),this.tzb=!1);this.$&&(this.Mrc&&this.RAc(),this.$.ea&&(this.$.ea.vRf(this.$Df),this.$.ea.wf&&this.$.ea.wf.Pza(this.yca)));Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.X0&&(this.X0.dispose(),
this.X0=null);ih.a.Fa(this.ksf);this.$=null;ef.prototype.dispose.call(this)};V.prototype.lzi=function(){this.NQd=!0};V.prototype.Fke=function(){this.Tna||(this.Tna=Nb.a(this.$).sg.kYa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))};V.prototype.Tfi=function(){if(this.NQd)return this.NQd=!1,!0;var Y=this.N7>this.Snf||this.pld>this.Snf&&10>this.N7;oc.ULS.sendTraceTag(537155223,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:{0}, Time gap between last two activities: {1}. return value:{2}",
this.N7,this.pld,Y);return Y};V.prototype.xgj=function(){Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&(this.X0=dh.a.instance.create(function(){Cc.Health.instance.recordQosError(Ea.a.AEj,[kb.a.qjc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0))};V.prototype.Pzg=function(){var Y=this;this.Tna||this.M0?oc.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):
this.M0=dh.a.instance.create(function(){Y.$?Y.Tna?oc.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):bf.g(Y.$).isEditing?(Y.Kab||(bf.g(Y.$).pc.Mo(Y.Kg),oc.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),Y.Lab=
!0,oc.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):Y.Fke():oc.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.t5f,Qh.a.tDj,void 0,!0)};V.prototype.drf=function(Y){this.s2c=this.bwe(2,Y,!0);this.upe()};V.prototype.glc=function(Y,
Ra){this.KVb=this.bwe(Y,Ra,!1);this.upe()};V.prototype.bwe=function(Y,Ra,xb){xb=xb?this.s2c:this.KVb;return Ra?xb|Y:xb&~Y};V.prototype.XVd=function(){var Y=!!this.sOa,Ra=!!this.pSa,xb=!!this.Tna,fc=!!this.a3b;this.rBb&&!Y?this.Ozg():!this.rBb&&Y&&this.Ybh();!this.ckc||Ra||xb?this.ckc||(Ra?this.KGe():(xb||this.M0&&this.M0.fp)&&this.LGe()):this.x2f&&this.Mfa?this.Mzg():!this.xKb||this.Mfa||Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&this.M0||
this.Pzg();this.Hka&&!fc?this.w$f(!0):!this.Hka&&fc&&this.w$f(!1)};V.prototype.Ozg=function(){this.$?this.sOa?oc.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):bf.g(this.$).isEditing?(this.Lab||(bf.g(this.$).pc.Mo(this.Kg),oc.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.Kab=!0,oc.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.Jke():oc.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")};V.prototype.Jke=function(){this.sOa||(this.sOa=Nb.a(this.$).sg.kYa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))};V.prototype.Ybh=function(){this.sOa&&
(ih.a.Fa(this.sOa),this.sOa=null)};V.prototype.KGe=function(){this.pSa&&(ih.a.Fa(this.pSa),this.pSa=null);Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.X0&&this.X0.fp&&this.X0.cancel();this.X0=null};V.prototype.LGe=function(){this.Tna&&(ih.a.Fa(this.Tna),this.Tna=null);this.M0&&(ih.a.Fa(this.M0),this.M0=null);this.Lab&&!this.Kab&&bf.g(this.$).pc.Pn(this.Kg);this.Lab=!1};V.prototype.Mzg=function(){this.pSa||(this.pSa=Nb.a(this.$).sg.kYa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,ce.a.instance.fa(2126)));this.xgj()};V.prototype.w$f=function(Y){Y?(this.a3b=Nb.a(this.$).sg.kYa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.K3i()):(ih.a.Fa(this.a3b),this.a3b=null)};V.prototype.K3i=function(){if(this.$&&this.$.na){var Y=this.$.na.ta.Zb();he.jb(this.$.na.ta,null,null,null,Y)}};V.prototype.RAc=function(){$g.a(this.$).WQ(Qf.a.cPa).Mq(this.hBf);this.$.pl(this.rd);this.Mrc=!1};V.prototype.upe=function(){this.documentVisibilityObserver||oc.ULS.sendTraceTag(537155211,
0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.Di?this.tzb||(this.documentVisibilityObserver.nnb(this.vya),this.tzb=!0,oc.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.XVd()};Sk.Object.defineProperties(V.prototype,
{Nhi:{configurable:!0,enumerable:!0,get:function(){return this.Mfa}},rBb:{configurable:!0,enumerable:!0,get:function(){return!(this.KVb&1)}},ckc:{configurable:!0,enumerable:!0,get:function(){return!(this.KVb&2)}},Hka:{configurable:!0,enumerable:!0,get:function(){return!!(this.s2c&2)}}});Object(Yc.a)(V,"NetworkConnectionStateManager",dd.a,[401,3]);var jf=yd.a;vm(D,jf);D.prototype.create=function(){var Y=this;Fb.TaskExtensions.Ba(Ph.GetServiceTaskFactory.Wa(this.$.da,395,396,this.ub),function(Ra){Y.Fb(Y.$.da.Aa(400)||
new V(Y.$,Ra.result))},this.$.ma,3)};D.ja=function(Y){Y.da.Ha(401,new D(Y))};Object(Yc.a)(D,"NetworkConnectionStateManagerFactory",yd.a,[]);var yf=b(1368),Eg=b(1165);v.prototype.dispose=function(){this.fcg();this.ncg();this.Fsd=this.qsd=this.hL=this.pk=this.qr=this.$qc=this.$=null;this.e_d=0};v.prototype.tOg=function(Y){this.hL=Y;this.qsd=Y.dIg;this.Fsd=Y.i8i};v.prototype.tIa=function(){if(this.hL){var Y=vf.K(this.hL.Fzh);this.IEj(Y);this.hide();this.fcg();this.hL=null}};v.prototype.IEj=function(Y){var Ra=
[1868184698,-1985798686,753331043,2137617149,237279923,1804571062,1766348718,42074747,-875588320,-958589048,-185374993];Kc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",!1)&&Y&&(null!=this.nAb&&Ra.includes(this.nAb.command)?(oc.ULS.sendTraceTag(526758984,306,50,"RecoveryUIController:dismissRecoveryUI Table hand raise is not triggered. Last command was {0}",Eg.a[this.nAb.command]),this.nAb=null):bf.g(this.$).Rb.u5(Y)?oc.ULS.sendTraceTag(526758983,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a table. Table hand raise is not triggered."):
bf.g(this.$).Rb.Ska(Y)?oc.ULS.sendTraceTag(526758982,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a pivot table. Table hand raise is not triggered."):(Ra=Ff.d(this.$.xa.pa),Y=new Kf.a(Y,Ra),this.LNj(Y)))};v.prototype.pmi=function(){return!!this.hL&&this.$qc.Jii};v.prototype.GCj=function(Y){this.hL?this.show(Y):oc.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")};v.prototype.$Sh=function(){return this.hL?this.hL.lsi:null};v.prototype.show=
function(Y){var Ra=this.hL.QOh();Ra?(this.$qc.showFloatie(Object.assign(new yf.a,{x:Ra.x,y:Ra.y}),this.hL.eKa(),Y),this.cl()):oc.ULS.sendTraceTag(537154071,0,100,"RecoveryUIController.Show: point is null.")};v.prototype.hide=function(){this.pmi()&&this.$qc.sC();this.ncg()};v.prototype.cl=function(){if(!this.k6b){var Y=bf.g(this.$);Y.view.Ms(this.oeg);Y.yj.Yl(this.UIe);this.pk.ja("blur",this.Rfh);this.$.Ka.CFa(this.J_);this.$.xa.Qf(this.VIe);(Y=this.$.da.Aa(65))&&Y.o3&&Y.o3.registerForCommentEvents(this.TIe);
this.k6b=!0}this.ydc||(this.qr.ot(Kg.a.Sb,this.$.domElement,this.onKeyDown,!0),this.qr.ot(Kg.a.Wd,this.$.domElement,this.onKeyUp,!0),this.ydc=!0)};v.prototype.fcg=function(){if(this.k6b){var Y=bf.g(this.$);Y.view.Nq(this.oeg);Y.yj.ol(this.UIe);this.pk.detach("blur");this.$.Ka.uQa(this.J_);this.$.xa.ug(this.VIe);(Y=this.$.da.Aa(65))&&Y.o3&&Y.o3.unregisterForCommentEvents(this.TIe);this.k6b=!1}};v.prototype.ncg=function(){this.ydc&&(this.qr.ut(Kg.a.Sb,this.$.domElement,this.onKeyDown,!0),this.qr.ut(Kg.a.Wd,
this.$.domElement,this.onKeyUp,!0),this.ydc=this.m_=this.M8b=!1)};v.prototype.STj=function(){this.hL&&250<=aa.a.Ra.he.m-this.e_d&&this.show(-1)};v.prototype.LNj=function(Y){Fb.TaskExtensions.Ba(Ph.GetServiceTaskFactory.Wa(this.$.da,426,427,1),function(Ra){Ra.result.yea(Y,"Paste")},this.$.ma,3)};Object(Yc.a)(v,"RecoveryUIController",null,[400,3]);var rh=yd.a;vm(J,rh);J.prototype.create=function(){var Y=this,Ra=this.$;Ra.$E(function(xb){xb.Hld().then(function(fc){Y.Fb(Ra.da.Aa(406)||new v(Ra,fc,Lh.KeyInputManager.instance,
Fh.a.instance.rE()))})})};J.ja=function(Y){Y.da.Ha(405,new J(Y))};Object(Yc.a)(J,"RecoveryUIControllerFactory",yd.a,[]);var Eh=b(681),Qg=b(572),Ng=b(38),Hh=b(1182),Tg=Ca.a;vm(r,Tg);r.prototype.validate=function(){this.Hj.KE||oc.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Hj.KE.value?!0:(r.Jz(CommonUIStrings.l_FileUploadNoFileSpecified),!1)};r.prototype.HLi=function(Y){this.Uvg&&(this.Hj=this.O0f(Y,this.$Wb))};r.prototype.$Ui=function(){this.Hj&&this.Hj.KE&&
(this.E6d||(this.Hj.V9i(Object(Ve.a)(this,this.lAd,"onFileChosen")),this.E6d=!0),this.Hj.CTe())};r.prototype.lAd=function(Y){this.fXa.uploadStatusLabel=Y;this.pBc(this.titleText,Object(Ve.a)(this,this.Oec,"insertDialogHandler"),this.fXa)};r.prototype.Oec=function(Y){1===Y&&this.isEnabled()?r.wy&&this.Hj.KE&&!this.Hj.KE.value?(this.fXa.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.pBc(this.titleText,Object(Ve.a)(this,this.Oec,"insertDialogHandler"),this.fXa)):(this.cxb(),this.$Wb.finalizeUpload(this.Hj,
Object(Ve.a)(this,this.dispose,"dispose"))):0===Y&&this.hide()};r.prototype.P0f=function(){this.jIc=!1;this.Hj=this.O0f(document.getElementById("uploadFrameContainer"),this.$Wb);Uc.AFrameworkApplication.ga.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Hga=Object(Ve.a)(this,this.bCd,"onUploadFrameLoad"),Ng.a.addHandler(this.Hj.iFrame,"load",this.Hga));this.Hj.KE||oc.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.sKf()};r.prototype.bCd=function(){this.sKf()};r.prototype.sKf=
function(){if(this.Hj&&!this.jIc){var Y=this.Hj.KE;Y&&(Ng.a.addHandler(Y,Kg.a.Sb,Object(Ve.a)(this,this.onKeyDown,"onKeyDown")),Y=[Y],this.Sm=Y.concat.apply(Y,this.Sm),this.Ydg(),this.jIc=!0)}};r.prototype.dispose=function(){if(this.Hj&&!r.wy){var Y=this.Hj.KE;Y&&Ng.a.removeHandler(Y,Kg.a.Sb,Object(Ve.a)(this,this.onKeyDown,"onKeyDown"));this.Hga&&Ng.a.removeHandler(this.Hj.iFrame,"load",this.Hga)}this.Hj=null;Tg.prototype.dispose.call(this)};r.prototype.Ydg=function(){if(0<this.Sm.length){var Y=
new Hh.a(this.Sm),Ra=uc.FocusManager.instance().XQ();Ra&&(this.Sm[0].focus(),Ra.jf=Y,Ra.v_=!0)}};r.prototype.onKeyDown=function(Y){4!==uc.FocusManager.instance().uKf(Y)&&Y.preventDefault()};r.Jz=function(Y){var Ra=document.getElementById("errorText");Ra.innerText=Y;Ra.style.display="inline-block"};Sk.Object.defineProperties(r.prototype,{lVj:{configurable:!0,enumerable:!0,get:function(){return this.$Wb}}});Sk.Object.defineProperties(r,{wy:{configurable:!0,enumerable:!0,get:function(){return Uc.AFrameworkApplication.sa.Qa.rw&&
Uc.AFrameworkApplication.sa.Qa.$gf}}});Object(Yc.a)(r,"InsertFileDialog",Ca.a,[]);Sk.Object.defineProperties(C,{eg:{configurable:!0,enumerable:!0,get:function(){return Ca.a.Cn(C.Vj,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}});C.Vj="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";
Object(Yc.a)(C,"InsertImageDialogHtml",null,[]);vm(u,r);u.prototype.validate=function(){this.Hj.KE||oc.ULS.sendTraceTag(25798095,322,10,"UploadFrame.FileInputElement is null");var Y=Object(nb.a)(Ya,this.lVj),Ra=Y.Qfg(this.Hj.KE.value);return 0!==Ra?(r.Jz(Y.$Ze(Ra)),!1):!0};Sk.Object.defineProperties(u.prototype,{zXb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadButtonText}},titleText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadingTitle}},
Seh:{configurable:!0,enumerable:!0,get:function(){return C.eg}}});Object(Yc.a)(u,"InsertImageDialog",r,[]);var tg=b(576),ii=b(192),Ki=b(419);B.prototype.ibf=function(){this.JD=Gd.a.create().toString();this.Nqa?this.F8c():this.Zqe()};B.prototype.A4g=function(Y){this.Vn=document.createElement("iframe");this.Vn.className=Y;this.Vn.id=Y;this.k7d&&(this.Vn.style.visibility="visible",this.Vn.style.height="30px",this.Vn.setAttribute("frameborder","0"));this.Hga=Object(Ve.a)(this,this.bCd,"onUploadFrameLoad");
Ng.a.addHandler(this.Vn,"load",this.Hga)};B.prototype.E6b=function(Y){var Ra=this;Uc.AFrameworkApplication.sa.gqc();if(!this.Wq)return oc.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";Ng.a.addHandler(this.Wq,"change",function(){Ra.kBh(Y)});z(Object(Ve.a)(this,this.CTe,"fileInputClick"),1,"DoFileOpenDialog");return this.Wq.value};B.prototype.kBh=function(Y){Y&&Y(this.Wq.value)};B.prototype.lBh=function(){this.SRb&&(this.SRb.innerText=this.m0e())};B.prototype.V9i=function(Y){var Ra=this;
Ng.a.addHandler(this.Wq,"change",function(){Y(Ra.m0e())})};B.prototype.m0e=function(){var Y=null;if(this.Wq.value){var Ra=this.Wq.value,xb=Ra.lastIndexOf("\\");0<xb&&(Y=Ra.substring(xb+1,Ra.length))}return Y?Y:""};B.prototype.CTe=function(){try{oc.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.Wq.click()}catch(Y){throw oc.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",Y.message),Y;}};B.prototype.GHj=function(){this.lni()?
this.O7f():(this.PYd(),this.Fs.submit())};B.prototype.lni=function(){return(this.Xqg||this.Nqa)&&!(void 0===window.self.FormData||null===window.self.FormData)};B.prototype.iYf=function(Y){if(Y){var Ra=this.oDe();this.Lg=new XMLHttpRequest;this.Lg.open("POST",Ra);this.Lg.setRequestHeader("X-CorrelationId",this.JD);this.kvi(Y);this.Lg.onreadystatechange=Object(Ve.a)(this,this.Koa,"uploadResponseReceived");this.Lg.send(Y)}};B.prototype.kvi=function(Y){if(!Oc.a.cB&&Y.get){var Ra=Y.get("ImageId");Y=window.self.navigator;
var xb={};Ra=(xb.CorrelationId=this.JD,xb.Canary=Uc.AFrameworkApplication.canary,xb.ImageNodeId=Ra,xb);Y&&(Y=Y.connection?Y.connection:Y.mozConnection?Y.mozConnection:Y.webkitConnection?Y.webkitConnection:null)&&(Ra.effectiveType=Y.effectiveType,Ra.downlink=Y.downlink,Ra.type=Y.type,Ra.rtt=Y.rtt);oc.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Ra)}};B.prototype.O7f=function(){try{this.PYd();oc.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");
var Y=new (Type.parse("FormData"))(this.Fs);this.iYf(Y)}catch(Ra){oc.ULS.sendTraceTag(594888407,322,10,"SubmitFormWithRequest failed to send the request with exception "+Ra.message),this.Z9a(null)}};B.prototype.N7f=function(Y){try{if(this.PYd(),oc.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.vWj(Y)){this.TRb=Y;this.Fs.contains(this.Wq)&&this.Fs.removeChild(this.Wq);var Ra=new (Type.parse("FormData"))(this.Fs);Ra.append("applicationfileInput",
Y.blob,Y.filename);this.iYf(Ra)}else this.Z9a(null)}catch(xb){oc.ULS.sendTraceTag(591267743,322,10,"SubmitFormWithBlob failed to send the request with exception "+xb.message),this.Z9a(null)}};B.prototype.vWj=function(Y){return Y&&void 0!==Y.blob&&null!==Y.blob&&void 0!==Y.filename&&null!==Y.filename&&""!==Y.filename?void 0===window.self.FormData||null===window.self.FormData?(oc.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(Y=Y?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",
void 0===Y.blob||null===Y.blob,void 0===Y.filename||null===Y.filename||""===Y.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",oc.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",Y)),!1)};B.prototype.Koa=function(){if(4===this.Lg.readyState)if(200===this.Lg.status){oc.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.JD);var Y=this.Lg.getResponseHeader("X-NewKey"),
Ra=this.vgi(this.Lg),xb=!1;if(void 0!==Y&&null!==Y&&Ra&&(xb=this.kWj(Y),!this.CSc&&xb)){oc.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.JD);this.CSc=!0;void 0!==this.TRb&&null!==this.TRb?this.N7f(this.TRb):this.O7f();return}oc.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.CSc,
Ra,!(void 0===Y||null===Y),xb,this.JD);this.Z9a(this.Lg.responseText)}else oc.ULS.sendTraceTag(42874946,322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Lg.status,this.Lg.responseText?!1:!0,this.JD),this.Z9a(null)};B.prototype.vgi=function(Y){try{var Ra=Lf.a(Y.responseText).Responses;if(void 0!==Ra&&null!==Ra&&1===Ra.length){var xb=Ra[0];if(void 0!==xb&&null!==xb&&2===xb.length&&28===xb[1].StatusCode)return!0}}catch(fc){}return!1};B.prototype.kWj=function(Y){Ki.a.Zcg(Y);
return Uc.AFrameworkApplication.canary!==Y?!1:!0};B.prototype.PYd=function(){this.DSc||(this.DSc=new Date)};B.prototype.dispose=function(){this.tm||(this.Nqa?this._parent.removeChild(this.Fs):(this._parent.removeChild(this.Vn),Ng.a.removeHandler(this.Vn,"load",this.Hga),this.Hga=null),this.iIc&&(Ng.a.removeHandler(this.Wq,"change",this.iIc),this.iIc=null),this.DTe&&(this.jib&&(Ng.a.removeHandler(this.Wq,"change",this.jib),this.jib=null),this.SRb=null),this.Wq=this.Fs=this._parent=this.Vn=null,this.tm=
!0,this.DSc=null,oc.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))};B.prototype.delayedDispose=function(){this.dispose()};B.prototype.c7g=function(Y){if(this.Fs){var Ra;(Ra=this.Fs.querySelector("input[name=__REQUESTDIGEST]"))?Ra.value=Y:(Ra=this.c4c(),Ra.type="hidden",Ra.id="__REQUESTDIGEST",Ra.name="__REQUESTDIGEST",Ra.value=Y,this.Fs.appendChild(Ra))}};B.prototype.c4c=function(){return this.Nqa?document.createElement("input"):this.Vn.contentWindow.document.createElement("input")};B.prototype.bCd=
function(){try{if(!this.Vn.contentWindow.document.body)return}catch(fc){this.O5h();return}if(!(this._initialized||this.L8a&&Oc.a.sF))this.F8c();else if(!this.L8a||!Oc.a.sF||this.pki){var Y=Oc.a.Af?this.Vn.contentWindow.document.body.innerText:this.lfg?this.Vn.contentWindow.document.body.firstChild.innerText:this.Vn.contentWindow.document.body.firstChild.innerHTML;var Ra=this.Vn.contentWindow.document.body.innerText.toLowerCase(),xb=0<=Ra.indexOf("responses")||0<=Ra.indexOf("wopisrc");Ra=0<=Ra.indexOf("http error");
!xb&&Ra&&oc.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+this.Vn.contentWindow.document.body.innerText);this.Z9a(Y)}};B.prototype.F8c=function(){if(!this._initialized){var Y=this.fa("uploadForm"),Ra=this.fa("fileInput"),xb=this.oDe();this.J6g();this.Fs.id=Y;this.Fs.method="post";this.Fs.encoding="multipart/form-data";this.Fs.action=xb;this.Wq.type="file";this.e1d&&(this.Wq.accept=this.e1d,this.c3d&&(this.Wq.capture=this.c3d));this.Wq.id=Ra;this.Wq.name=
Ra;this.kJg&&(this.Wq.multiple=!0);!this.DTe||Oc.a.Af||Oc.a.MH||(this.jib=Object(Ve.a)(this,this.lBh,"fileInputChangedHandleAccessibility"),Ng.a.addHandler(this.Wq,"change",this.jib),this.SRb=ua.a.Vqe(this.Fs,this.Wq,"InputFileDescription"));this.k7d&&(this.Nqa||(Y=this.Vn.contentWindow.document.body,Y.style.margin="0",Y.style.overflow="hidden"),Y=Uc.AFrameworkApplication.sa,this.Wq.style.fontFamily=Y.a1,this.Wq.style.fontSize=Y.EAc,this.Wq.style.margin="0");(Y=document.getElementById("__REQUESTDIGEST"))&&
this.c7g(Y.value);this.Fs.appendChild(this.Wq);this._initialized=!0;this.Eqg(this)}};B.prototype.J6g=function(){if(this.Nqa)this.Fs=document.createElement("form"),this._parent.appendChild(this.Fs),this.Wq=document.createElement("input");else{this.Fs=this.Vn.contentWindow.document.createElement("form");var Y=this.Vn.contentWindow.document;Y.body.appendChild(this.Fs);this.Wq=Y.createElement("input")}};B.prototype.Zqe=function(){this._parent.appendChild(this.Vn);this.L8a&&Oc.a.sF&&this.F8c()};B.prototype.oDe=
function(){var Y=new dc.QueryStringBuilder(this.ITe);Uc.AFrameworkApplication.Umb(Y);this.Tpj(Y);Y=Y.toString();if(Oc.a.Df||Oc.a.sF||Oc.a.MH)Y=ug.a.pXe(Y);return Y};B.prototype.Ule=function(){var Y=new Mh.a(2,1,0,Object(Ve.a)(this,this.delayedDispose,"delayedDispose"),4);Uc.AFrameworkApplication.hj.Zg(Y)};Sk.Object.defineProperties(B.prototype,{hUf:{configurable:!0,enumerable:!0,get:function(){return this.evg}},sessionId:{configurable:!0,enumerable:!0,get:function(){return this.AQc}},iFrame:{configurable:!0,
enumerable:!0,get:function(){return this.Vn}},KE:{configurable:!0,enumerable:!0,get:function(){return this.Wq}},L8a:{configurable:!0,enumerable:!0,get:function(){return Uc.AFrameworkApplication.ga?Uc.AFrameworkApplication.ga.ra("NativeFileOpenDialogIsEnabled"):!1}},DTe:{configurable:!0,enumerable:!0,get:function(){return Uc.AFrameworkApplication.ga?Uc.AFrameworkApplication.ga.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}},pki:{configurable:!0,enumerable:!0,get:function(){return this.Nqa?!1:
ii.a(this.Vn.contentWindow.location.pathname,this.ITe,0)}},kJg:{configurable:!0,enumerable:!0,get:function(){return!Oc.a.cB&&Uc.AFrameworkApplication.ga.ra("AllowMultipleImageInsertFromLocalDevice")}}});Object(Yc.a)(B,"UploadFrame",null,[3]);vm(t,B);t.prototype.fa=function(Y){return Y};t.prototype.Tpj=function(Y){oc.ULS.shipAssertTag(526399105,0,!!this.sessionId,"SessionId shouldn't be null.");ve.a.CWc(Y,this.$.ya);Y.G9(Ud.a.sessionId,this.sessionId);var Ra=bf.g(this.$).ha;Ra=vf.o(Ra.va.s4,this.$);
Y.G9(Ud.a.C3i,this.$.xa.pa.name);Y.G9(Ud.a.B3i,Ra.FirstRow.toString());Y.G9(Ud.a.A3i,Ra.FirstColumn.toString())};t.prototype.O5h=function(){this.hUf("ServerUploadError")};t.prototype.Z9a=function(Y){this.hUf(Y)};t.tii=function(Y){return!Y||gf.a.equals(Y,"ServerUploadError",!1)};Object(Yc.a)(t,"UploadFrameWrapper",B,[]);vm(y,u);y.prototype.O0f=function(Y,Ra){return new t(Y,Object(Ve.a)(Ra,Ra.uEb,"onUploadFrameInitialized"),Object(Ve.a)(Ra,Ra.Koa,"uploadResponseReceived"),this.ga,!0,this.$)};y.prototype.dispose=
function(){this.UAc();this.fR=this.aCc=null;u.prototype.dispose.call(this)};y.prototype.hide=function(){u.prototype.hide.call(this);this.$.Ab.TC=!1};y.prototype.validate=function(){var Y=this.aCc.zZd(this.Hj.KE.value,this.aCc.Uag(this.Hj));return 0!==Y?(Y=this.aCc.zed(Y).Description,this.cYd(Y),this.dUd(),!1):!0};y.prototype.isEnabled=function(){return!0};y.prototype.cYd=function(Y){this.bV.innerHTML=Y};y.prototype.Xld=function(){this.bV=document.getElementById("errorText");this.bV.style.display=
"inline-block";this.YAa=!1;this.cYd("");this.mIa.style.maxWidth=this.mIa.currentStyle.minWidth};y.prototype.dUd=function(){this.fR.qa(Kg.a.click,this.Hj.KE,this.Pmc);this.fR.qa(Kg.a.Sb,this.Hj.KE,this.Pmc);this.YAa=!0};y.prototype.UAc=function(){this.YAa&&(this.fR.za(Kg.a.click,this.Hj.KE,this.Pmc),this.fR.za(Kg.a.Sb,this.Hj.KE,this.Pmc),this.YAa=!1)};Object(Yc.a)(y,"InsertImageDialogWrapper",u,[]);vm(x,Ya);x.prototype.dispose=function(){ih.a.Fa(this.I_b);this.Hj&&this.Hj.Ule();this.Hj=this.I_b=this.vb=
null};x.prototype.T6i=function(Y){function Ra(){fc.Ow(!0)}var xb=this;if(!this.$)return oc.ULS.sendTraceTag(526399119,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),Xf.Task.Ta(!0);if(!this.$.wba)return Xf.Task.Ta(!0);var fc=new Kh.a,bd=new FileReader;Y=Y.KE.files[0];bd.onload=function(){xb.DDd=bd.result;fc.Ow(!0)};bd.onerror=Ra;bd.onabort=Ra;bd.readAsDataURL(Y);return fc.task};x.prototype.Uag=function(Y){var Ra=-1;Y=Y.KE;(null===Y||void 0===Y?0:Y.files)&&0<Y.files.length&&(Ra=Y.files[0].size);
return Ra};x.prototype.zZd=function(Y,Ra){var xb=x.y3g(Ya.NBa(Y));0===xb?-1!==Ra&&(oc.ULS.sendTraceTag(526399118,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",Ra,this.Fkc,this.$.ea.Ckf),Ra>this.Fkc?xb=3:Ra>this.$.ea.Ckf&&(xb=7)):6===xb&&this.gxi(Y);oc.ULS.sendTraceTag(526399117,0,50,"Validated file on client, validation result: {0}",xb);return xb};x.prototype.NBa=function(Y,Ra){Y=this.zZd(Y,this.Uag(Ra));return 0!==Y?(this.s1a||1===Y||this.RRd(Y),!1):
!0};x.prototype.pag=function(Y){Y.GHj()};x.prototype.zed=function(Y){var Ra=0,xb=1,fc=-1100324317,bd="InsertPictureUnknownError",Dd=null;switch(Y){case 1:Ra=1708;xb=0;fc=940870981;bd="InsertPictureNoFileSelected";break;case 3:xb=0;fc=1250467391;bd="InsertPicturePictureTooBig";Dd=String.format(ce.a.instance.Cb(171),this.vzi.toLocaleString());break;case 6:Ra=1712;xb=0;fc=1380041209;bd="InsertPictureUnsupportedFormat";break;case 7:Ra=1709;xb=0;fc=-903115058;bd="InsertPictureExceedWorkbookSize";break;
case 4:Ra=1710;xb=0;fc=1218352119;bd="InsertPictureUploadTimeout";break;case 5:Ra=1711,xb=0,fc=1979899005,bd="InsertPictureServiceNonDeterministicError"}Y=x.hd(Ra,xb,fc,bd);Dd&&(Y.Description=Dd);return Y};x.prototype.showDialog=function(){x.Dwe()?(this.s1a=!1,this.Hj=new t(this.$.domElement,this.uEb,this.Koa,this.ga,!1,this.$,!0)):(oc.ULS.sendTraceTag(526399115,0,50,"Showing Insert Picture dialog"),!this.Nzb&&(Oc.a.Vu||Oc.a.sF&&72>Oc.a.Rye)?(this.s1a=!1,this.Hj=new t(this.$.domElement,this.uEb,this.Koa,
this.ga,!1,this.$)):(this.s1a=!0,this.Hj=(new y(this,this.$,this.ga)).Hj))};x.prototype.A5h=function(Y){var Ra={};try{if(Ra=kh.a.pi(Y),af.b().XB(this.q_d.id,Ra.ServerCorrelationId,"actions","ServerActions"),!zd.a.lh(Ra.Errors)&&Ra.Result){this.$.ea.yX(Ra.StateId,"BasePictureUploaderWrapper.UploadResponseReceived");var xb=Ra.Result;gi.a(this.$).ona(1,xb);var fc=this.$.da.Aa(277);fc&&fc.qUc(this.$,1,Ra.Result,Ra,"InsertPicture");oc.ULS.sendTraceTag(526399114,0,50,"Insert picture completed successfully :)")}}catch(bd){oc.ULS.sendTraceTag(526399113,
0,50,"BasePictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",Y?Y.length:-1,bd)}this.uAc(Ra,null,"InsertPictureWebMethod")};x.prototype.D6e=function(Y){Y={Errors:[this.zed(Y)]};this.uAc(Y,null,"InsertPictureWebMethod")};x.prototype.uAc=function(Y,Ra,xb){this.Cr(Y,Ra,xb)};x.prototype.GWd=function(Y,Ra,xb){this.raa(Y,Ra,xb)};x.prototype.RRd=function(Y){Y=this.zed(Y);Kc.EwaSettings.oz()?new ud.a(this.$,Y):(new Lc.ErrorDialog(this.$,Y)).mf()};
x.prototype.gxi=function(Y){var Ra=this.$.ya.InsertPicturUnsupportedExtensionsForLogging;Y=Yf.a.Ol(Y);for(var xb=0;xb<Ra.length;++xb)if(Y.endsWith(Ra[xb])){oc.ULS.sendTraceTag(526399112,0,50,"Insert picture blocked invalid extension: {0}",Ra[xb]);break}};x.zWj=function(Y){return!Y||gf.a.equals(Y,Ud.a.insertPictureUnknownError,!0)?2:gf.a.equals(Y,Ud.a.insertPictureNoFileSelectedError,!0)?1:gf.a.equals(Y,Ud.a.jdi,!0)?3:gf.a.equals(Y,Ud.a.kdi,!0)?5:0};x.hd=function(Y,Ra,xb,fc){return zd.a.hd(1,0,0,Y,
Ra,xb,fc)};x.y3g=function(Y){switch(Y){case 1:return 1;case 2:return 6}return 0};x.Dwe=function(){return Kc.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1};Sk.Object.defineProperties(x.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},vzi:{configurable:!0,enumerable:!0,get:function(){return this.Fkc/1024/1024}}});Object(Yc.a)(x,"BasePictureUploaderWrapper",Ya,[3]);
vm(f,x);f.prototype.eBj=function(){this.Fkc=28E5;this.RRd(3)};f.prototype.Wad=function(Y){var Ra=this;oc.ULS.sendTraceTag(526399111,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - Start function.");var xb=new FileReader;Y=Y.KE.files;0==Y.length?oc.ULS.sendTraceTag(526399110,0,15,"FileReaderUploaderWrapper.finalizeUploadImpl - No image file found."):(Y=Y[0],xb.onload=function(){Ra.o9b.stop();Ra.qBh.PTi(xb.result,Ra);oc.ULS.sendTraceTag(526399109,0,50,"FileReaderUploaderWrapper.finalizeUploadImpl - End function.")},
xb.onerror=function(){Ra.o9b.stop();oc.ULS.sendTraceTag(526399108,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Can't read image.")},xb.onabort=function(){Ra.o9b.stop();oc.ULS.sendTraceTag(526399107,0,10,"FileReaderUploaderWrapper.finalizeUploadImpl - Aborted read image.")},this.o9b.start(),xb.readAsDataURL(Y))};f.prototype.finalizeUpload=function(Y,Ra){this.Wad(Y,Ra)};Object(Yc.a)(f,"FileReaderUploaderWrapper",x,[442]);m.prototype.getSheetName=function(){return this.sheetName};Object(Yc.a)(m,
"MacroRecorderPictureInsertedPayload",null,[147]);vm(n,x);n.prototype.Wad=function(Y,Ra){var xb=this;x.prototype.finalizeUpload.call(this,Y,Ra);td.a(this.$.userOperationManager,function(fc,bd){xb.Cr=fc;xb.raa=bd;xb.q_d.start();xb.I_b.Pq();xb.Xzc=!1;xb.pag(Y);return xb.T6i(Y)},function(fc){function bd(){return new m(Td,xb.DDd?xb.DDd:"")}var Dd={};xb.$.Cj(Dd);var Td=Dd.SheetName;fc=Kc.EwaSettings.sc()?new Ye.a(510,0,fc,72,bd):new Hd.a(510,0,fc,8,bd);fc.yAa(function(){return!0});fc.ae=xb.ae;return fc},
this.ae)};n.prototype.finalizeUpload=function(Y,Ra){this.Wad(Y,Ra)};Object(Yc.a)(n,"PictureUploaderWrapper",x,[]);Object(Yc.a)(l,"UploadBlobParameters",null,[]);vm(e,n);e.prototype.GWd=function(Y,Ra,xb){n.prototype.GWd.call(this,Y,Ra,xb);this.T0.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))};e.prototype.uAc=function(Y,Ra,xb){n.prototype.uAc.call(this,Y,Ra,xb);zd.a.lh(Y.Errors)?this.T0.setException(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",
zd.a.Tc(Y.Errors)))):this.T0.setResult(!0)};e.prototype.pag=function(Y){var Ra=new l(this.iec.name,this.iec);Y.N7f(Ra)};e.wHh=function(Y){var Ra=Y.split(",");Y=Ra[0].includes("base64")?window.self.atob(Ra[1]):window.self.decodeURI(Ra[1]);Ra=Ra[0].split(":")[1].split(";")[0];for(var xb=new Uint8Array(Y.length),fc=0;fc<Y.length;fc++)xb[fc]=Y.charCodeAt(fc);Y=new Blob([xb],{type:Ra});Y.name="Image.png";return Y};Object(Yc.a)(e,"DataUrlUploaderWrapper",n,[]);c.prototype.Sbi=function(Y,Ra,xb,fc,bd){new n(Y,
Ra,xb,fc,bd,!0)};c.prototype.Qai=function(Y,Ra,xb,fc,bd,Dd){new e(Y,null,Ra,xb,fc,bd,Dd)};c.prototype.bbi=function(Y,Ra,xb,fc,bd){new f(Y,Ra,xb,fc,bd,!0)};Object(Yc.a)(c,"UploaderCreator",null,[393]);var $i=yd.a;vm(a,$i);a.ja=function(Y){Y.da.Ha(485,new a(Y))};a.prototype.create=function(){var Y;this.Fb(null!==(Y=this.$.da.Aa(484))&&void 0!==Y?Y:this.$.da.Ha(484,new c))};Object(Yc.a)(a,"UploaderCreatorFactory",yd.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPicture");Type.registerNamespace("_Ewa");
Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");vc.main();Type.registerNamespace("Common.App.InProductMessaging");ie.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");Sf.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");(function(){hi.a.Ga(function(Y){Xb.ja(Y)})})();(function(){hi.a.Ga(function(Y){pd.ja(Y)})})();(function(){hi.a.Ga(function(){hi.a.Ga(Za.ja)})})();(function(){hi.a.Ga(function(){hi.a.Ga(ec.ja)})})();
(function(){hi.a.Ga(function(Y){Mb.ja(Y)})})();te.a.$i(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
hi.a.Ga(ja.ja);hi.a.Ga(D.ja);(function(){hi.a.Ga(function(Y){J.ja(Y)})})();(function(){hi.a.Ga(function(Y){a.ja(Y)})})()},989:function(A,F,b){function a(B){var z=this;this.businessBar=this.J7a=null;this.PHi=function(u,C){C.a7c?z.RHi(C):z.QHi(C)};this.Nh=function(u,C){u=C.context.methodName;z.J7a&&u===z.J7a&&(l.ULS.sendTraceTag(537155230,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "{0}" has now succeeded. Querying local storage for BB showings.',z.J7a),z.c8a(a.lJb,!0),
z.J7a=null);z.jnf(!1);z.$2b=!1};this.Mn=function(u,C){m.a.kh(C.errors,[-1387426400])&&!z.$2b&&(z.$2b=!0,z.K2f()&&window.performance.mark(a.huf),(new c(z)).Dri())};this.Wg=function(){z.jnf(!0);z.c8a(a.pCb,!1);z.c8a(a.lJb,!1)};this.Eya=function(){l.ULS.sendTraceTag(537155225,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");z.c8a(a.pCb,!0)};this.$=B;this.na=this.$.na;this.localStorage=new x.a;this.$2b=!1;this.$.ea.Um(this.Wg);
this.na.sf.unb(this.Eya);this.na.uq(this.Nh);this.$.da.Za(5,function(u){z.businessBar=u;u.cEg(z.PHi)});this.na.Ky(this.Mn)}function c(B){var z=this;this.Ekd=[y.a.kig,y.a.KDc];this.Lo=function(u,C){z.nO[C]=u;z.G6h()&&z.pgj("OnNetworkDownImmediatePing"===u.caller)};this.Lla=B;this.$=B.$;this.nO={}}function e(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}b.r(F);A=b(0);var l=b(13),n=b(314),m=b(27),f=b(9),x=b(305);Object(A.a)(e,"ConnectionErrorLogInfo",null,[]);var y=b(1209),
t=b(1255);c.prototype.Dri=function(){var B=t.a.Vcd(this.Lo,"OnNetworkDownImmediatePing",this.$,this.Ekd);B=yl(B);for(var z=B.next();!z.done;z=B.next())z.value.oMd()};c.prototype.G6h=function(){for(var B=yl(this.Ekd),z=B.next();!z.done;z=B.next())if(z=z.value,void 0===this.nO[z]||null===this.nO[z])return!1;return!0};c.prototype.pgj=function(B){var z=this.$.sf.QV;B&&this.tHj(z);B=yl(this.Ekd);for(var u=B.next();!u.done;u=B.next())u=u.value,this.nO[u]=Sys.Serialization.JavaScriptSerializer.serialize(this.nO[u]);
B=Date.now();u=this.Lla.Ehd(b(989).NetworkConnectionHealthChecker.pCb).returnValue;var C=this.Lla.Ehd(b(989).NetworkConnectionHealthChecker.lJb).returnValue;this.nO.isOfflineMode=z;this.nO.networkDownBBAge=-1===u?u:B-u;this.nO.transientServerCommunicationFailuresBBAge=-1===C?C:B-C;this.Lla.businessBar?(this.nO.isNetworkDownBBShown=this.Lla.businessBar.dC(54).toString(),this.nO.isServerErrorBBShown=this.Lla.businessBar.dC(21).toString()):(this.nO.isNetworkDownBBShown="unknown",this.nO.isServerErrorBBShown=
"unknown");l.ULS.sendTraceTag(537155224,0,50,"ConnectionHealthTestsRunner.ReportPingResults: {0}",Sys.Serialization.JavaScriptSerializer.serialize(this.nO))};c.prototype.tHj=function(B){for(var z=b(989).NetworkConnectionHealthChecker,u={},C=yl(Object.keys(this.nO)),r=C.next();!r.done;r=C.next())r=this.nO[r.value],u[r.testName]=r.isSuccess;u.isOfflineMode=B;this.Lla.WTd(z.r2c,Sys.Serialization.JavaScriptSerializer.serialize(u))};Object(A.a)(c,"ConnectionHealthTestsRunner",null,[]);b.d(F,"NetworkConnectionHealthChecker",
function(){return a});a.prototype.dispose=function(){this.$&&(this.$.ea&&this.$.ea.Lq(this.Wg),this.na&&(this.na.sf.qHb(this.Eya),this.na.Ez(this.Mn),this.na.yr(this.Nh)))};a.prototype.RHi=function(B){var z={};z.Timestamp=Date.now().toString();switch(B.f_a){case 21:this.J7a=B.data.FailedMethod;z.FailedMethod=this.J7a;this.WTd(a.lJb,JSON.stringify(z));break;case 54:this.WTd(a.pCb,JSON.stringify(z))}};a.prototype.QHi=function(B){switch(B.f_a){case 21:this.c8a(a.lJb,!0);break;case 54:this.c8a(a.pCb,
!0)}};a.prototype.WTd=function(B,z){try{this.localStorage.rg()&&this.localStorage.setItem(B,z)}catch(u){l.ULS.sendTraceTag(537155231,0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: {0}",u.message||"Unknown")}};a.prototype.Ehd=function(B){if(this.localStorage.rg()&&(B=this.localStorage.S3a(B))&&"null"!==B){var z=JSON.parse(B);B=parseInt(z.Timestamp,10);z=Sys.Serialization.JavaScriptSerializer.serialize(z);return{returnValue:B,rawData:z}}return{returnValue:-1,
rawData:null}};a.prototype.jnf=function(B){if(this.localStorage.rg()){var z=this.localStorage.S3a(a.r2c);if(z&&"null"!==z){var u=-1;this.$2b&&(u=this.fPh(a.huf,a.AGi));l.ULS.sendTraceTag(537155229,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: {0}, Period offline: {1}, New session: {2}",Sys.Serialization.JavaScriptSerializer.serialize(z),u,B);this.localStorage.removeItem(a.r2c)}}};a.prototype.fPh=function(B,z){if(!this.K2f())return-1;window.performance.measure(z,
B);B=window.performance.getEntriesByName(z);return B.length&&B[B.length-1]?B[B.length-1].duration:(l.ULS.sendTraceTag(537155228,0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name {0} returned no measures.",z),-1)};a.prototype.c8a=function(B,z){try{var u=this.Ehd(B);var C=u.rawData;var r=u.returnValue;if(-1!==r){var J=Object.assign(new e,{timeElapsed:Date.now()-r,scenario:B,isNewSession:!z,rawData:C});l.ULS.sendTraceTag(537155227,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: {0}",
JSON.stringify(J))}this.localStorage.removeItem(B)}catch(v){l.ULS.sendTraceTag(537155226,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: {0}",v.message||"Unknown")}};a.prototype.K2f=function(){return f.HelperMethods.JYc&&n.a.Vob};a.pCb="NetworkDownBBShown";a.lJb="ServerCommunicationFailureBBShown";a.r2c="ConnectionHealthPingRsults";a.huf="offMoStMa";a.AGi="offMoDuMea";Object(A.a)(a,"NetworkConnectionHealthChecker",null,[3])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.pi.js.map/112a360949234e077dcfa637a56cfc81/EwaDS.pi.js.map