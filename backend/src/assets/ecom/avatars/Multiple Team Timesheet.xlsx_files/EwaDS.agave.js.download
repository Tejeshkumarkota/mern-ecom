/*
 The buffer module from node.js, for the browser.

 @author   Feross Aboukhadijeh <http://feross.org>
 @license  MIT
 ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1011:function(A,F,b){function a(){this.BLa=0;this.Fha=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.Idc=!1;this.I$e=this.Aia=null}b.d(F,"a",function(){return a});A=b(0);Object(A.a)(a,"AddInCommandsNotificationParameters",null,[])},1065:function(A,F,b){function a(){}function c(){}function e(S,K,da,fa,X,ca){S=l.call(this,S,K,da,fa,X,void 0===ca?null:ca)||this;S.XTb=null;return S}function l(S,
K,da,fa,X,ca){S=n.call(this,S,da,X.rX,void 0===ca?null:ca)||this;S.Fbe=0;S.n1=S.VTh(fa);S.SXa=K;S.gf=X;S.tLj=7;S.gl=S.SXa.ownerDocument.createElement("div");S.gl.className="ModalCalloutControlOverlay";S.gl.tabIndex=0;S.SXa.insertBefore(S.gl,S.SXa.firstChild);return S}function n(S,K,da,fa){var X=B.call(this,document.createElement("div"))||this;X.Qqa=null;X.spa=null;X.AG=null;X.vG=null;X.Sw=null;X.aT=null;X.bT=null;X.eqa=!1;X.Hib=!1;X.Dp=null;X.content=null;X.n1=0;X.Ote=null;X.hU=0;X.TDf=null;X.xie=
S;X.Ade=K;X.AP=da;X.XGa=fa;X.zg=K.ownerDocument;X.Zib=!1;X.Su=!1;X.Fjd=!1;return X}A=b(0);var m=b(13),f=b(80),x=b(370),y=b(12),t=b(89),B=Sys.UI.Control;vm(n,B);n.prototype.show=function(){this.Zib||(this.i6g(),this.Lj(),this.Ade.appendChild(this.sW),this.sW.style.display="Block",this.wuj(),this.Zib=!0,this.TDf&&this.TDf())};n.prototype.dismiss=function(){this.Zib&&(this.PU(),this.Ade.removeChild(this.sW),this.Zib=!1,this.XGa&&this.XGa())};n.prototype.dispose=function(){this.dismiss();this.aT=this.Sw=
this.vG=this.spa=this.AG=this.Qqa=null;Sys.Component.prototype.dispose.call(this)};n.prototype.ri=function(S){return this.get_element().id+S};n.prototype.i6g=function(){this.AG=this.zg.createElement("div");this.AG.id=this.ri("WACCalloutHeader");this.AG.className="WACCalloutHeader";this.Su&&this.Mle();this.Fjd&&this.Zme();this.vG=this.zg.createElement("div");this.vG.id=this.ri("WACCalloutContent");this.vG.className="WACCalloutContent";this.vG.style.width=190<this.n1?this.n1-26+"px":"164px";this.vG.appendChild(this.content);
this.sW.appendChild(this.b0b);this.sW.appendChild(this.AG);this.sW.appendChild(this.vG)};n.prototype.Mle=function(){this.Sw=this.zg.createElement("a");this.Sw.className="WACCalloutCloseAnchor";this.Sw.id=this.ri("WACCalloutCloseAnchor");this.Sw.href="#";this.AG.appendChild(this.Sw);var S=x.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Sw.appendChild(S)};n.prototype.Zme=function(){this.aT=this.zg.createElement("div");this.aT.className=
"WACCalloutTitle UIFontBold";this.aT.style.width=190<this.n1?this.n1-30+"px":"160px";this.aT.id=this.ri("WACCalloutTitle");this.aT.innerText=this.title;this.AG.contains(this.Sw)?this.AG.insertBefore(this.aT,this.Sw):this.AG.appendChild(this.aT)};n.prototype.wuj=function(){var S=this.xie;if(1===this.hU){var K=this.Ote.y+16;var da=-16}else 2===this.hU||3===this.hU||0===this.hU?(K=S.y+S.height+15,da=-15):(K=S.y-this.sW.clientHeight-15-2,da=this.sW.clientHeight-1);this.sW.style.top=K+"px";this.b0b.style.top=
da+"px";1===this.hU?(S=this.Ote.x-16,this.sW.style.left="50%",this.sW.style.marginLeft=-this.n1/2+"px",K=Sys.UI.DomElement.getBounds(this.sW),this.b0b.style.left=S-K.x+"px"):(K=S.x+this.xie.width/2,2===this.hU||5===this.hU?(S=20,K-=36):0===this.hU||4===this.hU?(S=this.n1/2-16,K-=this.n1/2):(S=this.n1-20-32,K=K-this.n1+36),this.sW.style.left=K+"px",this.b0b.style.left=S+"px")};n.prototype.Lj=function(){this.Su&&!this.bT&&(this.bT=Object(f.a)(this,this.w$,"closeHandler"),this.AP.qa(y.a.click,this.Sw,
this.bT,null))};n.prototype.PU=function(){this.Su&&this.bT&&(this.AP.za(y.a.click,this.Sw,this.bT),this.bT=null)};n.prototype.w$=function(){this.dismiss();return!0};Sk.Object.defineProperties(n.prototype,{sW:{configurable:!0,enumerable:!0,get:function(){this.Qqa||(this.Qqa=this.zg.createElement("div"),this.Qqa.id=this.ri("WACCalloutOuter"),this.Qqa.className="WACCalloutOuter",this.Qqa.setAttribute(t.a.Td,t.a.rZa),this.Qqa.style.width=this.n1+"px");return this.Qqa}},b0b:{configurable:!0,enumerable:!0,
get:function(){if(!this.spa){this.spa=this.zg.createElement("div");this.spa.id=this.ri("WACCalloutBeakContainer");this.spa.className="WACCalloutBeakContainer";var S="CalloutBeakTopFilled_32x16x32";if(5===this.hU||6===this.hU||4===this.hU)S="CalloutBeakBottomFilled_32x16x32";S=x.createClusteredImage(32,16,S,"WACCalloutBeak",!0,"");this.spa.appendChild(S)}return this.spa},set:function(S){this.spa=S}},gMa:{configurable:!0,enumerable:!0,get:function(){return this.Zib}},title:{configurable:!0,enumerable:!0,
get:function(){return this.Dp},set:function(S){this.Dp!==S&&(this.Dp=S,this.aT&&(this.aT.innerText=this.Dp))}},Su:{configurable:!0,enumerable:!0,get:function(){return this.eqa},set:function(S){this.eqa!==S&&(this.eqa=S,this.AG&&(this.AG.contains(this.Sw)&&!this.eqa?this.AG.removeChild(this.Sw):!this.AG.contains(this.Sw)&&this.eqa&&this.Mle()))}},Fjd:{configurable:!0,enumerable:!0,get:function(){return this.Hib},set:function(S){this.Hib!==S&&(this.Hib=S,this.AG&&(this.AG.contains(this.aT)&&!this.Hib?
this.AG.removeChild(this.aT):!this.AG.contains(this.aT)&&this.Hib&&this.Zme()))}}});Object(A.a)(n,"Callout",Sys.UI.Control,[366]);vm(l,n);l.prototype.show=function(){this.gMa||(this.gf.gqc(),this.gf.bQ(!1),this.gl.style.zIndex=String(this.gf.r2),n.prototype.show.call(this),this.cl(),this.Fbe=window.setTimeout(Object(f.a)(this,this.dismiss,"dismiss"),1E3*this.tLj))};l.prototype.dismiss=function(){this.gMa&&(this.gf.PM(!1),this.un(),this.SXa&&this.SXa.contains(this.gl)&&this.SXa.removeChild(this.gl),
n.prototype.dismiss.call(this),window.clearTimeout(this.Fbe))};l.prototype.cl=function(){this.gf.Pra(Object(f.a)(this,this.dismiss,"dismiss"));this.gf.vy.qa(y.a.click,this.gl,Object(f.a)(this,this.Zc,"onClick"))};l.prototype.un=function(){this.gf.dbb(Object(f.a)(this,this.dismiss,"dismiss"));this.gf.vy.za(y.a.click,this.gl,Object(f.a)(this,this.Zc,"onClick"))};l.prototype.Zc=function(){this.dismiss();return!0};l.prototype.VTh=function(S){var K=0;switch(S){case 0:K=190;break;case 1:K=250;break;case 2:K=
300;break;case 3:K=360}return K};Object(A.a)(l,"ModalCallout",n,[]);var z=b(585),u=b(188);vm(e,l);e.prototype.show=function(){var S=this;if(!this.gMa){var K=Object.assign(new z.a,{onShow:function(){l.prototype.show.call(S)}});u.UISurfaces.sV().then(function(da){var fa=da.externalNotification();S.XTb=da.addNotification(fa,K);return null},function(da){m.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",da);return null})}};e.prototype.dismiss=function(){var S=this;this.gMa&&
this.XTb&&(u.UISurfaces.sV().then(function(K){K.removeNotification(S.XTb);return S.XTb=null},function(K){m.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",K);return null}),l.prototype.dismiss.call(this))};Object(A.a)(e,"ReactManagedModalCallout",l,[]);var C=b(5);c.R7g=function(S,K,da,fa){var X=void 0===X?null:X;return C.AFrameworkApplication.sa.Qa.sR?new e(S,K,da,fa,C.AFrameworkApplication.sa,X):new l(S,K,da,fa,C.AFrameworkApplication.sa,X)};Object(A.a)(c,"ModalCalloutControlFactory",
null,[]);var r=b(49),J=b(999),v=b(599),D=b(1E3),V=b(128),U=b(87),Q=b(47),la=b(86),ba=b(858),T=b(941),H=b(818);b.d(F,"a",function(){return a});a.s3c=function(S,K,da,fa,X,ca){a.nJ&&a.nJ.gMa&&a.nJ.dismiss();a.nJ=c.R7g(K,S,S,X);a.nJ.content=da;H.b(fa)||(a.nJ.title=fa,a.nJ.Fjd=!0);S=new Sys.UI.Bounds(0,0,U.a.s4a(),U.a.icc());a.nJ.hU=a.KLh(S,K,a.nJ.n1,ca);a.nJ.show();a.y_b&&a.y_b.sendNotification(da.innerText,!0)};a.u3c=function(S,K,da,fa){fa=void 0===fa?null:fa;u.UISurfaces.sV().then(function(X){var ca=
null;a.Wkb&&(X.removeNotification(a.Wkb),a.Wkb=null);var ja=X.callout(Object.assign(new J.a,{target:S,title:K,content:da,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new D.a,{onDismiss:function(){X.removeNotification(ca)},directionalHint:null!=fa?fa:null})})),ea=Object.assign(new z.a,{expirationOptions:Object.assign(new v.a,{displayTimeoutSeconds:7,onExpire:function(){X.removeNotification(a.Wkb)}})});ca=a.Wkb=X.addNotification(ja,ea);return null},
function(X){m.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",X);return null})};a.tRd=function(S,K){K=void 0===K?null:K;a.nJ&&a.nJ.gMa&&a.nJ.dismiss();var da=new V.StandardDialog;da.lSa=!1;da.jc=0;da.Jz(r.a.zri,CommonUIStrings.l_DialogError,H.b(S)?a.DZe():S,K)};a.vRd=function(S){a.nJ&&a.nJ.gMa&&a.nJ.dismiss();m.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",S.errorCode));var K=H.b(S.description)?a.DZe():S.description,da=
new V.StandardDialog,fa=null;S.Fha?(da.jc=1,da.Fc(1,S.buttonText),da.xna(1)):da.jc=0;fa=function(X){1===X?S.Fha():S.Aia&&S.Aia()};da.lSa=!1;0===S.BLa?da.Jz(S.errorCode,S.title?S.title:CommonUIStrings.l_DialogError,K,fa):1===S.BLa?da.mX(S.title?S.title:CommonUIStrings.l_DialogWarning,K,fa):da.KAa(S.title?S.title:CommonUIStrings.l_DialogInfo,K,fa)};a.KLh=function(S,K,da,fa){var X=0===fa?0:4,ca=S.x+S.width-K.x-K.width;K.x-S.x+K.width/2<=da/2?X=0===fa?2:5:ca+K.width/2<=da/2&&(X=0===fa?3:6);return X};
a.zAj=function(S,K,da,fa,X,ca){ca=void 0===ca?!1:ca;var ja=C.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1),ea=C.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SkipTeachingCalloutEnabled",!1);if(a.dZd)(K=T.a.jub(fa))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(K,function(Pa){Pa&&(ja&&ea&&ca||a.u3c(Pa,X,da,5))});else if(S)if(fa&&fa.tabs.count){fa=
fa.tabs.oa(0);var qa=fa.USa[ba.a.id],pa=fa.jK.oa(0).Lva[ba.a.id];S.mNd(qa)&&(S=fa.isOfficeTab?S.yRh(qa,pa):S.l_h(qa))&&(S.x+S.width/2>U.a.s4a()&&(S=new Sys.UI.Bounds(U.a.s4a(),S.y+S.height,0,0)),ja&&ea&&ca||a.s3c(K,S,a.rve(da),X,2,0))}else m.ULS.sendTraceTag(17326355,220,50,"There is no tab or group added to ribbon !");else m.ULS.sendTraceTag(594830283,220,50,"ribbonRoot is null, preventing finding the tab or group to which the callout should point.")};a.AAj=function(S,K,da,fa,X){X=void 0===X?!1:
X;a.zAj(S,K,fa.startedNode?fa.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,da),fa,fa.startedNode?fa.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,da),X)};a.yAj=function(S,K,da,fa){if(a.dZd)S=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,da,fa,CommonUIStrings.l_InsertionDialogRefresh)),a.u3c(K,S,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{K=Q.a.Dn(K);
var X=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),ca=document.createElement("span");ca.innerText=X[0];var ja=document.createElement("span");ja.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,da,fa,CommonUIStrings.l_InsertionDialogRefresh);ja.className="UIFontBold";da=document.createElement("span");da.innerText=X[1];fa=document.createElement("div");Sys.UI.DomElement.addCssClass(fa,"ModalCalloutControl");fa.appendChild(ca);fa.appendChild(ja);fa.appendChild(da);
a.s3c(S,K,fa,CommonUIStrings.l_ErrorLoadingAddInsTitle,3,1)}};a.VBj=function(S,K){var da=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,fa=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.dZd?a.u3c(K,da,fa):(K=Q.a.Dn(K),a.s3c(S,K,a.rve(fa),da,3,1))};a.rve=function(S){var K=document.createElement("div");Sys.UI.DomElement.addCssClass(K,"ModalCalloutControl");K.innerText=S;return K};a.DZe=function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};
Sk.Object.defineProperties(a,{y_b:{configurable:!0,enumerable:!0,get:function(){return a.gfa||(a.gfa=la.a.instance.Oh("Common.Utils.IAriaNotifier"))}},dZd:{configurable:!0,enumerable:!0,get:function(){return C.AFrameworkApplication.sa.Qa.Oi&&C.AFrameworkApplication.sa.Qa.sR}}});a.nJ=null;a.Wkb=null;a.gfa=null;Object(A.a)(a,"AddInCommandsNotificationFactory",null,[])},1074:function(A,F,b){function a(u,C,r,J,v){this.Is=u;this.gJ=r;this.E1=J;this.Nd=v;this.nhb=this.gJ.Ji;this.By=this.nhb.getOsfControl(C);
this.ysg=this.By.getManifest()}function c(u,C,r,J){this._id=u;this.Is=C;this.E1=r;this.Nd=J}function e(u,C,r,J){this.$z=!1;this._id=u;this.Is=C;this.E1=r;this.Nd=J}b.r(F);A=b(0);var l=b(13),n=b(1413),m=b(151),f=b(116),x=b(845),y=b(860),t=b(337);e.prototype.setEnabled=function(){};e.prototype._OnAccess=function(){};e.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonButton"};e.prototype.invokePropertyGet=function(u){switch(u){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
};e.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};e.prototype.invokePropertySet=function(u,C){switch(u){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(C,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};e.prototype.invokePropertySetAsync=function(u,C){this.invokePropertySet(u,C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
e.prototype.invokeMethod=function(u,C){switch(u){case 5:return this.frj(C);case 1:return this.mCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};e.prototype.invokeMethodAsync=function(u,C){u=this.invokeMethod(u,C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};e.prototype.frj=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setEnabled(u);return null};e.prototype.mCa=function(){this._OnAccess();return null};
Sk.Object.defineProperties(e.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.$z},set:function(u){var C=b(1074).DynamicRibbon,r=this.Nd.OwnerAddinStoreType,J=this.Nd.PrimaryMarketplace.MarketplaceRef,v={};v=(v.addinAssetId=Telemetry.PrivacyRules.GetAssetId(r,J,this.Is),v.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(r,J,this.Nd.OwnerAddinAssetId),v.ownerAddinStoreType=r,v.ribbonControlType="Button",v.toggle=u,v);m.a.sendTelemetryEvent(Object.assign(new t.a,{name:C.Czc+
"ControlUpdate",dataFields:f.a.Rk(v)}));this.$z=u;u={};r=(u.DynamicAddinCommandsMethodDispatchId=1,u.SolutionId=this.Is,u.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(r,J,this.Is),u.SourceControlId=this.id,u.MethodData=this.$z,u);this.E1.kK(-1014260128,r)}},id:{configurable:!0,enumerable:!0,get:function(){return this._id}},label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(A.a)(e,"RibbonButton",null,[]);c.prototype.setVisibility=function(u){var C=b(1074).DynamicRibbon,
r=this.Nd.OwnerAddinStoreType,J=this.Nd.PrimaryMarketplace.MarketplaceRef,v={};v=(v.addinAssetId=Telemetry.PrivacyRules.GetAssetId(r,J,this.Is),v.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(r,J,this.Nd.OwnerAddinAssetId),v.ownerAddinStoreType=r,v.ribbonControlType="Tab",v.toggle=u,v);m.a.sendTelemetryEvent(Object.assign(new t.a,{name:C.Czc+"ControlUpdate",dataFields:f.a.Rk(v)}));C={};u=(C.DynamicAddinCommandsMethodDispatchId=2,C.SolutionId=this.Is,C.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(r,
J,this.Is),C.StoreType=r,C.SourceControlId=this.id,C.MethodData=u,C);this.E1.kK(-1014260128,u)};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};c.prototype.invokePropertyGet=function(u){switch(u){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};c.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};
c.prototype.invokePropertySet=function(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};c.prototype.invokePropertySetAsync=function(u,C){this.invokePropertySet(u,C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};c.prototype.invokeMethod=function(u,C){switch(u){case 3:return this.$uj(C);case 1:return this.mCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};c.prototype.invokeMethodAsync=function(u,C){u=this.invokeMethod(u,
C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};c.prototype.$uj=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"boolean");this.setVisibility(u);return null};c.prototype.mCa=function(){this._OnAccess();return null};Sk.Object.defineProperties(c.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(A.a)(c,"RibbonTab",null,[]);var B=b(1118),z=b(157);b.d(F,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=
function(u){try{var C={},r=(C.addinAssetId=Telemetry.PrivacyRules.GetAssetId(this.Nd.OwnerAddinStoreType,this.Nd.PrimaryMarketplace.MarketplaceRef,this.Is),C.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(this.Nd.OwnerAddinStoreType,this.Nd.PrimaryMarketplace.MarketplaceRef,this.Nd.OwnerAddinAssetId),C.ownerAddinStoreType=this.Nd.OwnerAddinStoreType,C.ribbonControlType="Ribbon",C);m.a.sendTelemetryEvent(Object.assign(new t.a,{name:a.Czc+"ExecuteRequestCreate",dataFields:f.a.Rk(r)}));var J=z.a.pi(u);
u={};C={};C[x.a.GIa]=this.By;C[x.a.HIa]=J;C[x.a.L7c]=this.Nd;u[x.a.usb]=3;u[x.a.Y3]=this.Is;u[x.a.g7b]=Telemetry.PrivacyRules.GetAssetId(this.Nd.OwnerAddinStoreType,this.Nd.PrimaryMarketplace.MarketplaceRef,this.Is);u[x.a.X3]=C;this.E1.kK(-1014260128,u);var v=a.F$b("ExecuteRequestCreate",!0,"");l.ULS.sendTraceTag(538572826,0,50,v)}catch(D){J=a.F$b("ExecuteRequestCreate",!1,D.toString()),l.ULS.sendTraceTag(538572825,0,50,J)}return null};a.prototype.executeRequestUpdate=function(u){try{var C=null,r=
null;C=this.Nd.OwnerAddinStoreType;r=this.Nd.PrimaryMarketplace.MarketplaceRef;var J={},v=(J.addinAssetId=Telemetry.PrivacyRules.GetAssetId(C,r,this.Is),J.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(C,r,this.Nd.OwnerAddinAssetId),J.ownerAddinStoreType=this.Nd.OwnerAddinStoreType,J.ribbonControlType="Ribbon",J);m.a.sendTelemetryEvent(Object.assign(new t.a,{name:a.Czc+"ExecuteRequestUpdate",dataFields:f.a.Rk(v)}));var D=z.a.pi(u);u={};J={};J[x.a.GIa]=this.By;J[x.a.HIa]=D;J[x.a.L7c]=this.Nd;
u[x.a.usb]=3;u[x.a.Y3]=this.Is;u[x.a.g7b]=Telemetry.PrivacyRules.GetAssetId(C,r,this.Is);u[x.a.X3]=J;this.E1.kK(-1014260128,u);var V=a.F$b("ExecuteRequestUpdate",!0,"");l.ULS.sendTraceTag(538572824,0,50,V)}catch(U){C=a.F$b("ExecuteRequestUpdate",!1,U.toString()),l.ULS.sendTraceTag(538572823,0,50,C)}return null};a.prototype.getButton=function(u){var C=null;if(!this.Udf())return this.zDe();if(u&&0<u.length){if(!this.Jye(u))return this.RDe(u);C=new e(u,this.Is,this.E1,this.Nd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(C)};
a.prototype.getTab=function(u){var C=null;if(!this.Udf())return this.zDe();if(this.By.getOwnerAddinControlRecreated())return this.g7g();if(u&&0<u.length){if(!this.Jye(u))return this.RDe(u);C=new c(u,this.Is,this.E1,this.Nd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(C)};a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};a.prototype.invokePropertyGet=function(u){switch(u){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
};a.prototype.invokePropertyGetAsync=function(u){u=this.invokePropertyGet(u);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};a.prototype.invokePropertySet=function(u){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);};a.prototype.invokePropertySetAsync=function(u,C){this.invokePropertySet(u,C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};a.prototype.invokeMethod=function(u){switch(u){case 1:return this.mCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(u);
};a.prototype.invokeMethodAsync=function(u,C){switch(u){case 7:return this.qzh(C);case 6:return this.rzh(C);case 3:return this.sLh(C);case 5:return this.k_h(C)}u=this.invokeMethod(u,C);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(u)};a.prototype.qzh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestCreate(u)};a.prototype.rzh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.executeRequestUpdate(u)};
a.prototype.sLh=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getButton(u)};a.prototype.k_h=function(u){u=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(u,0,"string");return this.getTab(u)};a.prototype.mCa=function(){this._OnAccess();return null};a.prototype.RDe=function(u){return B.a(y.a.O2g,z.a.fa(1721)+u)};a.prototype.zDe=function(){return B.a(y.a.gjj,z.a.fa(1717))};a.prototype.g7g=function(){return B.a(y.a.hostRestartNeeded,z.a.fa(1722))};
a.prototype.Udf=function(){var u=this.By.getSharedRuntimeId();u=!!u&&0<u.length;l.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",u));return u};a.prototype.Jye=function(u){var C=this.ysg.getRibbonExtensionControlMap();return u in C||this.bXg(u)};a.prototype.bXg=function(u){var C=this.$Ch();if(C){C=yl(C.yKe.tabs);for(var r=C.next();!r.done;r=C.next()){r=r.value;if(r.id===u)return!0;r=yl(r.groups);for(var J=r.next();!J.done;J=r.next()){J=yl(J.value.controls);
for(var v=J.next();!v.done;v=J.next()){v=v.value;if(v.id===u)return!0;if("Menu"===v.type){v=yl(v.items);for(var D=v.next();!D.done;D=v.next())if(D.value.id===u)return!0}}}}}return!1};a.prototype.$Ch=function(){return n.a.getInstance().cja(this.Nd.PrimaryMarketplace.MarketplaceType,this.Nd.PrimaryMarketplace.SolutionId,1)};a.F$b=function(u,C,r){var J={};J.methodName="DynamicRibbon."+u;J.result=C?"Succeeded":"Failed";J.message=r;return z.a.Kc(J)};Sk.Object.defineProperties(a.prototype,{buttons:{configurable:!0,
enumerable:!0,get:function(){return null}}});a.Czc="Office.Online.Extensibility.Ribbon.";Object(A.a)(a,"DynamicRibbon",null,[])},1095:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);a.N8b="extId";a.EBe="ComponentType";a.kHa="ComponentId";a.Bkd="HostProps";a.Tya="OptionalProps";Object(A.a)(a,"ActionPropertyNames",null,[])},1115:function(A,F,b){function a(c,e){var l=!1;c&&(c=e.osfControl,(e=c.getManifest())&&e.getSharedRuntimeForCustomFunctions("Workbook")&&!c.getIsUpgrading()&&
(l=!0));return l}b.d(F,"a",function(){return a})},1117:function(A,F,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.rha=this.iTa=this.pfd=this.Fhd=this.Yvb=this.hVd=null}b.d(F,"a",function(){return a});A=b(0);Object(A.a)(a,"AppsForOfficeOauthResult",null,[])},1118:function(A,F,b){function a(c,e){return OfficeExtension.WacRuntime.Utility.createPromise(function(l,n){n(OfficeExtension.WacRuntime.Utility.createRichApiException(c,e))})}b.d(F,"a",function(){return a})},1232:function(A,
F,b){function a(ma,Ka,Ta){this.Nwa=!1;this.hF={};this.$=ma;this.xh=Ka;this.umd().hna();this.indexedDB=Ta;this.indexedDB.rg()&&(this.Nwa=!0,this.indexedDB.initialize(a.wld,a.xld))}function c(ma,Ka){this.FQc=ma;this._message=Ka}function e(){}function l(){}function n(ma){switch(ma){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function m(ma,Ka){z(b(1232).CustomFunctionsInstaller.G0e("CustomFunctionsRuntimeLogging"),function(Ta){if(Ta.result&&window.console)switch(Ta=
n(ma.severity)+" "+ma.message+Ka,ma.severity){case 2:window.console.log&&window.console.log(Ta);break;case 0:window.console.info&&window.console.info(Ta);break;case 1:window.console.error&&window.console.error(Ta)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}function f(ma,Ka,Ta,ob,Cb){Ta=ma.CWCT(function(){Ka(ma)},Ta,3,ob);Ta.continueWith(function(){V.ULS.sendTraceTag(537163459,0,10,Cb)},4);return Ta}function x(ma,Ka,Ta){return f(ma,Ka,
ja.a.none,ea.a.current,Ta)}function y(ma,Ka,Ta,ob,Cb){Ta=ma.CWRCT(function(){return Ka(ma)},Ta,3,ob);Ta.continueWith(function(){V.ULS.sendTraceTag(537163460,0,10,Cb)},4);return da.TaskExtensions.ZAc(Ta)}function t(ma,Ka,Ta){return y(ma,Ka,ja.a.none,ea.a.current,Ta)}function B(ma,Ka,Ta,ob,Cb){Ta=ma.CWRCT(function(){return Ka(ma)},Ta,3,ob);Ta.continueWith(function(){V.ULS.sendTraceTag(537163461,0,10,Cb)},4);return Ta}function z(ma,Ka,Ta){return B(ma,Ka,ja.a.none,ea.a.current,Ta)}function u(ma,Ka,Ta,
ob,Cb){Ta=ma.CWRCT(function(){return Ka(ma)},Ta,3,ob);Ta.continueWith(function(){V.ULS.sendTraceTag(537163462,0,10,Cb)},4);return da.TaskExtensions.ZAc(Ta)}function C(ma,Ka,Ta){return u(ma,Ka,ja.a.none,ea.a.current,Ta)}function r(ma,Ka,Ta,ob,Cb){Ta=ma.CWCT(function(){Ka(ma)},Ta,3,ob);Ta.continueWith(function(){V.ULS.sendTraceTag(537163463,0,10,Cb)},4);return Ta}function J(ma,Ka,Ta){return r(ma,Ka,ja.a.none,ea.a.current,Ta)}function v(){}function D(ma){ma=ma.split("|");this.Is=ma[1];this.kRc=ma[2];
this.YTd=ma[3]}b.r(F);A=b(0);var V=b(13),U=b(5),Q=b(139),la=b(184),ba=b(84),T=b(521),H=b(164),S=b(81),K=b(56),da=b(35),fa=b(220),X=b(114),ca=b(554);Sk.Object.defineProperties(D.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Is}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.kRc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.YTd===OSF.StoreTypeEnum.Registry.toString()}}});Object(A.a)(D,"AddinStoreInfo",
null,[]);Object(A.a)(v,"CustomFunctionRegistrationInfos",null,[]);var ja=b(199),ea=b(59),qa=b(1115);Object(A.a)(l,"InstallationInfo",null,[]);Object(A.a)(e,"UninstallationInfo",null,[]);var pa=b(26),Pa=b(92),Ha=b(32),Xa=b(27),Na=b(1),db=b(19),Ja=b(272),jb=b(913),hc=b(52);Sk.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.FQc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(A.a)(c,"CustomFunctionLog",null,
[]);b.d(F,"CustomFunctionsInstaller",function(){return a});a.prototype.Cbf=function(ma,Ka,Ta,ob){var Cb=this;if(ob.invariantNamespace)for(var eb=0;eb<ob.invariantNamespace.length;++eb){var ya=ob.invariantNamespace.charAt(eb);if("."!==ya&&"_"!==ya&&"a">ya&&"z"<ya&&"A">ya&&"Z"<ya&&"0">ya&&"9"<ya)throw V.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",ya,eb),Error.create("InvariantNamespace validation failed");
}return C(this.rTg(Ta,ob.manifest),function(){return C(Cb.PGd(ma),function(za){var Ga=za.result;return(null===Ga||void 0===Ga?0:Ga.isDynamicMetadata)?Cb.THd(ma,Ka,Ga,!1,!1,!1):C(Cb.gZj(ma,Ka,ob),function(cb){var Mb;Ga=(Mb=new l,Mb.addinId=Ta,Mb.locale=ob.locale,Mb.addinInvariantNamespace=ob.invariantNamespace,Mb.addinNamespace=ob.namespace,Mb.addinTitle=ob.title,Mb.isXllCompatible=ob.isXllCompatible,Mb.metadataContent=JSON.stringify(JSON.parse(cb.result)),Mb);return Cb.THd(ma,Ka,Ga,!1,a.qAh(ob.osfControl.getStoreType()),
qa.a(Cb.$,ob))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.Ebf=function(ma,Ka,Ta,ob){var Cb=this;if(!a.xrd(Ta))throw V.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),Error.create("Invalid Metadata JSON");return C(this.PGd(ma),
function(eb){eb=eb.result;if(!eb&&(eb=Ha.a.Gc(Cb.KV,ma),!eb))throw V.ULS.sendTraceTag(537163550,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetAssetId(Ka,null,ma))),Error.create("Customfunctions dynamic registration failed");eb.metadataContent=JSON.stringify(JSON.parse(Ta));eb.isDynamicMetadata=!0;return Cb.THd(ma,Ka,eb,!0,!0,ob)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};
a.prototype.Tbg=function(ma,Ka){var Ta=this;this.xh.Lia();var ob=Object.assign(new e,{solutionId:ma}),Cb=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetAssetId(Ka,null,ma));return C(this.FId(ma),function(){return C(Ta.MId(ma),function(){return Ta.zXd(Ta.xh,ma,Ka,ob)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},Cb)};a.prototype.gZj=function(ma,Ka,Ta){var ob=new Q.a;OSF.OUtil.xhrGet(Ta.metadataUrl,
function(Cb){Cb?ob.setResult(Cb):ob.setException(Error.create("Invalid manifest"))},function(Cb){V.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetAssetId(Ka,null,ma),Cb);ob.setException(Error.create("Failed to download manifest"))});return ob.task};a.prototype.umd=function(){var ma=this;return C(this.frc(),function(Ka){var Ta=Ka.result;if(!Ta.length)return hc.Task.Ta(!0);
V.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");Ka=new la.a;for(var ob=[],Cb={},eb=0;eb<Ta.length;Cb={mPb:Cb.mPb},eb++)Cb.mPb=Object(ba.a)(String,Ta[eb]),Ka.add(z(ma.PGd(Cb.mPb),function(ya){return function(za){if(za=za.result){var Ga=Ha.a.Gc(ma.hF,za.addinId);Ga&&Ga===za.metadataContent||(ma.hF[za.addinId]=za.metadataContent,ma.KV[ya.mPb]=za,Array.add(ob,za))}return!0}}(Cb),"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));
return t(hc.Task.WAE(Ka),function(){if(ob.length){var ya,za=(ya=new v,ya.registrationInfos=ob,ya);return ma.a0b(ma.xh,Ta,za)}V.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return hc.Task.Ta(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},"CustomFunctionsInstaller::InstallFromCacheAsync failed")};a.prototype.Fbf=function(){var ma=this,Ka=new Q.a;new la.a;var Ta=
[],ob=[];Object.keys(this.KV).forEach(function(Cb){Cb=Object(ba.a)(String,Cb);var eb=Ha.a.Gc(ma.KV,Cb);Array.add(Ta,eb);Array.add(ob,Cb)});if(!ob.length)return Ka.setResult(!0),Ka.task;Ka=Object.assign(new v,{registrationInfos:Ta});return this.a0b(this.xh,ob,Ka)};a.prototype.frc=function(){return z(this.Ifd(ca.a.UYa),function(ma){ma=ma.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(ma||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(ma||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};
a.prototype.xhg=function(ma){return this.SOd(ca.a.UYa,Sys.Serialization.JavaScriptSerializer.serialize(ma))};a.prototype.PGd=function(ma){return C(this.Ifd(ca.a.V3a(ma)),function(Ka){Ka=Ka.result||"";return 0<Ka.length?hc.Task.Ta(Sys.Serialization.JavaScriptSerializer.deserialize(Ka,!0)):hc.Task.Ta(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.$Yj=function(ma,Ka){var Ta=this;return C(this.fMe(ma),function(){return C(Ta.SOd(ca.a.V3a(ma),
Sys.Serialization.JavaScriptSerializer.serialize(Ka)),function(){return a.TOd(ca.a.ujd,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.FId=function(ma){var Ka=this;return C(this.xPf(ma),function(){return C(Ka.QPf(ca.a.V3a(ma)),function(){return C(Ka.frc(),function(Ta){return Ta.result.length?hc.Task.Ta(!0):a.TOd(ca.a.ujd,
"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.eNf=function(ma){return this.Ifd(ca.a.U3a(ma))};a.prototype.uhg=function(ma,Ka){var Ta=this;return C(this.fMe(ma),function(){return Ta.SOd(ca.a.U3a(ma),
Ka)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.MId=function(ma){var Ka=this;return C(this.xPf(ma),function(){return Ka.QPf(ca.a.U3a(ma))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.fMe=function(ma){var Ka=this;return C(this.frc(),function(Ta){Ta=Ta.result;var ob=ma.toLowerCase();if(Array.contains(Ta,ob))return hc.Task.Ta(!0);Ta.push(ob);return Ka.xhg(Ta)},
"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.xPf=function(ma){var Ka=this;return C(this.frc(),function(Ta){Ta=Ta.result;var ob=ma.toLowerCase();return Array.contains(Ta,ob)?(Ta.splice(Array.indexOf(Ta,ob),1),Ka.xhg(Ta)):hc.Task.Ta(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.rTg=function(ma,Ka){if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return ma=
new OSF.AddinIdInfo(ma),ma.needToRestoreManifest()?this.uhg(ma.getSolutionId(),Ka):hc.Task.Ta(!0);ma=new D(ma);return ma.needToRestoreManifest?this.uhg(ma.solutionId,Ka):hc.Task.Ta(!0)};a.prototype.Fij=function(ma){var Ka=this;if(Na.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var Ta=new OSF.AddinIdInfo(ma);return Ta.needToRestoreManifest()?z(this.eNf(Ta.getSolutionId()),function(Cb){(Cb=Cb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Ta.getSolutionId(),
Ta.getSolutionVersion(),Cb,Ka.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):hc.Task.Ta(!0)}var ob=new D(ma);return ob.needToRestoreManifest?z(this.eNf(ob.solutionId),function(Cb){(Cb=Cb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(ob.solutionId,ob.solutionVersion,Cb,Ka.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):hc.Task.Ta(!0)};a.prototype.QPf=function(ma){return this.Nwa?
this.indexedDB.t6c(ma):a.Paj(ma)};a.prototype.SOd=function(ma,Ka){return this.Nwa?this.indexedDB.Vbb(new jb.a(ma,Ka)):a.TOd(ma,Ka)};a.prototype.Ifd=function(ma){return this.Nwa?this.indexedDB.kKa(ma):a.G0e(ma)};a.prototype.THd=function(ma,Ka,Ta,ob,Cb,eb){var ya=this,za=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetAssetId(Ka,null,ma));return da.TaskExtensions.ZAc(z(this.UHd(this.xh,ma,Ka,Ta,!1,ob,eb),
function(){return Cb?ya.$Yj(ma,Ta):hc.Task.Ta(!0)},za))};a.prototype.UHd=function(ma,Ka,Ta,ob,Cb,eb,ya){var za=this;if(!eb&&(eb=Ha.a.Gc(this.hF,ob.addinId))&&eb===ob.metadataContent)return hc.Task.Ta(!0);this.hF[ob.addinId]=ob.metadataContent;this.KV[Ka]=ob;ya||ma.RGb(Ka);ma.Lia();return C(this.t9i(Ka,Ta,ob),function(){return za.AFd(ob.addinId,Cb)},"Failed to register functions for customfunction addin")};a.prototype.t9i=function(ma,Ka,Ta){var ob=this,Cb=new Q.a,eb=this.dpb(Ta);return this.Tia(function(ya){Na.EwaSettings.la(258)&&
m(a.Arb,ma);(ya=ya.Result)&&204===ya.ResponseStatusCode?Cb.setResult(!0):(delete ob.hF[Ta.addinId],delete ob.KV[ma],J(ob.FId(ma),function(){J(ob.MId(ma),function(){ob.Q3f()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",ma,ya?ya.ResponseStatusCode.toString():"Unknown")),Cb.setResult(!1))},function(ya){ya=X.a.og(ya.data);V.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",
Telemetry.PrivacyRules.GetAssetId(Ka,null,ma),Xa.a.Tc(ya));Na.EwaSettings.la(258)&&m(a.zrb,ma);delete ob.hF[Ta.addinId];delete ob.KV[ma];Cb.setResult(!1)},eb,Cb,!0)};a.prototype.a0b=function(ma,Ka,Ta){var ob=this,Cb=new Q.a,eb=pa.a.Ra.he.m;Ka.forEach(function(za){za=Object(ba.a)(String,za);ma.nye(za)});ma.Lia();var ya=this.PYc(Ta);return this.Tia(function(za){Na.EwaSettings.la(258)&&m(a.Arb,Sys.Serialization.JavaScriptSerializer.serialize(Ka));za=za.Result;var Ga=!0,cb=Sys.Serialization.JavaScriptSerializer.deserialize(za.ResponseBody.toString());
cb=Array.isArray(cb.value)?cb.value:null;for(var Mb=new la.a,Dc={Xea:0};Dc.Xea<cb.length;Dc={Xea:Dc.Xea},Dc.Xea++)if(!cb[Dc.Xea]){Ga=!1;var vb=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",za.ResponseStatusCode);Mb.add(C(ob.FId(Ka[Dc.Xea]),function(ib){return function(){delete ob.hF[Ta.registrationInfos[ib.Xea].addinId];delete ob.KV[Ka[ib.Xea]];return ob.MId(Ka[ib.Xea])}}(Dc),vb))}x(hc.Task.WAE(Mb),function(){J(ob.AFd("",
!1),function(){V.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",pa.a.Ra.he.m-eb);Ga?Cb.setResult(Ga):x(ob.Q3f(),function(){Cb.setResult(Ga)},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(za){za=
X.a.og(za.data);V.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",Xa.a.Tc(za));Na.EwaSettings.la(258)&&m(a.zrb,Sys.Serialization.JavaScriptSerializer.serialize(Ka));for(za=0;za<Ta.registrationInfos.length;za++)delete ob.hF[Ta.registrationInfos[za].addinId],delete ob.KV[Ka[za]];Cb.setResult(!1)},ya,Cb,!0)};a.prototype.zXd=function(ma,Ka,Ta,ob){var Cb=this;return C(this.nQj(ma,Ka,Ta,ob),function(){return Cb.AFd(ob.solutionId,
!1)},"Failed to unregister functions for customfunction addin")};a.prototype.nQj=function(ma,Ka,Ta,ob){var Cb=new Q.a;ma.RGb(Ka);(ma=Ha.a.Gc(this.KV,Ka))&&delete this.hF[ma.addinId];delete this.KV[Ka];ob=this.$Yc(ob);return this.Tia(function(){Na.EwaSettings.la(258)&&m(a.r5c,Ka);Cb.setResult(!0)},function(eb){eb=X.a.og(eb.data);V.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(Ta,
Ta,Ka),Xa.a.Tc(eb));Na.EwaSettings.la(258)&&m(a.q5c,Ka);Cb.setResult(!1)},ob,Cb,!1)};a.prototype.Tia=function(ma,Ka,Ta,ob,Cb){function eb(){function Dc(ub,Eb,Ya){Na.EwaSettings.la(258)&&m(Cb?a.p5c:a.s5c,vb.RequestBody);return S.i(za.ta,"ExecuteRichApiRequest",Ta,Ja.b(ub,ma),Ja.a(Eb,Ka),Ya,null,0)}if(ya.qHa()||0<za.ta.j4||0<za.Dk.j4)return!1;Ga&&ya.jv(Ga);cb&&za.yr(cb);Mb&&za.Ez(Mb);var vb=Ta.request,ib=0;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?vb.RequestFlags&
1&&256!==(vb.RequestFlags&256)||(ib=16):ib=vb.RequestFlags&1?0:16;Na.EwaSettings.sc()?ya.Nt(new H.a(507,0,Dc,ib|64)):ya.Nt(new T.a(507,0,Dc,ib));return!0}var ya=this.$.userOperationManager,za=this.$.na,Ga=null,cb=null,Mb=null;eb()||(Ga=function(){eb()},cb=function(){eb()},Mb=function(){eb()},ya.lx(Ga),za.uq(cb),za.Ky(Mb));return ob.task};a.prototype.dpb=function(ma){var Ka={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};Ka.RequestBody=JSON.stringify(ma);Ka.RequestFlags=
1;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ka.RequestFlags|=256);ma=this.$.na.ta.Na(1);ma.request=Ka;return ma};a.prototype.PYc=function(ma){var Ka={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};Ka.RequestBody=JSON.stringify(ma);Ka.RequestFlags=1;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ka.RequestFlags|=256);ma=this.$.na.ta.Na(1);ma.request=Ka;return ma};a.prototype.$Yc=
function(ma){var Ka={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};Ka.RequestBody=JSON.stringify(ma);Ka.RequestFlags=1;Na.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(Ka.RequestFlags|=256);ma=this.$.na.ta.Na(1);ma.request=Ka;return ma};a.prototype.AFd=function(ma,Ka){var Ta=this,ob=K.GetServiceTaskFactory.create(this.$.da,153,this.$.ma,1);return u(ob,function(){ob.result.RKd();return ma&&Ka?Ta.Fij(ma):hc.Task.Ta(!0)},this.$.ma,
fa.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.Q3f=function(){var ma=new Pa.a(1949669462,0,this.$.gd,0,null);return this.$.Ka.Xb(ma)};a.G0e=function(ma){try{return hc.Task.Ta(localStorage.getItem(ma))}catch(Ka){return V.ULS.sendTraceTag(537163537,0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",Ka.message||"Unknown"),hc.Task.Ta(null)}};a.TOd=function(ma,
Ka){try{return localStorage.setItem(ma,Ka),hc.Task.Ta(!0)}catch(Ta){return V.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",Ta.message||"Unknown"),hc.Task.Ta(!1)}};a.Paj=function(ma){try{return localStorage.removeItem(ma),hc.Task.Ta(!0)}catch(Ka){return V.ULS.sendTraceTag(537163535,0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",Ka.message||
"Unknown"),hc.Task.Ta(!1)}};a.qAh=function(ma){return db.a.equals(ma,"registry",!0)||db.a.equals(ma,"uploadfiledevcatalog",!0)||U.AFrameworkApplication.userNameUnknown||U.AFrameworkApplication.limitedEdit};a.xrd=function(ma){if(!ma)return!1;try{JSON.parse(ma)}catch(Ka){return!1}return!0};Sk.Object.defineProperties(a.prototype,{KV:{configurable:!0,enumerable:!0,get:function(){return this.xh.KV}}});a.wld="CustomFunctionCache";a.xld="CustomFunction";a.p5c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");
a.Arb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.zrb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.s5c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.r5c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.q5c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(A.a)(a,"CustomFunctionsInstaller",null,[431])},1234:function(A,F,b){function a(fa){this.hF={};this.$=fa;this.umd().hna()}
function c(fa,X){this.FQc=fa;this._message=X}function e(){}function l(){}function n(fa){switch(fa){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function m(fa,X){if(b(1234).CustomFunctionsLegacyInstaller.qvb("CustomFunctionsRuntimeLogging")&&window.console)switch(X=n(fa.severity)+" "+fa.message+X,fa.severity){case 2:window.console.log&&window.console.log(X);break;case 0:window.console.info&&window.console.info(X);break;case 1:window.console.error&&window.console.error(X)}}
function f(){}function x(fa){fa=fa.split("|");this.Is=fa[1];this.kRc=fa[2];this.YTd=fa[3]}b.r(F);A=b(0);var y=b(13),t=b(1065),B=b(139),z=b(84),u=b(521),C=b(164),r=b(81),J=b(56),v=b(35),D=b(114),V=b(554),U=b(1115);Sk.Object.defineProperties(x.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Is}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.kRc}},needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.YTd===OSF.StoreTypeEnum.Registry.toString()}}});
Object(A.a)(x,"AddinStoreInfo",null,[]);Object(A.a)(f,"CustomFunctionRegistrationInfos",null,[]);Object(A.a)(l,"InstallationInfo",null,[]);Object(A.a)(e,"UninstallationInfo",null,[]);var Q=b(147),la=b(32),ba=b(27),T=b(1),H=b(14),S=b(272),K=b(1011),da=b(52);Sk.Object.defineProperties(c.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.FQc}},message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(A.a)(c,"CustomFunctionLog",null,[]);b.d(F,"CustomFunctionsLegacyInstaller",
function(){return a});a.prototype.Cbf=function(fa,X,ca,ja){var ea=this,qa=new B.a;if(ja.invariantNamespace)for(X=0;X<ja.invariantNamespace.length;++X){var pa=ja.invariantNamespace.charAt(X);if("."!==pa&&"_"!==pa&&"a">pa&&"z"<pa&&"A">pa&&"Z"<pa&&"0">pa&&"9"<pa)return y.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",pa,X),qa.setResult(!1),qa.task}a.cacheManifest(ca,ja.manifest);var Pa=a.QGd(fa);(null===
Pa||void 0===Pa?0:Pa.isDynamicMetadata)?this.SHd(fa,Pa,qa,!1,!1):OSF.OUtil.xhrGet(ja.metadataUrl,function(Ha){Pa=Object.assign(new l,{addinId:ca,locale:ja.locale,addinInvariantNamespace:ja.invariantNamespace,addinNamespace:ja.namespace,addinTitle:ja.title,isXllCompatible:ja.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(Ha))});ea.SHd(fa,Pa,qa,!1,U.a(ea.$,ja))},function(Ha){y.ULS.sendTraceTag(537163528,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",
fa,Ha);qa.setResult(!1)});return qa.task};a.prototype.Ebf=function(fa,X,ca,ja){X=new B.a;if(!a.xrd(ca))return y.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),X.setResult(!1),X.task;var ea=a.QGd(fa);if(!ea)return y.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),X.setResult(!1),X.task;ea.metadataContent=JSON.stringify(JSON.parse(ca));
ea.isDynamicMetadata=!0;this.SHd(fa,ea,X,!0,ja);return X.task};a.prototype.Tbg=function(fa){var X=this,ca=new B.a,ja=J.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);v.TaskExtensions.Ba(ja,function(){var ea=ja.result;ea.Lia();var qa=Object.assign(new e,{solutionId:fa});a.GId(fa);a.NId(fa);v.TaskExtensions.Ba(X.zXd(ea,fa,qa),function(pa){Q.b(pa)?ca.setResult(pa.result):(pa.kg?y.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",
fa):pa.Ih&&y.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",fa),ca.setResult(!1))},X.$.ma,0)},this.$.ma,3);return ca.task};a.prototype.umd=function(){var fa=this,X=new B.a,ca=a.UGd();0<ca.length&&y.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var ja=[];ca.forEach(function(qa){qa=Object(z.a)(String,qa);if(qa=a.QGd(qa)){var pa=
la.a.Gc(fa.hF,qa.addinId);pa&&pa===qa.metadataContent||(fa.hF[qa.addinId]=qa.metadataContent,Array.add(ja,qa))}});if(!ja.length)return X.setResult(!0),y.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),X.task;var ea=J.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);v.TaskExtensions.Ba(ea,function(){var qa=ea.result,pa=Object.assign(new f,{registrationInfos:ja});v.TaskExtensions.Ba(fa.a0b(qa,ca,pa),function(Pa){Q.b(Pa)?
X.setResult(Pa.result):(Pa.kg?y.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):Pa.Ih&&y.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),X.setResult(!1))},fa.$.ma,0)},this.$.ma,3);return X.task};a.prototype.Eij=function(fa){fa=new x(fa);if(fa.needToRestoreManifest){var X=a.M6i(fa.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(fa.solutionId,
fa.solutionVersion,X,this.$.ya.UICultureTag)}};a.prototype.SHd=function(fa,X,ca,ja,ea){var qa=this,pa=J.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);v.TaskExtensions.Ba(pa,function(){v.TaskExtensions.Ba(qa.UHd(pa.result,fa,X,!1,ja,ea),function(Pa){Q.b(Pa)?((Pa=Pa.result)&&a.aZj(fa,X),ca.setResult(Pa)):(Pa.kg?y.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",fa):Pa.Ih&&y.ULS.sendTraceTag(537163487,0,10,
"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",fa),ca.setResult(!1))},qa.$.ma,0)},this.$.ma,3)};a.prototype.UHd=function(fa,X,ca,ja,ea,qa){var pa=this;if(!ea&&(ea=la.a.Gc(this.hF,ca.addinId))&&ea===ca.metadataContent)return da.Task.Ta(!0);this.hF[ca.addinId]=ca.metadataContent;var Pa=new B.a;qa||fa.RGb(X);fa.Lia();fa=this.dpb(ca);return this.Tia(function(Ha){T.EwaSettings.la(258)&&m(a.Arb,X);var Xa=Ha.Result;204===Xa.ResponseStatusCode?v.TaskExtensions.Ba(pa.zFd(Pa,
ca.addinId,ja),function(Na){Na.kg?X?y.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",X):y.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",ca.addinId):Na.Ih&&(X?y.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",
X):y.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",ca.addinId));Pa.setResult(!1)},pa.$.ma,4):(Ha=function(){delete pa.hF[ca.addinId];a.GId(X);a.NId(X);y.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",X,Xa.ResponseStatusCode);Pa.setResult(!1)},Ha=Object.assign(new K.a,{BLa:OSF.InfoType.Error,
title:ca.addinTitle,description:String.format(H.a.instance.Cb(152),H.a.instance.fa(1840)),buttonText:H.a.instance.fa(4),Fha:Ha,Idc:!1,Aia:Ha,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),t.a.vRd(Ha))},function(Ha){Ha=D.a.og(Ha.data);y.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",X,ba.a.Tc(Ha));T.EwaSettings.la(258)&&m(a.zrb,X);delete pa.hF[ca.addinId];Pa.setResult(!1)},
fa,Pa,!0)};a.prototype.a0b=function(fa,X,ca){var ja=this,ea=new B.a;X.forEach(function(pa){pa=Object(z.a)(String,pa);fa.nye(pa)});fa.Lia();var qa=this.PYc(ca);return this.Tia(function(pa){T.EwaSettings.la(258)&&m(a.Arb,Sys.Serialization.JavaScriptSerializer.serialize(X));pa=pa.Result;var Pa=!0,Ha=Sys.Serialization.JavaScriptSerializer.deserialize(pa.ResponseBody.toString());Ha=Array.isArray(Ha.value)?Ha.value:null;for(var Xa=0;Xa<Ha.length;Xa++)Ha[Xa]||(Pa=!1,delete ja.hF[ca.registrationInfos[Xa].addinId],
a.GId(X[Xa]),a.NId(X[Xa]),y.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",X[Xa],pa.ResponseStatusCode));v.TaskExtensions.Ba(ja.zFd(ea,"",!1),function(Na){Na.kg?y.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):Na.Ih&&y.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");
ea.setResult(!1)},ja.$.ma,4);ea.setResult(Pa)},function(pa){pa=D.a.og(pa.data);y.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",Sys.Serialization.JavaScriptSerializer.serialize(X),ba.a.Tc(pa));T.EwaSettings.la(258)&&m(a.zrb,Sys.Serialization.JavaScriptSerializer.serialize(X));pa=yl(ca.registrationInfos);for(var Pa=pa.next();!Pa.done;Pa=pa.next())delete ja.hF[Pa.value.addinId];
ea.setResult(!1)},qa,ea,!0)};a.prototype.zXd=function(fa,X,ca){var ja=this,ea=new B.a;fa.RGb(X);fa=this.$Yc(ca);return this.Tia(function(){T.EwaSettings.la(258)&&m(a.r5c,X);v.TaskExtensions.Ba(ja.zFd(ea,ca.solutionId,!1),function(qa){qa.kg?X&&y.ULS.sendTraceTag(537163473,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",X):qa.Ih&&X&&y.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",
X);ea.setResult(!1)},ja.$.ma,4)},function(qa){qa=D.a.og(qa.data);y.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",X,ba.a.Tc(qa));T.EwaSettings.la(258)&&m(a.q5c,X);ea.setResult(!1)},fa,ea,!1)};a.prototype.Tia=function(fa,X,ca,ja,ea){function qa(){function db(hc,ma,Ka){T.EwaSettings.la(258)&&m(ea?a.p5c:a.s5c,Ja.RequestBody);return r.i(Pa.ta,"ExecuteRichApiRequest",ca,S.b(hc,fa),S.a(ma,
X),Ka,null,0)}if(pa.qHa()||0<Pa.ta.j4||0<Pa.Dk.j4)return!1;Ha&&pa.jv(Ha);Xa&&Pa.yr(Xa);Na&&Pa.Ez(Na);var Ja=ca.request,jb=Ja.RequestFlags&1?0:16;T.EwaSettings.sc()?pa.Nt(new C.a(507,0,db,jb|64)):pa.Nt(new u.a(507,0,db,jb));return!0}var pa=this.$.userOperationManager,Pa=this.$.na,Ha=null,Xa=null,Na=null;qa()||(Ha=function(){qa()},Xa=function(){qa()},Na=function(){qa()},pa.lx(Ha),Pa.uq(Xa),Pa.Ky(Na));return ja.task};a.prototype.dpb=function(fa){var X={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",
RequestHeaders:null};X.RequestBody=JSON.stringify(fa);X.RequestFlags=1;fa=this.$.na.ta.Na(1);fa.request=X;return fa};a.prototype.PYc=function(fa){var X={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};X.RequestBody=JSON.stringify(fa);X.RequestFlags=1;fa=this.$.na.ta.Na(1);fa.request=X;return fa};a.prototype.$Yc=function(fa){var X={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};X.RequestBody=JSON.stringify(fa);X.RequestFlags=1;fa=
this.$.na.ta.Na(1);fa.request=X;return fa};a.prototype.zFd=function(fa,X,ca){var ja=this,ea=J.GetServiceTaskFactory.create(this.$.da,153,this.$.ma,1);v.TaskExtensions.Ba(ea,function(){ea.result.RKd();X&&ca&&ja.Eij(X);fa.setResult(!0)},this.$.ma,3);return ea};a.prototype.Fbf=function(){return da.Task.Ta(!0)};a.UGd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.qvb(V.a.UYa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.qvb(V.a.UYa)||"[]"):null)||
[]};a.yhg=function(fa){a.UOd(V.a.UYa,Sys.Serialization.JavaScriptSerializer.serialize(fa))};a.QGd=function(fa){fa=a.qvb(V.a.V3a(fa))||"";return 0<fa.length?Sys.Serialization.JavaScriptSerializer.deserialize(fa,!0):null};a.aZj=function(fa,X){a.eMe(fa);a.UOd(V.a.V3a(fa),Sys.Serialization.JavaScriptSerializer.serialize(X))};a.GId=function(fa){a.wPf(fa);a.RPf(V.a.V3a(fa))};a.M6i=function(fa){return a.qvb(V.a.U3a(fa))};a.bZj=function(fa,X){a.eMe(fa);a.UOd(V.a.U3a(fa),X)};a.NId=function(fa){a.wPf(fa);a.RPf(V.a.U3a(fa))};
a.eMe=function(fa){var X=a.UGd();fa=fa.toLowerCase();Array.contains(X,fa)||(X.push(fa),a.yhg(X))};a.wPf=function(fa){var X=a.UGd();fa=fa.toLowerCase();Array.contains(X,fa)&&(X.splice(Array.indexOf(X,fa),1),a.yhg(X))};a.cacheManifest=function(fa,X){fa=new x(fa);fa.needToRestoreManifest&&a.bZj(fa.solutionId,X)};a.qvb=function(fa){try{return localStorage.getItem(fa)}catch(X){return y.ULS.sendTraceTag(537163469,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",
X.message||"Unknown"),null}};a.UOd=function(fa,X){try{localStorage.setItem(fa,X)}catch(ca){y.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",ca.message||"Unknown")}};a.RPf=function(fa){try{localStorage.removeItem(fa)}catch(X){y.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",X.message||"Unknown")}};a.xrd=function(fa){if(!fa)return!1;
try{JSON.parse(fa)}catch(X){return!1}return!0};a.p5c=new c(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Arb=new c(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.zrb=new c(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.s5c=new c(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.r5c=new c(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.q5c=new c(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(A.a)(a,
"CustomFunctionsLegacyInstaller",null,[431])},1243:function(A,F,b){function a(ba,T,H,S,K){this.Ma=null;this.KVc="AddinActivated";this.$=ba;this.We=T;this.ownerAddinInfo=H;this.ae=void 0===K?null:K;this.PQa=(void 0===S?null:S)||Q.Task.Ta(!0);this.Ma=new t.a;return this}function c(ba){var T=U.call(this)||this;T.UCa="AddInCommandsDialog";T.Ue=T.UCa;T.jc=5;T.dialogWidth=695;T.dialogHeight=438;T.c2g="100%";T.$1g="408px";T.a2g="15px";T.b2g="0";T.ntg=ba;return T}function e(ba,T,H,S,K,da){var fa=ba.Na(9);
fa.sharedInfo=T;return z.i(ba,"InsertAgaveTaskpane",fa,H,S,K,da,0)}function l(){}A=b(0);var n=b(199),m=b(13),f=b(5);Object(A.a)(l,"AddinCommandsHost",null,[]);var x=b(1294),y=b(1365),t=b(36),B=b(949),z=b(81),u=b(521),C=b(369),r=b(164),J=b(35),v=b(1),D=b(272),V=b(140),U=V.a;vm(c,U);c.prototype.gD=function(){U.prototype.gD.call(this);this.yp.style.width=this.c2g;this.yp.style.height=this.$1g;this.yp.style.marginTop=this.a2g;this.yp.style.padding=this.b2g};c.prototype.IO=function(){U.prototype.IO.call(this);
this.Lb.style.width=String.format("{0}px",this.dialogWidth);this.Lb.style.height=String.format("{0}px",this.dialogHeight)};c.prototype.dispose=function(){U.prototype.dispose.call(this);this.ntg()};Sk.Object.defineProperties(c.prototype,{containerDiv:{configurable:!0,enumerable:!0,get:function(){return this.yp}}});Object(A.a)(c,"AddInCommandsDialog",V.a,[]);var Q=b(52),la=b(59);V=b(100);b.d(F,"a",function(){return a});vm(a,l);a.prototype.LDg=function(ba){this.Ma.addHandler(this.KVc,ba)};a.prototype.SPa=
function(){f.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",!1)&&(m.ULS.sendTraceTag(526235527,220,50,"survey addin {0} is used.",Telemetry.PrivacyRules.GetAssetId(this.ownerAddinInfo.storeType,this.ownerAddinInfo.storeId,this.ownerAddinInfo.solutionId)),this.Ma.raiseEvent(this.KVc,this.ownerAddinInfo.solutionId))};a.prototype.V1g=function(){var ba=this.PQa;this.PQa=Q.Task.Ta(!0);return ba};a.prototype.disposeHost=function(ba){this.We.rQa(ba)};
a.prototype.setOwnerAddinEToken=function(ba){this.ownerAddinInfo.eToken=ba};a.prototype.showTaskpane=function(ba,T,H){var S=this;m.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var K=null,da=!1,fa=(new x.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,new B.a,!0)).nGe(ba.solutionId.substr(this.ownerAddinInfo.solutionId.length));K=T.getSharedRuntimeForTaskpane("Workbook",fa);da=!!K&&1===K.LifeTime;this.We.qye(da?this.ownerAddinInfo.solutionId:ba.solutionId,da?K:null,
null)?this.SPa():(this.xnf(da,!0),this.PQa=this.smd(ba,K,function(X,ca){X?(da&&(X.PrimaryMarketplace.SolutionId=S.ownerAddinInfo.solutionId,X.SharedRuntime=K),X.WebExtensionOsfControlType=3,S.We.F0a(X),H(X.InstanceId,ca),S.SPa(),S.xnf(da,!1),v.EwaSettings.isChangeGateEnabled("OfficeVSO:6085876_TelemetryForActiveAddinSuccessOnExcelWacEnabled")&&m.ULS.sendTraceTag(524818146,220,50,"ShowTaskpane: succeed to call.")):(m.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),H(null,ca),
S.SPa())}))};a.prototype.getSettings=function(ba,T){var H=this.We.yaa(ba.solutionId);H?T(this.We.sZ(H).OsfPropertyBag):this.PQa=this.smd(ba,null,function(S){S?T(S.OsfPropertyBag):m.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(ba,T,H){function S(ca,ja,ea){return e(fa,X,D.b(ca,K),ja,ea,null)}function K(ca){var ja=ca.Result,ea=ja?ja.AgaveData:null;ea?(da.We.iFe(ea,function(){var qa=new c(function(){da.disposeHost(ea.InstanceId)});qa.initializeAndShow("",
null,null);da.SPa();return qa.containerDiv}),H(ea.InstanceId,0),da.SPa()):(m.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),H(null,ca.Errors?ca.Errors[0].ErrorCause:5001))}var da=this;m.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var fa=this.$.na.ta,X=a.lrb(ba,this.ownerAddinInfo);v.EwaSettings.sc()?this.PQa=C.a(this.$.userOperationManager,S,function(ca){return new r.a(500,0,ca,64)},this.ae):this.PQa=C.a(this.$.userOperationManager,S,function(ca){return new u.a(500,
0,ca)},this.ae)};a.prototype.createUILessSandbox=function(ba,T,H){var S=this;m.ULS.sendTraceTag(537170637,220,50,"UILess action called.");var K=T.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),da=!!K&&1===K.LifeTime;(T=this.We.dDh(da?this.ownerAddinInfo.solutionId:ba.solutionId,da?K:null))?(H(T,0),this.SPa()):this.PQa=this.smd(ba,K,function(fa,X){fa?(da?(fa.PrimaryMarketplace.SolutionId=S.ownerAddinInfo.solutionId,fa.SharedRuntime=K,fa.TaskpaneVisible=!1,fa.WebExtensionOsfControlType=3,S.We.F0a(fa)):
(fa.WebExtensionOsfControlType=4,S.We.iFe(fa,function(){a.Keb.ia(fa.InstanceId,new y.a);return a.Keb.oa(fa.InstanceId).q1a})),H(fa.InstanceId,X),S.SPa()):(m.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),H(null,X))})};a.prototype.smd=function(ba,T,H){function S(pa,Pa,Ha){return e(X,ca,D.b(pa,K),Pa,Ha,null)}function K(pa){var Pa=pa.Result;(fa=Pa?Pa.AgaveData:null)||H(null,pa.Errors?pa.Errors[0].ErrorCause:5001)}var da=this,fa=null,X=this.$.na.ta,ca=a.lrb(ba,this.ownerAddinInfo);
T&&(m.ULS.sendTraceTag(537170634,220,50,"Shared runtime agave is inserted."),ca.SharedRuntimeId=T.Resid);var ja=500,ea=0;void 0===ca.IsToBePersisted||null===ca.IsToBePersisted||ca.IsToBePersisted||(ja=538,S=function(pa,Pa,Ha){m.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",ca.CurrentStoreType,ca.StoreId,Telemetry.PrivacyRules.GetAssetId(ca.CurrentStoreType,ca.StoreId,ca.AssetId));pa=D.b(pa,K);var Xa=X.Na(9,null);Xa.sharedInfo=
ca;return z.i(X,"ShowAgaveTaskpane",Xa,pa,Pa,Ha,null,0)},ea=16);if(v.EwaSettings.sc()){ea|=64;var qa=C.a(this.$.userOperationManager,S,function(pa){return new r.a(ja,0,pa,ea)},this.ae)}else qa=C.a(this.$.userOperationManager,S,function(pa){return new u.a(ja,0,pa,ea)},this.ae);return J.TaskExtensions.ts(qa,function(){return fa?da.Ntd(X,fa.InstanceId,function(pa,Pa){if(pa){T||(fa.PrimaryMarketplace.MarketplaceType=ba.storeType);fa.OwnerAddinSolutionId=da.ownerAddinInfo.solutionId;fa.OwnerAddinAssetId=
da.ownerAddinInfo.assetId;fa.OwnerAddinStoreType=da.ownerAddinInfo.storeType;fa.OsfPropertyBag=[];for(Pa=0;Pa<pa.Settings.length;Pa++){var Ha=[];Ha[0]=pa.Settings[Pa].Name;Ha[1]=pa.Settings[Pa].Value;fa.OsfPropertyBag[Pa]=Ha}H(fa,0)}else H(null,Pa.Errors?Pa.Errors[0].ErrorCause:5001)}):Q.Task.Ta(!1)},n.a.none,3,la.a.current)};a.prototype.Ntd=function(ba,T,H){function S(da,fa,X){da=D.b(da,K);var ca=ba.Na(1);ca.controlId=T;return z.i(ba,"DdaLoadSettings",ca,da,fa,X,null,0)}function K(da){H(da.Result,
da)}return v.EwaSettings.sc()?C.a(this.$.userOperationManager,S,function(da){return new r.a(501,0,da,80)},this.ae):C.a(this.$.userOperationManager,S,function(da){return new u.a(501,0,da,16)},this.ae)};a.prototype.xnf=function(ba,T){var H;ba&&(null===(H=window.performance)||void 0===H?0:H.memory)&&m.ULS.sendTraceTag(537170630,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",T,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,
window.performance.memory.usedJSHeapSize)};a.showUILessDialog=function(ba){a.Keb.xb(ba)&&a.Keb.oa(ba).initializeAndShowWithTitle()};a.hideUILessDialog=function(ba){a.Keb.xb(ba)&&a.Keb.oa(ba).hide()};a.lrb=function(ba,T){var H={};H.SolutionId=ba.solutionId;H.Version=ba.version;H.StoreType=T.storeType;H.StoreId=ba.storeId;H.AssetId=ba.solutionId;H.AssetStoreId="omex";H.TargetType=1;H.Width=350;H.OwnerAddinSolutionId=T.solutionId;H.OwnerAddinStoreType=T.storeType;H.SharedRuntimeId=null;H.Preload=!1;
H.Id=ba.solutionId;H.AppVersion=ba.version;H.CurrentStoreType=T.storeType;H.OwnerAddinAssetId=T.assetId;return H};a.Keb=new V.a;Object(A.a)(a,"WACExcelAddinCommandsHost",l,[])},1280:function(A,F,b){function a(c,e,l,n){this._id=c;this.Xwg=e;this.Yhe=l;this.NUa=n}b.d(F,"a",function(){return a});A=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.Xwg};a.prototype.getStoreType=function(){return this.Yhe};Object(A.a)(a,"ExtensionIdentity",null,[487])},1281:function(A,
F,b){function a(c,e,l){this.Hae=l}b.d(F,"a",function(){return a});A=b(0);Object(A.a)(a,"HostProperties",null,[])},1282:function(A,F,b){function a(){this.si={};this.ir={}}b.d(F,"a",function(){return a});A=b(0);Object(A.a)(a,"ExtensionLaunchProperties",null,[])},1283:function(A,F,b){function a(){this.La=f.AFrameworkApplication.Gb}b.d(F,"a",function(){return a});A=b(0);var c=b(1280),e=b(1282),l=b(1095),n=b(1285),m=b(1281),f=b(5),x=b(592),y=b(30);a.prototype.qNa=function(t,B,z,u,C){this.Nri(t,B,z,u,C)};
a.prototype.Nri=function(t,B,z,u,C){var r=b(1284).ExtensionComponentInstance,J={};J[l.a.N8b]=t;J[l.a.EBe]=B;J[l.a.kHa]=z;J[l.a.Bkd]=u;J[l.a.Tya]=C;u=8;f.AFrameworkApplication.eni(t.getId())&&(u=B===n.a.action?this.La.Ce(y.a.YRe,2,J):this.La.Ce(y.a.Y3f,2,J));32===u?(u=x.a.create().toString(),C.si.InstanceToken&&(u=C.si.InstanceToken),t=new r(t,B,z,u),a.Fv[u]=t):t=new r(t,B,z,null);t.Hpj(J)};a.prototype.Mri=function(t){var B=t.ExtId,z=t.ComponentType,u=t.ComponentId,C=t.HostProps;t=t.OptionalProps;
B=new c.a(B.Id,B.StoreId,B.StoreType,B.AppVersion);C=new m.a(C.HostType,C.FormFactor,C.Locale);var r=new e.a;r.si=t.OptionalProperties;r.ir=t.DevProperties;a.instance.qNa(B,z,u,C,r)};a.prototype.getInstance=function(t){return a.Fv[t]};a.prototype.Laj=function(t){delete a.Fv[t]};Sk.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.YHc||(a.YHc=new a);return a.YHc}}});a.YHc=null;a.Fv={};Object(A.a)(a,"ExtensionLifeCycleManager",null,[486])},1284:function(A,F,b){function a(n,
m,f,x){this.NUa=this.rG=null;this._id=n;this.Wmg=f;this.Lqg=x;this.La=e.AFrameworkApplication.Gb?e.AFrameworkApplication.Gb:null}b.r(F);b.d(F,"ExtensionComponentInstance",function(){return a});A=b(0);var c=b(1283),e=b(5),l=b(30);a.prototype.$dd=function(){return this.Wmg};a.prototype.Hpj=function(n){this.rG=n};a.prototype.stop=function(){var n=this.La.Ce(l.a.CZg,2,this.rG);c.a.instance.Laj(this.Lqg);return 32===n};a.prototype.Itc=function(){this.La.Ce(l.a.kUf,2,this.rG)};Sk.Object.defineProperties(a.prototype,
{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.NUa}}});Object(A.a)(a,"ExtensionComponentInstance",null,[500])},1285:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);a.taskpane="Taskpane";a.action="Action";Object(A.a)(a,"ComponentTypeNames",null,[])},1286:function(A,F,b){(function(a){function c(U,Q,la){var ba=V.call(this)||this;ba.T$e=f.a.getTypeName();ba.ae=null;ba.wU=null;ba.sxb=null;ba.imageWidth=0;ba.imageHeight=0;ba.tableData=null;ba.errorMessage=null;
ba.xLa=null;ba.oTc=!1;ba.wGe=function(T){if(T){var H={};if(function(){var ca=v.d(ba.ich(T.data));H=ca.Ju;return ca}().returnValue){var S=Object(m.a)(Object,H);if("."===S.DataFromPictureWildcard)if(S.SessionId!==ba.xLa)l.ULS.sendTraceTag(537163345,0,10,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");else switch(l.ULS.sendTraceTag(537163344,0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane"),
S.CmdType){case "ACK":ba.oTc=!0;ba.poj();0<ba.errorMessage.length?ba.WXf():0<ba.tableData.length&&ba.mYf();break;case "insert_html":var K=ba.$.na.ta,da={},fa=J.g(ba.$).ha.va.Sd.clone();da.PasteId=n.a.create().toString();da.DestinationRanges=t.s(t.v(fa,ba.$));da.SourceHtml=S.Parameters;da.CopyOperationId=null;var X=K.Na(1,K.Zb());X.pasteHtmlParameters=da;B.a(ba.$.userOperationManager,function(ca,ja,ea){return u.i(K,"pasteHtmlContent",X,ca,ja,ea,null,64)},function(ca){return new z.a(204,0,ca,1)},null)}}}};
ba.A9h=function(T,H){if(T=H.SP)if(!H.parentPath||1>=H.parentPath.length||H.parentPath[1]!==ba.xLa)l.ULS.sendTraceTag(537163335,0,10,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{H=T.errorCode;switch(H){case null:case -1:ba.errorMessage=r.a.instance.fa(2203);break;case 1:ba.errorMessage=r.a.instance.fa(2204);break;case 2:ba.errorMessage=r.a.instance.fa(2205)}0<ba.errorMessage.length&&l.ULS.sendTraceTag(537163334,
0,10,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - ErrorCode:{0}.",H?H.toString():"null");ba.tableData=T.html;ba.oTc&&(0<ba.errorMessage.length?ba.WXf():0<ba.tableData.length&&ba.mYf())}else l.ULS.sendTraceTag(537163336,0,10,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - Received annotation is null.")};ba.$=U;ba.augmentationLoopManager=Q;ba.uploaderCreator=la;ba.initialize();return ba}b.d(F,"a",function(){return c});var e=b(0),l=b(13),n=b(178),m=b(84),
f=b(1291),x=b(36),y=b(232),t=b(43),B=b(369),z=b(164),u=b(81),C=b(92),r=b(14),J=b(20),v=b(40),D=b(1292),V=x.a;vm(c,V);c.prototype.dispose=function(){window.removeEventListener("message",this.wGe,!1);V.prototype.dispose.call(this)};c.prototype.PTi=function(U,Q){var la=this;l.ULS.sendTraceTag(526399129,0,50,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Start function.");var ba=new Image;ba.onload=function(){var T=document.createElement("canvas");T.width=ba.width;T.height=ba.height;var H=
T.getContext("2d");try{H.drawImage(ba,0,0,ba.width,ba.height)}catch(da){l.ULS.sendTraceTag(526399128,0,10,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Can't draw to canvas. ex.Message: {0}",da.message);return}try{var S=T.toDataURL("image/jpeg")}catch(da){l.ULS.sendTraceTag(526399127,0,10,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Can't render to jpeg. ex.Message: {0}",da.message);return}T=S.split(",");if(2>T.length)l.ULS.sendTraceTag(526399126,0,10,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Can't render to jpeg.");
else{T=T[1];try{var K=window.self.atob(T)}catch(da){l.ULS.sendTraceTag(526399125,0,10,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Can't convert image to byte string. ex.Message: {0}",da.message);return}28E5<K.length?(l.ULS.sendTraceTag(526399124,0,15,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - Image exceeds max size limit."),Q.eBj()):(la.rkj(la.ae,la.wU,T,ba.width,ba.height),URL.revokeObjectURL(ba.src),ba=null,l.ULS.sendTraceTag(526399123,0,50,"DataFromPicturePaneCommandManager.onSuccessfulFileLoad - End function."))}};
ba.src=U};c.prototype.Z0i=function(U,Q,la,ba){this.ae=U;this.wU=ba;this.uploaderCreator.bbi(this.$,Q,la,ba,this)};c.prototype.rkj=function(U,Q,la,ba,T){this.xLa=n.a.create().toString();this.sxb=la;this.imageWidth=ba;this.imageHeight=T;this.errorMessage=this.tableData="";this.oTc=!1;this.xWi(U,Q);this.iVj()};c.prototype.iVj=function(){if(this.sxb.length){var U=window.self.atob(this.sxb);for(var Q=new Uint8Array(U.length),la=0;la<U.length;la++)Q[la]=U.charCodeAt(la);this.augmentationLoopManager.hVj(Q,
this.xLa,this.imageWidth,this.imageHeight)}else l.ULS.sendTraceTag(537163343,0,10,"DataFromPicturePaneCommandManager:UploadImageToAugmentationLoop - imageDataBase64 is empty")};c.prototype.xWi=function(U,Q){Q.SessionID=this.xLa;Q.DataFromPictureAssetId="FA000000050";Q.LoadDataFromPictureTaskpane=!0;U=new C.a(-859308420,U.method,U.mode,U.af,U.tabName);this.$.Ka.Xb(U,Q)};c.prototype.o8c=function(U){try{var Q=a.from(U,"utf16le").toString("base64");return D.a.wHa(this.xLa,Q)}catch(la){return l.ULS.sendTraceTag(524888215,
0,10,"DataFromPicturePaneCommandManager.encodeAndEncrypt - Buffer can't encode message.",la.message),""}};c.prototype.ich=function(U){try{var Q=D.a.wHa(this.xLa,U);return a.from(Q,"base64").toString("utf16le")}catch(la){return l.ULS.sendTraceTag(524888214,0,50,"DataFromPicturePaneCommandManager.decryptAndDecode - Buffer can't decode message.",la.message),""}};c.prototype.poj=function(){if(this.sxb.length){var U=y.a(this.$).yaa("FA000000050"),Q={};Q=(Q.DataFromPictureWildcard=".",Q);Q.imageData=this.o8c(this.sxb);
OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(U,"onCustomMessage",Q,function(la){la&&l.ULS.sendTraceTag(537163341,0,10,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else l.ULS.sendTraceTag(537163342,0,10,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};c.prototype.mYf=function(){if(this.tableData.length){var U=y.a(this.$).yaa("FA000000050"),Q={};Q=(Q.DataFromPictureWildcard=
".",Q);Q.tableHtml=this.o8c(this.tableData);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(U,"onCustomMessage",Q,function(la){la&&l.ULS.sendTraceTag(537163339,0,10,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else l.ULS.sendTraceTag(537163340,0,10,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};c.prototype.WXf=function(){if(this.errorMessage.length){var U=
y.a(this.$).yaa("FA000000050"),Q={};Q=(Q.DataFromPictureWildcard=".",Q);Q.errorMessage=this.o8c(this.errorMessage);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(U,"onCustomMessage",Q,function(la){la&&l.ULS.sendTraceTag(537163337,0,10,"DataFromPicturePaneCommandManager:sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else l.ULS.sendTraceTag(537163338,0,10,"DataFromPicturePaneCommandManager:sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};
c.prototype.initialize=function(){window.addEventListener("message",this.wGe,!1);this.augmentationLoopManager.activateAnnotation(this.T$e);this.augmentationLoopManager.OT(this.T$e,this.A9h)};Object(e.a)(c,"DataFromPicturePaneCommandManager",x.a,[455])}).call(this,b(1287).jig)},1287:function(A,F,b){(function(a){function c(){try{var T=new Uint8Array(1);T.__proto__={__proto__:Uint8Array.prototype,Xbd:function(){return 42}};return 42===T.Xbd()&&"function"===typeof T.subarray&&0===T.subarray(1,1).byteLength}catch(H){return!1}}
function e(T,H){if((l.lP?2147483647:1073741823)<H)throw new RangeError("Invalid typed array length");l.lP?(T=new Uint8Array(H),T.__proto__=l.prototype):(null===T&&(T=new l(H)),T.length=H);return T}function l(T,H,S){if(!(l.lP||this instanceof l))return new l(T,H,S);if("number"===typeof T){if("string"===typeof H)throw Error("If encoding is specified then the first argument must be a string");return f(this,T)}return n(this,T,H,S)}function n(T,H,S,K){if("number"===typeof H)throw new TypeError('"value" argument must not be a number');
if("undefined"!==typeof ArrayBuffer&&H instanceof ArrayBuffer){H.byteLength;if(0>S||H.byteLength<S)throw new RangeError("'offset' is out of bounds");if(H.byteLength<S+(K||0))throw new RangeError("'length' is out of bounds");H=void 0===S&&void 0===K?new Uint8Array(H):void 0===K?new Uint8Array(H,S):new Uint8Array(H,S,K);l.lP?(T=H,T.__proto__=l.prototype):T=x(T,H);H=T}else if("string"===typeof H){K=T;T=S;if("string"!==typeof T||""===T)T="utf8";if(!l.Zdf(T))throw new TypeError('"encoding" must be a valid string encoding');
S=B(H,T)|0;K=e(K,S);H=K.write(H,T);H!==S&&(K=K.slice(0,H));H=K}else H=y(T,H);return H}function m(T){if("number"!==typeof T)throw new TypeError('"size" argument must be a number');if(0>T)throw new RangeError('"size" argument must not be negative');}function f(T,H){m(H);T=e(T,0>H?0:t(H)|0);if(!l.lP)for(var S=0;S<H;++S)T[S]=0;return T}function x(T,H){var S=0>H.length?0:t(H.length)|0;T=e(T,S);for(var K=0;K<S;K+=1)T[K]=H[K]&255;return T}function y(T,H){if(l.isBuffer(H)){var S=t(H.length)|0;T=e(T,S);if(0===
T.length)return T;H.copy(T,0,0,S);return T}if(H){if("undefined"!==typeof ArrayBuffer&&H.buffer instanceof ArrayBuffer||"length"in H)return(S="number"!==typeof H.length)||(S=H.length,S=S!==S),S?e(T,0):x(T,H);if("Buffer"===H.type&&Q(H.data))return x(T,H.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.");}function t(T){if(T>=(l.lP?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(l.lP?2147483647:
1073741823).toString(16)+" bytes");return T|0}function B(T,H){if(l.isBuffer(T))return T.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(T)||T instanceof ArrayBuffer))return T.byteLength;"string"!==typeof T&&(T=""+T);var S=T.length;if(0===S)return 0;for(var K=!1;;)switch(H){case "ascii":case "latin1":case "binary":return S;case "utf8":case "utf-8":case void 0:return J(T).length;case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return 2*
S;case "hex":return S>>>1;case "base64":return D(T).length;default:if(K)return J(T).length;H=(""+H).toLowerCase();K=!0}}function z(T,H,S){var K=!1;if(void 0===H||0>H)H=0;if(H>this.length)return"";if(void 0===S||S>this.length)S=this.length;if(0>=S)return"";S>>>=0;H>>>=0;if(S<=H)return"";for(T||(T="utf8");;)switch(T){case "hex":T=H;H=S;S=this.length;if(!T||0>T)T=0;if(!H||0>H||H>S)H=S;K="";for(S=T;S<H;++S)T=K,K=this[S],K=16>K?"0"+K.toString(16):K.toString(16),K=T+K;return K;case "utf8":case "utf-8":return r(this,
H,S);case "ascii":T="";for(S=Math.min(this.length,S);H<S;++H)T+=String.fromCharCode(this[H]&127);return T;case "latin1":case "binary":T="";for(S=Math.min(this.length,S);H<S;++H)T+=String.fromCharCode(this[H]);return T;case "base64":return 0===H&&S===this.length?U.hWe(this):U.hWe(this.slice(H,S));case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":H=this.slice(H,S);S="";for(T=0;T<H.length;T+=2)S+=String.fromCharCode(H[T]+256*H[T+1]);return S;default:if(K)throw new TypeError("Unknown encoding: "+
T);T=(T+"").toLowerCase();K=!0}}function u(T,H,S,K,da){if(0===T.length)return-1;"string"===typeof S?(K=S,S=0):2147483647<S?S=2147483647:-2147483648>S&&(S=-2147483648);S=+S;isNaN(S)&&(S=da?0:T.length-1);0>S&&(S=T.length+S);if(S>=T.length){if(da)return-1;S=T.length-1}else if(0>S)if(da)S=0;else return-1;"string"===typeof H&&(H=l.from(H,K));if(l.isBuffer(H))return 0===H.length?-1:C(T,H,S,K,da);if("number"===typeof H)return H&=255,l.lP&&"function"===typeof Uint8Array.prototype.indexOf?da?Uint8Array.prototype.indexOf.call(T,
H,S):Uint8Array.prototype.lastIndexOf.call(T,H,S):C(T,[H],S,K,da);throw new TypeError("val must be string, number or Buffer");}function C(T,H,S,K,da){function fa(ea,qa){return 1===X?ea[qa]:ea.Y6i(qa*X)}var X=1,ca=T.length,ja=H.length;if(void 0!==K&&(K=String(K).toLowerCase(),"ucs2"===K||"ucs-2"===K||"utf16le"===K||"utf-16le"===K)){if(2>T.length||2>H.length)return-1;X=2;ca/=2;ja/=2;S/=2}if(da)for(K=-1;S<ca;S++)if(fa(T,S)===fa(H,-1===K?0:S-K)){if(-1===K&&(K=S),S-K+1===ja)return K*X}else-1!==K&&(S-=
S-K),K=-1;else for(S+ja>ca&&(S=ca-ja);0<=S;S--){ca=!0;for(K=0;K<ja;K++)if(fa(T,S+K)!==fa(H,K)){ca=!1;break}if(ca)return S}return-1}function r(T,H,S){S=Math.min(T.length,S);for(var K=[];H<S;){var da=T[H],fa=null,X=239<da?4:223<da?3:191<da?2:1;if(H+X<=S)switch(X){case 1:128>da&&(fa=da);break;case 2:var ca=T[H+1];128===(ca&192)&&(da=(da&31)<<6|ca&63,127<da&&(fa=da));break;case 3:ca=T[H+1];var ja=T[H+2];128===(ca&192)&&128===(ja&192)&&(da=(da&15)<<12|(ca&63)<<6|ja&63,2047<da&&(55296>da||57343<da)&&(fa=
da));break;case 4:ca=T[H+1];ja=T[H+2];var ea=T[H+3];128===(ca&192)&&128===(ja&192)&&128===(ea&192)&&(da=(da&15)<<18|(ca&63)<<12|(ja&63)<<6|ea&63,65535<da&&1114112>da&&(fa=da))}null===fa?(fa=65533,X=1):65535<fa&&(fa-=65536,K.push(fa>>>10&1023|55296),fa=56320|fa&1023);K.push(fa);H+=X}T=K.length;if(T<=la)K=String.fromCharCode.apply(String,K);else{S="";for(H=0;H<T;)S+=String.fromCharCode.apply(String,K.slice(H,H+=la));K=S}return K}function J(T,H){H=H||Infinity;for(var S,K=T.length,da=null,fa=[],X=0;X<
K;++X){S=T.charCodeAt(X);if(55295<S&&57344>S){if(!da){if(56319<S){-1<(H-=3)&&fa.push(239,191,189);continue}else if(X+1===K){-1<(H-=3)&&fa.push(239,191,189);continue}da=S;continue}if(56320>S){-1<(H-=3)&&fa.push(239,191,189);da=S;continue}S=(da-55296<<10|S-56320)+65536}else da&&-1<(H-=3)&&fa.push(239,191,189);da=null;if(128>S){if(0>--H)break;fa.push(S)}else if(2048>S){if(0>(H-=2))break;fa.push(S>>6|192,S&63|128)}else if(65536>S){if(0>(H-=3))break;fa.push(S>>12|224,S>>6&63|128,S&63|128)}else if(1114112>
S){if(0>(H-=4))break;fa.push(S>>18|240,S>>12&63|128,S>>6&63|128,S&63|128)}else throw Error("Invalid code point");}return fa}function v(T){for(var H=[],S=0;S<T.length;++S)H.push(T.charCodeAt(S)&255);return H}function D(T){var H=U,S=H.BLj;T=(T.trim?T.trim():T.replace(/^\s+|\s+$/g,"")).replace(ba,"");if(2>T.length)T="";else for(;0!==T.length%4;)T+="=";return S.call(H,T)}function V(T,H,S,K){for(var da=0;da<K&&!(da+S>=H.length||da>=T.length);++da)H[da+S]=T[da];return da}var U=b(1288);b(1289);var Q=b(1290);
F.jig=l;F.VZj=function(T){+T!=T&&(T=0);return l.Qpe(+T)};F.KZj=50;l.lP=void 0!==a.lP?a.lP:c();F.j0j=l.lP?2147483647:1073741823;l.from=function(T,H,S){return n(null,T,H,S)};l.lP&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0}));l.Qpe=function(T){m(T);return e(null,T)};l.cJg=function(T){return f(null,T)};l.isBuffer=function(T){return!(null==T||!T.Vqg)};
l.compare=function(T,H){if(!l.isBuffer(T)||!l.isBuffer(H))throw new TypeError("Arguments must be Buffers");if(T===H)return 0;for(var S=T.length,K=H.length,da=0,fa=Math.min(S,K);da<fa;++da)if(T[da]!==H[da]){S=T[da];K=H[da];break}return S<K?-1:K<S?1:0};l.Zdf=function(T){switch(String(T).toLowerCase()){case "hex":case "utf8":case "utf-8":case "ascii":case "latin1":case "binary":case "base64":case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":return!0;default:return!1}};l.concat=function(T,H){if(!Q(T))throw new TypeError('"list" argument must be an Array of Buffers');
if(0===T.length)return l.Qpe(0);var S;if(void 0===H)for(S=H=0;S<T.length;++S)H+=T[S].length;H=l.cJg(H);var K=0;for(S=0;S<T.length;++S){var da=T[S];if(!l.isBuffer(da))throw new TypeError('"list" argument must be an Array of Buffers');da.copy(H,K);K+=da.length}return H};l.byteLength=B;l.prototype.Vqg=!0;l.prototype.toString=function(){var T=this.length|0;return 0===T?"":0===arguments.length?r(this,0,T):z.apply(this,arguments)};l.prototype.equals=function(T){if(!l.isBuffer(T))throw new TypeError("Argument must be a Buffer");
return this===T?!0:0===l.compare(this,T)};l.prototype.compare=function(T,H,S,K,da){if(!l.isBuffer(T))throw new TypeError("Argument must be a Buffer");void 0===H&&(H=0);void 0===S&&(S=T?T.length:0);void 0===K&&(K=0);void 0===da&&(da=this.length);if(0>H||S>T.length||0>K||da>this.length)throw new RangeError("out of range index");if(K>=da&&H>=S)return 0;if(K>=da)return-1;if(H>=S)return 1;H>>>=0;S>>>=0;K>>>=0;da>>>=0;if(this===T)return 0;var fa=da-K,X=S-H,ca=Math.min(fa,X);K=this.slice(K,da);T=T.slice(H,
S);for(H=0;H<ca;++H)if(K[H]!==T[H]){fa=K[H];X=T[H];break}return fa<X?-1:X<fa?1:0};l.prototype.includes=function(T,H,S){return-1!==this.indexOf(T,H,S)};l.prototype.indexOf=function(T,H,S){return u(this,T,H,S,!0)};l.prototype.lastIndexOf=function(T,H,S){return u(this,T,H,S,!1)};l.prototype.write=function(T,H,S,K){if(void 0===H)K="utf8",S=this.length,H=0;else if(void 0===S&&"string"===typeof H)K=H,S=this.length,H=0;else if(isFinite(H))H|=0,isFinite(S)?(S|=0,void 0===K&&(K="utf8")):(K=S,S=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");
var da=this.length-H;if(void 0===S||S>da)S=da;if(0<T.length&&(0>S||0>H)||H>this.length)throw new RangeError("Attempt to write outside buffer bounds");K||(K="utf8");for(da=!1;;)switch(K){case "hex":H=Number(H)||0;K=this.length-H;S?(S=Number(S),S>K&&(S=K)):S=K;K=T.length;if(0!==K%2)throw new TypeError("Invalid hex string");S>K/2&&(S=K/2);for(K=0;K<S;++K){da=parseInt(T.substr(2*K,2),16);if(isNaN(da))break;this[H+K]=da}return K;case "utf8":case "utf-8":return V(J(T,this.length-H),this,H,S);case "ascii":return V(v(T),
this,H,S);case "latin1":case "binary":return V(v(T),this,H,S);case "base64":return V(D(T),this,H,S);case "ucs2":case "ucs-2":case "utf16le":case "utf-16le":K=T;da=this.length-H;for(var fa=[],X=0;X<K.length&&!(0>(da-=2));++X){var ca=K.charCodeAt(X);T=ca>>8;ca%=256;fa.push(ca);fa.push(T)}return V(fa,this,H,S);default:if(da)throw new TypeError("Unknown encoding: "+K);K=(""+K).toLowerCase();da=!0}};l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this.ZZj||this,0)}};
var la=4096;l.prototype.slice=function(T,H){var S=this.length;T=~~T;H=void 0===H?S:~~H;0>T?(T+=S,0>T&&(T=0)):T>S&&(T=S);0>H?(H+=S,0>H&&(H=0)):H>S&&(H=S);H<T&&(H=T);if(l.lP)H=this.subarray(T,H),H.__proto__=l.prototype;else{S=H-T;H=new l(S,void 0);for(var K=0;K<S;++K)H[K]=this[K+T]}return H};l.prototype.Y6i=function(T){if(0!==T%1||0>T)throw new RangeError("offset is not uint");if(T+2>this.length)throw new RangeError("Trying to access beyond buffer length");return this[T]<<8|this[T+1]};l.prototype.copy=
function(T,H,S,K){S||(S=0);K||0===K||(K=this.length);H>=T.length&&(H=T.length);H||(H=0);0<K&&K<S&&(K=S);if(K===S||0===T.length||0===this.length)return 0;if(0>H)throw new RangeError("targetStart out of bounds");if(0>S||S>=this.length)throw new RangeError("sourceStart out of bounds");if(0>K)throw new RangeError("sourceEnd out of bounds");K>this.length&&(K=this.length);T.length-H<K-S&&(K=T.length-H+S);var da=K-S;if(this===T&&S<H&&H<K)for(K=da-1;0<=K;--K)T[K+H]=this[K+S];else if(1E3>da||!l.lP)for(K=0;K<
da;++K)T[K+H]=this[K+S];else Uint8Array.prototype.set.call(T,this.subarray(S,S+da),H);return da};l.prototype.fill=function(T,H,S,K){if("string"===typeof T){"string"===typeof H?(K=H,H=0,S=this.length):"string"===typeof S&&(K=S,S=this.length);if(1===T.length){var da=T.charCodeAt(0);256>da&&(T=da)}if(void 0!==K&&"string"!==typeof K)throw new TypeError("encoding must be a string");if("string"===typeof K&&!l.Zdf(K))throw new TypeError("Unknown encoding: "+K);}else"number"===typeof T&&(T&=255);if(0>H||
this.length<H||this.length<S)throw new RangeError("Out of range index");if(S<=H)return this;H>>>=0;S=void 0===S?this.length:S>>>0;T||(T=0);if("number"===typeof T)for(K=H;K<S;++K)this[K]=T;else for(T=l.isBuffer(T)?T:J((new l(T,K)).toString()),da=T.length,K=0;K<S-H;++K)this[K+H]=T[K%da];return this};var ba=/[^+\/0-9A-Za-z-_]/g}).call(this,b(692))},1288:function(A,F){function b(l){var n=l.length;if(0<n%4)throw Error("Invalid string. Length must be a multiple of 4");l=l.indexOf("=");-1===l&&(l=n);return[l,
l===n?0:4-l%4]}F.byteLength=function(l){l=b(l);var n=l[1];return 3*(l[0]+n)/4-n};F.BLj=function(l){var n=b(l);var m=n[0];n=n[1];var f=new e(3*(m+n)/4-n),x=0,y=0<n?m-4:m,t;for(t=0;t<y;t+=4)m=c[l.charCodeAt(t)]<<18|c[l.charCodeAt(t+1)]<<12|c[l.charCodeAt(t+2)]<<6|c[l.charCodeAt(t+3)],f[x++]=m>>16&255,f[x++]=m>>8&255,f[x++]=m&255;2===n&&(m=c[l.charCodeAt(t)]<<2|c[l.charCodeAt(t+1)]>>4,f[x++]=m&255);1===n&&(m=c[l.charCodeAt(t)]<<10|c[l.charCodeAt(t+1)]<<4|c[l.charCodeAt(t+2)]>>2,f[x++]=m>>8&255,f[x++]=
m&255);return f};F.hWe=function(l){for(var n=l.length,m=n%3,f=[],x=0,y=n-m;x<y;x+=16383){for(var t=f,B=t.push,z,u=l,C=x+16383>y?y:x+16383,r=[],J=x;J<C;J+=3)z=(u[J]<<16&16711680)+(u[J+1]<<8&65280)+(u[J+2]&255),r.push(a[z>>18&63]+a[z>>12&63]+a[z>>6&63]+a[z&63]);B.call(t,r.join(""))}1===m?(l=l[n-1],f.push(a[l>>2]+a[l<<4&63]+"==")):2===m&&(l=(l[n-2]<<8)+l[n-1],f.push(a[l>>10]+a[l>>4&63]+a[l<<2&63]+"="));return f.join("")};var a=[],c=[],e="undefined"!==typeof Uint8Array?Uint8Array:Array;for(A=0;64>A;++A)a[A]=
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[A],c["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(A)]=A;c[45]=62;c[95]=63},1289:function(A,F){F.read=function(b,a,c,e,l){var n=8*l-e-1;var m=(1<<n)-1,f=m>>1,x=-7;l=c?l-1:0;var y=c?-1:1,t=b[a+l];l+=y;c=t&(1<<-x)-1;t>>=-x;for(x+=n;0<x;c=256*c+b[a+l],l+=y,x-=8);n=c&(1<<-x)-1;c>>=-x;for(x+=e;0<x;n=256*n+b[a+l],l+=y,x-=8);if(0===c)c=1-f;else{if(c===m)return n?NaN:Infinity*(t?-1:1);n+=Math.pow(2,e);c-=f}return(t?
-1:1)*n*Math.pow(2,c-e)};F.write=function(b,a,c,e,l,n){var m,f=8*n-l-1,x=(1<<f)-1,y=x>>1,t=23===l?Math.pow(2,-24)-Math.pow(2,-77):0;n=e?0:n-1;var B=e?1:-1,z=0>a||0===a&&0>1/a?1:0;a=Math.abs(a);isNaN(a)||Infinity===a?(a=isNaN(a)?1:0,e=x):(e=Math.floor(Math.log(a)/Math.LN2),1>a*(m=Math.pow(2,-e))&&(e--,m*=2),a=1<=e+y?a+t/m:a+t*Math.pow(2,1-y),2<=a*m&&(e++,m/=2),e+y>=x?(a=0,e=x):1<=e+y?(a=(a*m-1)*Math.pow(2,l),e+=y):(a=a*Math.pow(2,y-1)*Math.pow(2,l),e=0));for(;8<=l;b[c+n]=a&255,n+=B,a/=256,l-=8);e=
e<<l|a;for(f+=l;0<f;b[c+n]=e&255,n+=B,e/=256,f-=8);b[c+n-B]|=128*z}},1290:function(A){var F={}.toString;A.exports=Array.isArray||function(b){return"[object Array]"==F.call(b)}},1291:function(A,F,b){function a(){var l=e.call(this)||this;l.errorCode=null;l.errorDescription=null;l.html=null;l.H_=Object.assign(new c.a,{T_:a.getTypeName(),B_:a.re()});return l}b.d(F,"a",function(){return a});A=b(0);F=b(847);var c=b(821),e=F.a;vm(a,e);a.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};
a.re=function(){return["AugLoop_Core_Annotation"]};Object(A.a)(a,"DetectedHtmlTableAnnotation",F.a,[])},1292:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);a.wHa=function(c,e){if(!(c&&e&&c.length&&e.length)||256<c.length)return"";var l=Array(256),n=Array(256),m,f=0,x=0,y="";for(m=0;256>m;m++)l[m]=m;for(m=0;256>m;m++){var t=c.charCodeAt(m%c.length);if(256<=t)return"";f=(f+l[m]+t)%256;t=l[m];l[m]=l[f];l[f]=t}for(m=0;256>m;m++)n[m]=l[256-m-1];for(c=f=m=0;c<e.length;c++){m=(m+1)%
256;f=(f+l[m])%256;t=l[m];l[m]=l[f];l[f]=t;t=e.charCodeAt(c);if(256<=t)return"";var B=t^l[(l[m]+l[f])%256];x=(x+n[m])%256;t=n[m];n[m]=n[x];n[x]=t;y+=String.fromCharCode(B^l[(n[m]+n[x])%256])}return y};Object(A.a)(a,"RC4A",null,[])},1294:function(A,F,b){function a(l,n,m,f){this.LRc=this.skb=this.NRc=null;this.mEa=l;e.AFrameworkApplication.ga.ra("AddInCommandsMissingTabIsEnabled")?(this.NRc=m.QTh(),this.skb=m.i$a,this.LRc=m.BBi):(this.NRc=m.jzc,this.LRc=this.skb=null);this.aFc=this.Is=n;this.ewg=f}
b.d(F,"a",function(){return a});A=b(0);var c=b(13),e=b(5);a.prototype.hva=function(l){l=this.kOa+this.solutionId+l;return this.TQd?(l in a.sZb||(a.sZb[l]="AddinControl"+a.SHg++),a.sZb[l]):l};a.prototype.nGe=function(l){if(this.TQd){var n=a.sZb,m;for(m in n){var f=m;if(l===n[m])return f.substr(this.kOa.length+this.solutionId.length)}}return l};a.prototype.shd=function(l){l=this.kOa+this.solutionId+l;return this.TQd?(l in a.PVc||(a.PVc[l]="AddinTab"+a.$Hg++),a.PVc[l]):l};a.prototype.ZUh=function(l){return l.toLowerCase()in
this.jzc?(c.ULS.sendTraceTag(17306646,220,50,"Tab id: {0}.",l.toLowerCase()),this.kOa+this.jzc[l.toLowerCase()]):null};a.prototype.lVh=function(){if(!this.i$a)return null;for(var l=[],n=yl(this.i$a),m=n.next();!m.done;m=n.next())l.push(this.kOa+m.value);return l};a.prototype.NSh=function(l){l=this.UXe(l);return null===l?null:l[1]};a.prototype.LSh=function(l){l=this.UXe(l);return null===l?null:l[2]};a.prototype.UXe=function(l){return this.MUd&&l.toLowerCase()in this.MUd?(c.ULS.sendTraceTag(21017039,
220,50,"Get attributes for Tab id: {0}.",l.toLowerCase()),this.MUd[l.toLowerCase()]):null};Sk.Object.defineProperties(a.prototype,{kOa:{configurable:!0,enumerable:!0,get:function(){return this.mEa}},jzc:{configurable:!0,enumerable:!0,get:function(){return this.NRc}},solutionId:{configurable:!0,enumerable:!0,get:function(){return this.Is}},assetId:{configurable:!0,enumerable:!0,get:function(){return this.aFc}},i$a:{configurable:!0,enumerable:!0,get:function(){return this.skb}},MUd:{configurable:!0,
enumerable:!0,get:function(){return this.LRc}},TQd:{configurable:!0,enumerable:!0,get:function(){return this.ewg}}});a.sZb={};a.PVc={};a.$Hg=0;a.SHg=0;Object(A.a)(a,"DefaultRibbonNamingProvider",null,[471])},1342:function(A,F,b){function a(z){var u=this;this.HA=null;this.S$f={};this.U$f={};this.kbd={};this.iyd={};this.fjd=function(C,r){C=u.$.Vb.Hc("Task","DdaEventDispatch.HandleServerEvent");r=r.sYf;for(var J=0;J<r.length;J++)switch(r[J].EventType){case 2:var v=r[J],D={};D.Name=v.Name;D.BindingType=
v.BindingType;D.ColCount=v.ColCount;D.RowCount=v.RowCount;u.Ova(v.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,D,null);break;case 4:u.Ova(r[J].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(v=r[J],v.InstanceId){D=Array(v.Entries.length);for(var V=0;V<v.Entries.length;V++)D[V]=a.Lbc(v.Entries[V],v.IsRemoteOverride);0<v.Entries.length&&1===v.Entries[0].Category?u.t2i(v.InstanceId,D):v.InstanceId&&u.Ova(v.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,D)}else{u.kbd={};u.iyd={};for(D=0;D<v.Entries.length;D++)u.ZIe(v.Entries[D],v.IsRemoteOverride);c.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",u.kbd,u.iyd,u.S$f,u.U$f)}}C.stop()};this.YIb=function(C,r){u.Ova(C,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,r)};this.$=z;this.nvc=this.fjd}b.r(F);A=b(0);var c=b(13),e=b(84),l;(function(z){z[z.none=0]="none";z[z.testEvent=1]=
"testEvent";z[z.test1Event=2]="test1Event";z[z.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";z[z.worksheetActivatedEvent=11]="worksheetActivatedEvent";z[z.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";z[z.worksheetAddedEvent=13]="worksheetAddedEvent";z[z.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";z[z.worksheetDeletedEvent=15]="worksheetDeletedEvent";z[z.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";z[z.worksheetFilteredEvent=17]="worksheetFilteredEvent";
z[z.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";z[z.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";z[z.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";z[z.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";z[z.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";z[z.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";z[z.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";z[z.worksheetNameChangedEvent=25]=
"worksheetNameChangedEvent";z[z.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";z[z.worksheetMovedEvent=27]="worksheetMovedEvent";z[z.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";z[z.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";z[z.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";z[z.chartAddedEvent=50]="chartAddedEvent";z[z.chartActivatedEvent=51]="chartActivatedEvent";z[z.chartDeactivatedEvent=
52]="chartDeactivatedEvent";z[z.chartDeletedEvent=53]="chartDeletedEvent";z[z.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";z[z.tableDataChangedEvent=101]="tableDataChangedEvent";z[z.tableAddedEvent=102]="tableAddedEvent";z[z.tableDeletedEvent=103]="tableDeletedEvent";z[z.tableFilteredEvent=104]="tableFilteredEvent";z[z.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";z[z.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";z[z.customFunctionExecutionEndEvent=
201]="customFunctionExecutionEndEvent";z[z.commentAddedEvent=250]="commentAddedEvent";z[z.commentDeletedEvent=251]="commentDeletedEvent";z[z.commentChangedEvent=252]="commentChangedEvent";z[z.invocationMessage=1E3]="invocationMessage";z[z.cancellationMessage=1001]="cancellationMessage";z[z.metadataMessage=1002]="metadataMessage";z[z.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";z[z.visualChangeEvent=2001]="visualChangeEvent";z[z.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";
z[z.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";z[z.shapeActivatedEvent=2101]="shapeActivatedEvent";z[z.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";z[z.shapeAddedEvent=2103]="shapeAddedEvent";z[z.shapeDeletedEvent=2104]="shapeDeletedEvent";z[z.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";z[z.wacOperationEvent=2201]="wacOperationEvent";z[z.recordingStateChangedEvent=2202]="recordingStateChangedEvent";z[z.workbookActivatedEvent=2203]="workbookActivatedEvent";
z[z.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";z[z.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";z[z.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";z[z.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";z[z.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";z[z.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";
z[z.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";z[z.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";z[z.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";z[z.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";z[z.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";z[z.pivotTableAddedEvent=2900]="pivotTableAddedEvent";z[z.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";
z[z.namedItemAddedEvent=3E3]="namedItemAddedEvent";z[z.namedItemDeletedEvent=3001]="namedItemDeletedEvent";z[z.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";z[z.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";z[z.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(l||(l={}));Object(A.b)("MessageType",l);var n=b(894),m=b(232),f=b(862),x=b(54),y=b(35),t=b(147),B=b(1);b.d(F,"DdaEventDispatch",function(){return a});
a.prototype.XYb=function(z){z&&(this.Lia(),Array.add(this.HA,z))};a.prototype.Hsc=function(z){this.HA&&(Array.remove(this.HA,z),this.HA.length||(this.$.wantServerEvents=!1,this.$.bej(this.nvc),this.HA=null))};a.prototype.t2i=function(z,u){var C=this,r=Object(e.a)(f.DdaFacade,m.a(this.$));y.TaskExtensions.Ba(r.iVh(z),function(J){if(t.b(J)){var v=J.result;J=r.cn(v);if(v)if(J.Fpd)C.Ova(v,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u);else if(J.o5c)for(v=0;v<u.length;v++)Array.add(J.o5c,u[v]);
else J.o5c=u}else J.kg?c.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):J.Ih&&c.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ma,0)};a.prototype.P2i=function(z,u){var C=Object(e.a)(f.DdaFacade,m.a(this.$)),r=C.DJh(z);r?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(r,u,this.YIb):C.l4g(z,u)};a.prototype.ZIe=function(z,
u){var C=!1,r=parseInt(z.Type,10),J=z.Target,v=Object(e.a)(f.DdaFacade,m.a(this.$));if((J=v.gj.oVh(r,J))&&0<Object.keys(J).length){C=!0;for(var D in J)if(J=D,v.gj.q_b(J)){var V=Array(1);V[0]=a.Lbc(z,u);if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var U=V[0][3];if(void 0!==U&&null!==U&&(U=Object(e.a)(Object,x.a.pi(U)))&&void 0!==U.triggerControlId&&null!==U.triggerControlId&&void 0!==U.triggerSource&&null!==U.triggerSource){var Q=!1;u?(U.triggerSource="Unknown",
Q=!0):v.$gh(U.triggerControlId,J)&&(U.triggerSource="ThisLocalAddin",Q=!0);Q&&(V[0][3]=x.a.Kc(U))}}this.Ova(J,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,V)}}C?(this.tec(l[r],this.kbd),this.tec(l[r],this.S$f)):(this.tec(l[r],this.iyd),this.tec(l[r],this.U$f))};a.prototype.Lia=function(){this.HA||(this.HA=[],this.$.Loe(this.nvc),this.$.wantServerEvents=!0)};a.prototype.tec=function(z,u){z in u||(u[z]=0);u[z]+=1};a.prototype.UM=function(z,u,C){var r={};r.Target=u;r.Category=65536;r.Type=z;r.Message=
C;r.Id=-1;this.ZIe(r,!1)};a.prototype.sDh=function(z,u){var C={Target:"",Category:2,Type:1E3};C.Message=u;C.Id=0;u=Array(1);u[0]=a.Lbc(C,!1);this.P2i(z,u)};a.prototype.H9b=function(z,u,C,r){var J={};J.Target=C;J.Category=65536;J.Type=u;J.Message=r;J.Id=-1;u=Array(1);u[0]=a.Lbc(J,!1);this.Ova(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)};a.prototype.rDh=function(z,u){this.Ova(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,u)};a.prototype.Ova=function(z,u,C,r){if(this.HA){var J=Object(e.a)(f.DdaFacade,
m.a(this.$));if(!J||u!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&u!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||J.gj.q_b(z))for(z=new n.a(u,z,C,r),u=0,C=this.HA.length;u<C;u++)(r=this.HA[u])&&r(z)}};a.Lbc=function(z,u){var C=Array(6);C[0]=z.Category;C[1]=z.Type;C[2]=z.Target;C[3]=z.Message;C[4]=z.Id;C[5]=u;return C};Object(A.a)(a,"DdaEventDispatch",null,[])},1365:function(A,F,b){function a(){var l=e.call(this,void 0,void 0,void 0,!0)||this;l.UCa="AddinCommandsUILessDialog";l.mSc="WACDialogTitleText";
l.jVa="0";l.XCa=380;l.Mhb=190;l.Ue=l.UCa;l.jc=5;l.cng=String.format("{0}px",l.XCa);l.iVa=String.format("{0}px",l.Mhb);l.Su=!1;l.V7e=!1;l.gD();return l}b.d(F,"a",function(){return a});A=b(0);F=b(140);var c=b(89),e=F.a;vm(a,e);a.prototype.gD=function(){e.prototype.gD.call(this);this.yp.style.width=this.cng;this.yp.style.height=this.iVa;this.yp.style.padding=this.jVa};a.prototype.mv=function(l){this.IO();document.getElementById(this.ri(this.mSc)).innerText=l};a.prototype.IO=function(){e.prototype.IO.call(this);
this.Lb.style.width=String.format("{0}px",this.XCa);this.Lb.style.height=String.format("{0}px",this.Mhb);this.Lb.removeAttribute(c.a.Td);this.Lb.removeAttribute(c.a.fE)};a.prototype.hide=function(){this.cxb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)};Sk.Object.defineProperties(a.prototype,{q1a:{configurable:!0,enumerable:!0,get:function(){return this.yp}}});Object(A.a)(a,"AddinCommandsUILessDialog",F.a,[484])},1371:function(A,
F,b){function a(G){return Yk.call(this,G)||this}function c(G,ka,d){this.rangePicker=null;this.$=G;this.We=ka;this.ze=new K(G.ea);this.Rz=new U(G,this.ze);this.psf=d;this.X8b=new Map}function e(G,ka,d,w,I){this.RSc=null;this.XPb=G;this.fA=ka;this.gJ=d;this.vb=w;this.Pyg=I}function l(){}function n(){this.vga=null}function m(G){if(!G)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.Fvd=G}function f(G,ka,d){return function(w){return function(I,
ha){Bh.TaskExtensions.Ba(gj.GetServiceTaskFactory.create(ka.da,279,ka.ma,1),function(wa){wa=wa.result;var $a=!1,Tb=d.Ji.getOsfControl(G),Ic=null;Tb&&(Ic=Tb.getStoreType(),(Tb=Tb.getManifest())&&Tb.getSharedRuntimeForCustomFunctions("Workbook")&&($a=!0));Bh.TaskExtensions.Ba(wa.Ebf(G,Ic,w,$a),function(pc){kl.b(pc)?pc.result?I(null):ha(OfficeExtension.WacRuntime.Utility.createRichApiException(L.a.invalidArgument,zf.a.instance.fa(1719))):ha(OfficeExtension.WacRuntime.Utility.createRichApiException(L.a.generalException,
zf.a.instance.fa(1715)))},ka.ma,3)},ka.ma,3)}}}function x(G,ka){this.nP=qi.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.fA=G;this.gJ=ka;this.ztg=this.gJ.Ji.getOsfControl(this.fA)}function y(G,ka,d,w){this.Q2d="";this.PRb=0;this.nP=G;this._id=ka;this.fA=d;this.gJ=w}function t(G,ka,d){this.Pqg=G;this.Qqg=ka;this.Kug=d}function B(){this.Zhe=this.Zbe=this.$z=!1}function z(G,ka,d,w){this.Is=G;this.E1=d;this.By=w.Ji.getOsfControl(ka)}function u(G,ka){this.gJ=ka;this.fA=
G}function C(G){this.fA=G}function r(G){this.zIa={};this.Ozi=G}function J(G,ka){var d=this;d.Whf=function(w,I){w=J.c3g(w,I);if(!jl.a(d.$,w))return!0;w=d.$.shortcutKeyManager.H3e(w);return!!w&&0<w.length};d.addinId=G;d.$=ka;return d}function v(){}function D(){}function V(G,ka,d,w){this.iBh=G;this.fileSize=ka;this.UDj=w}function U(G,ka){var d=this;this.lI=function(w,I){d.NQ.RJa($d.a.internalError,I)};this.$=G;this.NQ=ka}function Q(G,ka,d,w){d=il.call(this,576,0,d,w)||this;d.WLd=new ba("576",G,ka);return d}
function la(G,ka,d,w,I,ha,wa,$a){ka=Lk.call(this,10,0,ka,$a)||this;ka.Slb=d;ka.gib=w;ka.G3=I;ka.eFa=ha;ka.request=wa;ka.WLd=new ba("10",G,wa);return ka}function ba(G,ka,d){this.parentName=G;this.$=ka;this.request=d}function T(G,ka){this.source=G;this.eventId=ka}function H(G,ka,d,w,I,ha){var wa=G.Na(1);wa.request=ka;return Ci.i(G,"ExecuteRichApiRequest",wa,d,w,I,ha,0)}function S(G,ka,d){this.$=G;this.NQ=ka;this.Rz=d}function K(G){this.ea=G}function da(G,ka,d,w){G=Xj.call(this,G,"Select Data")||this;
G.Nob=null;G.GGe=ka;G.Q5c=d;G.callback=w;return G}function fa(G){this.vb=G}function X(G){G.add("InternalTest","PreviewExecutionMethod",ca)}function ca(G,ka){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof G+", objectId="+G+", value="+ka);return null}function ja(G,ka){this.zsg=G;this.Xsg=ka}function ea(G){var ka=G.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}","{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var d=ka.addMethod("AreShortcutsInUse",
3,"Object[]",1,0,"AreShortcutsInUse",0);d.addParameter("shortcuts","String[]",1,null,0);ka.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);d=ka.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);d.addParameter("shortcuts","Object",1,null,0);ka=G.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);d=ka.addMethod("GetSharedFilePickerResponse",1,"Object",1,1,"SharedFilePickerResponse",0);d.addParameter("pickerCustomizationJsonString",
"String",1,null,0);ka=G.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);d=ka.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);d.addParameter("base64File","String",1,null,0);ka=G.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);ka.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);d=ka.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",
0);d.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ka=G.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);ka.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);d=ka.addMethod("Register",1,"Void",0,0,"Register",0);d.addParameter("metadata","String",1,null,0);d.addParameter("javascript","String",1,null,0);ka=G.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus",
"{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);ka.addProperty("Enabled",1,"Boolean",1,!1,null,0);ka.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);ka.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);ka=G.addEnumType("Microsoft.Authentication.IdentityType");ka.addEnumField("OrganizationAccount",0);ka.addEnumField("MicrosoftAccount",1);ka=G.addEnumType("Microsoft.Authentication.AuthorityType");ka.addEnumField("External",0);ka.addEnumField("Msa",1);ka.addEnumField("Aad",2);ka=G.addType("Microsoft.Authentication.OfficeIdentityInfo",
"{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);ka.addProperty("DisplayName",4,"String",1,!1,null,0);ka.addProperty("Email",3,"String",1,!1,null,0);ka.addProperty("FederationProvider",2,"String",1,!1,null,0);ka.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);ka=G.addType("Microsoft.Authentication.AuthContext","{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);ka.addProperty("AppId",4,"String",
1,!1,null,0);ka.addProperty("Authority",2,"String",1,!1,null,0);ka.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);ka.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);ka.addProperty("TenantId",6,"String",1,!1,null,0);ka.addProperty("Upn",1,"String",1,!1,null,0);ka=G.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}","{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);ka.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",
3,!0,null,0);d=ka.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);d.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);ka.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);ka.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",2,1,"PrimaryIdentityInfo",4);ka=G.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}",
"{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);ka.addProperty("AuthChallenge",3,"String",1,!1,null,0);ka.addProperty("CorrelationId",7,"String",1,!1,null,0);ka.addProperty("Policy",4,"String",1,!1,null,0);ka.addProperty("Resource",2,"String",1,!1,null,0);ka.addProperty("Scope",5,"String",1,!1,null,0);ka.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);ka=G.addType("Microsoft.Authentication.SingleSignOnToken","{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);ka.addProperty("AccessToken",
2,"String",1,!1,null,0);ka.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);ka=G.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);ka.addProperty("Id",1,"String",1,!0,null,0);ka.addProperty("Value",2,"Object",1,!1,null,0);ka=G.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}","",3,0);d=ka.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",
0);d.addParameter("id","String",1,null,0);d=ka.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);d.addParameter("id","String",1,null,0);ka=G.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);ka.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",0);d=ka.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);
d.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);ka=G.addEnumType("Microsoft.AppRuntime.AppRuntimeState");ka.addEnumField("Inactive",0);ka.addEnumField("Background",1);ka.addEnumField("Visible",2);ka=G.addEnumType("Microsoft.AppRuntime.Visibility");ka.addEnumField("Hidden",1);ka.addEnumField("Visible",2);ka=G.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}","{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);ka.addProperty("Buttons",
4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);d=ka.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);d.addParameter("jsonCreate","String",1,null,0);d=ka.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);d.addParameter("jsonUpdate","String",1,null,0);d=ka.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);d.addParameter("id","String",1,null,0);d=ka.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,
"Tab",0);d.addParameter("id","String",1,null,0);ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ka=G.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);ka.addProperty("Id",2,"String",1,!0,null,0);d=ka.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);d.addParameter("visibility","Boolean",1,null,0);ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ka=G.addType("Microsoft.DynamicRibbon.RibbonButton","{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",
3,0);ka.addProperty("Enabled",3,"Boolean",1,!1,null,0);ka.addProperty("Id",2,"String",1,!0,null,0);ka.addProperty("Label",4,"String",1,!0,null,0);d=ka.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);d.addParameter("enabled","Boolean",1,null,0);ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ka=G.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);ka.addMethod("GetCount",3,"Int32",1,1,"Count",0);d=ka.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",
3,0);d.addParameter("key","String",1,null,0);ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);ka.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);ka=G.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");ka.addEnumField("Unknown",0);ka.addEnumField("Basic",1);ka.addEnumField("Premium",2);ka=G.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",3,0);d=ka.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",
1,1,"FeatureTier",0);d.addParameter("feature","String",1,null,0);d.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);d=ka.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);d.addParameter("feature","String",1,null,0);d=ka.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);d.addParameter("feature","String",1,null,0);d.addParameter("fallbackValue","Boolean",1,null,0);ka.addMethod("IsFreemiumUpsellEnabled",
3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);d=ka.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);d.addParameter("experienceId","String",1,null,0);d=ka.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);d.addParameter("feature","String",1,null,0);ka=G.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}","",3,0);ka.addProperty("Id",5,"String",1,!0,null,0);ka.addMethod("_RegisterStateChange",6,"Void",
0,1,"_RegisterStateChange",0);ka.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);ka=G.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);ka.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);ka=G.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification","{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",
3,0);ka.addMethod("Disable",3,"Void",0,1,"Disable",0);ka.addMethod("Enable",2,"Void",0,1,"Enable",0);ka.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function qa(G,ka,d,w){this.menuItemId=G;this.CI=ka;this.xHj=d;this.tBh=w}function pa(G){this.gyi=G}function Pa(G){this.Pxa=G;this.kog=fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function Ha(){}function Xa(){}function Na(){}function db(G,ka){this.nhb=ka;this.fA=G}function Ja(){this.a2d=
null;this.mge=this.iVb=this.JD="";this.Ahe=!0;this.options=null}function jb(G,ka){this.kgb=G;this.Qib=ka}function hc(){}function ma(){this.z6d=this.Q5d=this.tfa=null;this.Qib=0}function Ka(G){var ka=gl.call(this)||this;ka.$=G;ka.dc();return ka}function Ta(G,ka,d){this.elg=null;this.glg=0;this.wb=G;this.Tg=ka;this.x3d=d}function ob(){}function Cb(G,ka,d,w,I){var ha=fl.call(this)||this;ha.Kcb={};ha.obd={};ha.rwa=null;ha.Q$a=null;ha.w5h=function(wa,$a,Tb,Ic,pc){if(2!==Tb)return 32;wa=pc[uk.a.N8b];Tb=
pc[uk.a.kHa];pc=pc[uk.a.Tya];$a=new Lj.a;$a.udi=pc.si.InstanceToken;$a.dl=pc.si[ue.dl];$a.AS=pc.si[ue.AS];ue.taskPaneWidth in pc.si&&($a.taskPaneWidth=pc.si[ue.taskPaneWidth]);$a.sourceLocationOverrideResourceId=pc.si[ue.sourceLocationOverrideResourceId];$a.gI=pc.ir;$a.onTaskPaneClose=pc.si[ue.onTaskPaneClose];$a.kHa=Tb;Tb=new ag.a(-859308420,0,2,0,"");Ic=wa.getStoreType()===OSF.StoreType.Sdx;var vd=new mc;vd.cba=pc.si.HeaderCssClass||Xe.a.$Ia;vd.Zzc=pc.si.TitleCssClass;ha.J0(Tb,wa.getId(),$a,Ic,
vd);return 32};ha.h5h=function(wa,$a,Tb,Ic,pc){if(2!==Tb)return 32;wa=pc[uk.a.N8b].getId();pc=pc[uk.a.Tya].si[ue.sourceLocationOverrideResourceId];return wa?(ha.We.Ji.refreshOsfControl(wa,pc),32):8};ha.g0i=function(wa){wa=wa.Result;if(wa=null===wa?null:wa.SolutionId)ha.We.Sle(wa),sk.a(ha.$).ona(3,wa)};ha.EIf=function(wa,$a){var Tb=(wa=wa.Result)?wa.AgaveData:null;if(Tb){Se.ULS.shipAssertTag(537170434,0,Tb.TaskpaneWidth===Cb.Och,"Taskpane width is {0}, assetId is {1}.",Tb.TaskpaneWidth,Tb.PrimaryMarketplace.SolutionId);
var Ic=ha.obd[Tb.PrimaryMarketplace.SolutionId];Ic&&(Ic.Azc&&(Tb.TaskpaneTitle=Ic.Azc),Ic.yzc&&(Tb.TaskpaneIconId=Ic.yzc),Ic.dVd&&(Tb.TaskpaneButtonTooltip=Ic.dVd),0<Ic.Er&&(Tb.TaskpaneWidth=Ic.Er));$a&&(Tb.FocusOnIframeWhenLoaded=$a.focusOnIframeWhenLoaded,$a.width&&(Tb.TaskpaneWidth=$a.width),Tb.TaskpaneIconCssClass=$a.Nj,Tb.TaskpaneHeaderCssClass=$a.cba,Tb.TaskpaneTitleCssClass=$a.Zzc,Tb.IsFirstPartyOptOutAppContextOptmization=$a.isFirstPartyOptOutAppContextOptmization);ha.Kcb[Tb.PrimaryMarketplace.SolutionId]&&
(Tb.OsfPropertyBag=ha.uwd(Tb.OsfPropertyBag,Tb.PrimaryMarketplace.SolutionId));Mj.a(Tb)||(Tb.WebExtensionOsfControlType=1);Tb&&(ha.We.Sle(wa.SolutionId),ha.We.F0a(Tb))}else Se.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};ha.EAh=function(wa){wa&&(ha.rad.Hjf(wa),ha.sxe())};ha.GIf=function(wa){wa=wa.toDataURL("image/jpeg");var $a=ha.We.yaa(Cb.e9e+"."+Cb.C5e);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand($a,"onScreenshot",
{screenshot:wa},function(){})};ha.L3h=function(wa,$a,Tb,Ic,pc){if(2!==Tb)return 32;if(Tj.a.oi(pc)||pc[uk.a.EBe]!==Pj.a.action)return 8;$a=pc[uk.a.Tya];return $a?(wa=(wa=ha.nVh(pc))?ha.We.yaa(wa):null)?(pc=ha.We.i4g(pc[uk.a.kHa],$a.si[ue.pTc]),Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(Tb=ha.We.sZ(wa),Tb.TaskpaneTitle!==$a.si[ue.dl]&&(Tb.TaskpaneTitle=$a.si[ue.dl],Tb.TaskpaneIconCssClass=$a.si.IconCssClass,Tb.TaskpaneIconUrl=$a.si.TaskPaneIconUrl,Tb.TaskpaneIconId=
$a.si.TaskPaneIconId,Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?($a=ha.We.Ji,$a.changeIframeTitle(wa,Tb.TaskpaneTitle),Tb=$a.getOsfControl(wa),$a.raiseOsfControlStatusChange(Tb)):($a=ha.We.Ji.getOsfControl(wa),ha.We.Ji.raiseOsfControlStatusChange($a)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(wa,pc,ha.YIb),32):8:8};ha.YIb=function(wa,$a){ha.We.nDh(wa,$a)};ha.$=G;ha.viewBlockContainerHelpers=d;ha.We=ka;ha.rad=w;ha.Gi=I;ha.Gi.fc(re.a.Y3f,
Rj.a.frame,ha.w5h);ha.Gi.fc(re.a.kUf,Rj.a.frame,ha.h5h);ha.Gi.fc(re.a.YRe,Rj.a.frame,ha.L3h);return ha}function eb(){var G=pk.call(this)||this;G.iVa="calc(100% - 46px)";G.JQb="15px";G.jVa="0";G.Xng="WACDialogPanel";G.XCa=695;G.Yng=462;G.Mhb="80%";G.Olg=350;G.s2d="100%";G.jc=5;G.Ue="AppsForOfficeInsertionDialog";G.MHc=!!fg.AFrameworkApplication.ga&&fg.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return G}function ya(){var G=za.call(this)||this;G.isTable=!1;G.isPivotTable=
!1;G.hasTableHeaders=!1;G.tableName=null;G.userSelectedPivotTable=!1;return G}function za(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function Ga(){this.dVd=this.Azc=null;this.Er=0;this.yzc=null}function cb(){var G=this;this.We=null;this.iab=function(ka,d,w,I,ha){if(2===w){ka=ha?ha:{};d=ka.callback;if(!d)return 16;G.We.VFd(d,ka.refresh?ka.refresh:!1)}return 32};this.X9i=
function(ka,d,w,I,ha){2===w&&(ka=ha?ha.callback:null)&&G.We.AEg(ka);return 32}}function Mb(G,ka){this.l9=ka}function Dc(G){return ki.call(this,G)||this}function vb(G){var ka=vh.call(this)||this;ka.$=G;ka.isFirstLaunch=!1;return ka}function ib(G){Se.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Tof=fg.AFrameworkApplication.ga.ra("IsTellMeUpSellEnterpriseEnabled");this.zxi=fg.AFrameworkApplication.ga.Ua("SmartLookupApprovedOriginPattern");this.q8a=fg.AFrameworkApplication.ga.Ua("SmartLookupShredderServiceEndpoint");
this.eyi=xa.a.YM(fg.AFrameworkApplication.ga.Ua("AppCatalogUrl")||"");this.p8a=new Ya;this.p8a.EnableAllTabV2=!0;this.p8a.EnableIntentService=!0;this.p8a.EnableInDocumentSearch=fg.AFrameworkApplication.ga.ra("SmartLookupEnableInDocumentSearch");this.p8a.EnableLocalSearch=fg.AFrameworkApplication.ga.ra("SmartLookupEnableLocalSearch");this.p8a.IntentServiceEndpoint=ub.KYh();this.$xi=new Eb(G,this.q8a)}function ub(){}function Eb(G,ka,d){this.$Lj=9E5;this.cMj=3E5;this.ivd=null;this.oof="";this.fvd=0;
this.DGe=Date.now;this.Pxa=G;this.q8a=ka;(void 0===d||d)&&this.vdd()}function Ya(){}function tb(){}function ec(){}function Za(){}function mb(){}function sc(G,ka,d,w,I,ha){this.$=G;this.agaveCommandManager=ha}function pd(G){var ka=Ei.call(this)||this;ka.ddaFacade=null;ka.lNf=null;ka.$=G;G.da.Ha(106,ka);ka.dc();return ka}function $b(){}function Xb(){}function lc(G){this.jFa=G}function Oa(G,ka,d){this.iframe=G;this.onSuccess=ka;this.onError=d;$addHandler(window,"message",Object(Qi.a)(this,this.q7e,"handleResponse"))}
function pb(G,ka){return ff.a.Mtd(42,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},fg.AFrameworkApplication.ga.Ad("MaxRetriesForLoadingScript",0),G,ka)}function Ub(G){var ka=Ij.call(this)||this;ka.$=G;ka.dc();return ka}function ic(G,ka){var d=this;this.ZPa=this.$Pa=null;this.vag=function(w,I){var ha=null,wa=null,$a=null;I?(Object(Ej.a)(233,I)?(ha=I.WFa,$a=I.instanceId):Object(Ej.a)(306,I)&&(ha=I.get_element(),$a=I.instanceId),ha)?(wa=Object(Vh.a)(415,w),wa)?d.mNf($a,
ha,wa)||$a in d.ZPa||(d.$Pa[$a]=0,d.ZPa[$a]=Ui.a.instance.nC(function(){10<=d.$Pa[$a]||d.mNf($a,ha,wa)?(delete d.$Pa[$a],d.ZPa[$a].dispose(),delete d.ZPa[$a]):d.$Pa[$a]+=1},500,Ri.a.JIg,!0,!1)):Se.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):Se.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):Se.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};this.ariaLiveNotifier=
G;this.$=ka;this.zXc=!1;this.$.da.Ha(224,this)}function Jb(G){var ka=Zg.call(this)||this;ka.$=G;ka.dc();return ka}function cc(G){var ka=Mi.call(this,G)||this;ka.handler=null;ka.Kzg=function(){Se.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",ka.$.isEditMode,!!(ka.$.Hd&16384));var d=new Oj.a;ka.$.da.Za(53,function(pc){Se.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");
d.setResult(pc)});var w=d.task,I=new Ac,ha=Ok.a.getInstance(),wa=new Cd(ka.$,ha),$a=gj.GetServiceTaskFactory.create(ka.$.da,203,ka.ma,ka.ub),Tb=ka.X8i(I),Ic=gj.GetServiceTaskFactory.Wa(ka.$.da,349,350,ka.ub);return Bh.TaskExtensions.Ba(Bh.TaskExtensions.ve([w,$a,Tb,Ic],ka.ma),function(){Se.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Bh.TaskExtensions.Ba(gj.GetServiceTaskFactory.create(ka.$.da,106,ka.ma,ka.ub),function(pc){ka.handler=
new P(ka.$,pc.result,I,new Re,ha,wa,qi.a.instance.Oh("Common.IExternalUICommandDefinitionMapping"));Se.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");ka.Fd([ka.handler]);ka.$.da.Ha(198,ka.handler)},ka.ma,3)},ka.ma,3)};ka.Xbh=function(){void 0!==ka.handler&&null!==ka.handler?(ka.$.Ka.Rab(ka.handler),ka.$.da.OU(198),ka.handler=null):Se.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");
ka.$.da.OU(204);Pi.a(Oi.a,21,ka.$.da,198)};return ka}function Ob(G,ka,d,w){this.wQd=void 0===G?null:G;this.vTc=void 0===ka?null:ka;this.R5c=void 0===d?null:d;this.$8b=void 0===w?0:w}function P(G,ka,d,w,I,ha,wa){var $a=this;wa=void 0===wa?null:wa;this.disposed=!1;this.Ma=new dk.a;this.wIj=3E5;this.hRd=!0;this.KVc="addinActivated";this.DHi=function(Tb,Ic){if(Ic)if(Ic)if(Tb=Ic.hi){Ic=Ic.Bo;var pc=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(Tb.assetId in pc)Ic=pc[Tb.assetId];
else if(Ic=$a.pNh(Ic),void 0===Ic||null===Ic){Se.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}pc=new ag.a(re.a.A2,0,0,2,null);var vd={};$a.executeCommand(0,pc,(vd.SourceControlId=Ic,vd),null);Tb.isAutoLaunched=!0}else Se.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else Se.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else Se.ULS.sendTraceTag(528098437,220,15,"No args for OnAutoLaunchAddin event")};this.WOi=function(Tb,Ic){Tb=null;
Ic&&(Tb=Ic);(null===Tb||void 0===Tb?0:Tb.Bo)&&$a.Ftj(Tb.Bo);$a.$.If();Gf.EwaSettings.la(88)&&Tb&&Tb.hi&&$a.oNg(Tb.hi)};this.$=G;Se.ULS.shipAssertTag(537170659,0,!(void 0===ka||null===ka),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",Ji.a.u3());this.We=ka;this.qCe=d;this.oZb=w;this.eha=I;this.Enb=ha;this.co=new lg.a;this.dha=new Ec;this.ead=wa;dl.a.gxb=dl.a.URe;this.a6c=new ph.a;this.v1a=new ph.a}function Ba(G){var ka=this;this.MFa=this.QFa=this.hi=this.Bo=
null;this.bsc=0;this.VOi=function(){if(ka.hi&&ka.MFa){var d=new ag.a(re.a.A2,0,0,2,null),w={};ka.addinUICommandHandler.executeCommand(0,d,(w.SourceControlId=ka.MFa,w),null);Se.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.BAj=function(d,w){d=null;if(w)if(d=w,ka.hi=d.hi,ka.Bo=d.Bo,ka.Bo&&ka.Bo.qW&&ka.Bo.qW.Nr&&(ka.QFa=ka.Bo.qW.Nr.oa(0)),ka.QFa&&ka.QFa.id)if(ka.QFa.isOfficeTab)if(w=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),ka.hi.assetId in
w?ka.MFa=w[ka.hi.assetId]:(Se.ULS.sendTraceTag(537170695,220,15,"Failed to get button id from controlIdMap for add-in: {0}",Telemetry.PrivacyRules.GetAssetId(ka.hi.storeType,ka.hi.storeId,ka.hi.assetId)),ka.MFa=ka.IJh(ka.Bo)),ka.MFa)if(Gj.a.contains(ka.QFa.id,Ii.a.JW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Pc.a.jub(ka.Bo),function(){ka.$4f(ka.Bgd(ka.MFa))});else{if(w=ka.$.Ka)w.Voe(ka.vEf),Se.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else Se.ULS.sendTraceTag(537170694,
220,10,"Failed to get button id for addin"),w={},w=(w.AppTeachingUICalloutAction="NoEnabledButtonFound",w["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(ka.hi.storeType,ka.hi.storeId,ka.hi.assetId),w.AppTeachingUICalloutGoal="NewAdminDeployment",w["SDX.AppInstallOrigin"]="Organization",w),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(w)}));else ka.b5f(ka.Bgd(ka.QFa.id),0);else Se.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),
w={},w=(w.AppTeachingUICalloutAction="NoTabFound",w["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(ka.hi.storeType,ka.hi.storeId,ka.hi.assetId),w.AppTeachingUICalloutGoal="NewAdminDeployment",w["SDX.AppInstallOrigin"]="Organization",w),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(w)}))};this.vEf=function(){if(Gj.a.contains(ka.QFa.id,appChrome.selectors.getSelectedTabId(),!0)){var d=ka.$.Ka;d&&d.DRf(ka.vEf);ka.$4f(ka.Bgd(ka.MFa))}};
this.$=G.$;this.addinUICommandHandler=G;this.co=new lg.a}function ra(G,ka){this.mEa=G;this.$ea=new Gc;this.jfa=new Kb(ka)}function ta(G,ka,d,w,I,ha){G=bb.call(this,G,ka)||this;G.C8=null;G.mfa=null;G.pfa=null;G.jfa=d;G.Tpg=w;G.aFc=I;G.mpa=ha;return G}function Ia(G){this.jge=null;if(xi.c(G))throw Se.ULS.sendTraceTag(9041813,220,10,"ScalingDefinition type should not be null or undefined."),Error.create("ScalingDefinition type should not be null or undefined");this.Evg=G}function bb(G,ka){this.qie=new ph.a;
this.Tw=this.Av=null;this.ekb=G;this.$ea=ka}function Va(G){this.kge=this.t7d=this.lie=null;this.isOfficeTab=!1;this.f6e=this.DWf=null;this._id=G;this.USa[Nc.a.id]=this._id}function lb(G){this.j4d=this.s7d=this.Ylb=null;if(xi.c(G))throw Se.ULS.sendTraceTag(9041811,220,10,"GroupDefinition id should not be null or undefined."),Error.create("GroupDefinition id should not be null or undefined");this._id=G;this.Lva[Nc.a.id]=this._id}function kc(G,ka,d,w,I,ha){this.JPb=new ph.a;this.C8=this.Tw=this.Av=null;
this.ekb=G;this.$ea=ka;this.jfa=d;this.Is=w;this.mpa=I;this.n6d=ha}function zb(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function Sb(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=null}function gb(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function Sa(){this.iconLocation=this.title=this.id=null;this.enabled=!1;
this.controlType=0;this.attributes=this.menuItems=null}function Kb(G){this.JCa=G}function Gc(){}function Hb(G,ka){this.Ylb=new Lb(G,ka)}function Lb(G,ka){this.Hxg=G;this.mng=ka}function sa(G){this.mEa=G}function Ua(G,ka,d){this.fJ=this.rVa=null;this.ekb=G;this.jfa=ka;this.$ea=d;this.Fsg=new ph.a}function Yb(G){this.B8=null;if(xi.c(G))throw Se.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");
this._id=G}function jc(G){this.hNc=null;if(xi.c(G))throw Se.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=G;this.JR[Nc.a.id]=this._id}function md(G,ka){this.Vfa=this.i4d=null;if(xi.c(G)||xi.c(ka))throw Se.ULS.sendTraceTag(9175312,220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");
this.k4d=ka;this._id=G;this.EA[Nc.a.id]=this._id}function jd(G,ka,d,w,I,ha,wa,$a){$a=void 0===$a?null:$a;this.rb=new Qj.a;this.HUa=G;this.h4d=ka;this.Pm=d;this.UWb=w;this.dra=I;this.Gkg=ha;this.mpa=wa;this.Nce=$a;this.JDa=fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1);this.kWa=fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinTelemetryEnabled",!1);this.arg=fg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")}
function Zc(G,ka,d,w,I,ha,wa){this.KSa=new Fj.a;this.ks=G;this.Ji=ka;this.co=d;this.ribbonManager=w;this.contextMenuManager=I;this.ZF=ha;this.dha=wa;this.OO=fg.AFrameworkApplication.sa.xD}function Qb(G,ka,d){this.z1d=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=G;this.eventBuilder=ka;this.contextMenuBuilder=d}function fd(G){this.qog=G.entitlement}function xd(G,ka,d,w,I){ka=void 0===ka?null:ka;d=void 0===d?null:d;w=void 0===
w?null:w;I=void 0===I?0:I;if(xi.c(G)&&xi.c(ka))throw Se.ULS.sendTraceTag(9041814,220,10,"One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");this.lY=G;this.rtg=ka;this.Pwg=d;this.skb=w;this.spg=I}function Ad(G){this.Ice=null;if(xi.c(G))throw Se.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");
this.Okg=G}function Me(){}function Ue(){}function Jd(G){this.H$d=null;this.C8d=G}function Sd(G,ka,d){this.rb=G;this.V8=ka;this.sgb=d}function se(G,ka,d,w,I,ha,wa){this.ks=G;this.hi=ka;this.r0=d;this.eWe=w;this.ZFh=I;this.displayName=ha;this.bkf=wa}function oe(){var G=ed.call(this)||this;G.hi=null;G.Bo=null;return G}function Ke(){new bc(cd.a.instance)}function bc(G){this.YDa=G}function qd(){this.Ver=1}function zc(){}function ld(G){this.ytg=G}function rb(G,ka,d){this.Ma=new Qj.a;this.context=new of;
this.kXc=this.cha=this.Dda=this.MPb=null;this.contextActivationMgr=G;this.THg=ka;this.pZb=d;this.appName=fg.AFrameworkApplication.ga.Ua("WebAppShortName")}function Wd(G){var ka=Fc.call(this)||this;ka.solutionId=G.solutionId;ka.assetId=G.assetId;ka.storeType=G.storeType;ka.storeId=G.storeId;ka.assetStoreId=G.assetStoreId;ka.targetType=G.targetType;ka.width=G.width;ka.height=G.height;ka.displayName=G.displayName;ka.version=G.version;return ka}function rc(){this.addinId=null;this.targetType=0;this.assetId=
null}function nd(G,ka,d,w){this.fIb=fg.AFrameworkApplication.ga.Ua("RoamingServiceHandlerWebServiceBase");this.appName=G;this.Cib=ka;this.yib=d;this.Mkb=void 0===w?null:w}function me(G){var ka=Zb.call(this)||this;ka.properties=G;return ka}function be(){this.kA=this.jq=null;this._count=0}function sd(G,ka,d){this.next=d;this.previous=ka;this.data=G}function Qe(G){this.Kr=null;this.cA=G}function Sf(G){var ka=-1;switch(G.toLowerCase()){case "omex":ka=0;break;case "spcatalog":ka=1;break;case "spapp":ka=
2;break;case "filesystem":ka=3;break;case "exchange":ka=4;break;case "registry":ka=6;break;case "inmemory":ka=7;break;case "uploadfiledevcatalog":ka=8;break;case "hardcodedpreinstall":ka=9;break;case "excatalog":ka=10;break;case "wopicatalog":ka=16}return ka}function mf(G){var ka=null;switch(G){case 0:ka="omex";break;case 1:ka="spcatalog";break;case 2:ka="spapp";break;case 3:ka="filesystem";break;case 4:ka="exchange";break;case 6:ka="registry";break;case 7:ka="inmemory";break;case 8:ka="uploadfiledevcatalog";
break;case 9:ka="hardcodedpreinstall";break;case 10:ka="excatalog";break;case 16:ka="wopicatalog"}return ka}function Zd(G){var ka={};ka.solutionId=G.solutionId;ka.version=G.version;ka.storeType=G.storeType;ka.storeId=G.storeId;ka.assetId=G.assetId;ka.assetStoreId=G.storeType;ka.targetType=G.targetType;ka.requireConsent=G.requireConsent||!1;ka.isAddinCommands=!0;ka.id=G.solutionId;ka.appVersion=G.version;ka.currentStoreType=G.storeType;return ka}function ie(){return xa.a.x4(window.location.href.toLowerCase(),
"wdtpl")}function kd(){var G=xa.a.x4(window.location.href.toLowerCase(),"wdomexsrctype");return!!G&&"4"===G}function ge(){}function of(){this.ks=this.$_=0;this.LVc=null;this.Dqc=this.kAc=0;this.u0a=this.pja=this.Q9=null}function Ec(){this.RYa=null}function Cd(G,ka){var d=hk.call(this)||this;d.statusBarManager=null;d.agaveCommandManager=null;d.pze=function(){d.ZF&&d.ZF.Yye()};d.j6e=function(){d.raiseEvent("LAC")};d.$c=function(w,I){!w.qc&&Fk.b(I)&&d.statusBarManager&&(d.statusBarManager.RF(d),d.statusBarManager=
null)};d.ZF=ka;d.$=G;d.TGj=G.Ib+"OfficeAddinLabel-Medium14";d.$.da.Za(29,function(w){d.statusBarManager=w;w.xJ(d)});d.$.ea.Uj(d.$c);d.ZF.QDg(d.j6e);d.$.da.Za(206,function(w){d.agaveCommandManager=w;w.uFg(d.pze)});return d}function Qd(){}function od(){this.Ei=null;this.visible=!1}function ke(G,ka){this.Sa=G;this.r2g=ka}function Re(){this.d2d=this.fEc=null}function lf(G){this.Bfe=new vc(G)}function vc(G){this.s9=G;this.sVb=this.s9.ribbonBuilder}function hd(){var G=ak.call(this)||this;G.jmd=null;G.Qld=
null;G.ribbon=null;return G}function Ac(){this.img=new ph.a}function Vd(){}function Bd(G){return Jk.call(this,G)||this}function tf(G,ka,d){this.Drb=null;this.$=G;ka?(Se.ULS.sendTraceTag(537163346,0,50,"DataFromPictureCommandHandler.constructor - AugmentationLoopManager and UploaderCreator instantiated."),this.Drb=new Dk.a(G,ka,d)):Se.ULS.sendTraceTag(537163347,0,10,"DataFromPictureCommandHandler.constructor - Failed to instantiate AugmentationLoopManager.")}function Wb(G){var ka=bl.call(this)||this;
ka.$=G;ka.dc();return ka}function wc(G,ka){var d=Uc.call(this)||this;d.$=G;d.Rta=new DOMParser;d.cache=new Ti.a;d.indexedDB=ka;ka.rg()&&d.indexedDB.initialize("Scripts","OfficeScriptingCache");d.S4=!1;d.Hm=new Ed([],function(w){Uc.W5f(w)});d.hg=new Ed([],function(w){Uc.uLb(w)});d.zr=new Ed([],function(w){Uc.uLb(w)});d.Kk=new Ed([],function(){});return d}function yb(G,ka,d,w){var I=this;this.$6a=!1;this.i9a=function(){I.O2f()?(I.MIf(),dj.g(I.$).Ca.bJd(I.i9a)):I.$6a&&dj.g(I.$).Ca.bJd(I.i9a)};this.DJi=
function(ha,wa){Object.getType(wa)===String&&wa.toString().endsWith($c.a.Fvb(I.$))&&(I.$6a=!1)};this.$=G;this.lsa=ka;this.Ov=d;this.businessBarManager=w;this.cwj()}function mc(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.Zzc=this.cba=this.Nj=null;this.isFirstPartyOptOutAppContextOptmization=!1}function Wc(G,ka,d,w,I,ha,wa,$a,Tb){var Ic=this;this.oA=null;this.cache=new Ti.a;this.D7d=this.Tee=this.Vee=this.See=this.Uee=this.Ree=this.Nwa=!1;this.pee=this.bge=this.Yce=this.Aee=null;this.VFa={};
this.$=G;this.NPc=d;this.indexedDB=w;this.Eob=I;this.Ov=ha;this.lsa=wa;this.Ke=$a;this.ZP=$c.a.Jq?Tb:new ae(G,this);this.sNg=new Gd(this,G);this.Dqg=yh.a.Ra.Kb;this.n7f="";this.S4=!1;this.Ivj(new Ed([],function(pc){Uc.W5f(pc)}));this.Hvj(new Ed([],function(pc){Uc.uLb(pc)}));this.Lvj(new Ed([],function(pc){Uc.uLb(pc)}));this.Jvj(new Ed([],function(){}));w.rg()&&(this.Nwa=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));G=!0;if(kj.a.Uue){this.cache.rg()&&(ka=this.Gdd($c.a.Y$b(this.$)),
ka.isSuccess&&(G=vi.getElapsedSeconds(ka.timeStamp,yh.a.Ra.Kb),this.Ov.Vx=new xf(!0,!0),this.oA=new xf(ka.value,!0),G=this.oA.value?604800<G:86400<G,this.Fwb=this.LKb(!0)));this.Xoi=Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery");this.NJh();if("undefined"!==typeof makerstorage&&this.Xif)if(this.n7f=Ve(this.$),Cc(this.$))nb(this.$,"localstorageToken"),this.Ov.Vx=new xf(!0,!0),this.oA=new xf(!0,!0),this.Fwb=this.LKb(!0);else if((ka=$c.a.O0e())&&makerstorage.setStorageEnvironmentOverride(ka),
G)try{this.Fwb=this.Ov.Hye().then(function(){return Ic.lsa.lbc()}).then(function(pc){return Ic.Z5h(pc)}).then(function(){return Ic.LKb(!1)}).catch(function(){return Ic.LKb(!1)})}catch(pc){Se.ULS.sendTraceTag(537170314,0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",pc.message),this.Fwb=Promise.resolve(!1)}Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&this.Fwb?this.Fwb.then(function(pc){return Ic.mKd(pc)}):
this.mKd(!1)}else Se.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.mKd(!1)}function Nd(G,ka,d,w,I,ha){this.actionName=G;this.shapeId=ka;this.scriptLink=d;this.clickId=w;this.Gba=I;this.buttonText=ha}function Tc(G,ka,d,w){this.Bkd=G;this.Mzh=ka;this.Tya=d;this.kHa=w}function Yc(G){return Wi.a.Kd(G)?Xe.a.VOe:Xe.a.UOe}function oc(G){return Wi.a.Kd(G)?G.isChromeRtl?Xe.a.Nsh:Xe.a.Msh:Xe.a.$Ia}function ze(G){G=
G.na.ta.Na(1);G.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return G}function Ae(G,ka,d,w,I){function ha(){function vd(ne,Pe,Af){return Ci.i($a.ta,"ExecuteRichApiRequest",w,ri.b(ne,ka),ri.a(Pe,d),Af,null,0)}if(wa.qHa()||0<$a.ta.j4||0<$a.Dk.j4)return!1;Tb&&wa.jv(Tb);Ic&&$a.yr(Ic);pc&&$a.Ez(pc);Gf.EwaSettings.sc()?wa.Nt(new mk.a(507,
0,vd,80)):wa.Nt(new lk.a(507,0,vd,16));return!0}var wa=G.userOperationManager,$a=G.na,Tb=null,Ic=null,pc=null;ha()||(Tb=function(){ha()},Ic=function(){ha()},pc=function(){ha()},wa.lx(Tb),$a.uq(Ic),$a.Ky(pc));return I.task}function Ve(G){if(Cc(G))return Gf.EwaSettings.getBooleanFeatureGate($c.a.IBb,!1)?"makerservicelocal":"localstorage";G=$c.a.O0e();return $c.a.KZh(G)}function nb(G,ka){Cc(G)&&(Gf.EwaSettings.getBooleanFeatureGate($c.a.IBb,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));
makerstorage.setSessionId(G.ya.UserSessionId);makerstorage.setUserAccessInfo(new Sc(ka,null));Gf.EwaSettings.getBooleanFeatureGate($c.a.ofg,!1)&&makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")}function Hc(G,ka){ka.WacTaskPaneInfra=Wi.a.Kd(G);ka.UseV1ServiceURLs=Gf.EwaSettings.getBooleanFeatureGate($c.a.ofg,!1);ka.TaskpanelessRFB=Gf.EwaSettings.getBooleanFeatureGate($c.a.d9f,!1);ka.OfficeScriptsAutomateTask=$c.a.Yyd}function Cc(G){return"TestHost"===G.ya.DocumentHostInfo.HostTier}
function Sc(G,ka){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=G;this.currentUserMlapiToken=ka}function Uc(){this.Kk=null;this.S4=this.U6=this.mt=this.T6=this.Aza=this.xab=this.RGd=this.Yca=this.Tva=!1;this.zr=this.hg=this.Hm=null}function ae(G,ka){this.ky=null;this.$=G;this.automateCommandManager=ka;return this}function ue(){}function Lf(){this.Vx=null;return this}function xf(G,ka,d,w,I){this.value=G;this.isSuccess=ka;this.timeStamp=void 0===d?null:d;this.errorCode=
void 0===w?"":w;this.errorMessage=void 0===I?"":I}function Rf(){this.Vx=null}function dc(G,ka){this.ky=null;this.$=G;this.Ke=ka;return this}function Oc(G){this.K$=Gg.b(G)||{};this.shareId=this.shareId||null}function Ed(G,ka){this.scripts=G;this.V5f=ka}function Gd(G,ka){this.automateCommandManager=G;this.$=ka}function Ee(){this.ky=null}function ee(G,ka,d){this.$=G;this.oAuthManager=ka;this.Ov=d;this.zob=new hf;this.ote=this.oAuthManager&&null==this.oAuthManager.TLa()?!1:this.oAuthManager.TLa()}function hf(){this.token=
null;this.timeStamp=0}function kf(G){return Zj.call(this,G)||this}function rf(G,ka){this.automateCommandManager=G;this.$=ka}function ng(G){var ka=fj.call(this)||this;ka.$=G;ka.dc();return ka}function je(G){this.Eb=null;this.$=G}function bg(){return R.call(this)||this}function ig(){return R.call(this)||this}function Yd(){return R.call(this)||this}function If(){return R.call(this)||this}function Pd(){return R.call(this)||this}function Ze(){return R.call(this)||this}function Yf(){return R.call(this)||
this}function Xf(){return R.call(this)||this}function rg(){return R.call(this)||this}function uf(){return R.call(this)||this}function kg(){return R.call(this)||this}function qh(){return R.call(this)||this}function La(){return R.call(this)||this}function Db(){return R.call(this)||this}function uc(){return R.call(this)||this}function Vc(){return R.call(this)||this}function yd(){return R.call(this)||this}function Md(){return R.call(this)||this}function qe(){return R.call(this)||this}function ac(){return R.call(this)||
this}function Kc(){return R.call(this)||this}function dd(){return R.call(this)||this}function Ud(){return R.call(this)||this}function Le(){return R.call(this)||this}function ce(){return R.call(this)||this}function Nf(){return R.call(this)||this}function af(){return R.call(this)||this}function wf(){return R.call(this)||this}function vf(){return R.call(this)||this}function pg(){return R.call(this)||this}function bf(){return R.call(this)||this}function Bf(){return R.call(this)||this}function $e(){return R.call(this)||
this}function He(){return R.call(this)||this}function vg(){return R.call(this)||this}function ah(){return R.call(this)||this}function Ph(){return R.call(this)||this}function Pf(){return R.call(this)||this}function Da(){return R.call(this)||this}function Fb(){return R.call(this)||this}function Lc(){return R.call(this)||this}function ud(){return R.call(this)||this}function zd(){return R.call(this)||this}function Ce(){return R.call(this)||this}function Ge(){return R.call(this)||this}function gf(){return R.call(this)||
this}function Df(){return R.call(this)||this}function Ea(){return R.call(this)||this}function kb(){return R.call(this)||this}function Vb(){return R.call(this)||this}function Qc(){return R.call(this)||this}function Mc(){return R.call(this)||this}function Ab(){return R.call(this)||this}function nc(){return R.call(this)||this}function Rd(){return R.call(this)||this}function Je(){return R.call(this)||this}function he(){return R.call(this)||this}function Ff(){return Kf.call(this,195,16)||this}function Fe(){return Kf.call(this,
194,8)||this}function Tf(){return R.call(this)||this}function Hd(){return Kf.call(this,198,2)||this}function Ye(){return Kf.call(this,197,1)||this}function Fd(){return Kf.call(this,196,32)||this}function ve(){return R.call(this)||this}function jg(){return Kf.call(this,193,4)||this}function Kf(G,ka){var d=R.call(this)||this;d.Afa=G;d.tZd=ka;return d}function td(){return R.call(this)||this}function qf(){return R.call(this)||this}function Ch(){return R.call(this)||this}function Uf(){return R.call(this)||
this}function Rg(){return R.call(this)||this}function Od(){return R.call(this)||this}function gh(){return sb.call(this,11,16)||this}function fi(){return sb.call(this,10,128)||this}function hh(){return R.call(this)||this}function ye(){return R.call(this)||this}function Dg(){return R.call(this)||this}function Jf(){return R.call(this)||this}function Ne(){return R.call(this)||this}function gi(){return R.call(this)||this}function kh(){return R.call(this)||this}function Vf(){return R.call(this)||this}function ti(){return R.call(this)||
this}function Kh(){return sb.call(this,9,2)||this}function Jh(){return sb.call(this,8,1)||this}function nh(){return sb.call(this,7,8)||this}function ih(){return sb.call(this,6,32)||this}function dh(){return R.call(this)||this}function Qh(){return R.call(this)||this}function xh(){return R.call(this)||this}function Xg(){return R.call(this)||this}function Lg(){return R.call(this)||this}function hi(){return R.call(this)||this}function Lh(){return R.call(this)||this}function Kg(){return R.call(this)||
this}function ai(){return R.call(this)||this}function Fh(){return R.call(this)||this}function Sg(){return R.call(this)||this}function zg(){return R.call(this)||this}function wh(){return R.call(this)||this}function ch(){return R.call(this)||this}function Bg(){return sb.call(this,4,64)||this}function Ah(){return R.call(this)||this}function eg(){return R.call(this)||this}function Mh(){return R.call(this)||this}function pi(){return R.call(this)||this}function mg(){return R.call(this)||this}function si(){return R.call(this)||
this}function Wh(){return R.call(this)||this}function qg(){}function Ca(){return R.call(this)||this}function ua(){return sb.call(this,3,4)||this}function sb(G,ka){var d=R.call(this)||this;d.Afa=G;d.tZd=ka;return d}function Ld(){return R.call(this)||this}function le(){return R.call(this)||this}function nf(){return R.call(this)||this}function ug(){return R.call(this)||this}function Cf(){return E.call(this,185,18)||this}function Cg(){return R.call(this)||this}function Ag(){return E.call(this,181,14)||
this}function eh(){return E.call(this,169,2)||this}function jh(){return E.call(this,168,1)||this}function Pg(){return R.call(this)||this}function te(){return E.call(this,182,15)||this}function Fg(){return R.call(this)||this}function og(){return R.call(this)||this}function mh(){return E.call(this,180,13)||this}function cg(){return E.call(this,186,19)||this}function li(){return E.call(this,175,8)||this}function fh(){return E.call(this,176,9)||this}function pf(){return E.call(this,187,20)||this}function Qf(){return E.call(this,
174,7)||this}function $g(){return E.call(this,179,12)||this}function yg(){return E.call(this,178,11)||this}function lh(){return E.call(this,177,10)||this}function h(){return R.call(this)||this}function Bb(){return E.call(this,170,3)||this}function qc(){return E.call(this,172,5)||this}function W(){return E.call(this,173,6)||this}function va(){return E.call(this,183,16)||this}function N(){return E.call(this,184,17)||this}function k(){return E.call(this,171,4)||this}function E(G,ka){var d=R.call(this)||
this;d.Afa=G;d.opType=ka;return d}function M(){return R.call(this)||this}function aa(){return R.call(this)||this}function na(){return R.call(this)||this}function qb(){return R.call(this)||this}function Pb(){return R.call(this)||this}function Jc(){return R.call(this)||this}function ad(){return R.call(this)||this}function ia(){return R.call(this)||this}function Qa(){return R.call(this)||this}function Nb(){return R.call(this)||this}function tc(){return R.call(this)||this}function gd(){return R.call(this)||
this}function Rc(){return R.call(this)||this}function Xd(){return R.call(this)||this}function pe(){return R.call(this)||this}function cf(){return R.call(this)||this}function ef(){return R.call(this)||this}function jf(){return R.call(this)||this}function yf(){return R.call(this)||this}function Eg(){return R.call(this)||this}function rh(){return R.call(this)||this}function Eh(){return Te.call(this)||this}function Qg(){return R.call(this)||this}function Ng(){return R.call(this)||this}function Hh(){return R.call(this)||
this}function Tg(){return R.call(this)||this}function tg(){return R.call(this)||this}function ii(){return R.call(this)||this}function Ki(){return R.call(this)||this}function $i(){return R.call(this)||this}function Y(){return R.call(this)||this}function Ra(){return Ef.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function xb(){return Ef.call(this,79,[0,1,2,-102])||
this}function fc(){return Ef.call(this,75,[-101])||this}function bd(){return Ef.call(this,81,[100,101,102,103,104,105,106])||this}function Dd(){return R.call(this)||this}function Td(){return Ef.call(this,85,[328,329,330,331,332,333,334,335])||this}function we(){return Te.call(this)||this}function Oe(G,ka,d){this.response=this.request=this.eventId=this.source=null;G&&(this.source=G.source,this.eventId=G.eventId,this.request=ka,this.response=d)}function Te(){return R.call(this)||this}function Zf(){return Ef.call(this,
83,[500,501,502])||this}function dg(){return Ef.call(this,76,[-100])||this}function Jg(){return Ef.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function Ug(){return Ef.call(this,80,[-104,-103,300,301,302,303,304,305,306,307,308,309,310,311])||this}function Xh(){return Ef.call(this,84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function Ef(G,ka){var d=R.call(this)||this;d.Afa=G;d.fWj=ka;return d}function Th(){return R.call(this)||this}function sh(){return R.call(this)||
this}function Mg(){return R.call(this)||this}function Hi(){return R.call(this)||this}function R(){this.eIc=this.fIc=this.fOc=this.JSc=null}function Aa(G,ka,d){var w=this;this.F9b=null;this.kyi=function(I,ha){w.P2f()&&w.hbd(ha)};this.tpf=ka;this.qpf=d;this.$=G;this.$.Aba&&this.$.kGg(this.kyi);G.da.Ha(297,this)}function hb(){}function Ib(){}function Bc(){this.Cgb=null}function gc(){this.tb=null}function Id(G){this._initialized=!1;this.k$a={};this.Jyc={};this.OO=fg.AFrameworkApplication.sa.xD;this.Akd=
G}function fe(G,ka,d){this.expiration=this.authority=this.accessToken=null;this.accessToken=G;this.authority=ka;this.expiration=d}function sf(){this.authority=this.email=this.displayName=null;this.authority=this.email=this.displayName=""}function hg(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}function $f(){}
function th(G,ka){this.requestCallback=this.requestParameters=null;this.requestParameters=G;this.requestCallback=ka}function ji(){}b.r(F);var aj=b(516),Uj=b(1088),de=b(0),Se=b(13),Qi=b(80),Nh;(function(G){G[G.generalException=0]="generalException";G[G.invalidArgument=1]="invalidArgument";G[G.notAllowed=2]="notAllowed";G[G.apiNotAvailable=3]="apiNotAvailable";G[G.unresolvedPendingRequest=4]="unresolvedPendingRequest";G[G.timeout=5]="timeout";G[G.adalTimeout=6]="adalTimeout";G[G.userNotSignedIn=7]=
"userNotSignedIn";G[G.userAborted=8]="userAborted";G[G.silentSignInFailed=9]="silentSignInFailed";G[G.invalidResourceUrl=10]="invalidResourceUrl";G[G.invalidGrant=11]="invalidGrant";G[G.connectionLost=12]="connectionLost";G[G.clientError=13]="clientError";G[G.serverError=14]="serverError"})(Nh||(Nh={}));Object(de.b)("ErrorCodes",Nh);ji.IFf="OneDriveWOPI";Object(de.a)(ji,"HostApplicationType",null,[]);Object(de.a)(th,"OutstandingRequest",null,[]);$f.jEi="AADSTS50058";$f.invalidResourceUrl="AADSTS50001";
$f.dEi="AADSTS65001";$f.vEi="AADSTS70011";$f.userAborted="13002";$f.V_i="Popup Window is null";$f.U_i="Popup Window closed";$f.adalTimeout="Token renewal operation failed due to timeout";$f.dMj="tokenRevoked";Object(de.a)($f,"WopiHostErrorType",null,[]);var fg=b(5),bi=b(857),Li=b(592),Rh=b(40);hg.zKh=function(G){switch(G){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object(de.a)(hg,"WopiAuthContext",null,[493]);Object(de.a)(sf,"WopiIdentityInfo",null,[494]);
Object(de.a)(fe,"WopiIdentityToken",null,[456]);var kj=b(23),Uh=b(151),bj=b(373),sg=b(170),Mf=b(75),Yh=b(337);Id.prototype.Y1a=function(G){this._initialized||(G.Zn(sg.a.AIf),G.Kl(sg.a.AIf,Object(Qi.a)(this,this.uRi,"onReceivedAccessToken")),this._initialized=!0)};Id.prototype.getAccessToken=function(G,ka,d){var w=this;d=void 0===d?null:d;this.KNa(G,ka);return new Promise(function(I,ha){if(w.Smd(ka))if(ka in w.k$a)ha("unresolvedPendingRequest");else{var wa=window.setTimeout(function(){var Tb={};Se.ULS.sendTraceTag(37856032,
344,10,Rh.c((Tb.error="Request timeout.",Tb.callerId=ka,Tb)));ha("timeout")},12E4);w.edd(G,ka,d,function(Tb,Ic){window.clearTimeout(wa);Tb?I(Tb):(Tb={},Se.ULS.sendTraceTag(37856033,369,15,Rh.c((Tb.error=Nh[Ic],Tb))),ha(Ic))})}else{var $a={};Se.ULS.sendTraceTag(37856034,344,10,Rh.c(($a.error="Caller is not allowed.",$a)));ha("notAllowed")}})};Id.prototype.getPrimaryIdentityInfo=function(G){var ka=this;return new Promise(function(d,w){if(ka.Smd(G))ka.nWh(function(ha,wa){ha?d(ha):(ha={},Se.ULS.sendTraceTag(37856064,
369,10,Rh.c((ha.error=wa.toString(),ha))),w(wa))});else{var I={};Se.ULS.sendTraceTag(37856065,344,10,Rh.c((I.error="Caller is not allowed.",I)));w("notAllowed")}})};Id.prototype.getAuthContext=function(G){var ka=this;return new Promise(function(d,w){var I=ka.getAuthContextSync(G);I?d(I):w("notAllowed")})};Id.prototype.getAuthContextSync=function(G){if(this.Smd(G)){var ka=new hg;ka.upn=fg.AFrameworkApplication.ga.Ua("UserPrincipalName");ka.userId=fg.AFrameworkApplication.ga.Ua("LoggableUserId");ka.authority=
fg.AFrameworkApplication.ga.Ua("HostAuthAuthority");ka.tenantId=fg.AFrameworkApplication.ga.Ua("TenantId");ka.isAnonymous=fg.AFrameworkApplication.ga.ra("IsAnonymousUser");ka.supportsAuthToken=this.A8h(G);G=fg.AFrameworkApplication.ga.Ua("HostAuthType");ka.authorityType="aad"===G.toLowerCase()?2:"msa"===G.toLowerCase()?1:0;return ka}ka={};Se.ULS.sendTraceTag(40751647,344,10,Rh.c((ka.error="Caller is not allowed.",ka)));return null};Id.prototype.A8h=function(G){var ka=bi.a.hxb;return kj.a.ala?ka&&
bi.a.i9f?Array.contains(bi.a.i9f,G.toLowerCase()):!1:ka};Id.prototype.edd=function(G,ka,d,w){var I=this,ha=[];Array.add(ha,Object.assign(new Mf.a,{name:"CallerId",string:ka}));Array.add(ha,Object.assign(new Mf.a,{name:bj.a.kTd,string:G.correlationId}));Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:ha}));ha=Li.a.create().toString();var wa="getAccessToken_"+ha,$a=this.OO.Hc("ComponentAttach",wa);this.Jyc[wa]=$a;var Tb=
{};Tb[bj.a.lTd]=ha;Tb[bj.a.GFj]=G.resource;Tb[bj.a.HFj]=G.scope;Tb[bj.a.l6f]=fg.AFrameworkApplication.ga.Ua("HostAuthType");Tb[bj.a.KFj]=fg.AFrameworkApplication.ga.Ua("UserPrincipalName");Tb[bj.a.IFj]=G.silentLogin;Tb[bj.a.DFj]=G.options;Tb[bj.a.kTd]=G.correlationId;Tb[bj.a.EFj]=ka;d&&(Tb[bj.a.addinName]=d.AddinName,Tb[bj.a.CFj]=d.AddinTrustId);this.Akd.execute(function(Ic){I.Y1a(Ic);Ic.Sj(sg.a.getAuthToken,Tb)});this.k$a[ha]=new th(G,w)};Id.prototype.nWh=function(G){var ka=fg.AFrameworkApplication.ga.Ua("UserName"),
d=fg.AFrameworkApplication.ga.Ua("UserPrincipalName"),w=fg.AFrameworkApplication.ga.Ua("LoggableUserIdSpace"),I=new sf;I.email=d;I.displayName=ka;switch(w){case "OrgIdPuid":I.authority="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":I.authority="MicrosoftAccount";break;default:I.authority=w}G(I,null)};Id.prototype.uRi=function(G){var ka=null;try{var d=G.Values[bj.a.lTd],w=G.Values[bj.a.BFj],I=G.Values[bj.a.l6f],ha=G.Values[bj.a.JFj],wa=null,$a=null,Tb=this.k$a[d];if("undefined"!==
typeof Tb&&Tb){var Ic=[];Array.add(Ic,Object.assign(new Mf.a,{name:bj.a.kTd,string:Tb.requestParameters.correlationId}));Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",dataFields:Ic}));ka=Tb.requestCallback;delete this.k$a[d];"undefined"!==typeof w&&w&&w.length?$a=new fe(w,I,ha):wa=Nh[this.czi(G)];d="getAccessToken_"+d;d in this.Jyc&&(this.Jyc[d].stop(),delete this.Jyc[d]);ka($a,wa)}else wa={},Se.ULS.sendTraceTag(37856066,344,
10,Rh.c((wa.error="No matching outstanding request for request ID.",wa.requestId=d,wa)))}catch(pc){G=G.Values[bj.a.lTd],G in this.k$a&&delete this.k$a[G],this.Njc(),G={},Se.ULS.sendTraceTag(37856067,344,10,Rh.c((G.error=pc.message,G.stack=pc.stack,G))),ka&&ka(null,"generalException")}};Id.prototype.Smd=function(G){var ka=fg.AFrameworkApplication.Z1h();G=G.toLowerCase();ka=yl(ka);for(var d=ka.next();!d.done;d=ka.next())if(G===d.value.toLowerCase())return!0;ka=bi.a.wWc;for(var w in ka)if(G===ka[w].toLowerCase())return!0;
return!1};Id.prototype.czi=function(G){G=G.Values[bj.a.FFj];this.Njc();var ka={};Se.ULS.sendTraceTag(39068821,344,15,Rh.c((ka.error=G,ka)));return G?-1<G.indexOf($f.jEi)?9:-1<G.indexOf($f.V_i)||-1<G.indexOf($f.U_i)?12:-1<G.indexOf($f.invalidResourceUrl)?10:-1<G.indexOf($f.userAborted)?8:-1<G.indexOf($f.vEi)||-1<G.indexOf($f.dEi)||G===$f.dMj?11:-1<G.indexOf($f.adalTimeout)?6:0:13};Id.prototype.KNa=function(G,ka){G=this.n8i(G.resource);var d={};Se.ULS.sendTraceTag(39921882,344,50,Rh.c((d.callerId=ka,
d.resource=G,d)))};Id.prototype.Njc=function(){var G={};Se.ULS.sendTraceTag(39068822,344,50,Rh.c((G.userAgent=window.navigator.userAgent,G)))};Id.prototype.n8i=function(G){return(G?G:"").replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Object(de.a)(Id,"WopiIdentityManager",null,[434]);var Bi=b(273);gc.prototype.ji=function(G){this.tb=G;G.register(Id,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").Bc().Lc(function(){return new Id(G.oc("Postmessage.IHostPostmessenger"))})};
gc.prototype.init=function(){fg.AFrameworkApplication.ga&&fg.AFrameworkApplication.ga.ow(Object(Qi.a)(this,this.lB,"onFullAppSettingsReady"))};gc.prototype.lB=function(){try{this.tb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(G){Se.ULS.sendTraceTag(571074327,383,10,"Failed to initialize WopiIdentityPackage with exception: "+G)}};gc.prototype.dispose=function(){};gc.main=function(){Bi.a.instance.sj(new gc)};Sk.Object.defineProperties(gc.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});
Object(de.a)(gc,"WopiIdentityPackage",null,[4,5]);var Ih=b(10),Vg=b(214),ph=b(184),uj=b(604);Bc.prototype.Ufi=function(G){return this.UNg.contains(G.operation)};Bc.prototype.CPj=function(G){for(var ka=[],d=yl(G.payload.batchedOperations),w=d.next();!w.done;w=d.next())ka.push(new uj.a(G.operation,w.value));return ka};Sk.Object.defineProperties(Bc.prototype,{UNg:{configurable:!0,enumerable:!0,get:function(){this.Cgb||(this.Cgb=new ph.a,this.Cgb.add(12),this.Cgb.add(11));return this.Cgb}}});Object(de.a)(Bc,
"MacroRecorderBatchedEventList",null,[]);var cj=b(54),Vj=b(120),Jj=b(686);Ib.prototype.equals=function(G,ka){return G===ka};Ib.prototype.getHashCode=function(G){return G};Ib.prototype.Eja=function(G){return G};Object(de.a)(Ib,"UserOperationNameComparer",null,[103,104]);hb.X1h=function(){hb.Pc||(hb.Pc=new Jj.a(new Ib),hb.Pc.add(507),hb.Pc.add(10),hb.Pc.add(576),hb.Pc.add(563),hb.Pc.add(564),hb.Pc.add(565),hb.Pc.add(566),hb.Pc.add(567),hb.Pc.add(568),hb.Pc.add(569),hb.Pc.add(570),hb.Pc.add(571),hb.Pc.add(572),
hb.Pc.add(573),hb.Pc.add(574),hb.Pc.add(575),hb.Pc.add(501),hb.Pc.add(520),hb.Pc.add(1),hb.Pc.add(1002),hb.Pc.add(129),hb.Pc.add(198),hb.Pc.add(500),hb.Pc.add(519),hb.Pc.add(538),hb.Pc.add(1E3),hb.Pc.add(1003),hb.Pc.add(144),hb.Pc.add(502),hb.Pc.add(505),hb.Pc.add(179),hb.Pc.add(205),hb.Pc.add(134),hb.Pc.add(230),hb.Pc.add(103),hb.Pc.add(110),hb.Pc.add(112),hb.Pc.add(113),hb.Pc.add(124),hb.Pc.add(133),hb.Pc.add(154),hb.Pc.add(162),hb.Pc.add(168),hb.Pc.add(172),hb.Pc.add(201),hb.Pc.add(222),hb.Pc.add(227),
hb.Pc.add(513),hb.Pc.add(534),hb.Pc.add(539),hb.Pc.add(545),hb.Pc.add(600),hb.Pc.add(547),hb.Pc.add(555),hb.Pc.add(558),hb.Pc.add(562),hb.Pc.add(585),hb.Pc.add(1001),hb.Pc.add(1005),hb.Pc.add(1008),hb.Pc.add(1010),hb.Pc.add(1011),hb.Pc.add(1012),hb.Pc.add(1018),hb.Pc.add(252),hb.Pc.add(253),hb.Pc.add(258),hb.Pc.add(101),hb.Pc.add(102),hb.Pc.add(108),hb.Pc.add(118),hb.Pc.add(257),hb.Pc.add(119),hb.Pc.add(120),hb.Pc.add(123),hb.Pc.add(126),hb.Pc.add(127),hb.Pc.add(130),hb.Pc.add(140),hb.Pc.add(159),
hb.Pc.add(160),hb.Pc.add(165),hb.Pc.add(166),hb.Pc.add(167),hb.Pc.add(169),hb.Pc.add(189),hb.Pc.add(223),hb.Pc.add(214),hb.Pc.add(228),hb.Pc.add(233),hb.Pc.add(247),hb.Pc.add(504),hb.Pc.add(511),hb.Pc.add(512),hb.Pc.add(525),hb.Pc.add(533),hb.Pc.add(537),hb.Pc.add(542),hb.Pc.add(544),hb.Pc.add(548),hb.Pc.add(550),hb.Pc.add(551),hb.Pc.add(552),hb.Pc.add(554),hb.Pc.add(577),hb.Pc.add(584),hb.Pc.add(586),hb.Pc.add(587),hb.Pc.add(588),hb.Pc.add(592),hb.Pc.add(1009),hb.Pc.add(1016),hb.Pc.add(1017));return hb.Pc};
hb.Pc=null;Object(de.a)(hb,"MacroRecorderUnrecognizedEventList",null,[]);Aa.prototype.init=function(G){this.$.Aba&&(G?this.F9b=G:Se.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};Aa.prototype.hbd=function(G){if(this.P2f())try{if(this.qpf.Ufi(G))for(var ka=this.qpf.CPj(G),d=yl(ka),w=d.next();!w.done;w=d.next())this.DUe(w.value);else this.DUe(G)}catch(I){G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",
Vj.a(G.operation),I.stack),Se.ULS.sendTraceTag(537155423,0,10,G)}};Aa.prototype.DUe=function(G){var ka=this.tpf.M0e(G,!0);ka?(this.F9b(ka.eventId,cj.a.Kc(G.payload)),G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",ka.eventId),Se.ULS.sendTraceTag(537155422,0,50,G)):(ka=this.tpf.M0e(G,!1))?(G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",ka.eventId),Se.ULS.sendTraceTag(537155421,0,50,G)):hb.X1h().contains(G.operation)||
(this.F9b(0,cj.a.Kc(G.operation)),G=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",Vj.a(G.operation)),Se.ULS.sendTraceTag(537155420,0,50,G))};Aa.prototype.P2f=function(){return this.$.Qka&&this.F9b&&this.$.wba?!0:!1};Object(de.a)(Aa,"MacroRecorderEventHandler",null,[438]);var Gf=b(1);R.prototype.qg=function(){};R.prototype.pwa=function(){};R.prototype.zd=function(G){this.tCc.add(G)};R.prototype.Ub=function(G){this.operations.contains(G)||this.operations.add(G)};
R.prototype.$mb=function(){this.featureGates.add(702)};R.prototype.bme=function(G){this.ZSe.add(G)};Sk.Object.defineProperties(R.prototype,{operations:{configurable:!0,enumerable:!0,get:function(){this.fOc||(this.fOc=new ph.a,this.ic());return this.fOc}},tCc:{configurable:!0,enumerable:!0,get:function(){this.JSc||(this.JSc=new ph.a,this.qg());return this.JSc}},ZSe:{configurable:!0,enumerable:!0,get:function(){this.eIc||(this.eIc=new ph.a);return this.eIc}},featureGates:{configurable:!0,enumerable:!0,
get:function(){this.fIc||(this.fIc=new ph.a,this.pwa());return this.fIc}}});Object(de.a)(R,"MacroRecorderEventBase",null,[]);vm(Hi,R);Hi.prototype.ic=function(){this.Ub(100)};Sk.Object.defineProperties(Hi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 130}}});Object(de.a)(Hi,"AccessibilityCheckRunEvent",R,[]);vm(Mg,R);Mg.prototype.ic=function(){this.Ub(241)};Mg.prototype.qg=function(){this.zd(function(G){return G.addToPrintArea})};Sk.Object.defineProperties(Mg.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 160}}});Object(de.a)(Mg,"AddedToPrintAreaEvent",R,[]);vm(sh,R);sh.prototype.ic=function(){this.Ub(516)};Sk.Object.defineProperties(sh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 65}}});Object(de.a)(sh,"AutoFilterToggledEvent",R,[]);vm(Th,R);Th.prototype.ic=function(){this.Ub(502)};Th.prototype.qg=function(){this.zd(function(G){return!(G.l4a().FirstColumn===G.l4a().LastColumn&&G.l4a().FirstRow===G.l4a().LastRow)})};Sk.Object.defineProperties(Th.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object(de.a)(Th,"AutoSumEvent",R,[]);vm(Ef,R);Ef.prototype.ic=function(){this.Ub(529);this.Ub(594)};Ef.prototype.qg=function(){var G=this;this.zd(function(ka){return Array.contains(G.fWj,ka.egd())})};Sk.Object.defineProperties(Ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Afa}}});Object(de.a)(Ef,"ChartPropertyAppliedEventBase",R,[]);vm(Xh,Ef);Object(de.a)(Xh,"ChartAxisChangedEvent",Ef,[]);vm(Ug,
Ef);Object(de.a)(Ug,"ChartAxisTitleChangedEvent",Ef,[]);vm(Jg,Ef);Object(de.a)(Jg,"ChartDataLabelsChangedEvent",Ef,[]);vm(dg,Ef);Object(de.a)(dg,"ChartDataSelectedEvent",Ef,[]);vm(Zf,Ef);Object(de.a)(Zf,"ChartDataTableChangedEvent",Ef,[]);var Oh=b(574),Ej=b(411),Vh=b(84);vm(Te,R);Object(de.a)(Te,"RichApiRequestExecutedEventBase",R,[]);Sk.Object.defineProperties(Oe.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||
null===this.eventId)&&!0}}});Object(de.a)(Oe,"MacroRecorderRichApiRequestExecutedPayload",null,[147]);vm(we,Te);we.prototype.oF=function(G){we.Y6||(we.Y6=new Jj.a(Oh.a.Hk()),we.Y6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),we.Y6.add("fa000000014"));return!!G&&we.Y6.contains(G.toLowerCase())};we.prototype.ic=function(){this.Ub(507);this.Ub(10);this.Ub(576)};we.prototype.qg=function(){var G=this;this.zd(function(ka){return Object(Ej.a)(Oe,ka)&&(ka=Object(Vh.a)(Oe,ka),ka.isValid&&G.oF(ka.source))?(Se.ULS.sendTraceTag(537155427,
0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",ka.eventId),!0):!1})};Sk.Object.defineProperties(we.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 117}}});we.Y6=null;Object(de.a)(we,"ChartFormatRichApiRequestExecutedEvent",Te,[]);vm(Td,Ef);Object(de.a)(Td,"ChartGridlinesChangedEvent",Ef,[]);vm(Dd,R);Dd.prototype.ic=function(){this.Ub(528)};Sk.Object.defineProperties(Dd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});
Object(de.a)(Dd,"ChartInsertedEvent",R,[]);vm(bd,Ef);Object(de.a)(bd,"ChartLegendChangedEvent",Ef,[]);vm(fc,Ef);Object(de.a)(fc,"ChartRowColumnSwitchedEvent",Ef,[]);vm(xb,Ef);Object(de.a)(xb,"ChartTitleChangedEvent",Ef,[]);vm(Ra,Ef);Object(de.a)(Ra,"ChartTypeChangedEvent",Ef,[]);vm(Y,R);Y.prototype.ic=function(){this.Ub(521)};Sk.Object.defineProperties(Y.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object(de.a)(Y,"ConnectorFloatingObjectResizedEvent",R,[]);vm($i,
R);$i.prototype.ic=function(){this.Ub(109)};Sk.Object.defineProperties($i.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object(de.a)($i,"EntitySelectedEvent",R,[]);vm(Ki,R);Ki.prototype.ic=function(){this.Ub(149);this.Ub(147)};Sk.Object.defineProperties(Ki.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object(de.a)(Ki,"FindCellEvent",R,[]);vm(ii,R);ii.prototype.ic=function(){this.Ub(122)};Sk.Object.defineProperties(ii.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 96}}});Object(de.a)(ii,"FloatingObjectAltTextAppliedEvent",R,[]);vm(tg,R);tg.prototype.ic=function(){this.Ub(522)};Sk.Object.defineProperties(tg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object(de.a)(tg,"FloatingObjectDeletedEvent",R,[]);vm(Tg,R);Tg.prototype.ic=function(){this.Ub(524)};Sk.Object.defineProperties(Tg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object(de.a)(Tg,"FloatingObjectMovedAndResizedEvent",
R,[]);vm(Hh,R);Hh.prototype.ic=function(){this.Ub(523)};Sk.Object.defineProperties(Hh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 95}}});Object(de.a)(Hh,"FloatingObjectRotatedEvent",R,[]);vm(Ng,R);Ng.prototype.ic=function(){this.Ub(543)};Sk.Object.defineProperties(Ng.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object(de.a)(Ng,"GroupDetailsShownOrHiddenEvent",R,[]);vm(Qg,R);Qg.prototype.ic=function(){this.Ub(125)};Sk.Object.defineProperties(Qg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object(de.a)(Qg,"HyperlinksRemovedFromRangeEvent",R,[]);vm(Eh,Te);Eh.prototype.oF=function(G){Eh.Y6||(Eh.Y6=new Jj.a(Oh.a.Hk()),Eh.Y6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Eh.Y6.add("fa000000005"));return!!G&&Eh.Y6.contains(G.toLowerCase())};Eh.prototype.ic=function(){this.Ub(507);this.Ub(10);this.Ub(576)};Eh.prototype.qg=function(){var G=this;this.zd(function(ka){return Object(Ej.a)(Oe,ka)?(ka=Object(Vh.a)(Oe,ka),ka.isValid&&
G.oF(ka.source)):!1})};Sk.Object.defineProperties(Eh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});Eh.Y6=null;Object(de.a)(Eh,"IdeasRichApiRequestExecutedEvent",Te,[]);vm(rh,R);rh.prototype.ic=function(){this.Ub(115)};Sk.Object.defineProperties(rh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});Object(de.a)(rh,"LinkedEntityConvertedEvent",R,[]);vm(Eg,R);Eg.prototype.ic=function(){this.Ub(114)};Sk.Object.defineProperties(Eg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object(de.a)(Eg,"LinkedEntityDisambiguationPaneToggledEvent",R,[]);vm(yf,R);yf.prototype.ic=function(){this.Ub(119)};Sk.Object.defineProperties(yf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object(de.a)(yf,"MovedToEdgeEvent",R,[]);vm(jf,R);jf.prototype.ic=function(){this.Ub(191)};jf.prototype.pwa=function(){this.$mb()};Sk.Object.defineProperties(jf.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 135}}});Object(de.a)(jf,"NamedSheetViewCreatedEvent",R,[]);vm(ef,R);ef.prototype.ic=function(){this.Ub(200)};ef.prototype.pwa=function(){this.$mb()};Sk.Object.defineProperties(ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object(de.a)(ef,"NamedSheetViewDeletedEvent",R,[]);vm(cf,R);cf.prototype.ic=function(){this.Ub(192)};cf.prototype.pwa=function(){this.$mb()};Sk.Object.defineProperties(cf.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 133}}});Object(de.a)(cf,"NamedSheetViewExitedEvent",R,[]);vm(pe,R);pe.prototype.ic=function(){this.Ub(199)};pe.prototype.pwa=function(){this.$mb()};Sk.Object.defineProperties(pe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object(de.a)(pe,"NamedSheetViewRenamedEvent",R,[]);vm(Xd,R);Xd.prototype.ic=function(){this.Ub(195)};Xd.prototype.pwa=function(){this.$mb()};Sk.Object.defineProperties(Xd.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 167}}});Object(de.a)(Xd,"NamedSheetViewSwitchedEvent",R,[]);vm(Rc,R);Rc.prototype.ic=function(){this.Ub(174)};Sk.Object.defineProperties(Rc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object(de.a)(Rc,"OutlineLevelSetEvent",R,[]);vm(gd,R);gd.prototype.ic=function(){this.Ub(244)};Sk.Object.defineProperties(gd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object(de.a)(gd,"PageBreakInsertedEvent",R,[]);vm(tc,R);
tc.prototype.ic=function(){this.Ub(245)};Sk.Object.defineProperties(tc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});Object(de.a)(tc,"PageBreakRemovedEvent",R,[]);vm(Nb,R);Nb.prototype.ic=function(){this.Ub(246)};Sk.Object.defineProperties(Nb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object(de.a)(Nb,"PageBreaksAllResetEvent",R,[]);vm(Qa,R);Qa.prototype.ic=function(){this.Ub(503)};Qa.prototype.qg=function(){this.zd(function(G){return!!G.pasteParameters.ClientEstimationFloatingObjectId&&
2===G.pasteParameters.CopyPasteTargetType&&!G.isFromCurrentSession})};Sk.Object.defineProperties(Qa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object(de.a)(Qa,"PasteArtOtherWorkbookEvent",R,[]);vm(ia,R);ia.prototype.ic=function(){this.Ub(503)};ia.prototype.qg=function(){this.zd(function(G){return!!G.pasteParameters.ClientEstimationFloatingObjectId&&2===G.pasteParameters.CopyPasteTargetType&&G.isFromCurrentSession})};Sk.Object.defineProperties(ia.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 52}}});Object(de.a)(ia,"PasteArtSameWorkbookEvent",R,[]);vm(ad,R);ad.prototype.ic=function(){this.Ub(204)};Sk.Object.defineProperties(ad.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object(de.a)(ad,"PasteHtmlEvent",R,[]);vm(Jc,R);Jc.prototype.ic=function(){this.Ub(506)};Sk.Object.defineProperties(Jc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object(de.a)(Jc,"PasteRangeEvent",R,[]);vm(Pb,R);Pb.prototype.ic=
function(){this.Ub(503)};Pb.prototype.qg=function(){this.zd(function(G){return 1===G.pasteParameters.CopyPasteTargetType})};Sk.Object.defineProperties(Pb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object(de.a)(Pb,"PasteShadowWorkbookRangeEvent",R,[]);vm(qb,R);qb.prototype.ic=function(){this.Ub(180)};Sk.Object.defineProperties(qb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object(de.a)(qb,"PasteStringEvent",R,[]);vm(na,R);na.prototype.ic=
function(){this.Ub(220)};Sk.Object.defineProperties(na.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 134}}});Object(de.a)(na,"PendingMergeEvent",R,[]);vm(aa,R);aa.prototype.ic=function(){this.Ub(510)};Sk.Object.defineProperties(aa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object(de.a)(aa,"PictureInsertedEvent",R,[]);vm(M,R);M.prototype.ic=function(){this.Ub(161)};Sk.Object.defineProperties(M.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 153}}});Object(de.a)(M,"PivotDrillToggledEvent",R,[]);vm(E,R);E.prototype.ic=function(){this.Ub(225)};E.prototype.qg=function(){var G=this;this.zd(function(ka){return ka.opType===G.opType})};Sk.Object.defineProperties(E.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Afa}}});Object(de.a)(E,"PivotTableSettingsChangedEventBase",R,[]);vm(k,E);Object(de.a)(k,"PivotTableAllItemLabelsRepeatedEvent",E,[]);vm(N,E);Object(de.a)(N,"PivotTableAltTextDescriptionChangedEvent",
E,[]);vm(va,E);Object(de.a)(va,"PivotTableAltTextTitleChangedEvent",E,[]);vm(W,E);Object(de.a)(W,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",E,[]);vm(qc,E);Object(de.a)(qc,"PivotTableBlankLineAfterEachItemToggledEvent",E,[]);vm(Bb,E);Object(de.a)(Bb,"PivotTableColumnGrandTotalShownEvent",E,[]);vm(h,R);h.prototype.ic=function(){this.Ub(132)};Sk.Object.defineProperties(h.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object(de.a)(h,"PivotTableCreatedEvent",R,
[]);vm(lh,E);Object(de.a)(lh,"PivotTableDisplayErrorStringToggledEvent",E,[]);vm(yg,E);Object(de.a)(yg,"PivotTableDisplayNullStringToggledEvent",E,[]);vm($g,E);Object(de.a)($g,"PivotTableErrorStringChangedEvent",E,[]);vm(Qf,E);Object(de.a)(Qf,"PivotTableExpandCollapseButtonsShownEvent",E,[]);vm(pf,E);Object(de.a)(pf,"PivotTableIndentChangedEvent",E,[]);vm(fh,E);Object(de.a)(fh,"PivotTableItemsWithNoDataOnColumnsShownEvent",E,[]);vm(li,E);Object(de.a)(li,"PivotTableItemsWithNoDataOnRowsShownEvent",
E,[]);vm(cg,E);Object(de.a)(cg,"PivotTableLayoutTypeSetEvent",E,[]);vm(mh,E);Object(de.a)(mh,"PivotTableNullStringChangedEvent",E,[]);vm(og,R);og.prototype.ic=function(){this.Ub(219)};Sk.Object.defineProperties(og.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object(de.a)(og,"PivotTablePivotLocationChangedEvent",R,[]);vm(Fg,R);Fg.prototype.ic=function(){this.Ub(145)};Sk.Object.defineProperties(Fg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});
Object(de.a)(Fg,"PivotTablePivotedEvent",R,[]);vm(te,E);Object(de.a)(te,"PivotTableRefreshDataOnLoadToggledEvent",E,[]);vm(Pg,R);Pg.prototype.ic=function(){this.Ub(50)};Pg.prototype.qg=function(){this.zd(function(G){return!!G.pivotTableId&&!!G.pivotTableName})};Sk.Object.defineProperties(Pg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object(de.a)(Pg,"PivotTableRefreshedEvent",R,[]);vm(jh,E);Object(de.a)(jh,"PivotTableRenamedEvent",E,[]);vm(eh,E);Object(de.a)(eh,
"PivotTableRowGrandTotalShownEvent",E,[]);vm(Ag,E);Object(de.a)(Ag,"PivotTableSaveSourceDataWithFileToggledEvent",E,[]);var Nj=b(652);vm(Cg,R);Cg.prototype.ic=function(){this.Ub(131)};Cg.prototype.qg=function(){this.zd(function(G){G=Object(Vh.a)(Nj.a,G);return!!G&&!!G.iKa()&&!!G.hierarchyName})};Sk.Object.defineProperties(Cg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object(de.a)(Cg,"PivotTableSortedEvent",R,[]);vm(Cf,E);Object(de.a)(Cf,"PivotTableSubTotalsVisibilitySettingSetEvent",
E,[]);vm(ug,R);ug.prototype.ic=function(){this.Ub(560)};Sk.Object.defineProperties(ug.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object(de.a)(ug,"PivotValueFieldSettingAppliedEvent",R,[]);vm(nf,R);nf.prototype.ic=function(){this.Ub(243)};Sk.Object.defineProperties(nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object(de.a)(nf,"PrintAreaClearedEvent",R,[]);vm(le,R);le.prototype.ic=function(){this.Ub(241)};le.prototype.qg=function(){this.zd(function(G){return!G.addToPrintArea})};
Sk.Object.defineProperties(le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object(de.a)(le,"PrintAreaSetEvent",R,[]);vm(Ld,R);Ld.prototype.ic=function(){this.Ub(517)};Sk.Object.defineProperties(Ld.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 57}}});Object(de.a)(Ld,"RangeAutoFilterClearedEvent",R,[]);vm(sb,R);sb.prototype.ic=function(){this.Ub(11)};sb.prototype.qg=function(){var G=this;this.zd(function(ka){return 16===ka.cellFormat.ValidMembers});
this.zd(function(ka){return ka.cellFormat.Font.ValidMembers===G.tZd})};Sk.Object.defineProperties(sb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Afa}}});Object(de.a)(sb,"RangeFontFormattedEventBase",R,[]);vm(ua,sb);Object(de.a)(ua,"RangeBoldedEvent",sb,[]);vm(Ca,R);Ca.prototype.ic=function(){this.Ub(11)};Ca.prototype.qg=function(){this.zd(function(G){return 128===G.cellFormat.ValidMembers})};Sk.Object.defineProperties(Ca.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 2}}});Object(de.a)(Ca,"RangeBorderedEvent",R,[]);qg.g$a="Table";qg.Loc="Sheet";Object(de.a)(qg,"MacroRecorderEventConstants",null,[]);vm(Wh,R);Wh.prototype.ic=function(){this.Ub(208)};Wh.prototype.qg=function(){this.zd(function(G){return G.getParameters().FilterType===qg.Loc})};Sk.Object.defineProperties(Wh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object(de.a)(Wh,"RangeCheckedItemsFilteredEvent",R,[]);vm(si,R);si.prototype.ic=function(){this.Ub(106);
this.Ub(105)};Sk.Object.defineProperties(si.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object(de.a)(si,"RangeConditionalFormattingChangedEvent",R,[]);vm(mg,R);mg.prototype.ic=function(){this.Ub(221)};Sk.Object.defineProperties(mg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object(de.a)(mg,"RangeConditionalFormattingRuleDeletedEvent",R,[]);vm(pi,R);pi.prototype.ic=function(){this.Ub(508)};pi.prototype.qg=function(){this.zd(function(G){return 3===
G.Qt()||1===G.Qt()||4===G.Qt()})};Sk.Object.defineProperties(pi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object(de.a)(pi,"RangeContentClearedEvent",R,[]);vm(Mh,R);Mh.prototype.ic=function(){this.Ub(104)};Sk.Object.defineProperties(Mh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object(de.a)(Mh,"RangeCopiedCutCellsInsertedEvent",R,[]);vm(eg,R);eg.prototype.ic=function(){this.Ub(209)};eg.prototype.qg=function(){this.zd(function(G){return G.getParameters().FilterType===
qg.Loc})};Sk.Object.defineProperties(eg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object(de.a)(eg,"RangeCustomFilteredEvent",R,[]);vm(Ah,R);Ah.prototype.ic=function(){this.Ub(121)};Sk.Object.defineProperties(Ah.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object(de.a)(Ah,"RangeDataValidationChangedEvent",R,[]);vm(Bg,sb);Object(de.a)(Bg,"RangeDoubleUnderlinedEvent",sb,[]);vm(ch,R);ch.prototype.ic=function(){this.Ub(190)};Sk.Object.defineProperties(ch.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object(de.a)(ch,"RangeDuplicatesRemovedEvent",R,[]);vm(wh,R);wh.prototype.ic=function(){this.Ub(527);this.Ub(12)};Sk.Object.defineProperties(wh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object(de.a)(wh,"RangeEditedEvent",R,[]);vm(zg,R);zg.prototype.ic=function(){Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Ub(255):this.Ub(232)};zg.prototype.qg=
function(){this.zd(function(G){return 4===G.actionType})};Sk.Object.defineProperties(zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 164}}});Object(de.a)(zg,"RangeExternalLinksBrokeAllLinksEvent",R,[]);vm(Sg,R);Sg.prototype.ic=function(){Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Ub(255):this.Ub(232)};Sg.prototype.qg=function(){this.zd(function(G){return 3===G.actionType})};Sk.Object.defineProperties(Sg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object(de.a)(Sg,"RangeExternalLinksBrokeLinkEvent",R,[]);vm(Fh,R);Fh.prototype.ic=function(){Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?this.Ub(256):this.Ub(249)};Fh.prototype.pwa=function(){this.bme("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};Sk.Object.defineProperties(Fh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 205}}});
Object(de.a)(Fh,"RangeExternalLinksChangeSourceEvent",R,[]);vm(ai,R);ai.prototype.ic=function(){this.Ub(553)};ai.prototype.qg=function(){this.zd(function(G){return 1===G.actionType})};Sk.Object.defineProperties(ai.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object(de.a)(ai,"RangeExternalLinksRefreshedAllEvent",R,[]);vm(Kg,R);Kg.prototype.ic=function(){this.Ub(553)};Kg.prototype.qg=function(){this.zd(function(G){return 0===G.actionType})};Sk.Object.defineProperties(Kg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});Object(de.a)(Kg,"RangeExternalLinksRefreshedEvent",R,[]);vm(Lh,R);Lh.prototype.ic=function(){this.Ub(224)};Sk.Object.defineProperties(Lh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object(de.a)(Lh,"RangeExternalLinksSetAutoRefreshEvent",R,[]);vm(hi,R);hi.prototype.ic=function(){this.Ub(11)};hi.prototype.qg=function(){this.zd(function(G){return 64===G.cellFormat.ValidMembers})};Sk.Object.defineProperties(hi.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object(de.a)(hi,"RangeFillColoredEvent",R,[]);vm(Lg,R);Lg.prototype.ic=function(){this.Ub(155)};Sk.Object.defineProperties(Lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object(de.a)(Lg,"RangeFilledEvent",R,[]);vm(Xg,R);Xg.prototype.ic=function(){this.Ub(176)};Xg.prototype.qg=function(){this.zd(function(G){return G.jV().AutoFilterType===qg.Loc&&!!G.jV().CriteriaType})};Sk.Object.defineProperties(Xg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object(de.a)(Xg,"RangeFilterAppliedEvent",R,[]);vm(xh,R);xh.prototype.ic=function(){this.Ub(176)};xh.prototype.qg=function(){this.zd(function(G){return G.jV().AutoFilterType===qg.Loc&&!G.jV().CriteriaType})};Sk.Object.defineProperties(xh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});Object(de.a)(xh,"RangeFilterClearedEvent",R,[]);vm(Qh,R);Qh.prototype.ic=function(){this.Ub(518)};Sk.Object.defineProperties(Qh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object(de.a)(Qh,"RangeFilterReappliedEvent",R,[]);vm(dh,R);dh.prototype.ic=function(){this.Ub(150)};Sk.Object.defineProperties(dh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object(de.a)(dh,"RangeFlashFilledEvent",R,[]);vm(ih,sb);Object(de.a)(ih,"RangeFontColoredEvent",sb,[]);vm(nh,sb);Object(de.a)(nh,"RangeFontItalicizedEvent",sb,[]);vm(Jh,sb);Object(de.a)(Jh,"RangeFontNamedEvent",sb,[]);vm(Kh,
sb);Object(de.a)(Kh,"RangeFontSizedEvent",sb,[]);vm(ti,R);ti.prototype.ic=function(){this.Ub(215)};Sk.Object.defineProperties(ti.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object(de.a)(ti,"RangeFormattedAsTableEvent",R,[]);vm(Vf,R);Vf.prototype.ic=function(){this.Ub(188)};Sk.Object.defineProperties(Vf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 97}}});Object(de.a)(Vf,"RangeGroupedOrUngroupedEvent",R,[]);vm(kh,R);kh.prototype.ic=function(){this.Ub(11)};
kh.prototype.qg=function(){this.zd(function(G){return 2===G.cellFormat.ValidMembers})};Sk.Object.defineProperties(kh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object(de.a)(kh,"RangeHorizontallyAlignedEvent",R,[]);vm(gi,R);gi.prototype.ic=function(){this.Ub(526)};Sk.Object.defineProperties(gi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 43}}});Object(de.a)(gi,"RangeHyperlinkAppliedEvent",R,[]);vm(Ne,R);Ne.prototype.ic=function(){this.Ub(11)};
Ne.prototype.qg=function(){this.zd(function(G){return 256===G.cellFormat.ValidMembers})};Sk.Object.defineProperties(Ne.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object(de.a)(Ne,"RangeIndentChangedEvent",R,[]);vm(Jf,R);Jf.prototype.ic=function(){this.Ub(156)};Jf.prototype.qg=function(){this.zd(function(G){return 2===G.Qt()||5===G.Qt()||6===G.Qt()||7===G.Qt()})};Sk.Object.defineProperties(Jf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});
Object(de.a)(Jf,"RangeMergedEvent",R,[]);vm(Dg,R);Dg.prototype.ic=function(){this.Ub(216)};Sk.Object.defineProperties(Dg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object(de.a)(Dg,"RangeNamedCellStyleAppliedEvent",R,[]);vm(ye,R);ye.prototype.ic=function(){this.Ub(11)};ye.prototype.qg=function(){this.zd(function(G){return 32===G.cellFormat.ValidMembers})};Sk.Object.defineProperties(ye.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});
Object(de.a)(ye,"RangeNumberFormattedEvent",R,[]);var xk=b(1089);vm(hh,R);hh.prototype.ic=function(){this.Ub(141)};hh.prototype.qg=function(){this.zd(function(G){return Object(Ej.a)(xk.a,G)})};Sk.Object.defineProperties(hh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object(de.a)(hh,"RangeSortedEvent",R,[]);vm(fi,sb);Object(de.a)(fi,"RangeStrikedThroughEvent",sb,[]);vm(gh,sb);Object(de.a)(gh,"RangeUnderlinedEvent",sb,[]);vm(Od,R);Od.prototype.ic=function(){this.Ub(11)};
Od.prototype.qg=function(){this.zd(function(G){return 1===G.cellFormat.ValidMembers})};Sk.Object.defineProperties(Od.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object(de.a)(Od,"RangeVerticallyAlignedEvent",R,[]);vm(Rg,R);Rg.prototype.ic=function(){this.Ub(11)};Rg.prototype.qg=function(){this.zd(function(G){return 8===G.cellFormat.ValidMembers})};Sk.Object.defineProperties(Rg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 62}}});Object(de.a)(Rg,
"RangeWrapTextToggledEvent",R,[]);vm(Uf,R);Uf.prototype.ic=function(){this.Ub(51)};Sk.Object.defineProperties(Uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object(de.a)(Uf,"RefreshedAllEvent",R,[]);vm(Ch,R);Ch.prototype.ic=function(){this.Ub(148)};Sk.Object.defineProperties(Ch.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});Object(de.a)(Ch,"ReplaceAllEvent",R,[]);vm(qf,R);qf.prototype.ic=function(){this.Ub(532)};qf.prototype.qg=function(){this.zd(function(G){return 95!==
G.getShapeType()&&96!==G.getShapeType()&&97!==G.getShapeType()&&98!==G.getShapeType()&&100!==G.getShapeType()&&102!==G.getShapeType()&&103!==G.getShapeType()})};Sk.Object.defineProperties(qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object(de.a)(qf,"ShapeInsertedEvent",R,[]);vm(td,R);td.prototype.ic=function(){this.Ub(531)};Sk.Object.defineProperties(td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object(de.a)(td,"ShapeStyleSetEvent",
R,[]);var ck=b(945);vm(Kf,R);Kf.prototype.ic=function(){this.Ub(581)};Kf.prototype.qg=function(){var G=this;this.zd(function(ka){return Object(Ej.a)(ck.a,ka)&&4===ka.getShapeTextFormat().ValidMembers});this.zd(function(ka){return Object(Ej.a)(ck.a,ka)&&ka.getShapeTextFormat().Font.ValidMembers===G.tZd})};Sk.Object.defineProperties(Kf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Afa}}});Object(de.a)(Kf,"ShapeTextFontFormattedEventBase",R,[]);vm(jg,Kf);Object(de.a)(jg,
"ShapeTextBoldedEvent",Kf,[]);var ik=b(1091);vm(ve,R);ve.prototype.ic=function(){this.Ub(581)};ve.prototype.qg=function(){this.zd(function(G){return Object(Ej.a)(ik.a,G)})};Sk.Object.defineProperties(ve.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object(de.a)(ve,"ShapeTextChangedEvent",R,[]);vm(Fd,Kf);Object(de.a)(Fd,"ShapeTextFontColorChangedEvent",Kf,[]);vm(Ye,Kf);Object(de.a)(Ye,"ShapeTextFontNameChangedEvent",Kf,[]);vm(Hd,Kf);Object(de.a)(Hd,"ShapeTextFontSizeChangedEvent",
Kf,[]);vm(Tf,R);Tf.prototype.ic=function(){this.Ub(581)};Tf.prototype.qg=function(){this.zd(function(G){return Object(Ej.a)(ck.a,G)&&2===G.getShapeTextFormat().ValidMembers})};Sk.Object.defineProperties(Tf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object(de.a)(Tf,"ShapeTextHorizontallyAlignedEvent",R,[]);vm(Fe,Kf);Object(de.a)(Fe,"ShapeTextItalicizedEvent",Kf,[]);vm(Ff,Kf);Object(de.a)(Ff,"ShapeTextUnderlinedEvent",Kf,[]);vm(he,R);he.prototype.ic=function(){this.Ub(581)};
he.prototype.qg=function(){this.zd(function(G){return Object(Ej.a)(ck.a,G)&&1===G.getShapeTextFormat().ValidMembers})};Sk.Object.defineProperties(he.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object(de.a)(he,"ShapeTextVerticallyAlignedEvent",R,[]);vm(Je,R);Je.prototype.ic=function(){this.Ub(138)};Sk.Object.defineProperties(Je.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 13}}});Object(de.a)(Je,"SheetAddedEvent",R,[]);var hj=b(8);vm(Rd,
R);Rd.prototype.ic=function(){this.Ub(237)};Rd.prototype.qg=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){G=G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>G.DeltaColumn&&!G.DeltaRow&&(!!G.InsertDeleteRange.FirstRow||G.InsertDeleteRange.LastRow!==hj.a.rz)||!G.DeltaColumn&&0>G.DeltaRow&&(!!G.InsertDeleteRange.FirstColumn||G.InsertDeleteRange.LastColumn!==
hj.a.uw)})};Sk.Object.defineProperties(Rd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object(de.a)(Rd,"SheetCellsDeletedEvent",R,[]);vm(nc,R);nc.prototype.ic=function(){this.Ub(237)};nc.prototype.qg=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){G=G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<G.DeltaColumn&&!G.DeltaRow&&
(!!G.InsertDeleteRange.FirstRow||G.InsertDeleteRange.LastRow!==hj.a.rz)||!G.DeltaColumn&&0<G.DeltaRow&&(!!G.InsertDeleteRange.FirstColumn||G.InsertDeleteRange.LastColumn!==hj.a.uw)})};Sk.Object.defineProperties(nc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object(de.a)(nc,"SheetCellsInsertedEvent",R,[]);vm(Ab,R);Ab.prototype.ic=function(){this.Ub(237)};Ab.prototype.qg=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});
this.zd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.zd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===hj.a.rz})};Sk.Object.defineProperties(Ab.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 139}}});Object(de.a)(Ab,"SheetColumnDeletedEvent",R,[]);vm(Mc,R);Mc.prototype.ic=function(){this.Ub(237)};Mc.prototype.qg=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.zd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===hj.a.rz})};Sk.Object.defineProperties(Mc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object(de.a)(Mc,"SheetColumnInsertedEvent",R,[]);vm(Qc,R);Qc.prototype.ic=function(){this.Ub(137)};Sk.Object.defineProperties(Qc.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object(de.a)(Qc,"SheetDeletedEvent",R,[]);vm(Vb,R);Vb.prototype.ic=function(){this.Ub(185)};Sk.Object.defineProperties(Vb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object(de.a)(Vb,"SheetDirectionChangedEvent",R,[]);vm(kb,R);kb.prototype.ic=function(){this.Ub(139)};Sk.Object.defineProperties(kb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object(de.a)(kb,"SheetDuplicatedEvent",R,[]);vm(Ea,
R);Ea.prototype.ic=function(){this.Ub(207)};Sk.Object.defineProperties(Ea.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object(de.a)(Ea,"SheetNameEditedEvent",R,[]);vm(Df,R);Df.prototype.ic=function(){this.Ub(151)};Sk.Object.defineProperties(Df.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object(de.a)(Df,"SheetPaneFrozenEvent",R,[]);vm(gf,R);gf.prototype.ic=function(){this.Ub(226)};Sk.Object.defineProperties(gf.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 120}}});Object(de.a)(gf,"SheetPrintSettingsSavedEvent",R,[]);var ui=b(994);vm(Ge,R);Ge.prototype.ic=function(){this.Ub(507)};Ge.prototype.pwa=function(){this.bme("Microsoft.Office.Excel.SheetProtectionMacroRecording")};Ge.prototype.qg=function(){this.zd(function(G){return Object.getType(G)===ui.a})};Sk.Object.defineProperties(Ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object(de.a)(Ge,"SheetProtectionPausedResumedEvent",R,
[]);vm(Ce,R);Ce.prototype.ic=function(){this.Ub(557)};Sk.Object.defineProperties(Ce.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object(de.a)(Ce,"SheetReorderedEvent",R,[]);vm(zd,R);zd.prototype.ic=function(){this.Ub(237)};zd.prototype.qg=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.zd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.zd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===hj.a.uw})};Sk.Object.defineProperties(zd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object(de.a)(zd,"SheetRowDeletedEvent",R,
[]);vm(ud,R);ud.prototype.ic=function(){this.Ub(237)};ud.prototype.qg=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.zd(function(G){return G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===hj.a.uw})};Sk.Object.defineProperties(ud.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object(de.a)(ud,"SheetRowInsertedEvent",R,[]);vm(Lc,R);Lc.prototype.ic=function(){this.Ub(135)};Sk.Object.defineProperties(Lc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object(de.a)(Lc,"SheetRowsColumnsAutoFitEvent",R,[]);vm(Fb,
R);Fb.prototype.ic=function(){this.Ub(136)};Sk.Object.defineProperties(Fb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object(de.a)(Fb,"SheetRowsColumnsResizedEvent",R,[]);vm(Da,R);Da.prototype.ic=function(){this.Ub(183)};Sk.Object.defineProperties(Da.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object(de.a)(Da,"SheetShowGridlinesToggledEvent",R,[]);vm(Pf,R);Pf.prototype.ic=function(){this.Ub(184)};Sk.Object.defineProperties(Pf.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object(de.a)(Pf,"SheetShowHeadingsToggledEvent",R,[]);vm(Ph,R);Ph.prototype.ic=function(){this.Ub(213)};Sk.Object.defineProperties(Ph.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object(de.a)(Ph,"SheetSpellCheckedEvent",R,[]);vm(ah,R);ah.prototype.ic=function(){this.Ub(515)};Sk.Object.defineProperties(ah.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object(de.a)(ah,
"SheetTabColoredEvent",R,[]);vm(vg,R);vg.prototype.ic=function(){this.Ub(157)};Sk.Object.defineProperties(vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object(de.a)(vg,"SheetVisibilityChangedEvent",R,[]);vm(He,R);He.prototype.ic=function(){this.Ub(239)};Sk.Object.defineProperties(He.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object(de.a)(He,"SheetsVisibilityChangedEvent",R,[]);vm($e,R);$e.prototype.ic=function(){this.Ub(203)};
Sk.Object.defineProperties($e.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object(de.a)($e,"SlicerInsertedEvent",R,[]);vm(Bf,R);Bf.prototype.ic=function(){this.Ub(173)};Bf.prototype.qg=function(){this.zd(function(G){return!G.clearFilter})};Sk.Object.defineProperties(Bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object(de.a)(Bf,"SlicerSelectionAppliedEvent",R,[]);vm(bf,R);bf.prototype.ic=function(){this.Ub(173)};bf.prototype.qg=
function(){this.zd(function(G){return G.clearFilter})};Sk.Object.defineProperties(bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object(de.a)(bf,"SlicerSelectionClearedEvent",R,[]);vm(pg,R);pg.prototype.ic=function(){this.Ub(208)};pg.prototype.qg=function(){this.zd(function(G){return G.getParameters().FilterType===qg.g$a})};Sk.Object.defineProperties(pg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object(de.a)(pg,"TableCheckedItemsFilteredEvent",
R,[]);vm(vf,R);vf.prototype.ic=function(){this.Ub(237)};vf.prototype.qg=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Sk.Object.defineProperties(vf.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object(de.a)(vf,"TableColumnDeletedEvent",R,[]);vm(wf,R);wf.prototype.ic=function(){this.Ub(237)};wf.prototype.qg=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return 0<G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Sk.Object.defineProperties(wf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object(de.a)(wf,"TableColumnInsertedEvent",R,[]);var jk=b(1090);vm(af,R);af.prototype.ic=function(){this.Ub(141)};af.prototype.qg=function(){this.zd(function(G){return Object(Ej.a)(jk.a,G)})};Sk.Object.defineProperties(af.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object(de.a)(af,"TableColumnSortedEvent",R,[]);vm(Nf,R);Nf.prototype.ic=function(){this.Ub(193)};
Sk.Object.defineProperties(Nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object(de.a)(Nf,"TableConvertedToRangeEvent",R,[]);vm(ce,R);ce.prototype.ic=function(){this.Ub(206)};Sk.Object.defineProperties(ce.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object(de.a)(ce,"TableCreatedEvent",R,[]);vm(Le,R);Le.prototype.ic=function(){this.Ub(209)};Le.prototype.qg=function(){this.zd(function(G){return G.getParameters().FilterType===qg.g$a})};
Sk.Object.defineProperties(Le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object(de.a)(Le,"TableCustomFilteredEvent",R,[]);vm(Ud,R);Ud.prototype.ic=function(){this.Ub(187)};Ud.prototype.qg=function(){this.zd(function(G){return 1===G.options.OperationType})};Sk.Object.defineProperties(Ud.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object(de.a)(Ud,"TableCustomSortedEvent",R,[]);vm(dd,R);dd.prototype.ic=function(){this.Ub(176)};dd.prototype.qg=
function(){this.zd(function(G){return G.jV().AutoFilterType===qg.g$a});this.zd(function(G){return 0===G.jV().CriteriaType})};Sk.Object.defineProperties(dd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object(de.a)(dd,"TableFilterClearedEvent",R,[]);vm(Kc,R);Kc.prototype.ic=function(){this.Ub(176)};Kc.prototype.qg=function(){this.zd(function(G){return G.jV().AutoFilterType===qg.g$a});this.zd(function(G){var ka=new ph.a;ka.add(1);ka.add(2);ka.add(8);ka.add(9);ka.add(10);
ka.add(11);ka.add(12);ka.add(13);ka.add(14);ka.add(15);ka.add(16);ka.add(17);ka.add(18);ka.add(19);ka.add(20);ka.add(21);ka.add(22);ka.add(23);ka.add(24);ka.add(25);ka.add(26);ka.add(27);ka.add(28);ka.add(29);ka.add(30);ka.add(31);ka.add(32);ka.add(33);ka.add(34);ka.add(35);ka.add(36);ka.add(37);ka.add(38);ka.add(39);return ka.contains(G.jV().CriteriaType)})};Sk.Object.defineProperties(Kc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 32}}});Object(de.a)(Kc,"TableItemFilteredEvent",
R,[]);vm(ac,R);ac.prototype.ic=function(){this.Ub(217)};Sk.Object.defineProperties(ac.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object(de.a)(ac,"TableRenamedEvent",R,[]);vm(qe,R);qe.prototype.ic=function(){this.Ub(211)};Sk.Object.defineProperties(qe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object(de.a)(qe,"TableResizedEvent",R,[]);vm(Md,R);Md.prototype.ic=function(){this.Ub(514)};Sk.Object.defineProperties(Md.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 44}}});Object(de.a)(Md,"TableRowColumnRearrangedEvent",R,[]);vm(yd,R);yd.prototype.ic=function(){this.Ub(237)};yd.prototype.qg=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return 0>G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
Sk.Object.defineProperties(yd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object(de.a)(yd,"TableRowDeletedEvent",R,[]);vm(Vc,R);Vc.prototype.ic=function(){this.Ub(237)};Vc.prototype.qg=function(){this.zd(function(G){return!!G.insertDeleteMultiRangeParameters});this.zd(function(G){return G.insertDeleteMultiRangeParameters.IsTableCommand});this.zd(function(G){return!G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.zd(function(G){return 0<
G.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};Sk.Object.defineProperties(Vc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object(de.a)(Vc,"TableRowInsertedEvent",R,[]);vm(uc,R);uc.prototype.ic=function(){this.Ub(177)};uc.prototype.qg=function(){this.zd(function(G){return G.jV().AutoFilterType===qg.g$a})};Sk.Object.defineProperties(uc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});Object(de.a)(uc,"TableSortedEvent",
R,[]);vm(Db,R);Db.prototype.ic=function(){this.Ub(212)};Sk.Object.defineProperties(Db.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object(de.a)(Db,"TableStyleAppliedEvent",R,[]);vm(La,R);La.prototype.ic=function(){this.Ub(196)};Sk.Object.defineProperties(La.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object(de.a)(La,"TableStyleOptionToggledEvent",R,[]);vm(qh,R);qh.prototype.ic=function(){this.Ub(210)};qh.prototype.qg=function(){this.zd(function(G){return G.getParameters().FilterType===
qg.g$a})};Sk.Object.defineProperties(qh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object(de.a)(qh,"TableTop10FilteredEvent",R,[]);vm(kg,R);kg.prototype.ic=function(){this.Ub(238)};Sk.Object.defineProperties(kg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object(de.a)(kg,"TextToColumnsEvent",R,[]);vm(uf,R);uf.prototype.ic=function(){this.Ub(559)};Sk.Object.defineProperties(uf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 128}}});
Object(de.a)(uf,"ValuesSortedEvent",R,[]);vm(rg,R);rg.prototype.ic=function(){this.Ub(197)};Sk.Object.defineProperties(rg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object(de.a)(rg,"WorkbookCalculationModeSetEvent",R,[]);vm(Xf,R);Xf.prototype.ic=function(){this.Ub(181)};Xf.prototype.qg=function(){this.zd(function(G){return!!G.parentCommentId})};Sk.Object.defineProperties(Xf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});Object(de.a)(Xf,
"WorkbookCommentRepliedEvent",R,[]);vm(Yf,R);Yf.prototype.ic=function(){this.Ub(181)};Yf.prototype.qg=function(){this.zd(function(G){return!G.parentCommentId})};Sk.Object.defineProperties(Yf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object(de.a)(Yf,"WorkbookCommentedEvent",R,[]);vm(Ze,R);Ze.prototype.ic=function(){this.Ub(128)};Sk.Object.defineProperties(Ze.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 56}}});Object(de.a)(Ze,"WorkbookRecalculatedEvent",
R,[]);vm(Pd,R);Pd.prototype.ic=function(){this.Ub(171)};Sk.Object.defineProperties(Pd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object(de.a)(Pd,"WorkbookRedoEvent",R,[]);vm(If,R);If.prototype.ic=function(){this.Ub(170)};Sk.Object.defineProperties(If.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object(de.a)(If,"WorkbookUndoEvent",R,[]);vm(Yd,R);Yd.prototype.ic=function(){this.Ub(507);this.Ub(576);this.Ub(10)};Yd.prototype.qg=function(){this.zd(function(G){if(Object(Ej.a)(Oe,
G)&&(G=Object(Vh.a)(Oe,G),void 0!==G.source&&null!==G.source&&void 0!==G.eventId&&null!==G.eventId))return Se.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",G.source,G.eventId),!0;Se.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};Sk.Object.defineProperties(Yd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 116}}});Object(de.a)(Yd,"DefaultRichApiRequestExecutedEvent",
R,[]);vm(ig,R);ig.prototype.ic=function(){this.Ub(1022)};Sk.Object.defineProperties(ig.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 216}}});Object(de.a)(ig,"TablelAltTextEditedEvent",R,[]);vm(bg,R);bg.prototype.ic=function(){this.Ub(263)};Sk.Object.defineProperties(bg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 217}}});Object(de.a)(bg,"FloatingObjectZOrderChangedEvent",R,[]);je.prototype.M0e=function(G,ka){var d=this.N0e(G,this.macroRecorderEvents,
ka);d||(d=this.N0e(G,je.S1h(),ka),!d&&this.Nff(G,je.jHe,ka)&&(d=je.jHe));return d};je.prototype.N0e=function(G,ka,d){var w=new ph.a;ka=yl(ka);for(var I=ka.next();!I.done;I=ka.next())I=I.value,this.Nff(G,I,d)&&w.add(I);return 1===w.count?w.oa(0):1<w.count?je.OKh(w):null};je.prototype.Nff=function(G,ka,d){var w=je.DWi(G,ka);return d?w&&je.KWj(G,ka):w};je.prototype.saj=function(){for(var G=new ph.a,ka=yl(this.Eb),d=ka.next();!d.done;d=ka.next()){d=d.value;for(var w=!1,I=yl(d.featureGates),ha=I.next();!ha.done;ha=
I.next())if(!Gf.EwaSettings.la(ha.value)){G.add(d);w=!0;break}if(!w)for(w=yl(d.ZSe),I=w.next();!I.done;I=w.next())if(!Gf.EwaSettings.getBooleanFeatureGate(I.value,!1)){G.add(d);break}}G=yl(G);for(ka=G.next();!ka.done;ka=G.next())this.Eb.remove(ka.value)};je.S1h=function(){je.FBb||(je.FBb=new ph.a,je.FBb.add(new we),je.FBb.add(new Eh));return je.FBb};je.DWi=function(G,ka){return ka.operations.contains(G.operation)};je.KWj=function(G,ka){var d=ka.tCc;if(!d.count)return!0;ka=!0;d=yl(d);for(var w=d.next();!w.done;w=
d.next())if(w=w.value,!w(G.payload)){ka=!1;break}return ka};je.OKh=function(G){var ka=G.oa(0);G=yl(G);for(var d=G.next();!d.done;d=G.next())d=d.value,d.tCc.count>ka.tCc.count&&(ka=d);return ka};Sk.Object.defineProperties(je.prototype,{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.Eb||(this.Eb=new ph.a,this.Eb.add(new wh),this.Eb.add(new Ca),this.Eb.add(new ua),this.Eb.add(new Bg),this.Eb.add(new hi),this.Eb.add(new ih),this.Eb.add(new nh),this.Eb.add(new Jh),this.Eb.add(new Kh),
this.Eb.add(new fi),this.Eb.add(new gh),this.Eb.add(new ye),this.Eb.add(new Je),this.Eb.add(new Qc),this.Eb.add(new Ea),this.Eb.add(new ce),this.Eb.add(new vf),this.Eb.add(new wf),this.Eb.add(new yd),this.Eb.add(new Vc),this.Eb.add(new Mc),this.Eb.add(new Ab),this.Eb.add(new ud),this.Eb.add(new zd),this.Eb.add(new Ud),this.Eb.add(new uc),this.Eb.add(new pg),this.Eb.add(new dd),this.Eb.add(new pi),this.Eb.add(new Le),this.Eb.add(new qh),this.Eb.add(new Kc),this.Eb.add(new Yf),this.Eb.add(new Xf),this.Eb.add(new Jc),
this.Eb.add(new Fb),this.Eb.add(new Rd),this.Eb.add(new nc),this.Eb.add(new Lc),this.Eb.add(new Mh),this.Eb.add(new Qh),this.Eb.add(new gi),this.Eb.add(new qb),this.Eb.add(new Md),this.Eb.add(new Pd),this.Eb.add(new If),this.Eb.add(new Ch),this.Eb.add(new Ki),this.Eb.add(new ia),this.Eb.add(new Jf),this.Eb.add(new kb),this.Eb.add(new rg),this.Eb.add(new Ze),this.Eb.add(new Ld),this.Eb.add(new xh),this.Eb.add(new Lg),this.Eb.add(new kh),this.Eb.add(new Od),this.Eb.add(new Rg),this.Eb.add(new Ne),this.Eb.add(new Ce),
this.Eb.add(new sh),this.Eb.add(new Dd),this.Eb.add(new Pf),this.Eb.add(new Da),this.Eb.add(new ch),this.Eb.add(new vg),this.Eb.add(new ah),this.Eb.add(new qe),this.Eb.add(new ti),this.Eb.add(new fc),this.Eb.add(new dg),this.Eb.add(new Kg),this.Eb.add(new Ra),this.Eb.add(new xb),this.Eb.add(new Ug),this.Eb.add(new bd),this.Eb.add(new Jg),this.Eb.add(new Zf),this.Eb.add(new Xh),this.Eb.add(new Td),this.Eb.add(new dh),this.Eb.add(new Db),this.Eb.add(new La),this.Eb.add(new Ph),this.Eb.add(new Df),this.Eb.add(new qf),
this.Eb.add(new td),this.Eb.add(new tg),this.Eb.add(new Tg),this.Eb.add(new Hh),this.Eb.add(new ii),this.Eb.add(new Vf),this.Eb.add(new h),this.Eb.add(new Rc),this.Eb.add(new Ng),this.Eb.add(new ac),this.Eb.add(new Fg),this.Eb.add(new Uf),this.Eb.add(new Pg),this.Eb.add(new Nf),this.Eb.add(new Ah),this.Eb.add(new Dg),this.Eb.add(new hh),this.Eb.add(new si),this.Eb.add(new ad),this.Eb.add(new Pb),this.Eb.add(new Qa),this.Eb.add(new Wh),this.Eb.add(new eg),this.Eb.add(new Xg),this.Eb.add(new Th),this.Eb.add(new aa),
this.Eb.add(new Sg),this.Eb.add(new gf),this.Eb.add(new af),this.Eb.add(new mg),this.Eb.add(new He),this.Eb.add(new yf),this.Eb.add(new uf),this.Eb.add(new $i),this.Eb.add(new Hi),this.Eb.add(new Y),this.Eb.add(new cf),this.Eb.add(new na),this.Eb.add(new jf),this.Eb.add(new rh),this.Eb.add(new Vb),this.Eb.add(new Eg),this.Eb.add(new og),this.Eb.add(new M),this.Eb.add(new Qg),this.Eb.add(new Cg),this.Eb.add(new gd),this.Eb.add(new tc),this.Eb.add(new Nb),this.Eb.add(new le),this.Eb.add(new Mg),this.Eb.add(new nf),
this.Eb.add(new pe),this.Eb.add(new ai),this.Eb.add(new zg),this.Eb.add(new Lh),this.Eb.add(new ef),this.Eb.add(new Xd),this.Eb.add(new jh),this.Eb.add(new eh),this.Eb.add(new Bb),this.Eb.add(new k),this.Eb.add(new qc),this.Eb.add(new W),this.Eb.add(new Qf),this.Eb.add(new li),this.Eb.add(new fh),this.Eb.add(new lh),this.Eb.add(new yg),this.Eb.add(new $g),this.Eb.add(new mh),this.Eb.add(new Ag),this.Eb.add(new te),this.Eb.add(new va),this.Eb.add(new N),this.Eb.add(new Cf),this.Eb.add(new cg),this.Eb.add(new pf),
this.Eb.add(new $e),this.Eb.add(new Bf),this.Eb.add(new bf),this.Eb.add(new ve),this.Eb.add(new jg),this.Eb.add(new Fe),this.Eb.add(new Ff),this.Eb.add(new Fd),this.Eb.add(new Ye),this.Eb.add(new Hd),this.Eb.add(new Tf),this.Eb.add(new he),this.Eb.add(new Fh),this.Eb.add(new ug),this.Eb.add(new kg),this.Eb.add(new Ge),this.Eb.add(new ig),this.Eb.add(new bg),Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.saj());return this.Eb}}});je.FBb=null;je.jHe=new Yd;Object(de.a)(je,
"MacroRecorderEventList",null,[]);var fj=Vg.a;vm(ng,fj);ng.prototype.create=function(){this.Fb(this.$.da.Aa(297)||new Aa(this.$,new je(this.$),new Bc))};ng.ja=function(G){G.da.Ha(298,new ng(G))};Object(de.a)(ng,"MacroRecorderEventHandlerFactory",Vg.a,[]);var vj=b(817),yj=b(77),Bh=b(35);rf.prototype.Yc=function(){return!1};rf.prototype.executeCommand=function(G,ka,d){G=Bh.TaskExtensions.om();ka=ka.command;switch(ka){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 971811139:this.$.xe(2045014907,
-1,0,null),this.automateCommandManager.esi(ka,1904816141===ka?d[yj.a.ld].toString():null)}return G};rf.prototype.Jc=function(G,ka){G=!1;switch(ka.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case 1904816141:case 1606046412:G=this.$.Aba}return G};rf.prototype.fd=function(G,ka,d){return"PopulateAutomateGalleryMenu"===ka&&this.$.Aba?(this.automateCommandManager.fd(ka,d),!0):!1};Object(de.a)(rf,"AutomateCommandHandler",null,[188]);var kk=b(461),Zj=vj.a;vm(kf,Zj);kf.prototype.Od=
function(){var G=this;kk.a(this.$,374,375,this.ub,function(){var ka=G.$.da.Aa(352);ka?G.Fd([new rf(ka,G.$)]):Se.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})};kf.ja=function(G){G.da.Ha(308,new kf(G))};Object(de.a)(kf,"AutomateCommandHandlerFactory",vj.a,[]);Object(de.a)(hf,"AuthContext",null,[]);var $c=b(577),De=b(126),vi=b(107),yh=b(26),O=b(946),Fa=b(176);ee.prototype.getAuthContext=function(){return this.zob};ee.prototype.lbc=
function(){function G(ha,wa){return(new Promise(function($a){window.setTimeout(function(){$a(ha)},wa)})).then(function($a){w.push(Object.assign(new Mf.a,{name:"Error"+I,string:$a.ErrorMessage}));w.push(Object.assign(new Mf.a,{name:"ErrorCode"+I,string:$a.ErrorCode}));I++;return ka.Vag()})}var ka=this,d=yh.a.Ra.Kb,w=[];if(this.oAuthManager)w.push(Object.assign(new Mf.a,{name:"IsAuthSupported",bool:this.ote}));else return this.V8b(w,d,"need_OAuthManager","No OAuthManager");if(!this.Ov.Vx||!this.Ov.Vx.value)return this.V8b(w,
d,"need_license","No License");if(fg.AFrameworkApplication.ga.ra("IsAnonymousUser"))return this.V8b(w,d,"need_user","Anonymous User");if(33E5>Date.now()-this.zob.timeStamp)return w.push(Object.assign(new Mf.a,{name:"UsedCachedToken",bool:!0})),Fa.a(De.a.Xyd,!0,0,w),Promise.resolve(Object.assign(new O.a,{IsSuccess:!0,Token:this.zob.token}));w.push(Object.assign(new Mf.a,{name:"UsedCachedToken",bool:!1}));var I=1;return this.Vag().catch(function(ha){return G(ha,200)}).catch(function(ha){return G(ha,
400)}).then(function(ha){ha.IsSuccess?(ka.zob.token=ha.Token,ka.zob.timeStamp=Date.now()):(w.push(Object.assign(new Mf.a,{name:"Error"+I,string:ha.ErrorMessage})),w.push(Object.assign(new Mf.a,{name:"ErrorCode"+I,string:ha.ErrorCode})));w.push(Object.assign(new Mf.a,{name:"Attempts",int64:I}));w.push(Object.assign(new Mf.a,{name:"Error",string:ha.ErrorMessage}));w.push(Object.assign(new Mf.a,{name:"ErrorCode",string:ha.ErrorCode}));Fa.a(De.a.Xyd,ha.IsSuccess,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),
w);return Promise.resolve(ha)}).catch(function(ha){w.push(Object.assign(new Mf.a,{name:"Error"+I,string:ha.ErrorMessage}));w.push(Object.assign(new Mf.a,{name:"ErrorCode"+I,string:ha.ErrorCode}));w.push(Object.assign(new Mf.a,{name:"Attempts",int64:I}));return ka.V8b(w,d,ha.ErrorCode,ha.ErrorMessage)})};ee.prototype.V8b=function(G,ka,d,w){G.push(Object.assign(new Mf.a,{name:"Error",string:w}));G.push(Object.assign(new Mf.a,{name:"ErrorCode",string:d}));Fa.a(De.a.Xyd,!1,vi.getElapsedMilliseconds(ka,
yh.a.Ra.Kb),G);return Promise.resolve(Object.assign(new O.a,{IsSuccess:!1,ErrorMessage:w,ErrorCode:d}))};ee.prototype.Vag=function(){var G=this,ka=$c.a.T_h(),d=0;ka=this.oAuthManager.FS("Maker",ka).then(function(w){if(w)return!w.IsSuccess&&G.Yyj(w)?Promise.reject(w):Promise.resolve(w);w=Object.assign(new O.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(w)}).catch(function(w){var I=new O.a;Object.getType(w)===Object.getType(I)?I=w:(I.ErrorMessage=
w.toString(),I.ErrorCode="exception");return Promise.reject(I)});return Promise.race([ka,new Promise(function(w,I){d=window.setTimeout(function(){I(Object.assign(new O.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(function(w){window.clearTimeout(d);return w})};ee.prototype.Yyj=function(G){return"interaction_required"===G.ErrorCode||"InitFailed"===G.ErrorCode||"invalid_resource"===G.ErrorCode||"login_required"===G.ErrorCode&&G.ErrorMessage.startsWith("AADSTS500341")?
!1:!0};Object(de.a)(ee,"AutomateCommandAuth",null,[511]);var Gb=b(947);Object(de.a)(Ee,"AutomateCommandGalleryBase",null,[]);var yc=b(844),Xc=b(29),xe=b(865),Ie=b(1364),Xe=b(16),ff=b(53),zf=b(14),Yg=b(823),Hg=b(996);Gd.prototype.CIh=function(G){var ka=this.automateCommandManager.Sa.Lp().aC(),d=Gd.AU(G,zf.a.instance.fa(2079));this.GUc(d,$c.a.nUi,this.automateCommandManager.hg,$c.a.IFi,zf.a.instance.fa(2075),this.automateCommandManager.Sa);Array.add(ka.MenuSectionList,d);d=Gd.AU(G,zf.a.instance.fa(2080));
this.GUc(d,$c.a.ICi,$c.a.LK?this.automateCommandManager.Kk.uUe(this.automateCommandManager.hg):this.automateCommandManager.Hm.uUe(this.automateCommandManager.hg),$c.a.Dtf,zf.a.instance.fa(2076),this.automateCommandManager.Sa);Array.add(ka.MenuSectionList,d);d=Gd.AU(G,zf.a.instance.fa(2081));this.GUc(d,$c.a.Hkj,this.automateCommandManager.zr,$c.a.Dtf,"",this.automateCommandManager.Sa);Array.add(ka.MenuSectionList,d);d=Object.assign(new yc.a,{Id:$c.a.Lpe,ExternalId:$c.a.Lpe,Command:"1606046412",LabelText:zf.a.instance.fa(2072),
Alt:zf.a.instance.fa(2073),Image16by16:ff.a.Ee(16),Image16by16Class:Xe.a.qPe,Visible:!0});G=Gd.AU(G,null);G.ControlsId="myScriptsSection.Controls";Array.add(G.ControlList,d);Array.add(ka.MenuSectionList,G);return ka};Gd.prototype.GUc=function(G,ka,d,w,I,ha){if(d&&0<d.length){ka=ha.GA(ka,1,"Size150by20").x0b();I={};ha={};ha.root=Gd.nta(320,30);ha.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",lineHeight:"normal"};ha.label={margin:"0px 3px"};I.galleryButtonInExpanded=
ha;ka.GalleryStyle=I;for(I=0;I<d.length&&I<w;I++)ha=d.hK(I),Array.add(ka.GalleryItems,Gd.h4b(ha.id,ha,!1));Array.add(G.ControlList,ka)}else d=Object.assign(new Hg.a,{Id:ka,ExternalId:ka,LabelText:I}),G.ControlsId=d.Id+".Controls",Array.add(G.ControlList,d)};Gd.UWe=function(G){if(G){var ka=String.format($c.a.Qci,G.isShared?$c.a.qag:$c.a.WWf,ff.a.Ee(16));G=String.format($c.a.Rci,Xc.a.Lf(G.name));return String.format($c.a.Pci,ka,G)}return""};Gd.AU=function(G,ka){return Object.assign(new xe.a,{Id:G,Title:ka,
MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};Gd.h4b=function(G,ka,d){var w=d?$c.a.uNj:$c.a.tNj,I=d?$c.a.$lj:$c.a.Zlj,ha=d?$c.a.qag:$c.a.vNj,wa=d?$c.a.WWf:$c.a.amj;return ka?Gd.mEe(ka.shareId||ka.id,ka.name,d,ka.isShared?w:I,G,G,ka.isShared?ha:wa):Gd.mEe("","",d,"",G,G)};Gd.mEe=function(G,ka,d,w,I,ha,wa){I=void 0===I?null:I;ha=void 0===ha?null:ha;wa=void 0===wa?null:wa;var $a=void 0===$a?null:$a;var Tb={},Ic={};d?(Tb.root=Gd.nta(32,32),
Ic.root=Gd.nta(32,32)):(Tb.root=Gd.nta(20,20),Ic.root=Gd.nta(20,20));return Object.assign(new Ie.a,{Id:G,ExternalId:I||G,MenuItemId:ha||G,Command:"1904816141",Icon:w,Image:ff.a.Ee(16),ImageClass:wa,LabelText:ka,FullIconStyle:Tb,PreviewIconStyle:Ic,Alt:$a||ka})};Gd.nta=function(G,ka){var d={};d.width=G;d["min-width"]=G;d.height=ka;return d};Object(de.a)(Gd,"AutomateCommandRenderer",null,[]);Ed.prototype.CKa=function(G){for(var ka=0;ka<this.scripts.length;ka++)if(this.scripts[ka].id===G||this.scripts[ka].shareId===
G)return ka;return-1};Ed.prototype.sort=function(){this.V5f(this.scripts)};Ed.prototype.$n=function(G){return-1===this.CKa(G.id)?(this.scripts.push(G),!0):!1};Ed.prototype.yYa=function(G){return-1===this.CKa(G.id)?(this.scripts=[G].concat(this.scripts),!0):!1};Ed.prototype.vrf=function(G){G=this.CKa(G.id);if(-1!==G){for(var ka=this.scripts[G].Vha();0<G;)this.scripts[G]=this.scripts[G-1],G--;this.scripts[0]=ka}};Ed.prototype.Gea=function(G){var ka=this.CKa(G.id);if(-1!==ka){var d=this.scripts[ka].shareId;
this.scripts[ka]=G;this.scripts[ka].shareId=d}};Ed.prototype.Pgc=function(G){var ka=this.CKa(G.id);return-1!==ka?G.name===this.scripts[ka].name:!1};Ed.prototype.xia=function(G){G=this.CKa(G);return-1!==G?(this.scripts.splice(G,1),!0):!1};Ed.prototype.clear=function(){this.scripts=[]};Ed.prototype.getScripts=function(){return this.scripts};Ed.prototype.iz=function(G){G=this.CKa(G);return-1!==G?this.scripts[G]:null};Ed.prototype.hK=function(G){return 0<=G&&this.length>G?this.scripts[G]:null};Ed.prototype.uUe=
function(G){for(var ka=new Ed([],this.V5f),d=0;d<this.scripts.length;d++){var w=this.scripts[d];G.iz(w.id)||ka.$n(w)}return ka};Ed.prototype.heb=function(){for(var G=[],ka=yl(this.scripts),d=ka.next();!d.done;d=ka.next())G.push(d.value.QVd());return G};Sk.Object.defineProperties(Ed.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object(de.a)(Ed,"ScriptCollection",null,[]);var Gg=b(180);Oc.prototype.Vha=function(){return new Oc(this.K$)};Oc.prototype.QVd=
function(){return this.K$};Sk.Object.defineProperties(Oc.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.K$.id}},shareId:{configurable:!0,enumerable:!0,get:function(){return this.K$.shareId},set:function(G){this.K$.shareId=G||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.K$.name}},CGe:{configurable:!0,enumerable:!0,get:function(){return this.K$.dateLastPublished}},body:{configurable:!0,enumerable:!0,get:function(){return this.K$.body}},description:{configurable:!0,
enumerable:!0,get:function(){return this.K$.description}},wdf:{configurable:!0,enumerable:!0,get:function(){return this.K$.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.shareId&&0<this.shareId.length}}});Object(de.a)(Oc,"ScriptCore",null,[]);var Zh=b(57),Wi=b(39);vm(dc,Ee);dc.prototype.Qbc=function(G){switch(G){case "1":case "2":case "3":return this.ky.hK(parseInt(G,10)-1);default:return this.Ke.Kk.iz(G)||this.Ke.Hm.iz(G)||this.Ke.hg.iz(G)||this.Ke.zr.iz(G)}};dc.prototype.Uac=
function(G,ka,d){var w=null;if(this.Ke.Sva)switch(G){case "1":case "2":case "3":w=this.ky.hK(parseInt(G,10)-1);break;default:w=this.ky.iz(G)}Wi.a.isReactRibbonEnabled()?(d=Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?2===d:!Zh.a.Rf.QC,ka[Gb.a.GalleryButtonProps]=Gd.h4b(G,w,d)):ka[Gb.a.InnerHTML]=Gd.UWe(w);ka[Gb.a.Alt]=w?w.name:""};dc.prototype.rB=function(G){this.ky=this.pGb();this.$.If();var ka=[];ka.push(Object.assign(new Mf.a,{name:"Operation",
string:G}));ka.push(Object.assign(new Mf.a,{name:"HasReadRecentCachedScripts",bool:this.Ke.Tva}));ka.push(Object.assign(new Mf.a,{name:"ReadScriptsDone",bool:this.Ke.ZKa}));ka.push(Object.assign(new Mf.a,{name:"ReadSamplesScriptsDone",bool:this.Ke.U6}));ka.push(Object.assign(new Mf.a,{name:"SamplesScriptCount",int64:this.Ke.zr.length}));ka.push(Object.assign(new Mf.a,{name:"ReadRecentScriptsDone",bool:this.Ke.Yca}));ka.push(Object.assign(new Mf.a,{name:"RecentScriptCount",int64:this.Ke.Kk.length}));
ka.push(Object.assign(new Mf.a,{name:"ReadWorkbookScriptsDone",bool:this.Ke.mt}));ka.push(Object.assign(new Mf.a,{name:"WorkbookScriptCount",int64:this.Ke.hg.length}));Fa.a(De.a.Wyd,!0,0,ka)};dc.prototype.Ucc=function(G){var ka=!1,d="",w=new Oc(G.scriptMetadata),I={Operation:"HandleRefreshRibbonGallery"};I.RefreshOperation=G.operationName;switch(G.operationName){case $c.a.DHd:G=this.owb(w);d=G.message;ka=G.returnValue;break;case $c.a.BHd:G=this.mwb(w);d=G.message;ka=G.returnValue;break;case $c.a.AHd:G=
this.lwb(w);d=G.message;ka=G.returnValue;break;case $c.a.CHd:G=this.nwb(w);d=G.message;ka=G.returnValue;break;case $c.a.qOf:G=this.ejd(w),d=G.message,ka=G.returnValue}(I.GalleryUpdated=ka)?(Se.ULS.sendTraceTag(537170322,0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",d),this.rB("RefreshGallery")):Se.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",d);I.Message=d;Se.ULS.sendTraceTag(537170320,
0,50,Rh.c(I))};dc.prototype.pGb=function(){for(var G=new Ed([],function(){}),ka=this.Ke.hg?this.Ke.hg.length:0,d=this.Ke.Kk?this.Ke.Kk.length:0,w=this.Ke.zr?this.Ke.zr.length:0,I=0,ha=0;ha<$c.a.LEd;ha++)if(ha<ka)G.$n(this.Ke.hg.hK(ha));else if(ha-ka+I<d){var wa=this.Ke.Kk.hK(ha-ka+I);this.Ke.hg.iz(wa.id)?(I++,ha--):G.$n(wa)}else ha-ka-d+I<w&&G.$n(this.Ke.zr.hK(ha-ka+I-d));return G};dc.prototype.owb=function(G){if(this.Ke.Kk.yYa(G))var ka="";else{ka="";var d=G.Vha();this.Ke.hg.Gea(d);this.Ke.hg.sort();
this.Ke.Kk.Gea(G)}return{returnValue:!0,message:ka}};dc.prototype.mwb=function(G){this.Ke.hg.xia(G.id);return this.Ke.Kk.xia(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};dc.prototype.lwb=function(G){var ka=G.Vha();ka.shareId=null;this.Ke.Kk.yYa(ka);return this.Ke.hg.$n(G)?(this.Ke.hg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};dc.prototype.nwb=
function(G){return this.Ke.hg.xia(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};dc.prototype.ejd=function(G){var ka=G.Vha(),d=!1;this.Ke.hg.Pgc(ka)&&(this.Ke.hg.Gea(ka),this.Ke.hg.sort(),d=!0);this.Ke.Kk.yYa(G)?d=!0:this.Ke.Kk.Pgc(G)&&(this.Ke.Kk.Gea(G),this.Ke.Kk.vrf(G),d=!0);return{returnValue:d,message:""}};Object(de.a)(dc,"AutomateCommandGallery",Ee,[]);var qi=b(86);Object(de.a)(Rf,"AutomateCommandLicensingBase",
null,[]);Object(de.a)(xf,"BoolResultWrapper",null,[]);vm(Lf,Rf);Lf.prototype.Hye=function(){var G=this,ka=yh.a.Ra.Kb,d=[];return new Promise(function(w){qi.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(I){I.isFeatureEnabled("ExcelOfficeScripting",!1).then(function(ha){d.push(Object.assign(new Mf.a,{name:"IsLicensed",bool:ha}));Fa.a(De.a.duf,!0,vi.getElapsedMilliseconds(ka,yh.a.Ra.Kb),d);G.Vx=new xf(ha,!0);w(ha)}).catch(function(ha){d.push(Object.assign(new Mf.a,
{name:"IsLicensed",bool:!1}));d.push(Object.assign(new Mf.a,{name:"Error",string:ha.toString()}));d.push(Object.assign(new Mf.a,{name:"ErrorCode",string:"exception"}));Fa.a(De.a.duf,!1,vi.getElapsedMilliseconds(ka,yh.a.Ra.Kb),d);G.Vx=new xf(!1,!1,void 0,"exception",ha.toString());w(!1)})})})};Object(de.a)(Lf,"AutomateCommandLicensing",Rf,[]);var qj=b(1283),rj=b(1281),ij=b(1280),Ig=b(1282);ue.taskPaneWidth="TaskPaneWidth";ue.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";ue.dl=
"TaskPaneTitle";ue.Nj="IconCssClass";ue.ZUd="TaskPaneIconUrl";ue.AS="TaskPaneIconId";ue.gI="NonPersistedSettings";ue.onTaskPaneClose="OnTaskPaneClose";ue.pTc="ActionArgs";Object(de.a)(ue,"PropertyNames",null,[]);var Oj=b(139),Kj=b(178),Ti=b(305),Ii=b(4);vm(ae,Ee);ae.prototype.Qbc=function(G){switch(G){case "1":case "2":case "3":return this.ky.hK(parseInt(G,10)-1);default:return this.automateCommandManager.Kk.iz(G)||this.automateCommandManager.hg.iz(G)||this.automateCommandManager.zr.iz(G)}};ae.prototype.Uac=
function(G,ka,d){var w=null;if(this.automateCommandManager.Sva)switch(G){case "1":case "2":case "3":w=this.ky.hK(parseInt(G,10)-1);break;default:w=this.ky.iz(G)}Wi.a.isReactRibbonEnabled()?(d=Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?2===d:!Zh.a.Rf.QC,ka[Gb.a.GalleryButtonProps]=Gd.h4b(G,w,d)):ka[Gb.a.InnerHTML]=Gd.UWe(w);ka[Gb.a.Alt]=w?w.name:""};ae.prototype.rB=function(G){this.ky=this.pGb();this.$.If();var ka=[];ka.push(Object.assign(new Mf.a,
{name:"Operation",string:G}));ka.push(Object.assign(new Mf.a,{name:"HasReadRecentCachedScripts",bool:this.automateCommandManager.Tva}));ka.push(Object.assign(new Mf.a,{name:"ReadScriptsDone",bool:this.automateCommandManager.ZKa}));ka.push(Object.assign(new Mf.a,{name:"ReadSamplesScriptsDone",bool:this.automateCommandManager.U6}));ka.push(Object.assign(new Mf.a,{name:"SamplesScriptCount",int64:this.automateCommandManager.zr.length}));ka.push(Object.assign(new Mf.a,{name:"ReadRecentScriptsDone",bool:this.automateCommandManager.Yca}));
ka.push(Object.assign(new Mf.a,{name:"RecentScriptCount",int64:this.automateCommandManager.Kk.length}));ka.push(Object.assign(new Mf.a,{name:"ReadWorkbookScriptsDone",bool:this.automateCommandManager.mt}));ka.push(Object.assign(new Mf.a,{name:"WorkbookScriptCount",int64:this.automateCommandManager.hg.length}));Fa.a(De.a.Wyd,!0,0,ka)};ae.prototype.Ucc=function(G){var ka=!1,d="",w=new Oc(G.scriptMetadata),I={Operation:"HandleRefreshRibbonGallery"};I.RefreshOperation=G.operationName;switch(G.operationName){case $c.a.DHd:G=
this.owb(w);d=G.message;ka=G.returnValue;break;case $c.a.BHd:G=this.mwb(w);d=G.message;ka=G.returnValue;break;case $c.a.AHd:G=this.lwb(w);d=G.message;ka=G.returnValue;break;case $c.a.CHd:G=this.nwb(w);d=G.message;ka=G.returnValue;break;case $c.a.qOf:G=this.ejd(w),d=G.message,ka=G.returnValue}(I.GalleryUpdated=ka)?(Se.ULS.sendTraceTag(537170319,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",d),this.rB("RefreshGallery")):Se.ULS.sendTraceTag(537170318,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",
d);I.Message=d;Se.ULS.sendTraceTag(537170317,0,50,Rh.c(I))};ae.prototype.pGb=function(){for(var G=new Ed([],function(){}),ka=this.automateCommandManager.hg?this.automateCommandManager.hg.length:0,d=this.automateCommandManager.Kk?this.automateCommandManager.Kk.length:0,w=this.automateCommandManager.zr?this.automateCommandManager.zr.length:0,I=0,ha=0;ha<$c.a.LEd;ha++)if(ha<ka)G.$n(this.automateCommandManager.hg.hK(ha));else if(ha-ka+I<d){var wa=this.automateCommandManager.Kk.hK(ha-ka+I);this.automateCommandManager.hg.iz(wa.id)?
(I++,ha--):G.$n(wa)}else ha-ka-d+I<w&&G.$n(this.automateCommandManager.zr.hK(ha-ka+I-d));return G};ae.prototype.owb=function(G){if(this.automateCommandManager.Kk.yYa(G))var ka="";else{ka="";var d=G.Vha();this.automateCommandManager.hg.Gea(d);this.automateCommandManager.hg.sort();this.automateCommandManager.Kk.Gea(G)}return{returnValue:!0,message:ka}};ae.prototype.mwb=function(G){this.automateCommandManager.hg.xia(G.id);return this.automateCommandManager.Kk.xia(G.id)?{returnValue:!0,message:""}:{returnValue:!1,
message:"Deleting a script but script could not be found in recent script collection."}};ae.prototype.lwb=function(G){var ka=G.Vha();ka.shareId=null;this.automateCommandManager.Kk.yYa(ka);return this.automateCommandManager.hg.$n(G)?(this.automateCommandManager.hg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};ae.prototype.nwb=function(G){return this.automateCommandManager.hg.xia(G.id)?{returnValue:!0,message:""}:{returnValue:!1,
message:"Detaching a script but the script could not be found in the collection."}};ae.prototype.ejd=function(G){var ka=G.Vha(),d=!1;this.automateCommandManager.hg.Pgc(ka)&&(this.automateCommandManager.hg.Gea(ka),this.automateCommandManager.hg.sort(),d=!0);this.automateCommandManager.Kk.yYa(G)?d=!0:this.automateCommandManager.Kk.Pgc(G)&&(this.automateCommandManager.Kk.Gea(G),this.automateCommandManager.Kk.vrf(G),d=!0);return{returnValue:d,message:""}};Object(de.a)(ae,"AutomateCommandGalleryOld",Ee,
[]);var Gj=b(19);Uc.W5f=function(G){G.sort(function(ka,d){return d.CGe-ka.CGe})};Uc.uLb=function(G){G.sort(function(ka,d){return Gj.a.compare(ka.name,d.name,!0)})};Uc.U3e=function(G){var ka;var d=ka=null;if(G){var w=G.indexOf(":");if(-1!==w)return ka=G.substr(0,w),d=G.substr(w+1),{returnValue:!0,UTd:ka,shareId:d}}return{returnValue:!1,UTd:ka,shareId:d}};Uc.IYh=function(G,ka){var d={};d[$c.a.qhg]=encodeURIComponent(G.workbookContext.WorkbookFileName);d[$c.a.ZWf]=ka.heb();return Rh.c(d)};Uc.iNf=function(G,
ka){return Bh.TaskExtensions.I$(ka.kKa($c.a.Dfb),function(d){d=d.result;if(""!==d){d=Rh.b(d);var w=d[$c.a.ZWf];if(d[$c.a.qhg]===encodeURIComponent(G.workbookContext.WorkbookFileName)){d=new Ed([],function(ha){Uc.uLb(ha)});w=yl(w);for(var I=w.next();!I.done;I=w.next())d.$n(new Oc(I.value));d.sort();return d}}},G.ma,3)};Sk.Object.defineProperties(Uc.prototype,{Sva:{configurable:!0,enumerable:!0,get:function(){var G=$c.a.LK?this.Tva:this.S4;return this.U6||G||this.ZKa}},ZKa:{configurable:!0,enumerable:!0,
get:function(){return($c.a.LK?this.Yca:this.T6)&&this.mt&&this.U6}}});Object(de.a)(Uc,"AutomateCommandStorageBase",null,[]);Object(de.a)(Sc,"UserInfo",null,[]);var lk=b(521),mk=b(164),Ci=b(81),ri=b(272);Object(de.a)(Tc,"LaunchSDXParams",null,[]);Object(de.a)(Nd,"RunfromButtonParameters",null,[]);var yk=b(153),rk=b(114),al=b(27),Tk=b(913),Ik=b(48),Fj=b(100),Bk=b(46),Ck=b(168);Wc.prototype.Ivj=function(G){$c.a.Jq?this.Ke.Hm=G:this.Aee=G};Wc.prototype.Hvj=function(G){$c.a.Jq?this.Ke.hg=G:this.Yce=G};
Wc.prototype.Lvj=function(G){$c.a.Jq?this.Ke.zr=G:this.bge=G};Wc.prototype.Jvj=function(G){this.Ke.Kk=G};Wc.prototype.LKb=function(G){var ka=fg.AFrameworkApplication.ga.ra("IsO365CommercialHost"),d="",w="",I=!1;var ha=!(this.Ov.Vx&&this.Ov.Vx.isSuccess&&this.Ov.Vx.value&&(!this.oA||!this.oA.isSuccess));this.Ov.Vx&&!this.Ov.Vx.isSuccess?(w=this.Ov.Vx.errorCode,d=this.Ov.Vx.errorMessage):this.oA&&!this.oA.isSuccess&&(w=this.oA.errorCode,d=this.oA.errorMessage);var wa=[];wa.push(Object.assign(new Mf.a,
{name:"IsScriptingEnabled",bool:this.Gba}));wa.push(Object.assign(new Mf.a,{name:"IsValidHost",bool:ka}));wa.push(Object.assign(new Mf.a,{name:"IsUserLicensed",bool:this.Ov.Vx?this.Ov.Vx.value:!1}));wa.push(Object.assign(new Mf.a,{name:"IsAdminSwitchOn",bool:this.oA?this.oA.value:!1}));wa.push(Object.assign(new Mf.a,{name:"ShowTab",bool:this.Gba}));wa.push(Object.assign(new Mf.a,{name:"ServiceChecked",bool:!G}));this.Gba&&Wi.a.bxa(this.$)&&(G=yk.a(this.$),(null===G||void 0===G?0:G.Im)?(wa.push(Object.assign(new Mf.a,
{name:"RibbonType",string:"React"})),G.Im.MCj(Ii.a.kGb),ka=["AutomateRecorder","AutomateNewScript","AutomateGallery","AutomateAllScripts"],Gf.EwaSettings.getBooleanFeatureGate($c.a.Lsf,!1)?G.Im.TJb(["AutomateAutomateTask"],!$c.a.Yyd):(G.Im.TJb(ka,!1),$c.a.Yyd&&G.Im.TJb(["AutomateAutomateTask"],!1)),Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(I=!0)):(w="ribbon_manager_error",
d="The RibbonManager or RibbonUser is null"));wa.push(Object.assign(new Mf.a,{name:"Error",string:d}));wa.push(Object.assign(new Mf.a,{name:"ErrorCode",string:w}));Fa.a(De.a.wGi,ha,vi.getElapsedMilliseconds(this.initTime,yh.a.Ra.Kb),wa);return Promise.resolve(I)};Wc.prototype.fd=function(G,ka){if(!ka)return!1;ka.MenuItems=this.sNg.CIh(ka.MenuId);return!0};Wc.prototype.gIf=function(){var G=this;if(this.Nwa)if($c.a.LK)this.Ke.fNf(this.ZP).continueWith(function(w){w.result&&G.ZP.rB($c.a.dQa)});else if($c.a.Jq)this.Ke.V6i(this.ZP);
else{var ka=yh.a.Ra.Kb,d=[];Bh.TaskExtensions.Ba(this.indexedDB.kKa($c.a.OPa),function(w){var I=!G.T6||!G.Hm.length;w=w.result;d.push(Object.assign(new Mf.a,{name:"ExistingScriptCount",int64:G.Hm.length}));if(""!==w)if(w=Rh.b(w),d.push(Object.assign(new Mf.a,{name:"CachedScriptCount",int64:w.length})),I){for(var ha=yl(w),wa=ha.next();!wa.done;wa=ha.next())G.Hm.$n(new Oc(wa.value));G.Hm.sort();G.S4=!0;G.xab=0<w.length;Fa.a(De.a.SCb,I,vi.getElapsedMilliseconds(ka,yh.a.Ra.Kb),d);G.rB("CachedScripts")}else Fa.a(De.a.SCb,
I,vi.getElapsedMilliseconds(ka,yh.a.Ra.Kb),d);else Fa.a(De.a.SCb,I,vi.getElapsedMilliseconds(ka,yh.a.Ra.Kb),d)},this.$.ma,3)}Cc(this.$)?this.e3e(Object.assign(new O.a,{IsSuccess:!0,Token:"FakeToken"})):this.lsa.lbc().then(function(w){G.e3e(w)})};Wc.prototype.Uac=function(G,ka,d){if($c.a.LK)this.ZP.Uac(G,ka,d);else{var w=null;if(this.Sva)switch(G){case "1":case "2":case "3":w=this.ky.hK(parseInt(G,10)-1);break;default:w=this.ky.iz(G)}ka[Gb.a.GalleryButtonProps]=Gd.h4b(G,w,this.Xoi?2===d:!Zh.a.Rf.QC);
ka[Gb.a.Alt]=w?w.name:""}};Wc.prototype.Ucc=function(G){if($c.a.LK)this.ZP.Ucc(G);else{var ka=!1,d="",w=new Oc(G.scriptMetadata),I={Operation:"HandleRefreshRibbonGallery"};I.RefreshOperation=G.operationName;switch(G.operationName){case $c.a.DHd:G=this.owb(w);d=G.message;ka=G.returnValue;break;case $c.a.BHd:G=this.mwb(w);d=G.message;ka=G.returnValue;break;case $c.a.AHd:G=this.lwb(w);d=G.message;ka=G.returnValue;break;case $c.a.CHd:G=this.nwb(w),d=G.message,ka=G.returnValue}(I.GalleryUpdated=ka)?(Se.ULS.sendTraceTag(537170313,
0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",d),this.rB("RefreshGallery")):Se.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",d);I.Message=d;Se.ULS.sendTraceTag(537170311,0,50,Rh.c(I))}};Wc.prototype.t5h=function(G,ka,d,w){this.$.Ns(null,!1,1023)&&(G=new Nd($c.a.wVf,G,ka,d,this.Gba,w),this.Eob.pwb(G))};Wc.prototype.w7e=function(G,ka,d){G=new Nd($c.a.oXj,G,ka,d,this.Gba);this.Eob.pwb(G)};
Wc.prototype.j3h=function(G){this.Eob.Hid($c.a.ZCj,G)};Wc.prototype.i3h=function(G){this.Eob.Hid($c.a.W1g,G)};Wc.prototype.k3h=function(G){this.Eob.Hid($c.a.gHj,G)};Wc.prototype.esi=function(G,ka){var d=Ik.b().ui(G),w=[];w.push(Object.assign(new Mf.a,{name:"SessionId",string:this.$.ya.UserSessionId}));w.push(Object.assign(new Mf.a,{name:"MenuItemId",string:ka}));w.push(Object.assign(new Mf.a,{name:"WorkbookScriptCount",int64:this.hg.length}));w.push(Object.assign(new Mf.a,{name:"PublishedScriptCount",
int64:this.Hm.length}));w.push(Object.assign(new Mf.a,{name:"RecentScriptCount",int64:this.Kk.length}));w.push(Object.assign(new Mf.a,{name:"Command",string:d}));ka=ka?this.Qbc(ka):null;if(d=this.YSh(G,d,ka))w.push(Object.assign(new Mf.a,{name:$c.a.u$,string:d.Tya.ir[$c.a.u$]})),qj.a.instance.qNa(d.Mzh,"Taskpane",d.kHa,d.Bkd,d.Tya),1904816141===G&&(w.push(Object.assign(new Mf.a,{name:"ScriptId",string:ka.id})),w.push(Object.assign(new Mf.a,{name:"ShareId",string:ka.shareId})),w.push(Object.assign(new Mf.a,
{name:"IsPreviewGallery",bool:$c.a.LK?!!this.ZP.ky.iz(ka.id):!!this.ky.iz(ka.id)})),w.push(Object.assign(new Mf.a,{name:"IsOwner",bool:ka.wdf||!!this.Hm.iz(ka.id)})),this.$.If());Fa.a(De.a.tGi,void 0,void 0,w)};Wc.prototype.YSh=function(G,ka,d){var w=null,I=$c.a.Er,ha=new rj.a($c.a.X9e,$c.a.NVe,$c.a.locale),wa=new ij.a($c.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,$c.a.Huc),$a=new Ig.a;$a.ir.AdminPolicyForFeedback=Rh.c(this.VFa);$a.ir.DocumentHostInfo=cj.a.Kc(this.$.ya.DocumentHostInfo);$a.ir.CodeEditorUrl=
$c.a.Tub(this.$);$a.ir.MakerTestService=Gf.EwaSettings.getBooleanFeatureGate($c.a.IBb,!1);$a.ir[$c.a.PUf]=$c.a.o3a(this.$);$a.ir.StorageModePreference=this.n7f||"";$a.ir.Source="Ribbon";$a.ir.IsTeams=kj.a.ala;$a.ir[$c.a.c9f]=cj.a.Kc(I);$a.ir[$c.a.iue]=this.$.cuf?"true":"false";$a.ir[$c.a.u$]=Kj.a.create().toString();var Tb=oc(this.$),Ic=Yc(this.$);$a.si.HeaderCssClass=Tb;$a.si.TitleCssClass=Ic;$a.ir[$c.a.U8e]=Tb;$a.ir[$c.a.j$f]=Ic;Tb={};Tb.ribbonCommand=ka;Tb[$c.a.m7f]=this.lsa.getAuthContext();Tb[$c.a.OPa]=
this.xab?this.Hm.heb():null;Tb[$c.a.Dfb]=this.Aza?this.hg.heb():null;$c.a.LK&&(Tb[$c.a.dQa]=this.Ke.RGd?this.Kk.heb():null);$a.ir[$c.a.$bf]=cj.a.Kc(Tb);ka={};Hc(this.$,ka);$a.ir[$c.a.XUe]=cj.a.Kc(ka);switch(G){case -45542983:$a.ir.Script="";$a.ir.Destination="Editor";$a.ir.IsOwner=!0;$a.si[ue.dl]=zf.a.instance.fa(2068);$a.si[ue.taskPaneWidth]=I;$a.si[ue.sourceLocationOverrideResourceId]=$c.a.Tub(this.$);w=$c.a.t1c;break;case -1342227603:$a.si[ue.dl]=zf.a.instance.fa(2070);$a.si[ue.taskPaneWidth]=
I;$a.si[ue.sourceLocationOverrideResourceId]=$c.a.r2e(this.$);break;case 971811139:case 1606046412:$a.ir.Script="";$a.ir.Destination="BackStage";$a.ir.IsOwner=!0;$a.si[ue.dl]=zf.a.instance.fa(2068);$a.si[ue.taskPaneWidth]=I;$a.si[ue.sourceLocationOverrideResourceId]=$c.a.Tub(this.$);w=$c.a.t1c;break;case 1845457202:$a.si[ue.dl]=zf.a.instance.fa(2069);$a.si[ue.taskPaneWidth]=I;$a.si[ue.sourceLocationOverrideResourceId]=$c.a.I2e(this.$);w=$c.a.fmj;break;case 1904816141:if(d)$a.ir.Script=cj.a.Kc(d.QVd()),
$a.ir.Destination="Details",$a.ir.IsOwner=d.wdf||!!this.Hm.iz(d.id),$a.si[ue.dl]=zf.a.instance.fa(2068),$a.si[ue.taskPaneWidth]=I,$a.si[ue.sourceLocationOverrideResourceId]=$c.a.Tub(this.$),w=$c.a.t1c;else return null;break;default:return null}return new Tc(ha,wa,$a,w)};Wc.prototype.NJh=function(){var G=this;qi.a.instance.oc("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(ka){G.VFa.FeedbackEnabled=!0;G.VFa.ScreenshotEnabled=!0;G.VFa.EmailEnabled=!0;ka.$J("Enabled").then(function(d){G.VFa.FeedbackEnabled=
d},function(){});ka.$J("IncludeScreenshot").then(function(d){G.VFa.ScreenshotEnabled=d},function(){});ka.$J("IncludeEmail").then(function(d){G.VFa.EmailEnabled=d},function(){})})};Wc.prototype.Z5h=function(G){var ka=this,d=yh.a.Ra.Kb,w=[];if(!G||!G.IsSuccess){var I=G?G.ErrorCode:"need_token";G=G?G.ErrorMessage:"No Access Token";w.push(Object.assign(new Mf.a,{name:"ServiceChecked",bool:!1}));w.push(Object.assign(new Mf.a,{name:"Error",string:G}));w.push(Object.assign(new Mf.a,{name:"ErrorCode",string:I}));
Fa.a(De.a.Uyd,!1,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),w);this.oA=new xf(!1,!1,void 0,I,G);return Promise.resolve(!1)}w.push(Object.assign(new Mf.a,{name:"ServiceChecked",bool:!0}));nb(this.$,G.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(ha){ka.oA=new xf(ha.OfficeScriptingEnabled,!0);ka.qZc($c.a.Y$b(ka.$),ha.OfficeScriptingEnabled);w.push(Object.assign(new Mf.a,{name:"IsEnabled",bool:ka.oA.value}));Fa.a(De.a.Uyd,!0,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),
w);return Promise.resolve(ka.oA.value)}).catch(function(ha){Object.getType(ha)===makerstorage.StorageServiceError?(w.push(Object.assign(new Mf.a,{name:"Error",string:ha.message})),w.push(Object.assign(new Mf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",ha.errorCode.toString(),ha.status.toString())}))):(w.push(Object.assign(new Mf.a,{name:"Error",string:ha.toString()})),w.push(Object.assign(new Mf.a,{name:"ErrorCode",string:"exception"})));Fa.a(De.a.Uyd,!1,vi.getElapsedMilliseconds(d,
yh.a.Ra.Kb),w);ka.oA=new xf(!1,!1,void 0,"exception",ha.toString());return Promise.resolve(!1)})};Wc.prototype.SGd=function(G){var ka=this;if($c.a.Jq)return this.Ke.SGd(G,this.ZP);var d=new Oj.a,w=ze(this.$);return Ae(this.$,function(I){if((I=I.Result)&&200===I.ResponseStatusCode)I=JSON.parse(I.ResponseBody.join("")),G(ka.cDd(I.value)),d.setResult(!0);else{I=I?"RichApi_"+I.ResponseStatusCode:"RichApiError";var ha=[];ha.push(Object.assign(new Mf.a,{name:"Error",string:"Failed to read shared script ids from document"}));
ha.push(Object.assign(new Mf.a,{name:"ErrorCode",string:I}));ka.mt=!0;ka.sU(yh.a.Ra.Kb,0,ha);d.setResult(!1)}},function(I){I=rk.a.og(I.data);Se.ULS.sendTraceTag(537170310,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery. {0}",al.a.Tc(I));var ha=[];ha.push(Object.assign(new Mf.a,{name:"Error",string:"Failure using rich api: "+I}));ha.push(Object.assign(new Mf.a,{name:"ErrorCode",string:"RichApiFailure"}));ka.mt=!0;ka.sU(yh.a.Ra.Kb,0,ha);d.setResult(!1)},w,d)};Wc.prototype.e3e=
function(G){var ka=this;this.Ngd();$c.a.LK?this.Ke.hXh(G,this.ZP,this.cache):this.FWh(G);this.SGd(function(d){ka.$gd(d,G)})};Wc.prototype.Ngd=function(){if($c.a.Jq)this.Ke.Ngd(this.ZP);else{var G={id:"samples-2"};G.name=zf.a.instance.fa(2082);this.zr.$n(new Oc(G));G.id="samples-4";G.name=zf.a.instance.fa(2083);this.zr.$n(new Oc(G));G.id="samples-5";G.name=zf.a.instance.fa(2084);this.zr.$n(new Oc(G));this.U6=!0;this.rB("SampleScripts")}};Wc.prototype.FWh=function(G){var ka=this,d=yh.a.Ra.Kb,w=[];if(G&&
G.IsSuccess){nb(this.$,G.Token);var I=Li.a.create().toString();w.push(Object.assign(new Mf.a,{name:"CorrelationId",string:I}));makerstorage.getScripts(I).then(function(ha){w.push(Object.assign(new Mf.a,{name:"HasReadCachedScripts",bool:ka.S4}));ka.Hm.clear();ha=yl(ha);for(var wa=ha.next();!wa.done;wa=ha.next())ka.Hm.$n(new Oc(wa.value));ka.Hm.sort();ka.xab=!0;ka.T6=!0;ka.Nwa&&(ha=cj.a.Kc(ka.Hm.heb()),ka.indexedDB.Vbb(new Tk.a($c.a.OPa,ha)));w.push(Object.assign(new Mf.a,{name:"ScriptCount",int64:ka.Hm.length}));
Fa.a(De.a.TCb,!0,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),w);ka.rB($c.a.OPa)}).catch(function(ha){Object.getType(ha)===makerstorage.StorageServiceError?(w.push(Object.assign(new Mf.a,{name:"Error",string:ha.message})),w.push(Object.assign(new Mf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",ha.errorCode.toString(),ha.status.toString())})),17===ha.errorCode&&ka.cache.HId($c.a.Y$b(ka.$))):(w.push(Object.assign(new Mf.a,{name:"Error",string:ha.toString()})),w.push(Object.assign(new Mf.a,
{name:"ErrorCode",string:"exception"})));Fa.a(De.a.TCb,!1,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),w);ka.T6=!0;ka.rB($c.a.OPa)})}else I=G?G.ErrorCode:"need_token",G=G?G.ErrorMessage:"No Access Token",w.push(Object.assign(new Mf.a,{name:"ServiceChecked",bool:!1})),w.push(Object.assign(new Mf.a,{name:"Error",string:G})),w.push(Object.assign(new Mf.a,{name:"ErrorCode",string:I})),Fa.a(De.a.TCb,!1,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),w),this.T6=!0,this.rB($c.a.OPa)};Wc.prototype.$gd=function(G,ka){var d=
this;if($c.a.Jq)this.Ke.$gd(G,ka,this.ZP);else{var w=yh.a.Ra.Kb,I=0,ha=0;this.mt=I===G.count;var wa=[];wa.push(Object.assign(new Mf.a,{name:"ScriptIds",int64:G.count}));if(G.count)if(ka&&ka.IsSuccess){nb(this.$,ka.Token);var $a={};ka=yl(G);for(var Tb=ka.next();!Tb.done;$a={Ofb:$a.Ofb},Tb=ka.next())Tb=Tb.value,$a.Ofb=Li.a.create().toString(),makerstorage.getSharedScript(Tb.value,$a.Ofb).then(function(Ic){return function(pc){var vd=[];vd.push(Object.assign(new Mf.a,{name:"BodySize",int64:pc.body.length}));
vd.push(Object.assign(new Mf.a,{name:"CorrelationId",string:Ic.Ofb}));Fa.a(De.a.jmc,!0,vi.getElapsedMilliseconds(w,yh.a.Ra.Kb),vd);I++;pc=new Oc(pc);pc.shareId=G.oa(pc.id);d.hg.$n(pc);d.mt=I===G.count;d.Aza=!0;d.sU(w,ha,wa)}}($a)).catch(function(Ic){return function(pc){var vd=[];Object.getType(pc)===makerstorage.StorageServiceError?(wa.push(Object.assign(new Mf.a,{name:"Error",string:pc.message})),wa.push(Object.assign(new Mf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",pc.errorCode.toString(),
pc.status.toString())}))):(vd.push(Object.assign(new Mf.a,{name:"Error",string:pc.toString()})),vd.push(Object.assign(new Mf.a,{name:"ErrorCode",string:"exception"})));vd.push(Object.assign(new Mf.a,{name:"CorrelationId",string:Ic.Ofb}));Fa.a(De.a.jmc,!1,vi.getElapsedMilliseconds(w,yh.a.Ra.Kb),vd);I++;ha++;d.mt=I===G.count;d.sU(w,ha,wa)}}($a))}else $a=ka?ka.ErrorCode:"need_token",ka=ka?ka.ErrorMessage:"No Access Token",wa.push(Object.assign(new Mf.a,{name:"Error",string:ka})),wa.push(Object.assign(new Mf.a,
{name:"ErrorCode",string:$a})),this.mt=!0,this.sU(w,ha,wa);else this.mt=this.Aza=!0,this.sU(w,ha,wa)}};Wc.prototype.sU=function(G,ka,d){this.mt&&(d.push(Object.assign(new Mf.a,{name:"ScriptCount",int64:this.hg.length})),d.push(Object.assign(new Mf.a,{name:"ScriptErrorCount",int64:ka})),Fa.a(De.a.fuf,!ka,vi.getElapsedMilliseconds(G,yh.a.Ra.Kb),d),this.hg.sort(),this.rB($c.a.Dfb))};Wc.prototype.cDd=function(G){var ka=new Fj.a;if(G=Wc.Rta.parseFromString(G,"text/xml").querySelector('[id="script-ids-node-id"]')){G=
G.getElementsByTagName("scriptId");for(var d={},w=0;w<G.length;d={rPb:d.rPb,oPb:d.oPb,iPb:d.iPb},w++)d.rPb=G[w].getAttribute("id"),d.rPb&&(d.oPb=void 0,d.iPb=void 0,function(I){return function(){var ha=Uc.U3e(I.rPb);I.oPb=ha.UTd;I.iPb=ha.shareId;return ha}}(d)().returnValue&&ka.ia(d.oPb,d.iPb))}return ka};Wc.prototype.Qbc=function(G){if($c.a.LK)return this.ZP.Qbc(G);switch(G){case "1":case "2":case "3":return this.ky.hK(parseInt(G,10)-1);default:return this.Hm.iz(G)||this.hg.iz(G)||this.zr.iz(G)}};
Wc.prototype.owb=function(G){if(this.Hm.$n(G)){this.Hm.sort();var ka=""}else{ka="";var d=G.Vha();this.hg.Gea(d);this.hg.sort();this.Hm.Gea(G);this.Hm.sort()}return{returnValue:!0,message:ka}};Wc.prototype.mwb=function(G){this.hg.xia(G.id);return this.Hm.xia(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};Wc.prototype.lwb=function(G){var ka=G.Vha();ka.shareId=null;this.Hm.$n(ka)&&this.Hm.sort();return this.hg.$n(G)?
(this.hg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};Wc.prototype.nwb=function(G){return this.hg.xia(G.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};Wc.prototype.rB=function(G){if($c.a.LK)this.ZP.rB(G);else{this.pGb();this.$.If();var ka=[];ka.push(Object.assign(new Mf.a,{name:"Operation",string:G}));ka.push(Object.assign(new Mf.a,{name:"HasReadCachedScripts",
bool:this.S4}));ka.push(Object.assign(new Mf.a,{name:"ReadScriptsDone",bool:this.ZKa}));ka.push(Object.assign(new Mf.a,{name:"ReadSamplesScriptsDone",bool:this.U6}));ka.push(Object.assign(new Mf.a,{name:"SamplesScriptCount",int64:this.zr.length}));ka.push(Object.assign(new Mf.a,{name:"ReadPublishedScriptsDone",bool:this.T6}));ka.push(Object.assign(new Mf.a,{name:"PublishedScriptCount",int64:this.Hm.length}));ka.push(Object.assign(new Mf.a,{name:"ReadWorkbookScriptsDone",bool:this.mt}));ka.push(Object.assign(new Mf.a,
{name:"WorkbookScriptCount",int64:this.hg.length}));Fa.a(De.a.Wyd,!0,0,ka)}};Wc.prototype.pGb=function(){this.ky=new Ed([],function(){});for(var G=this.hg?this.hg.length:0,ka=this.Hm?this.Hm.length:0,d=this.zr?this.zr.length:0,w=0,I=0;I<$c.a.LEd;I++)if(I<G)this.ky.$n(this.hg.hK(I));else if(I-G+w<ka){var ha=this.Hm.hK(I-G+w);this.hg.iz(ha.id)?(w++,I--):this.ky.$n(ha)}else I-G-ka+w<d&&this.ky.$n(this.zr.hK(I-G+w-ka))};Wc.prototype.qZc=function(G,ka){if($c.a.Jq)this.Ke.qZc(G,ka);else if(this.cache.rg()){var d=
{};d.TimeStamp=yh.a.Ra.Kb;d.IsEnabled=ka;this.cache.bwc(G,cj.a.Kc(d))}};Wc.prototype.Gdd=function(G){if($c.a.Jq)return this.Ke.Gdd(G);var ka=!1,d=!1,w=null;this.cache.rg()&&(G=Rh.b(this.cache.S3a(G)))&&(d=G.IsEnabled,w=new Date(G.TimeStamp),ka=!0);return new xf(d,ka,w)};Wc.prototype.mKd=function(G){Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(G?(Bk.PageLoadTrackingInfo.instance.b7(Ii.a.oO,
["automateTab"]),Bk.PageLoadTrackingInfo.instance.n0(Ii.a.oO,["automateTab"]),Bk.PageLoadTrackingInfo.instance.VW(Ii.a.oO,["automateTab"])):(Bk.PageLoadTrackingInfo.instance.CQa(Ii.a.oO,["automateTab"]),Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&Ck.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(Ii.a.kGb))))};Sk.Object.defineProperties(Wc.prototype,{Hm:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq?this.Ke.Hm:this.Aee}},
hg:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq?this.Ke.hg:this.Yce}},zr:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq?this.Ke.zr:this.bge}},Kk:{configurable:!0,enumerable:!0,get:function(){return this.Ke.Kk}},Sa:{configurable:!0,enumerable:!0,get:function(){return this.NPc}},U6:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq?this.Ke.U6:this.Tee},set:function(G){$c.a.Jq?this.Ke.U6=G:this.Tee=G}},mt:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq?
this.Ke.mt:this.Vee},set:function(G){$c.a.Jq?this.Ke.mt=G:this.Vee=G}},Yca:{configurable:!0,enumerable:!0,get:function(){return this.Ke.Yca}},Tva:{configurable:!0,enumerable:!0,get:function(){return this.Ke.Tva}},ZKa:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq?this.Ke.ZKa:($c.a.LK?this.Yca:this.T6)&&this.mt&&this.U6}},Sva:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq?this.Ke.Sva:($c.a.LK?this.Tva:this.S4)||this.ZKa}},ky:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq||
$c.a.LK?this.ZP.ky:this.pee},set:function(G){$c.a.Jq||$c.a.LK?this.ZP.ky=G:this.pee=G}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.Dqg}},Gba:{configurable:!0,enumerable:!0,get:function(){var G=!!this.Ov.Vx&&this.Ov.Vx.isSuccess&&this.Ov.Vx.value,ka=!!this.oA&&!this.oA.isSuccess,d=!!this.oA&&this.Ov.Vx.isSuccess&&this.oA.value;return this.Xif&&G&&(d||ka&&!kj.a.Xka(11))}},xab:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq?this.Ke.xab:this.Ree},set:function(G){$c.a.Jq?
this.Ke.xab=G:this.Ree=G}},Aza:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq?this.Ke.Aza:this.Uee},set:function(G){$c.a.Jq?this.Ke.Aza=G:this.Uee=G}},S4:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq?this.Ke.S4:this.D7d},set:function(G){$c.a.Jq?this.Ke.S4=G:this.D7d=G}},T6:{configurable:!0,enumerable:!0,get:function(){return $c.a.Jq?this.Ke.T6:this.See},set:function(G){$c.a.Jq?this.Ke.T6=G:this.See=G}},Xif:{configurable:!0,enumerable:!0,get:function(){var G="TestHost"===
this.$.ya.DocumentHostInfo.HostTier,ka=fg.AFrameworkApplication.ga.Ua("UserPrincipalName");ka=!fg.AFrameworkApplication.ga.ra("IsAnonymousUser")&&!!ka&&!ka.includes("ext#")&&!ka.includes("guest#");return!kj.a.Uwa&&(G||this.lsa.ote&&ka)}}});Wc.Rta=new DOMParser;Object(de.a)(Wc,"AutomateCommandManager",null,[430]);var Lj=b(1339),Pj=b(1285),Hj=b(232);mc.key="InsertAgaveClientSideParametersKey";Object(de.a)(mc,"InsertAgaveClientSideParameters",null,[]);var gj=b(56),sk=b(102),dj=b(20),zk=b(1096);yb.prototype.pwb=
function(G){if(G.Gba){var ka=[];ka.push(Object.assign(new Mf.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.$6a}));ka.push(Object.assign(new Mf.a,{name:"actionName",string:G.actionName}));ka.push(Object.assign(new Mf.a,{name:$c.a.u$,string:G.clickId.toString()}));this.$6a?this.RXf(G):this.S3h(G);Fa.a(De.a.uGi,void 0,void 0,ka)}};yb.prototype.Hid=function(G,ka){var d={};d[$c.a.u$]=ka;this.GNd(G,d)};yb.prototype.cwj=function(){this.O2f()?this.MIf():dj.g(this.$).Ca.qne(this.i9a)};yb.prototype.O2f=
function(){if(this.$6a||Cc(this.$))return!1;var G=sk.a(this.$);return dj.g(this.$).Ca.NZb&&G.Jfi()};yb.prototype.MIf=function(){var G=this;this.Ov.Vx?this.Ov.Vx.value&&this.lsa.lbc():this.Ov.Hye().then(function(ka){ka&&G.lsa.lbc()});Fa.a(De.a.qGi)};yb.prototype.roj=function(){var G=Kj.a.create().toString(),ka={};Hc(this.$,ka);var d={};d[$c.a.m7f]=this.lsa.getAuthContext();var w={};w[$c.a.XUe]=cj.a.Kc(ka);w[$c.a.$bf]=cj.a.Kc(d);w[$c.a.whh]=cj.a.Kc(this.$.ya.DocumentHostInfo);w[$c.a.nHj]=Ve(this.$);
w[$c.a.c9f]=cj.a.Kc($c.a.Er);w[$c.a.iue]=this.$.cuf?"true":"false";w[$c.a.PUf]=$c.a.o3a(this.$);w[$c.a.U8e]=oc(this.$);w[$c.a.j$f]=Yc(this.$);w[$c.a.u$]=G;ka=[];ka.push(Object.assign(new Mf.a,{name:$c.a.u$,string:G}));Fa.a(De.a.sGi,void 0,void 0,ka);this.GNd($c.a.yai,w)};yb.prototype.S3h=function(G){var ka=this;this.vAj(G);Cc(this.$)&&nb(this.$,"localstorage");Bh.TaskExtensions.Ba(gj.GetServiceTaskFactory.Wa(this.$.da,374,375,1),function(d){ka.Jti(d.result).continueWith(function(){ka.qoj(G)});ka.$6a=
!0},this.$.ma,3)};yb.prototype.Jti=function(G){var ka={};ka.SolutionId=$c.a.solutionId;ka.Version=$c.a.Huc;ka.StoreType=OSF.StoreType.Sdx;ka.StoreId=OSF.StoreType.Sdx;ka.AssetId=$c.a.solutionId;ka.AssetStoreId=OSF.StoreType.Sdx;ka.TargetType=1;ka.SharedRuntimeId=$c.a.Fvb(this.$);ka.SourceLocationOverrideResourceId=$c.a.Fvb(this.$);ka.IsToBePersisted=!1;ka.Id=$c.a.solutionId;ka.AppVersion=$c.a.Huc;ka.CurrentStoreType=OSF.StoreType.Sdx;var d=new Lj.a;d.dl=zf.a.instance.fa(2088);d.taskPaneWidth=$c.a.Er;
var w=new mc;w.Zzc=Yc(this.$);w.cba=oc(this.$);return G.HMd(ka,d,void 0,void 0,w)};yb.prototype.qoj=function(G){this.roj();Hj.a(this.$)&&Hj.a(this.$).Cne(this.DJi);this.RXf(G)};yb.prototype.RXf=function(G){var ka={};ka[$c.a.vkj]=G.shapeId;ka[$c.a.ukj]=G.scriptLink;ka[$c.a.u$]=G.clickId.toString();ka[$c.a.tkj]=G.buttonText;this.GNd(G.actionName,ka)};yb.prototype.GNd=function(G,ka){var d=new ij.a($c.a.solutionId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,$c.a.Huc),w=new rj.a($c.a.X9e,$c.a.NVe,this.$.ya.UICultureTag),
I=new Ig.a;I.si[ue.dl]=zf.a.instance.fa(2088);I.si[ue.sourceLocationOverrideResourceId]=$c.a.Fvb(this.$);I.si[ue.pTc]=ka;I.si[ue.taskPaneWidth]=$c.a.Er;qj.a.instance.qNa(d,Pj.a.action,G,w,I)};yb.prototype.vAj=function(G){Gf.EwaSettings.getBooleanFeatureGate($c.a.d9f,!1)&&G.actionName===$c.a.wVf&&(G=new zk.a(G.scriptLink,"initializing",G.clickId.toString(),G.buttonText),this.businessBarManager.xme(63,G))};Object(de.a)(yb,"AutomateCommandRunFromButton",null,[428]);vm(wc,Uc);wc.prototype.qZc=function(G,
ka){if(this.cache.rg()){var d={};d.TimeStamp=yh.a.Ra.Kb;d.IsEnabled=ka;this.cache.bwc(G,cj.a.Kc(d))}};wc.prototype.Gdd=function(G){var ka=!1,d=!1,w=null;this.cache.rg()&&(G=Rh.b(this.cache.S3a(G)))&&(d=G.IsEnabled,w=new Date(G.TimeStamp),ka=!0);return new xf(d,ka,w)};wc.prototype.fNf=function(G){var ka=this,d=yh.a.Ra.Kb,w=[];return Bh.TaskExtensions.I$(this.indexedDB.kKa($c.a.dQa),function(I){var ha=!ka.Yca||!ka.Kk.length;I=I.result;w.push(Object.assign(new Mf.a,{name:"ExistingScriptCount",int64:ka.Kk.length}));
if(""!==I&&(I=Rh.b(I),w.push(Object.assign(new Mf.a,{name:"CachedScriptCount",int64:I.length})),ha)){for(var wa=yl(I),$a=wa.next();!$a.done;$a=wa.next())ka.Kk.$n(new Oc($a.value));ka.Tva=!0;ka.RGd=0<I.length;Fa.a(De.a.euf,ha,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),w);ka.yHd(G);return!0}Fa.a(De.a.euf,ha,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),w);return!1},this.$.ma,3)};wc.prototype.V6i=function(G){Gf.EwaSettings.getBooleanFeatureGate($c.a.NXc,!1)&&this.$6i(G);$c.a.LK?this.fNf(G):this.U6i(G)};wc.prototype.hXh=
function(G,ka,d){var w=this,I=yh.a.Ra.Kb,ha=[];if(G&&G.IsSuccess){nb(this.$,G.Token);var wa=Li.a.create().toString();ha.push(Object.assign(new Mf.a,{name:"CorrelationId",string:wa}));makerstorage.getRecentScripts(wa).then(function($a){ha.push(Object.assign(new Mf.a,{name:"HasReadCachedScripts",bool:w.Tva}));w.Kk.clear();$a=yl($a);for(var Tb=$a.next();!Tb.done;Tb=$a.next())w.Kk.$n(new Oc(Tb.value));w.RGd=!0;w.Yca=!0;w.indexedDB.rg()&&($a=cj.a.Kc(w.Kk.heb()),w.indexedDB.Vbb(new Tk.a($c.a.dQa,$a)));
ha.push(Object.assign(new Mf.a,{name:"ScriptCount",int64:w.Kk.length}));Fa.a(De.a.TCb,!0,vi.getElapsedMilliseconds(I,yh.a.Ra.Kb),ha);ka.rB($c.a.dQa)}).catch(function($a){Object.getType($a)===makerstorage.StorageServiceError?(ha.push(Object.assign(new Mf.a,{name:"Error",string:$a.message})),ha.push(Object.assign(new Mf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",$a.errorCode.toString(),$a.status.toString())})),17===$a.errorCode&&d.HId($c.a.Y$b(w.$))):(ha.push(Object.assign(new Mf.a,
{name:"Error",string:$a.toString()})),ha.push(Object.assign(new Mf.a,{name:"ErrorCode",string:"exception"})));Fa.a(De.a.rGi,!1,vi.getElapsedMilliseconds(I,yh.a.Ra.Kb),ha);w.Yca=!0;ka.rB($c.a.dQa)})}else wa=G?G.ErrorCode:"need_token",G=G?G.ErrorMessage:"No Access Token",ha.push(Object.assign(new Mf.a,{name:"ServiceChecked",bool:!1})),ha.push(Object.assign(new Mf.a,{name:"Error",string:G})),ha.push(Object.assign(new Mf.a,{name:"ErrorCode",string:wa})),Fa.a(De.a.TCb,!1,vi.getElapsedMilliseconds(I,yh.a.Ra.Kb),
ha),this.Yca=!0,ka.rB($c.a.dQa)};wc.prototype.SGd=function(G,ka){var d=this,w=new Oj.a,I=ze(this.$);return Ae(this.$,function(ha){if((ha=ha.Result)&&200===ha.ResponseStatusCode)ha=JSON.parse(ha.ResponseBody.join("")),G(d.cDd(ha.value)),w.setResult(!0);else{ha=ha?"RichApi_"+ha.ResponseStatusCode:"RichApiError";var wa=[];wa.push(Object.assign(new Mf.a,{name:"Error",string:"Failed to read shared script ids from document"}));wa.push(Object.assign(new Mf.a,{name:"ErrorCode",string:ha}));d.mt=!0;d.sU(ka,
yh.a.Ra.Kb,0,wa);w.setResult(!1)}},function(ha){ha=rk.a.og(ha.data);Se.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var wa=[];wa.push(Object.assign(new Mf.a,{name:"Error",string:"Failure using rich api: "+ha}));wa.push(Object.assign(new Mf.a,{name:"ErrorCode",string:"RichApiFailure"}));d.mt=!0;d.sU(ka,yh.a.Ra.Kb,0,wa);w.setResult(!1)},I,w)};wc.prototype.$gd=function(G,ka,d){var w=this,I=yh.a.Ra.Kb,ha=0,wa=0;this.mt=ha===G.count;var $a=[];$a.push(Object.assign(new Mf.a,
{name:"ScriptIds",int64:G.count}));if(G.count)if(ka&&ka.IsSuccess){nb(this.$,ka.Token);var Tb={};ka=yl(G);for(var Ic=ka.next();!Ic.done;Tb={Pfb:Tb.Pfb},Ic=ka.next())Ic=Ic.value,Tb.Pfb=Li.a.create().toString(),makerstorage.getSharedScript(Ic.value,Tb.Pfb).then(function(pc){return function(vd){var ne=[];ne.push(Object.assign(new Mf.a,{name:"BodySize",int64:vd.body.length}));ne.push(Object.assign(new Mf.a,{name:"CorrelationId",string:pc.Pfb}));Fa.a(De.a.jmc,!0,vi.getElapsedMilliseconds(I,yh.a.Ra.Kb),
ne);ha++;vd=new Oc(vd);vd.shareId=G.oa(vd.id);w.hg.$n(vd);w.mt=ha===G.count;w.Aza=!0;w.sU(d,I,wa,$a)}}(Tb)).catch(function(pc){return function(vd){var ne=[];Object.getType(vd)===makerstorage.StorageServiceError?($a.push(Object.assign(new Mf.a,{name:"Error",string:vd.message})),$a.push(Object.assign(new Mf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",vd.errorCode.toString(),vd.status.toString())}))):(ne.push(Object.assign(new Mf.a,{name:"Error",string:vd.toString()})),ne.push(Object.assign(new Mf.a,
{name:"ErrorCode",string:"exception"})));ne.push(Object.assign(new Mf.a,{name:"CorrelationId",string:pc.Pfb}));Fa.a(De.a.jmc,!1,vi.getElapsedMilliseconds(I,yh.a.Ra.Kb),ne);ha++;wa++;w.mt=ha===G.count;w.sU(d,I,wa,$a)}}(Tb)).finally(function(){if(Gf.EwaSettings.getBooleanFeatureGate($c.a.NXc,!1)&&w.indexedDB.rg()&&w.mt){var pc=Uc.IYh(w.$,w.hg);w.indexedDB.Vbb(new Tk.a($c.a.Dfb,pc))}})}else Tb=ka?ka.ErrorCode:"need_token",ka=ka?ka.ErrorMessage:"No Access Token",$a.push(Object.assign(new Mf.a,{name:"Error",
string:ka})),$a.push(Object.assign(new Mf.a,{name:"ErrorCode",string:Tb})),this.mt=!0,this.sU(d,I,wa,$a);else this.mt=this.Aza=!0,this.sU(d,I,wa,$a),Gf.EwaSettings.getBooleanFeatureGate($c.a.NXc,!1)&&Bh.TaskExtensions.I$(Uc.iNf(this.$,this.indexedDB),function(pc){pc.result&&(w.indexedDB.t6c($c.a.Dfb),w.hg.clear(),d.rB("CachedScripts"))},this.$.ma,3)};wc.prototype.Ngd=function(G){var ka={id:"samples-6"};ka.name=zf.a.instance.fa(2085);this.zr.$n(new Oc(ka));ka.id="samples-8";ka.name=zf.a.instance.fa(2086);
this.zr.$n(new Oc(ka));ka.id="samples-2";ka.name=zf.a.instance.fa(2082);this.zr.$n(new Oc(ka));ka.id="samples-4";ka.name=zf.a.instance.fa(2083);this.zr.$n(new Oc(ka));ka.id="samples-5";ka.name=zf.a.instance.fa(2084);this.zr.$n(new Oc(ka));this.U6=!0;G.rB("SampleScripts")};wc.prototype.cDd=function(G){var ka=new Fj.a;if(G=this.Rta.parseFromString(G,"text/xml").querySelector('[id="script-ids-node-id"]')){G=G.getElementsByTagName("scriptId");for(var d={},w=0;w<G.length;d={sPb:d.sPb,pPb:d.pPb,jPb:d.jPb},
w++)d.sPb=G[w].getAttribute("id"),d.sPb&&(d.pPb=void 0,d.jPb=void 0,function(I){return function(){var ha=Uc.U3e(I.sPb);I.pPb=ha.UTd;I.jPb=ha.shareId;return ha}}(d)().returnValue&&ka.ia(d.pPb,d.jPb))}return ka};wc.prototype.$6i=function(G){var ka=this,d=yh.a.Ra.Kb,w=[];Bh.TaskExtensions.I$(Uc.iNf(this.$,this.indexedDB),function(I){var ha=I.result;w.push(Object.assign(new Mf.a,{name:"ExistingScriptCount",int64:ka.hg.length}));if(ha){w.push(Object.assign(new Mf.a,{name:"CachedScriptCount",int64:ha.length}));
if(I=!ka.mt||0===ka.hg.length){ha=yl(ha.getScripts());for(var wa=ha.next();!wa.done;wa=ha.next())ka.hg.$n(wa.value);ka.hg.sort();Fa.a(De.a.Vyd,I,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),w);ka.yHd(G);return!0}Fa.a(De.a.Vyd,I,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),w)}else Fa.a(De.a.Vyd,!1,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),w);return!1},this.$.ma,3)};wc.prototype.U6i=function(G){var ka=this,d=yh.a.Ra.Kb,w=[];Bh.TaskExtensions.I$(this.indexedDB.kKa($c.a.OPa),function(I){var ha=!ka.T6||!ka.Hm.length;
I=I.result;w.push(Object.assign(new Mf.a,{name:"ExistingScriptCount",int64:ka.Hm.length}));if(""!==I&&(I=Rh.b(I),w.push(Object.assign(new Mf.a,{name:"CachedScriptCount",int64:I.length})),ha)){I=yl(I);for(var wa=I.next();!wa.done;wa=I.next())ka.Hm.$n(new Oc(wa.value));ka.Hm.sort();Fa.a(De.a.SCb,ha,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),w);ka.yHd(G);return!0}Fa.a(De.a.SCb,ha,vi.getElapsedMilliseconds(d,yh.a.Ra.Kb),w);return!1},this.$.ma,3)};wc.prototype.sU=function(G,ka,d,w){this.mt&&(w.push(Object.assign(new Mf.a,
{name:"ScriptCount",int64:this.hg.length})),w.push(Object.assign(new Mf.a,{name:"ScriptErrorCount",int64:d})),Fa.a(De.a.fuf,!d,vi.getElapsedMilliseconds(ka,yh.a.Ra.Kb),w),this.hg.sort(),G.rB($c.a.Dfb))};wc.prototype.yHd=function(G){this.S4=!0;G.rB("CachedScripts")};Object(de.a)(wc,"AutomateCommandStorage",Uc,[]);var bl=Vg.a;vm(Wb,bl);Wb.prototype.create=function(){var G=this,ka=gj.GetServiceTaskFactory.Wa(this.$.da,349,350,this.ub),d=ff.a.loadScript(109,4,this.ub,void 0,void 0,351),w=gj.GetServiceTaskFactory.create(this.$.da,
102,this.$.ma,this.ub),I=gj.GetServiceTaskFactory.create(this.$.da,396,this.$.ma,this.ub),ha=gj.GetServiceTaskFactory.Wa(this.$.da,5,4,this.ub);Bh.TaskExtensions.Ba(Bh.TaskExtensions.ve([ka,d,w,I,ha],this.ma,3),function(){var wa=ka.result,$a=I.result,Tb=ha.result,Ic=new Lf,pc=new ee(G.$,wa,Ic),vd=new wc(G.$,$a),ne=new dc(G.$,vd);Tb=new yb(G.$,pc,Ic,Tb);G.Fb(G.$.da.Aa(352)||new Wc(G.$,wa,w.result,$a,Tb,Ic,pc,vd,ne))},this.ma,3)};Wb.ja=function(G){G&&G.da.Ha(351,new Wb(G))};Object(de.a)(Wb,"AutomateCommandManagerFactory",
Vg.a,[]);var Uk=b(98),Dk=b(1286),Xi=b(175),Wj=b(52);tf.prototype.Yc=function(){return!1};tf.prototype.executeCommand=function(G,ka,d){G=!1;switch(ka.command){case 73979048:this.Drb&&this.Drb.Z0i(ka,Uk.a.instance,fg.AFrameworkApplication.ga,d),G=!0}return G?Wj.Task.Ta(!0):Xi.a(ka.command)};tf.prototype.Jc=function(G,ka){return 73979048===ka.command&&Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)};tf.prototype.fd=function(){return!1};tf.prototype.dispose=function(){this.Drb&&
this.Drb.dispose()};Object(de.a)(tf,"DataFromPictureCommandHandler",null,[188,3]);var Jk=vj.a;vm(Bd,Jk);Bd.prototype.Od=function(){var G=this,ka=gj.GetServiceTaskFactory.Wa(this.$.da,328,327,1),d=gj.GetServiceTaskFactory.Wa(this.$.da,484,485,1);Bh.TaskExtensions.Ba(Bh.TaskExtensions.ve([ka,d],this.$.ma),function(){G.Fd([new tf(G.$,ka.result,d.result)])},this.$.ma,3)};Bd.ja=function(G){vj.a.fe(452,new Bd(G))};Object(de.a)(Bd,"DataFromPictureCommandHandlerFactory",vj.a,[]);var wg=b(845),tk=b(89),xi=
b(818);Vd.yD=function(G,ka,d){d?Vd.Rc(G,ka):Vd.nl(G,ka)};Vd.Rc=function(G,ka){if(!xi.c(G)){var d=G.className;if(xi.c(d)||-1===d.indexOf(ka))ka=d.trim()+" "+ka,ka=ka.trim(),G.className=ka}};Vd.nl=function(G,ka){if(!(xi.c(G)||xi.c(ka)||xi.c(G.className))){var d=G.className;d!==d.replace(ka,"")&&(G.className=d.replace(ka,""))}};Vd.p7=function(G,ka,d,w){d=void 0===d?!1:d;w=void 0===w?!1:w;xi.c(G)||d||(Vd.yD(G,"cui-disabled",!ka),ka=ka?tk.a.Po:tk.a.vj,tk.a.Yg(G,tk.a.mha,ka),w&&tk.a.Yg(G,tk.a.dXc,ka))};
Object(de.a)(Vd,"Helper",null,[]);Ac.prototype.XUh=function(G){Se.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",G);for(var ka=new ph.a,d=yl(this.P0b),w=d.next();!w.done;w=d.next()){w=yl(w.value.PCb);for(var I=w.next();!I.done;I=w.next())I=I.value,I.id===G&&ka.add(I)}return ka};Ac.prototype.Ple=function(G){this.P0b.add(G)};Ac.prototype.oaj=function(G){for(var ka=yl(this.P0b),d=ka.next();!d.done;d=ka.next())if(d=d.value,d.Hpe===G.Hpe){this.P0b.remove(d);break}};Ac.tfh=function(G,ka,d){d=void 0===
d?null:d;G=Ac.lNh(G);0<G.length&&(Ac.Pvc(G,!1),d&&d(ka,G))};Ac.lNh=function(G){var ka=[];if(G&&G.PCb&&0<G.PCb.count){G=yl(G.PCb);for(var d=G.next();!d.done;d=G.next())if(d=d.value,d.controls&&0<d.controls.count){d=yl(d.controls);for(var w=d.next();!w.done;w=d.next())if(w=w.value,w.menuItems&&0<w.menuItems.count){w=yl(w.menuItems);for(var I=w.next();!I.done;I=w.next())Array.add(ka,I.value.id)}}}return ka};Ac.Pvc=function(G,ka){if(G.length){G=yl(G);for(var d=G.next();!d.done;d=G.next())d=document.querySelector('[id^="'+
d.value+'"]'),Vd.p7(d,ka)}};Sk.Object.defineProperties(Ac.prototype,{P0b:{configurable:!0,enumerable:!0,get:function(){return this.img}}});Object(de.a)(Ac,"ContextMenuExtensibilityCache",null,[478,479]);var Ok=b(1413),Ak=b(1011),Vk=b(885),Di=b(853),nk=b(893),ak=nk.a;vm(hd,ak);hd.prototype.clone=function(){var G=new hd;G.jmd=this.jmd;G.Qld=this.Qld;G.ribbon=this.ribbon;return G};Object(de.a)(hd,"RibbonBuildContext",nk.a,[]);vc.prototype.Vga=function(G,ka,d){ka=void 0===ka?null:ka;d=void 0===d?null:
d;var w=Vk.Builder.A3b(G);if(xi.c(w))d&&d(!1);else if(G=new hd,G.Qld=this.s9.homeTab.id,G.jmd=this.s9.homeTab,G.ribbon=this.s9,w=new Di.a(w),w=Di.a.pV(w.node,Di.a.R0d),xi.c(w))d&&d(!1);else{w=Di.a.Bm(w);for(var I=0;I<w.length;I++){var ha=w[I],wa=(new Di.a(ha)).attributes[Di.a.id];if(this.s9.Kaa(wa))this.sVb.x_j(wa,ha,G);else{var $a=-1;ka&&($a=this.OCh(wa,ka));-1!==$a?this.sVb.gDg(ha,G,$a):this.sVb.gDg(ha,G)}}d&&d(!0)}};vc.prototype.OCh=function(G,ka){G=Array.indexOf(ka,G);if(-1===G)return-1;--G;for(var d=
-1;0<=G;){d=this.fSh(ka[G]);if(-1!==d)break;G--}return d+1};vc.prototype.fSh=function(G){for(var ka=0,d=!1,w=yl(this.s9.children),I=w.next();!I.done;I=w.next()){I=I.value;if(I.id===G){d=!0;break}I.visible&&ka++}return d?ka:-1};vc.prototype.Uab=function(G){G=Vk.Builder.A3b(G);if(!xi.c(G)&&(G=new Di.a(G),G=Di.a.pV(G.node,Di.a.R0d),!xi.c(G))){G=Di.a.Bm(G);for(var ka=0;ka<G.length;ka++){var d=G[ka],w=(new Di.a(d)).attributes[Di.a.id];d=Di.a.pV(d,Di.a.hgb);d=Di.a.Bm(d);for(var I=0;I<d.length;I++){var ha=
Di.a.y1e(d[I],Di.a.id);xi.c(ha)||this.sVb.R0j(w,ha)}}}};Object(de.a)(vc,"RibbonExtensibilityBuilder",null,[]);var cl=b(819);lf.prototype.Vga=function(G,ka){ka=void 0===ka?null:ka;var d=G.nXe();this.Bfe.Vga(d,G.i$a,ka)};lf.prototype.Uab=function(G){G=G.nXe();this.Bfe.Uab(G)};lf.Cfh=function(G,ka,d){d=void 0===d?null:d;G=lf.PXh(G);0<G.length&&(lf.Pvc(G,!1),d&&d(ka,G))};lf.PXh=function(G){var ka=[];if(G){var d=G.qW;if(!d){if(G.tabs&&0<G.tabs.count)for(G=yl(G.tabs),d=G.next();!d.done;d=G.next())if(d=
d.value,0<d.jK.count){var w=yl(d.jK);for(d=w.next();!d.done;d=w.next())if(d=d.value,0<d.iia.count){var I=yl(d.iia);for(d=I.next();!d.done;d=I.next())Array.add(ka,d.value.id)}}}else if(d.Nr&&0<d.Nr.count)for(G=yl(d.Nr),d=G.next();!d.done;d=G.next())if(d=d.value,d.groups&&0<d.groups.length)for(w=yl(d.groups),d=w.next();!d.done;d=w.next())if(d=d.value,d.controls&&0<d.controls.length)for(I=yl(d.controls),d=I.next();!d.done;d=I.next())Array.add(ka,d.value.id)}return ka};lf.Pvc=function(G,ka){if(G.length){G=
yl(G);for(var d=G.next();!d.done;d=G.next())d=document.querySelector('[id^="'+d.value+'"]'),cl.a.p7(d,ka)}};Object(de.a)(lf,"RibbonExtensibilityManager",null,[491]);var gk=b(1065);Re.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(G,ka){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(G,ka)};Re.prototype.Fid=function(G,ka,d,w,I,ha,wa){ha=void 0===ha?null:ha;wa=void 0===wa?null:wa;Se.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",G);if((G=ka.cja(I.ownerAddinInfo.storeType,
I.ownerAddinInfo.solutionId))&&G.oB&&!G.oB.getIsUpgrading())if(ka=null,0<G.oB.getNotificationParams().length&&(ka=this.hve(G.oB.getNotificationParams()[0]),fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1)&&ka&&2147758681===ka.errorCode&&(G.isUpgraded=!0),fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpgradeAddinUsageEnabled",!1)&&ka&&2147758681===ka.errorCode&&Se.ULS.sendTraceTag(529278163,220,50,"Upgrade")),
2!==G.oB.getStatus()&&(1!==G.oB.getStatus()||ka&&2147758681===ka.errorCode))ka&&this.y3f(G,ka,wa);else try{d.setOwnerAddinEToken(G.oB.getEToken()),I.action(d,w.sma),ha&&ha()}catch($a){Se.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",fg.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?$a.stack:$a.message)),gk.a.tRd(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}};Re.prototype.y3f=
function(G,ka,d){var w=this;d=void 0===d?null:d;var I=G.oB;if(1===I.getNotificationParams().length||ka.Idc){var ha=ka.Fha,wa=ka.Aia;ka.Fha=function(){I.removeFirstNotification();if(0<I.getNotificationParams().length){var $a=w.hve(I.getNotificationParams()[0]);w.y3f(G,$a)}2147758681===ka.errorCode&&(lf.Cfh(G.Bo,I,Object(Qi.a)(w,w.Iaf,"initUpgradeStateDetectTask")),Ac.tfh(G.Jqb,I,Object(Qi.a)(w,w.Iaf,"initUpgradeStateDetectTask")));ha&&ha()};ka.Aia=function(){wa&&wa();d&&d()};gk.a.vRd(ka)}};Re.prototype.Iaf=
function(G,ka){var d=null;d=function(){G.getIsUpgrading()?window.setTimeout(d,1E3):G.getUpgradingFailed()?lf.Pvc(ka,!0):fg.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(d,1E3)};Re.prototype.hve=function(G){var ka=new Ak.a;ka.BLa=G.infoType;ka.id=G.id;ka.title=G.title;ka.description=G.description;ka.buttonText=G.buttonTxt;ka.Fha=G.buttonCallback;ka.Idc=G.highPriority;ka.Aia=G.dismissCallback;ka.errorCode=G.errorCode;ka.I$e=G.iframeNotificationUrl;return ka};Sk.Object.defineProperties(Re.prototype,
{Ake:{configurable:!0,enumerable:!0,get:function(){return this.fEc||(this.fEc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},set:function(G){this.fEc=G}},pNg:{configurable:!0,enumerable:!0,get:function(){return this.d2d||(this.d2d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object(de.a)(Re,"AddinCommandsActionHandler",null,[472]);ke.prototype.cIh=function(G){if(void 0!==G&&null!==G&&G===Ii.a.rCe)G="ContextMenuCell";else return null;var ka=this.Sa.Mc();
this.uHh(ka,G);return ka};ke.prototype.uHh=function(G,ka){ka=this.r2g.XUh(ka);ka=yl(ka);for(var d=ka.next();!d.done;d=ka.next()){d=yl(d.value.controls);for(var w=d.next();!w.done;w=d.next())this.hHh(G,w.value)}};ke.prototype.hHh=function(G,ka){var d=ka.EA[Di.a.id],w=ka.EA[Di.a.iCa],I=ka.EA[Di.a.lCa],ha="Image16by16",wa=ka.EA[Di.a.AUa];xi.c(I)&&(ha="None");0<ka.menuItems.count?(d=this.Sa.Wv(d,d,w,798637440),d.BJb(ha,I,null),this.aIh(d.menu,ka),Array.add(G.buttons,d)):Array.add(G.buttons,this.Sa.zHa(d,
w,wa,I,ha,null,!1))};ke.prototype.aIh=function(G,ka){var d,w=this.Sa.Mc();ka=yl(ka.menuItems);for(d=ka.next();!d.done;d=ka.next()){var I=d.value;d=I.JR[Di.a.id];var ha=I.JR[Di.a.iCa],wa=I.JR[Di.a.lCa],$a="Image16by16";I=I.JR[Di.a.AUa];xi.c(wa)&&($a="None");d=this.Sa.zHa(d,ha,I,wa,$a,null,!1);Array.add(w.buttons,d)}Array.add(G.zc,w)};Object(de.a)(ke,"AddInCommandsContextMenuExtensibilityHandler",null,[427]);var Ek=b(998);Object(de.a)(od,"AddinStatusCommandValues",null,[]);Qd.I3i=function(G){var ka=
new od;ka.Ei=G.TYa;ka.visible=ka.Ei?!0:!1;return ka};Qd.Dxc=function(G,ka,d,w,I){var ha=document.getElementById(d);ha?Qd.PBj(G,ka,ha,w,I):Se.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",d))};Qd.PBj=function(G,ka,d,w,I){d?G.TYa===CommonUIStrings.l_ErrorLoadingAddInsTitle?gk.a.yAj(ka,d,w,I):G.TYa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&gk.a.VBj(ka,d):Se.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};
Object(de.a)(Qd,"AddinCommandsStatusHandler",null,[]);var dk=b(36),Fk=b(217),hk=dk.a;vm(Cd,hk);Cd.prototype.tq=function(G){this.addHandler("LAC",G)};Cd.prototype.Mq=function(G){this.removeHandler("LAC",G)};Cd.prototype.$r=function(G,ka){var d=this;if("QueryAddinLabel"!==G)return!1;ka[Ek.a.LabelText]!==this.ZF.TYa&&(G=Qd.I3i(this.ZF),ka[Ek.a.LabelText]=G.Ei,ka[Ek.a.Visible]=G.visible,window.setTimeout(function(){d.Dxc()},0));return!0};Cd.prototype.kn=function(){return!0};Cd.prototype.Dxc=function(){this.$&&
Qd.Dxc(this.ZF,this.$.domElement,this.TGj,zf.a.instance.fa(334),zf.a.instance.fa(335))};Cd.prototype.dispose=function(){this.$.ea.lk(this.$c);this.ZF.ubj(this.j6e);this.agaveCommandManager&&(this.agaveCommandManager.Jcj(this.pze),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.RF(this),this.statusBarManager=null);this.ZF=this.$=null;hk.prototype.dispose.call(this)};Object(de.a)(Cd,"AddinCommandsStatusBarManager",dk.a,[185,186]);var dl=b(1293),Yi=b(116),el=b(144);Ec.prototype.setErrorMessageForAddin=
function(G,ka){this.RYa||(this.RYa={});this.RYa[G]=ka};Ec.prototype.EPh=function(G){return this.RYa&&G in this.RYa?this.RYa[G]:null};Object(de.a)(Ec,"AddinCommandsErrorManager",null,[]);var di=b(326),Qj=b(93);Object(de.a)(of,"AddinCommandsListLoaderContext",null,[]);var Z=b(950);Object(de.a)(ge,"AppsForOfficeEntitlementQueryInfo",null,[]);var xa=b(78),fb=b(804);Qe.prototype.get_current=function(){if(!this.Kr)throw Error.argumentOutOfRange();return this.Kr.data};Qe.prototype.moveNext=function(){if(!this.Kr)return this.Kr=
this.cA,!!this.cA;if(!this.Kr.next)return!1;this.Kr=this.Kr.next;return!0};Qe.prototype.plc=function(){if(!this.Kr)return this.Kr=this.cA,!!this.cA;if(!this.Kr.previous)return!1;this.Kr=this.Kr.previous;return!0};Qe.prototype.reset=function(){this.Kr=this.cA};Object(de.a)(Qe,"ListEnumerator",null,[0]);Object(de.a)(sd,"ListNode",null,[]);be.prototype.add=function(G){this.jq?this.kA=this.kA.next=new sd(G,this.kA,null):this.jq=this.kA=new sd(G,null,null);this._count=this.count+1};be.prototype.insert=
function(G,ka){if(G>this.count||0>G)throw Error.argumentOutOfRange("pos");if(G===this.count)this.add(ka);else{for(var d=this.jq;0!==G--;)d=d.next;G=new sd(ka,d.previous,d);G.previous?G.previous.next=G:this.jq=G;G.next?G.next.previous=G:this.kA=G;this._count=this.count+1}};be.prototype.remove=function(G){for(var ka=this.jq;ka&&ka.data!==G;)ka=ka.next;if(!ka)return!1;ka.previous?ka.previous.next=ka.next:this.jq=ka.next;ka.next?ka.next.previous=ka.previous:this.kA=ka.previous;this._count=this.count-
1;return!0};be.prototype.clear=function(){var G=this.jq;for(this.kA=this.jq=null;G;){var ka=G.next;G.previous=null;G.next=null;G=ka}this._count=0};be.prototype.indexOf=function(G){for(var ka=this.jq,d=0;ka&&ka.data!==G;)ka=ka.next,d++;return ka?d:-1};be.prototype.oa=function(G){return this.at(G).data};be.prototype.getEnumerator=function(){return new Qe(this.jq)};be.prototype[Symbol.iterator]=function(){return Object(fb.a)(this.getEnumerator())};be.prototype.Lac=function(G){G=this.at(G);return new Qe(G)};
be.prototype.toArray=function(){for(var G=Array(this.count),ka=0,d=yl(this),w=d.next();!w.done;w=d.next())G[ka]=w.value,ka++;return G};be.prototype.at=function(G){for(var ka=this.jq,d=0;d!==G;){if(!ka)throw Error.argumentOutOfRange("pos");ka=ka.next;d++}return ka};Sk.Object.defineProperties(be.prototype,{count:{configurable:!0,enumerable:!0,get:function(){return this._count}}});Object(de.a)(be,"List",null,[1]);var Zb=Sys.EventArgs;vm(me,Zb);Object(de.a)(me,"AddinCommandsEntitlementsRetrievedEventArgs",
Sys.EventArgs,[]);nd.prototype.J$c=function(G){var ka=new Sys.StringBuilder(this.fIb);ka.append("RoamingServiceHandler.ashx?action=");ka.append("getAddinTeachingCalloutSettings");ka.append("&");ka.append(this.Agd(G));ka.append("&");ka.append(fg.AFrameworkApplication.mj);fg.AFrameworkApplication.Jd.Xl(ka.toString(),1,null,null,!0,2,Object(Qi.a)(this,this.AKa,"getRequestSuccessCallback"),Object(Qi.a)(this,this.Qja,"getRequestFailureCallback"),null)};nd.prototype.K$c=function(G){var ka=new Sys.StringBuilder(this.fIb);
ka.append("RoamingServiceHandler.ashx?action=");ka.append("saveAddinTeachingCalloutSettings");ka.append("&");ka.append(fg.AFrameworkApplication.mj);ka=ka.toString();G=Rh.c(G);fg.AFrameworkApplication.Jd.Xl(ka,2,G,null,!0,4,null,Object(Qi.a)(this,this.CPa,"postRequestFailureCallback"),null)};nd.prototype.AKa=function(G){var ka=!1,d=null;try{if(0<G.data.ie.length){var w=Object(Vh.a)(Object,Rh.a(G.data.ie)),I=w?w[this.appName]:null;I&&(d=Object(Vh.a)(Object,Rh.a(I.toString())))}ka=!0}catch(ha){this.Qja(null)}ka&&
this.Cib&&this.Cib(d)};nd.prototype.Qja=function(G){this.yib&&this.yib(G?G.data:null)};nd.prototype.CPa=function(G){this.Mkb&&this.Mkb(G?G.data:null)};nd.prototype.Agd=function(G){for(var ka=new Sys.StringBuilder("requestedsettings="),d=0;d<G.count;d++)ka.append(G.oa(d)),d<G.count-1&&ka.append(";");return ka.toString()};Object(de.a)(nd,"AddinTeachingUIRoamingRequestHandler",null,[]);Object(de.a)(rc,"MiniAddinInfo",null,[]);var Fc=Sys.EventArgs;vm(Wd,Fc);Object(de.a)(Wd,"ShowTeachingCalloutForContentAddinEventArgs",
Sys.EventArgs,[]);rb.prototype.ODg=function(G){this.Ma.addHandler(wg.a.qZb,G)};rb.prototype.lHg=function(G){this.Ma.addHandler(wg.a.E3f,G)};rb.prototype.YOj=function(G){var ka=this;null!==G&&(this.context.$_=G[wg.a.K2],this.context.ks=G[wg.a.zJ],this.context.kAc=this.context.Dqc=0,G=wg.a.OFa in G?G[wg.a.OFa]:0,-1!==this.context.$_&&0!==this.context.ks&&(this.context.Q9=new be,this.context.pja=new be,this.context.u0a=new be,this.context.LVc=this.THg.createAddinDataProvider(mf(this.context.$_),this.contextActivationMgr),
this.context.LVc?this.context.LVc.getEntitlementsAsync(this.contextActivationMgr.sma,!0,G,function(d){ka.jPi(d)}):Se.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.$_)))};rb.prototype.jPi=function(G){var ka=this;if(G&&0<G.length){this.context.kAc=G.length;for(var d=0;d<G.length;d++){var w=G[d];if(!w||1!==w.targetType&&-1!==w.targetType)this.jzd();else{var I={};I.marketplaceId=w.solutionId;I.marketplaceVersion=w.version;I.storeType=w.storeType;I.storeId=w.storeId;
I.targetData=w;this.contextActivationMgr.isAddinCommandsAsync(I,function(ha,wa,$a){ha?(wa&&ka.context.Q9.add($a.targetData),10===ka.context.$_&&(ha=$a.targetData,wa=ha.targetType,fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PropertiesForTeachingUIOfPrivateCatelogEnabled",!1)&&!xi.c($a.targetTypeForExp)&&(wa=$a.targetTypeForExp,ha.targetType=wa),fg.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&ka.context.pja.add(ha),
fg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&0===wa&&ka.context.u0a.add(ha))):Se.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetAssetId($a.targetData.storeType,$a.targetData.storeId,$a.targetData.assetId),$a.targetData.storeType);ka.jzd()})}}}else this.jzd()};rb.prototype.jzd=function(){var G;(G=this.context).Dqc=G.Dqc+1;this.context.Dqc>=this.context.kAc&&(this.pZb.HYf(this.context.$_,
!1),0<this.context.kAc&&10===this.context.$_&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(G=!1,fg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled")&&kd()&&(G=this.Zui()),fg.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&this.nui(),fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&!G?this.JJh(this.context.Q9):
this.sYb(this.context.Q9)):this.sYb(this.context.Q9))};rb.prototype.sYb=function(G){var ka=new ph.a;if(G){G=yl(this.context.Q9);for(var d=G.next();!d.done;d=G.next())ka.add(Zd(d.value))}this.context.Q9&&1>this.context.Q9.count&&Z.a.bNb(wg.a.rZb,"false",this.context.$_);G={};ka=(G.ack2=ka,G);ka[wg.a.K2]=this.context.$_;ka[wg.a.zJ]=this.context.ks;this.Ma.raiseEvent(wg.a.qZb,new me(ka),this)};rb.prototype.OVf=function(G){if(this.appName){var ka={},d={};d.LastTeachingUIShowTime=(new Date).toUTCString();
d.AddinHasShown=G;ka[this.appName]=Rh.c(d);this.MPb&&(this.MPb.K$c(ka),Se.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else Se.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};rb.prototype.JJh=function(G){if(this.cha=G)G=new ph.a,G.add(this.appName),this.MPb=new nd(this.appName,Object(Qi.a)(this,this.AKa,"getRequestSuccessCallback"),Object(Qi.a)(this,this.Qja,"getRequestFailureCallback"),
Object(Qi.a)(this,this.CPa,"postRequestFailureCallback")),this.MPb.J$c(G);else{G=new ph.a;var ka={};G=(ka.ack2=G,ka);G[wg.a.K2]=this.context.$_;G[wg.a.zJ]=this.context.ks;this.Ma.raiseEvent(wg.a.qZb,new me(G),this)}};rb.prototype.AKa=function(G){G?this.yzj(G)?(Se.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.Dda="AddinHasShown"in G&&G.AddinHasShown?G.AddinHasShown.toString():null,this.FBe()):(Se.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),this.sYb(this.cha)):
(Se.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.Dda=null,this.FBe())};rb.prototype.Qja=function(G){Se.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",G?G.httpStatus:-1);this.sYb(this.cha)};rb.prototype.CPa=function(G){Se.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",G?G.httpStatus:-1)};rb.prototype.FBe=function(){if(fg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")){var G=
this.meh();0===G.targetType?(G.assetId?(this.kXc=G.assetId,this.E3i()):this.xmf("NoAssetId"),G.addinId&&this.OVf(this.Dda?this.Dda+","+G.addinId:G.addinId),this.rUc(null)):this.rUc(G.addinId);Se.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",G.addinId)}else G=this.leh(),this.rUc(G),Se.ULS.sendTraceTag(538248464,306,50,"Show teaching callout for taskpane addin: {0}",G)};rb.prototype.E3i=function(){var G=this,ka=new ge;ka.callbackFunc=function(d){if(d.errorCode)G.xmf("FailToGetAppDetails");
else if(d.value){d=yl(d.value);for(var w=d.next();!w.done;w=d.next()){w=w.value;var I=w[1];if(I===G.kXc){d={solutionId:I,assetId:I};d.storeType=w[6];d.storeId=w[11];d.assetStoreId=w[6];d.targetType=w[3];d.width=w[7];d.height=w[8];d.displayName=w[0];d.version=w[4];d=new Wd(d);G.Ma.raiseEvent(wg.a.E3f,d);break}}}};ka.storeType=OSF.StoreTypeEnum.PrivateCatalog;ka.fromInsertDialog=!1;fg.AFrameworkApplication.ga.isChangeGateEnabled("AvoidRefreshCacheEnabled")?ka.refresh=!1:ka.refresh=!0;this.contextActivationMgr.queryEntitlementDetails(ka)};
rb.prototype.yzj=function(G){if("LastTeachingUIShowTime"in G){if(G=+new Date-+new Date(G.LastTeachingUIShowTime.toString()),G<fg.AFrameworkApplication.ga.$Q("AddinShowTeachingUIIntervalInMS",864E5))return Se.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",G),!1}else Se.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0};rb.prototype.leh=function(){for(var G=new di.a("",0),ka=new di.a("",0),d=0,w=0,I=0,ha=yl(this.cha),wa=ha.next();!wa.done;wa=
ha.next())if(wa=wa.value,!("excatalog"!==wa.storeType||xi.c(wa.installTimeInMS)||!wa.installTimeInMS||wa.installTimeInMS<=fg.AFrameworkApplication.ga.$Q("DateTimeInMSForNewAddin",16409664E5))){var $a=this.qdd(wa);if(this.Dda){var Tb=this.Dda.split(",");if(0<Tb.length&&Array.contains(Tb,$a)){I++;Se.ULS.sendTraceTag(538817694,306,50,"This addin has shown teaching UI before");continue}}$a.startsWith("private_")?(G.value<wa.installTimeInMS&&(G=new di.a($a,wa.installTimeInMS)),w++):(ka.value<wa.installTimeInMS&&
(ka=new di.a($a,wa.installTimeInMS)),d++)}Se.ULS.sendTraceTag(538817695,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",w,d,I);return 0<ka.value?ka.key:0<G.value?G.key:null};rb.prototype.meh=function(){var G=new di.a(new rc,0),ka=new di.a(new rc,0),d=0,w=0,I=0;if(fg.AFrameworkApplication.ga.isChangeGateEnabled("FixAlertPeakEnabled")){var ha=new be;if(0<this.context.Q9.count)for(var wa=yl(this.context.Q9),$a=wa.next();!$a.done;$a=wa.next())ha.add($a.value);
if(0<this.context.u0a.count)for(wa=yl(this.context.u0a),$a=wa.next();!$a.done;$a=wa.next())ha.add($a.value)}else if(ha=this.cha,0<this.context.u0a.count)for(wa=yl(this.context.u0a),$a=wa.next();!$a.done;$a=wa.next())ha.add($a.value);ha=yl(ha);for($a=ha.next();!$a.done;$a=ha.next())if($a=$a.value,!("excatalog"!==$a.storeType||xi.c($a.installTimeInMS)||!$a.installTimeInMS||$a.installTimeInMS<=fg.AFrameworkApplication.ga.$Q("DateTimeInMSForNewAddin",16409664E5))){wa=this.qdd($a);if(this.Dda){var Tb=
this.Dda.split(",");if(0<Tb.length&&Array.contains(Tb,wa)){I++;Se.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}}wa.startsWith("private_")?(G.value<$a.installTimeInMS&&(G=new di.a(Object.assign(new rc,{addinId:wa,targetType:$a.targetType,assetId:$a.assetId}),$a.installTimeInMS)),w++):(ka.value<$a.installTimeInMS&&(ka=new di.a(Object.assign(new rc,{addinId:wa,targetType:$a.targetType,assetId:$a.assetId}),$a.installTimeInMS)),d++)}Se.ULS.sendTraceTag(528345033,
306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",w,d,I);return 0<ka.value?ka.key:0<G.value?G.key:Object.assign(new rc,{addinId:null,targetType:-1,assetId:null})};rb.prototype.rUc=function(G){for(var ka=new ph.a,d=yl(this.cha),w=d.next();!w.done;w=d.next()){var I=w.value;w=Zd(I);G&&(I=this.qdd(I),G===I&&(w.showCallout=!0,this.OVf(this.Dda?this.Dda+","+G:G)));ka.add(w)}this.cha&&1>this.cha.count&&Z.a.bNb(wg.a.rZb,"false",this.context.$_);G={};ka=
(G.ack2=ka,G);ka[wg.a.K2]=this.context.$_;ka[wg.a.zJ]=this.context.ks;this.Ma.raiseEvent(wg.a.qZb,new me(ka),this)};rb.prototype.qdd=function(G){return Telemetry.PrivacyRules.IsPrivateAddin(G.storeType,G.storeId,G.assetId)?"private_"+G.installTimeInMS:G.assetId};rb.prototype.Zui=function(){var G=!1;if(this.context.pja&&1>this.context.pja.count)return G;var ka=ie();if(!ka)return G;for(var d=yl(this.context.pja),w=d.next();!w.done;w=d.next())if(w=w.value,w.storeId&&w.storeId.toLowerCase()===ka.toLowerCase()||
w.assetId&&w.assetId.toLowerCase()===ka.toLowerCase()){G=Telemetry.PrivacyRules.GetAssetId(w.storeType,w.storeId,w.solutionId);var I={};w=(I.SDX_Id=G,I.SDX_TargetType=xi.c(w.targetType)?"":w.targetType.toString(),I);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.EmailAlertNotification",dataFields:Yi.a.Rk(w)}));G=!0}return G};rb.prototype.nui=function(){if(!(this.context.pja&&1>this.context.pja.count))if(this.pZb.qki()){var G=this.pZb.jWh();G?(G=this.mZe(this.context.pja,
G),Se.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(G=this.mZe(this.context.pja,null),Se.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.pZb.ptj(G)}else Se.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")};rb.prototype.mZe=function(G,ka){var d={},w=!1;G=yl(G);for(var I=G.next();!I.done;I=G.next()){I=I.value;var ha=Telemetry.PrivacyRules.GetAssetId(I.storeType,I.storeId,I.assetId);ha&&(!ka||ha in ka||(this.Jxa(I,ha),Se.ULS.sendTraceTag(527523849,
306,50,"New addin detected,log to AppInstall")),"private"===ha.toLowerCase()?w||(w=!0,d[ha]=null):d[ha]=null)}return d};rb.prototype.Jxa=function(G,ka){var d=G.installTimeInMS?(new Date(G.installTimeInMS)).toISOString():"";if(fg.AFrameworkApplication.ga.isChangeGateEnabled("TargetTypeAndStoreIdFixEnabled")){var w={};d=(w["SDX.Id"]=ka,w["SDX.AppInstallOrigin"]="Organization",w["SDX.TargetType"]=xi.c(G.targetType)?"":G.targetType.toString(),w["SDX.AdminDeploymentTime"]=d,w)}else w={},d=(w["SDX.Id"]=
ka,w["SDX.AppInstallOrigin"]="Organization",w["SDX.TargetType"]=G.targetType,w["SDX.AdminDeploymentTime"]=d,w);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Yi.a.Rk(d)}));1===G.targetType&&(G={},ka=(G["SDX.Id"]=ka,G["SDX.AppInstallOrigin"]="Organization",G["SDX.CommandPlacement"]="Ribbon",G),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Yi.a.Rk(ka)})))};rb.prototype.xmf=function(G){var ka=
{};G=(ka.AppTeachingUICalloutAction=G,ka["SDX.Id"]=this.kXc,ka.AppTeachingUICalloutGoal="NewAdminDeployment",ka["SDX.AppInstallOrigin"]="Organization",ka);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(G)}))};Object(de.a)(rb,"AddInCommandsListLoader",null,[]);ld.prototype.insertOsfControl=function(G){return this.sma.insertOsfControl(G)};ld.prototype.getManifestInvaildErrorString=function(){return this.sma.getManifestInvaildErrorString()};
ld.prototype.isAddinCommandsAsync=function(G,ka){this.sma.isAddinCommandsAsync(G,ka)};ld.prototype.ownerAddinControlRecreated=function(G,ka){this.sma.ownerAddinControlRecreated(G,ka)};ld.prototype.queryEntitlementDetails=function(G){this.sma.queryEntitlementDetails(G)};Sk.Object.defineProperties(ld.prototype,{sma:{configurable:!0,enumerable:!0,get:function(){return this.ytg}}});Object(de.a)(ld,"ContextActivationMgrWrapper",null,[468]);zc.prototype.createAddinDataProvider=function(G,ka){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(G,
ka.sma)};Sk.Object.defineProperties(zc,{instance:{configurable:!0,enumerable:!0,get:function(){zc.Oa||(zc.Oa=new zc);return zc.Oa}}});zc.Oa=null;Object(de.a)(zc,"OSFAddinDataProviderFactory",null,[470]);Object(de.a)(qd,"CacheItem",null,[]);bc.prototype.Vk=function(G){Se.ULS.sendTraceTag(526989510,220,15,"GetCacheItem");var ka=this.YDa.getItem(G);if(ka){var d=new qd;try{d=Sys.Serialization.JavaScriptSerializer.deserialize(ka,!0)}catch(w){return this.YDa.removeItem(G),null}return d.Data?d.Data:d.data}return null};
bc.prototype.Kza=function(G){Se.ULS.sendTraceTag(526989512,220,15,"RemoveCacheItem");this.YDa.removeItem(G)};Object(de.a)(bc,"AppsDataCacheManager",null,[425]);var cd=b(951);Ke.prototype.HYf=function(G,ka){G=wg.a.s_e()+G;cd.a.instance.setItem(G,ka.toString())};Ke.prototype.jWh=function(){var G=wg.a.v2e();Se.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",G);G=cd.a.instance.getItem(G);return Rh.a(G)};Ke.prototype.ptj=function(G){var ka=wg.a.v2e();Se.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",
ka);cd.a.instance.setItem(ka,Rh.c(G))};Ke.prototype.qki=function(){return!!cd.a.instance.localStorage};Sk.Object.defineProperties(Ke,{instance:{configurable:!0,enumerable:!0,get:function(){Ke.Oa||(Ke.Oa=new Ke);return Ke.Oa}}});Ke.Oa=null;Object(de.a)(Ke,"AddInCommandsCacheManager",null,[473]);var ed=Sys.EventArgs;vm(oe,ed);Object(de.a)(oe,"InsertionParamEventArgs",Sys.EventArgs,[]);Object(de.a)(se,"PostLaunchAddinCommandsParameters",null,[]);Sd.prototype.eBg=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",
Object(Qi.a)(this,this.XOi,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Qi.a)(this,this.mKi,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Qi.a)(this,this.RIi,"onCloseButtonClickedEventHandler"),!0)):Se.ULS.sendTraceTag(525112601,306,15,"AddEventListenerForTeachingCallout failed to get Window")};Sd.prototype.XOi=function(){var G=this,ka={};ka=(ka.AppTeachingUICalloutAction="ClickOnLaunch",ka["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.V8.storeType,
this.V8.storeId,this.V8.assetId),ka.AppTeachingUICalloutGoal="NewAdminDeployment",ka["SDX.AppInstallOrigin"]="Organization",ka);fg.AFrameworkApplication.ga.isChangeGateEnabled("TeachingUIExtraLogForLaunch")&&this.sgb&&this.sgb.tabs&&!this.sgb.tabs[0].isOfficeTab&&(ka["SDX.FeatureFlags"]="NonOfficeTab");Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(ka)}));this.sgb?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.sgb,
function(){var d=new oe;d.hi=G.V8;G.rb.raiseEvent(wg.a.Ykf,d)}):Se.ULS.sendTraceTag(525112602,306,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};Sd.prototype.RIi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnClose",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.V8.storeType,this.V8.storeId,this.V8.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Yi.a.Rk(G)}))};Sd.prototype.mKi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnDismiss",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.V8.storeType,this.V8.storeId,this.V8.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(G)}))};Object(de.a)(Sd,"PrivateCatalogTeachingCalloutHandler",null,[]);Jd.prototype.Vga=
function(G,ka){this.C8d.Vga(G,void 0===ka?null:ka);this.H$d=G};Jd.prototype.Uab=function(G){this.C8d.Uab(G)};Sk.Object.defineProperties(Jd.prototype,{txa:{configurable:!0,enumerable:!0,get:function(){return this.H$d}}});Object(de.a)(Jd,"RibbonExtensibilityManagerWithChangeDetection",null,[491]);var Nc=b(858),Pc=b(941);Ue.prototype.Vga=function(G,ka){ka=void 0===ka?null:ka;if(G=Pc.a.jub(G)){appChrome.addInApi.dispatchActionsToInstallAddIn(G,ka);ka=yl(G.tabs);for(var d=ka.next();!d.done;d=ka.next())if(d.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(G,
function(){});break}}};Ue.prototype.Uab=function(G){(G=Pc.a.jub(G))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(G)};Object(de.a)(Ue,"OneLineRibbonExtensibilityManager",null,[491]);var wd=b(1010);Me.a0e=function(G){var ka=new ph.a;if(Me.sBe)for(var d=yl(Me.sBe),w=d.next();!w.done;w=d.next())ka.add(w.value);w=null;switch(G){case "Workbook":w=Me.MYj;break;case "Document":w=Me.vhh;break;case "Presentation":w=Me.w1i}if(w)for(G=yl(w),w=G.next();!w.done;w=G.next())ka.add(w.value);return ka};Me.sBe=
["PrimaryCommandSurface","ContextMenu"];Me.MYj=null;Me.vhh=null;Me.w1i=null;Object(de.a)(Me,"ExtensionPointType",null,[]);Sk.Object.defineProperties(Ad.prototype,{PCb:{configurable:!0,enumerable:!0,get:function(){return this.Ice||(this.Ice=new ph.a)}},Hpe:{configurable:!0,enumerable:!0,get:function(){return this.Okg}}});Object(de.a)(Ad,"ContextMenuExtensibility",null,[476]);xd.prototype.nXe=function(){for(var G=new Sys.StringBuilder,ka=yl(this.lY),d=ka.next();!d.done;d=ka.next())G.append(d.value.Q7());
return this.GCg(G.toString())};xd.prototype.GCg=function(G){var ka=new Sys.StringBuilder;ka.append("<Ribbon><Tabs>");ka.append(G);ka.append("</Tabs></Ribbon>");return ka.toString()};Sk.Object.defineProperties(xd.prototype,{tabs:{configurable:!0,enumerable:!0,get:function(){return this.lY}},qW:{configurable:!0,enumerable:!0,get:function(){return this.rtg}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.Pwg}},i$a:{configurable:!0,enumerable:!0,get:function(){return this.skb}},
YIh:{configurable:!0,enumerable:!0,get:function(){return this.spg}}});Object(de.a)(xd,"RibbonExtensibility",null,[503]);fd.prototype.createActionContext=function(G,ka){G={};G.ownerAddinInfo=this.entitlement;G.action=ka;return G};Sk.Object.defineProperties(fd.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.qog}}});Object(de.a)(fd,"AddInCommandsContextProvider",null,[]);Qb.prototype.H5g=function(G){return new fd(G)};Qb.prototype.createActionBuilder=function(G,ka){return OfficeExt.DefaultControlActionBinder.createActionBuilder(G,
ka.entitlement,ka.manifest)};Qb.prototype.startApplyAddin=function(G){this.z1d=G;var ka=this.H5g(G);this.actionBuilder=this.createActionBuilder(ka,G)};Qb.prototype.endApplyAddin=function(){};Qb.prototype.Zcd=function(G,ka,d){d=void 0===d?0:d;return this.ribbonBuilder.kzc&&0<this.ribbonBuilder.kzc.count||this.ribbonBuilder.Nr&&0<this.ribbonBuilder.Nr.count?new xd(this.ribbonBuilder.kzc,this.mIh(G,ka),this.epe.startedNode,this.ribbonBuilder.d6.lVh(),d):null};Qb.prototype.KWe=function(){var G=void 0===
G?null:G;if(this.contextMenuBuilder.Xkc&&0<this.contextMenuBuilder.Xkc.count){G||(G=this.epe.entitlement.solutionId);G=new Ad(G);for(var ka=yl(this.contextMenuBuilder.Xkc),d=ka.next();!d.done;d=ka.next())G.PCb.add(d.value);return G}return null};Qb.prototype.mIh=function(G,ka){return this.ribbonBuilder.Nr&&0<this.ribbonBuilder.Nr.count?new Pc.a(this.ribbonBuilder.Nr,G,ka):null};Sk.Object.defineProperties(Qb.prototype,{epe:{configurable:!0,enumerable:!0,get:function(){return this.z1d}}});Object(de.a)(Qb,
"AddinCommandsBuilder",null,[]);Zc.prototype.pNa=function(G,ka,d,w,I,ha,wa){function $a(ne,Pe,Af,Wf){I(ne,Pe,Af,Wf);ne=wd.a[Tb.ks]+Pe.assetId;Af=Tb.KSa.Gc(ne);Pe=Af.value;Af.returnValue&&(Pe.stop(),Tb.KSa.remove(ne))}var Tb=this;if(0!==this.ks&&G)for(Se.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",G.count),4===this.ks&&(Se.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",w)),this.$Xg(G,w),ha()),G=yl(G),w=G.next();!w.done;w=G.next())if(w=w.value,
w.solutionId=w.solutionId||w.assetId,w.storeType=w.storeType||w.currentStoreType,w.version=w.version||w.appVersion,Se.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.co.oK,Telemetry.PrivacyRules.GetAssetId(w.storeType,w.storeId,w.solutionId))),this.cgg(w))if(wa&&w.requireConsent)wa(w,function(ne){try{if(Tb.OO){var Pe=wd.a[Tb.ks]+ne.solutionId,Af=Tb.OO.Hc("ComponentAttach",Pe);Tb.KSa.ia(Pe,Af)}var Wf=Tb.ZF.cja(ne.storeType,ne.solutionId);6!==Tb.ks&&(Wf&&(Tb.W1b(Wf),Wf.oB.purge(!1)),
Tb.Ji.insertOsfControl(Tb.CFb(ne,ka,d,$a)),Wf&&Tb.Ji.ownerAddinControlRecreated(ne.solutionId,ne.storeType))}catch(Of){Se.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",Tb.co.oK,Telemetry.PrivacyRules.GetAssetId(ne.storeType,ne.storeId,ne.solutionId),ne.version,ne.storeType,ne.storeId,Of.message)),$a(!1,ne,null,null)}});else try{if(this.OO){var Ic=wd.a[this.ks]+w.solutionId,pc=this.OO.Hc("ComponentAttach",
Ic);this.KSa.ia(Ic,pc)}var vd=this.ZF.cja(w.storeType,w.solutionId);6!==this.ks&&(vd&&(this.W1b(vd),vd.oB.purge(!1)),this.Ji.insertOsfControl(this.CFb(w,ka,d,$a)),vd&&this.Ji.ownerAddinControlRecreated(w.solutionId,w.storeType))}catch(ne){Se.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.co.oK,Telemetry.PrivacyRules.GetAssetId(w.storeType,w.storeId,w.solutionId),w.version,w.storeType,
w.storeId,ne.message)),$a(!1,w,null,null)}else $a(!1,w,null,null)};Zc.prototype.Jri=function(G,ka,d,w,I,ha){function wa(vd,ne,Pe,Af){ha(vd,ne,Pe,Af);vd=wd.a[$a.ks]+ne.solutionId;Pe=$a.KSa.Gc(vd);ne=Pe.value;Pe.returnValue&&(ne.stop(),$a.KSa.remove(vd))}var $a=this;if(6===this.ks&&G)if(G.solutionId=G.solutionId||G.assetId,G.storeType=G.storeType||G.currentStoreType,G.version=G.version||G.appVersion,Se.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.co.oK,Telemetry.PrivacyRules.GetAssetId(G.storeType,
G.storeId,G.solutionId))),this.cgg(G))try{if(this.OO){var Tb=wd.a[this.ks]+G.solutionId,Ic=this.OO.Hc("ComponentAttach",Tb);this.KSa.ia(Tb,Ic)}var pc=this.ZF.cja(G.storeType,G.solutionId);pc||wa(!1,G,null,null);fg.AFrameworkApplication.sa&&fg.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.lXe(G,ka,w,I,d,function(vd){wa(vd,G,d,pc.displayName)}):(this.lXe(G,ka,w,I,d),wa(!0,G,d,pc.displayName))}catch(vd){Se.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",
this.co.oK,Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId,vd.message)),wa(!1,G,null,null)}else wa(!1,G,null,null)};Zc.prototype.XGi=function(G,ka,d,w,I,ha){if(ha)if(ha._isAddinCommandsManifest(this.co.oK))try{fg.AFrameworkApplication.sa&&fg.AFrameworkApplication.sa.Qa.delayInstallAddInIsEnabled?this.kXe(G,ka,d,I,ha,function(wa){w(wa,G,ha,ha.getDefaultDisplayName())}):(this.kXe(G,ka,d,I,ha),w(!0,G,ha,ha.getDefaultDisplayName()))}catch(wa){Se.ULS.sendTraceTag(17586257,
220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.co.oK,Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId,wa.message)),w(!1,G,ha,ha.getDefaultDisplayName())}else Se.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.co.oK,
Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId)),w(!1,G,null,null);else Se.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.co.oK,Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,G.solutionId),G.version,G.storeType,G.storeId)),w(!1,G,null,null)};Zc.prototype.CFb=function(G,ka,d,w){var I=this,ha={},wa=document.createElement("div");wa.setAttribute("visible",
"false");ha.div=wa;ha.id=G.solutionId||G.id;ha.solutionId=G.solutionId||G.id;ha.version=G.version||G.appVersion;ha.storeType=G.storeType||G.currentStoreType;ha.storeId=G.storeId;ha.assetId=G.assetId;ha.assetStoreId=G.assetStoreId;ha.isvirtualOsfControl=!0;ha.virtualOsfControlActivationCallback=function($a,Tb){var Ic=I.ZF.cja(G.storeType||G.currentStoreType,G.solutionId||G.id);Ic&&(Ic.isUpgraded&&(G.isUpgraded=!0),I.W1b(Ic));I.XGi(G,ka,d,w,$a,Tb)};ha.reason=3===this.ks?Microsoft.Office.WebExtension.InitializationReason.Inserted:
Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;ha.marketplaceID=G.id;ha.marketplaceVersion=G.appVersion;ha.store=G.storeId;return ha};Zc.prototype.kXe=function(G,ka,d,w,I,ha){ha=void 0===ha?null:ha;var wa={};wa.solutionId=w.getSolutionId();wa.version=w.getVersion();wa.storeType=w.getStoreType();wa.storeId=w.getStoreId();wa.assetId=w.getSolutionId();wa.assetStoreId=w.getAssetStoreId();wa.targetType=w.getOsfControlType();wa.appVersion=w.getMarketplaceVersion();var $a=null,Tb=null;
if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))$a=(new OfficeExt.Parser.AddinCommandsManifestParser(this.co.oK,this.co.formFactor)).parseExtensions(wa,I,this.dha),Tb=Me.a0e(this.co.oK);else try{$a=(new OfficeExt.Parser.AddinCommandsManifestParser(this.co.oK,this.co.formFactor)).parseExtensions(wa,I,this.dha),Tb=Me.a0e(this.co.oK)}catch(Sh){throw Se.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+
Sh.message),Sh;}if(Tb&&0<Tb.count){if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var Ic=ka(G);var pc=d(G);d=!!fg.AFrameworkApplication.ga&&fg.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");Ic=new Qb(Ic,null,pc);Tb=yl(Tb);for(pc=Tb.next();!pc.done;pc=Tb.next())Ic.commandSurface=pc.value,$a.apply(Ic,this.dha,d)}else try{var vd=ka(G),ne=d(G),Pe=!!fg.AFrameworkApplication.ga&&fg.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");
Ic=new Qb(vd,null,ne);var Af=yl(Tb);for(pc=Af.next();!pc.done;pc=Af.next())Ic.commandSurface=pc.value,$a.apply(Ic,this.dha,Pe)}catch(Sh){throw Se.ULS.sendTraceTag(538752132,220,10,"Exception encounter while building ribbon. Exception: "+Sh.message),Sh;}if(OSF.OUtil.checkFlight(14))try{var Wf=Ic.Zcd(G.solutionId||G.id,I.getDefaultDisplayName()),Of=Ic.KWe();Wf&&this.ribbonManager.Vga(Wf,ha);Of&&this.contextMenuManager.Ple(Of);this.ZF.qme(w,Wf,Of,I.getDefaultDisplayName());Se.ULS.sendTraceTag(17326353,
220,100,"Add-in name: {0}.",I.getDefaultDisplayName())}catch(Sh){throw OfficeExt.DevConsole.log(Sh),Se.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+Sh.message),Sh;}else try{var xg=Ic.Zcd(G.solutionId||G.id,I.getDefaultDisplayName()),oi=Ic.KWe();xg&&this.ribbonManager.Vga(xg);oi&&this.contextMenuManager.Ple(oi);this.ZF.qme(w,xg,oi,I.getDefaultDisplayName());Se.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",I.getDefaultDisplayName())}catch(Sh){throw Se.ULS.sendTraceTag(539870851,
220,10,"Error generating ribbon extensibility. Exception: "+Sh.message),Sh;}}};Zc.prototype.lXe=function(G,ka,d,w,I,ha){ha=void 0===ha?null:ha;var wa={};wa.solutionId=G.solutionId||G.assetId;wa.version=G.version||G.appVersion;wa.storeType=G.storeType||G.currentStoreType;wa.storeId=G.assetStoreId;wa.assetId=G.assetId;wa.assetStoreId=G.assetStoreId;wa.targetType=G.targetType;wa.appVersion=G.appVersion;var $a=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.co.oK,this.co.formFactor);try{var Tb=
ka.getManifest(),Ic=$a.parse(wa,Tb,I,this.dha,ka.getSharedRuntimeId()),pc=d(G),vd=w(G),ne=new Qb(pc,null,vd);ne.commandSurface="PrimaryCommandSurface";Ic.apply(ne,this.dha,!0);if(ne.ribbonBuilder.Nr&&0<ne.ribbonBuilder.Nr.count){var Pe=ne.Zcd(G.solutionId||G.id,ka.getManifest().getDefaultDisplayName(),1);fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.Vga(Pe,ha):Pe&&this.ribbonManager.Vga(Pe,ha);this.ZF.WBg(ka,
Pe,I,ka.getManifest().getDefaultDisplayName());Se.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",ka.getManifest().getDefaultDisplayName())}}catch(Af){Se.ULS.sendTraceTag(592290768,220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",ka.getManifest().getDefaultDisplayName(),Af.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Af)}};Zc.prototype.W1b=function(G){G.Bo&&this.ribbonManager.Uab(G.Bo);G.Jqb&&this.contextMenuManager.oaj(G.Jqb);this.ZF.X$i(G.oB.getStoreType(),
G.oB.getSolutionId())};Zc.prototype.$Xg=function(G,ka){ka=mf(ka);for(var d=yl(this.ZF.E5a),w=d.next();!w.done;w=d.next())if(w=w.value,w.oB.getStoreType()===ka){for(var I=!0,ha=yl(G),wa=ha.next();!wa.done;wa=ha.next())if((wa=wa.value)&&w.zhf(wa.storeType||wa.currentStoreType,wa.solutionId||wa.id)){I=!1;break}I&&(this.W1b(w),w.oB.purge(!1))}};Zc.prototype.cgg=function(G){G.solutionId!==G.assetId&&Se.ULS.sendTraceTag(540379092,220,50,"VerifyInsertAgaveParameter solutionId != AssetId");G.id!==G.assetId&&
Se.ULS.sendTraceTag(540379093,220,50,"VerifyInsertAgaveParameter Id != AssetId");return!!G&&!!G.solutionId&&!!G.version&&!!G.storeType&&!!G.storeId};Object(de.a)(Zc,"AddInCommandsIntegration",null,[]);var Kd=b(863);jd.prototype.PDg=function(G){this.rb.addHandler(wg.a.dpe,G)};jd.prototype.IFg=function(G){this.rb.addHandler(wg.a.Ykf,G)};jd.prototype.kHg=function(G){this.rb.addHandler(wg.a.G3f,G)};jd.prototype.VDg=function(G){this.rb.addHandler(wg.a.KXc,G)};jd.prototype.pNa=function(G,ka,d){var w=this,
I=d[wg.a.NFa],ha=void 0===d[wg.a.zJ]?0:d[wg.a.zJ];if(I&&0!==ha)if(0>=I.count&&4!==ha)this.Xpc(new se(ha,null,null,G,ka,null,!0));else{var wa=I.count,$a=new Jd(new lf(G));d=void 0===d[wg.a.K2]?-1:d[wg.a.K2];(new Zc(ha,this.Pm,this.HUa,$a,this.h4d,this.dra,this.mpa)).pNa(I,function(Tb){return w.UWb.zRg(Tb.solutionId,w.mpa,w.HUa)},function(Tb){return w.UWb.Yue(Tb.solutionId)},d,function(Tb,Ic,pc,vd){wa--;pc=new se(ha,Ic,$a,G,ka,vd,0>=wa);Tb&&Ic?w.Xpc(pc):(w.kWa&&(3===ha||Ic&&Ic.isUpgraded)&&(Tb="",Ic&&
(Tb=Telemetry.PrivacyRules.GetAssetId(Ic.storeType,Ic.storeId,Ic.solutionId)),Ic={},Ic=(Ic.SDX_AppInstallOrigin="User",Ic.SDX_IsAutoLaunchEnabled=w.JDa,Ic.SDX_AppInstallErrorCode="onAddinCompleted.fail",Ic.SDX_Id=Tb,Ic),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Yi.a.Rk(Ic)}))),w.Wpc(pc))},function(){w.Wlc();0>=I.count&&4===ha&&w.dra.Qvc()},this.Nce)}else this.kWa&&(d={},d=(d.SDX_AppInstallOrigin="User",d.SDX_IsAutoLaunchEnabled=this.JDa,
d.SDX_AppInstallErrorCode="LaunchAddinCommands.fail",d.SDX_Id="",d),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Yi.a.Rk(d)}))),Se.ULS.sendTraceTag(17638115,220,10,String.format("{0}: parameters are invalid for LaunchAddinCommands.",this.HUa.oK)),this.Wpc(new se(ha,null,null,G,ka,null,!0))};jd.prototype.asi=function(G,ka,d){var w=this,I=d[wg.a.NFa],ha=void 0===d[wg.a.zJ]?0:d[wg.a.zJ];if(I&&0!==ha)if(0>=I.count&&4!==ha)this.Xpc(new se(ha,null,
null,null,ka,null,!0));else{var wa=I.count,$a=new Jd(new Ue),Tb=void 0===d[wg.a.K2]?-1:d[wg.a.K2],Ic=new Zc(ha,this.Pm,this.HUa,$a,this.h4d,this.dra,this.mpa),pc=function(Wf){return w.UWb.kRg(Wf.solutionId,w.mpa,w.HUa,G)},vd=function(Wf){return w.UWb.Yue(Wf.solutionId)},ne=function(Wf,Of,xg){wa--;xg=new se(ha,Of,$a,null,ka,xg,0>=wa);Wf&&Of?w.Xpc(xg):(w.kWa&&(3===ha||Of&&Of.isUpgraded)&&(Wf="",Of&&(Wf=Telemetry.PrivacyRules.GetAssetId(Of.storeType,Of.storeId,Of.solutionId)),Of={},Of=(Of.SDX_AppInstallOrigin=
"User",Of.SDX_IsAutoLaunchEnabled=w.JDa,Of.SDX_AppInstallErrorCode="onAddinCompletedBase.fail",Of.SDX_Id=Wf,Of),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Yi.a.Rk(Of)}))),w.Wpc(xg));wa||fg.AFrameworkApplication.sa.updateCommandUI()},Pe=function(Wf,Of,xg,oi){ne(Wf,Of,oi)},Af=function(){w.Wlc();0>=I.count&&4===ha&&w.dra.Qvc()};6===ha?(Tb=d[wg.a.GIa],d=d[wg.a.HIa],Ic.Jri(I.oa(0),Tb,d,pc,vd,function(Wf,Of,xg,oi){ne(Wf,Of,oi)})):Ic.pNa(I,pc,vd,
Tb,Pe,Af,this.Nce)}else this.kWa&&(Ic={},Ic=(Ic.SDX_AppInstallOrigin="User",Ic.SDX_IsAutoLaunchEnabled=this.JDa,Ic.SDX_AppInstallErrorCode="LaunchOneLineRibbonAddinCommands.fail",Ic.SDX_Id="",Ic),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Yi.a.Rk(Ic)}))),Se.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.HUa.oK)),this.Wpc(new se(ha,null,null,null,ka,null,!0))};jd.prototype.Wpc=
function(G){this.Wlc(G);this.x4f(!1,G)};jd.prototype.Xpc=function(G){var ka=G.hi,d=null;null!==ka&&(d=ka.storeType||ka.currentStoreType,d=d.toLowerCase());if(this.kWa&&ka&&"omex"===ka.storeType&&G&&(3===G.ks||ka.isUpgraded)){var w={};w=(w.SDX_AppInstallOrigin="User",w.SDX_IsAutoLaunchEnabled=this.JDa,w.SDX_AppInstallErrorCode="0",w.SDX_Id=Telemetry.PrivacyRules.GetAssetId(d,ka.storeId,ka.solutionId),w);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Yi.a.Rk(w)}))}this.Wlc(G);
this.JDa&&ka&&"omex"===ka.storeType&&G.r0&&(3===G.ks&&"hardcodedpreinstall"!==d||ka.isUpgraded)&&(w=new oe,w.hi=ka,w.Bo=G.r0.txa,this.rb.raiseEvent(wg.a.KXc,w));if(this.arg){w=kd();var I=ie();w&&ka&&"excatalog"===ka.storeType&&G.r0&&5===G.ks&&I&&(ka.storeId&&ka.storeId.toLowerCase()===I.toLowerCase()||ka.assetId&&ka.assetId.toLowerCase()===I.toLowerCase())&&(w=new oe,w.hi=ka,w.Bo=G.r0.txa,this.rb.raiseEvent(wg.a.KXc,w),Se.ULS.sendTraceTag(525362254,220,50,"Email alert triggers AutoLaunchAddin event."))}ka&&
(Ke.instance.HYf(Sf(d),!0),"uploadfiledevcatalog"===d&&(w=this.Gkg.createAddinDataProvider(d,this.Pm))&&w.localCacheAddinCommands(this.Pm.sma,ka.solutionId||ka.id,ka.version||ka.appVersion,ka.storeId),this.Clj(G.r0.txa,d,G.ks,G.eWe),Z.a.bNb(wg.a.rZb,"true",Sf(d)));this.x4f(!0,G)};jd.prototype.x4f=function(G,ka){if(G)if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&ka.r0&&5===ka.ks&&ka.r0.txa&&void 0!==ka.hi.showCallout&&null!==
ka.hi.showCallout&&ka.hi.showCallout)(new Sd(this.rb,ka.hi,Pc.a.jub(ka.r0.txa))).eBg(),G=new oe,G.Bo=ka.r0.txa,G.hi=ka.hi,this.rb.raiseEvent(wg.a.G3f,G);else if(3!==ka.ks)ka.bkf&&this.dra.Qvc();else{if(ka.r0&&ka.r0.txa&&(G=Object(Vh.a)(Kd.Ribbon,ka.eWe),"hardcodedpreinstall"!==ka.hi.storeType)){var d=!1;this.JDa&&(d=ka.hi.isAutoLaunched);gk.a.AAj(G,ka.ZFh,ka.displayName,ka.r0.txa,d)}}else 3===ka.ks?ka.hi&&"uploadfiledevcatalog"===ka.hi.storeType.toLowerCase()?(ka=this.mpa.EPh(ka.hi.solutionId),gk.a.tRd(ka?
ka:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.dra.NZf():ka.bkf&&this.dra.Qvc()};jd.prototype.Wlc=function(G){var ka=(G=void 0===G?null:G)?G.hi:null,d=new oe;if(d.hi=ka){var w;(w=this.dra.cja(ka.storeType||ka.currentStoreType,ka.solutionId||ka.id,6===G.ks?1:0))&&w.Bo&&(d.Bo=w.Bo,this.kWa&&3===G.ks&&"hardcodedpreinstall"!==ka.storeType)&&(G="",w.Bo.qW&&w.Bo.qW.Nr&&(w=w.Bo.qW.Nr.oa(0))&&(G=w.id),w={},ka=(w.SDX_CommandPlacement=G,w.SDX_PinningAction="Pinning",
w.SDX_PinningActionErrorCode="0",w.SDX_Id=Telemetry.PrivacyRules.GetAssetId(ka.storeType,ka.storeId,ka.solutionId),w),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Yi.a.Rk(ka)})))}this.rb.raiseEvent(wg.a.dpe,d)};jd.prototype.Clj=function(G,ka,d,w){w=Object(Vh.a)(Kd.Ribbon,w);G&&w&&(G=G.tabs.oa(0).USa[Nc.a.id],3===d&&"hardcodedpreinstall"!==ka&&w.mNd(G),w.hni(G)&&w.Blj())};Object(de.a)(jd,"LaunchAddinCommandsHandler",null,[485]);b(914);b(892);
md.prototype.Q7=function(){return Yg.k(this.k4d,this.JAi(),this.EA)};md.prototype.JAi=function(){var G=null;if(this.Vfa){G=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>');for(var ka=yl(this.Vfa),d=ka.next();!d.done;d=ka.next())G.append(d.value.Q7());G.append("</Controls></MenuSection></Menu>")}return G?G.toString():""};Sk.Object.defineProperties(md.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}},EA:{configurable:!0,enumerable:!0,get:function(){return this.i4d||
(this.i4d={})}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.k4d||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.Vfa||(this.Vfa=new ph.a)}}});Object(de.a)(md,"ControlDefinition",null,[483]);jc.prototype.Q7=function(){return Yg.k(Nc.a.button,null,this.hNc)};Sk.Object.defineProperties(jc.prototype,{JR:{configurable:!0,enumerable:!0,get:function(){return this.hNc||(this.hNc={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});
Object(de.a)(jc,"MenuItemDefinition",null,[501]);Yb.prototype.Q7=function(){var G=null;if(this.B8){G=new Sys.StringBuilder;for(var ka=yl(this.B8),d=ka.next();!d.done;d=ka.next())G.append(d.value.Q7())}return G?G.toString():""};Sk.Object.defineProperties(Yb.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.B8||(this.B8=new ph.a)}}});Object(de.a)(Yb,"OfficeMenuDefinition",null,[480]);var re=b(30);Ua.prototype.addButton=
function(G){Se.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",G.actionType);this.fJ=new md(this.fQ(G.id),Nc.a.button);this.fJ.EA[Nc.a.jgb]=G.label;this.fJ.EA[Nc.a.iCa]=G.label;this.fJ.EA[Nc.a.lCa]=G.icon["16"];this.osa(this.fJ.EA[Nc.a.id],G.action);this.w2(this.fJ.EA);this.rVa.controls.add(this.fJ);this.fJ=null};Ua.prototype.startBuildMenu=function(G){if(xi.c(this.rVa))this.rVa=new Yb(G.id);else{var ka=this.fQ(G.id);this.fJ=new md(ka,Nc.a.wZ);this.zha(this.fJ.EA,G);this.fJ.EA[Nc.a.lCa]=
G.icon["16"];this.fJ.EA[Nc.a.AUa]=re.a.alwaysEnabled}};Ua.prototype.addMenuItem=function(G){Se.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",G.actionType);var ka=new jc(this.fQ(G.id));this.zha(ka.JR,G);G.icon&&(ka.JR[Nc.a.lCa]=G.icon["16"]);this.osa(ka.JR[Nc.a.id],G.action);this.w2(ka.JR);this.fJ.menuItems.add(ka)};Ua.prototype.endBuildMenu=function(){xi.c(this.fJ)?(this.Xkc.add(this.rVa),this.rVa=null):(this.rVa.controls.add(this.fJ),this.fJ=null)};Ua.prototype.osa=function(G,
ka){this.xmb.bindAction(G,ka)};Ua.prototype.w2=function(G){this.dHa.w2(G)};Ua.prototype.fQ=function(G){return this.d6.hva(G)};Ua.prototype.zha=function(G,ka){G[Nc.a.jgb]=ka.label;G[Nc.a.iCa]=ka.label};Sk.Object.defineProperties(Ua.prototype,{d6:{configurable:!0,enumerable:!0,get:function(){return this.ekb}},dHa:{configurable:!0,enumerable:!0,get:function(){return this.jfa}},xmb:{configurable:!0,enumerable:!0,get:function(){return this.$ea}},Xkc:{configurable:!0,enumerable:!0,get:function(){return this.Fsg}}});
Object(de.a)(Ua,"ContextMenuExtensibilityCreator",null,[498,490]);sa.prototype.hva=function(G){return this.kOa+G};Sk.Object.defineProperties(sa.prototype,{kOa:{configurable:!0,enumerable:!0,get:function(){return this.mEa}}});Object(de.a)(sa,"DefaultContextMenuNamingProvider",null,[499]);Lb.prototype.sNh=function(G){return this.P2g+G};Sk.Object.defineProperties(Lb.prototype,{MJj:{configurable:!0,enumerable:!0,get:function(){return this.Hxg}},P2g:{configurable:!0,enumerable:!0,get:function(){return this.mng}}});
Object(de.a)(Lb,"DefaultRibbonGroupTemplate",null,[502]);Sk.Object.defineProperties(Hb.prototype,{$db:{configurable:!0,enumerable:!0,get:function(){return this.Ylb}}});Object(de.a)(Hb,"DefaultRibbonGroupTemplateResolver",null,[497]);var We=b(1294);Gc.prototype.bindAction=function(G,ka){OfficeExt.DefaultControlActionBinder.bindAction(G,ka)};Object(de.a)(Gc,"DefaultUIControlActionBinder",null,[496]);Kb.prototype.w2=function(G){G[Nc.a.AUa]=this.command};Sk.Object.defineProperties(Kb.prototype,{command:{configurable:!0,
enumerable:!0,get:function(){return this.JCa}}});Object(de.a)(Kb,"DefaultUIControlCommandBinder",null,[495]);var df=b(31);Object(de.a)(Sa,"AddInControl",null,[]);Object(de.a)(gb,"AddInGroup",null,[]);Object(de.a)(Sb,"AddInMenuItem",null,[]);Object(de.a)(zb,"AddInTab",null,[]);kc.prototype.startBuildTab=function(G){var ka=G.isOfficeTab?G.id:this.d6.shd(G.id),d=G.isOfficeTab?null:G.label;this.Av=Object.assign(new zb,{id:ka,title:d,isOfficeTab:G.isOfficeTab,visible:G.visible,groups:[],tabType:G.tabType,
insertBefore:G.insertBefore,insertAfter:G.insertAfter,autoFocus:G.autoFocus})};kc.prototype.startBuildGroup=function(G){var ka=this.fQ(G.id);this.Tw=Object.assign(new gb,{id:ka,mlrId:G.mlrId,title:G.label,controls:[],groupType:0})};kc.prototype.addNativeGroup=function(G){this.Tw=Object.assign(new gb,{id:G.id,mlrId:G.mlrId,title:G.label,controls:[],groupType:1});this.Av.groups.push(this.Tw)};kc.prototype.addButton=function(G){var ka=this.fQ(G.id);ka&&(this.osa(ka,G.action),Se.ULS.sendTraceTag(24786640,
220,50,"AddInDataTransferObject button actiontype: {0}.",G.actionType),G=Object.assign(new Sa,{id:ka,title:G.label,iconLocation:this.qfd(G),enabled:G.enabled,controlType:0,attributes:this.zha()}),this.n6d.Ele(new df.a(ka,this.dHa.command.toString())),this.Tw.controls.push(G))};kc.prototype.addNativeControl=function(G){G.id&&(Se.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",G.actionType),G=Object.assign(new Sa,{id:G.id,title:"",iconLocation:"",enabled:G.enabled,
controlType:2,attributes:this.zha()}),this.Tw.controls.push(G))};kc.prototype.startBuildMenu=function(G){var ka=this.fQ(G.id);ka&&(this.C8=Object.assign(new Sa,{id:ka,title:G.label,iconLocation:this.qfd(G),controlType:1,attributes:{},menuItems:[]}))};kc.prototype.addMenuItem=function(G){var ka=this.fQ(G.id);ka&&(this.osa(ka,G.action),Se.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",G.actionType),G=Object.assign(new Sb,{id:ka,title:G.label,iconLocation:this.qfd(G),
enabled:G.enabled,attributes:this.zha()}),this.n6d.Ele(new df.a(ka,this.dHa.command.toString())),this.C8.menuItems.push(G))};kc.prototype.endBuildMenu=function(){xi.c(this.C8.id)||this.Tw.controls.push(this.C8);this.C8=null};kc.prototype.endBuildGroup=function(){xi.c(this.Tw.id)||this.Av.groups.push(this.Tw);this.Tw=null};kc.prototype.endBuildTab=function(){xi.c(this.Av.id)||this.JPb.add(this.Av);this.Av=null};kc.prototype.zha=function(){var G={};this.w2(G);return G};kc.prototype.qfd=function(G){return G.icon["80"]?
G.icon["80"]:G.icon["32"]};kc.prototype.w2=function(G){this.dHa.w2(G)};kc.prototype.fQ=function(G){return this.d6.hva(G)};kc.prototype.osa=function(G,ka){this.xmb.bindAction(G,ka)};Sk.Object.defineProperties(kc.prototype,{d6:{configurable:!0,enumerable:!0,get:function(){return this.ekb}},Nr:{configurable:!0,enumerable:!0,get:function(){return this.JPb}},kzc:{configurable:!0,enumerable:!0,get:function(){return null}},xmb:{configurable:!0,enumerable:!0,get:function(){return this.$ea}},dHa:{configurable:!0,
enumerable:!0,get:function(){return this.jfa}}});Object(de.a)(kc,"OneLineRibbonExtensibilityCreator",null,[489,490]);lb.prototype.Q7=function(){for(var G=new ph.a,ka=yl(this.iia),d=ka.next();!d.done;d=ka.next())G.add(d.value.Q7());G=Yg.e.apply(null,[Nc.a.BUa,null].concat(G.toArray()));return Yg.e(Nc.a.GROUP,this.Lva,G)};Sk.Object.defineProperties(lb.prototype,{$db:{configurable:!0,enumerable:!0,get:function(){return this.Ylb},set:function(G){this.Ylb=G;this.Lva[Nc.a.S0d]=this.Ylb}},Lva:{configurable:!0,
enumerable:!0,get:function(){return this.s7d||(this.s7d={})}},iia:{configurable:!0,enumerable:!0,get:function(){return this.j4d||(this.j4d=new ph.a)}}});Object(de.a)(lb,"GroupDefinition",null,[]);Va.prototype.Q7=function(){for(var G=new ph.a,ka=new ph.a,d=yl(this.EMd),w=d.next();!w.done;w=d.next())G.add(w.value.Q7());d=yl(this.jK);for(w=d.next();!w.done;w=d.next())ka.add(w.value.Q7());ka=this.tve(Nc.a.hgb,this.f6e,ka.toArray());G=this.tve(Nc.a.TDc,this.DWf,G.toArray());return Yg.e(Nc.a.Q0d,this.USa,
G,ka)};Va.prototype.tve=function(G,ka,d){var w={};w[Nc.a.id]=ka;return Yg.e.apply(null,[G,w].concat(d))};Sk.Object.defineProperties(Va.prototype,{aBa:{configurable:!0,enumerable:!0,get:function(){return this._id}},USa:{configurable:!0,enumerable:!0,get:function(){return this.lie||(this.lie={})}},jK:{configurable:!0,enumerable:!0,get:function(){return this.t7d||(this.t7d=new ph.a)}},EMd:{configurable:!0,enumerable:!0,get:function(){return this.kge||(this.kge=new ph.a)}}});Object(de.a)(Va,"TabDefinition",
null,[]);bb.prototype.startBuildTab=function(G){G=G.isOfficeTab?this.d6.ZUh(G.id):this.d6.shd(G.id);this.Av=new Va(G)};bb.prototype.startBuildGroup=function(G){G=this.fQ(G.id);this.Tw=new lb(G)};bb.prototype.addButton=function(G){var ka=this.fQ(G.id);this.osa(ka,G.action)};bb.prototype.startBuildMenu=function(){};bb.prototype.addMenuItem=function(G){var ka=this.fQ(G.id);this.osa(ka,G.action)};bb.prototype.endBuildMenu=function(){};bb.prototype.endBuildGroup=function(){this.Av.jK.add(this.Tw);this.Tw=
null};bb.prototype.endBuildTab=function(){xi.c(this.Av.aBa)||this.qie.add(this.Av);this.Av=null};bb.prototype.osa=function(G,ka){this.xmb.bindAction(G,ka)};bb.prototype.fQ=function(G){return this.d6.hva(G)};Sk.Object.defineProperties(bb.prototype,{Nr:{configurable:!0,enumerable:!0,get:function(){return null}},d6:{configurable:!0,enumerable:!0,get:function(){return this.ekb}},xmb:{configurable:!0,enumerable:!0,get:function(){return this.$ea}},kzc:{configurable:!0,enumerable:!0,get:function(){return this.qie}}});
Object(de.a)(bb,"RibbonExtensibilityCreatorBase",null,[489,490]);Ia.prototype.Q7=function(){return Yg.k(this.Evg,null,this.u0)};Sk.Object.defineProperties(Ia.prototype,{u0:{configurable:!0,enumerable:!0,get:function(){return this.jge||(this.jge={})}}});Object(de.a)(Ia,"ScalingDefinition",null,[]);vm(ta,bb);ta.prototype.startBuildTab=function(G){bb.prototype.startBuildTab.call(this,G);this.Av.isOfficeTab=G.isOfficeTab;if(!this.Av.isOfficeTab)this.Av.USa[Nc.a.Zea]=this.z7b(G.label);else if(this.Av.aBa){var ka=
this.d6.NSh(G.id);ka&&(this.Av.USa[Nc.a.Zea]=ka);(G=this.d6.LSh(G.id))&&(this.Av.USa[Nc.a.I0d]=G)}G=this.Av.aBa;this.Av.DWf=G+"."+Nc.a.TDc;this.Av.f6e=G+"."+Nc.a.hgb};ta.prototype.startBuildGroup=function(G){bb.prototype.startBuildGroup.call(this,G);this.Tw.Lva[Nc.a.Zea]=this.z7b(G.label)};ta.prototype.addButton=function(G){bb.prototype.addButton.call(this,G);Se.ULS.sendTraceTag(17085954,220,50,"RibbonExtensibility button actiontype: {0}.",G.actionType);var ka=this.kU(G,Nc.a.button);this.w2(ka.EA);
ka.EA[Nc.a.kCa]=G.enabled;this.Tw.iia.add(ka)};ta.prototype.startBuildMenu=function(G){this.C8=this.kU(G,Nc.a.wZ)};ta.prototype.addMenuItem=function(G){bb.prototype.addMenuItem.call(this,G);Se.ULS.sendTraceTag(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",G.actionType);var ka=this.fQ(G.id);ka=new jc(ka);this.zha(ka.JR,G);this.w2(ka.JR);ka.JR[Nc.a.kCa]=G.enabled;this.C8.menuItems.add(ka)};ta.prototype.endBuildMenu=function(){this.Tw.iia.add(this.C8);this.C8=null};ta.prototype.endBuildGroup=
function(){this.CRg();this.Av.EMd.add(this.mfa);this.pfa&&(this.Av.EMd.add(this.pfa),this.pfa=null);this.mfa=null;bb.prototype.endBuildGroup.call(this)};ta.prototype.w2=function(G){this.dHa.w2(G)};ta.prototype.kU=function(G,ka){var d=this.fQ(G.id);ka=new md(d,ka);this.zha(ka.EA,G);return ka};ta.prototype.zha=function(G,ka){G[Nc.a.jgb]=this.z7b(ka.label);G[Nc.a.iCa]=this.z7b(ka.label);G[Nc.a.lCa]=ka.icon["16"];G[Nc.a.F0d]=ka.icon["32"]};ta.prototype.CRg=function(){var G=this.X2h.$db;this.Tw.$db=G.MJj;
var ka=this.Tw.iia.count;Se.ULS.sendTraceTag(17085956,220,50,"Control count: {0}.",ka);var d=this.Tw.Lva[Nc.a.id];this.mfa=new Ia(Nc.a.RDc);this.mfa.u0[Nc.a.id]=d+".Scaling."+Nc.a.RDc;this.mfa.u0[Nc.a.ODc]=this.Tw.Lva[Nc.a.id];2<ka&&(this.pfa=new Ia(Nc.a.SDc),this.pfa.u0[Nc.a.id]=d+".Scaling."+Nc.a.SDc,this.pfa.u0[Nc.a.ODc]=this.Tw.Lva[Nc.a.id]);this.Xtj(ka,G)};ta.prototype.Xtj=function(G,ka){var d=1;switch(G){case 1:case 2:this.mfa.u0[Nc.a.$oa]=Nc.a.LARGE;break;case 3:this.mfa.u0[Nc.a.$oa]=Nc.a.LARGE;
this.pfa.u0[Nc.a.$oa]=Nc.a.vPb;break;case 4:this.mfa.u0[Nc.a.$oa]=Nc.a.vPb+"TwoRow";this.pfa.u0[Nc.a.$oa]=Nc.a.SMALL+"TwoRow";break;case 5:case 6:this.mfa.u0[Nc.a.$oa]=Nc.a.vPb;this.pfa.u0[Nc.a.$oa]=Nc.a.SMALL;break;default:throw Se.ULS.sendTraceTag(9041819,220,10,"Addin commands does not support {0} controls.",G),this.mpa.setErrorMessageForAddin(this.aFc,CommonUIStrings.l_AddinManifestInvalid_Message),Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls",G));
}for(var w=yl(this.Tw.iia),I=w.next();!I.done;I=w.next())I.value.EA[Nc.a.T0d]=ka.sNh(d),d+=3!==G?1:2};ta.prototype.z7b=function(G){return G?(G=Xc.a.replaceAll(G,"&","&amp;"),G=Xc.a.replaceAll(G,"'","&apos;"),G=Xc.a.replaceAll(G,'"',"&quot;"),G=Xc.a.replaceAll(G,">","&gt;"),G=Xc.a.replaceAll(G,"<","&lt;")):null};Sk.Object.defineProperties(ta.prototype,{X2h:{configurable:!0,enumerable:!0,get:function(){return this.Tpg}},dHa:{configurable:!0,enumerable:!0,get:function(){return this.jfa}}});Object(de.a)(ta,
"RibbonExtensibilityCreator",bb,[]);ra.prototype.Yue=function(G){G=new sa(G);return new Ua(G,this.jfa,this.$ea)};ra.prototype.zRg=function(G,ka,d){d=new We.a(this.mEa,G,d,!0);var w=new Hb(this.mEa+"Ribbon.Templates.AddInCommandsControlGroup","addinControl");return new ta(d,this.$ea,this.jfa,w,G,ka)};ra.prototype.kRg=function(G,ka,d,w){d=new We.a(this.mEa,G,d,!0);return new kc(d,this.$ea,this.jfa,G,ka,w)};Object(de.a)(ra,"UIExtensibilityFactory",null,[469]);var ag=b(92),lg=b(949);Ba.prototype.s$i=
function(G){this.So=G;window.addEventListener&&(window.addEventListener("LaunchContentAddin",Object(Qi.a)(this,this.YOi,"onLaunchButtonClicked_ContentAddin"),!0),window.addEventListener("DismissCallout",Object(Qi.a)(this,this.nKi,"onDismissButtonClicked_ContentAddin"),!0),window.addEventListener("CloseCallout",Object(Qi.a)(this,this.SIi,"onCloseButtonClicked_ContentAddin"),!0))};Ba.prototype.Bgd=function(G){return"[id="+G+"]"};Ba.prototype.b5f=function(G,ka){var d=this;ka>fg.AFrameworkApplication.ga.Ad("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)?(window.clearTimeout(this.bsc),this.a5f("[data-unique-id='pivotOverflowButton']"),Se.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+G)?this.a5f(G):this.bsc=window.setTimeout(function(){d.b5f(G,ka+1)},1E3)};Ba.prototype.$4f=function(G){var ka=document.querySelector("button[data-unique-id='RightPaddle']");if(ka)G={},G=(G.AppTeachingUICalloutAction="RightPaddlePresent",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.hi.storeType,
this.hi.storeId,this.hi.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(G)}));else if(ka=document.querySelector("button"+G),!ka&&(ka=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!ka)){ka={};ka=(ka.AppTeachingUICalloutAction="NoAnchor",ka["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.hi.storeType,this.hi.storeId,
this.hi.assetId),ka.AppTeachingUICalloutGoal="NewAdminDeployment",ka["SDX.AppInstallOrigin"]="Organization",ka);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(ka)}));Se.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");return}this.rag(ka,"ShowTeachingUIForAddinButton")};Ba.prototype.a5f=function(G){G=document.querySelector("button"+G);if(!G&&(G=document.querySelector("button[data-unique-id='pivotOverflowButton']"),
!G)){G={};G=(G.AppTeachingUICalloutAction="NoAnchor",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.hi.storeType,this.hi.storeId,this.hi.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(G)}));Se.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");return}this.rag(G,"ShowTeachingUIForAddinTab")};
Ba.prototype.rag=function(G,ka){G.setAttribute("lpp-id","latestAddin");var d=qi.a.instance.oc("Common.ISystemInitiatedFeedback");d&&G?(d.execute(function(w){w.logActivity(ka,null)}),G={},G=(G.AppTeachingUICalloutAction="Show",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.hi.storeType,this.hi.storeId,this.hi.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Yi.a.Rk(G)})),Se.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(Se.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),G={},G=(G.AppTeachingUICalloutAction="NoSifFutureObject",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.hi.storeType,this.hi.storeId,this.hi.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(G)})))};Ba.prototype.IJh=function(G){if(!G)return null;G=G.qW;if((null===G||void 0===G?0:G.Nr)&&0<G.Nr.count){G=yl(G.Nr);for(var ka=G.next();!ka.done;ka=G.next())if(ka=ka.value,ka.groups&&0<ka.groups.length){ka=yl(ka.groups);for(var d=ka.next();!d.done;d=ka.next())if(d=d.value,d.controls&&0<d.controls.length){d=yl(d.controls);for(var w=d.next();!w.done;w=d.next()){w=w.value;if(w.attributes&&0===w.controlType&&w.enabled)return w.id;
if(w.menuItems)for(var I=yl(w.menuItems),ha=I.next();!ha.done;ha=I.next())if(ha=ha.value,ha.attributes&&ha.enabled)return w.id}}}}return null};Ba.prototype.aDj=function(){var G=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(null==G){G=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==G){G={};G=(G.AppTeachingUICalloutAction="NoAnchor",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.So.storeType,this.So.storeId,
this.So.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(G)}));Se.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}Se.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}else Se.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");var ka=
qi.a.instance.oc("Common.ISystemInitiatedFeedback");null==ka||null==G?(G={},G=(G.AppTeachingUICalloutAction="NoSifFutureObject",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.So.storeType,this.So.storeId,this.So.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(G)})),Se.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture")):
(ka.execute(function(d){d.logActivity("ShowTeachingUIForContentAddin",null)}),G={},G=(G.AppTeachingUICalloutAction="Show",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.So.storeType,this.So.storeId,this.So.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(G)})),Se.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))};
Ba.prototype.YOi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnLaunch",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.So.storeType,this.So.storeId,this.So.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(G)}));var ka={};ka[yj.a.Ug]=this.So;G={};G.solutionId=this.So.solutionId;G.assetId=this.So.assetId;G.assetStoreId=
this.So.assetStoreId;G.height=0!=this.So.height?this.So.height:600;G.storeId=this.So.storeId;G.storeType=this.So.storeType;G.targetType=this.So.targetType;G.width=0!=this.So.width?this.So.width:600;G.displayName=this.So.displayName;G.version=this.So.version;G.isAddinCommands=!1;ka[wg.a.SYa]=G;var d=new ag.a(-741808261,0,0,2,null);Bh.TaskExtensions.Ba(gj.GetServiceTaskFactory.Wa(this.$.da,374,375,1),function(w){w=w.result;null!=w&&w.insertAgave(ka,d)},this.$.ma,3)};Ba.prototype.SIi=function(){var G=
{};G=(G.AppTeachingUICalloutAction="ClickOnClose",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.So.storeType,this.So.storeId,this.So.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(G)}))};Ba.prototype.nKi=function(){var G={};G=(G.AppTeachingUICalloutAction="ClickOnDismiss",G["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.So.storeType,
this.So.storeId,this.So.assetId),G.AppTeachingUICalloutGoal="NewAdminDeployment",G["SDX.AppInstallOrigin"]="Organization",G);Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(G)}))};Object(de.a)(Ba,"AddinTeachingCalloutHandler",null,[]);var oh=b(1243),zh=b(376),uh=b(9),Ji=b(37);P.prototype.dispose=function(){void 0!==this.Enb&&null!==this.Enb&&(this.Enb.dispose(),this.Enb=null);this.We=this.$=null;this.disposed=!0};P.prototype.lTi=
function(G){var ka=this;if(void 0!==G&&this.hRd&&isNullOrUndefined(this.ezc)){var d=G.solutionId;Se.ULS.sendTraceTag(526509831,220,50,"Start monitor addin {0}.",Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,d));this.ezc=d;this.bsc=window.setTimeout(function(){ka.hRd&&(qi.a.instance.oc("Common.ISystemInitiatedFeedback").execute(function(w){w.logActivity("Office_Excel_Addins_NoActivationFloodgate",null)}),Se.ULS.sendTraceTag(526254983,220,15,String.format("The addin {0} is not launched in 5 mins",
Telemetry.PrivacyRules.GetAssetId(G.storeType,G.storeId,ka.ezc))),ka.hRd=!1)},this.wIj)}};P.prototype.gbj=function(G){fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",!1)&&this.ezc===G&&(window.clearTimeout(this.bsc),this.ezc=void 0)};P.prototype.Vxj=function(G,ka){switch(G){case re.a.A2:G=this.Hxj(ka);break;default:G=!1}return G};P.prototype.Yc=function(){return!1};P.prototype.executeCommand=function(G,ka,d){var w=this;G=Bh.TaskExtensions.om();
ka=ka.command;switch(ka){case 843847158:break;case -2025863019:gk.a.tRd(d[wg.a.MVc].toString(),function(){dj.g(w.$).focus()});break;case -1777565636:oh.a.showUILessDialog(d[wg.a.Fnb].toString());this.We.PAj(d[wg.a.Fnb].toString());break;case 1592314317:oh.a.hideUILessDialog(d[wg.a.Fnb].toString());this.We.A7h(d[wg.a.Fnb].toString());break;case re.a.A2:G=this.Fid(d);break;case re.a.NAb:this.pNa(d);break;case re.a.dna:this.dna(d);break;case re.a.uRd:this.Enb.Dxc();break;case re.a.refreshAddinCommands:this.p8i();
break;case 1949669462:this.eha.NZf(!0);break;case -1014260128:G=this.executeDynamicAddInCommandsAPI(d);break;default:G=Xi.a(ka)}return G};P.prototype.Jc=function(G,ka){G=!1;switch(ka.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case re.a.dna:case re.a.uRd:case re.a.refreshAddinCommands:case 1949669462:case re.a.NAb:case -1014260128:G=!0;break;case re.a.A2:G=!fg.AFrameworkApplication.protectedFile}return G};P.prototype.fd=function(){return!1};P.prototype.pNh=function(G){if(!G)return Se.ULS.sendTraceTag(528098432,
220,10,"Failed to get button id for addin"),null;if((G=G.qW)&&G.Nr&&0<G.Nr.count){G=yl(G.Nr);for(var ka=G.next();!ka.done;ka=G.next()){ka=ka.value;if(ka.groups&&1===ka.groups.length){var d=ka.groups[0];if(d.controls&&1===d.controls.length){var w=d.controls[0];if(w.attributes&&!w.controlType&&w.enabled)return w.id}d.controls&&Se.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}ka.groups&&Se.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}}return null};P.prototype.p8i=function(){if(this.eha.Qtd()){this.eha.Yye();
var G=this.zdd();if(G&&0<G.count){G=yl(G);for(var ka=G.next();!ka.done;ka=G.next()){var d={};ka=(d[wg.a.K2]=ka.value,d[wg.a.zJ]=4,d[wg.a.OFa]=(new Date).getTime(),d);this.dna(ka)}}}};P.prototype.dna=function(G){var ka=this;Se.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",G[wg.a.zJ],G[wg.a.K2]);this.eha.$pj();window.setTimeout(function(){if(void 0===ka.We||null===ka.We)Se.ULS.sendTraceTag(537170656,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",
Ji.a.u3()));else{var d=new rb(new ld(ka.We.Ji),zc.instance,Ke.instance);d.ODg(function(w,I){ka.pNa(I.properties)});fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&fg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&d.lHg(function(w,I){null==I?(w={},w=(w.AppTeachingUICalloutAction="InvalidEventArgs",w.AppTeachingUICalloutGoal="NewAdminDeployment",w["SDX.AppInstallOrigin"]=
"Organization",w),Uh.a.sendTelemetryEvent(Object.assign(new Yh.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Yi.a.Rk(w)}))):(ka.e9f=new Ba(ka),ka.e9f.s$i(I),w=ka.$.Ka,null!=w&&(w.Voe(Object(Qi.a)(ka,ka.xbf,"onTabSwitched")),Se.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});d.YOj(G)}},0)};P.prototype.xbf=function(G,ka){"Insert"==ka.tabName&&(G=this.$.Ka,null!=G&&(G.DRf(Object(Qi.a)(this,this.xbf,"onTabSwitched")),Se.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),
this.e9f.aDj())};P.prototype.pNa=function(G){var ka=this;if(!this.disposed){Se.ULS.sendTraceTag(537170655,220,50,"LaunchOperationType {0}.",G[wg.a.zJ]);if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",!1))try{var d=G[wg.a.NFa],w=G[wg.a.zJ];if(d&&0<d.count&&3==w){var I=d.oa(0);I.storeType==OSF.StoreType.OMEX&&this.lTi(I)}}catch(vd){Se.ULS.sendTraceTag(526509830,220,10,String.format("Monitor survey error message : {0}.",vd.message))}try{if(Gf.EwaSettings.la(187)){var ha=
G[wg.a.NFa];if(ha&&0<ha.count){var wa=ha.count;for(d=wa-1;0<=d;d--){var $a=ha.oa(d);Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString($a.currentStoreType)||ha.remove(ha.oa(d)):$a.currentStoreType.toLowerCase()!==OSF.StoreType.FirstParty.toLowerCase()&&ha.remove(ha.oa(d))}if(ha.count<wa){var Tb=gj.GetServiceTaskFactory.Wa(this.$.da,5,4,0);Bh.TaskExtensions.Ba(Tb,function(){Tb.result.ig(35,null)},this.$.ma,3)}if(!ha.count)return}}if(void 0===
this.We||null===this.We)Se.ULS.sendTraceTag(537170654,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",Ji.a.u3()));else{var Ic=null;Ic=fg.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled")?new jd(this.co,this.qCe,new ld(this.We.Ji),new ra(this.$.Ib,re.a.A2),this.eha,zc.instance,this.dha,function(vd,ne){var Pe={};Pe.InstanceId=Li.a.create().toString();Pe.PrimaryMarketplace={};Pe.PrimaryMarketplace.MarketplaceRef=vd.storeId;Pe.PrimaryMarketplace.MarketplaceType=
vd.currentStoreType;Pe.PrimaryMarketplace.SolutionId=vd.assetId;Pe.PrimaryMarketplace.SolutionVersion=vd.appVersion;Pe.WebExtensionType=1;ka.We.hDj(Pe,function(){ne(vd)})}):new jd(this.co,this.qCe,new ld(this.We.Ji),new ra(this.$.Ib,re.a.A2),this.eha,zc.instance,this.dha);(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinOnExcelWacEnabled",!1)||fg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5996085_EmailAlertAutolaunchOnWacEnabled"))&&Ic.VDg(this.DHi);
Ic.PDg(this.WOi);if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var pc=new Ba(this);Ic.IFg(pc.VOi);Ic.kHg(pc.BAj)}this.$.da.Aa(53).Im&&el.a.get_instance().kl(5,null).continueWith(function(){ka.disposed||Ic.asi(ka.ead,ka.$.domElement,G)})}}catch(vd){Se.ULS.sendTraceTag(537170653,220,10,String.format("LaunchAddinCommands error message : {0}.",vd.message))}}};P.prototype.Fid=function(G){var ka=this,d=Bh.TaskExtensions.om();
G=G[this.co.jia];var w=this.oZb.Ake(G),I=new oh.a(this.$,this.We,w.ownerAddinInfo,d);I.LDg(function(){ka.gbj(w.ownerAddinInfo.solutionId)});return this.i6e(d,G,w,I)};P.prototype.i6e=function(G,ka,d,w){var I=this;this.oZb.Fid(ka,this.eha,w,new ld(this.We.Ji),d,function(){G=w.V1g()},function(){dj.g(I.$).focus()});return G};P.prototype.oNg=function(G){var ka=this,d=Bh.TaskExtensions.om(),w=this.We.yaa(G.assetId);if(w){var I=this.We.sZ(w);if(uh.HelperMethods.iw(I)&&0!==I.SharedRuntime.State)return}I=
this.oZb.pNg;var ha=G.assetId in I?I[G.assetId]:null;if(ha){var wa=this.oZb.Ake(ha),$a=new oh.a(this.$,this.We,wa.ownerAddinInfo,d);I=function(Ic){if(Ic){var pc={};Ic=yl(Ic);for(var vd=Ic.next();!vd.done;vd=Ic.next())vd=vd.value,pc[vd[0]]=vd[1];(pc=wg.a.cpe in pc?pc[wg.a.cpe]:null)&&"true"===pc.toLowerCase()&&(Se.ULS.sendTraceTag(537170652,220,50,"Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",G.currentStoreType,G.storeId,Telemetry.PrivacyRules.GetAssetId(null!==
wa.ownerAddinInfo?wa.ownerAddinInfo.storeType:G.currentStoreType,G.storeId,G.assetId)),ka.i6e(d,ha,wa,$a))}};Se.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",G.currentStoreType,G.storeId,Telemetry.PrivacyRules.GetAssetId(null!==wa.ownerAddinInfo?wa.ownerAddinInfo.storeType:G.currentStoreType,G.storeId,G.assetId));if(w)I(this.We.sZ(w).OsfPropertyBag);else if(w=this.$.ea.workbookContext.WebExtensions){w=yl(w);for(var Tb=w.next();!Tb.done;Tb=
w.next())if(Tb=Tb.value,(1===Tb.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===G.targetType&&Tb.PrimaryMarketplace.MarketplaceType.toLowerCase()===G.currentStoreType.toLowerCase()&&Tb.PrimaryMarketplace.MarketplaceRef.toLowerCase()===G.storeId.toLowerCase()&&Tb.PrimaryMarketplace.SolutionId.toLowerCase()===G.assetId.toLowerCase()){I(Tb.OsfPropertyBag);break}}}};P.prototype.YLb=function(G,ka,d){G&&(void 0===d||!d||ka||this.a6c.contains(G)||this.a6c.add(G),(d=this.v1a.contains(G))&&
ka&&this.v1a.remove(G),d||ka||this.v1a.add(G))};P.prototype.Ftj=function(G){var ka=G.qW;if(ka){if(ka.Nr)for(G=yl(ka.Nr),ka=G.next();!ka.done;ka=G.next())if(ka=ka.value,ka.groups){ka=yl(ka.groups);for(var d=ka.next();!d.done;d=ka.next())if(d=d.value,d.controls){var w=yl(d.controls);for(d=w.next();!d.done;d=w.next())if(d=d.value,this.YLb(d.id,d.enabled,!0),1===d.controlType&&d.menuItems){var I=yl(d.menuItems);for(d=I.next();!d.done;d=I.next())d=d.value,this.YLb(d.id,d.enabled,!0)}}}}else if(G.tabs)for(G=
yl(G.tabs),ka=G.next();!ka.done;ka=G.next())if(ka=ka.value,ka.jK)for(ka=yl(ka.jK),d=ka.next();!d.done;d=ka.next())if(d=d.value,d.iia)for(w=yl(d.iia),d=w.next();!d.done;d=w.next())if(d=d.value,this.YLb(d.id,Di.a.kCa in d.EA?d.EA[Di.a.kCa]:!0,!0),d.controlType===Di.a.wZ&&d.menuItems)for(I=yl(d.menuItems),d=I.next();!d.done;d=I.next())d=d.value,this.YLb(d.id,Di.a.kCa in d.JR?d.JR[Di.a.kCa]:!0,!0)};P.prototype.zdd=function(){var G=new ph.a;Gf.EwaSettings.la(54)&&(this.$.ea.oh.get(27)&&(G.add(0),G.add(16)),
this.$.ea.oh.get(33)&&G.add(1),G.add(8));return G};P.prototype.executeDynamicAddInCommandsAPI=function(G){var ka=!0;if(void 0===G||null===G||void 0===G[wg.a.usb]||null===G[wg.a.usb])return Wj.Task.Ta(!1);switch(G[wg.a.usb]){case 1:ka=this.WRj(G);break;case 2:ka=this.Jtj(G);break;case 4:this.v1a.clear();this.v1a.addRange(this.a6c);break;case 3:ka=this.installContextualTab(G);break;default:ka=!1}return Wj.Task.Ta(ka)};P.prototype.Hxj=function(G){return G&&this.co.jia in G?(G=G[this.co.jia])?this.v1a.contains(G):
!1:!1};P.prototype.WRj=function(G){var ka=null,d=null,w=null,I=!0;void 0!==G[wg.a.Y3]&&null!==G[wg.a.Y3]&&void 0!==G[this.co.jia]&&null!==G[this.co.jia]&&void 0!==G[wg.a.X3]&&null!==G[wg.a.X3]&&(ka=G[wg.a.Y3],d=G[wg.a.g7b],w=G[this.co.jia],I=G[wg.a.X3]);if(!ka||!w)return Se.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;G=(new We.a(this.$.Ib,ka,this.co,!0)).hva(w);ka={DynamicAddinCommandsApiName:"UpdateControlEnableState"};ka.AssetId=d;ka.MaskedTabId=
G;ka.IsToEnable=I;Se.ULS.sendTraceTag(537170648,220,15,cj.a.Kc(ka));this.YLb(G,I);zh.a.Iy.updateCommandUI();return!0};P.prototype.Jtj=function(G){var ka,d,w=null,I=null,ha=null,wa=null,$a=!0;void 0!==G[wg.a.K7c]&&null!==G[wg.a.K7c]&&void 0!==G[wg.a.Y3]&&null!==G[wg.a.Y3]&&void 0!==G[this.co.jia]&&null!==G[this.co.jia]&&void 0!==G[wg.a.X3]&&null!==G[wg.a.X3]&&(w=G[wg.a.K7c],I=G[wg.a.Y3],ha=G[wg.a.g7b],wa=G[this.co.jia],$a=G[wg.a.X3]);if(!w||!I||!wa)return Se.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),
!1;G=(new We.a(this.$.Ib,I,this.co,!0)).shd(wa);wa={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};wa.StoreType=w;wa.AssetId=ha;wa.MaskedTabId=G;wa.IsToShow=$a;Se.ULS.sendTraceTag(537170646,220,15,cj.a.Kc(wa));I=this.eha.cja(w,I,1);w=!1;if(null===(d=null===(ka=null===I||void 0===I?void 0:I.Bo)||void 0===ka?void 0:ka.qW)||void 0===d?0:d.Nr)for(ka=yl(I.Bo.qW.Nr),d=ka.next();!d.done;d=ka.next())if(d.value.id===G){w=!0;break}if(!w)return Se.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),
!1;ka=[];$a?appChrome.selectors.getSelectedTabId()!==G&&ka.push(appChrome.actions.activateRibbonTab(G)):(appChrome.selectors.getSelectedTabId()===G&&ka.push(appChrome.actions.setCurrentTab(Ii.a.JW)),ka.push(appChrome.actions.deactivateRibbonTab(G)));appChrome.api.dispatch(ka);return!0};P.prototype.installContextualTab=function(G){var ka=null,d=null,w=null,I=null;if(void 0!==G[wg.a.Y3]&&null!==G[wg.a.Y3]&&void 0!==G[wg.a.X3]&&null!==G[wg.a.X3]){var ha=G[wg.a.X3];ka=G[wg.a.Y3];void 0!==ha[wg.a.GIa]&&
null!==ha[wg.a.GIa]&&void 0!==ha[wg.a.HIa]&&null!==ha[wg.a.HIa]&&(d=ha[wg.a.GIa],w=ha[wg.a.HIa],I=ha[wg.a.L7c])}if(!(ka&&w&&d&&I))return Se.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;G=this.eha.cja(I.PrimaryMarketplace.MarketplaceType,I.PrimaryMarketplace.SolutionId,1);if(null===G||void 0===G?0:G.Bo)return Se.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;G={};G.solutionId=I.PrimaryMarketplace.SolutionId;G.version=
I.PrimaryMarketplace.SolutionVersion;G.storeType=I.PrimaryMarketplace.MarketplaceType;G.storeId=I.PrimaryMarketplace.MarketplaceRef;G.assetId=I.PrimaryMarketplace.SolutionId;G.assetStoreId=I.PrimaryMarketplace.MarketplaceRef;G.targetType=I.WebExtensionOsfControlType;G.width=I.TaskpaneWidth;G.height=0;G.isAddinCommands=!0;G.id=G.assetId;G.appVersion=I.PrimaryMarketplace.SolutionVersion;G.currentStoreType=I.PrimaryMarketplace.MarketplaceType;I=new ph.a;I.add(G);G={};G[wg.a.NFa]=I;G[wg.a.zJ]=6;G[wg.a.GIa]=
d;G[wg.a.HIa]=w;this.pNa(G);return!0};Object(de.a)(P,"AddinUICommandHandler",null,[192,188,3]);var yi=b(72);Ob.prototype.qKb=function(){return this.wQd()};Ob.prototype.activate=function(){return this.vTc()};Ob.prototype.deactivate=function(){this.R5c()};Ob.prototype.dispose=function(){this.R5c=this.vTc=this.wQd=null};Object(de.a)(Ob,"FeatureActivator",null,[45,3]);var Oi=b(21),Pi=b(17),Mi=vj.a;vm(cc,Mi);cc.prototype.Od=function(){var G=this;Se.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");
yi.a(this.$).add(Object.assign(new Ob,{wQd:function(){var ka=G.$.ea.qF&&G.$.ea.qc&&!!(G.$.Hd&16384)&&G.$.isEditMode;G.$.ea.qc&&Se.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",ka,G.$.ea.qF,G.$.ea.qc,!!(G.$.Hd&16384),G.$.isEditMode);return ka},vTc:this.Kzg,R5c:this.Xbh,$8b:2}))};cc.prototype.X8i=function(G){var ka=this,d=gj.GetServiceTaskFactory.create(this.$.da,
102,this.ma,this.ub);return Bh.TaskExtensions.Ba(d,function(){Se.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");ka.$.da.Ha(204,new ke(d.result,G))},this.ma,3)};cc.ja=function(G){vj.a.fe(199,new cc(G))};Object(de.a)(cc,"AddinUICommandHandlerFactory",vj.a,[]);var zj=b(1232),lj=b(1234),Zg=Vg.a;vm(Jb,Zg);Jb.prototype.create=function(){var G=this,ka;if(Gf.EwaSettings.la(413)){var d=gj.GetServiceTaskFactory.create(this.$.da,
106,this.$.ma,this.ub),w=gj.GetServiceTaskFactory.create(this.$.da,396,this.$.ma,this.ub);Bh.TaskExtensions.Ba(Wj.Task.WAA(d,w),function(){G.Fb(G.$.da.Aa(278)||new zj.CustomFunctionsInstaller(G.$,d.result,w.result))},this.$.ma,3)}else(ka=this.$.da.Aa(278))||(ka=this.$.da.Ha(278,new lj.CustomFunctionsLegacyInstaller(this.$))),this.Fb(ka)};Jb.ja=function(G){G.da.Ha(279,new Jb(G))};Object(de.a)(Jb,"CustomFunctionsInstallerFactory",Vg.a,[]);var ci=b(88),Ui=b(44),Ri=b(42);ic.prototype.ja=function(G){this.zXc?
Se.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):(this.zXc=!0,this.ZPa={},this.$Pa={},G?G.BEg(this.vag):Se.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};ic.prototype.detach=function(G){if(G){G.Ybj(this.vag);G=this.ZPa;for(var ka in G)ci.a.Fa(G[ka]);this.$Pa=this.ZPa=null;this.zXc=!1}else Se.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};
ic.prototype.mNf=function(G,ka,d){if(this.yfi(d,G))return!1;G=ka.querySelector("iframe");if(!G)return Se.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;G=G.title;if(!G||!G.length)return Se.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(G);return!0};ic.prototype.yfi=function(G,ka){return(G=G.Ji.getOsfControl(ka))?G.getPageStatus()!==OSF.OsfControlPageStatus.Ready:
!0};Object(de.a)(ic,"AgaveOnSelectedReadoutHandler",null,[416]);var Ij=Vg.a;vm(Ub,Ij);Ub.prototype.create=function(){var G=this,ka=this.$.da;Bh.TaskExtensions.Ba(gj.GetServiceTaskFactory.Wa(ka,211,212,this.ub),function(d){d=ka.Aa(224)||new ic(d.result,G.$);G.Fb(d)},this.ma,3)};Ub.ja=function(G){G.da.Ha(225,new Ub(G))};Object(de.a)(Ub,"AgaveOnSelectedReadoutHandlerFactory",Vg.a,[]);var mi=b(862),Si=b(231);Oa.prototype.q7e=function(G){try{if(G&&G.rawEvent&&G.rawEvent.origin&&this.iframe&&this.iframe.id){var ka=
this.XGf(G.rawEvent.origin),d=this.XGf(document.domain);if(Oh.a.Hk().equals(d,ka))if(G.rawEvent.source&&G.rawEvent.source.frameElement&&G.rawEvent.source.frameElement.id&&Oh.a.Hk().equals(G.rawEvent.source.frameElement.id,this.iframe.id)){ka=null;try{ka=JSON.parse(G.rawEvent.data)}catch(w){Se.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",w.message)}ka?(ka.statusCode!==Si.a.kP||void 0!==ka.error&&
ka.error?(Se.ULS.sendTraceTag(23707648,344,50,"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",ka.statusCode,ka.error),this.onError()):(Se.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(ka.authorizationCode?ka.authorizationCode:ka.signInUrl)),$removeHandler(window,"message",Object(Qi.a)(this,this.q7e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):
Se.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):Se.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):Se.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else Se.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else Se.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else Se.ULS.sendTraceTag(51418200,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(w){Se.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",w.message)}};Oa.prototype.XGf=function(G){var ka="";try{G&&(ka=-1<G.indexOf("//")?G.split("/")[2]:G.split("/")[0])&&(ka=ka.split(":")[0],ka=ka.split("?")[0])}catch(d){Se.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",d.message)}return ka};Oa.ja=function(G,ka,d){new Oa(G,ka,d)};Object(de.a)(Oa,
"ResponseHandler",null,[]);var wi=b(277);lc.prototype.tryAuthenticate=function(G,ka){this.D$a(lc.rqg,function(){G()},ka)};lc.prototype.tryAuthorize=function(G,ka){this.D$a(lc.zlg,G,ka)};lc.prototype.getSignInUrl=function(G,ka){this.D$a(lc.yhe,G,ka)};lc.prototype.signOut=function(G,ka){this.D$a(lc.Awg,G,ka)};lc.prototype.D$a=function(G,ka,d){var w=new wi.QueryStringBuilder("AuthenticationProxyHandler.aspx");w.Hi("responseType",G);fg.AFrameworkApplication.Umb(w);w=String.format("{0}{1}&{2}",this.jFa,
w.toString(),fg.AFrameworkApplication.mj);var I=document.createElement("iframe");I.setAttribute("id","privateCatalogIframe");I.setAttribute("name","privateCatalogIframe");I.setAttribute("style","display: none");Oh.a.Hk().equals(G,lc.yhe)||I.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Oa.ja(I,ka,d);I.setAttribute("src",w);document.body.appendChild(I)};lc.zlg="authcode";lc.rqg="identitytoken";lc.yhe="signinurl";lc.Awg="signout";Object(de.a)(lc,
"AuthenticationProxy",null,[]);Xb.getUserId="getUserId";Xb.getLastStoreUpdate="laststoreupdate";Xb.getEntitlement="getEntitlements";Xb.getEToken="getEToken";Xb.getManifest="getManifest";Xb.getAppState="getAppState";Xb.getKilledApps="getRemovedAddins";Xb.getAppDetails="getAppDetails";Xb.removeApps="removeAddin";Xb.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";Xb.getPrivateCatalogAddIns="getAddIns";Xb.getPrivateCatalogManifests="getAppManifests";Xb.isStoreDisabled="isStoreDisabled";Object(de.a)(Xb,
"S2SWebRequestActions",null,[]);var zi=b(596);$b.prototype.getUserId=function(G,ka){var d=new ph.a;d.add(new di.a("corr",G));this.fX(Xb.getUserId,d,1,ka)};$b.prototype.getLastStoreUpdate=function(G,ka,d){var w=new ph.a;w.add(new di.a("lc",G));w.add(new di.a("corr",ka));this.fX(Xb.getLastStoreUpdate,w,1,d)};$b.prototype.getEntitlement=function(G,ka,d,w){G=new ph.a;G.add(new di.a("av",ka));G.add(new di.a("corr",d));this.fX(Xb.getEntitlement,G,1,w)};$b.prototype.getEToken=function(G,ka,d,w,I,ha){var wa=
new ph.a;wa.add(new di.a("cmu",G));wa.add(new di.a("cmf",ka));wa.add(new di.a("assetid",d));wa.add(new di.a("expver",w));wa.add(new di.a("corr",I));this.fX(Xb.getEToken,wa,1,ha)};$b.prototype.getManifest=function(G,ka,d,w){var I=new ph.a;I.add(new di.a("cmu",G));I.add(new di.a("assetid",ka));I.add(new di.a("corr",d));this.fX(Xb.getManifest,I,1,w)};$b.prototype.getAppState=function(G,ka,d){var w=new ph.a;w.add(new di.a("ma",G));w.add(new di.a("corr",ka));this.fX(Xb.getAppState,w,1,d)};$b.prototype.getKilledApps=
function(G,ka){var d=new ph.a;d.add(new di.a("corr",G));this.fX(Xb.getKilledApps,d,1,ka)};$b.prototype.getAppDetails=function(G,ka,d,w){var I=new ph.a;I.add(new di.a("cmo",G));I.add(new di.a("corr",d));this.hcb(Xb.getAppDetails,I,ka,2,w,!1)};$b.prototype.removeApps=function(G,ka,d){var w=new ph.a;w.add(new di.a("corr",ka));this.hcb(Xb.removeApps,w,G,2,d,!1)};$b.prototype.getLastPrivateCatalogUpdate=function(G,ka,d,w,I,ha){var wa=new ph.a;wa.add(new di.a("catalog","privatecatalog"));wa.add(new di.a("clientCode",
G));wa.add(new di.a("clientVersion",ka));wa.add(new di.a("corr",I));G=String.format("authorizationCode={0}&refreshToken={1}",d?Xc.a.pf(d):"",w?Xc.a.pf(w):"");this.hcb(Xb.getLastPrivateCatalogUpdate,wa,G,2,ha,!0)};$b.prototype.getPrivateCatalogAddIns=function(G,ka,d,w,I,ha){var wa=new ph.a;wa.add(new di.a("catalog","privatecatalog"));wa.add(new di.a("clientCode",G));wa.add(new di.a("clientVersion",ka));wa.add(new di.a("corr",I));G=String.format("authorizationCode={0}&refreshToken={1}",d?Xc.a.pf(d):
"",w?Xc.a.pf(w):"");this.hcb(Xb.getPrivateCatalogAddIns,wa,G,2,ha,!0)};$b.prototype.getPrivateCatalogManifests=function(G,ka,d,w,I){var ha=new ph.a;ha.add(new di.a("catalog","privatecatalog"));ha.add(new di.a("corr",w));G=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Xc.a.pf(G),ka?Xc.a.pf(ka):"",d?Xc.a.pf(d):"");this.hcb(Xb.getPrivateCatalogManifests,ha,G,2,I,!0)};$b.prototype.isStoreDisabled=function(G,ka){var d=new ph.a;d.add(new di.a("corr",G));this.fX(Xb.isStoreDisabled,
d,2,ka)};$b.prototype.fX=function(G,ka,d,w){this.hcb(G,ka,null,d,w,!1)};$b.prototype.hcb=function(G,ka,d,w,I,ha){var wa=new wi.QueryStringBuilder("AddinServiceHandler.ashx");wa.Hi("action",G);wa.Hi("app",zi.a[fg.AFrameworkApplication.sa.Qa.Pj]);ka=yl(ka);for(var $a=ka.next();!$a.done;$a=ka.next())$a=$a.value,wa.Hi($a.key,$a.value);wa=String.format("{0}{1}&{2}",fg.AFrameworkApplication.sa.Qa.jW,wa.toString(),fg.AFrameworkApplication.mj);fg.AFrameworkApplication.Jd.Xl(wa,w,d,null,!1,2,function(Tb){var Ic=
null;Tb&&Tb.data&&(Tb.data.responseHeaders["X-BlockedForMinor"]&&"1"===Tb.data.responseHeaders["X-BlockedForMinor"].toString()&&(Tb.data.httpStatus=451),Ic=Tb.data.ie);I(Tb.data.httpStatus,Ic)},function(Tb){var Ic=null;ha&&Tb&&Tb.data&&Tb.data.ie&&(Ic=Tb.data.ie);I(Tb.data.httpStatus,Ic);if(fg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){Ic={message:"AddinServiceHandler request failed"};Ic.code=Tb.data.httpStatus;Ic.action=G;
if(Tb.data.request||Tb.data.request.get_headers())Ic["X-UserSessionId"]=Tb.data.request.get_headers()["X-UserSessionId"];408===Tb.data.httpStatus||503===Tb.data.httpStatus?Se.ULS.sendTraceTag(538784582,220,10,JSON.stringify(Ic)):Se.ULS.sendTraceTag(18392345,220,50,JSON.stringify(Ic))}else Se.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",Tb.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+G)};Object(de.a)($b,"S2SWebRequestManager",null,[]);var Ei=Vg.a;
vm(pd,Ei);pd.prototype.create=function(){var G=this;Se.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");fg.AFrameworkApplication.disableWholeAppsForOfficeFeature?Se.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",fg.AFrameworkApplication.disableWholeAppsForOfficeFeature):Gf.EwaSettings.la(417)?qi.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(ka){ka.isFeatureEnabled("mso_officeStore",
!0).then(function(d){mi.DdaFacade.O2c=d;G.sEe();return null})}):this.sEe()};pd.prototype.sEe=function(){var G=this,ka=gj.GetServiceTaskFactory.Wa(this.$.da,224,225,this.ub),d=ff.a.Mtd(41,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,this.$.ma,this.ub,106),w=pb(this.ma,this.ub);Bh.TaskExtensions.Ba(Bh.TaskExtensions.ve([ka,d,w],this.$.ma),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?Se.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",
Ji.a.u3()):G.Y$h();Se.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");G.lNf=ka.result;G.Fb(G.We);Se.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ma,3)};pd.prototype.Y$h=function(){Gf.EwaSettings.la(65)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new $b);this.$.jg.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new $b,new lc(fg.AFrameworkApplication.ga.appSettings.WebServiceBase),Gf.EwaSettings.la(72),
Gf.EwaSettings.la(448))};pd.prototype.dispose=function(){ci.a.Fa(this.ddaFacade);this.$=this.ddaFacade=null;Ei.prototype.dispose.call(this)};pd.ja=function(G){new pd(G)};Sk.Object.defineProperties(pd.prototype,{We:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new mi.DdaFacade(this.$,this.lNf))}}});Object(de.a)(pd,"DdaFacadeServiceFactory",Vg.a,[]);sc.prototype.fd=function(){return!1};sc.prototype.Yc=function(){return!1};sc.prototype.Jc=function(G,ka,d,w){var I=
!1;switch(ka.command){case -684355545:I=!0;break;case -741808261:I=!!d;break;case -859308420:I=!!w&&1===w.xA;break;case 418618014:I=1===G&&!!w&&1===w.xA;break;case -515602470:ka=Gf.EwaSettings.la(236)&&2===G;I=(1===G||ka)&&!!w&&1===w.xA;break;case 2086613372:I=Gf.EwaSettings.la(236)&&2===G&&!!w&&1===w.xA;break;case -1336341324:I=Gf.EwaSettings.la(500)&&1===G&&!!w&&1===w.xA;break;case -1444574190:case -336193495:I=1===G&&!!w&&1===w.xA;break;case 1296389134:I=1===G&&!!w&&1===w.xA;break;case 1221897806:I=
Gf.EwaSettings.la(167)&&2===G;break;case 1172793074:case 1930653487:I=Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1)&&2===G;break;case -1753056834:I=Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:I=!0;break;case 301511274:I=Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:I=Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",
!1)&&this.$.isEditMode;break;case 1723441034:I=this.$.isEditMode&&this.$.ea.kKb}return I};sc.prototype.executeCommand=function(G,ka,d){var w=Bh.TaskExtensions.om(),I=ka.command;switch(ka.command){case 1296389134:this.agaveCommandManager.fGj(d.SourceControlId,d.LabelText);break;case -684355545:this.agaveCommandManager.YZc();break;case -741808261:w=this.agaveCommandManager.insertAgave(d,ka);break;case -1336341324:Gf.EwaSettings.la(500)&&(w=this.agaveCommandManager.Sid(d,G,ka));break;case 1172793074:Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1)&&(w=this.agaveCommandManager.Sid(d,G,ka));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 418618014:case 1221897806:case 1930653487:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:w=this.agaveCommandManager.Sid(d,G,ka);break;default:w=Xi.a(I)}return w};Object(de.a)(sc,"AgaveCommandHandler",null,[188]);Object(de.a)(mb,"Selection",null,[]);Object(de.a)(Za,"SmartLookupApplicationInterface",null,[]);Object(de.a)(ec,"ApplicationProperties",
null,[]);Object(de.a)(tb,"EnterpriseUserInfo",null,[]);Object(de.a)(Ya,"FeatureGates",null,[]);Eb.prototype.kZh=function(){var G=void 0===G?!0:G;var ka=this.DGe();if(ka<this.fvd+this.$Lj)return ka>this.fvd+this.cMj&&this.vdd(),this.oof;G&&this.vdd();return""};Eb.prototype.vdd=function(){var G=this;this.ivd=this.ivd||new Promise(function(ka){G.lZh().then(function(d){G.oof=d;G.fvd=G.DGe();G.ivd=null;ka(d)})})};Eb.prototype.lZh=function(){var G=this;return this.q8a&&this.q8a.length?new Promise(function(ka){G.Pxa.FS("SmartLookup",
G.q8a).then(function(d){d.IsSuccess?d.Token||(ka(""),Se.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(Se.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+d.ErrorCode+": "+d.ErrorMessage),ka(""));ka(d.Token)}).catch(function(d){d=Rh.c(d);Se.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+d);ka("")})}):(Se.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),
Promise.resolve(""))};Object(de.a)(Eb,"SmartLookupAuthenticationManager",null,[474]);ub.yPh=function(){switch(Object(Vh.a)(String,fg.AFrameworkApplication.Yb.AudienceGroup)||""){case "Dogfood":if(fg.AFrameworkApplication.ga){var G=fg.AFrameworkApplication.ga.Ua("UserPrincipalName");G=Xc.a.Ol(G);var ka=fg.AFrameworkApplication.ga.Ty("SmartLookupINTEnabledForSKITeam")?fg.AFrameworkApplication.ga.fw("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(ka,G)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};
ub.KYh=function(){switch(fg.AFrameworkApplication.ga.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":fg.AFrameworkApplication.ga.ra("IntentSvcEnableProdSourceLocationOverride")?"PROD":fg.AFrameworkApplication.ga.ra("IntentSvcEnableIntSourceLocationOverride")?"INT":ub.yPh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};
Object(de.a)(ub,"Utils",null,[]);var Ai=b(579);ib.prototype.kKh=function(){return Promise.resolve(this.lKh())};ib.prototype.lKh=function(){var G=new ec;G.anid="";G.applicationVersion=fg.AFrameworkApplication.buildVersion;G.appCorrelationId=Kj.a.create().toString();G.themePlatform=ib.QXj;G.lcid=fg.AFrameworkApplication.lcid;G.launchUtcTime=(new Date).toUTCString();G.featureGates=this.p8a;var ka=Ai.a.cK(fg.AFrameworkApplication.lcid);ka=ka?ka.name:null;G.market=this.xac(ka);G.uiLanguage=ka;G.sessionId=
fg.AFrameworkApplication.userSessionId;G.themeId=0;G.parentalControl=ib.SXi;var d=new tb;d.CountryCode=this.xac(ka);d.ServiceEndpoint=this.q8a;d.IsGoLocal=!1;d.IsEnabled=this.Tof;d.IsEnterpriseEnabled=this.Tof;d.TenantRoot=this.eyi;G.enterpriseUserInfo=d;G.accessToken=this.$xi.kZh();return G};ib.prototype.xac=function(G){G=G.split("-");return G[G.length-1]};Sk.Object.defineProperties(ib.prototype,{approvedOriginPattern:{configurable:!0,enumerable:!0,get:function(){return this.zxi}}});ib.QXj="web";
ib.SXi="yes";Object(de.a)(ib,"SmartLookupManager",null,[452]);var vh=dk.a;vm(vb,vh);vb.prototype.fd=function(){return!1};vb.prototype.Yc=function(){return!1};vb.prototype.Jc=function(G,ka){G=Gf.EwaSettings.la(135);return-983891024===ka.command&&G};vb.prototype.executeCommand=function(G,ka){G=Bh.TaskExtensions.om();-983891024===ka.command&&this.Kri();return G};vb.prototype.Kri=function(){var G=this,ka=new ib(null),d={},w=dj.g(this.$).uc(null).originalText;w=Object.assign(new mb,{neighborhood:w,mentionStart:0,
mentionLength:w?w.length:0});var I=Object.assign(new Za,{selection:w,entryPoint:0});ka.kKh().then(function(wa){wa.applicationName=vb.appName;wa.isFirstLaunch=G.isFirstLaunch;wa.themeId=5;d[vb.smartLookupApplicationInterface]=JSON.stringify(I);d[vb.UJg]=JSON.stringify(wa);G.isFirstLaunch=!1});ka=new rj.a("ExcelOnline","Web","en-Us");w=new ij.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var ha=new Ig.a;ha.si[ue.dl]=zf.a.instance.fa(1760);ha.si[ue.taskPaneWidth]=350;ha.si[ue.sourceLocationOverrideResourceId]=
"WAC.PROD.URL";ha.ir=d;qj.a.instance.qNa(w,"Taskpane","SmartLookupSDXTaskpane",ka,ha)};vb.UJg="AppProperties";vb.appName="Excel";vb.smartLookupApplicationInterface="SmartLookupApplicationInterface";Object(de.a)(vb,"SmartLookupCommandHandler",dk.a,[188]);var ki=vj.a;vm(Dc,ki);Dc.prototype.Od=function(){var G=this;kk.a(this.$,374,375,this.ub,function(ka){G.Fd([new sc(G.$,null,null,null,null,ka),new vb(G.$)])})};Dc.ja=function(G){vj.a.fe(76,new Dc(G))};Object(de.a)(Dc,"AgaveCommandHandlerFactory",vj.a,
[]);Object(de.a)(function(){},"AppInfoDetail",null,[]);b(1075);Object(de.a)(function(){},"AppsForOfficeUtils",null,[]);Object(de.a)(Mb,"AppsDataManager",null,[533]);var Og=b(1296),Rj=b(104);cb.prototype.initialize=function(G){cb.initialized||(this.We=G,this.Qg(),cb.initialized=!0)};cb.prototype.Qg=function(){fg.AFrameworkApplication.Gb.ef(re.a.iab,Rj.a.frame,this.iab,96);fg.AFrameworkApplication.Gb.fc(re.a.N8i,Rj.a.frame,this.X9i)};Sk.Object.defineProperties(cb,{instance:{configurable:!0,enumerable:!0,
get:function(){cb.Oa||(cb.Oa=new cb);return cb.Oa}}});cb.Oa=null;cb.initialized=!1;Object(de.a)(cb,"AgaveCommandActor",null,[]);var Tj=b(109),Pk=b(354),Wk=b(351),jj=b(1257),Aj=b(340);Object(de.a)(Ga,"FirstPartyAddinTaskpaneOverrides",null,[]);Object(de.a)(za,"IdeasSelectionContext",null,[]);vm(ya,za);Object(de.a)(ya,"IdeasTableSelectionContext",za,[]);var nj=b(61),ni=b(43),sj=b(369),Sj=b(154),Mj=b(587),ok=b(127),Gk=b(140),Kk=b(172),pk=Gk.a;vm(eb,pk);eb.prototype.gD=function(){pk.prototype.gD.call(this);
this.yp.style.width=this.s2d;this.yp.style.height=this.iVa;this.yp.style.marginTop=this.JQb;this.yp.style.padding=this.jVa};eb.prototype.VPa=function(){this.yp.style.width=this.s2d;this.yp.style.height=this.iVa;this.yp.style.marginTop=this.JQb;this.yp.style.padding=this.jVa;this.XCa>Kk.a.p$a?(this.Lb.style.width=String.format("{0}px",Kk.a.p$a),this.Lb.style.overflowX="scroll",fg.AFrameworkApplication.isRtl?this.Lb.style.right="0":this.Lb.style.left="0"):(this.Lb.style.width=String.format("{0}px",
this.XCa),this.Lb.style.overflowX="hidden");this.Lb.offsetHeight>Kk.a.o$a||this.Yng+50>Kk.a.o$a?(this.Lb.style.height=String.format("{0}px",Kk.a.o$a),this.Lb.style.overflowY="scroll",this.Lb.style.top="0",fg.AFrameworkApplication.isRtl?this.Lb.style.right="0":this.Lb.style.left="0",this.MHc||(this.Lb.style.marginTop="-48px"),this.yp.style.minHeight=String.format("{0}px",this.Olg)):(this.Lb.style.overflowY="hidden",this.Lb.style.top="10%",this.Lb.style.height=this.Mhb);this.F_a()};eb.prototype.F_a=
function(){if(this.Lb){var G=this.Lb.style.zIndex;this.Lb.style.zIndex="-9999";if(this.XCa>Kk.a.p$a)fg.AFrameworkApplication.isRtl?this.Lb.style.marginRight="0":this.Lb.style.marginLeft="0";else{var ka=String.format("{0}px",Math.floor(-this.Lb.offsetWidth/2));fg.AFrameworkApplication.isRtl?this.Lb.style.marginRight=ka:this.Lb.style.marginLeft=ka;fg.AFrameworkApplication.isRtl?this.Lb.style.right="50%":this.Lb.style.left="50%"}this.Lb.style.zIndex=String(G)}else Se.ULS.sendTraceTag(19976784,306,10,
"_divMessageBox is null in CenterDialog()")};eb.prototype.IO=function(){pk.prototype.IO.call(this);var G=document.getElementById(this.ri(this.Xng));G.style.width=String.format("{0}px",this.XCa);G.style.height=this.Mhb};Sk.Object.defineProperties(eb.prototype,{q1a:{configurable:!0,enumerable:!0,get:function(){return this.yp}}});Object(de.a)(eb,"AppsForOfficeInsertionDialog",Gk.a,[532]);var uk=b(1095),fl=dk.a;vm(Cb,fl);Cb.prototype.uFg=function(G){this.addHandler(Cb.pCd,G)};Cb.prototype.Jcj=function(G){this.removeHandler(Cb.pCd,
G)};Cb.prototype.dispose=function(){ci.a.Fa(this.rwa);this.rwa=null;fl.prototype.dispose.call(this)};Cb.prototype.YZc=function(){this.rwa.hide()};Cb.prototype.fGj=function(G,ka){if(G){this.raiseEvent(Cb.pCd);var d=G.split("|");this.Kvi(G,ka,d);this.rwa=new eb;this.rwa.initializeAndShow("",null,null);this.We.csi(this.rwa.q1a,d)}};Cb.prototype.Sid=function(G,ka,d){var w=Bh.TaskExtensions.om();if(-515602470===d.command||-336193495===d.command||2086613372===d.command||-1444574190===d.command||-1336341324===
d.command)w=this.e4h(G,ka,d);418618014===d.command&&(ka=new Lj.a,ka.dl=zf.a.instance.fa(1771),w=this.J0(d,Cb.l7h,ka,!0));if((d.tabName===this.$.Ib+Ii.a.GUf||d.tabName===Ii.a.g0)&&2===d.af||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),G[yj.a.ld])||G[yj.a.ld]===Ii.a.MZ)return this.X6e(G,d);if(7===d.af&&G.SourceControlId===this.$.Ib+Ii.a.vcc)return G.MenuItemId=Ii.a.WGd,this.X6e(G,d);1221897806===d.command&&(w=this.J3f(d,"Format"));if(1930653487===d.command||1172793074===
d.command)w=this.J3f(d,"Data");-1753056834===d.command&&(w=this.NBj(d));932597253===d.command&&(Se.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),Fa.c(932597253,!0),ka=new Lj.a,ka.dl=zf.a.instance.fa(2099),ka.sourceLocationOverrideResourceId=Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",!1)?Cb.p0i:Cb.r0i,ka.focusOnIframeWhenLoaded=!0,ka.taskPaneWidth=Cb.E$e,w={},w.LaunchSource=Object(Vh.a)(String,G.SourceControlId),w.LaunchMode=
"Default",ka.gI=w,w=this.J0(d,Cb.q0i,ka,!0));301511274===d.command&&(w=this.YBj(d));515196233===d.command&&((ka=this.$.da.Aa(465))&&ka.k9e(),ka=new Lj.a,ka.dl=zf.a.instance.fa(2168),w={},w.SourceUILocation=Pk.a[d.af],ka.gI=w,w=new mc,w.cba=Xe.a.$Ia,w=this.J0(d,Cb.EWi,ka,!0,w,void 0,ka.dl));1723441034===d.command&&(ka=new Lj.a,ka.dl=zf.a.instance.fa(2180),ka.focusOnIframeWhenLoaded=!0,ka.taskPaneWidth=Cb.m3i,w=new mc,w.cba=Xe.a.Bqh,w=this.J0(d,Cb.l3i,ka,!0,w));Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",
!1)&&G.LoadDataFromPictureTaskpane&&(ka={},w=new Lj.a,w.dl=zf.a.instance.fa(2206),ka.SessionID=G.SessionID,w.gI=ka,w.focusOnIframeWhenLoaded=!0,w=this.J0(d,G.DataFromPictureAssetId,w,!0));return w};Cb.prototype.insertAgave=function(G,ka){var d=this,w=Bh.TaskExtensions.om(),I=this.$,ha=G[wg.a.SYa];if("SourceControlId"in G){var wa={};var $a=G.SourceControlId.split("|");if(8!==$a.length||!($a[0]&&$a[1]&&$a[2]&&!isNaN(parseInt($a[2],10))&&$a[3]&&!isNaN(parseInt($a[3],10))&&$a[4]&&$a[5]&&!isNaN(parseInt($a[5],
10))&&$a[6]&&$a[7]))return Bh.TaskExtensions.H4();ha={};ha.version=wa.Version=$a[0];ha.assetId=wa.AssetId=$a[1];ha.solutionId=wa.SolutionId=$a[1];ha.height=wa.Height=parseInt($a[2],10);ha.width=wa.Width=parseInt($a[3],10);ha.storeId=wa.StoreId=$a[4];ha.targetType=wa.TargetType=parseInt($a[5],10);ha.assetStoreId=wa.AssetStoreId=$a[6];ha.storeType=wa.StoreType=$a[7];ha.appVersion=$a[0];ha.currentStoreType=$a[7];ha.id=$a[1]}else wa=G[yj.a.Ug];$a=null;mc.key in G&&($a=G[mc.key]);this.rwa&&this.rwa.hide();
if(!wa||!ha)return Se.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),w;this.$.v5&&Ii.a.dBa in G&&(wa.EnabledInViewMode=G[Ii.a.dBa]);G=this.MMh(ka.command);if(!wa.EnabledInViewMode&&!I.Ns(null,!1,G))return w;var Tb=void 0===wa.IsToBePersisted||null===wa.IsToBePersisted||wa.IsToBePersisted?0:16;if(1===wa.TargetType)w=this.qdi(wa,ha,ka,$a,Tb);else{ha=dj.g(I);w=this.viewBlockContainerHelpers.vfb(ha);var Ic=I.ea.isNamedObjectViewMode?I.pa.sheetName:I.pa.name;if(w){ha=
w.qf;var pc=ha.Zf.top;var vd=ha.Zf.left;var ne=w.XI.x;var Pe=w.XI.y}else pc=vd=1,w=this.viewBlockContainerHelpers.IKa(ha),ne=w.x,Pe=w.y;var Af=this.$.na.ta.Zb();w=function(Wf,Of,xg){var oi=I.na.ta,Sh=wa,mj=pc,tj=vd,Cj=ne,pj=Pe;Wf=ri.b(Wf,d.g0i);var fk=oi.Na(9,Af);fk.sharedInfo=Sh;fk.sheetName=Ic;fk.positionRow=mj;fk.positionCol=tj;fk.positionOffsetX=Cj;fk.positionOffsetY=pj;return Ci.i(oi,"InsertWebExtension",fk,Wf,Of,xg,null,0)};Gf.EwaSettings.sc()?(Tb|=64,w=sj.a(this.$.userOperationManager,w,function(Wf){return new mk.a(534,
0,Wf,Tb)},ka)):w=sj.a(this.$.userOperationManager,w,function(Wf){return new lk.a(534,0,Wf,Tb)},ka)}return w};Cb.prototype.N1g=function(){var G=qi.a.instance.oc("Common.App.ICustomerFeedbackUiWrapper"),ka=qi.a.instance.oc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.rad?this.rad.ojb?this.sxe():ka.instance.s7c(this.EAh):Se.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");ka={};fg.AFrameworkApplication.ga.kme(ka);G=G.instance.getContext(ka);ka={};
"telemetryGroup"in G&&(ka=G.telemetryGroup);ka.processSessionId=G.sessionId;ka.officeBuild=G.build;G.telemetryGroup=ka;G.feedbackType=-1;G.userVoiceEnabled=!1;"disableIncludeScreenshot"in G||(G.disableIncludeScreenshot=!1);"screenshot"in G||(G.screenshot=!1);G.disableScreenshotPreview=!1;G.includeScreenshotSelectedDefault=!0;return G};Cb.prototype.E0i=function(G){if(!this.Q$a&&Gf.EwaSettings.la(735)&&Gf.EwaSettings.getBooleanFeatureGate(Cb.d9h,!1)){var ka=Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";ka=this.bve(ka);var d=new mc;d.Nj=Xe.a.m$c;this.Q$a=this.HMd(ka,null,!1,null,d);ka={};ok.b(this.$).ee(De.a.F0i,(ka.Location=Pk.a[G.af],ka.InputMethod=Wk.a[G.method],ka),void 0,!0)}};Cb.prototype.OZf=function(G){var ka=this.$.ea.oh.get(17);qi.a.instance.oc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(d){d.isFeatureEnabled("mso_sendASmile",ka).then(function(w){G.FeedbackEnabled=ka&&w;return null})})};Cb.prototype.J3f=
function(G,ka){var d=dj.g(this.$),w=new Lj.a,I={};I.ActiveTab=ka;I.DatapaneFlighting=Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",!1);I.RangePickerFlighting=Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",!1);I.AceFlighting=!0;I.ChartNewSDXRecording=Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);I.ThemeColorsFlighting=Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",
!1)&&Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");I.UOMirror=Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",!1);this.OZf(I);I.startTimeMs=Date.now();I.UserSessionId=this.$.ya.UserSessionId;(ka=d.ha.Pa.Fo)&&(I.SubSelection=ka);Se.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",I.UserSessionId,void 0===G.af||null===G.af?"Null":Pk.a[G.af],ka||"ChartRoot");w.gI=I;w.dl=
zf.a.instance.fa(953);I=new mc;I.cba=Xe.a.$Ia;return this.J0(G,Cb.JWg,w,!0,I)};Cb.prototype.NBj=function(G){var ka=new Lj.a;ka.gI={};ka.dl=zf.a.instance.fa(1759);ka.AS=Cb.Dlf;var d=new mc;d.cba=Xe.a.$Ia;return this.J0(G,Cb.Dlf,ka,!0,d,void 0,ka.dl)};Cb.prototype.YBj=function(G){var ka=new Lj.a;ka.gI={};ka.dl=zf.a.instance.fa(2123);var d=new mc;d.cba=Xe.a.$Ia;return this.J0(G,Cb.uDi,ka,!0,d)};Cb.prototype.X6e=function(G,ka){var d=Cb.e9e,w=G[yj.a.ld].toString(),I={},ha=new Lj.a;ha.dl=zf.a.instance.fa(9);
switch(w){case "A0":I.query=(G[yj.a.Ug]||"").split("|").slice(2,Aj.a.WS).join("|");break;case "A1":I.query=G.CommandValueId;break;case "Help":I.gwdropdownflightinfo=Gf.EwaSettings.la(241);I.query="";break;case Ii.a.WGd:Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(ha.dl=zf.a.instance.fa(1725),ha.sourceLocationOverrideResourceId=Cb.C5e,I.feedback=this.N1g()):I.query=w;break;case "HelpArticle":I.query=G[yj.a.Ug];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":I.query=
w;break;default:return Wj.Task.Ta(!0)}ha.gI=I;w=new mc;w.cba=Xe.a.$Ia;return this.J0(ka,d,ha,!1,w,G[Ii.a.dBa]||!1)};Cb.prototype.bve=function(G){var ka={Version:"0.0.0.0"};ka.AssetId=Cb.kwa;ka.SolutionId=Cb.kwa;ka.AssetStoreId="";ka.StoreType=OSF.StoreType.Sdx;ka.Height=0;ka.Width=0;ka.StoreId=OSF.StoreType.Sdx;ka.TargetType=OSF.OsfControlTarget.TaskPane;ka.IsToBePersisted=!1;ka.SourceLocationOverrideResourceId=G;ka.SharedRuntimeId=G;ka.Id=Cb.kwa;ka.CurrentStoreType=OSF.StoreType.Sdx;ka.AppVersion=
"0.0.0.0";return ka};Cb.prototype.e4h=function(G,ka,d){var w=this,I=new Lj.a,ha=new mc,wa={};this.OZf(wa);wa.LaunchSource="";wa.StartTimeMs=Date.now();wa.CorrelationId=Kj.a.create().toString();I.gI=wa;I.focusOnIframeWhenLoaded=!0;I.taskPaneWidth=Cb.E$e;ha.cba=Xe.a.Lsh;ha.Zzc=Xe.a.TOe;switch(d.command){case -1444574190:var $a,Tb;wa.LaunchMode="RecommendedPivotTables";wa.SelectionContext="";wa.LaunchSource="PivotTableHandRaise"===Object(Vh.a)(String,G.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";
if(this.$&&Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&G.SourceSelection){var Ic=G.SourceSelection.split(",")[0];ka=Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var ne=ni.Z(Ic,w.$.xa);$a=ne.sheetName;Tb=ne.eGb;pc=ne.range;return ne}().returnValue&&!dj.g(this.$).Rb.Ska(pc))G=this.$.xa.getItemByName($a),wa.SelectionContext=JSON.stringify(Object.assign(new za,{address:Tb,addressWithSheet:$a+"!"+pc.FC(!1),sheetId:nj.d(G),
sheetName:$a,isSheetEmpty:!1,columnCount:pc.width,rowCount:pc.height,columnIndex:pc.left+ka,rowIndex:pc.top+ka,selectionType:"Continuous"}));else if((G=this.$.zb.getItemByName(Object(Vh.a)(String,G.SourceSelection)))&&nj.o(G)){var pc=Sj.a(G,!0);var vd=this.$.xa.getItemByName(G.sheetName);wa.SelectionContext=JSON.stringify(Object.assign(new ya,{tableName:G.name,hasTableHeaders:Sj.d(G),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:pc.FC(!1),addressWithSheet:vd.name+"!"+pc.FC(!1),sheetId:nj.d(vd),
sheetName:vd.name,isSheetEmpty:!1,columnCount:pc.width,rowCount:pc.height,columnIndex:pc.left+ka,rowIndex:pc.top+ka,selectionType:"Continuous"}))}}Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?I.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":I.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";I.dl=zf.a.instance.fa(1769);Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(I.AS=Cb.JZi);I.Nj=Xe.a.lRe;ha.Nj=Xe.a.lRe;
break;case -336193495:wa.LaunchMode="RecommendedCharts";Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?I.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":I.sourceLocationOverrideResourceId="RecommendCharts.Bundle";I.dl=zf.a.instance.fa(1768);Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(I.AS=Cb.C7i);I.Nj=Xe.a.mRe;ha.Nj=Xe.a.mRe;break;case -1336341324:if(!Gf.EwaSettings.la(500))return Wj.Task.Ta(!1);wa.LaunchMode="NL";Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&
(I.AS=Cb.pWc);Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?I.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":I.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(Gf.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:I.dl=zf.a.instance.fa(1773);wa.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:I.dl=zf.a.instance.fa(1774);wa.NLLaunchModeBrandingCandidatesIndex=2;break;default:I.dl=
zf.a.instance.fa(1772),wa.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!Gf.EwaSettings.la(236))return Wj.Task.Ta(!1);wa.LaunchMode="ChartDesigner";wa.LaunchSelectionMode=ka.toString();Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?I.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":I.sourceLocationOverrideResourceId="Insights.Https.Bundle";I.dl=zf.a.instance.fa(1775);Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&
(I.AS=Cb.pWc);break;default:wa.LaunchMode="Default",Gf.EwaSettings.la(236)&&(wa.LaunchSelectionMode=ka.toString()),Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?I.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":I.sourceLocationOverrideResourceId="Insights.Https.Bundle",I.dl=zf.a.instance.fa(1770),Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(I.AS=Cb.pWc),I.Nj=Xe.a.m$c,ha.Nj=Xe.a.m$c}return Gf.EwaSettings.la(735)?(Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?I.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":I.sourceLocationOverrideResourceId="Insights.Https.Bundle",this.Q$a?this.Q$a.CWR(function(){return w.QXf(wa,I)}):this.ybi(d,I,ha,wa)):this.J0(d,Cb.kwa,I,!0,ha)};Cb.prototype.ybi=function(G,ka,d,w){var I=this;this.Q$a=this.HMd(this.bve(ka.sourceLocationOverrideResourceId),ka,!1,G,d,!1);return this.Q$a.CWR(function(){return I.QXf(w,ka)})};Cb.prototype.QXf=function(G,ka){var d=this.We.yaa(this.We.SJa(Cb.kwa,ka.sourceLocationOverrideResourceId));
if(d){this.Kcb[Cb.kwa]=G;var w=this.uwd(this.We.sZ(d).OsfPropertyBag,Cb.kwa);this.We.sZ(d).OsfPropertyBag=w}this.qNa(Cb.kwa,"LaunchIdeasAction",G,ka);return Wj.Task.Ta(!0)};Cb.prototype.J0=function(G,ka,d,w,I,ha,wa){d=void 0===d?null:d;w=void 0===w?!1:w;I=void 0===I?null:I;ha=void 0===ha?!1:ha;wa=void 0===wa?null:wa;Bh.TaskExtensions.om();d||(d=new Lj.a);var $a={Version:"0.0.0.0"};$a.AssetId=ka;$a.SolutionId=ka;$a.AssetStoreId="";$a.StoreType=w?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;$a.Height=
0;$a.Width=0;$a.StoreId=w?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;$a.TargetType=OSF.OsfControlTarget.TaskPane;$a.IsToBePersisted=!1;$a.SourceLocationOverrideResourceId=d.sourceLocationOverrideResourceId;$a.AppVersion="0.0.0.0";$a.Id=ka;$a.CurrentStoreType=w?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;if(d.dl||wa)this.obd[ka]=Object.assign(new Ga,{Azc:d.dl,dVd:wa,yzc:d.AS});Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?
(d.gI||(d.gI={}),d.gI.ShowFeedback=this.$.isFeedbackEnabled,this.Kcb[ka]=d.gI):d.gI&&(this.Kcb[ka]=d.gI);ka={};ka[yj.a.Ug]=$a;wa={};wa.id=$a.Id;wa.solutionId=$a.SolutionId;wa.version=$a.Version;wa.storeType=$a.StoreType;wa.storeId=$a.StoreId;wa.assetId=$a.AssetId;wa.assetStoreId=$a.AssetStoreId;wa.height=$a.Height;wa.targetType=$a.TargetType;wa.width=$a.Width;wa.isAddinCommands=!w;wa.appVersion=$a.AppVersion;wa.currentStoreType=$a.CurrentStoreType;ka[wg.a.SYa]=wa;I||(I=new mc);I.focusOnIframeWhenLoaded=
d.focusOnIframeWhenLoaded;I.width=d.taskPaneWidth;ka[mc.key]=I;ka[Ii.a.dBa]=ha;return this.insertAgave(ka,G)};Cb.prototype.qdi=function(G,ka,d,w,I){function ha(pc){Se.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetAssetId(pc.storeType,pc.storeId,pc.solutionId),pc.storeType);var vd={},ne=new ph.a;ne.add(pc);vd[wg.a.NFa]=ne;vd[wg.a.zJ]=3;pc=new ag.a(re.a.NAb,0,$a.$.gd,0,null);return $a.$.Ka.Xb(pc,vd)}function wa(pc,vd){var ne=pc.SolutionId;var Pe=
pc.StoreType;Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(Pe)&&pc.SourceLocationOverrideResourceId&&(ne=$a.We.SJa(ne,pc.SourceLocationOverrideResourceId)):Pe!==OSF.StoreType.FirstParty&&Pe!==OSF.StoreType.Sdx||!pc.SourceLocationOverrideResourceId||(ne=$a.We.SJa(ne,pc.SourceLocationOverrideResourceId));var Af=$a.We.qye(ne,null,pc.SharedRuntimeId);if(Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?
OSF.OsfControl.isFirstPartyStoreString(Pe):Pe===OSF.StoreType.FirstParty||Pe===OSF.StoreType.Sdx)Gf.EwaSettings.la(300)&&Af&&(Pe=$a.We.yaa(ne))&&(ne=null,ne=$a.uwd($a.We.sZ(Pe).OsfPropertyBag,pc.SolutionId),(Pe=$a.We.Ji.getOsfControl(Pe))&&Pe.setSettings(ne)),pc.SharedRuntimeId&&Af||$a.We.Ji.refreshOsfControl(pc.SolutionId,pc.SourceLocationOverrideResourceId);if(!Af){var Wf=$a.$.na.ta.Zb(),Of=519;Af=function(xg,oi,Sh){var mj=$a.$.na.ta;xg=ri.b(xg,$a.EIf);var tj=mj.Na(9,Wf);tj.sharedInfo=pc;return Ci.i(mj,
"InsertAgaveTaskpane",tj,xg,oi,Sh,w,0)};void 0===pc.IsToBePersisted||null===pc.IsToBePersisted||pc.IsToBePersisted||(Of=538,Af=function(xg,oi,Sh){Se.ULS.sendTraceTag(537170442,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",pc.StoreType,pc.StoreId,Telemetry.PrivacyRules.GetAssetId(pc.StoreType,pc.StoreId,pc.SolutionId));var mj=$a.$.na.ta;xg=ri.b(xg,$a.EIf);var tj=mj.Na(9,void 0===Wf?null:Wf);tj.sharedInfo=pc;return Ci.i(mj,"ShowAgaveTaskpane",tj,xg,
oi,Sh,w,0)});return Gf.EwaSettings.sc()?(I|=64,sj.a($a.$.userOperationManager,Af,function(xg){return new mk.a(Of,0,xg,I)},vd)):sj.a($a.$.userOperationManager,Af,function(xg){return new lk.a(Of,0,xg,I)},vd)}return Bh.TaskExtensions.H4()}var $a=this;if(!Gf.EwaSettings.la(54)||G.StoreId===OSF.StoreType.FirstParty)return wa(G,d,w);if(ka.isAddinCommands)return ha(ka);var Tb=new Oj.a,Ic={};Ic.marketplaceId=G.SolutionId;Ic.marketplaceVersion=G.Version;Ic.storeType=G.StoreType;Ic.storeId=G.StoreId;Ic.targetData=
G;Gf.EwaSettings.la(94)&&(Ic.clearCache=!0);this.We.Ji.isAddinCommandsAsync(Ic,function(pc,vd,ne){Tb.setResult(vd);pc||(pc=ne.targetData,Se.ULS.sendTraceTag(537170438,220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetAssetId(pc.StoreType,pc.StoreId,pc.SolutionId),pc.StoreType))});return Bh.TaskExtensions.ts(Tb.task,function(pc){return pc.result?ha(ka):wa(G,d,w)},this.$.ma)};Cb.prototype.uwd=function(G,ka){if(!this.Kcb[ka])return G;var d={};if(G){G=
yl(G);for(var w=G.next();!w.done;w=G.next())w=w.value,d[w[0]]=w[1]}G=this.Kcb[ka];w=yl(Object.keys(G));for(ka=w.next();!ka.done;ka=w.next())ka=ka.value,ka===Cb.GAh&&Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?d[ka]=Sys.Serialization.JavaScriptSerializer.serialize(G[ka]):d[ka]=Sys.Serialization.JavaScriptSerializer.serialize(G[ka].toString());ka=Object.keys(d).length;G=Array(ka);w=0;var I=yl(Object.keys(d));for(ka=I.next();!ka.done;ka=I.next())ka=
ka.value,G[w]=[ka,d[ka].toString()],w++;return G};Cb.prototype.Kvi=function(G,ka,d){var w=this.$.ya.UserSessionId,I=this.$.ya.UICultureTag,ha=this.$.ya.UICultureTagLcid,wa=this.$.ya.WacHostId,$a="",Tb="";5<=d.length&&($a=d[3],Tb=d[4]);this.Lvi($a,Tb,G,ka,I,ha,w,wa)};Cb.prototype.Lvi=function(G,ka,d,w,I,ha,wa,$a){var Tb={};Tb.a=wa;Tb.b=d;Tb.c=w;Tb.d=G;Tb.e=ka;Tb.f=I;Tb.g=ha;Tb.h=$a;Ik.b().Pe(36,Tb)};Cb.prototype.sxe=function(){if(jj.a.Wtf())Se.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");
else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.GIf);return}catch(G){Se.ULS.sendTraceTag(537170432,1302,15,"Failed to use createScreenshot "+(G?G.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.GIf)}catch(G){Se.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(G?G.toString():null))}}};Cb.prototype.HMd=function(G,ka,d,w,I,ha){ka=void 0===ka?null:ka;d=void 0===d?!1:d;w=void 0===w?null:w;I=void 0===I?null:I;ha=void 0===ha?
!0:ha;var wa=G.SolutionId,$a=Wj.Task.Ta(!1);G&&wa&&G.SharedRuntimeId&&(w=w||new ag.a(-859308420,0,2,0,""),wa={},wa.id=G.Id,wa.solutionId=G.SolutionId,wa.version=G.Version,wa.storeType=G.StoreType,wa.storeId=G.StoreId,wa.assetId=G.AssetId,wa.assetStoreId=G.AssetStoreId,wa.height=G.Height,wa.targetType=G.TargetType,wa.width=0,wa.isAddinCommands=!1,wa.sharedRuntimeId=G.SharedRuntimeId,G.Preload=ha,wa.appVersion=G.AppVersion,wa.currentStoreType=G.CurrentStoreType,I=I?I:new mc,I.width=0,ka&&(I.focusOnIframeWhenLoaded=
ka.focusOnIframeWhenLoaded,ha=new Ga,ka.dl&&(ha.Azc=ka.dl),0<ka.taskPaneWidth&&(ha.Er=ka.taskPaneWidth),ka.AS&&Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(ha.yzc=ka.AS),this.obd[G.SolutionId]=ha),ka={},ka[yj.a.Ug]=G,ka[wg.a.SYa]=wa,ka[mc.key]=I,ka[Ii.a.dBa]=d,$a=this.insertAgave(ka,w));return $a};Cb.prototype.qNa=function(G,ka,d,w){w=void 0===w?null:w;if(G&&ka){G=new ij.a(G,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var I=new rj.a("ExcelOnline","Web",this.$.ya.UICultureTag),
ha=new Ig.a;ha.si[ue.pTc]=d;w&&(d=w,d.sourceLocationOverrideResourceId&&(ha.si[ue.sourceLocationOverrideResourceId]=d.sourceLocationOverrideResourceId),d.dl&&(ha.si[ue.dl]=d.dl),d.Nj&&(ha.si.IconCssClass=d.Nj),d.ZUd&&(ha.si.TaskPaneIconUrl=d.ZUd),d.AS&&(ha.si.TaskPaneIconId=d.AS));qj.a.instance.qNa(G,Pj.a.action,ka,I,ha)}};Cb.prototype.nVh=function(G){if(!Tj.a.oi(G)){var ka=G[uk.a.N8b];if(ka&&(ka=ka.getId(),G=G[uk.a.Tya],ka&&G))return this.SJa(ka,G.si[ue.sourceLocationOverrideResourceId])}return null};
Cb.prototype.SJa=function(G,ka){ka=void 0===ka?null:ka;return G&&ka?String.format("{0}.{1}",G,ka):G};Cb.prototype.MMh=function(G){switch(G){case 1172793074:case 1221897806:case 1930653487:return 2;case -515602470:case 2086613372:return Gf.EwaSettings.la(236)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}};Cb.d9h="Microsoft.Office.Excel.IdeasXLOPreload";Cb.pCd="IDS";Cb.e9e="FA000000012";Cb.kwa="FA000000005";Cb.l7h="HelloWorld";Cb.JWg="FA000000014";
Cb.C5e="Help.GiveFeedback.Url";Cb.GAh="feedback";Cb.Dlf="FA000000066";Cb.r0i="PowerBi.Url";Cb.p0i="PowerBi.DevUrl";Cb.q0i="FA000000054";Cb.uDi="FA000000064";Cb.EWi="FA000000075";Cb.l3i="FA000000080";Cb.pWc="AnalyzeDataTaskPane";Cb.C7i="RecommendedChartsTaskPane";Cb.JZi="PivotTableTaskPane";Cb.Och=350;Cb.E$e=320;Cb.m3i=320;Object(de.a)(Cb,"AgaveCommandManager",dk.a,[512,513]);Sk.Object.defineProperties(ob,{instance:{configurable:!0,enumerable:!0,get:function(){return ob.Oa}}});ob.Oa=new ob;Object(de.a)(ob,
"AppsDataManagerFactory",null,[]);Object(de.a)(function(G,ka){this.httpStatus=G;this.data=ka},"AppData",null,[]);Ta.prototype.$xb=function(G){this.elg(this.glg,G)};Ta.prototype.fX=function(G,ka,d,w){0===G?this.wb&&this.Tg&&ka?this.Tg.Xl(String.format("{0}AppsForOfficeProxy.ashx?lcid={1}&syslcid={1}&uilcid={1}&rt=xml&client={2}&cv=16.1.0.0",this.wb.appSettings.WebServiceBase,fg.AFrameworkApplication.lcid,ka),1,"",null,!0,2,d,w,null):Se.ULS.sendTraceTag(6070476,344,10,"The request objects are not available"):
(ka={},Se.ULS.sendTraceTag(6070477,344,15,"The request datatype is not supported.  {0}",(ka.dataType=G,ka)))};Object(de.a)(Ta,"AppsDataProvider",null,[426]);var gl=Vg.a;vm(Ka,gl);Ka.prototype.create=function(){var G=this,ka=this.$.da,d=gj.GetServiceTaskFactory.create(ka,106,this.ma,this.ub),w=gj.GetServiceTaskFactory.create(ka,104,this.ma,this.ub),I=ff.a.loadScript(36,0,this.ub,void 0,void 0,375);Bh.TaskExtensions.Ba(Bh.TaskExtensions.ve([w,d,I],this.ma),function(){var ha=new bc(cd.a.instance),wa=
new Ta(fg.AFrameworkApplication.ga,fg.AFrameworkApplication.Jd,"WAC_Excel");new Mb(ha,wa,"PreinstalledAppsData_Excel");ha=null;Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(ha=qi.a.instance.oc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);cb.instance.initialize(d.result);ha=new Cb(G.$,d.result,w.result,ha,fg.AFrameworkApplication.Gb);ka.Ha(206,ha);G.Fb(ka.Aa(374)||ka.Ha(374,ha))},this.ma,3);qi.a.instance.register(Og.a,
"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").Bc().Lc(function(){return new Og.a(G.$.Vv)})};Ka.ja=function(G){G.da.Ha(375,new Ka(G))};Object(de.a)(Ka,"AgaveCommandManagerFactory",Vg.a,[]);var L=b(860);ma.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};ma.prototype.invokePropertyGet=function(G){switch(G){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};ma.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ma.prototype.invokePropertySet=function(G,ka){switch(G){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");
return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ma.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ma.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ma.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,
ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ma.O6g=function(G){var ka=new ma;ka.displayName=G.displayName;ka.email=G.email;switch(G.authority){case ji.IFf:ka.identityType=1;break;default:ka.identityType=0}ka.federationProvider="";return ka};Sk.Object.defineProperties(ma.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.tfa},set:function(G){this.tfa=G}},email:{configurable:!0,enumerable:!0,get:function(){return this.Q5d},set:function(G){this.Q5d=
G}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.z6d},set:function(G){this.z6d=G}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.Qib},set:function(G){this.Qib=G}}});Object(de.a)(ma,"OfficeIdentityInfo",null,[]);hc.Mac=function(G){return G in hc.KMe?hc.KMe[G].toString():G};Sk.Object.defineProperties(hc,{KMe:{configurable:!0,enumerable:!0,get:function(){return hc.uog}}});hc.map=null;var oa={};hc.uog=(oa.GeneralException=L.a.generalException,oa.AccessDenied=
L.a.lTc,oa.ApiNotAvailable=L.a.apiNotAvailable,oa.UserNotSignedIn=L.a.userNotSignedIn,oa.UserAborted=L.a.userAborted,oa.UnsupportedUserIdentity=L.a.aRj,oa.InvalidResourceUrl=L.a.invalidResourceUrl,oa.InvalidGrant=L.a.invalidGrant,oa.AddinIsAlreadyRequestingToken=L.a.VHg,oa.ResourceNotAllowed=L.a.pij,oa.ClientError=L.a.clientError,oa.ServerError=L.a.serverError,oa);Object(de.a)(hc,"SingleSignOnErrorCodeMap",null,[]);jb.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};
jb.prototype.invokePropertyGet=function(G){switch(G){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};jb.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};jb.prototype.invokePropertySet=function(G,ka){switch(G){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 3:this.tokenIdenityType=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};jb.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};jb.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};jb.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};
Sk.Object.defineProperties(jb.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.kgb},set:function(G){this.kgb=G}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.Qib},set:function(G){this.Qib=G}}});Object(de.a)(jb,"SingleSignOnToken",null,[]);Ja.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};Ja.prototype.invokePropertyGet=function(G){switch(G){case 3:return this.authChallenge;case 7:return this.correlationId;
case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Ja.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Ja.prototype.invokePropertySet=function(G,ka){switch(G){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 7:this.correlationId=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};Ja.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Ja.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};Ja.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Sk.Object.defineProperties(Ja.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.a2d},
set:function(G){this.a2d=G}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.JD},set:function(G){this.JD=G}},policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.iVb},set:function(G){this.iVb=G}},scope:{configurable:!0,enumerable:!0,get:function(){return this.mge},set:function(G){this.mge=G}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.Ahe},set:function(G){this.Ahe=
G}}});Object(de.a)(Ja,"TokenParameters",null,[481]);db.prototype.getAccessToken=function(G){var ka=this,d=this.nhb.getOsfControl(this.fA),w=d.getManifest(),I=w.getMarketplaceID();this.KNa(G,I);return OfficeExtension.WacRuntime.Utility.createPromise(function(ha,wa){d.isFirstParty()&&ka.nhb._enableFirstPartySSO?ka.Pfi(w,G)?qi.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(G,I).then(function($a){ha($a)},function($a){wa($a)}):wa(L.a.lTc):wa(L.a.apiNotAvailable)}).then(function(ha){switch(ha.authority){case ji.IFf:var wa=
1;break;default:wa=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new jb(ha.accessToken,wa))},function(ha){ka.logErrorResponse(G,I,ha);return ha?OfficeExtension.WacRuntime.Utility.createPromise(function(wa,$a){$a(OfficeExtension.WacRuntime.Utility.createRichApiException(ha,hc.Mac(ha)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(wa,$a){$a(OfficeExtension.WacRuntime.Utility.createRichApiException(L.a.generalException,hc.Mac(L.a.generalException)))})})};db.prototype.getAuthContext=
function(){return null};db.prototype.getPrimaryIdentityInfo=function(){var G=this.nhb.getOsfControl(this.fA);G.getManifest();var ka=G.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(d,w){qi.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(ka).then(function(I){d(I)},function(I){w(I.toString())})}).then(function(d){d=ma.O6g(d);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(d)},function(d){return d?
OfficeExtension.WacRuntime.Utility.createPromise(function(w,I){I(OfficeExtension.WacRuntime.Utility.createRichApiException(d,hc.Mac(d)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(w,I){I(OfficeExtension.WacRuntime.Utility.createRichApiException(L.a.generalException,hc.Mac(L.a.generalException)))})})};db.prototype.getTypeName=function(){return"Microsoft.Authentication.AuthenticationService"};db.prototype.invokePropertyGet=function(G){switch(G){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};db.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};db.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};db.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};db.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};db.prototype.invokeMethodAsync=function(G,ka){switch(G){case 1:return this.iJh(ka);case 3:return this.xKh();case 2:return this.mWh()}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};db.prototype.iJh=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,Ja);return this.getAccessToken(G)};db.prototype.xKh=function(){return this.getAuthContext()};db.prototype.mWh=function(){return this.getPrimaryIdentityInfo()};db.prototype.Pfi=function(G,
ka){var d=!1,w=G.getWebApplicationAuthorizations();G=null;w=yl(w);for(var I=w.next();!I.done;I=w.next())if(I=I.value,I.getResource().toLowerCase()===ka.resource.toLowerCase()){G=I;d=!0;break}if(!d)return!1;ka=ka.scope.split(" ,+");ka=yl(ka);for(d=ka.next();!d.done;d=ka.next())if((d=d.value)&&d.length){w=!1;I=yl(G.getScopes());for(var ha=I.next();!ha.done;ha=I.next())d.toLowerCase()===ha.value.toLowerCase()&&(w=!0);if(!w)return!1}return!0};db.prototype.KNa=function(G,ka){G=this.Ptf(G.resource);var d=
{};Se.ULS.sendTraceTag(538572831,369,50,"{0}",(d.manifestId=ka,d.resource=G,d))};db.prototype.logErrorResponse=function(G,ka,d){G=this.Ptf(G.resource);var w={};Se.ULS.sendTraceTag(538572830,369,10,"{0}",(w.manifestId=ka,w.resource=G,w.error=d,w))};db.prototype.Ptf=function(G){return G.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};Sk.Object.defineProperties(db.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(de.a)(db,"AuthenticationService",
null,[]);Na.prototype.create=function(G,ka){return new db(G,ka)};Object(de.a)(Na,"AuthenticationServiceFactory",null,[]);var Wa=b(985),Rb=b(1117),xc=b(1078);Xa.generalException="generalException";Xa.invalidArgument="invalidArgument";Xa.notAllowed="notAllowed";Xa.apiNotAvailable="apiNotAvailable";Xa.unresolvedPendingRequest="unresolvedPendingRequest";Xa.timeout="timeout";Xa.adalTimeout="adalTimeout";Xa.userNotSignedIn="userNotSignedIn";Xa.userAborted="userAborted";Xa.silentSignInFailed="silentSignInFailed";
Xa.invalidResourceUrl="invalidResourceUrl";Xa.invalidGrant="invalidGrant";Xa.connectionLost="connectionLost";Xa.clientError="clientError";Xa.serverError="serverError";Object(de.a)(Xa,"WopiHostErrorCodes",null,[]);Object(de.a)(Ha,"OAuthCallerMetadata",null,[]);Pa.prototype.vzg=function(G,ka,d,w,I,ha){var wa=this;if(!this.Pxa)return w=new Rb.a,w.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(w);var $a=new Ha;$a.AddinName=I;$a.AddinTrustId=ha;var Tb=-1;ha=null;if(w&&
this.mff())ha=this.Pxa.$ag(wg.a.Ozc,G,w,Pa.x2e(I),$a);else{var Ic=Date.now();ha=this.Pxa.FS(wg.a.Ozc,G,$a).then(function(pc){Tb=Date.now()-Ic;var vd=(ka||d)&&"login_required"===pc.ErrorCode;return(ka&&("interaction_required"===pc.ErrorCode||"consent_required"===pc.ErrorCode||"invalid_grant"===pc.ErrorCode)||vd)&&wa.mff()?wa.Pxa.$ag(wg.a.Ozc,G,null,Pa.x2e(I),$a):Promise.resolve(pc)})}return ha.then(function(pc){var vd=new Rb.a;pc.IsSuccess?(vd.token=pc.Token,pc.Telemetry&&(vd.iTa=pc.Telemetry.fromCache,
vd.expiresOn=pc.Telemetry.expiresOn)):(vd.errorCode=wa.bzi(pc),vd.hVd=wa.UXi(pc));return vd}).catch(function(){var pc=new Rb.a;pc.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(pc)}).then(function(pc){pc.rha="OauthManager";0<=Tb&&(pc.Yvb=Tb);return pc})};Pa.prototype.eii=function(G){var ka=(fg.AFrameworkApplication.ga.Ua(fg.AFrameworkApplication.Aea)||"").toLowerCase();return(kj.a.ala||"teams"===ka&&bi.a.hxb)&&!Pa.Jhi(G)||!this.Pxa||!this.Pxa.TLa()?!1:!0};Pa.prototype.mff=
function(){return this.kog||1!==xc.a.S$b()};Pa.prototype.bzi=function(G){switch(G.ErrorCode){case "UserCancelled":case "interaction_required":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":G=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:G=G.ErrorCode===Xa.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:G.ErrorCode===Xa.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:G.ErrorCode===Xa.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:G.ErrorCode===Xa.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:G.ErrorCode===Xa.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return G};Pa.prototype.UXi=function(G){var ka="";(G=RegExp("AADSTS(\\d+)").exec(G.ErrorMessage))&&1<G.length&&(ka=G[1]);return ka};Pa.x2e=function(G){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,G)};Pa.Jhi=function(G){if(!G)return!1;G=G.toLowerCase();for(var ka=
yl(Wa.AppsForOfficeSingleSignOnManager.KUe),d=ka.next();!d.done;d=ka.next())if(d.value===G)return!0;return!1};Object(de.a)(Pa,"AppsforOfficeTokenFromOauthManager",null,[539]);pa.woa=function(){if(fg.AFrameworkApplication.ga.ra("AppForOfficeSSOV2IsEnabled")){var G=null;try{G=qi.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(ka){Se.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+ka)}G=new Pa(G);pa.Oa=new pa(G)}};pa.getInstance=function(){pa.u8d||(pa.woa(),pa.u8d=!0);
return pa.Oa};pa.Oa=null;pa.u8d=!1;Object(de.a)(pa,"AppsForOfficeOauthManagerFactory",null,[519]);var id=b(128);Object(de.a)(qa,"NewDocumentParameters",null,[]);var rd=b(157);ja.prototype.createAndOpenWorkbook=function(G){var ka=this;if(G&&G.length>this.zsg)throw Se.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",G.length),OfficeExtension.WacRuntime.Utility.createRichApiException(L.a.invalidArgument,rd.a.fa(1719));var d=new qa("blank","agave",G?"streamBase64":"streamEmpty",G),w=
null;return OfficeExtension.WacRuntime.Utility.createPromise(function(I,ha){var wa=new id.StandardDialog;wa.jc=4;wa.Jk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function($a){2===$a||0===$a?ha("Cancelled"):(w=window.open(""),ka.Xsg.create(I,ha,d).E0a())})}).then(function(I){if(!I)throw OfficeExtension.WacRuntime.Utility.createRichApiException(L.a.generalException,rd.a.fa(1715));try{w.top.location.href=I}catch(ha){Se.ULS.sendTraceTag(538572820,0,10,
"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",kj.a.ep,ha),Se.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),w.location.replace(I)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(I){if("Cancelled"===I)throw OfficeExtension.WacRuntime.Utility.createRichApiException(L.a.sCd,rd.a.fa(1718));w.close();ka.AKj();return null})};
ja.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};ja.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ja.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ja.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ja.prototype.invokePropertySetAsync=function(G,
ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};ja.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};ja.prototype.invokeMethodAsync=function(G,ka){switch(G){case 1:return this.B4g(ka)}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};ja.prototype.B4g=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return this.createAndOpenWorkbook(G)};
ja.prototype.AKj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(L.a.generalException,rd.a.fa(1715));};Object(de.a)(ja,"WacWorkbook",null,[]);var $d=b(859),Be=b(869);Sk.Object.defineProperties(fa.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(de.a)(fa,"RichApiPreviewExecutionContext",null,[]);var gg=b(24),Wg=b(1012),Dh=b(200),ei=b(202),wj=b(112),Bj=b(11),Xj=ei.a;vm(da,Xj);da.prototype.start=function(G,ka){var d="<div class='"+wj.a.ioh+
" "+Xe.a.Tk+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+wj.a.xC+"' /></div>";d=String.format(d,Xc.a.Lf(this.Q5c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Ob.innerHTML=d;this.Nob=Bj.DOMElementExtensions.getElementById(this.Ob,"bindingText");G=ka?G.E2a(ka,this.Q5c.DdaBindingsMethod.BindingId):null;(null===G||void 0===G?0:G.IsValidRef)?(ka=new gg.Range(G.Reference.FirstRow+1,G.Reference.FirstColumn+1,G.Reference.LastRow+1,G.Reference.LastColumn+
1,!1,!1),this.Nob.value=G.Reference.SheetName+"!"+ka):(G=dj.g(this.$).ha,this.Nob.value=nj.f(this.$.pa)||!G.va.qh?"":G.uia);this.initialize();this.mf()};da.prototype.mm=function(){this.t0c();this.addButton(0);this.addButton(1);Xj.prototype.mm.call(this)};da.prototype.setFocus=function(){Bj.DOMElementExtensions.setFocus(this.Nob)};da.prototype.validate=function(){return!0};da.prototype.commit=function(){var G=this.Nob.value.trim(),ka=G.indexOf("!");-1!==ka&&(G=this.dZh(G.substring(0,ka))+G.substr(ka));
this.GGe.addBinding(this.Q5c,G,0,this.callback);return!0};da.prototype.JGa=function(){this.GGe.NQ.yf($d.a.internalError,this.callback);Xj.prototype.JGa.call(this)};da.prototype.dZh=function(G){G=Gj.a.trimStart(G.trim(),"=");return G.length?G.startsWith("'")&&G.endsWith("'")?G:uh.HelperMethods.U7b(G):""};Sk.Object.defineProperties(da.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object(de.a)(da,"DdaBindingPrompt",ei.a,[]);K.prototype.yf=function(G,ka){if(ka){var d=
{};d.Error=G;d.Version=this.ea.uf;ka(d)}};K.prototype.RJa=function(G,ka){this.yf(G,ka)};K.prototype.nH=function(G,ka){this.yf($d.a.iWe(G.Errors[0].MessageId),ka)};K.prototype.Ou=function(G){G&&G(this.tQ())};K.prototype.tQ=function(){var G={Error:0};G.Version=this.ea.uf;return G};Object(de.a)(K,"DdaErrorGenerator",null,[]);var Fi=b(303),oj=b(105);S.prototype.pxd=function(G,ka){function d($a){var Tb=w.$.xa.getItemByName($a.SheetName);(null===Tb||void 0===Tb?0:Tb.visible)?(dj.g(w.$).Vg($a,null,null,
null,3,oj.a.Tbh,void 0,void 0,void 0,void 0,!0),w.NQ.Ou(ka)):w.NQ.yf($d.a.mVg,ka)}var w=this,I=G.DdaGoToByIdMethod.GoToType,ha=G.DdaGoToByIdMethod.SelectionMode,wa=G.DdaGoToByIdMethod.Id.toString().trim();0===I?this.kDi(wa,ha,G.DdaMethod.ControlId,d,ka):1===I?this.oDi(wa,ha,d,ka):this.NQ.yf($d.a.YQj,ka)};S.prototype.kDi=function(G,ka,d,w,I){var ha=this;this.Rz.ddaGetBinding(d,G,function(wa){if(!Fi.a(wa)&&wa.Result&&wa.Result.Reference){wa=wa.Result;var $a={};$a.SheetName=wa.Reference.SheetName;$a.FirstRow=
wa.Reference.FirstRow;$a.FirstColumn=wa.Reference.FirstColumn;$a.LastRow=wa.Reference.LastRow;$a.LastColumn=wa.Reference.LastColumn;S.cWc($a,ka);1!==wa.BindingType?w($a):ha.Rz.ddaGetBindingData(d,G,1,0,2,0,0,-1,-1,function(Tb){Fi.a(Tb)||!Tb.Result?ha.NQ.nH(Tb,I):(Tb=Tb.Result,2!==ka&&($a.FirstRow-=Tb.Headers.length,0>$a.FirstRow&&($a.FirstRow=0)),w($a))},I)}else ha.NQ.RJa($d.a.c6f,I)},I)};S.prototype.oDi=function(G,ka,d,w){var I=this,ha=ni.z(G);ha?(ha=ni.v(ha,this.$),S.cWc(ha,ka),d(ha)):this.$.ea.isNamedObjectViewMode&&
this.$.zb.zj(G)?this.$.zb.pa=this.$.zb.getItemByName(G):(ha=function(wa){Fi.a(wa)||!wa.Result?I.$.xa.contains(G)?(wa={},wa.SheetName=G,wa.FirstRow=0,wa.FirstColumn=0,wa.LastRow=0,wa.LastColumn=0,d(wa)):I.NQ.RJa($d.a.c6f,w):(wa=wa.Result,S.cWc(wa,ka),d(wa))},this.$.xa.pa?this.Rz.parseRangeForGoto(G,this.$.xa.pa.name,ha,w):this.Rz.parseRange(G,ha,w))};S.cWc=function(G,ka){G.LastRow=2===ka?G.FirstRow:G.LastRow;G.LastColumn=2===ka?G.FirstColumn:G.LastColumn};Object(de.a)(S,"DdaNavigator",null,[]);var bk=
b(287),vk;(function(G){G[G.unsupported=0]="unsupported";G[G.surface=1]="surface";G[G.combo=2]="combo";G[G.column=3]="column";G[G.column3D=4]="column3D";G[G.bar=5]="bar";G[G.bar3D=6]="bar3D";G[G.line=7]="line";G[G.line3D=8]="line3D";G[G.pie=9]="pie";G[G.pie3D=10]="pie3D";G[G.scatter=11]="scatter";G[G.bubble=12]="bubble";G[G.area=13]="area";G[G.area3D=14]="area3D";G[G.doughnut=15]="doughnut";G[G.radar=16]="radar";G[G.stock=17]="stock";G[G.waterfall=18]="waterfall";G[G.funnel=19]="funnel";G[G.treemap=
20]="treemap";G[G.sunburst=21]="sunburst";G[G.boxWhisker=22]="boxWhisker";G[G.histogram=23]="histogram";G[G.pareto=24]="pareto";G[G.regionMap=25]="regionMap";G[G.noVisibleSeries=26]="noVisibleSeries";G[G.complexDataSource=27]="complexDataSource";G[G.pivotChart=28]="pivotChart"})(vk||(vk={}));Object(de.b)("ChartCategory",vk);Object(de.a)(T,"MacroRecorderEventData",null,[]);ba.prototype.CXh=function(G){var ka;if(void 0===G||null===G||void 0===G.RequestBody||null===G.RequestBody)return null;var d=JSON.parse(G.RequestBody);
if(void 0!==G.ActiveChartId&&null!==G.ActiveChartId){d.ActiveChartId=G.ActiveChartId;var w=dj.g(this.$).ha.Pa.lc;if(null===(ka=null===w||void 0===w?void 0:w.floatingObject)||void 0===ka?0:ka.Xc)d.ActiveChartType=vk[w.floatingObject.Xc.ChartCategory]}void 0!==G.SheetMultiRange&&null!==G.SheetMultiRange&&(d.SheetName=G.SheetMultiRange.SheetName);return d};ba.prototype.LXh=function(G){if(void 0===G||null===G||void 0===G.Result||null===G.Result)return null;G=G.Result;return void 0===G.ResponseBody||null===
G.ResponseBody||G.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(G.ResponseBody.join(""))};ba.prototype.nmi=function(G){return!!G&&!(void 0===G.eventId||null===G.eventId)&&0<G.eventId.length};ba.prototype.Zl=function(G){var ka=this;return function(){if(ka.$.wba){var d=ka.tRg(ka.request);if(ka.nmi(d)){var w=ka.CXh(ka.request),I=ka.LXh(G);if(w&&!Tj.a.isEmpty(w)&&I&&!Tj.a.isEmpty(I))return Se.ULS.sendTraceTag(537163164,0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),
new Oe(d,w,I);d=String.format("requestInfo: {0}; responseInfo: {1}",w?"(not null)":"(null)",I?"(not null)":"(null)");Se.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",d)}}return new Oe(null,null,null)}};ba.prototype.tRg=function(G){var ka=this.omi(G.SolutionId),d=ba.jXh(G);if(d&&ka)return ka={},Se.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(ka.recorderEventId=d,ka["request.SolutionId"]=G.SolutionId,ka)),new T(G.SolutionId,d);var w=
{};Se.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(w.recorderEventId=d,w.isRecorderAwareAddin=ka,w["request.SolutionId"]=G.SolutionId,w));return null};ba.prototype.omi=function(G){if(!G)return!1;G=G.toLowerCase();return ba.U1h().contains(G)};ba.U1h=function(){ba.Cza||(ba.Cza=new Jj.a(Oh.a.Hk()),ba.Cza.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),ba.Cza.add("fa000000005"),ba.Cza.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),ba.Cza.add("fa000000014"),ba.Cza.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));
return ba.Cza};ba.jXh=function(G){var ka=null,d=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(d.test(G.RequestBody))ka=d.exec(G.RequestBody)[1];else{G=G.RequestHeaders;if(!G)return ka;d=hj.a.nGi.toLowerCase();for(var w=0;w<G.length;w++)if(G[w].Name.toLowerCase()===d){ka=G[w].Value;break}}return ka};ba.Cza=null;Object(de.a)(ba,"DdaRichApiRequestRecorder",null,[]);var Qk=b(63),Lk=bk.a;vm(la,Lk);la.prototype.V2=function(G){return Lk.prototype.V2.call(this,G)||this.iUg(G)};
la.prototype.Zl=function(){return this.WLd.Zl(this.ud)};la.prototype.ieb=function(){var G={OperationType:3};G.RichApiRequest=this.request;return G};la.prototype.iUg=function(G){var ka=this;return function(d,w,I){return H(G,ka.request,ri.b(d,ka.Slb),ri.a(w,ka.gib),I,ka.G3)}};Sk.Object.defineProperties(la.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Gf.EwaSettings.sc()?Object(Qk.a)(la.prototype,this,"operationWorkingState"):2}},gCc:{configurable:!0,enumerable:!0,
get:function(){return this.eFa}},Cr:{configurable:!0,enumerable:!0,get:function(){return this.Slb}},l4:{configurable:!0,enumerable:!0,get:function(){return this.gib}}});Object(de.a)(la,"DdaRichApiRequestBatchOperation",bk.a,[]);var il=mk.a;vm(Q,il);Q.prototype.Zl=function(){return this.WLd.Zl(this.ud)};Sk.Object.defineProperties(Q.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Gf.EwaSettings.sc()?Object(Qk.a)(Q.prototype,this,"operationWorkingState"):0}}});Object(de.a)(Q,
"DdaRichApiRequestOperation",mk.a,[]);U.prototype.ddaAddBinding=function(G,ka,d,w,I,ha,wa){var $a=this;this.TJ(function(Tb,Ic,pc){var vd=$a.$.na.ta,ne=$a.Aja();Tb=ri.b(Tb,ha);Ic=ri.a(Ic,$a.lI);var Pe=vd.Na(9);Pe.controlId=G;Pe.bindingId=ka;Pe.bindingType=d;Pe.currentSheetName=ne;Pe.formula=w;Pe.options=I;return Ci.i(vd,"DdaAddBinding",Pe,Tb,Ic,pc,wa,0)},wa,563)};U.prototype.ddaReleaseBinding=function(G,ka,d,w){var I=this;this.TJ(function(ha,wa,$a){var Tb=I.$.na.ta;ha=ri.b(ha,d);wa=ri.a(wa,I.lI);var Ic=
Tb.Na(9);Ic.controlId=G;Ic.bindingId=ka;return Ci.i(Tb,"DdaReleaseBinding",Ic,ha,wa,$a,w,0)},w,564)};U.prototype.ddaGetBinding=function(G,ka,d,w){var I=this;this.TJ(function(ha,wa,$a){var Tb=I.$.na.ta;ha=ri.b(ha,d);wa=ri.a(wa,I.lI);var Ic=Tb.Na(1);Ic.controlId=G;Ic.bindingId=ka;return Ci.i(Tb,"DdaGetBinding",Ic,ha,wa,$a,w,0)},w,565,16)};U.prototype.ddaGetAllBindings=function(G,ka,d){var w=this;this.TJ(function(I,ha,wa){var $a=w.$.na.ta;I=ri.b(I,ka);ha=ri.a(ha,w.lI);var Tb=$a.Na(1);Tb.controlId=G;
return Ci.i($a,"DdaGetAllBindings",Tb,I,ha,wa,d,0)},d,566,16)};U.prototype.ddaGetBindingData=function(G,ka,d,w,I,ha,wa,$a,Tb,Ic,pc){var vd=this;this.TJ(function(ne,Pe,Af){var Wf=vd.$.na.ta,Of=vd.Aja();ne=ri.b(ne,Ic);Pe=ri.a(Pe,vd.lI);var xg=Wf.Na(1);xg.controlId=G;xg.bindingId=ka;xg.coerceType=d;xg.valueFormat=w;xg.filterType=I;xg.startRow=ha;xg.startCol=wa;xg.rowCount=$a;xg.colCount=Tb;xg.currentSheetName=Of;return Ci.i(Wf,"DdaGetBindingData",xg,ne,Pe,Af,pc,0)},pc,567,16)};U.prototype.ddaSetBindingData=
function(G,ka,d,w,I,ha,wa){var $a=this;this.TJ(function(Tb,Ic,pc){var vd=$a.$.na.ta,ne=$a.Aja();Tb=ri.b(Tb,ha);Ic=ri.a(Ic,$a.lI);var Pe=vd.Na(9);Pe.controlId=G;Pe.bindingId=ka;Pe.startRow=d;Pe.startCol=w;Pe.currentSheetName=ne;Pe.bindingData=I;return Ci.i(vd,"DdaSetBindingData",Pe,Tb,Ic,pc,wa,0)},wa,568)};U.prototype.ddaGetSelectedData=function(G,ka,d,w,I,ha,wa){var $a=this;this.TJ(function(Tb,Ic,pc){var vd=$a.$.na.ta,ne=$a.Aja();Tb=ri.b(Tb,ha);Ic=ri.a(Ic,$a.lI);var Pe=vd.Na(1);Pe.controlId=G;Pe.coerceType=
ka;Pe.valueFormat=d;Pe.filterType=w;Pe.currentSheetName=ne;Pe.formula=I;return Ci.i(vd,"DdaGetSelectedData",Pe,Tb,Ic,pc,wa,0)},wa,569,16)};U.prototype.ddaSetSelectedData=function(G,ka,d,w,I){var ha=this;this.TJ(function(wa,$a,Tb){var Ic=ha.$.na.ta,pc=ha.Aja();wa=ri.b(wa,w);$a=ri.a($a,ha.lI);var vd=Ic.Na(9);vd.controlId=G;vd.currentSheetName=pc;vd.formula=ka;vd.bindingData=d;return Ci.i(Ic,"DdaSetSelectedData",vd,wa,$a,Tb,I,0)},I,570)};U.prototype.ddaLoadSettings=function(G,ka,d){var w=this;this.TJ(function(I,
ha,wa){var $a=w.$.na.ta;I=ri.b(I,ka);ha=ri.a(ha,w.lI);var Tb=$a.Na(1);Tb.controlId=G;return Ci.i($a,"DdaLoadSettings",Tb,I,ha,wa,d,0)},d,501,16)};U.prototype.ddaSaveSettings=function(G,ka,d,w,I){var ha=this;this.TJ(function(wa,$a,Tb){var Ic=ha.$.na.ta;wa=ri.b(wa,w);$a=ri.a($a,ha.lI);var pc=Ic.Na(9);pc.controlId=G;pc.settings=ka;pc.overwriteIfStale=d;return Ci.i(Ic,"DdaSaveSettings",pc,wa,$a,Tb,I,0)},I,571)};U.prototype.ddaAddRowsColumns=function(G,ka,d,w,I,ha){var wa=this;this.TJ(function($a,Tb,Ic){var pc=
wa.$.na.ta,vd=wa.Aja();$a=ri.b($a,I);Tb=ri.a(Tb,wa.lI);var ne=pc.Na(9);ne.controlId=G;ne.bindingId=ka;ne.isRow=d;ne.currentSheetName=vd;ne.bindingData=w;return Ci.i(pc,"DdaAddRowsColumns",ne,$a,Tb,Ic,ha,0)},ha,572)};U.prototype.ddaDeleteAllDataValues=function(G,ka,d,w){var I=this;this.TJ(function(ha,wa,$a){var Tb=I.$.na.ta,Ic=I.Aja();ha=ri.b(ha,d);wa=ri.a(wa,I.lI);var pc=Tb.Na(9);pc.controlId=G;pc.bindingId=ka;pc.currentSheetName=Ic;return Ci.i(Tb,"DdaDeleteAllDataValues",pc,ha,wa,$a,w,0)},w,573)};
U.prototype.ddaClearBindingFormats=function(G,ka,d,w){var I=this;this.TJ(function(ha,wa,$a){var Tb=I.$.na.ta,Ic=I.Aja();ha=ri.b(ha,d);wa=ri.a(wa,I.lI);var pc=Tb.Na(9);pc.controlId=G;pc.bindingId=ka;pc.currentSheetName=Ic;return Ci.i(Tb,"DdaClearBindingFormats",pc,ha,wa,$a,w,0)},w,574)};U.prototype.ddaSetBindingFormats=function(G,ka,d,w,I,ha){var wa=this;this.TJ(function($a,Tb,Ic){var pc=wa.$.na.ta,vd=wa.Aja();$a=ri.b($a,I);Tb=ri.a(Tb,wa.lI);var ne=pc.Na(9);ne.controlId=G;ne.bindingId=ka;ne.currentSheetName=
vd;ne.bindingData=d;ne.isSetFormats=w;return Ci.i(pc,"DdaSetBindingFormats",ne,$a,Tb,Ic,ha,0)},ha,575)};U.prototype.parseRange=function(G,ka,d){var w=this;this.TJ(function(I,ha,wa){var $a=w.$.na.ta.Zb();return Ci.Q(w.$.na.ta,G,-1,ri.b(I,ka),ri.a(ha,w.lI),wa,d,$a)},d,162,16)};U.prototype.parseRangeForGoto=function(G,ka,d,w){var I=this;this.TJ(function(ha,wa,$a){var Tb=I.$.na.ta.Zb();return Ci.R(I.$.na.ta,G,ka,ri.b(ha,d),ri.a(wa,I.lI),$a,w,Tb)},w,562,16)};U.prototype.executeRichApiRequest=function(G,
ka,d){var w=this;Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(G.RequestFlags&=8191);if(Gf.EwaSettings.la(260))this.uzh(this.$.na.ta.Zb(),ka,function(){w.NQ.RJa($d.a.internalError,d)},d,G);else{var I=mi.DdaFacade.dgd(G);!Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Ab.TC||I&16?(Gf.EwaSettings.sc()&&(I|=64),this.$.userOperationManager.Nt(new Q(this.$,G,function(ha,wa,$a){return H(w.$.na.ta,G,ri.b(ha,
ka),ri.a(wa,w.lI),$a,d)},I))):(this.NQ.RJa($d.a.cDc,d),Se.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};U.prototype.Aja=function(){return this.$.ea.isNamedObjectViewMode?this.$.pa.sheetName:this.$.activeItemName};U.prototype.TJ=function(G,ka,d,w){w=void 0===w?0:w;!Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Ab.TC||w&16?Gf.EwaSettings.sc()?this.$.userOperationManager.Nt(new mk.a(d,0,G,w|64)):this.$.userOperationManager.Nt(new lk.a(d,
0,G,w)):(this.NQ.RJa($d.a.cDc,ka),Se.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};U.prototype.uzh=function(G,ka,d,w,I){var ha=mi.DdaFacade.dgd(I);if(!Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Ab.TC||ha&16){var wa=this.$.Vb.Hc("UserAction","Rich Api request");Gf.EwaSettings.sc()&&(ha|=64);this.$.userOperationManager.hc(new la(this.$,G,ka,d,w,wa,I,ha),null)}else this.NQ.RJa($d.a.cDc,w),Se.ULS.sendTraceTag(537163158,
0,50,"Write operation is not allowed")};Object(de.a)(U,"DdaWebServiceHelper",null,[]);Object(de.a)(V,"DocumentFile",null,[]);D.generalException="GeneralException";D.KJg="ApiNotFound";D.sCd="OperationCancelled";D.invalidArgument="InvalidArgument";Object(de.a)(D,"ErrorCodes",null,[]);v.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};v.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};v.prototype.checkShortcutsInUse=
function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object(de.a)(v,"WacApiDelegates",null,[]);var jl=b(661);vm(J,v);J.prototype.replaceShortcuts=function(G){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,G,this.Whf)};J.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};J.prototype.checkShortcutsInUse=function(G){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(G,this.Whf)};
J.v7g=function(G,ka){var d=document.createEvent("KeyboardEvent");if(kj.a.sF)d.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(G&8),!!(G&32),!!(G&4),!!(G&256));else{var w=[];G&4&&w.push("Shift");G&8&&w.push("Control");G&32&&w.push("Alt");d.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,w,!1,"en-US")}G=new Sys.UI.DomEvent(d);G.keyCode=ka;return G};J.c3g=function(G,ka){if(kj.a.Df)switch(ka){case 189:ka=173;break;case 187:ka=61;break;case 186:ka=59}return J.v7g(G,ka)};Object(de.a)(J,"ExcelWacApiDelegates",
v,[]);r.prototype.aBg=function(G,ka){this.edc(G)||(this.zIa[G]={});if(this.Ihi(G))return Se.ULS.sendTraceTag(537163157,344,50,"App {0} has reach the limit of number of cached files.",G),$d.a.sAi;this.zIa[G][ka.iBh.toString()]=ka;return $d.a.success};r.prototype.YOh=function(G,ka){var d=null;this.edc(G)&&(d=this.zIa[G][ka.toString()]);d||Se.ULS.sendTraceTag(537163156,344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",G,ka);return d};r.prototype.edc=function(G){return G in this.zIa};
r.prototype.Q$i=function(G,ka){if(this.edc(G)){var d=this.zIa[G];delete d[ka.toString()];1>Object.keys(d).length&&delete this.zIa[G];return ka.toString()in d?$d.a.internalError:$d.a.success}return $d.a.internalError};r.prototype.Ihi=function(G){return this.edc(G)?Object.keys(this.zIa[G]).length>=this.Ozi:!1};r.getInstance=function(G){return G.da.Aa(200)||G.da.Ha(200,new r(r.Pzi))};r.WDi=function(){return++r.xTg};r.uzi=4194304;r.Pzi=1;r.xTg=0;Object(de.a)(r,"GetFileApiHelper",null,[]);C.prototype.notifyActionHandlerReady=
function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.fA)};C.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};C.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};C.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};C.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};C.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};C.prototype.invokeMethod=function(G){switch(G){case 1:return this.FEi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};C.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};C.prototype.FEi=function(){this.notifyActionHandlerReady();return null};
Object(de.a)(C,"AddinInternalService",null,[]);u.prototype.getAppRuntimeState=function(){return this.gJ.getAppRuntimeState(this.fA)?2:1};u.prototype.setAppRuntimeState=function(G){switch(G){case 2:G=!0;break;case 1:G=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(L.a.invalidArgument,rd.a.fa(1719));}this.gJ.setAppRuntimeState(this.fA,G)};u.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};u.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};u.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};u.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};u.prototype.invokeMethod=function(G,ka){switch(G){case 2:return this.mKh();case 1:return this.Rpj(ka)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};u.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};u.prototype.mKh=function(){return this.getAppRuntimeState()};u.prototype.Rpj=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"int");this.setAppRuntimeState(G);return null};Object(de.a)(u,"AppRuntimeService",null,[]);var Rk=b(1118);z.prototype.disable=function(){try{if(!rd.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.ADe();
if(!this.yhf())return this.BDe();this.E1.eQj(this.Is)}catch(G){return Se.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",G.message||"Unknown"),this.yDe()}return null};z.prototype.enable=function(){try{if(!rd.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.ADe();if(!this.yhf())return this.BDe();this.E1.S8i(this.Is)}catch(G){return Se.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",
G.message||"Unknown"),this.yDe()}return null};z.prototype._OnAccess=function(){};z.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};z.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};z.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};z.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};z.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};z.prototype.invokeMethod=function(G){switch(G){case 1:return this.mCa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};z.prototype.invokeMethodAsync=function(G,ka){switch(G){case 3:return this.yfh();case 2:return this.Skh()}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};z.prototype.yfh=
function(){return this.disable()};z.prototype.Skh=function(){return this.enable()};z.prototype.mCa=function(){this._OnAccess();return null};z.prototype.ADe=function(){return Rk.a(L.a.notImplemented,rd.a.fa(1720))};z.prototype.BDe=function(){return Rk.a(L.a.sharedRuntimeNotAvailable,rd.a.fa(1724))};z.prototype.yDe=function(){return Rk.a(L.a.generalException,rd.a.fa(1715))};z.prototype.yhf=function(){var G=this.By.getSharedRuntimeId();return!!G&&0<G.length};Object(de.a)(z,"BeforeDocumentCloseNotification",
null,[]);B.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};B.prototype.invokePropertyGet=function(G){switch(G){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};B.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};B.prototype.invokePropertySet=function(G,
ka){switch(G){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"boolean");return;case 3:this.nativeRuntime=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(ka,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};B.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
B.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};B.prototype.invokeMethodAsync=function(G,ka){G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};Sk.Object.defineProperties(B.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.$z},set:function(G){this.$z=G}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.Zbe},set:function(G){this.Zbe=G}},streamingEnabled:{configurable:!0,
enumerable:!0,get:function(){return this.Zhe},set:function(G){this.Zhe=G}}});Object(de.a)(B,"CustomFunctionEngineStatus",null,[]);t.prototype.register=function(G){return OfficeExtension.WacRuntime.Utility.createPromise(this.Kug(G))};t.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};t.prototype.invokePropertyGet=function(G){switch(G){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};t.prototype.invokePropertyGetAsync=
function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};t.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};t.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};t.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};t.prototype.invokeMethodAsync=
function(G,ka){switch(G){case 1:return this.K9i(ka)}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};t.prototype.K9i=function(G){var ka=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"string");return this.register(ka,G)};Sk.Object.defineProperties(t.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var G=new B;G.enabled=this.Pqg;G.streamingEnabled=this.Qqg;
G.nativeRuntime=!1;return G}}});Object(de.a)(t,"CustomFunctionManager",null,[]);var ol=b(1074);y.prototype._RegisterStateChange=function(){var G=this;this.PRb||this.nP.execute(function(ka){G.Q2d=ka.Fza(G._id,function(d){G.gJ.qDh(G.fA,G._id,JSON.stringify(d))})});this.PRb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};y.prototype._UnregisterStateChange=function(){var G=this;this.PRb--;this.PRb||this.nP.execute(function(ka){ka.AId(G._id,G.Q2d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
y.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};y.prototype.invokePropertyGet=function(G){switch(G){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};y.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};y.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};y.prototype.invokePropertySetAsync=
function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};y.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};y.prototype.invokeMethodAsync=function(G,ka){switch(G){case 6:return this.ukg();case 7:return this.wkg()}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};y.prototype.ukg=function(){return this._RegisterStateChange()};y.prototype.wkg=
function(){return this._UnregisterStateChange()};Sk.Object.defineProperties(y.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(de.a)(y,"LicenseFeature",null,[]);x.prototype.getFeatureTier=function(G,ka){var d=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(w){var I=1===ka?1:2===ka?2:0;d.nP.execute(function(ha){ha.getFeatureTier(G,I).then(function(wa){w(d.iTh(wa))},function(){w(ka)})})})};x.prototype.getLicenseFeature=function(G){G=new y(this.nP,
G,this.fA,this.gJ);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};x.prototype.isFeatureEnabled=function(G,ka){var d=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(w){d.nP.execute(function(I){I.isFeatureEnabled(G,ka).then(function(ha){w(ha)},function(){w(ka)})})})};x.prototype.isFreemiumUpsellEnabled=function(){var G=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ka){G.nP.execute(function(d){d=d.isFreemiumUpsellEnabled();ka(d)})})};
x.prototype.launchUpsellExperience=function(G){var ka=this;if(this.ztg.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){ka.nP.execute(function(d){d.launchUpsellExperience(G)})});throw OfficeExtension.WacRuntime.Utility.createRichApiException(L.a.lTc,"");};x.prototype._TestFireStateChangedEvent=function(){};x.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};x.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};x.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};x.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};x.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};x.prototype.invokeMethod=function(G,ka){switch(G){case 6:return this.vkg(ka)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};x.prototype.invokeMethodAsync=function(G,ka){switch(G){case 2:return this.TPh(ka);case 5:return this.hTh(ka);case 1:return this.wii(ka);case 3:return this.bji();case 4:return this.ksi(ka)}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};x.prototype.TPh=function(G){var ka=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"int");return this.getFeatureTier(ka,G)};x.prototype.hTh=
function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");return this.getLicenseFeature(G)};x.prototype.wii=function(G){var ka=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,1,"boolean");return this.isFeatureEnabled(ka,G)};x.prototype.bji=function(){return this.isFreemiumUpsellEnabled()};x.prototype.ksi=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");
return this.launchUpsellExperience(G)};x.prototype.vkg=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"string");this._TestFireStateChangedEvent(G);return null};x.prototype.iTh=function(G){switch(G){case 1:return 1;case 2:return 2;default:return 0}};Object(de.a)(x,"License",null,[]);var kl=b(147);m.prototype.areShortcutsInUse=function(G){var ka=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(d,w){ka.Fvd.checkShortcutsInUse(G).then(function(I){d(I)}).catch(function(I){w(I)})})};
m.prototype.getShortcuts=function(){var G=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(ka,d){G.Fvd.getShortcuts().then(function(w){ka(w)}).catch(function(w){d(w)})})};m.prototype.replaceShortcuts=function(G){var ka=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(d,w){ka.Fvd.replaceShortcuts(G).then(function(){d(null)}).catch(function(I){w(I)})})};m.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};m.prototype.invokePropertyGet=
function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};m.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};m.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};m.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};m.prototype.invokeMethod=
function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};m.prototype.invokeMethodAsync=function(G,ka){switch(G){case 3:return this.sLg(ka);case 1:return this.hZh();case 2:return this.ufj(ka)}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};m.prototype.sLg=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"Array<string>");return this.areShortcutsInUse(G)};m.prototype.hZh=function(){return this.getShortcuts()};
m.prototype.ufj=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,0,"any");return this.replaceShortcuts(G)};Object(de.a)(m,"ActionService",null,[]);var pl=b(525);n.prototype.WYh=function(){this.vga||(this.vga=pl.a.Tq(qi.a.instance.oc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.vga};n.prototype.getSharedFilePickerResponse=function(G){var ka=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(d,w){try{var I=ka.WYh();Wj.Task.WAA.call(null,
I).continueWith(function(){var ha=I.result;if(ha){var wa={};(function(){var $a=Rh.d(G);wa=$a.Ju;return $a})().returnValue?ha.Jed(wa).then(function($a){$a&&0<$a.length?d($a):w(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker returned null or an empty array."))}).catch(function($a){w($a)}):w(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else w(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker is resolved as null."))})}catch(ha){w(ha)}})};n.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};n.prototype.invokePropertyGet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};n.prototype.invokePropertyGetAsync=function(G){G=this.invokePropertyGet(G);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};n.prototype.invokePropertySet=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);
};n.prototype.invokePropertySetAsync=function(G,ka){this.invokePropertySet(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=function(G){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(G);};n.prototype.invokeMethodAsync=function(G,ka){switch(G){case 1:return this.VYh(ka)}G=this.invokeMethod(G,ka);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(G)};n.prototype.VYh=function(G){G=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(G,
0,"string");return this.getSharedFilePickerResponse(G)};Object(de.a)(n,"SharedFilePicker",null,[]);l.prototype.createInstance=function(G,ka){switch(G){case "Microsoft.Office.ActionService":return new m(ka);case "Microsoft.Office.SharedFilePicker":return new n}return null};Object(de.a)(l,"WacApiHost",null,[]);e.prototype.hostName=function(){return"ExcelOnline"};e.prototype.appId=function(){return this.XPb};e.prototype.createInstance=function(G){switch(G){case "Microsoft.Authentication.AuthenticationService":return qi.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.fA,
this.gJ.Ji);case "Microsoft.Authentication.TokenParameters":return new Ja;case "Microsoft.ExcelServices.CustomFunctionManager":G=this.vb.la(122);var ka=this.vb.la(123);return new t(G,ka,f(this.XPb,this.vb,this.gJ));case "Microsoft.AppRuntime.AppRuntimeService":return new u(this.fA,this.gJ);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return G=Hj.a(this.vb),new z(this.XPb,this.fA,G,this.gJ);case "Microsoft.DynamicRibbon.DynamicRibbon":return G=Hj.a(this.vb),new ol.DynamicRibbon(this.XPb,
this.fA,this.gJ,G,G.cn(this.fA).el);case "Microsoft.Office.Licensing.License":return new x(this.fA,this.gJ);case "Microsoft.InternalService.AddinInternalService":return new C(this.fA);default:if(this.RSc||(this.RSc=new l),ka=this.RSc.createInstance(G,this.Pyg))return ka}Se.ULS.sendTraceTag(537163155,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",G);throw OfficeExtension.WacRuntime.Utility.createRichApiException(L.a.generalException,L.a.generalException);};
Object(de.a)(e,"RichApiHost",null,[]);var sl=b(385),ll=b(113),wk=b(32),Xk=b(94),hl=b(278),ql=b(41),tl=b(245),rl=b(6),ek=b(65),Hk=b(192);c.prototype.dispose=function(){this.$=this.X8b=null};c.prototype.Yc=function(){return!1};c.prototype.fd=function(){return!1};c.prototype.executeCommand=function(G,ka,d){G=ka.command;switch(G){case 451041795:this.ze.yf(d[yj.a.Ug],d[yj.a.G3]);break;case 974713501:this.v4h(d[yj.a.Ug],d[yj.a.G3]);break;case 1237877382:this.ze.Ou(d[yj.a.G3]);break;default:return Xi.a(G)}return Wj.Task.Ta(!0)};
c.prototype.Jc=function(G,ka,d){if(G=!!d)switch(ka.command){case 974713501:case 1237877382:case 451041795:break;default:G=!1}return G};c.prototype.v4h=function(G,ka){var d=G.DdaMethod;if("undefined"===typeof d.DispatchId)this.ze.yf($d.a.internalError,ka);else if(c.Bhi(G)||this.$.Hd&1){if(d.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new da(this.$,this,G,ka)).start(this.We,G.DdaMethod.ControlId):d.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.vYh(G,ka):
d.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.kuj(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?this.addBinding(G,this.jed(G.DdaMethod.ControlId),0,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.QKh(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.aqj(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.PKh(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.P$i(G,
ka):d.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.RJh(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?this.Ntd(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(G.DdaAddRowsColumns.IsRow=!0,this.Lme(G,ka)):d.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(G.DdaAddRowsColumns.IsRow=!1,this.Lme(G,ka)):d.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?
this.hdh(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.eYg(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?(G.DdaSetBindingFormats.IsSetFormats=!0,this.XYf(G,ka)):d.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(G.DdaSetBindingFormats.IsSetFormats=!1,this.XYf(G,ka)):d.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(G,G.DdaBindingsMethod.ItemName,G.DdaBindingsMethod.FailOnCollision?2:1,ka):d.DispatchId===
OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.XPh(ka):d.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.pxd(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.VOh(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.WOh(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.R$i(G,ka):d.DispatchId===
OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(G.DdaMethod.ControlId,G),this.ze.Ou(ka)):d.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?Gf.EwaSettings.la(24)?this.ze.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ka):this.$Ai(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?Gf.EwaSettings.la(24)?this.ze.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,ka):this.WAi(G,
ka):d.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(G,ka):d.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?this.getAuthContext(G,ka):this.ze.yf($d.a.vCd,ka),Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&d.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){G=this.We.sZ(G.DdaMethod.ControlId);ka="";if(G){ka=mi.DdaFacade.getSolutionId(G,this.$);var w=G.PrimaryMarketplace.MarketplaceType;w===
OSF.StoreType.InMemory?G.OwnerAddinAssetId&&G.AssetMarketplace&&(w=G.AssetMarketplace.MarketplaceType):w===OSF.StoreType.WopiCatalog&&(w=OSF.StoreType.OMEX);ka=Telemetry.PrivacyRules.GetAssetId(w,G.PrimaryMarketplace.MarketplaceRef,ka)}Se.ULS.sendTraceTag(537163224,344,50,"DDA method Id: {0}, AppID: {1}",d.DispatchId,ka)}}else this.ze.yf($d.a.DJe,ka)};c.prototype.QKh=function(G,ka){var d=this;G.DdaGetBindingData.CoerceType=c.u2b(G.DdaGetBindingData.CoerceType);G.DdaGetBindingData.FilterType=c.TTe(G.DdaGetBindingData.FilterType);
G.DdaGetBindingData.ValueFormat=c.Xfg(G.DdaGetBindingData.ValueFormat);if(this.lic(G.DdaGetBindingData.CoerceType,ka)){if(G.DdaGetBindingData){var w=G.DdaGetBindingData;0===w.FilterType&&(w.FilterType=2);w.StartCol|=0;w.StartRow|=0;w.ColCount=void 0===w.ColCount?-1:w.ColCount;w.RowCount=void 0===w.RowCount?-1:w.RowCount}this.Rz.ddaGetBindingData(G.DdaMethod.ControlId,G.DdaGetBindingData.BindingId,G.DdaGetBindingData.CoerceType,G.DdaGetBindingData.ValueFormat,G.DdaGetBindingData.FilterType,G.DdaGetBindingData.StartRow,
G.DdaGetBindingData.StartCol,G.DdaGetBindingData.RowCount,G.DdaGetBindingData.ColCount,function(I){if(Fi.a(I)||!I.Result)d.ze.nH(I,ka);else{var ha=d.ze.tQ();ha.Data=c.$ue(I.Result);ka(ha)}},ka)}};c.prototype.aqj=function(G,ka){var d=this;G.DdaSetBindingData.CoerceType=c.u2b(G.DdaSetBindingData.CoerceType);if(this.lic(G.DdaSetBindingData.CoerceType,ka)){var w=c.QYc(G.DdaSetBindingData.CoerceType,G.DdaSetBindingData.Data);c.ofc(w)?this.ze.yf($d.a.WAc,ka):(1===w.CoerceType&&(w.CellFormat||(w.CellFormat=
G.DdaSetBindingData.CellFormat),w.TableOptions||(w.TableOptions=G.DdaSetBindingData.TableOptions)),G.DdaSetBindingData&&(G.DdaSetBindingData.StartCol|=0,G.DdaSetBindingData.StartRow|=0),this.Rz.ddaSetBindingData(G.DdaMethod.ControlId,G.DdaSetBindingData.BindingId,G.DdaSetBindingData.StartRow,G.DdaSetBindingData.StartCol,w,function(I){Fi.a(I)?d.ze.nH(I,ka):d.ze.Ou(ka)},ka))}};c.prototype.vYh=function(G,ka){var d=this;G.DdaGetBindingData.CoerceType=c.u2b(G.DdaGetBindingData.CoerceType);G.DdaGetBindingData.ValueFormat=
c.Xfg(G.DdaGetBindingData.ValueFormat);G.DdaGetBindingData.FilterType=c.TTe(G.DdaGetBindingData.FilterType);if(this.lic(G.DdaGetBindingData.CoerceType,ka)){var w=this.jed(G.DdaMethod.ControlId);w?this.Rz.ddaGetSelectedData(G.DdaMethod.ControlId,G.DdaGetBindingData.CoerceType,G.DdaGetBindingData.ValueFormat,G.DdaGetBindingData.FilterType,w,function(I){if(Fi.a(I))d.ze.nH(I,ka);else{var ha=d.ze.tQ();ha.Data=c.$ue(I.Result);ka(ha)}},ka):this.ze.yf($d.a.q3e,ka)}};c.prototype.VOh=function(G,ka){var d=this;
if(kj.a.$od)this.ze.yf($d.a.zPg,ka);else{var w=G[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],I=G[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],ha=G.DdaMethod.ControlId,wa=r.getInstance(this.$);if(0>=I)Se.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.ze.yf($d.a.rei,ka);else if(I>r.uzi)Se.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.ze.yf($d.a.wZe,ka);else{var $a=null;switch(w){case 1:$a=
"Compressed";break;case 0:$a="Text";break;case 2:$a="Pdf";break;default:Se.ULS.sendTraceTag(537163219,344,15,"Requested file type {0} is not supported.",w);this.ze.yf($d.a.HTe,ka);return}if("Text"===$a)Se.ULS.sendTraceTag(537163218,344,15,"Requested file type {0} is not supported.",$a),this.ze.yf($d.a.HTe,ka);else{Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(G=new Sys.StringBuilder,G.append(Wg.a(this.$,$a)),"Pdf"===$a&&Dh.a.Xf(G,hj.a.YFd,"WholeWorkbook"),
G=G.toString()):G=Wg.a(this.$,$a);var Tb=null,Ic=new XMLHttpRequest;Ic.onreadystatechange=function(){if(4===Ic.readyState)if(200===Ic.status){var pc=Ic.response;if(pc){Tb=new Uint8Array(pc);pc=d.ze.tQ();for(var vd=Tb.length,ne=r.WDi(),Pe={},Af=0,Wf=0;Wf<vd;Wf+=I){for(var Of=[],xg=Wf+I<vd?Wf+I:vd,oi=0,Sh=Wf;Sh<xg;oi++,Sh++)Of[oi]=Tb[Sh];Pe[(Af++).toString()]=Of}Pe=new V(ne,vd,I,Pe);Pe=wa.aBg(ha,Pe);Pe!==$d.a.success?d.ze.yf(Pe,ka):(pc[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=ne,
pc[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=vd,Se.ULS.sendTraceTag(537163216,344,50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",$a,vd),ka(pc))}else Se.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type {0}.",$a),d.ze.yf($d.a.internalError,ka)}else 500===Ic.status?d.ze.yf($d.a.iWe(parseInt(Ic.statusText,10)),ka):(Se.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type {0}.",
$a),d.ze.yf($d.a.EDi,ka))};Ic.open("GET",G,!0);Ic.responseType="arraybuffer";Ic.setRequestHeader("If-Modified-Since","0");Ic.send(null)}}}};c.prototype.WOh=function(G,ka){var d=G[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],w=G[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];G=G.DdaMethod.ControlId;(d=r.getInstance(this.$).YOh(G,d))?(d=d.UDj,0>w||w>=Object.keys(d).length?this.ze.yf($d.a.b$h,ka):(w=d[w.toString()],d=this.ze.tQ(),d[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=
w,d[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=w.length,ka(d))):this.ze.yf($d.a.internalError,ka)};c.prototype.R$i=function(G,ka){var d=G[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];G=G.DdaMethod.ControlId;d=r.getInstance(this.$).Q$i(G,d);d===$d.a.success?this.ze.Ou(ka):this.ze.yf(d,ka)};c.prototype.kuj=function(G,ka){var d=this;G.DdaSetBindingData.CoerceType=c.u2b(G.DdaSetBindingData.CoerceType);if(this.lic(G.DdaSetBindingData.CoerceType,ka)){var w=this.jed(G.DdaMethod.ControlId);
if(w){var I=c.QYc(G.DdaSetBindingData.CoerceType,G.DdaSetBindingData.Data),ha=dj.g(this.$).ha;1===I.CoerceType&&(!I.Data&&ha.va.h_&&(I.Headers||(I.Headers=[]),I.Headers.length||Array.add(I.Headers,[]),I.Headers[0].length||Array.add(I.Headers[0],"")),c.ofc(I)||(I.CellFormat||(I.CellFormat=G.DdaSetBindingData.CellFormat),I.TableOptions||(I.TableOptions=G.DdaSetBindingData.TableOptions)));if(c.ofc(I))this.ze.yf($d.a.WAc,ka);else{var wa=ha.va.Sd.clone(),$a=ha.va.activeCell.clone();this.Rz.ddaSetSelectedData(G.DdaMethod.ControlId,
w,I,function(Tb){var Ic;if(Fi.a(Tb))d.ze.nH(Tb,ka);else{Tb=wa.clone();var pc=I.Headers?I.Headers[0].length:I.Data[0].length;1!==I.CoerceType||I.Data?1===I.CoerceType&&(null===(Ic=I.TableOptions)||void 0===Ic?0:Ic.length)&&0==I.TableOptions[0]?(Tb.top+=1,Tb.bottom=Tb.top+I.Data.length-1):Tb.bottom=Tb.top+I.Data.length-(1===I.CoerceType?0:1):Tb.bottom=Tb.top+1;Tb.right=Tb.left+pc-1;Ic=Tb.contains($a)?$a:Tb.topLeft;ha.updateSelection(Tb,Ic,0);d.ze.Ou(ka)}},ka)}}else this.ze.yf($d.a.pxe,ka)}};c.prototype.addBinding=
function(G,ka,d,w){var I=this;ka?this.Rz.ddaAddBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,G.DdaBindingsMethod.BindingType,ka,d,function(ha){if(Fi.a(ha))I.ze.nH(ha,w);else{var wa=I.ze.tQ();wa.Bindings=Array(1);wa.Bindings[0]=I.We.f0b(ha.Result);w(wa)}},w):this.ze.yf($d.a.vnj,w)};c.prototype.PKh=function(G,ka){var d=this;this.Rz.ddaGetBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(w){if(Fi.a(w)||!w.Result)d.ze.nH(w,ka);else{var I=d.ze.tQ();I.Bindings=Array(1);
I.Bindings[0]=d.We.f0b(w.Result);ka(I)}},ka)};c.prototype.XPh=function(G){var ka=this.ze.tQ(),d={};d[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;ka[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=d;G(ka)};c.prototype.P$i=function(G,ka){var d=this;this.Rz.ddaReleaseBinding(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(w){Fi.a(w)?d.ze.nH(w,ka):d.ze.Ou(ka)},ka)};c.prototype.RJh=function(G,ka){var d=this;this.Rz.ddaGetAllBindings(G.DdaMethod.ControlId,
function(w){if(Fi.a(w))d.ze.nH(w,ka);else{var I=d.ze.tQ();if(w.Result){w=w.Result;I.Bindings=Array(w.length);for(var ha=0;ha<w.length;ha++)I.Bindings[ha]=d.We.f0b(w[ha])}else I.Bindings=null;ka(I)}},ka)};c.prototype.Ntd=function(G,ka){var d=this;this.Rz.ddaLoadSettings(G.DdaMethod.ControlId,function(w){if(Fi.a(w))d.ze.nH(w,ka);else{var I=d.ze.tQ();I.Properties=w.Result;ka(I)}},ka)};c.prototype.saveSettings=function(G,ka){for(var d=this,w={Settings:[]},I=0;I<G.DdaSettingsMethod.Properties.length;I++){var ha=
{};ha.Name=G.DdaSettingsMethod.Properties[I][0];ha.Value=G.DdaSettingsMethod.Properties[I][1];w.Settings[I]=ha}this.Rz.ddaSaveSettings(G.DdaMethod.ControlId,w,G.DdaSettingsMethod.OverwriteIfStale,function(wa){Fi.a(wa)?d.ze.nH(wa,ka):d.ze.Ou(ka)},ka)};c.prototype.Lme=function(G,ka){var d=this,w=c.QYc(1,G.DdaAddRowsColumns.Data);c.ofc(w)?this.ze.yf($d.a.WAc,ka):this.Rz.ddaAddRowsColumns(G.DdaMethod.ControlId,G.DdaAddRowsColumns.BindingId,G.DdaAddRowsColumns.IsRow,w,function(I){Fi.a(I)?d.ze.nH(I,ka):
d.ze.Ou(ka)},ka)};c.prototype.hdh=function(G,ka){var d=this;this.Rz.ddaDeleteAllDataValues(G.DdaMethod.ControlId,G.DdaBindingsMethod.BindingId,function(w){Fi.a(w)?d.ze.nH(w,ka):d.ze.Ou(ka)},ka)};c.prototype.eYg=function(G,ka){var d=this;this.Rz.ddaClearBindingFormats(G.DdaMethod.ControlId,G.DdaClearBindingFormats.BindingId,function(w){Fi.a(w)?d.ze.nH(w,ka):d.ze.Ou(ka)},ka)};c.prototype.XYf=function(G,ka){var d=this,w={},I=G.DdaSetBindingFormats.IsSetFormats;I?w.CellFormat=G.DdaSetBindingFormats.CellFormat:
w.TableOptions=G.DdaSetBindingFormats.TableOptions;this.Rz.ddaSetBindingFormats(G.DdaMethod.ControlId,G.DdaSetBindingFormats.BindingId,w,I,function(ha){Fi.a(ha)?d.ze.nH(ha,ka):d.ze.Ou(ka)},ka)};c.prototype.executeRichApiRequest=function(G,ka){var d=this,w=G.ArrayData,I={},ha=dj.g(this.$).ha;if(w){if("WacPartition"===w[0]){this.dzh(G,ka);return}var wa=Object(Vh.a)(mi.DdaFacade,Hj.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===w[0]){var $a=wa.cn(G.DdaMethod.ControlId);$a&&($a.Fpd=!0,
$a.xKf())}I.HttpMethod=w[1];I.PathAndQuery=w[2];I.RequestHeaders=c.S_e(w[3]);I.RequestBody=w[4];I.AppPermission=w[5];$a=w[6];I.RequestFlags=$a;var Tb=0;if(nj.i(this.$.pa))switch(ha.Ve){case 1:Tb=2;break;case 2:Tb=3;break;case 128:Tb=4;break;default:Tb=1}var Ic=null;ha.Pa.pC&&(Ic=ha.Pa.pC.ij);I.SheetMultiRange=ni.r(ha.va.selectedRanges,this.$);I.ActiveCell=ni.v(ha.va.activeCell,this.$);I.ActiveChartId=Ic;I.SelectionState=Tb;Tb=this.We.sZ(G.DdaMethod.ControlId);I.InstanceId=Tb?Tb.InstanceId:"";if(Tb&&
Tb.PrimaryMarketplace){Ic=mi.DdaFacade.getSolutionId(Tb,this.$);var pc=Tb.PrimaryMarketplace.MarketplaceType;if(pc===OSF.StoreType.InMemory){if(!Tb.OwnerAddinSolutionId){this.ze.yf($d.a.Xxb,ka);return}if(Tb.AssetMarketplace)pc=Tb.AssetMarketplace.MarketplaceType;else{this.ze.yf($d.a.Xxb,ka);return}}else pc===OSF.StoreType.WopiCatalog&&(pc=OSF.StoreType.OMEX);var vd=Telemetry.PrivacyRules.GetAssetId(pc,Tb.PrimaryMarketplace.MarketplaceRef,Ic);I.CompliantSolutionId=vd;I.SolutionId=Ic;I.MarketplaceType=
pc;I.SolutionVersion=Tb.PrimaryMarketplace.SolutionVersion;I.StoreLocation=Tb.PrimaryMarketplace.MarketplaceRef}else I.SolutionId=I.MarketplaceType="",I.CompliantSolutionId="";I.IsEventsEnabled=void 0===wa||null===wa||wa.gj.q_b(I.InstanceId);I.RequestGuid=Kj.a.create().toString();wa=I.RequestBody.length;if(Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&wa>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.ze.yf($d.a.Ogj,ka);Se.ULS.sendTraceTag(537163213,0,50,
"Request payload size:{0} exceeded the limit",wa);return}Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&$a&4096&&(wa=new fa(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(wa,X,w),I.RequestBody=w[4])}var ne=c.X2e(I.RequestHeaders);c.oDd++;var Pe=yh.a.Ra.Kb;Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&I&&I.RequestBody&&Se.ULS.sendTraceTag(537163212,0,50,String.format("Richapi json request body size is {0}",I.RequestBody.length));
this.Rz.executeRichApiRequest(I,function(Af){var Wf;d.gYf(Pe,!0,Af.ServerCorrelationId);var Of=null,xg=null,oi=Af.ServerCorrelationId;if(null===(Wf=null===Af||void 0===Af?void 0:Af.Errors)||void 0===Wf?0:Wf[0])Of=Af.Errors[0].MessageIdName,xg=Af.Errors[0].Description,Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&ek.a(d.$).qd.ZD(Af.Errors[0].MessageId);if(Fi.a(Af)||!Af.Result)d.JNa(oi,ne,"Server error",Of,xg),d.ze.nH(Af,ka);else{var Sh=null;if(Gf.EwaSettings.la(260))if((Wf=
Af.Result)&&Wf.length){for(var mj=0;mj<Wf.length;mj++)if(Wf[mj].RequestGuid===I.RequestGuid){Sh=Wf[mj];break}Sh||d.ze.nH(Af,ka)}else Sh=Af.Result;else Sh=Af.Result;if(!Of&&Sh&&Sh.ResponseBody&&Sh.ResponseBody[0])if(Af=Sh.ResponseBody[0],Af.startsWith('{"Error":')){1<Sh.ResponseBody.length&&(Af=Af.substring(0,Af.indexOf("}")+1),Af+="}");try{var tj=cj.a.pi(Af);tj.Error&&d.JNa(oi,ne,"Pipeline error",tj.Error.Code,tj.Error.Message)}catch(nl){d.JNa(oi,ne,"Json deserialize error",null,"Error info cannot be deserialized.")}}else d.JNa(oi,
ne);else d.JNa(oi,ne,"Server error",Of,xg);var Cj=(tj=Sh.SheetMultiRange)?tj.SheetName:null;Af=Sh.ActiveChartId;var pj=Sh.SelectionState;Of=5===pj&&!!tj||6===pj||7===pj||8===pj;if(Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&d.$.Ab.TC&&Of)d.ze.yf($d.a.cDc,ka),Se.ULS.sendTraceTag(537163211,0,50,String.format("{0} is not allowed",pj.toString()));else if(5===pj&&tj){if(d.$.xa&&Cj)if(d.$.xa.zj(Cj))d.JTc(Cj);else{var fk=null;fk=function(){d.$.xa.zj(Cj)&&
(Se.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),d.JTc(Cj),d.$.xa.bbb(fk))};d.$.xa.KYa(fk);if(Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var Zk=null;Zk=function(){d.$.xa.zj(Cj)&&(d.JTc(Cj),d.$.xa.Tma(Zk))};d.$.xa.$ga(Zk)}}}else if(6===pj||7===pj||8===pj||9===pj){if(tj){var Zi=ni.g(tj.Ranges);if(Cj&&ni.cb(Zi,!0))if(Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&
!d.$.xa.zj(Cj)){var ml=null;ml=function(){d.Aeg(ha,Zi,Cj,pj);d.$.xa.Tma(ml)};d.$.xa.$ga(ml)}else d.Aeg(ha,Zi,Cj,pj)}7===pj?(Af="38.{"+Hk.c(Af)+"}",sk.a(d.$).ona(0,Af,!0)):8===pj&&sk.a(d.$).ona(2,Af,!0);9===pj&&(d.$.ya.ApiCallToSetPageLayout=!0)}Sh.PostProcessActions?d.$.Pgf?(oi=cj.a.pi(Sh.PostProcessActions),d.l0i(oi).then(function(){d.fcb(Sh,ka);d.ibd(G.DdaMethod.ControlId,I);return Promise.resolve(null)},function(nl){d.fcb(Sh,ka,nl);return Promise.reject(nl)})):(d.JNa(oi,ne,"Promise not supported",
null,"Promise is not supported on this browser."),d.ze.yf($d.a.internalError,ka)):d.fcb(Sh,ka)}},function(Af){d.gYf(Pe,!1,null);d.JNa(null,ne,"Web service error");ka(Af)})};c.prototype.ibd=function(G,ka){var d=Object(Vh.a)(mi.DdaFacade,Hj.a(this.$));(null===d||void 0===d?0:d.VLd)&&d.cn(G)&&c.dyj(ka.RequestHeaders)&&(Se.ULS.sendTraceTag(537163209,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",G,ka.SolutionId),d.VLd.$lh(G))};c.prototype.dzh=
function(G,ka){var d=this,w=this.We.sZ(G.DdaMethod.ControlId),I=mi.DdaFacade.getSolutionId(w,this.$),ha=null;ha=mi.DdaFacade.Yua(w,this.$);ha=new J(ha,this.$);ha=new e(I,G.DdaMethod.ControlId,this.We,this.$,ha);var wa={ResponseHeaders:[]};wa.ResponseBody=Array(1);w=c.S_e(G.ArrayData[3]);var $a=c.X2e(w);w=new ja(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.psf);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(ha,ea,w,G.ArrayData).then(function(Tb){if(!Tb)return d.yud(!1,"The rich api executor call failed",
$a),Se.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),wa.ResponseStatusCode=500,d.fcb(wa,ka),null;d.yud(!0,"The rich api executor call succeeded",$a);wa.ResponseStatusCode=Tb[0];wa.ResponseBody[0]=Tb[2];d.fcb(wa,ka);return null},function(Tb){wa.ResponseStatusCode=400;wa.ResponseBody[0]=Tb.toString();d.yud(!1,"The rich api executor call failed",$a);Se.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",I);d.fcb(wa,ka);return null})};c.prototype.gYf=
function(G,ka,d){c.oDd--;G=ll.a(yh.a.Ra,G);Se.ULS.sendTraceTag(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",G,c.oDd,ka?"success":"false",d)};c.prototype.fcb=function(G,ka,d){d=void 0===d?null:d;var w=Array(3);w[0]=G.ResponseStatusCode;w[1]=c.NZh(G.ResponseHeaders);var I=[],ha=!1;if(d&&G.ResponseBody){var wa=cj.a.pi(G.ResponseBody.join(""));wa.Error||(ha={},ha.Error=d,ha.TraceIds=wa.TraceIds,ha.ProcessedResults=
{},ha.ProcessedResults.Results=wa.Results,I[0]=cj.a.Kc(ha),ha=!0)}w[2]=ha?I:G.ResponseBody;G=this.ze.tQ();G.Data=w;ka(G)};c.prototype.pxd=function(G,ka){(new S(this.$,this.ze,this.Rz)).pxd(G,ka)};c.prototype.$Ai=function(G,ka){Se.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");var d=G[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],w=G[wg.a.NVc],I=G[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];G=this.$.da.Aa(232).r1a.aBi(G.DdaMethod.ControlId,d,w,I);G===$d.a.success?this.ze.Ou(ka):
(Se.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.ze.yf(G,ka))};c.prototype.WAi=function(G,ka){Se.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");var d=G[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],w=G[wg.a.NVc],I=G[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.Aa(232).r1a.voj(G.DdaMethod.ControlId,d,w,I);this.ze.Ou(ka)};c.prototype.getAccessToken=function(G,ka){function d(ha,wa){if(ha===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)ha=w.ze.tQ(),
ha[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=wa.accessToken,ka(ha);else{wa=w.We.sZ(G.DdaMethod.ControlId);var $a=null!==wa.OwnerAddinSolutionId?wa.OwnerAddinSolutionId:wa.PrimaryMarketplace.MarketplaceType,Tb={};Se.ULS.sendTraceTag(537163202,0,10,"{0}.",(Tb.errorCode=ha.toString(),Tb.appId=Telemetry.PrivacyRules.GetAssetId($a,wa.PrimaryMarketplace.MarketplaceRef,mi.DdaFacade.getSolutionId(wa,w.$)),Tb.storeType=$a,Tb));w.ze.yf(ha,ka)}}var w=this;Se.ULS.sendTraceTag(537163203,
0,50,"GetAccessToken API called!");var I=!Gf.EwaSettings.la(24);Bh.TaskExtensions.Ba(gj.GetServiceTaskFactory.create(this.$.da,137,this.$.ma,1),function(ha){var wa=w.We.Ji,$a=pa.getInstance();Wa.AppsForOfficeSingleSignOnManager.getInstance(wa,ha.result,$a).getAccessToken(G.DdaMethod.ControlId,I,G,d)},this.$.ma)};c.prototype.getAuthContext=function(G,ka){var d=this;Bh.TaskExtensions.Ba(gj.GetServiceTaskFactory.create(this.$.da,137,this.$.ma,1),function(){var w=d.We.Ji.getOsfControl(G.DdaMethod.ControlId);
if(!Gf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||w.isFirstParty()){w=w.getManifest();var I=w.getMarketplaceID(),ha=w.getWebApplicationId(),wa=w.getWebApplicationMsaId();qi.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(I).then(function($a){var Tb=d.ze.tQ(),Ic={};Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=ha;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=wa||ha;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
$a.upn;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=$a.userId;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=$a.authority;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=hg.zKh($a.authorityType);Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=$a.isAnonymous;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=$a.tenantId;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=$a.supportsAuthToken;
Tb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ic;ka(Tb)},function($a){var Tb=d.ze.tQ(),Ic={},pc=new hg;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=ha;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=wa||ha;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=pc.upn;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=pc.userId;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=pc.authority;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=
pc.authorityType;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=pc.isAnonymous;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=pc.tenantId;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=$a;Ic[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=pc.supportsAuthToken;Tb[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=Ic;Tb.Error=1;ka(Tb)})}},this.$.ma)};c.prototype.rhi=function(G){var ka=dj.g(this.$).ha;return 16===
ka.Ve&&!!ka.Pa.lc&&!!ka.Pa.lc.floatingObject&&Gj.a.equals(ka.Pa.lc.floatingObject.id,G,!0)};c.prototype.jed=function(G){var ka=dj.g(this.$).ha;return ka.va.qh?1===ka.Ve||this.rhi(G)?ka.uia:null:null};c.prototype.lic=function(G,ka){return 1!==G&&2!==G&&3!==G?(this.ze.yf($d.a.CAe,ka),!1):!0};c.prototype.yud=function(G,ka,d){var w={};w.a=this.$.ya.UserSessionId;w.b=G;w.c=ka;w.d=null;w.e=d;Ik.b().Pe(37,w)};c.prototype.JNa=function(G,ka,d,w,I){d=void 0===d?null:d;w=void 0===w?null:w;I=void 0===I?null:
I;var ha={};G&&(ha.ServerCorrelationId=G);void 0!==ka&&null!==ka&&(ha.Source=ka);d&&(ha.ErrorType=d);w&&(ha.MessageId=w);I&&(ha.StatusDescription=I);Se.ULS.sendTraceTag(50688452,0,50,cj.a.Kc(ha))};c.prototype.l0i=function(G){for(var ka=new Promise(function(w){w(null)}),d=0;d<G.length;d++)ka=this.k0i(ka,G[d]);return ka};c.prototype.k0i=function(G,ka){var d=this;if(!ka)return Se.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),G.then(function(){return Promise.reject(c.i3a(D.generalException,
zf.a.instance.fa(1715),null))});switch(ka.actionType){case 1:case 2:G=G.then(function(){var w=Object(Vh.a)(mi.DdaFacade,Hj.a(d.$));if(w.cn(ka.controlId))switch(w.gj.K3h(ka),ka.messageType){case 14:case 100:w.ULd.O_b(ka);break;case 11:case 12:w.Djj.vob(ka);break;case 51:case 52:w.Bjj.vob(ka);break;case 2101:case 2102:w.Cjj.vob(ka);break;case 2E3:w.Ejj.O_b(ka);break;case 2201:d.$.Qka&&w.VLd.oMg(ka);break;case 2203:w.Fjj.pMg(ka);break;case 2700:Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
w.TLd.O_b(ka)}else Se.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId[{0}] doesn't exist.",ka.controlId);return Promise.resolve(null)});break;case 3:G=G.then(function(){d.y3h(ka);return Promise.resolve(null)});break;case 15:Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(G=G.then(function(){d.Z4h(ka);return Promise.resolve(null)}));break;case 4:G=G.then(function(){if(Gf.EwaSettings.la(105)){var w=dj.g(d.$).ha.va.activeCell;w.top!==ka.row+1&&w.left!==ka.column+1&&
(w=ni.v(gg.Range.kd(ka.row+1,ka.column+1),d.$),dj.g(d.$).Vg(w,null,null,null,3,oj.a.Rbh));kk.a(d.$,243,242,0,function(I){I.NKb(ka.row+1,ka.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:G=G.then(function(){Object(Vh.a)(mi.DdaFacade,Hj.a(d.$)).gj.BLe(ka.controlId,ka.isEnableEvents);return Promise.resolve(null)});break;case 5:G=G.then(function(){return d.nah(ka)});break;case 6:G=G.then(function(){return d.yWi(ka)});break;case 8:G=G.then(function(){Gf.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&
Object(Vh.a)(mi.DdaFacade,Hj.a(d.$)).dYg();var w=new tl.a(rl.a.Bk,5,null);ql.a(d.$).kt(w);return Promise.resolve(null)});break;case 9:G=G.then(function(){return d.dqj(ka)});break;case 10:G=G.then(function(){return d.TYj(ka)});break;case 11:G=G.then(function(){return d.SYj()});break;case 12:G=G.then(function(){return d.PYj()});break;case 13:G=G.then(function(){return d.QYj(ka)});break;case 14:G=G.then(function(){return d.RYj(ka)});break;case 16:G=G.then(function(){return Promise.resolve(ka)});break;
case 17:G=G.then(function(){return d.tmj(ka,Object(Vh.a)(mi.DdaFacade,Hj.a(d.$)))});break;case 18:dj.g(this.$).focus();break;case 19:this.n6e(ka.entryType,!1,ka.options);break;case 20:this.n6e(ka.entryType,!0,ka.options);break;default:G=G.then(function(){return Promise.reject(c.i3a(D.KJg,zf.a.instance.fa(1716),null))})}return G};c.prototype.Z4h=function(G){var ka=Object(Vh.a)(mi.DdaFacade,Hj.a(this.$)).cn(G.controlId);if(ka&&!(0===G.operationType^!ka.Cda)){dj.g(this.$).Dhc=!0;switch(G.operationType){case 0:var d=
new hl.a(document.createElement("input"));d.text=G.range;ka.dci(dj.g(this.$).Hh.I9g(d,new sl.a(this.$)));ka.Cda.startEdit(!0);break;case 1:ka.cQf();this.rangePicker=null;break;case 2:ka.Cda.Peg(G.range);break;case 3:ka.Cda.Peg(G.startingRange);ka=G.expandSelection;d=G.getNextDataRegionCell;var w=0;switch(G.keyboardDirectionValue){case 2:w=38;G=ka&&d?105288353:ka?-31900117:d?542791952:137938150;break;case 3:w=40;G=ka&&d?-1297307319:ka?-1603798598:d?1713663844:-798660877;break;case 0:w=37;G=ka&&d?-403586027:
ka?2039316657:d?-2012742350:-1470715894;break;case 1:w=39;G=ka&&d?784916030:ka?589730764:d?1324884057:-1231471547;break;default:G=1461300262}ka=this.l4b("keydown",w,ka,d);dj.g(this.$).hIb(ka,new ag.a(G,1,0,8,null))}dj.g(this.$).Dhc=!1}};c.prototype.l4b=function(G,ka,d,w){var I=document.createEvent("KeyboardEvent");if(kj.a.sF)I.initKeyboardEvent(G,!1,!1,window.self,"A",0,w,!1,d,!1);else{var ha="";d&&(ha+="Shift");w&&(ha+=0<ha.length?" Control":"Control");I.initKeyboardEvent(G,!1,!1,window.self,"A",
0,ha,!1,"en-US")}G=new Sys.UI.DomEvent(I);G.keyCode=ka;return G};c.prototype.y3h=function(G){switch(G.operationType){case 1:Bh.TaskExtensions.Ba(gj.GetServiceTaskFactory.create(this.$.da,153,this.$.ma,1),function(ka){ka.result.RKd()},this.$.ma,3);break;case 2:if(G=Object(Vh.a)(mi.DdaFacade,Hj.a(this.$)).cn(G.controlId))G.Fpd=!0,G.xKf()}};c.prototype.nah=function(G){var ka=this,d=G.fileBase64;return d&&d.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(c.i3a(D.invalidArgument,zf.a.instance.fa(1719),
"Application.CreateWorkbook")):(new Promise(function(w,I){var ha=new id.StandardDialog;ha.jc=4;ha.Jk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(wa){2!==wa&&0!==wa||I(c.i3a(D.sCd,zf.a.instance.fa(1718),"Application.CreateWorkbook"));wa=new qa("blank","agave",d?"streamBase64":"streamEmpty",d);ka.psf.create(w,I,wa).E0a()})})).then(function(w){ka.X8b.set(G.fakeFileId,w);return Promise.resolve(null)},function(w){return w?Promise.reject(w):Promise.reject(c.i3a(D.generalException,
zf.a.instance.fa(1715),"Application.CreateWorkbook"))})};c.prototype.yWi=function(G){var ka=this;return new Promise(function(d,w){if(ka.X8b.has(G.fakeFileId)){var I=ka.X8b.get(G.fakeFileId);w=new id.StandardDialog;w.jc=4;w.Jk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(ha){1===ha&&uh.HelperMethods.vf(I,void 0,void 0,"DdaMethodHandler.fileUrl");d(null)})}else w(c.i3a(D.generalException,zf.a.instance.fa(1715),"Document.Open"))})};c.prototype.dqj=
function(G){var ka=this;return new Promise(function(d){Object(Vh.a)(mi.DdaFacade,Hj.a(ka.$)).LUf=G.runtimeCalculationMode;var w=ka.$.da.Aa(268);w&&w.qyd(3===G.runtimeCalculationMode);d(null)})};c.prototype.TYj=function(G){Wi.a.Yzb(this.$)&&this.$.da.Aa(331).gcb(0,G.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.SYj=function(){Wi.a.Yzb(this.$)&&this.$.da.Aa(331).gcb(1,null,!0,!0,null);return Promise.resolve(null)};c.prototype.PYj=function(){Wi.a.Yzb(this.$)&&this.$.da.Aa(331).yLe();return Promise.resolve(null)};
c.prototype.QYj=function(G){Wi.a.Yzb(this.$)&&this.$.da.Aa(331).gcb(5,G.urlStr,!0,!0,null);return Promise.resolve(null)};c.prototype.RYj=function(G){if(Wi.a.Yzb(this.$)){var ka=this.$.da.Aa(331);ka=yl(ka.oaa);for(var d=ka.next();!d.done;d=ka.next())d=d.value,d.IsActive&&d.HostEditUrl&&d.UrlStr===G.hostEditUrlStr&&uh.HelperMethods.vf(d.HostEditUrl,"_blank")}return Promise.resolve(null)};c.prototype.tmj=function(G,ka){var d=Be.a.bX;G=cj.a.pi(G.payload);var w={};"eventId"in G&&"payload"in G&&(w.eventId=
G.eventId,w.payload=G.payload);ka.UM(2201,d,cj.a.Kc(w));return Promise.resolve(null)};c.prototype.n6e=function(G,ka,d){var w=this.$.da.Aa(5);w&&(G=this.qLh(G))&&(ka?w.removeEntry(G):w.xme(G,d))};c.prototype.qLh=function(G){switch(G){case 0:return 63}};c.prototype.JTc=function(G){G=Object(Vh.a)(Xk.a,this.$.xa.getItemByName(G));(null===G||void 0===G?0:G.visible)&&G.activate(!0)};c.prototype.Aeg=function(G,ka,d,w){var I=G.va.aB,ha=I<ka.length&&ka[I].contains(G.va.activeCell);G=ha?G.va.activeCell:ka[0].topLeft;
I=ha?I:0;dj.g(this.$).wV(ka,I,d,null,G,null,null,3,oj.a.Sbh,void 0,void 0,void 0,6===w)};c.S_e=function(G){if(!G||!G.length)return null;for(var ka=Array(G.length/2),d=0;d<G.length/2;d++)ka[d]={},ka[d].Name=G[2*d],ka[d].Value=G[2*d+1];return ka};c.NZh=function(G){if(!G||!G.length)return null;for(var ka=Array(2*G.length),d=0;d<G.length;d++)ka[2*d]=G[d].Name,ka[2*d+1]=G[d].Value;return ka};c.ubd=function(G){if(!G||!G.length)return null;for(var ka=Array(G.length),d=0,w=G.length;d<w;d++){var I=G[d].length;
if(I){ka[d]=Array(I);for(var ha=0;ha<I;ha++)ka[d][ha]=null==G[d][ha]?null:G[d][ha].toString()}else return null}return ka};c.u2b=function(G){return"string"===typeof G?wk.a.Tn(c.Nbh,G,0):G};c.TTe=function(G){return"string"===typeof G?wk.a.Tn(c.Qbh,G,0):G};c.Xfg=function(G){return"string"===typeof G?wk.a.Tn(c.Ubh,G,0):G};c.Bhi=function(G){switch(G.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};c.QYc=function(G,ka){var d={};d.CoerceType=G;1===
d.CoerceType?(d.Data=c.ubd(ka.Rows),d.Headers=c.ubd(ka.Headers)):d.Data=c.ubd(ka);return d};c.$ue=function(G){if(1===G.CoerceType){var ka={};return ka.Headers=G.Headers,ka.Rows=G.Data,ka}return G.Data};c.ofc=function(G){return 1===G.CoerceType?!G.Data&&!G.Headers:!G.Data};c.X2e=function(G){var ka="Unknown";if(!G)return ka;for(var d=0;d<G.length;d++)if(G[d].Name.toLowerCase()===hj.a.Gjj){ka=G[d].Value;break}return ka};c.dyj=function(G){if(!G)return!1;for(var ka=hj.a.oGi.toLowerCase(),d=0;d<G.length;d++)if(G[d].Name.toLowerCase()===
ka)return!0;return!1};c.i3a=function(G,ka,d){var w={};w.Code=G;w.Message=ka;w.Location=d;w.ActionIndex=0;return w};Sk.Object.defineProperties(c.prototype,{NQ:{configurable:!0,enumerable:!0,get:function(){return this.ze}}});Sk.Object.defineProperties(c,{Nbh:{configurable:!0,enumerable:!0,get:function(){c.Kpa||(c.Kpa={},c.Kpa[Microsoft.Office.WebExtension.CoercionType.Table]=1,c.Kpa[Microsoft.Office.WebExtension.CoercionType.Text]=2,c.Kpa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,c.Kpa[Microsoft.Office.WebExtension.CoercionType.Html]=
4,c.Kpa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return c.Kpa}},Qbh:{configurable:!0,enumerable:!0,get:function(){c.Ahb||(c.Ahb={},c.Ahb[Microsoft.Office.WebExtension.FilterType.All]=1,c.Ahb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return c.Ahb}},Ubh:{configurable:!0,enumerable:!0,get:function(){c.Bhb||(c.Bhb={},c.Bhb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=2,c.Bhb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return c.Bhb}}});c.Kpa=null;c.Ahb=
null;c.Bhb=null;c.oDd=0;Object(de.a)(c,"DdaMethodHandler",null,[188,3]);var Yk=vj.a;vm(a,Yk);a.prototype.Od=function(){var G=this,ka=gj.GetServiceTaskFactory.create(this.$.da,106,this.ma,this.ub),d=gj.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.ub),w=pb(this.ma,this.ub);Bh.TaskExtensions.Ba(Bh.TaskExtensions.ve([ka,d,w],this.ma),function(){var ha=ka.result,wa=qi.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");G.Fd([new c(G.$,ha,wa)])},this.ma,3);var I=
qi.a.instance;Bh.TaskExtensions.Ba(gj.GetServiceTaskFactory.create(this.$.da,137,this.$.ma,this.ub),function(){I.register(Na,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").Bc().Lc(function(){return new Na})},this.$.ma)};a.ja=function(G){vj.a.fe(82,new a(G))};Object(de.a)(a,"DdaCommandHandlerFactory",vj.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");aj.a.$i("");aj.a.$i(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Uj.a;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.WopiIdentity");
gc.main();(function(){Ih.a.Ga(function(G){ng.ja(G)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");(function(){Ih.a.Ga(function(G){kf.ja(G);Wb.ja(G)})})();(function(){Ih.a.Ga(function(G){Bd.ja(G)})})();Type.registerNamespace("CommandUI.AddInCommands");(function(){Ih.a.Ga(function(G){Gf.EwaSettings.la(54)&&cc.ja(G)})})();(function(){Ih.a.Ga(function(G){Gf.EwaSettings.la(122)&&Jb.ja(G)})})();Ih.a.Ga(Ub.ja);Ih.a.Ga(pd.ja);Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.SmartLookup");(function(){Ih.a.Ga(function(G){Dc.ja(G);Ka.ja(G)})})();Ih.a.Ga(a.ja)},1413:function(A,F,b){function a(){this.vEc=null;this.gJc=0;this.MKc=!1;this.rb=new l.a;this.Jqg=new e.a}function c(){this.yKe=this.displayName=this.Jqb=this.Bo=this.oB=null;this.isUpgraded=!1}A=b(0);var e=b(184),l=b(93);c.prototype.zhf=function(n,m){return this.oB.getStoreType().toLowerCase()===n.toLowerCase()&&this.oB.getSolutionId().toLowerCase()===m.toLowerCase()};Object(A.a)(c,
"AddinCommandsResourceItem",null,[]);b.d(F,"a",function(){return a});a.prototype.QDg=function(n){this.rb.addHandler("AddinCommandsLoadingMessageChanged",n)};a.prototype.ubj=function(n){this.rb.removeHandler("AddinCommandsLoadingMessageChanged",n)};a.prototype.Icb=function(n){n!==this.vEc&&(this.vEc=n,this.rb.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.$pj=function(){this.gJc++;this.TYa||this.Icb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Qvc=function(){this.gJc--;this.Qtd()&&
(this.MKc?this.TYa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Icb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Icb(null))};a.prototype.NZf=function(n){this.MKc=!0;this.Icb((void 0===n?0:n)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)};a.prototype.Yye=function(){this.MKc=!1;this.Qtd()?this.Icb(null):this.Icb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Qtd=function(){return 0>=this.gJc};a.prototype.cja=function(n,m,f){f=void 0===
f?0:f;for(var x=yl(this.E5a),y=x.next();!y.done;y=x.next())if(y=y.value,y.zhf(n,m)&&(!y.Bo||y.Bo.YIh===f))return y;return null};a.prototype.qme=function(n,m,f,x){var y=new c;y.oB=n;y.Bo=m;y.Jqb=f;y.displayName=x;this.E5a.add(y)};a.prototype.WBg=function(n,m,f,x){var y=new c;y.oB=n;y.Bo=m;y.Jqb=null;y.yKe=f;y.displayName=x;this.E5a.add(y)};a.prototype.X$i=function(n,m){for(var f=0,x=yl(this.E5a),y=x.next();!y.done;y=x.next())y=y.value,y.oB.getStoreType()===n&&y.oB.getSolutionId()===m?this.E5a.removeAt(f):
f++};a.getInstance=function(){a.Oa||(a.Oa=new a);return a.Oa};Sk.Object.defineProperties(a.prototype,{TYa:{configurable:!0,enumerable:!0,get:function(){return this.vEc}},E5a:{configurable:!0,enumerable:!0,get:function(){return this.Jqg}}});a.Oa=null;Object(A.a)(a,"AddinCommandsResourceManager",null,[])},858:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);a.iCa="Alt";a.AUa="Command";a.kCa="Enabled";a.ODc="GroupId";a.id="Id";a.lCa="Image16by16";a.F0d="Image32by32";a.I0d="Keytip";
a.jgb="LabelText";a.$oa="Size";a.T0d="TemplateAlias";a.Zea="Title";a.Q0d="Tab";a.TDc="Scaling";a.RDc="MaxSize";a.SDc="Scale";a.GROUP="Group";a.hgb="Groups";a.BUa="Controls";a.S0d="Template";a.button="Button";a.wZ="FlyoutAnchor";a.LARGE="Large";a.vPb="Medium";a.SMALL="Small";Object(A.a)(a,"DataNodeWrapper",null,[])},859:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);var c=b(32);a.iWe=function(e){return c.a.Tn(a.YAi,e.toString(),a.internalError)};Sk.Object.defineProperties(a,{YAi:{configurable:!0,
enumerable:!0,get:function(){var e={};return a.wbe||(a.wbe=(e["-2002156328"]=a.CAe,e["-1954750170"]=a.q3e,e["317650254"]=a.YZg,e["-1005263101"]=a.kei,e["1353664579"]=a.Onj,e["159671765"]=a.lei,e["1446690022"]=a.wZe,e["1150069548"]=a.WAc,e["-1409306331"]=a.pxe,e["338507772"]=a.xGe,e["-457159301"]=a.sXi,e["-1037701970"]=a.obh,e["-1893322318"]=a.qei,e["965579896"]=a.qbh,e["93287890"]=a.pbh,e["358088857"]=a.Lqj,e["-1223650923"]=a.xGe,e["2007306190"]=a.TVg,e["1549955423"]=a.eue,e["-1275974171"]=a.pei,
e["382101082"]=a.BWi,e["-898776235"]=a.OCi,e["335464256"]=a.DCi,e["1677378049"]=a.oei,e["-261992848"]=a.XPj,e["-980820954"]=a.eue,e["-931375837"]=a.AWi,e["929186550"]=a.yjh,e["-982144310"]=a.k3i,e["-785741187"]=a.iei,e["2125217573"]=a.sei,e["299124955"]=a.jei,e["1669853884"]=a.Vjj,e["-1515932330"]=a.ZZg,e["314621024"]=a.wFh,e["-300049690"]=a.XVg,e["14766835"]=a.Uvj,e["-1251992761"]=a.DJe,e["-2087635043"]=a.invalidOrTimedOutSession,e["2100961153"]=a.invalidOrTimedOutSession,e["-1218744139"]=a.invalidSheetName,
e["-1468309555"]=5006,e["-315732528"]=a.invalidOrTimedOutSession,e["611268539"]=a.invalidOrTimedOutSession,e["1531005923"]=5006,e["1593924569"]=5006,e["299476328"]=a.rFa,e["49173765"]=a.rFa,e["-907155566"]=a.rFa,e["-1201603824"]=a.rFa,e["1541165282"]=a.rFa,e["-1347753427"]=a.rFa,e["134912532"]=a.rFa,e["1780971550"]=a.responsePayloadSizeLimitExceeded,e))}}});a.success=0;a.CAe=1E3;a.q3e=1001;a.YZg=1002;a.kei=1003;a.Onj=1004;a.lei=1005;a.wZe=1008;a.HTe=1009;a.invalidSheetName=1014;a.WAc=2E3;a.pxe=2001;
a.xGe=2002;a.sXi=2003;a.obh=2004;a.qei=2005;a.qbh=2007;a.pbh=2008;a.Lqj=2009;a.TVg=2014;a.vnj=3E3;a.eue=3002;a.pei=3004;a.BWi=3005;a.OCi=3006;a.DCi=3007;a.oei=3008;a.XPj=3009;a.AWi=3010;a.Uvj=4002;a.vCd=5E3;a.internalError=5001;a.DJe=5002;a.Xxb=5004;a.YQj=5007;a.b$h=5008;a.zPg=5009;a.invalidOrTimedOutSession=5012;a.cDc=5016;a.rFa=5102;a.Ogj=5103;a.responsePayloadSizeLimitExceeded=5104;a.mVg=7001;a.c6f=7002;a.yjh=8E3;a.k3i=8001;a.iei=8010;a.sei=8011;a.jei=8012;a.Vjj=8020;a.ZZg=8021;a.wFh=8022;a.XVg=
8023;a.sAi=11E3;a.EDi=11001;a.rei=11002;a.wbe=null;Object(A.a)(a,"DdaErrorIds",null,[])},860:function(A,F,b){function a(){}b.d(F,"a",function(){return a});A=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";a.lTc="AccessDenied";a.notSupported="NotSupported";a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.sCd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.aRj="UnsupportedUserIdentity";
a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.VHg="AddinIsAlreadyRequestingToken";a.pij="ResourceNotAllowed";a.clientError="ClientError";a.serverError="ServerError";a.O2g="ControlIdNotFound";a.gjj="RibbonApiNotAvailable";a.hostRestartNeeded="HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(A.a)(a,"ErrorCodes",null,[])},862:function(A,F,b){function a(nb,Hc){var Cc=Ve.call(this)||this;Cc.ea=
null;Cc.Pm=null;Cc.ei=null;Cc.Ff=[];Cc.PIa=null;Cc.aGe=!1;Cc.DOb=!1;Cc.initialized=!1;Cc.disposed=!1;Cc.UBa=null;Cc.Ooc=[];Cc.WFe=[];Cc.qPa=[];Cc.f1a=null;Cc.zDd=new pd.a($b.a.Hk());Cc.nZb=new Xb.a($b.a.Hk());Cc.dFb=[];Cc.CHf=[];Cc.C5b=350;Cc.gfa=null;Cc.rxa=null;Cc.WSc=!1;Cc.Gfe=null;Cc.Dfe=null;Cc.Hfe=null;Cc.Ffe=null;Cc.Jfe=null;Cc.nvg=null;Cc.Efe=null;Cc.Ife=null;Cc.Kfe=null;Cc.Lfe=null;Cc.Mfe=null;Cc.Mf=function(){Cc.UBa=Cc.ea.Dm.WebExtensions;for(var Sc=Cc.Ff.length-1;0<=Sc;--Sc){var Uc=Cc.Ff[Sc],
ae;if(ae=!Cc.jDh(Uc.controlId))ae=Uc,ae=lb.EwaSettings.la(122)?!ae.YHa:!0;ae&&(Uc.Nmc(),Array.removeAt(Cc.Ff,Sc))}if(Cc.UBa)for(Sc=0,Uc=Cc.UBa.length;Sc<Uc;Sc++){ae=Cc.UBa[Sc];var ue=Cc.cn(ae.WebExtensionId);ue&&ue.ZAd(ae)}};Cc.kma=function(Sc){Cc.raiseEvent("csc",Sc.getID())};Cc.lBf=function(Sc,Uc,ae){if(lb.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&Uc===OSF.AgaveHostAction.KeyboardShortcuts){var ue=Object(lc.a)(Object,ae);Uc={};Uc.keyCode=ue.keyCode;Uc.type=
"keydown";Uc.ctrlKey=ue.ctrlKey;Uc.shiftKey=ue.shiftKey;Uc.altKey=ue.altKey;Uc.metaKey=ue.metaKey;Sc=Cc.cn(Sc);ue=Sc.oha;Uc.srcElement=Object(Oa.a)(233,ue)?ue.WFa:kc.g(Cc.$).Jb;Uc=new Sys.UI.DomEvent(Uc);Sc={focusedAddinId:a.Yua(Sc.el,Cc.$)};ue=new md.a(1461300262,1,Cc.$.gd,6,null);kc.g(Cc.$).hIb(Uc,ue,Sc)}else if(Uc===OSF.AgaveHostAction.Select)Cc.k6e(!0);else if(Uc===OSF.AgaveHostAction.UnSelect)Cc.k6e(!1);else if(Uc===OSF.AgaveHostAction.CancelDialog)Cc.kK(-684355545,null);else if(Uc===OSF.AgaveHostAction.InsertAgave)Sc=
{},ae&&(Sc[Ya.a.SYa]=ae,Sc[ra.a.Ug]=a.lrb(ae),Cc.kK(-741808261,Sc));else if(Uc===OSF.AgaveHostAction.InsertDevManifest)Sc={},ae&&(Sc[Ya.a.SYa]=ae,Sc[ra.a.Ug]=a.lrb(ae),Cc.kK(-741808261,Sc));else if(Uc===OSF.AgaveHostAction.InsertDevManifestError)Sc=Object(lc.a)(Object,ae),Uc={},Sc=(Uc[Ya.a.MVc]=Cc.Pm.getDevManifestInvalidUrlErrorString(Sc.manifestUrl),Uc),Cc.kK(-2025863019,Sc);else if(Uc===OSF.AgaveHostAction.NotifyHostError)Sc={},Sc=(Sc[Ya.a.MVc]=Cc.Pm.getManifestInvaildErrorString(),Sc),Cc.kK(-2025863019,
Sc);else if(Uc===OSF.AgaveHostAction.RefreshAddinCommands)lb.EwaSettings.la(54)&&Cc.kK(Ae.a.refreshAddinCommands,null);else if(Uc===OSF.AgaveHostAction.CtrlF6Exit||Uc===OSF.AgaveHostAction.CtrlF6ExitShift){if(ue=Cc.$.da.Aa(15)){(Sc=Cc.cn(Sc).oha)&&Sc.Fyc();Cb.a.Df&&document.activeElement.blur();var Lf={keyCode:117,type:"keydown",ctrlKey:!0};Lf.shiftKey=Uc===OSF.AgaveHostAction.CtrlF6ExitShift;Lf.srcElement=Object(Oa.a)(233,Sc)?Sc.WFa:kc.g(Cc.$).Jb;Sc=new Sys.UI.DomEvent(Lf);ue.nW(Sc)}}else if(Uc===
OSF.AgaveHostAction.PageIsReady){if((Sc=Cc.cn(Sc).oha)&&Sc.ZYa===OSF.OsfControlTarget.TaskPane&&(Sc=Cc.$.da.Aa(183))&&Cc.Ff)for(Uc=Lb.a.Kd(Cc.$),ue=yl(Cc.Ff),Lf=ue.next();!Lf.done;Lf=ue.next())a.$La(Lf.value.zU)&&(Uc?Sc.Ne(!0,!1):Sc.setFocusOnToolbarFirstElement())}else if(Uc===OSF.AgaveHostAction.TabExit){Uc=Cc.cn(Sc);var xf=Uc.oha;if(xf)if(xf.ZYa===OSF.OsfControlTarget.InContent)xf.Rjf();else{if(xf.ZYa===OSF.OsfControlTarget.TaskPane)if(Lb.a.Kd(Cc.$))Cb.a.Df&&document.activeElement.blur(),tb.UISurfaces.Gk().then(function(Oc){var Ed=
Object(Oa.a)(233,xf)?xf:null;Ed?Ed.isResizable?Oc.focusResizeHandle():Oc.focusTabbedTaskPaneArea():Oc.focusTabbedTaskPaneArea();return null});else if(Sc=Cc.$.da.Aa(183))Cb.a.Df&&document.activeElement.blur(),(Uc=document.getElementById(Cc.$.Ib+Jb.a.Ylc))&&jd.DOMElementExtensions.isVisible(Uc)?jd.DOMElementExtensions.setFocus(Uc):Sc.setFocusOnToolbarFirstElement()}else Uc&&4===Uc.osfControlType&&Cc.Pm.notifyAgave(Sc,OSF.AgaveHostAction.TabIn)}else if(Uc===OSF.AgaveHostAction.TabExitShift)(Uc=Cc.cn(Sc),
ue=Uc.oha)?ue.ZYa===OSF.OsfControlTarget.InContent?ue.Sjf():ue.ZYa===OSF.OsfControlTarget.TaskPane&&(Sc=Object(Oa.a)(233,ue)?ue:null)&&(Cb.a.Df&&document.activeElement.blur(),Sc.XZf()):Uc&&4===Uc.osfControlType&&Cc.Pm.notifyAgave(Sc,OSF.AgaveHostAction.TabIn);else if(Uc===OSF.AgaveHostAction.EscExit||Uc===OSF.AgaveHostAction.ExitNoFocusable||Uc===OSF.AgaveHostAction.ExitNoFocusableShift)if(ue=Cc.cn(Sc).oha)ue.Fyc();else{if(Uc===OSF.AgaveHostAction.EscExit){Uc=null;ue=yl(fa.E1h());for(Lf=ue.next();!Lf.done;Lf=
ue.next())if(Lf=Lf.value,Lf.value.Ue===Sc){Lf.value.dialog.hide();Uc=Lf.key;break}Uc&&(Sc=Cc.cn(Uc))&&4!==Sc.osfControlType&&Cc.Ji.notifyAgave(Uc,OSF.AgaveHostAction.TabIn)}}else if(Uc===OSF.AgaveHostAction.InstallCustomFunctions)if(lb.EwaSettings.la(122)){Vd.a(Cc.$).GVe(function(){return!1});var Rf=Cc.$.da;sa.TaskExtensions.Ba(Gc.GetServiceTaskFactory.Wa(Rf,278,279,1),function(Oc){Oc=Oc.result;Rf.Aa(278)||Rf.Ha(278,Oc);var Ed=ae.osfControl.getStoreType();Oc.Cbf(ae.osfControl.getSolutionId(),Ed,a.$Nh(ae.osfControl),
ae).hna()},Cc.ma,3)}else Ja.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");else if(Uc===OSF.AgaveHostAction.UninstallCustomFunctions)if(lb.EwaSettings.la(122)){Vd.a(Cc.$).GVe(function(){return!1});var dc=Cc.$.da;sa.TaskExtensions.Ba(Gc.GetServiceTaskFactory.Wa(dc,278,279,1),function(Oc){Oc=Oc.result;dc.Aa(278)||dc.Ha(278,Oc);Oc.Tbg(ae.solutionId,ae.storeType).hna()},Cc.ma,3)}else Ja.ULS.sendTraceTag(537170574,0,10,
"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else Uc===OSF.AgaveHostAction.SendTelemetryEvent?e(ae):Uc===OSF.AgaveHostAction.SendCustomerContent?c(ae):Uc===OSF.AgaveHostAction.LaunchExtensionComponent?jb.a.instance.Mri(ae):Uc===OSF.AgaveHostAction.RefreshRibbonGallery?(Sc=Cc.$.da.Aa(352))&&Sc.Ucc(ae):Uc===OSF.AgaveHostAction.RemoveAppCommandsAddin?(Cc.Xaj(ae.assetId),Lb.a.Kd(Cc.$)||(Sc=Cc.$.da.Aa(183))&&Sc.rp()):Uc===OSF.AgaveHostAction.GetOriginalControlId&&
(Sc=new ib.a(Cc.$.Ib,ae.ownerAssetId,new cc.a,!0),ae.originalControlId=Sc?Sc.nGe(ae.controlId):ae.controlId)};Cc.sVi=function(){Cc.$.pa&&Zd.p(Cc.$.pa)&&Cc.$.da.Aa(34).Vld()};Cc.rd=function(){Cc.Rlf()};Cc.ZR=function(Sc,Uc){var ae,ue;1===Uc.Bw&&(Sc=Uc.Pg)&&(Uc=new n(Ac.toTimestamp(Sc.enqueueUtcTime),Ac.toTimestamp(Sc.processUtcTime),Ac.toTimestamp(Sc.dequeueUtcTime),Ac.getElapsedMilliseconds(Sc.enqueueUtcTime,Sc.processUtcTime),Ac.getElapsedMilliseconds(Sc.processUtcTime,Sc.dequeueUtcTime),Sc.operationCount,
(null===(ue=null===(ae=Sc.operation)||void 0===ae?void 0:ae.ud)||void 0===ue?0:ue.ServerCorrelationId)?Sc.operation.ud.ServerCorrelationId:null,Sc.operation?Enum.toString(Qd.a,Sc.operation.operationName):null,Wc.a.kF(Ac.getElapsedMilliseconds(Sc.enqueueUtcTime,Bd.a.Ra.Kb))),ae=Sys.Serialization.JavaScriptSerializer.serialize(Uc),Ja.ULS.sendTraceTag(50872916,0,50,ae))};Cc.$c=function(Sc,Uc){!Cc.ea.qc&&of.a(Uc)?(Array.forEach(Cc.Ff,Cc.Swf),Array.clear(Cc.Ff),Cc.DOb=!1):(Uc.FH&&(Ja.ULS.sendTraceTag(537170516,
0,50,"Silent Reload require reset osf controls."),Cc.NTf()),Cc.nL(),lb.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&(Cc.DOb=!1))};Cc.Hq=function(){lb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Ja.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),Cc.NTf());Cc.nL();lb.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Cc.DOb=!1)};
Cc.Swf=function(Sc){Sc.Nmc();Cc.raiseEvent("cd",Sc.controlId)};Cc.vb=nb;Cc.gWc=Hc;Cc.initialize();T.ja(Cc);Cc.LUf=0;(nb=(nb=!(Cb.a.Xp||Cb.a.Uwa))&&(!lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||!Cb.a.Df))&&OfficeExt.ShortcutKeyDispatchManager.init();Cc.Kqg={};return Cc}function c(nb){Tc.a.sendOtelCustomerContent(Object.assign(new Yc.a,{otelEvent:nb}))}function e(nb){Tc.a.sendOtelEvent(Object.assign(new Yc.a,{otelEvent:nb}))}function l(nb,Hc,Cc){var Sc=
ge.call(this,Cc,nb)||this;Sc.hashCode=null;Sc.Hva=null;Sc.j3b=!1;Sc.Fm=function(Uc,ae){ae.dd.hash===Sc.hashCode&&Sc.Hva&&Object(lc.a)(b(862).DdaFacade,Sc.$.da.Aa(35)).uBj(Sc.Hva.InstanceId)};Sc.Re=function(Uc,ae){switch(ae.dd.block.state){case 1:case 3:case 5:Sc.Dna(ae)}};Sc.Jg=function(){Sc.aGb(!0)};Sc.xo=function(Uc,ae){Sc.isVisible&&Sc.CTa(ae.mI);Sc.clearCache()};Sc.Qe=function(Uc,ae){Sc.FSa(ae.pa,!!ae.mI)};Sc.WN=function(){Sc.$.ea.oma()};Sc.lUa=Hc;Sc.domElement.classList.add(be.a.t8b);Sc.domElement.classList.add(sd.a.Tk);
Cc.tabIndex=0;Sc.FSa(Sc.$.pa,!1);Sc.wc.ja("mousedown",Sc.WN);Sc.wc.ja("contextmenu",function(Uc){kd.g(Uc)});Sc.$.xa.yJ(Sc.xo);Sc.$.zb.yJ(Sc.xo);Sc.$.zb.Qf(Sc.Qe);Sc.$.xa.Qf(Sc.Qe);Sc.Ca.sq(Sc.Re);Sc.Ca.KG(Sc.Fm);Sc.Ca.Fp(Sc.Jg);lb.EwaSettings.sc()&&Sc.ar(Sc.sya);return Sc}function n(nb,Hc,Cc,Sc,Uc,ae,ue,Lf,xf){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;
this.IsDocumentHidden=!1;this.enqueueUtcTime=nb;this.processUtcTime=Hc;this.dequeueUtcTime=Cc;this.inQueueDurationInMS=Sc;this.executionDurationInMS=Uc;this.operationCount=ae;this.ServerCorrelationId=ue;this.UserOperationName=Lf;this.IsDocumentHidden=xf}function m(nb,Hc,Cc){this.$=nb;this.gj=Hc;this.runtimeCalculationMode=Cc}function f(){}function x(nb,Hc,Cc){var Sc=this;this.lGf=null;this.hbd=function(Uc,ae){var ue=Ue.a.bX,Lf={};Lf.eventId=Uc;Lf.payload=ae;Sc.gj.$Z(2201,ue)&&Sc.ei.UM(2201,ue,Me.a.Kc(Lf))};
this.$=nb;this.gj=Hc;this.ei=Cc;this.Hbi()}function y(nb,Hc,Cc){var Sc=this;this.KGb=0;this.rhg=!0;this.Y9b=0;this.mqd=!0;this.Bye=function(){var Uc=document.hasFocus();if(Sc.rhg!==Uc){if(Uc){var ae=Me.a.Kc({});Sc.ei.UM(2203,Ue.a.bX,ae)}Sc.rhg=Uc}};this.Cye=function(Uc){(0<Uc.timeRemaining()||Uc.didTimeout)&&Sc.Bye();window.requestIdleCallback(Sc.Cye)};this.$=nb;this.gj=Hc;this.ei=Cc;window.requestIdleCallback||(this.mqd=!1)}function t(nb,Hc,Cc){var Sc=this;this.JGb=0;this.O$a=this.V$a=null;this.tFf=
function(){var Uc=kc.g(Sc.$).ha.Pa.pC;if(Uc)if(Sc.ajf(Uc)){var ae=Sc.Bja();Sc.jbd(ae);Sc.V$a=Uc.floatingObject.id;Sc.O$a=ae}else Sc.V$a&&(Sc.jbd(Sc.O$a),Sc.V$a=null,Sc.O$a=null);else Sc.V$a&&(Sc.jbd(Sc.O$a),Sc.V$a=null,Sc.O$a=null)};this.$=nb;this.gj=Hc;this.ei=Cc}function B(nb,Hc,Cc){var Sc=this;this.j2b=null;this.gic=!1;this.onPointerDown=function(Uc){var ae;Sc.jji?3===Uc.yb?(function(){var ue=Sc.gridView.Eub(Uc.clientPoint);ae=ue.TGa;return ue}(),Sc.gic=!!ae&&Sc.gridView.ha.va.o7c(ae)):Sc.gic=
!1:(function(){var ue=Sc.gridView.Eub(Uc.clientPoint);ae=ue.TGa;return ue}(),Sc.gic=3===Uc.yb&&!!ae&&Sc.gridView.ha.va.o7c(ae));Sc.j2b=Uc.clientPoint;return!1};this.Zc=function(Uc){if(Sc.gridView.inRangePicker||Sc.gridView.Ci||Sc.gic||Uc.shiftKey||Uc.ctrlKey||Uc.Ea.button!==Sys.UI.MouseButton.leftButton||!Sc.j2b||!Uc.clientPoint||Uc.clientPoint.x!==Sc.j2b.x||Uc.clientPoint.y!==Sc.j2b.y)return!1;var ae=Sc.gridView.Eub(Uc.clientPoint);Uc=ae.TGa;ae=ae.returnValue;var ue=Object(lc.a)(se.a,Sc.$.xa.pa);
if(ae&&ue&&0===ue.AI){if(!Sc.gridView.ha.va.s4.contains(Uc))return!1;Uc=new z(ue,Uc,Zc.HelperMethods.HDd(ae.x),Zc.HelperMethods.HDd(ae.y));Sc.OVi(Uc)}return!1};this.$=nb;this.gridView=kc.g(nb);this.gj=Hc;this.ei=Cc;this.jji=lb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GetCellOffSetPointFromEventPointOptimization",!1);this.v$i()}function z(nb,Hc,Cc,Sc){var Uc=Wd.call(this)||this;Uc.sheet=nb;Uc.QVg=Hc;Uc.offsetX=Cc;Uc.offsetY=Sc;return Uc}function u(nb,Hc,Cc){var Sc=this;this.dPf=this.cPf=
this.ePf=this.bPf=0;this.KVi=function(Uc,ae){Uc=Object(lc.a)(se.a,ae.pa);Sc.p7a(Uc)&&(ae={},ae.worksheetId=Uc.sheetId,ae=Me.a.Kc(ae),Sc.fja(11,Uc.sheetId,ae))};this.NVi=function(Uc,ae){Uc=Object(lc.a)(se.a,ae.mI);Sc.p7a(Uc)&&(ae={},ae.worksheetId=Uc.sheetId,ae=Me.a.Kc(ae),Sc.fja(12,Uc.sheetId,ae))};this.LVi=function(Uc,ae){Uc=Object(lc.a)(se.a,ae.pa);Sc.p7a(Uc)&&(ae={},ae.worksheetId=Uc.sheetId,Uc=Me.a.Kc(ae),Sc.fja(11,null,Uc,!0))};this.MVi=function(Uc,ae){Uc=Object(lc.a)(se.a,ae.mI);Sc.p7a(Uc)&&
(ae={},ae.worksheetId=Uc.sheetId,Uc=Me.a.Kc(ae),Sc.fja(12,null,Uc,!0))};this.$=nb;this.gj=Hc;this.ei=Cc}function C(nb,Hc,Cc){var Sc=this;this.lQa=this.kQa=0;this.EGa=this.Iha=null;this.iyf=function(){var Uc=kc.g(Sc.$).ha.Pa.pC;if(0<Sc.lQa&&Sc.Iha&&Sc.EGa){var ae={};ae.shapeId=Sc.Iha;ae.worksheetId=Sc.EGa;ae=Me.a.Kc(ae);Sc.fireEvent(2102,Sc.Iha,ae)}Sc.vni(Uc)?(Sc.Iha=Sc.wOj(Uc),Sc.EGa=Sc.Bja(),Sc.Iha&&Sc.EGa)?0<Sc.kQa&&(Uc={},Uc.shapeId=Sc.Iha,Uc.worksheetId=Sc.EGa,Uc=Me.a.Kc(Uc),Sc.fireEvent(2101,
Sc.Iha,Uc)):Ja.ULS.sendTraceTag(537170458,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",Sc.Iha,Sc.EGa):(Sc.Iha=null,Sc.EGa=null)};this.$=nb;this.gj=Hc;this.ei=Cc}function r(nb,Hc,Cc){nb=J.call(this,nb,Hc,Cc)||this;nb.nkf=null;nb.mkf=null;return nb}function J(nb,Hc,Cc){var Sc=bc.call(this)||this;Sc.Iza=0;Sc.SU=0;Sc.nd=function(Uc,ae){if(Sc.enabled&&!(Sc.rff()||null!==ae&&void 0!==ae&&ae.Bif)&&(Uc=Object(lc.a)(se.a,Sc.$.xa.pa))&&
0===Uc.AI){var ue=Uc.sheetId,Lf=Sc.qZe(),xf=null,Rf=null;Sc.gj.qif()&&(xf=Sc.grid.Rb.Xj(Sc.grid.ha.va.activeCell),Rf=ue in Sc.Tic?Sc.Tic[ue]:null);Sc.ise(ue,Lf)&&sa.TaskExtensions.Ba(Ke.Task.Ta(!0),function(){Sc.U5h(ue,Lf);Sc.E5h(ue,Lf,xf,Rf)},Sc.ma);Sc.yJe(ue,Lf,xf)}};Sc.$=nb;Sc.gj=Hc;Sc.ei=Cc;Sc.grid=kc.g(nb);Sc.gNa={};Sc.Tic={};return Sc}function v(nb,Hc,Cc){var Sc=this;this.$Of=this.ZOf=0;this.jKb=this.Y$a=null;this.oIi=function(){var Uc=kc.g(Sc.$).ha.Pa.pC;if(Sc.snd(Uc)&&(Uc=Sc.dac(Uc))){var ae=
{chartId:Uc};ae.worksheetId=Sc.Bja();ae=Me.a.Kc(ae);Sc.fja(51,Uc,ae);Sc.fja(51,Sc.Bja(),ae)}};this.pIi=function(){if(Sc.Y$a){var Uc={};Uc.chartId=Sc.Y$a;Uc.worksheetId=Sc.jKb;Uc=Me.a.Kc(Uc);Sc.fja(52,Sc.Y$a,Uc);Sc.fja(52,Sc.jKb,Uc)}Uc=kc.g(Sc.$).ha.Pa.pC;Sc.snd(Uc)?(Sc.Y$a=Sc.dac(Uc),Sc.jKb=Sc.Bja()):(Sc.Y$a=null,Sc.jKb=null)};this.$=nb;this.gj=Hc;this.ei=Cc}function D(){this.VYa={}}function V(nb,Hc,Cc,Sc){Sc=void 0===Sc?!1:Sc;var Uc=Ad.call(this)||this;Uc.jcb=0;Uc.xE=null;Uc.fwa=!1;Uc.uqc=null;Uc.SU=
0;Uc.$1d=null;Uc.bHc=null;Uc.tVa=null;Uc.l5b=null;Uc.S9d=!1;Uc.l_d=null;Uc.Cda=null;Uc.hOc=null;Uc.nd=function(){Uc.enabled&&(Uc.Foj(),Uc.uqc=Kb.d(kc.g(Uc.$).ha.va.selectedRanges))};Uc.v6e=function(ae){ae.controlId===Uc.Nd.InstanceId&&Array.forEach(Uc.xE,function(ue){ue.szi(ae)&&ue.Z0b(ae)})};Uc.Huf=function(ae){if((ae=Object(lc.a)(233,ae))&&!ae.Wp())if(!Uc.Nd||OSF.OsfControl.isFirstPartyStoreString(Uc.Nd.PrimaryMarketplace.MarketplaceType)||Uc.$.lha){ae.hf=Uc.Nd;ae.xh=Uc.$g;Uc.l_d=ae;Uc.hwc(ae.WFa);
var ue=lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Lb.a.Kd(Uc.$)&&Zc.HelperMethods.iw(Uc.Nd)&&Uc.Nd.Preload&&!Uc.Nd.TaskpaneVisible;ue?ae.IAd():lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(ae.IAd(),(Uc.Nd.SharedRuntime&&1===Uc.Nd.SharedRuntime.LifeTime||Uc.Nd.SharedRuntimeId)&&!Uc.Nd.TaskpaneVisible&&ae.Nf(!1)):((Uc.Nd.SharedRuntime&&1===Uc.Nd.SharedRuntime.LifeTime||Uc.Nd.SharedRuntimeId)&&!Uc.Nd.TaskpaneVisible&&
ae.Nf(!1),ae.IAd());Uc.O5a||(Lb.a.Kd(Uc.$)?ue||ae.aS():Hb.a(Uc.$).result.oD(ae,!0));Uc.$.da.Aa(77).sQf(Uc.Huf);Uc.oha=Object(lc.a)(255,ae)}else Ja.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};Uc.onFloatingObjectControlAdded=function(ae,ue){3===ue.control.floatingObject.type&&ue.control.floatingObject.el.InstanceId===Uc.m1.WebExtensionId&&(Uc.oha=Object(lc.a)(255,ue.control),Uc.hwc(ue.control.Rd.firstChild),Qb.a(Uc.$).jHb(Uc.onFloatingObjectControlAdded))};Uc.vb=nb.$;
Uc.$g=nb;Uc.Nd=Cc;Uc.Nd.InstanceId=Cc.SrcLocationOverrideResourceId?nb.SJa(Cc.InstanceId,Cc.SrcLocationOverrideResourceId):Cc.InstanceId;Uc.ei=Hc;Uc.m1={};Uc.m1.WebExtensionId=Cc.InstanceId;Uc.kGf="osfControl_"+Cc.InstanceId;Uc.R6c="disabled_"+Cc.InstanceId;Uc.m1.BindingData=Cc.BindingData;Uc.O5a=Uc.$g.O5a(Cc.InstanceId);Uc.gfc=Uc.$g.gfc(Cc.InstanceId);Uc.nde=Cc.WebExtensionOsfControlType;Uc.sJf=Sc;return Uc}function U(){}function Q(nb,Hc,Cc,Sc,Uc,ae,ue,Lf){nb=Sb.call(this,nb,Hc,Cc)||this;nb.startRow=
0;nb.startColumn=0;nb.rowCount=0;nb.columnCount=0;nb.startColumn=ae-Sc.Reference.FirstColumn;nb.columnCount=Lf;ae=Math.max(Uc,Sc.Reference.FirstRow);Uc=Math.min(Uc+ue-1,Sc.Reference.LastRow);ae>Uc?nb.startRow=nb.rowCount=void 0:(nb.startRow=ae-Sc.Reference.FirstRow,nb.rowCount=Uc-ae+1);return nb}function la(nb){var Hc=this;this.xE=null;this.fwa=!1;this.nd=function(){Hc.xE.forEach(function(Cc){Cc.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Cc.Z0b(new Ia.a(Cc.eventId,"",null))})};
this.$g=nb}function ba(nb,Hc){this.HA=null;this.Afa=nb;this.rxg=Hc}function T(nb){var Hc=this;this.Ji=this.NWc=null;this.HPi=function(Cc,Sc){Hc.handlers.xb(Sc.controlId)&&(Cc=new S(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Sc.controlId,null,Sc.messageType,Sc.messageContent,Sc.messageOrigin,Sc.targetOrigin),Hc.handlers.oa(Sc.controlId)(Cc),Sc.messageType===OSF.DialogMessageType.DialogClosed&&Hc.handlers.remove(Sc.controlId))};this.GPi=function(Cc,Sc){Hc.$kc.xb(Sc.controlId)&&(Cc=new H(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,
Sc.controlId,null,Sc.messageType,Sc.messageContent,Sc.messageOrigin,Sc.targetOrigin),Hc.$kc.oa(Sc.controlId)(Cc))};this.handlers=new Dc.a;this.$kc=new Dc.a;this.$g=nb;this.r1a.nGg(this.HPi);this.r1a.mGg(this.GPi)}function H(nb,Hc,Cc,Sc,Uc,ae,ue){nb=Va.call(this,nb,Hc,Cc)||this;nb.messageType=0;nb.messageContent=null;nb.messageOrigin=null;nb.targetOrigin=null;nb.messageType=Sc;nb.messageContent=Uc;nb.messageOrigin=ae;nb.targetOrigin=ue;return nb}function S(nb,Hc,Cc,Sc,Uc,ae,ue){nb=bb.call(this,nb,
Hc,Cc)||this;nb.messageType=0;nb.messageContent=null;nb.messageOrigin=null;nb.targetOrigin=null;nb.messageType=Sc;nb.messageContent=Uc;nb.messageOrigin=ae;nb.targetOrigin=ue;return nb}function K(nb,Hc){var Cc=ta.call(this)||this;Cc.requests=[];Cc.s1b=!1;Cc.disposed=!1;Cc.Kg=function(){if(!Cc.disposed){Cc.grid.yc.Pn(Cc.Kg);Cc.s1b=!1;var Sc=Cc.requests;Cc.requests=[];Sc=yl(Sc);for(var Uc=Sc.next();!Uc.done;Uc=Sc.next())Uc=Uc.value,Cc.ddaFacade.kK(Uc.command,Uc.properties)}};Cc.ddaFacade=nb;Cc.grid=
Hc;return Cc}function da(){this.command=0;this.properties=null}function fa(nb){this.rb=new ma.a;this.Pm=nb}function X(nb,Hc,Cc,Sc,Uc){Cc=void 0===Cc?null:Cc;Sc=void 0===Sc?"":Sc;Uc=void 0===Uc?"":Uc;var ae=za.call(this)||this;ae.controlId=nb;ae.messageType=Hc;ae.messageContent=Cc;ae.messageOrigin=Sc;ae.targetOrigin=Uc;return ae}function ca(nb,Hc,Cc,Sc,Uc){Cc=void 0===Cc?null:Cc;Sc=void 0===Sc?"":Sc;Uc=void 0===Uc?"":Uc;var ae=ya.call(this)||this;ae.controlId=nb;ae.messageType=Hc;ae.messageContent=
Cc;ae.messageOrigin=Sc;ae.targetOrigin=Uc;return ae}function ja(){this.height=this.width=0;this.Ue=this.controlId=this.pageUrl=null;this.Hdc=this.X6c=!1}function ea(){}function qa(){this.dialog=this.Ue=null}function pa(nb,Hc,Cc){var Sc=eb.call(this)||this;Sc.x9=null;Sc.mSc="WACDialogTitleText";Sc.jVa="0";Sc.JQb="15px";Sc.bng="0px";Sc.iVa="calc(100% - 30px)";Sc.ang="100%";Sc.efe=0;Sc.rb=new ma.a;Sc.Kkg=new Ha;Sc.jc=5;Sc.UCa=Cc;Sc.Ue=Cc;Sc.xHc=nb;Sc.f5d=Hc;Sc.MHc=!!Ta.AFrameworkApplication.ga&&Ta.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");
return Sc}function Pa(){}function Ha(){}function Xa(nb,Hc){nb=Na.call(this,1,nb,Hc)||this;nb.kcf=OfficeExt.CommandInvokeMode.ExclusiveForNew;return nb}function Na(nb,Hc,Cc){this._id=nb;this.Ikg=Hc;this.Nmg=Cc;this.kcf=OfficeExt.CommandInvokeMode.Default}b.r(F);var db=b(0),Ja=b(13),jb=b(1283),hc=b(80),ma=b(93);Na.prototype.execute=function(nb,Hc,Cc){var Sc=this;Cc=Cc||{};Cc.commandMode=this.kcf;Hc.invokeAppCommand(this.UHg,this.A_g,Cc,function(){nb.SPi(Sc.id)})};Sk.Object.defineProperties(Na.prototype,
{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},UHg:{configurable:!0,enumerable:!0,get:function(){return this.Ikg}},A_g:{configurable:!0,enumerable:!0,get:function(){return this.Nmg}}});Object(db.a)(Na,"AddinNativeActionBase",null,[566]);vm(Xa,Na);Object(db.a)(Xa,"AddinTakeSnapshotAction",Na,[]);Ha.prototype.m4g=function(nb){return new Na(3,nb,this.GJh().getNativeActionName(3))};Ha.prototype.GJh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(db.a)(Ha,
"AddinNativeActionManager",null,[556]);var Ka=b(140);Pa.prototype.invokeAppCommand=function(nb,Hc,Cc,Sc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(nb,Hc,Cc,Sc)};Pa.getInstance=function(){Pa.Oa||(Pa.Oa=new Pa);return Pa.Oa};Pa.Oa=null;Object(db.a)(Pa,"OSFAddinCommandsRuntimeManager",null,[547]);var Ta=b(5),ob=b(172),Cb=b(23),eb=Ka.a;vm(pa,eb);pa.prototype.fGg=function(nb){this.rb.addHandler("OnDialogClosedEventKey",nb)};pa.prototype.Esj=function(){this.fEa=null};pa.prototype.gD=function(){eb.prototype.gD.call(this);
this.yp.style.width="100%";this.yp.style.height=this.jdc?this.iVa:this.ang;this.yp.style.marginTop=this.jdc?this.JQb:this.bng;this.yp.style.padding=this.jVa};pa.prototype.IO=function(){eb.prototype.IO.call(this);this.Lb.style.width=String.format("{0}px",this.xHc*window.innerWidth/100);this.Lb.style.height=String.format("{0}px",this.f5d*window.innerHeight/100);this.Lb.style.minWidth="0px";this.MHc&&Ta.AFrameworkApplication.isRtl&&100===this.xHc&&(this.Lb.style.right="0px",this.Lb.style.marginRight=
"0px");this.x9=document.getElementById(this.ri(this.mSc));this.x9.style.position="absolute";this.x9.style.whiteSpace="nowrap";this.x9.style.textOverflow="ellipsis";Ta.AFrameworkApplication.isRtl?(this.x9.style.right="14px",this.x9.style.left="44px"):(this.x9.style.right="44px",this.x9.style.left="14px")};pa.prototype.mv=function(nb){eb.prototype.mv.call(this,nb);this.x9&&this.x9.setAttribute("title",nb)};pa.prototype.XKd=function(){this.Lb.style.width=String.format("{0}px",this.xHc*window.innerWidth/
100);this.Lb.style.height=String.format("{0}px",this.f5d*window.innerHeight/100);this.Lb.style.overflowY="hidden";this.Lb.style.overflowX="hidden";this.Lb.style.marginTop="";this.Lb.style.top="";Cb.a.oR&&Ta.AFrameworkApplication.isRtl?(this.Lb.style.right="",this.Lb.style.marginRight=""):(this.Lb.style.left="",this.Lb.style.marginLeft="")};pa.prototype.hide=function(){var nb=this;this.Kkg.m4g(this.UCa).execute(this,Pa.getInstance(),{});this.efe=window.setTimeout(function(){nb.rb.raiseEvent("OnDialogClosedEventKey",
nb.UCa);ob.a.prototype.hide.call(nb)},500)};pa.prototype.SPi=function(nb){3===nb&&(window.clearTimeout(this.efe),this.rb.raiseEvent("OnDialogClosedEventKey",this.UCa),eb.prototype.hide.call(this))};Sk.Object.defineProperties(pa.prototype,{q1a:{configurable:!0,enumerable:!0,get:function(){return this.yp}}});Object(db.a)(pa,"AppsForOfficeDialog",Ka.a,[534,535]);Object(db.a)(qa,"DialogInfo",null,[]);ea.url="url";ea.height="height";ea.width="width";ea.X6c="displayInIframe";ea.Hdc="hideTitle";Object(db.a)(ea,
"DialogSettings",null,[]);Object(db.a)(ja,"DisplayDialogParams",null,[]);var ya=Sys.EventArgs;vm(ca,ya);Object(db.a)(ca,"OnMessageDialogEventArgs",Sys.EventArgs,[]);var za=Sys.EventArgs;vm(X,za);Object(db.a)(X,"OnMessageParentEventArgs",Sys.EventArgs,[]);var Ga=b(40),cb=b(29),Mb=b(178),Dc=b(100);fa.prototype.nGg=function(nb){this.rb.addHandler("OnMessageParentEventKey",nb)};fa.prototype.mGg=function(nb){this.rb.addHandler("OnMessageDialogEventKey",nb)};fa.prototype.showDialog=function(nb,Hc,Cc,Sc){if(fa.m8.xb(Hc))Ja.ULS.sendTraceTag(18896285,
344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{var Uc=Ga.b(nb),ae=Uc[ea.url];if(this.Pm.getOsfControl(Hc).checkAppDomains(ae)){var ue=new ja;ue.width=Uc[ea.width];ue.height=Uc[ea.height];ue.pageUrl=ae;ue.X6c=Uc[ea.X6c];ue.Hdc=Uc[ea.Hdc];ue.controlId=Hc;ue.Ue=Mb.a.create().toString();var Lf=new qa;Lf.Ue=ue.Ue;var xf=this.Pm.getOsfControl(ue.controlId).getManifest().getDefaultDisplayName(),Rf=this.Pm.getOsfControl(ue.controlId).getStoreType().toLowerCase();
nb=null;var dc=Ta.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.HideDialogTitleOption",!1);nb=(4===Ta.AFrameworkApplication.sa.Qa.Pj&&"hardcodedpreinstall"===Rf||dc&&"sdxcatalog"===Rf)&&ue.Hdc?this.createAndShowAppsForOfficeDialog(ue.width,ue.height,ue.Ue,!0,xf):this.createAndShowAppsForOfficeDialog(ue.width,ue.height,ue.Ue,!1,xf);var Oc=this.Pm.getOsfControl(ue.controlId),Ed=Oc.getManifest();dc={};dc.id=ue.Ue;dc.solutionId=Oc.getSolutionId();dc.version=Oc.getVersion();
dc.storeType=Rf;dc.storeId=Oc.getStoreId();dc.assetId=Oc.getAssetId();dc.assetStoreId=Oc.getAssetStoreId();dc.ownerAddinSolutionId=Oc.getOwnerAddinSolutionId();dc.ownerAddinStoreType=Oc.getOwnerAddinStoreType();dc.appDomains=Ed.getAppDomains();dc.dialogUrl=ae;dc.osfControlType=1;dc.marketplaceID=Ed.getMarketplaceID();dc.marketplaceVersion=Ed.getMarketplaceVersion();dc.store=Oc.getStoreLocator();dc.ownerAddinAssetId=Oc.getOwnerAddinAssetId();dc.agaveName=xf;dc.div=nb.q1a;Ja.ULS.sendTraceTag(542978531,
344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==dc.ownerAddinStoreType?dc.ownerAddinStoreType:dc.storeType,dc.storeId,dc.solutionId),cb.a.Qv(ue.pageUrl));this.Pm.insertDialogControl(dc);nb.fGg(Object(hc.a)(this,this.hKi,"onDialogClosed"));Lf.dialog=nb;fa.m8.ia(ue.controlId,Lf);Sc&&Sc(dc);Cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else Ja.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(Gd){Ja.ULS.sendTraceTag(18371104,
344,10,"ShowDialog: action failed. Exception message: {0}",Gd.message),Cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};fa.prototype.aBi=function(nb,Hc,Cc,Sc){Ta.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",!1)||""===Sc&&(Sc=Cc);try{var Uc=this.hva(nb);Uc&&this.rb.raiseEvent("OnMessageParentEventKey",new X(Uc,OSF.DialogMessageType.DialogMessageReceived,Hc,Cc,Sc))}catch(ae){return Ja.ULS.sendTraceTag(555238219,344,10,
"MessageParentOrigin: action failed. Exception message: {0}",ae.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};fa.prototype.h1c=function(nb,Hc){if(fa.m8.xb(nb))try{var Cc=fa.m8.oa(nb);Cc.dialog&&Cc.dialog.hide();this.Pm.purgeDialogControl(Cc.Ue);fa.m8.remove(nb);Hc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Sc){Ja.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Sc.message),Hc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else Ja.ULS.sendTraceTag(18896286,
344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),Hc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};fa.prototype.voj=function(nb,Hc,Cc,Sc){Ta.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",!1)||""===Sc&&(Sc=Cc);if(fa.m8.xb(nb)&&(nb=fa.m8.oa(nb),nb.dialog))try{this.rb.raiseEvent("OnMessageDialogEventKey",new ca(nb.Ue,OSF.DialogMessageType.DialogParentMessageReceived,Hc,Cc,Sc))}catch(Uc){Ja.ULS.sendTraceTag(555045763,
344,10,"SendMessageOrigin: action failed. Exception message: {0}",Uc.message)}};fa.prototype.hva=function(nb){for(var Hc=null,Cc=yl(fa.m8),Sc=Cc.next();!Sc.done;Sc=Cc.next())if(Sc=Sc.value,Sc.value.Ue===nb){Hc=Sc.key;break}return Hc};fa.prototype.hKi=function(nb,Hc){if(nb=this.hva(Hc))this.Pm.purgeDialogControl(Hc),fa.m8.remove(nb),this.rb.raiseEvent("OnMessageParentEventKey",new X(nb,OSF.DialogMessageType.DialogClosed,null,null,"*"))};fa.prototype.createAndShowAppsForOfficeDialog=function(nb,Hc,
Cc,Sc,Uc){nb=new pa(nb,Hc,Cc);Uc=Sc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,Uc);Sc&&(nb.jdc=!1,nb.Su=!1);nb.initializeAndShow(Uc,null,null);nb.Esj();return nb};fa.E1h=function(){return fa.m8};fa.getInstance=function(nb){fa.Oa||(fa.Oa=new fa(nb));return fa.Oa};fa.Oa=null;fa.m8=new Dc.a;Object(db.a)(fa,"AppsForOfficeDialogManager",null,[518]);var vb=b(985),ib=b(1294),ub=b(1365),Eb=b(1065),Ya=b(845),tb=b(188),ec=b(1296),Za=b(142),mb=b(86),sc=b(88),pd=b(686),$b=b(574),Xb=b(805),
lc=b(84),Oa=b(411),pb=b(139),Ub=b(184),ic=b(36),Jb=b(4),cc=b(949),Ob=b(1243),P=b(74);Object(db.a)(da,"DdaRequestInfo",null,[]);var Ba=b(859),ra=b(77),ta=P.a;vm(K,ta);K.prototype.Ych=function(nb,Hc){this.disposed||(this.s1b||(this.grid.yc.Mo(this.Kg),this.s1b=!0),this.requests.push(Object.assign(new da,{command:nb,properties:Hc})))};K.prototype.dispose=function(){if(!this.disposed){this.disposed=!0;this.s1b&&this.grid.yc.Pn(this.Kg);var nb=this.requests;this.requests=null;nb=yl(nb);for(var Hc=nb.next();!Hc.done;Hc=
nb.next())Hc=Hc.value,(Hc=Hc.properties?Hc.properties[ra.a.G3]:null)&&this.ddaFacade.yf(Ba.a.Xxb,Hc);this.ddaFacade=this.grid=null;ta.prototype.dispose.call(this)}};K.D_g=function(nb,Hc){var Cc=!1;974713501===nb&&(Hc=(nb=Hc?Hc[ra.a.Ug]:null)?nb.DdaMethod:null)&&Hc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&(Cc=nb.ArrayData,Cc=!!Cc&&64===(Cc[6]&64));return Cc};Object(db.a)(K,"DdaCellEditDelayRequestHandler",P.a,[]);var Ia=b(894),bb=Ia.a;vm(S,bb);Object(db.a)(S,"DialogMessageReceivedEventArgs",
Ia.a,[]);var Va=Ia.a;vm(H,Va);Object(db.a)(H,"DialogParentMessageReceivedEventArgs",Ia.a,[]);var lb=b(1);T.prototype.addHandler=function(nb,Hc,Cc,Sc){var Uc=this;if(lb.EwaSettings.la(24))this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Cc);else{Ja.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");var ae=function(ue){ue===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?(Uc.handlers.ia(nb,Hc),Uc.$g.Ou(Cc)):(Ja.ULS.sendTraceTag(537170501,0,
10,"DialogMessageReceivedEventManager.AddHandler failed!"),Uc.$g.yf(ue,Cc))};this.handlers.xb(nb)?ae(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(nb,Sc,ae)}};T.prototype.NBg=function(nb,Hc,Cc){lb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Cc):(Ja.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),this.$kc.ia(nb,Hc),this.$g.Ou(Cc))};T.prototype.removeHandler=function(nb,Hc){var Cc=
this;lb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Hc):this.handlers.xb(nb)?(Ja.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.r1a.h1c(nb,function(Sc){Cc.handlers.remove(nb);Sc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?Cc.$g.Ou(Hc):(Ja.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),Cc.$g.yf(Sc,Hc))})):this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,
Hc)};T.prototype.Raj=function(nb,Hc){lb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Hc):(Ja.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.$kc.remove(nb),this.$g.Ou(Hc))};T.prototype.showDialog=function(nb,Hc,Cc){var Sc=this;try{this.r1a.showDialog(Hc,nb,Cc,function(Uc){Sc.$g.eCg(Sc.oSg(Uc))})}catch(Uc){Ja.ULS.sendTraceTag(537170496,0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",
Uc.message),Cc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};T.prototype.oSg=function(nb){var Hc={};Hc.InstanceId=nb.id;Hc.WebExtensionType=nb.osfControlType===OSF.OsfControlTarget.InContent?0:1;Hc.PrimaryMarketplace={};Hc.PrimaryMarketplace.SolutionId=nb.solutionId;Hc.PrimaryMarketplace.SolutionVersion=nb.version;Hc.PrimaryMarketplace.MarketplaceRef=nb.storeId;Hc.PrimaryMarketplace.MarketplaceType=nb.storeType;return Hc};T.ja=function(nb){if(!nb.$.da.Aa(232)){var Hc=new T(nb);nb.$.da.Ha(232,
Hc)}};Sk.Object.defineProperties(T.prototype,{r1a:{configurable:!0,enumerable:!0,get:function(){this.NWc||(this.NWc=fa.getInstance(this.contextActivationMgr));return this.NWc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.Ji&&this.$g&&(this.Ji=this.$g.Ji);return this.Ji}}});Object(db.a)(T,"DialogMessageReceivedEventManager",null,[505]);ba.prototype.XYb=function(nb){nb&&(this.HA||(this.HA=[]),Array.add(this.HA,nb))};ba.prototype.Hsc=function(nb){this.HA&&Array.remove(this.HA,
nb)};ba.prototype.szi=function(nb){return this.eventId!==nb.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===nb.ddaBinding.Name:!0};ba.prototype.Z0b=function(nb){this.HA&&Array.forEach(this.HA,function(Hc){Hc(nb)})};ba.prototype.Qma=function(){this.HA=[]};Sk.Object.defineProperties(ba.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Afa}},targetId:{configurable:!0,
enumerable:!0,get:function(){return this.rxg}},v6h:{configurable:!0,enumerable:!0,get:function(){return 0<this.HA.length}}});Object(db.a)(ba,"DdaEventRegistration",null,[]);var kc=b(20);la.prototype.invokeDdaMethod=function(nb,Hc){var Cc={};Cc[ra.a.Ug]=nb;Cc[ra.a.G3]=Hc;this.$g.kK(974713501,Cc)};la.prototype.registerDdaEventAsync=function(nb,Hc,Cc,Sc,Uc){la.Cyb(nb)?(la.Knd(nb)&&this.okd(),this.xE||(this.xE=[]),Hc=this.utb(nb,Cc),Hc||(Hc=new ba(nb,Cc),Array.add(this.xE,Hc)),Hc.XYb(Sc),this.$g.Ou(Uc)):
this.$g.yf(-1,Uc)};la.prototype.unregisterDdaEventAsync=function(nb,Hc,Cc,Sc,Uc){la.Cyb(nb)?((nb=this.utb(nb,Cc))&&nb.Hsc(Sc),this.$g.Ou(Uc)):this.$g.yf(-1,Uc)};la.prototype.okd=function(){this.fwa||(kc.g(this.$g.$).ha.NG(this.nd),this.fwa=!0)};la.prototype.utb=function(nb,Hc){if(!this.xE)return null;for(var Cc=0;Cc<this.xE.length;Cc++){var Sc=this.xE[Cc];if(Sc.eventId===nb&&Sc.targetId===Hc)return Sc}return null};la.Cyb=function(nb){return nb===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};
la.Knd=function(nb){return nb===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Object(db.a)(la,"EmbeddingPage",null,[419]);var zb=b(194),Sb=Ia.a;vm(Q,Sb);Q.prototype.getStartRow=function(){return this.startRow};Q.prototype.getStartColumn=function(){return this.startColumn};Q.prototype.getRowCount=function(){return this.rowCount};Q.prototype.getColumnCount=function(){return this.columnCount};Object(db.a)(Q,"DdaBindingSelectionEventArgs",Ia.a,[]);var gb=b(187),Sa=b(24),Kb=b(43),Gc=b(56),Hb=
b(412),Lb=b(39),sa=b(35),Ua=b(587),Yb=b(106),jc=b(53),md=b(92),jd=b(11),Zc=b(9),Qb=b(102);U.nuh="ewa-wx-disabled-div";U.muh="ewa-wx-container-div";U.SOe="ewa-ptp-nov2-flex";Object(db.a)(U,"CssClassNames",null,[]);var fd=U.nuh,xd=U.muh,Ad=zb.a;vm(V,Ad);V.prototype.dci=function(nb){this.Cda||(this.Cda=nb)};V.prototype.cQf=function(){this.Cda&&(this.Cda.dispose(),this.Cda=null)};V.prototype.Gld=function(){var nb=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.Nd.PrimaryMarketplace.MarketplaceType)&&
lb.EwaSettings.la(187)){var Hc=Gc.GetServiceTaskFactory.Wa(this.$.da,5,4,0);sa.TaskExtensions.Ba(Hc,function(){Hc.result.ig(35,null)},this.ma,3);return this}if(1===this.Nd.WebExtensionType)sa.TaskExtensions.Ba(Hb.a(this.$),function(Uc){Uc.result.Zqb(nb.$.da,77,6,nb.Huf,1)},this.ma,3);else{var Cc=this.$Te(),Sc=Qb.a(this.$);Cc||(Cc={Type:3},Cc.Id=this.m1.WebExtensionId,Cc.WebExtensionData=this.Nd,Cc.ContentHtml="<div/>",Cc.Version=0,Cc.AbsoluteLeft=0,Cc.AbsoluteTop=0,Cc.AbsoluteRight=0,Cc.AbsoluteBottom=
0,Cc.Width=0,Cc.Height=0,Cc.ZOrder=0,Cc.OriginDeltaX=0,Cc.OriginDeltaY=0,Cc=new gb.a(Cc),Sc.Q3b(Cc,null),Cc=Sc.Up(Cc.Hg()));Cc?(this.hwc(Cc.Rd.firstChild),this.oha=Object(lc.a)(255,Cc)):Sc.rnb(this.onFloatingObjectControlAdded)}return this};V.prototype.Caf=function(nb){this.hwc(nb);return this};V.prototype.Nmc=function(){this.sJf||this.$g.Ji.purgeOsfControl(this.controlId,!1);this.Qbg(!0);var nb=this.$Te();nb&&Qb.a(this.$).deleteFloatingObject(nb);this.$g.gj.Aaj(this.controlId);this.$g.gj.BLe(this.controlId,
!0);this.hOc=null};V.prototype.ZAd=function(nb){this.m1=nb};V.prototype.invokeDdaMethod=function(nb,Hc){if(lb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Cc={};Cc[ra.a.Ug]=nb;Cc[ra.a.G3]=Hc;this.$g.kK(974713501,Cc)}else this.$g.yf(Ba.a.Xxb,Hc)};V.prototype.Z8i=function(nb,Hc,Cc,Sc){if(lb.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!V.Ehh(nb)||void 0!==Hc&&null!==Hc&&void 0!==this.E2a(Hc)&&null!==this.E2a(Hc))if(Ja.ULS.sendTraceTag(36444195,
0,50,"eventId: {0}, targetId: {1}",nb,Hc),V.Jdf(nb)&&this.k8h(),V.Knd(nb)&&this.okd(),V.Hdf(nb))lb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Sc):this.$g.$.da.Aa(232).addHandler(this.controlId,Cc,Sc,Hc);else if(V.Idf(nb))lb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Sc):this.$g.$.da.Aa(232).NBg(this.controlId,Cc,Sc);else{V.Gdf(nb)&&this.x6e(-1777565636,Sc);this.xE||(this.xE=[]);var Uc=this.utb(nb,Hc);
Uc||(Uc=new ba(nb,Hc),Array.add(this.xE,Uc));Uc.Qma();Uc.XYb(Cc);this.$g.Ou(Sc);nb===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.tVa&&(this.l5b=Cc)}else this.$g.yf(3002,Sc);else this.$g.yf(-1,Sc)};V.prototype.iQj=function(nb,Hc,Cc,Sc){V.Hdf(nb)?lb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Sc):this.$g.$.da.Aa(232).removeHandler(this.controlId,Sc):V.Idf(nb)?lb.EwaSettings.la(24)?this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,
Sc):this.$g.$.da.Aa(232).Raj(this.controlId,Sc):(V.Gdf(nb)&&this.x6e(1592314317,Sc),Hc=this.utb(nb,Hc),this.enabled?(Hc&&(Hc.Hsc(Cc),Hc.v6h||Array.remove(this.xE,Hc),this.xE.length?V.Jdf(nb)&&this.Rbg(!1):this.Qbg(!1)),this.$g.Ou(Sc)):this.$g.yf(-1,Sc))};V.prototype.ja=function(nb){jd.DOMElementExtensions.getElementById(nb,this.kGf)||nb.appendChild(jd.DOMElementExtensions.Tf(this.ey))};V.prototype.showHide=function(nb){jd.DOMElementExtensions.setVisible(this.ey,nb)};V.prototype.resize=function(nb,
Hc){jd.DOMElementExtensions.Uq(this.ey,nb);jd.DOMElementExtensions.pG(this.ey,Hc)};V.prototype.vIe=function(nb){if(!this.SU&&!jd.DOMElementExtensions.getElementById(this.ey,this.R6c)&&this.ey){var Hc=document.createElement("div");Hc.id=this.R6c;Hc.className=fd;Hc.style.backgroundImage="url("+jc.a.current.ro(81)+")";Hc.style.opacity=nb?"1":"0";Hc.style.backgroundRepeat="no-repeat";Hc.style.backgroundPosition="center";this.ey.insertBefore(Hc,this.ey.firstChild)}this.SU++};V.prototype.Pkh=function(){0<
this.SU&&this.SU--;this.SU||(jd.DOMElementExtensions.Tf(jd.DOMElementExtensions.getElementById(this.ey,this.R6c)),this.fwa&&!Kb.Q(this.uqc,kc.g(this.$).ha.va.selectedRanges)&&this.nd(null,null))};V.prototype.E2a=function(nb){if(!this.m1||!this.m1.BindingData)return null;for(var Hc=0;Hc<this.m1.BindingData.length;Hc++)if(this.m1.BindingData[Hc].Name===nb)return this.m1.BindingData[Hc];return null};V.prototype.getDefaultIconUrl=function(){var nb=this.U1e();return nb?nb.getDefaultIconUrl():null};V.prototype.getDefaultDisplayName=
function(){if(this.Nd.TaskpaneTitle)return this.Nd.TaskpaneTitle;var nb=this.U1e();return nb?nb.getDefaultDisplayName():null};V.prototype.xKf=function(){if(this.tVa&&this.l5b){var nb=new Ia.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.tVa);this.l5b(nb);this.l5b=this.tVa=null}};V.prototype.Nf=function(nb){this.l_d&&this.l_d.Nf(nb)};V.prototype.yqj=function(){var nb=this;this.$.ea.isNamedObjectViewMode&&this.Nli()&&(this.$.da.Aa(34).xqj(this.ey),this.showHide(!1));if(this.$g.dYj){if(!this.sJf){var Hc=
{};Hc.div=this.ey;Hc.id=this.Nd.InstanceId;Hc.solutionId=this.Nd.PrimaryMarketplace.SolutionId;Hc.version=this.Nd.PrimaryMarketplace.SolutionVersion;Hc.storeId=this.Nd.PrimaryMarketplace.MarketplaceRef;Hc.storeType=this.Nd.PrimaryMarketplace.MarketplaceType;Hc.ownerAddinSolutionId=this.Nd.OwnerAddinSolutionId;Hc.ownerAddinStoreType=this.Nd.OwnerAddinStoreType;this.Nd.AssetMarketplace&&(Hc.assetId=this.Nd.AssetMarketplace.SolutionId,Hc.assetStoreId=this.Nd.AssetMarketplace.MarketplaceRef,Hc.alternateReference=
{},Hc.alternateReference.marketplaceID=this.Nd.AssetMarketplace.SolutionId,Hc.alternateReference.marketplaceVersion=this.Nd.AssetMarketplace.SolutionVersion,Hc.alternateReference.store=this.Nd.AssetMarketplace.MarketplaceRef,Hc.alternateReference.storeType=this.Nd.AssetMarketplace.MarketplaceType);Hc.marketplaceID=this.Nd.PrimaryMarketplace.SolutionId;Hc.marketplaceVersion=this.Nd.PrimaryMarketplace.SolutionVersion;Hc.store=this.Nd.PrimaryMarketplace.MarketplaceRef;Hc.ownerAddinAssetId=this.Nd.OwnerAddinAssetId;
Hc.settings=this.Nd.OsfPropertyBag;lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?Hc.reason=this.O5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.gfc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:Hc.reason=this.O5a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;Hc.osfControlType=
0===this.Nd.WebExtensionType?OSF.OsfControlTarget.InContent:OSF.OsfControlTarget.TaskPane;Hc.isForUILessAction=4===this.Nd.WebExtensionOsfControlType;Hc.sourceLocationOverrideResourceId=this.Nd.SrcLocationOverrideResourceId;Hc.focusOnIframeWhenLoaded=this.Nd.FocusOnIframeWhenLoaded;Ua.a(this.Nd)&&(Hc.featureGates=Ta.AFrameworkApplication.ga.vQh(Hc.solutionId));Hc.hostInfoFlags=0;this.YHa&&(Hc.hostInfoFlags|=2);Zc.HelperMethods.iw(this.Nd)&&(Hc.hostInfoFlags|=1);this.$.lha||(Ja.ULS.sendTraceTag(537170466,
0,50,"Content web add-in disabled by doc IRM"),Hc.hostInfoFlags|=4);lb.EwaSettings.la(662)&&(Hc.hostInfoFlags|=8);lb.EwaSettings.la(54)&&lb.EwaSettings.la(94)&&!this.bHc&&(Hc.virtualOsfControlActivationCallback=function(){nb.$g.$Bd(nb.Nd)});Hc.sharedRuntimeId=this.Nd.SharedRuntime?this.Nd.SharedRuntime.Resid:this.Nd.SharedRuntimeId;!Zc.HelperMethods.iw(this.Nd)||this.Nd.Preload||Ua.a(this.Nd)||this.$g.Ji.getOsfControl(b(862).DdaFacade.getSolutionId(this.Nd,this.$))||(lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?
this.$.isEditMode&&this.$g.$Bd(this.Nd):this.$g.$Bd(this.Nd));Hc.initialDisplayMode=this.Nd.TaskpaneVisible?2:1;lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(Hc.titleOverride=this.el.TaskpaneTitle);this.$g.Ji.insertOsfControl(Hc)}this.SU=0}else this.vIe(!0)};V.prototype.Qbg=function(nb){this.Rbg(nb);this.QPj()};V.prototype.k8h=function(){this.jcb||this.ei.XYb(this.v6e);this.jcb++};V.prototype.Rbg=function(nb){0<this.jcb&&(nb?this.jcb=0:this.jcb--,this.jcb||this.ei.Hsc(this.v6e))};
V.prototype.okd=function(){if(!this.fwa){var nb=kc.g(this.$).ha;this.uqc=Kb.d(kc.g(this.$).ha.va.selectedRanges);nb.NG(this.nd);this.fwa=!0}};V.prototype.QPj=function(){this.fwa&&(kc.g(this.$).ha.jL(this.nd),this.fwa=!1)};V.prototype.wnj=function(nb){var Hc=new Sa.Range(nb.Reference.FirstRow+1,nb.Reference.FirstColumn+1,nb.Reference.LastRow+1,nb.Reference.LastColumn+1,!1,!1);1===nb.BindingType&&(nb.HasHeaders&&--Hc.top,nb.HasTotals&&(Hc.bottom+=1));var Cc=kc.g(this.$).ha.va.selectedRanges;nb=Hc.Wxb(this.uqc);
Cc=Hc.Wxb(Cc);return(Hc=Hc.zf(kc.g(this.$).ha.va.activeRange))&&(Yb.e(nb)&&!Yb.e(Cc)||!Yb.e(nb)&&!Yb.e(Cc)&&!Kb.Q(nb,Cc))?Hc:null};V.prototype.Foj=function(){var nb=this;Array.forEach(this.xE,function(Hc){if(Hc.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Hc.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||nb.$g.gj.q_b(nb.controlId))if(Hc.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)Hc.Z0b(new Ia.a(Hc.eventId,nb.controlId,null));else if(Hc.eventId===
OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var Cc=nb.E2a(Hc.targetId);if((null===Cc||void 0===Cc?0:Cc.IsValidRef)&&(nb.$.ea.isNamedObjectViewMode?nb.$.zb.pa.sheetName:nb.$.xa.pa.name)===Cc.Reference.SheetName){var Sc=nb.wnj(Cc);Sc&&Hc.Z0b(new Q(Hc.eventId,nb.controlId,nb.$g.f0b(Cc),Cc,Sc.top-1,Sc.left-1,Sc.height,Sc.width))}}})};V.prototype.utb=function(nb,Hc){if(!this.xE)return null;for(var Cc=0;Cc<this.xE.length;Cc++){var Sc=this.xE[Cc];if(Sc.eventId===nb&&Sc.targetId===Hc)return Sc}return null};
V.prototype.$Te=function(){for(var nb=Qb.a(this.$).ez,Hc=nb.length-1;0<=Hc;--Hc){var Cc=nb[Hc];if(3===Cc.floatingObject.type&&Cc.floatingObject.el.InstanceId===this.m1.WebExtensionId)return Cc}return null};V.prototype.Nli=function(){for(var nb=0;nb<this.$.zb.count;nb++)if(this.$.zb.getItem(nb).nka===this.m1.WebExtensionId)return!0;return!1};V.prototype.hwc=function(nb){this.hOc=nb;this.ey.id=this.kGf;this.ey.className=xd;this.ey.dir=this.$.isChromeRtl?"rtl":"ltr";this.yqj()};V.prototype.U1e=function(){if(!this.enabled)return null;
var nb=Ua.a(this.el)?"":this.el.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.el.PrimaryMarketplace.SolutionId,nb)};V.prototype.x6e=function(nb,Hc){if(lb.EwaSettings.la(24))this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Hc);else try{if(Ja.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.nde)this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,Hc);else{var Cc={};Cc[Ya.a.Fnb]=
this.controlId;var Sc=new md.a(nb,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Xb(Sc,Cc);this.$g.Ou(Hc)}}catch(Uc){Ja.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",Uc.message),this.$g.yf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,Hc)}};V.Ehh=function(nb){return nb===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||nb===OSF.DDA.EventDispId.dispidBindingDataChangedEvent};V.Jdf=function(nb){return nb===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||
nb===OSF.DDA.EventDispId.dispidSettingsChangedEvent||nb===OSF.DDA.EventDispId.dispidRichApiMessageEvent};V.Knd=function(nb){return nb===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||nb===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};V.Hdf=function(nb){return nb===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};V.Idf=function(nb){return nb===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};V.Gdf=function(nb){return nb===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};
Sk.Object.defineProperties(V.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.Nd.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.Nd.WebExtensionType}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,get:function(){return this.Nd.OwnerAddinSolutionId}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.SU}},ey:{configurable:!0,enumerable:!0,get:function(){return this.hOc}},
zU:{configurable:!0,enumerable:!0,get:function(){return this.Nd.SrcLocationOverrideResourceId?this.$g.SJa(this.Nd.PrimaryMarketplace.SolutionId,this.Nd.SrcLocationOverrideResourceId):this.Nd.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,enumerable:!0,get:function(){return this.Nd.SrcLocationOverrideResourceId}},el:{configurable:!0,enumerable:!0,get:function(){return this.Nd}},oha:{configurable:!0,enumerable:!0,get:function(){return this.$1d},set:function(nb){this.$1d=
nb}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.nde}},YHa:{configurable:!0,enumerable:!0,get:function(){return this.bHc},set:function(nb){this.bHc=nb}},o5c:{configurable:!0,enumerable:!0,get:function(){return this.tVa},set:function(nb){this.tVa=nb}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.Nd.FocusOnIframeWhenLoaded}},Fpd:{configurable:!0,enumerable:!0,get:function(){return this.S9d},set:function(nb){this.S9d=nb}}});Object(db.a)(V,
"OsfControl",zb.a,[504]);D.prototype.add=function(nb){this.VYa[nb]=!0};D.prototype.remove=function(nb){delete this.VYa[nb]};D.prototype.clear=function(){for(var nb=yl(Object.keys(this.VYa)),Hc=nb.next();!Hc.done;Hc=nb.next())delete this.VYa[Hc.value]};D.prototype.P7e=function(){return 0<Object.keys(this.VYa).length};D.prototype.FJh=function(){return Object.keys(this.VYa)};Object(db.a)(D,"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Me=b(54);v.prototype.vob=function(nb){51===
nb.messageType?this.ZOf=this.mGa(nb.actionType,this.ZOf,this.oIi):52===nb.messageType&&(this.$Of=this.mGa(nb.actionType,this.$Of,this.pIi))};v.prototype.mGa=function(nb,Hc,Cc){if(1===nb)Hc||kc.g(this.$).ha.Pa.ZUc(Cc),Hc++,this.juj();else if(2===nb){if(1>Hc)return Hc;1===Hc&&kc.g(this.$).ha.Pa.lJd(Cc);Hc--}return Hc};v.prototype.fja=function(nb,Hc,Cc){Hc&&this.gj.$Z(nb,Hc)&&this.ei.UM(nb,Hc,Cc)};v.prototype.dac=function(nb){return nb&&nb.floatingObject?(nb=nb.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&
1===nb.length?nb[0]:null:null};v.prototype.Bja=function(){var nb=this.$.xa.pa;return nb&&0===nb.AI?nb.sheetId:null};v.prototype.juj=function(){var nb=kc.g(this.$).ha.Pa.pC;this.snd(nb)&&(this.Y$a=this.dac(nb),this.jKb=this.Bja())};v.prototype.snd=function(nb){return!!nb&&!!nb.floatingObject&&0===nb.floatingObject.type};Object(db.a)(v,"RichApiEventChartActivatedDeactivatedHandler",null,[]);var Ue=b(869),Jd=b(180),Sd=b(657),se=b(94),oe=b(341),Ke=b(52),bc=P.a;vm(J,bc);J.prototype.O_b=function(nb){Object(lc.a)(oe.a,
this.$.xa);1===nb.actionType?(this.Iza||this.grid.ha.NG(this.nd),this.Iza++):2!==nb.actionType||1>this.Iza||(1===this.Iza&&this.grid.ha.jL(this.nd),this.Iza--)};J.prototype.Nvc=function(nb){nb?this.SU++:(0<this.SU&&this.SU--,this.SU||this.nd(null,new Sd.a(!1)))};J.prototype.qZe=function(){return this.grid.ha.va.selectedRanges};J.prototype.ise=function(nb,Hc){return lb.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?(!!nb&&Jd.e(this.gNa)||nb in
this.gNa)&&!Kb.Q(this.gNa[nb],Hc):nb in this.gNa&&!Kb.Q(this.gNa[nb],Hc)};J.prototype.yJe=function(nb,Hc,Cc){this.gNa[nb]=Kb.d(Hc);this.Tic[nb]=Cc};J.prototype.rff=function(){return this.grid.isEditing||this.grid.Ci};J.prototype.zUe=function(nb,Hc){this.gj.$Z(14,nb)&&this.ei.UM(14,nb,Hc);this.gj.$Z(14,Ue.a.bX)&&this.ei.UM(14,Ue.a.bX,Hc)};J.prototype.U5h=function(nb,Hc){var Cc={};Cc.worksheetId=nb;Cc.address=this.Egd(Hc);Hc=Me.a.Kc(Cc);this.zUe(nb,Hc)};J.prototype.E5h=function(nb,Hc,Cc,Sc){if(this.gj.qif()){var Uc=
"",ae="";Sc&&(Uc=Sc.ij);Cc&&(ae=Cc.ij);Sc?Cc?(Hc=Cc.usedRange.Wxb(Hc),Uc!==ae&&this.I9b(Uc,"",nb),this.I9b(ae,this.Egd(Hc),nb)):this.I9b(Uc,"",nb):Cc&&(Uc=Cc.usedRange.Wxb(Hc),this.I9b(ae,this.Egd(Uc),nb))}};J.prototype.I9b=function(nb,Hc,Cc){if(this.gj.$Z(100,nb)){var Sc={};Sc.address=Hc;Sc.worksheetId=Cc;this.ei.UM(100,nb,Me.a.Kc(Sc))}};J.prototype.Egd=function(nb){return Kb.i(nb,",",this.$,!1)};J.prototype.dispose=function(){0<this.Iza&&this.grid.ha.jL(this.nd);this.Tic=this.gNa=null;this.Iza=
0;this.ei=this.gj=this.$=this.grid=null};Sk.Object.defineProperties(J.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.SU&&0<this.Iza}}});Object(db.a)(J,"RichApiEventSelectionChangedHandler",P.a,[]);var qd=b(336);vm(r,J);r.prototype.qZe=function(){return qd.a.GHa(this.grid.ha.rangePicker.$K)};r.prototype.ise=function(nb,Hc){return this.nkf!==nb||!Kb.Q(this.mkf,Hc)};r.prototype.yJe=function(nb,Hc){this.nkf=nb;this.mkf=Kb.d(Hc)};r.prototype.rff=function(){return!this.grid.isEditing&&
!this.grid.Ci};r.prototype.zUe=function(nb,Hc){this.gj.$Z(2700,Ue.a.bX)&&this.ei.UM(2700,Ue.a.bX,Hc)};Object(db.a)(r,"RichApiEventPickedRangesChangedHandler",J,[]);C.prototype.vob=function(nb){var Hc=kc.g(this.$).ha;1===nb.actionType?(this.kQa||this.lQa||Hc.Pa.ZUc(this.iyf),2101===nb.messageType?this.kQa++:2102===nb.messageType&&this.lQa++):2===nb.actionType&&(2101===nb.messageType?this.kQa=0<this.kQa?this.kQa-1:0:2102===nb.messageType&&(this.lQa=0<this.lQa?this.lQa-1:0),this.kQa||this.lQa||Hc.Pa.lJd(this.iyf))};
C.prototype.vni=function(nb){return!!nb&&!!nb.floatingObject&&(0===nb.floatingObject.type||7===nb.floatingObject.type||1===nb.floatingObject.type||3===nb.floatingObject.type||5===nb.floatingObject.type)};C.prototype.wOj=function(nb){if(!nb||!nb.floatingObject)return null;nb=nb.floatingObject.id;var Hc=nb.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));Hc=Hc&&1===Hc.length?Hc[0]:null;return Hc?Hc:(Ja.ULS.sendTraceTag(537170457,344,10,"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",
nb),null)};C.prototype.Bja=function(){var nb=this.$.xa.pa;return nb&&0===nb.AI?nb.sheetId:null};C.prototype.fireEvent=function(nb,Hc,Cc){Hc&&this.gj.$Z(nb,Hc)&&this.ei.UM(nb,Hc,Cc)};Object(db.a)(C,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);u.prototype.vob=function(nb){11===nb.messageType?nb.targetId===Ue.a.bX?this.rMg(nb.actionType):this.qMg(nb.actionType):12===nb.messageType&&(nb.targetId===Ue.a.bX?this.sMg(nb.actionType):this.tMg(nb.actionType))};u.prototype.qMg=function(nb){this.bPf=
this.mGa(nb,this.bPf,this.KVi)};u.prototype.tMg=function(nb){this.ePf=this.mGa(nb,this.ePf,this.NVi)};u.prototype.rMg=function(nb){this.cPf=this.mGa(nb,this.cPf,this.LVi)};u.prototype.sMg=function(nb){this.dPf=this.mGa(nb,this.dPf,this.MVi)};u.prototype.mGa=function(nb,Hc,Cc){1===nb?Hc=this.xXc(Hc,Cc):2===nb&&(Hc=this.C6c(Hc,Cc));return Hc};u.prototype.xXc=function(nb,Hc){nb||this.$.xa.Qf(Hc);nb++;return nb};u.prototype.C6c=function(nb,Hc){if(1>nb)return nb;1===nb&&this.$.xa.ug(Hc);nb--;return nb};
u.prototype.p7a=function(nb){return!!nb&&0===nb.AI};u.prototype.fja=function(nb,Hc,Cc,Sc){Hc=(void 0===Sc?0:Sc)?Ue.a.bX:Hc;this.gj.$Z(nb,Hc)&&this.ei.UM(nb,Hc,Cc)};Object(db.a)(u,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var zc=b(169),ld=b(12),rb=b(275),Wd=Sys.EventArgs;vm(z,Wd);Object(db.a)(z,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);B.prototype.dispose=function(){this.DQj()};B.prototype.v$i=function(){for(var nb=yl(this.gridView.nn),Hc=nb.next();!Hc.done;Hc=nb.next())Hc=Hc.value.domElement,
zc.a.instance.qa(ld.a.pointerDown,Hc,this.onPointerDown),rb.a.instance.qa(ld.a.click,Hc,this.Zc)};B.prototype.DQj=function(){for(var nb=yl(this.gridView.nn),Hc=nb.next();!Hc.done;Hc=nb.next())Hc=Hc.value.domElement,zc.a.instance.za(ld.a.pointerDown,Hc,this.onPointerDown),rb.a.instance.za(ld.a.click,Hc,this.Zc)};B.prototype.OVi=function(nb){var Hc=nb.sheet;if(this.p7a(Hc)){var Cc={};Cc.worksheetId=Hc.sheetId;Cc.address=nb.QVg.toString();Cc.offsetX=nb.offsetX;Cc.offsetY=nb.offsetY;nb=Hc.sheetId;this.gj.$Z(21,
nb)&&(Hc=Me.a.Kc(Cc),this.ei.UM(21,nb,Hc));nb=Ue.a.bX;this.gj.$Z(21,nb)&&(Cc=Me.a.Kc(Cc),this.ei.UM(21,nb,Cc))}};B.prototype.p7a=function(nb){return!!nb&&0===nb.AI};Object(db.a)(B,"RichApiEventSingleClickedHandler",null,[]);t.prototype.O_b=function(nb){2E3===nb.messageType&&(1===nb.actionType?(this.JGb||kc.g(this.$).ha.Pa.ZUc(this.tFf),this.JGb++,this.Fqj()):2===nb.actionType&&this.JGb&&(1===this.JGb&&kc.g(this.$).ha.Pa.lJd(this.tFf),this.JGb--))};t.prototype.jbd=function(nb){var Hc,Cc={};Cc.worksheetId=
nb;Cc.revisionLoad=!1;if(lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&(lb.EwaSettings.la(746)||lb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){var Sc=kc.g(this.$).ha.Pa.pC;(null===(Hc=null===Sc||void 0===Sc?void 0:Sc.floatingObject)||void 0===Hc?0:Hc.Xc)?Cc.selectedVisualId=Sc.floatingObject.Xc.VisualID:Cc.selectedVisualId=null}Hc=Me.a.Kc(Cc);nb&&this.gj.$Z(2E3,nb)&&this.ei.UM(2E3,nb,
Hc)};t.prototype.Bja=function(){var nb=this.$.xa.pa;return nb&&0===nb.AI?nb.sheetId:null};t.prototype.Fqj=function(){var nb=kc.g(this.$).ha.Pa.pC;this.ajf(nb)&&(this.V$a=nb.floatingObject.id,this.O$a=this.Bja())};t.prototype.ajf=function(nb){return!!nb&&nb.Hrd()};Object(db.a)(t,"RichApiEventVisualSelectionChangedHandler",null,[]);y.prototype.pMg=function(nb){1===nb.actionType?(this.KGb||this.KMg(),this.KGb++):2!==nb.actionType||1>this.KGb||(1===this.KGb&&this.deh(),this.KGb--)};y.prototype.KMg=function(){if(this.gj.$Z(2203,
Ue.a.bX))if(this.mqd){var nb={};nb.timeout=this.$.ya.CheckFocusTimeout;this.Y9b=window.requestIdleCallback(this.Cye,nb)}else this.Y9b=window.setInterval(this.Bye,this.$.ya.CheckFocusTimeInterval)};y.prototype.deh=function(){this.mqd?window.cancelIdleCallback(this.Y9b):window.clearInterval(this.Y9b)};Object(db.a)(y,"RichApiEventWorkbookActivatedHandler",null,[]);var rc;(function(nb){nb[nb.none=0]="none";nb[nb.registerEvent=1]="registerEvent";nb[nb.unregisterEvent=2]="unregisterEvent";nb[nb.customFunction=
3]="customFunction";nb[nb.showCard=4]="showCard";nb[nb.createWorkbook=5]="createWorkbook";nb[nb.openWorkbook=6]="openWorkbook";nb[nb.enableEvents=7]="enableEvents";nb[nb.closeWorkbook=8]="closeWorkbook";nb[nb.setCalculationMode=9]="setCalculationMode";nb[nb.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";nb[nb.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";nb[nb.workbookLinksEnableContent=12]="workbookLinksEnableContent";nb[nb.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";
nb[nb.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";nb[nb.rangePicker=15]="rangePicker";nb[nb.enableRichApiRecording=16]="enableRichApiRecording";nb[nb.recordAction=17]="recordAction";nb[nb.focus=18]="focus";nb[nb.businessBarShow=19]="businessBarShow";nb[nb.businessBarHide=20]="businessBarHide"})(rc||(rc={}));Object(db.b)("PostProcessActionType",rc);var nd=b(232);x.prototype.oMg=function(nb){1===nb.actionType?(this.$.wba=!0,Object(lc.a)(b(862).DdaFacade,nd.a(this.$)).ibd(!0)):2===nb.actionType&&
(this.$.wba=!1);this.lGf=nb.controlId;Ja.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",rc[nb.actionType],this.lGf,this.$.wba)};x.prototype.$lh=function(nb){Object(lc.a)(b(862).DdaFacade,nd.a(this.$)).CUe(nb,this.$.wba)};x.prototype.Hbi=function(){var nb=this;this.$.Aba&&sa.TaskExtensions.Ba(Gc.GetServiceTaskFactory.Wa(this.$.da,297,298,1),function(Hc){(Hc=Hc.result)&&Hc.init(nb.hbd)},this.$.ma,
3)};Object(db.a)(x,"RichApiMacroRecorderEventHandler",null,[]);Object(db.a)(f,"SessionRecreationInfo",null,[]);m.prototype.xDi=function(){return lb.EwaSettings.la(261)?this.gj.E6h()||0!==this.runtimeCalculationMode:!1};m.prototype.yRg=function(){var nb={};nb.eventRegistrationInfos=this.gj.JPh();nb.runtimeCalculationMode=this.runtimeCalculationMode;nb=Object.assign(new f,{runtimeState:nb});var Hc={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",RequestHeaders:null};Hc.RequestBody=JSON.stringify(nb);
Hc.RequestFlags=1;return Hc};Object(db.a)(m,"RichApiRuntimeStateHandler",null,[]);Object(db.a)(n,"UserOperationQueueItemsStatisticsData",null,[]);var me=b(323),be=b(28),sd=b(16),Qe=b(286),Sf=b(45),mf=b(610),Zd=b(61),ie=b(57),kd=b(69),ge=me.a;vm(l,ge);l.prototype.dispose=function(){this.$&&(this.$.xa.TF(this.xo),this.$.zb.TF(this.xo),this.$.zb.ug(this.Qe),this.$.xa.ug(this.Qe));this.lUa&&(this.lUa.pp(this.Re),this.lUa.oI(this.Fm),this.lUa.Kq(this.Jg));lb.EwaSettings.sc()&&this.pt(this.sya);this.clearCache();
sc.a.Fa(this.lUa);this.lUa=null;jd.DOMElementExtensions.Tf(this.domElement);ge.prototype.dispose.call(this)};l.prototype.xqj=function(nb){jd.DOMElementExtensions.Tf(jd.DOMElementExtensions.getElementById(this.domElement,nb.id));this.domElement.appendChild(nb)};l.prototype.Vld=function(){if(this.Hva&&!this.j3b){var nb=Object(lc.a)(b(862).DdaFacade,nd.a(this.$)).cn(this.Hva.InstanceId);nb&&(nb.resize(this.Hva.Width,this.Hva.Height),nb.ja(this.domElement),nb.showHide(!0),this.j3b=!0)}};l.prototype.r7a=
function(){return!0};l.prototype.Dna=function(nb){this.Hva=nb.dd.block.se;this.j3b=!1;this.Vld()};l.prototype.CTa=function(nb){this.$.ea.XZ&&nb&&(nb.ru||(nb.ru=new Qe.a),nb.ru.Sg=new Sf.a(this.domElement.scrollLeft,this.domElement.scrollTop),nb.ru.wFb=20)};l.prototype.clearCache=function(){this.Ca.Kza(this.hashCode);this.Hva=this.hashCode=null;this.j3b=!1};l.prototype.FSa=function(nb,Hc){if(this.isVisible=!!nb&&Zd.p(nb))this.hashCode=this.Ca.Sga(nb,ie.a.Grb,this.hashCode),this.uwc(Hc)};l.nGa=function(nb){if(!nb.da.Aa(34)){var Hc=
nb.tf;nb.da.Ha(34,new l(nb,new mf.a(nb,nb.ea,nb.na.Dk,3,0),Hc.appendChild(Hc.ownerDocument.createElement("div"))))}};Sk.Object.defineProperties(l.prototype,{Ca:{configurable:!0,enumerable:!0,get:function(){return this.lUa}}});Object(db.a)(l,"WebExtensionView",me.a,[451,191,3]);var of=b(217),Ec=b(521),Cd=b(369),Qd=b(437),od=b(164),ke=b(81),Re=b(114),lf=b(44),vc=b(42),hd=b(147),Ac=b(107),Vd=b(72),Bd=b(26),tf=b(27),Wb=b(303),wc=b(19),yb=b(14),mc=b(272),Wc=b(880),Nd=b(48),Tc=b(151),Yc=b(1116),oc=b(192),
ze=b(1011),Ae=b(30);b.d(F,"DdaFacade",function(){return a});var Ve=ic.a;vm(a,Ve);a.prototype.Cne=function(nb){this.addHandler("cd",nb)};a.prototype.Xbj=function(nb){this.removeHandler("cd",nb)};a.prototype.Dne=function(nb){this.addHandler("csc",nb)};a.prototype.ysc=function(nb){this.removeHandler("csc",nb)};a.prototype.zEg=function(nb){this.addHandler("ca",nb)};a.prototype.Wbj=function(nb){this.removeHandler("ca",nb)};a.prototype.AEg=function(nb){this.addHandler("ci",nb)};a.prototype.BEg=function(nb){this.addHandler("ekros",
nb)};a.prototype.Ybj=function(nb){this.removeHandler("ekros",nb)};a.prototype.dDd=function(nb,Hc){try{return JSON.parse(nb)[Hc].toLowerCase()}catch(Cc){return""}};a.prototype.exj=function(nb){var Hc=this.dDd(nb,"AudienceGroup"),Cc=this.dDd(nb,"SessionOrigin");try{var Sc=parseInt(this.dDd(nb,"Ring"),10);if("automation"!==Hc&&"bluechicken"!==Cc&&-2<=Sc)return!0}catch(Uc){if("automation"!==Hc&&"bluechicken"!==Cc)return!0}return!1};a.prototype.f0b=function(nb){var Hc={};Hc.Name=nb.Name;Hc.BindingType=
nb.BindingType;Hc.HasHeaders=nb.HasHeaders;nb.IsValidRef&&(Hc.ColCount=nb.Reference.LastColumn-nb.Reference.FirstColumn+1,Hc.RowCount=nb.Reference.LastRow-nb.Reference.FirstRow+1);return Hc};a.prototype.csi=function(nb,Hc){this.Pm.launchInsertDialog(nb,null,this.CQg(Hc))};a.prototype.VFd=function(nb,Hc){var Cc={};Cc.callbackFunc=nb;Cc.storeType=OSF.StoreTypeEnum.MarketPlace;Cc.fromInsertDialog=!1;Cc.refresh=Hc;this.Pm.queryEntitlementDetails(Cc)};a.prototype.invokeDdaMethod=function(nb,Hc){var Cc=
this.cn(nb.DdaMethod.ControlId);Cc?Cc.invokeDdaMethod(nb,Hc):this.yf(Ba.a.internalError,Hc)};a.prototype.registerDdaEventAsync=function(nb,Hc,Cc,Sc,Uc){(Hc=this.cn(Hc))?a.Cyb(nb)?Hc.Z8i(nb,Cc,Sc,Uc):this.yf(Ba.a.vCd,Uc):this.yf(Ba.a.internalError,Uc)};a.prototype.unregisterDdaEventAsync=function(nb,Hc,Cc,Sc,Uc){(Hc=this.cn(Hc))?a.Cyb(nb)?Hc.iQj(nb,Cc,Sc,Uc):this.yf(Ba.a.vCd,Uc):this.yf(Ba.a.internalError,Uc)};a.prototype.dispose=function(){this.disposed||(this.$.pl(this.rd),this.ea.lk(this.$c),this.ea.QW(this.Hq),
this.ea.Ew(this.Mf),this.gWc.detach(this),this.$.userOperationManager.jv(this.ZR),this.Ooc=this.Ff=this.ei=this.gWc=this.vb=null,this.PIa&&(this.PIa.dispose(),this.PIa=null),sc.a.Fa(this.ULd),sc.a.Fa(this.TLd),this.f1a&&(this.f1a.dispose(),this.f1a=null),Ve.prototype.dispose.call(this),this.disposed=!0,Ja.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.Bac=function(nb){return(nb=this.cn(nb))?nb.getDefaultIconUrl():null};a.prototype.Nvc=function(nb){if(this.aGe!==nb){this.aGe=
nb;for(var Hc=0,Cc=this.Ff.length;Hc<Cc;Hc++){var Sc=this.Ff[Hc];nb?Sc.vIe(!1):Sc.Pkh()}this.ULd.Nvc(nb);this.TLd.Nvc(nb)}};a.prototype.uOh=function(nb){return(nb=this.cn(nb))?nb.getDefaultDisplayName():null};a.prototype.yf=function(nb,Hc,Cc){var Sc={};Sc[ra.a.Ug]=nb;Sc[ra.a.G3]=Hc;this.kK(451041795,Sc,void 0===Cc?!0:Cc)};a.prototype.Ou=function(nb){var Hc={};Hc[ra.a.G3]=nb;this.kK(1237877382,Hc)};a.prototype.kK=function(nb,Hc,Cc){var Sc=this;Cc=void 0===Cc?!0:Cc;var Uc=new md.a(nb,0,this.$.gd,0,
null),ae=Hc?Hc[ra.a.G3]:null;this.f1a&&kc.g(this.$).isEditing&&K.D_g(nb,Hc)?this.f1a.Ych(nb,Hc):(nb=this.$.Ka.Xb(Uc,Hc),Cc&&sa.TaskExtensions.Ba(nb,function(ue){hd.a(ue)?Sc.yf(Ba.a.internalError,ae,!1):ue.result||(kc.g(Sc.$).isEditing?Sc.yf(Ba.a.Xxb,ae,!1):Sc.yf(Ba.a.internalError,ae,!1))},this.ma,8))};a.prototype.d2g=function(nb){var Hc=this;return!!this.eja(function(Cc){return a.getSolutionId(Cc.el,Hc.$)===a.getSolutionId(nb,Hc.$)&&Cc.el.PrimaryMarketplace.MarketplaceType===nb.PrimaryMarketplace.MarketplaceType&&
Cc.el.PrimaryMarketplace.MarketplaceRef===nb.PrimaryMarketplace.MarketplaceRef&&Cc.el.PrimaryMarketplace.SolutionVersion===nb.PrimaryMarketplace.SolutionVersion})};a.prototype.cn=function(nb){return this.eja(function(Hc){return Hc.controlId.startsWith(nb)})};a.prototype.XCh=function(nb){return this.eja(function(Hc){return Hc.YHa===nb})};a.prototype.aUe=function(nb){return this.eja(function(Hc){return Hc.zU===nb&&!!Hc.YHa})};a.prototype.rUe=function(nb,Hc,Cc,Sc){return this.eja(function(Uc){return Uc.zU===
nb&&Uc.el.PrimaryMarketplace.MarketplaceRef.toLowerCase()===Hc.toLowerCase()&&Uc.el.PrimaryMarketplace.MarketplaceType.toLowerCase()===Cc.toLowerCase()&&!!Uc.el.SharedRuntime&&!!Uc.el.SharedRuntime.Resid&&!!Sc&&!!Sc.Resid&&Uc.el.SharedRuntime.Resid.toLowerCase()===Sc.Resid.toLowerCase()})};a.prototype.bMg=function(nb,Hc){if(nb=this.cn(nb))nb.ja(Hc),nb.showHide(!0)};a.prototype.uBj=function(nb){(nb=this.cn(nb))&&nb.showHide(!1)};a.prototype.F0a=function(nb){if(1!==nb.WebExtensionType||this.$.Hd&8388608&&
nb.TaskpaneVisible||this.$.Hd&8388608&&!nb.TaskpaneVisible&&Zc.HelperMethods.iw(nb)){var Hc=null;Zc.HelperMethods.iw(nb)&&(Hc=a.Yua(nb,this.$),nb.TaskpaneWidth||(nb.TaskpaneWidth=this.C5b));var Cc=(new V(this,this.ei,nb)).Gld();Ja.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(nb.PrimaryMarketplace.MarketplaceType,nb.PrimaryMarketplace.MarketplaceRef,nb.PrimaryMarketplace.SolutionId),nb.PrimaryMarketplace.MarketplaceType,
Zc.HelperMethods.iw(nb));Hc&&(Cc.YHa=Hc);Array.add(this.Ff,Cc);this.rxa=null;this.O5a(nb.InstanceId)||(nb=String.format("{0}|{1}|{2}|{3}|{4}",nb.PrimaryMarketplace.SolutionId,nb.PrimaryMarketplace.SolutionVersion,nb.PrimaryMarketplace.MarketplaceRef,nb.PrimaryMarketplace.MarketplaceType,nb.WebExtensionType),this.raiseEvent("ci",nb))}};a.prototype.hDj=function(nb,Hc){function Cc(){Sc.rQa(ae.controlId);Sc.Ji.purgeOsfControl(ae.controlId,!1);Hc()}var Sc=this;nb.TaskpaneWidth=this.C5b;nb.TaskpaneVisible=
!0;var Uc={};Uc.SolutionId=nb.PrimaryMarketplace.SolutionId;Uc.TargetType=nb.WebExtensionType;Uc.Version=nb.PrimaryMarketplace.SolutionVersion;Uc.StoreType=nb.PrimaryMarketplace.MarketplaceType;Uc.StoreId=nb.PrimaryMarketplace.MarketplaceRef;Uc.AssetId=nb.PrimaryMarketplace.SolutionId;Uc.AssetStoreId=nb.PrimaryMarketplace.MarketplaceRef;Uc.Width=nb.TaskpaneWidth;Uc.Id=nb.PrimaryMarketplace.SolutionId;Uc.AppVersion=nb.PrimaryMarketplace.SolutionVersion;Uc.CurrentStoreType=nb.PrimaryMarketplace.MarketplaceType;
var ae=new V(this,this.ei,nb,!0);ae.Gld();Array.add(this.Ff,ae);var ue=null;ue=lf.a.instance.nC(function(){ae.ey&&(sc.a.Fa(ue),ue=null,Sc.Ji.insertBlankControlWithErrorUX(Sc.CFb(ae,Uc),Cc))},100,vc.a.Pbh)};a.prototype.O5g=function(nb){var Hc=this;if(nb&&nb.length){var Cc=[];nb.forEach(function(Sc){if(Sc.ContainsCustomFunctions){var Uc=a.Yua(Sc,Hc.$);Hc.zDd.contains(Uc)||(Hc.zDd.add(Uc),Array.add(Hc.CHf,Sc));Hc.d2g(Sc)||Array.add(Cc,Sc)}});Cc.length&&this.rDe(Cc)}};a.prototype.iFe=function(nb,Hc){this.cn(nb.InstanceId)||
(Hc=Hc(),nb=(new V(this,this.ei,nb)).Caf(Hc),Array.add(this.Ff,nb),this.rxa=null)};a.prototype.PAj=function(nb){a.Y0a.xb(nb)&&a.Y0a.oa(nb).initializeAndShowWithTitle()};a.prototype.A7h=function(nb){a.Y0a.xb(nb)&&a.Y0a.oa(nb).hide()};a.prototype.iVh=function(nb){var Hc=this,Cc=null,Sc,Uc=null;var ae=a.$hd(nb,!0);if(!ae)return Ja.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Ke.Task.Ta(null);(Sc=this.Pm.getOsfControl(a.getSolutionId(ae,
this.$)))&&(Cc=Sc.getManifest())&&(Uc=Cc.getSharedRuntimeForCustomFunctions("Workbook"));if(Cc=Uc&&1===Uc.LifeTime?this.rUe(ae.PrimaryMarketplace.SolutionId,ae.PrimaryMarketplace.MarketplaceRef,ae.PrimaryMarketplace.MarketplaceType,Uc):this.XCh(nb))return Ke.Task.Ta(Cc.controlId);var ue=new pb.a;Zc.HelperMethods.oic(Uc)&&(ae.SharedRuntime=Uc);nb=Sc?Sc.getNotificationParams():[];if(!nb.length)return this.SDe(ae);this.A3f(nb,function(){sa.TaskExtensions.Ba(ue.task,function(){Hc.SDe(ae)},Hc.ma,3)},function(){});
return ue.task};a.prototype.DJh=function(nb){nb=a.$hd(nb,!1);if(!nb)return Ja.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var Hc=null,Cc=this.Pm.getOsfControl(a.getSolutionId(nb,this.$));Cc&&(Cc=Cc.getManifest())&&(Hc=Cc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Zc.HelperMethods.oic(Hc)&&(nb=this.rUe(nb.PrimaryMarketplace.SolutionId,nb.PrimaryMarketplace.MarketplaceRef,nb.PrimaryMarketplace.MarketplaceType,Hc))?nb.controlId:
null};a.prototype.l4g=function(nb,Hc){var Cc=this,Sc=a.$hd(nb,!1);if(Sc){var Uc=null,ae=this.Pm.getOsfControl(a.getSolutionId(Sc,this.$));ae&&(ae=ae.getManifest())&&(Uc=ae.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Zc.HelperMethods.oic(Uc)){Sc.SharedRuntime=Uc;var ue=Sc.PrimaryMarketplace.SolutionId;ae=Sc.PrimaryMarketplace.SolutionVersion;var Lf=OSF.OsfManifestManager.getCachedManifest(ue,ae);if(Lf)if(this.nZb.xb(nb))Uc=this.nZb.oa(nb),sa.TaskExtensions.Ba(Uc,function(dc){(dc=dc.result)&&
OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(dc,Hc,Cc.ei.YIb)},this.ma,3);else{var xf={solutionId:ue,version:ae};xf.storeType=Sc.PrimaryMarketplace.MarketplaceType;xf.storeId=Sc.PrimaryMarketplace.MarketplaceRef;xf.assetId=ue;xf.assetStoreId=null;xf.targetType=OSF.OsfControlTarget.TaskPane;var Rf=new pb.a;Sc=sa.TaskExtensions.om();Sc=new Ob.a(this.$,this,xf,Sc);Uc=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(ue,Uc.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(Lf,
Uc,ae);Sc.createUILessSandbox(xf,Lf,function(dc,Oc){dc&&!Oc?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(dc,Hc,Cc.ei.YIb),Rf.setResult(dc)):Rf.setResult(null);Cc.nZb.remove(nb)});this.nZb.ia(nb,Rf.task)}}}else Ja.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.nye=function(nb){(nb=this.aUe(nb))&&(nb.el.SharedRuntime||this.RGb(nb.controlId))};a.prototype.RGb=function(nb){(nb=this.aUe(nb))&&this.rQa(nb.controlId)};
a.prototype.$gh=function(nb,Hc){if(!this.Ff||!nb||!Hc)return!1;if(nb.toLowerCase()===Hc.toLowerCase())return!0;for(var Cc=null,Sc=null,Uc=0,ae=this.Ff.length;Uc<ae;Uc++){var ue=this.Ff[Uc];if(ue.ownerAddinSolutionId&&(ue.controlId===nb&&(Cc=ue.ownerAddinSolutionId.toLowerCase()),ue.controlId===Hc&&(Sc=ue.ownerAddinSolutionId.toLowerCase()),Cc&&Sc))break}return Cc&&Cc===Sc?!0:!1};a.prototype.eCg=function(nb){this.cn(nb.InstanceId)||(nb=new V(this,this.ei,nb),Array.add(this.Ff,nb),this.rxa=null)};a.prototype.WPf=
function(nb){if(this.Ff&&0<=nb&&nb<this.Ff.length){var Hc=this.Ff[nb],Cc=Hc.ey;Array.removeAt(this.Ff,nb);this.Swf(Hc);jd.DOMElementExtensions.Tf(Cc)}};a.prototype.rQa=function(nb){if(this.Ff)for(var Hc=0,Cc=this.Ff.length;Hc<Cc;Hc++)if(this.Ff[Hc].controlId===nb){this.WPf(Hc);break}};a.prototype.Xaj=function(nb){if(this.Ff){nb=nb.toLowerCase();for(var Hc=0,Cc=this.Ff.length;Hc<Cc;Hc++)if(nb===this.Ff[Hc].ownerAddinSolutionId.toLowerCase()){this.WPf(Hc);break}}};a.prototype.JMg=function(nb){nb.hn&&
(this.cn(nb.floatingObject.el.InstanceId)||(this.gfc(nb.floatingObject.el.InstanceId)||Array.add(this.Ooc,nb.floatingObject.el.InstanceId),this.F0a(nb.floatingObject.el)),this.ea.isNamedObjectViewMode&&this.bMg(nb.floatingObject.el.InstanceId,nb.Rd))};a.prototype.yaa=function(nb){if(this.Ff)for(var Hc=0,Cc=this.Ff.length;Hc<Cc;Hc++)if(1===this.Ff[Hc].controlType&&wc.a.equals(this.Ff[Hc].zU,nb,!0))return this.Ff[Hc].controlId;return null};a.prototype.vCh=function(nb){var Hc=[];if(this.Ff)for(var Cc=
0,Sc=this.Ff.length;Cc<Sc;Cc++)wc.a.equals(this.Ff[Cc].zU,nb,!0)&&Hc.push(this.Ff[Cc].controlId);return Hc};a.prototype.dDh=function(nb,Hc){if(!Hc||!nb)return null;if(this.Ff)for(var Cc=0,Sc=this.Ff.length;Cc<Sc;Cc++)if(1===this.Ff[Cc].controlType&&wc.a.equals(this.Ff[Cc].zU,nb,!0)&&this.Ff[Cc].el.SharedRuntime&&wc.a.equals(this.Ff[Cc].el.SharedRuntime.Resid,Hc.Resid,!0))return this.Ff[Cc].controlId;return null};a.prototype.SJa=function(nb,Hc){Hc=void 0===Hc?null:Hc;return nb?Hc?String.format("{0}.{1}",
nb,Hc):nb:""};a.prototype.qye=function(nb,Hc,Cc){if(this.rxa===nb)return!0;this.rxa=nb;var Sc=null,Uc=!1;if(!Sc&&this.Ff)for(var ae=0,ue=this.Ff.length;ae<ue;ae++)if(1===this.Ff[ae].controlType&&wc.a.equals(this.Ff[ae].zU,nb,!0)){var Lf=!1,xf=!1;Hc?(Lf=!0,xf=!!this.Ff[ae].el.SharedRuntime&&wc.a.equals(this.Ff[ae].el.SharedRuntime.Resid,Hc.Resid,!0)):Cc&&(Lf=!0,xf=wc.a.equals(this.Ff[ae].el.SharedRuntimeId,Cc,!0));if(!Lf||xf){xf&&this.Ff[ae].Nf(!0);Sc=this.Ff[ae].controlId;Uc=!0;this.rxa=null;break}}Sc&&
this.raiseEvent("ca",Sc);return Uc};a.prototype.setAppRuntimeState=function(nb,Hc){var Cc;if(nb){var Sc=this.cn(nb);if(Sc&&Zc.HelperMethods.iw(Sc.el))Sc.Nf(Hc),Hc&&(this.raiseEvent("ca",nb),(null===(Cc=Sc.ey)||void 0===Cc?0:Cc.firstChild)&&(nb=Sc.ey.firstChild.title)&&0<nb.length&&this.y_b.xoj(nb));else throw Ja.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(yb.a.instance.fa(2181));}else throw Ja.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(yb.a.instance.fa(2182));};a.prototype.getAppRuntimeState=function(nb){if(nb)if((nb=this.cn(nb))&&Zc.HelperMethods.iw(nb.el))nb=nb.el.TaskpaneVisible;else throw Ja.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(yb.a.instance.fa(2181));else throw Ja.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(yb.a.instance.fa(2182));return nb};a.prototype.E2a=function(nb,Hc){return(nb=
this.cn(nb))?nb.E2a(Hc):null};a.prototype.O5a=function(nb){return this.sye(this.Ooc,nb)};a.prototype.gfc=function(nb){return this.sye(this.WFe,nb)};a.prototype.Sle=function(nb){Array.add(this.WFe,nb)};a.prototype.sZ=function(nb){return(nb=this.cn(nb))?nb.el:null};a.prototype.syd=function(nb){this.raiseEvent("ekros",nb,this)};a.prototype.$Bd=function(nb){if(nb){var Hc=this.cn(nb.InstanceId);Hc&&(nb.SharedRuntime||nb.SharedRuntimeId||(this.rQa(Hc.controlId),this.Ji.purgeOsfControl(Hc.controlId,!1)),
Hc={},Hc.SolutionId=nb.PrimaryMarketplace.SolutionId,Hc.TargetType=nb.WebExtensionType,Hc.Version=nb.PrimaryMarketplace.SolutionVersion,Hc.StoreType=nb.PrimaryMarketplace.MarketplaceType,Hc.StoreId=nb.PrimaryMarketplace.MarketplaceRef,Hc.AssetId=nb.PrimaryMarketplace.SolutionId,Hc.AssetStoreId=nb.PrimaryMarketplace.MarketplaceRef,Hc.Width=nb.TaskpaneWidth,Hc.SharedRuntimeId=nb.SharedRuntimeId,Hc.Id=nb.PrimaryMarketplace.SolutionId,Hc.AppVersion=nb.PrimaryMarketplace.SolutionVersion,Hc.CurrentStoreType=
nb.PrimaryMarketplace.MarketplaceType,this.sag(Hc))}};a.prototype.Lia=function(){this.ei.Lia()};a.prototype.UM=function(nb,Hc,Cc){this.ei.UM(nb,Hc,Cc)};a.prototype.Goj=function(nb,Hc){var Cc=Array(2);Cc[0]=Hc;Cc[1]=null;this.ei.sDh(nb,JSON.stringify(Cc))};a.prototype.CUe=function(nb,Hc){Hc=a.s9g(Hc);nb=this.sZ(nb);this.ei.H9b(nb.InstanceId,2202,Ue.a.bX,Hc)};a.prototype.ibd=function(nb){for(var Hc=0,Cc=this.Ff.length;Hc<Cc;Hc++)this.CUe(this.Ff[Hc].controlId,nb)};a.prototype.oDh=function(nb,Hc){Hc=
a.R4g(Hc);this.ei.H9b(nb,65539,"",Hc)};a.prototype.qDh=function(nb,Hc,Cc){this.ei.H9b(nb,1,Hc,Cc)};a.prototype.nDh=function(nb,Hc){this.ei.rDh(nb,Hc)};a.prototype.i4g=function(nb,Hc){return[[2,1E3,"",JSON.stringify([nb,Hc]),0,!1]]};a.prototype.Vfi=function(){return!!this.ena&&this.ena.P7e()};a.prototype.dYg=function(){this.ena&&this.ena.clear()};a.prototype.pDh=function(){if(this.ena&&this.ena.P7e()){var nb=this.ena.FJh();nb=yl(nb);for(var Hc=nb.next();!Hc.done;Hc=nb.next()){Hc=this.vCh(Hc.value);
Hc=yl(Hc);for(var Cc=Hc.next();!Cc.done;Cc=Hc.next())this.ei.H9b(Cc.value,65540,"","{}")}}};a.prototype.S8i=function(nb){this.ena.add(nb)};a.prototype.eQj=function(nb){this.ena.remove(nb)};a.prototype.eja=function(nb){if(!this.Ff)return null;for(var Hc=yl(this.Ff),Cc=Hc.next();!Cc.done;Cc=Hc.next())if(Cc=Cc.value,nb(Cc))return Cc;return null};a.prototype.SDe=function(nb){var Hc=this,Cc=new pb.a,Sc=a.Yua(nb,this.$);if(Zc.HelperMethods.iw(nb))Ja.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),
this.zHf(nb,function(ae){ae?(nb.InstanceId=ae.InstanceId,nb.WebExtensionOsfControlType=3,nb.TaskpaneVisible=!1,Hc.F0a(nb),Cc.setResult(nb.InstanceId)):(Ja.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetAssetId(nb.PrimaryMarketplace.MarketplaceType,nb.PrimaryMarketplace.MarketplaceRef,nb.PrimaryMarketplace.SolutionId)),Cc.setException(Error.create("Null insert data")))});else{a.Y0a.ia(nb.InstanceId,new ub.a);var Uc=a.Y0a.oa(nb.InstanceId).q1a;
this.N5g(nb,Uc,Sc);this.zHf(nb,null);Cc.setResult(nb.InstanceId)}return Cc.task};a.prototype.N5g=function(nb,Hc,Cc){this.cn(nb.InstanceId)||(nb=new V(this,this.ei,nb),nb.YHa=Cc,nb.Caf(Hc),Array.add(this.Ff,nb),this.rxa=null)};a.prototype.zHf=function(nb,Hc){var Cc=a.Yua(nb,this.$);if(!this.zDd.contains(Cc))this.dFb.push(nb),1<=this.dFb.length&&this.AHf(nb,Hc);else if(Hc){nb=yl(this.CHf);for(var Sc=nb.next();!Sc.done;Sc=nb.next())if(Sc=Sc.value,a.Yua(Sc,this.$)===Cc){Hc(Sc,0);break}}};a.prototype.AHf=
function(nb,Hc){function Cc(dc){dc&&!Wb.a(dc)||Ja.ULS.sendTraceTag(537170527,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetAssetId(ue.StoreType,ue.StoreId,ue.SolutionId),tf.a.Tc(dc.Errors));Uc.dFb.shift();0<Uc.dFb.length&&Uc.AHf(Uc.dFb[0],Hc)}function Sc(dc){dc=Re.a.og(dc.data);Ja.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",tf.a.Tc(dc))}var Uc=this,
ae=null,ue={};ue.SolutionId=a.getSolutionId(nb,this.$);ue.TargetType=nb.WebExtensionType;ue.Version=nb.PrimaryMarketplace.SolutionVersion;ue.StoreType=nb.PrimaryMarketplace.MarketplaceType;ue.StoreId=nb.PrimaryMarketplace.MarketplaceRef;ue.AssetId=nb.PrimaryMarketplace.SolutionId;ue.AssetStoreId=nb.PrimaryMarketplace.MarketplaceRef;ue.Width=nb.TaskpaneWidth;ue.ContainsCustomFunctions=!0;ue.Id=a.getSolutionId(nb,this.$);ue.AppVersion=nb.PrimaryMarketplace.SolutionVersion;ue.CurrentStoreType=nb.PrimaryMarketplace.MarketplaceType;
Zc.HelperMethods.iw(nb)&&(ue.SharedRuntimeId=nb.SharedRuntime.Resid);var Lf=this.$.na.ta;nb=this.$.na.ta.Zb();var xf=Lf.Na(9,nb);xf.sharedInfo=ue;if(Hc){var Rf=function(dc){var Oc=dc.Result;(ae=Oc?Oc.AgaveData:null)||Hc(null,dc.Errors?dc.Errors[0].ErrorCause:5001);Hc(ae,0)};nb=function(dc,Oc,Ed){return ke.i(Lf,"InsertAgaveTaskpane",xf,mc.b(dc,Cc,Rf),mc.a(Oc,Sc),Ed,null,0)}}else nb=function(dc,Oc,Ed){return ke.i(Lf,"InsertAgaveTaskpane",xf,mc.b(dc,Cc),mc.a(Oc,Sc),Ed,null,0)};lb.EwaSettings.sc()?Cd.a(this.$.userOperationManager,
nb,function(dc){return new od.a(519,0,dc,64)},null):Cd.a(this.$.userOperationManager,nb,function(dc){return new Ec.a(519,0,dc)},null)};a.prototype.Xxj=function(){return this.$.jg.get(35)};a.prototype.SId=function(nb){nb=this.cn(nb);(null===nb||void 0===nb?0:nb.Cda)&&nb.cQf()};a.prototype.KEi=function(nb){var Hc=this.eja(function(Cc){return a.$La(Cc.zU)});Hc&&(Hc=this.Ji.getOsfControl(Hc.controlId))&&Hc.notifyAgave(OSF.AgaveHostAction.SendMessage,nb)};a.prototype.Hgi=function(){return!!this.eja(function(nb){return 1===
nb.controlType&&a.$La(nb.zU)})};a.prototype.Ggi=function(){var nb=this.eja(function(Hc){return a.$La(Hc.zU)});return nb?nb.ey?jd.DOMElementExtensions.isVisible(nb.ey):!1:!1};a.prototype.wrj=function(){var nb=this.eja(function(Hc){return a.$La(Hc.zU)});nb&&(nb.Nf(!0),this.raiseEvent("ca",nb.controlId))};a.prototype.initialize=function(){var nb=b(1342).DdaEventDispatch,Hc=void 0===this.$||null===this.$||lb.EwaSettings.la(261);void 0!==this.$&&null!==this.$||Ja.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");
Hc&&Ja.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(l.nGa(this.$),this.ea=this.$.ea,this.ei=new nb(this.$),this.$.Qk(this.rd),this.ea.Uj(this.$c),this.ea.RP(this.Hq),this.ea.Dt(this.Mf),this.$.userOperationManager.lx(this.ZR),this.Rlf(),this.nPi(),this.Uai(),this.$.da.Ha(35,this),this.gWc.ja(this),Hc&&Ja.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.Gfe=new Ue.a,Hc&&Ja.ULS.sendTraceTag(537170521,
0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.Jfe=new u(this.$,this.gj,this.ei),this.nvg=new B(this.$,this.gj,this.ei),this.Hfe=new J(this.$,this.gj,this.ei),this.Ffe=new r(this.$,this.gj,this.ei),this.Efe=new v(this.$,this.gj,this.ei),this.Ife=new C(this.$,this.gj,this.ei),this.Kfe=new t(this.$,this.gj,this.ei),this.Lfe=new y(this.$,this.gj,this.ei),this.$.Aba&&(this.Mfe=new x(this.$,this.gj,this.ei)),lb.EwaSettings.la(191)&&(this.f1a=new K(this,kc.g(this.$))),lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.Dfe=new D),this.initialized=!0,Ja.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.jDh=function(nb){if(!this.UBa)return null;for(var Hc=0,Cc=this.UBa.length;Hc<Cc;Hc++)if(nb.startsWith(this.UBa[Hc].WebExtensionId))return this.UBa[Hc];return null};a.prototype.Rlf=function(){var nb,Hc=this.ea;if(Hc.qc&&!this.DOb){if(Hc.workbookContext){if(this.WSc=this.$.ea.oh.get(22),null===(nb=Hc.workbookContext.WebExtensions)||void 0===nb?0:nb.length){nb=Hc.workbookContext.WebExtensions;
Hc=!1;for(var Cc={},Sc=nb.length-1;0<=Sc;Cc={XOb:Cc.XOb},Sc--){if(!this.ea.isNamedObjectViewMode){Array.add(this.Ooc,nb[Sc].InstanceId);if(1!==nb[Sc].WebExtensionType){Array.removeAt(nb,Sc);continue}if(Zc.HelperMethods.iw(nb[Sc])&&0!==nb[Sc].SharedRuntime.State)1===nb[Sc].SharedRuntime.State?nb[Sc].TaskpaneVisible=!1:2===nb[Sc].SharedRuntime.State?nb[Sc].TaskpaneVisible=!0:Ja.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!nb[Sc].ContainsCustomFunctions&&!nb[Sc].TaskpaneVisible&&
!Ua.a(nb[Sc])){Array.removeAt(nb,Sc);continue}}var Uc=OSF.OsfControl.isFirstPartyStoreString(nb[Sc].PrimaryMarketplace.MarketplaceType);lb.EwaSettings.la(187)&&!Uc&&(Array.removeAt(nb,Sc),Hc||(Hc=!0,Cc.XOb=Gc.GetServiceTaskFactory.Wa(this.$.da,5,4,3),sa.TaskExtensions.Ba(Cc.XOb,function(ae){return function(){ae.XOb.result.ig(35,null)}}(Cc),this.ma,3)));lb.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&nb[Sc].PrimaryMarketplace&&a.$La(nb[Sc].PrimaryMarketplace.SolutionId)&&
(Ja.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(nb,Sc))}this.rDe(nb)}}else this.WSc=!1;this.DOb=!0}};a.prototype.k6e=function(nb){var Hc=kc.g(this.$),Cc=Hc.ha.Pa.lc;if(Cc&&nb){nb=!1;if(this.Ff)for(var Sc=yl(this.Ff),Uc=Sc.next();!Uc.done;Uc=Sc.next())if(Uc=Uc.value,a.$La(Uc.zU)||a.Iji(Uc.zU)){nb=!0;break}nb||Hc.ha.Pa.bH(Cc)}};a.prototype.nPi=function(){this.Ji&&this.ea.isNamedObjectViewMode&&this.$.pa&&Zd.p(this.$.pa)&&(this.$.da.Aa(34).jR?
this.$.da.Aa(34).Vld():this.$.da.Aa(34).ar(this.sVi))};a.prototype.rDe=function(nb){var Hc=this,Cc=null;Cc=function(ae){function ue(){Hc.qPa.shift();0<Hc.qPa.length&&Cc(Hc.qPa[0])}var Lf=ae.WebExtensionData,xf=ae.IsTaskPane,Rf=ae.RecordHandler;if(Hc.yaa(Lf.PrimaryMarketplace.SolutionId))ue();else{xf&&(Lf.WebExtensionOsfControlType=1);var dc=Ua.a(Lf);if(!xf||Lf.TaskpaneVisible||dc||Lf.SharedRuntime&&0!==Lf.SharedRuntime.State||Lf.ContainsCustomFunctions){var Oc=new V(Hc,Hc.ei,Lf,!xf);Ja.ULS.sendTraceTag(537170517,
0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(Lf.PrimaryMarketplace.MarketplaceType,Lf.PrimaryMarketplace.MarketplaceRef,Lf.PrimaryMarketplace.SolutionId),Lf.PrimaryMarketplace.MarketplaceType,Zc.HelperMethods.iw(Lf));Oc.Gld();Zc.HelperMethods.iw(Lf)&&(Oc.YHa=a.Yua(Lf,Hc.$),Lf.TaskpaneWidth=Hc.C5b);dc&&(Lf.WebExtensionToolTip="");xf&&Lf.TaskpaneVisible&&!dc&&(Lf.TaskpaneWidth=Hc.C5b);Array.add(Hc.Ff,Oc);var Ed=Hc.rxa=
null;Ed=lf.a.instance.nC(function(){Oc.ey&&(sc.a.Fa(Ed),Ed=null,Rf&&Rf(ae,Oc),ue())},100,vc.a.Obh)}else ue()}};for(var Sc={},Uc=0;Uc<nb.length;Sc={q1:Sc.q1},Uc++)if(!this.cn(nb[Uc].InstanceId))if(1!==nb[Uc].WebExtensionType)this.F0a(nb[Uc]);else if(!lb.EwaSettings.la(54))this.Dmb(nb[Uc],Cc);else if(this.$.Hd&8388608||nb[Uc].TaskpaneVisible)Sc.q1={},Sc.q1.marketplaceId=nb[Uc].PrimaryMarketplace.SolutionId,Sc.q1.marketplaceVersion=nb[Uc].PrimaryMarketplace.SolutionVersion,Sc.q1.storeType=nb[Uc].PrimaryMarketplace.MarketplaceType,
Sc.q1.storeId=nb[Uc].PrimaryMarketplace.MarketplaceRef,Sc.q1.targetData=nb[Uc],this.Ji.isAddinCommandsAsync(Sc.q1,function(ae){return function(ue,Lf,xf){if(ue){var Rf=xf.targetData;if(Lf){if(lb.EwaSettings.la(88))if(ae.q1.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())ue=ae.q1.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),Lf=lb.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&ae.q1.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),
(ue||Lf)&&Zc.HelperMethods.iw(Rf)&&Hc.Dmb(Rf,Cc);else if(lb.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))Hc.H4h(xf,Cc);else{var dc=!1;Hc.VFd(function(Oc){if(!Oc.errorCode){if(Oc.value){Oc=yl(Oc.value);for(var Ed=Oc.next();!Ed.done&&!dc;Ed=Oc.next())dc=oc.c(Ed.value[1])===oc.c(Rf.PrimaryMarketplace.SolutionId)}dc?Zc.HelperMethods.iw(Rf)&&Hc.Dmb(Rf,Cc):(Oc={},Oc.SolutionId=xf.marketplaceId,Oc.TargetType=Rf.WebExtensionType,Oc.Version=xf.marketplaceVersion,
Oc.StoreType=Rf.PrimaryMarketplace.MarketplaceType,Oc.StoreId=xf.storeId,Oc.AssetId=xf.marketplaceId,Oc.AssetStoreId=xf.storeId,Oc.Width=Rf.TaskpaneWidth,Rf.TaskpaneVisible=!0,Oc.Id=xf.marketplaceId,Oc.AppVersion=xf.marketplaceVersion,Oc.CurrentStoreType=Rf.PrimaryMarketplace.MarketplaceType,Hc.Eke(Oc,Rf,Cc))}},!0)}}else Hc.Dmb(Rf,Cc)}else ue=xf.targetData,Ja.ULS.sendTraceTag(542185164,220,15,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetAssetId(ue.PrimaryMarketplace.MarketplaceType,
ue.PrimaryMarketplace.MarketplaceRef,ue.PrimaryMarketplace.SolutionId),ue.PrimaryMarketplace.MarketplaceType)}}(Sc))};a.prototype.H4h=function(nb,Hc){var Cc=this,Sc=!1;this.VFd(function(Uc){var ae=nb.targetData;if(!Uc.errorCode){if(Uc.value){Uc=yl(Uc.value);for(var ue=Uc.next();!ue.done&&!Sc;ue=Uc.next())Sc=oc.c(ue.value[1])===oc.c(ae.PrimaryMarketplace.SolutionId)}Sc?Zc.HelperMethods.iw(ae)&&Cc.Dmb(ae,Hc):(Uc={},Uc.SolutionId=nb.marketplaceId,Uc.TargetType=ae.WebExtensionType,Uc.Version=nb.marketplaceVersion,
Uc.StoreType=ae.PrimaryMarketplace.MarketplaceType,Uc.StoreId=nb.storeId,Uc.AssetId=nb.marketplaceId,Uc.AssetStoreId=nb.storeId,Uc.Width=ae.TaskpaneWidth,Uc.Id=nb.marketplaceId,Uc.AppVersion=nb.marketplaceVersion,Uc.CurrentStoreType=ae.PrimaryMarketplace.MarketplaceType,ae.TaskpaneVisible=!0,Cc.Eke(Uc,ae,Hc))}},!0)};a.prototype.Dmb=function(nb,Hc){var Cc={};Cc.WebExtensionData=nb;Cc.IsTaskPane=!0;this.qPa.push(Cc);1===this.qPa.length&&Hc(Cc)};a.prototype.Eke=function(nb,Hc,Cc){var Sc=this,Uc={};Uc.ActivationInfo=
nb;Uc.WebExtensionData=Hc;Uc.IsTaskPane=!1;Uc.RecordHandler=function(ae,ue){var Lf=ae.ActivationInfo;Sc.Ji.insertBlankControlWithErrorUX(Sc.CFb(ue,Lf),function(){Sc.rQa(ue.controlId);Sc.Ji.purgeOsfControl(ue.controlId,!1);Sc.sag(Lf)})};this.qPa.push(Uc);1===this.qPa.length&&Cc(Uc)};a.prototype.sag=function(nb){var Hc={};Hc.solutionId=nb.SolutionId;Hc.version=nb.Version;Hc.storeType=nb.StoreType;Hc.storeId=nb.StoreId;Hc.assetId=nb.AssetId;Hc.assetStoreId=nb.AssetStoreId;Hc.targetType=nb.TargetType;
Hc.sharedRuntimeId=nb.SharedRuntimeId;Hc.id=nb.Id;Hc.currentStoreType=nb.CurrentStoreType;Hc.appVersion=nb.AppVersion;nb=new Ub.a;nb.add(Hc);Hc={};Hc[Ya.a.NFa]=nb;Hc[Ya.a.zJ]=3;nb=new md.a(Ae.a.NAb,0,this.$.gd,0,null);this.$.Ka.Xb(nb,Hc)};a.prototype.CFb=function(nb,Hc){var Cc={};Cc.div=nb.ey;Cc.id=nb.controlId;Cc.solutionId=Hc.SolutionId;Cc.version=Hc.Version;Cc.storeId=Hc.StoreId;Cc.storeType=Hc.StoreType;Cc.osfControlType=OSF.OsfControlTarget.TaskPane;Cc.marketplaceID=Hc.Id;Cc.marketplaceVersion=
Hc.AppVersion;Cc.store=Hc.StoreId;return Cc};a.prototype.NTf=function(){var nb=this;if(lb.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var Hc=[],Cc=0;Cc<this.Ff.length;Cc++){var Sc=this.Ff[Cc];0!==Sc.osfControlType&&3!==Sc.osfControlType&&4!==Sc.osfControlType||Array.add(Hc,Sc)}Cc=!1;for(Sc=0;Sc<Hc.length;Sc++){var Uc=Hc[Sc];this.rQa(Uc.controlId);!Cc&&Uc&&Uc.el&&(Cc=Zc.HelperMethods.iw(Uc.el))}Cc&&(Hc={},Hc=(Hc.DynamicAddinCommandsMethodDispatchId=4,
Hc),this.kK(-1014260128,Hc))}lb.EwaSettings.la(413)&&sa.TaskExtensions.Ba(Gc.GetServiceTaskFactory.Wa(this.$.da,278,279,3),function(ae){ae&&(ae=ae.result)&&(nb.$.da.Aa(278)||nb.$.da.Ha(278,ae),ae.Fbf().hna())},this.ma,3)};a.prototype.nL=function(){var nb=this,Hc=new m(this.$,this.gj,this.LUf);void 0===this.$||null===this.$?Ja.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):lb.EwaSettings.la(261)&&Ja.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+
(void 0===this.gj||null===this.gj));if(Hc.xDi()){var Cc=function(){},Sc=function(ue){ue=Re.a.og(ue.data);Ja.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",tf.a.Tc(ue))},Uc=Hc.yRg();Hc=function(ue,Lf,xf){return ke.i(nb.$.na.ta,"ExecuteRichApiRequest",nb.ARg(Uc),mc.b(ue,Cc),mc.a(Lf,Sc),xf,null,0)};var ae=a.dgd(Uc);lb.EwaSettings.sc()?this.$.userOperationManager.Nt(new od.a(507,0,Hc,ae|64)):this.$.userOperationManager.Nt(new Ec.a(507,
0,Hc,ae))}};a.prototype.ARg=function(nb){var Hc=this.$.na.ta.Na(1);Hc.request=nb;return Hc};a.prototype.sye=function(nb,Hc){if(nb)for(var Cc=0;Cc<nb.length;Cc++)if(wc.a.equals(nb[Cc],Hc,!0))return!0;return!1};a.prototype.CQg=function(nb){var Hc={};Hc.navigationMode=OSF.OsfNavigationMode.DefaultMode;Hc.assetId=null;Hc.category=null;if(!nb||3>nb.length)return Hc;if(nb[0]){var Cc=parseInt(nb[0],10);isNaN(parseInt(Cc,10))||(Hc.navigationMode=Cc)}nb[1]&&(Hc.assetId=nb[1]);nb[2]&&(Hc.category=nb[2]);return Hc};
a.prototype.Uai=function(){if(lb.EwaSettings.la(62)){var nb=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(nb&&"*"!==nb.trim()){this.PIa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new la(this),nb,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.jg.get(2));try{this.PIa.init()}catch(Hc){try{this.PIa.dispose()}catch(Cc){}this.PIa=null;Ja.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+Hc.message)}nb={};nb.a=this.$.ya.UserSessionId;
Nd.b().Pe(39,nb)}}};a.prototype.A3f=function(nb,Hc,Cc){var Sc=this,Uc=a.QPg(nb[0]),ae=Uc.Fha,ue=Uc.Aia;Uc.Fha=function(){ae&&ae();var Lf=Uc.BLa!==OSF.InfoType.Error?Hc:null;nb.shift();nb.length?Sc.A3f(nb,Lf,Cc):Lf&&Lf()};Uc.Aia=function(){ue&&ue();Cc&&Uc.BLa!==OSF.InfoType.Error&&Cc()};Eb.a.vRd(Uc)};a.prototype.SRh=function(){var nb={};nb.AddinRibbonControlsOverriddenByApi=lb.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();nb.AddinActionDefinitionHybridMode=
lb.EwaSettings.la(665).toString();nb.UseActionIdForUILessCommand=lb.EwaSettings.la(669).toString();nb.AllowStorageAccessByUserActivationOnIFrame=lb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();nb.RequirementSetRibbonApiOnePointTwo=lb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();nb.flightingTreatmentVariables=Ta.AFrameworkApplication.ga.Q9b;nb.ShortcutInfoArrayInUserPreferenceData=
lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return nb};a.getSolutionId=function(nb){var Hc=nb.PrimaryMarketplace.SolutionId;lb.EwaSettings.la(298)&&nb.OwnerAddinSolutionId&&(Hc=nb.OwnerAddinSolutionId);return Hc};a.dgd=function(nb){var Hc=0;lb.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?nb.RequestFlags&1&&256!==(nb.RequestFlags&256)||(Hc=16):Hc=nb.RequestFlags&1?0:16;return Hc};a.Yua=function(nb,
Hc){Hc=a.getSolutionId(nb,Hc);return a.tZe(Hc,nb.PrimaryMarketplace.SolutionVersion,nb.PrimaryMarketplace.MarketplaceType,nb.PrimaryMarketplace.MarketplaceRef)};a.s9g=function(nb){var Hc={};nb=(Hc.recording=nb,Hc);return JSON.stringify(nb)};a.R4g=function(nb){var Hc={};Hc.visibility=nb?"Visible":"Hidden";return JSON.stringify(Hc)};a.$Nh=function(nb){var Hc=nb.getSolutionId(),Cc=nb.getVersion(),Sc=nb.getStoreType();nb=nb.getStoreId();return a.tZe(Hc,Cc,Sc,nb)};a.tZe=function(nb,Hc,Cc,Sc){return String.format("{0}|{1}|{2}|{3}|{4}|||",
"2",nb,Hc,a.LZh(Cc).toString(),Sc)};a.$hd=function(nb,Hc){var Cc=nb.split("|");if(7>Cc.length)return Ja.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Cc[0])return Ja.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",Cc[0]),null;var Sc=Cc[1],Uc=Cc[2],ae=a.MZh(Cc[3]),ue=Cc[4];Cc=Cc[5];Sc&&Sc.length||(Sc=Cc);Cc={};Cc.InstanceId=String.format("{{{0}}}",Mb.a.create().toString());
Cc.WebExtensionOsfControlType=4;Cc.WebExtensionType=1;Cc.PrimaryMarketplace={};Cc.PrimaryMarketplace.SolutionId=Sc;Cc.PrimaryMarketplace.SolutionVersion=Uc;Cc.PrimaryMarketplace.MarketplaceRef=ue;Cc.PrimaryMarketplace.MarketplaceType=ae;Cc.ContainsCustomFunctions=Hc?!0:!1;Hc&&(Cc.OsfPropertyBag=[["customFunctionAddinId",nb]]);return Cc};a.MZh=function(nb){nb=parseInt(nb,10);return nb===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:nb===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:nb===OSF.StoreTypeEnum.SPApp?
OSF.StoreType.SPApp:nb===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:nb===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:nb===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:nb===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:nb===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:nb===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:nb===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:nb===OSF.StoreTypeEnum.WopiCatalog?
OSF.StoreType.WopiCatalog:null};a.LZh=function(nb){return nb===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:nb===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:nb===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:nb===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:nb===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:nb===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:nb===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:nb===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:
nb===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:nb===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:nb===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.lrb=function(nb){var Hc={};Hc.Version=nb.appVersion;Hc.AssetId=nb.assetId;Hc.AssetStoreId=null!==nb.assetStoreId?nb.assetStoreId.toString():null;Hc.StoreType=nb.storeType;Hc.Height=nb.height;Hc.SolutionId=nb.solutionId;Hc.StoreId=nb.storeId;Hc.TargetType=nb.targetType;Hc.Width=1===Hc.TargetType?
0:nb.width;Hc.SharedRuntimeId=nb.sharedRuntimeId;Hc.AppVersion=nb.appVersion;Hc.CurrentStoreType=nb.currentStoreType;Hc.Id=nb.id;return Hc};a.Cyb=function(nb){return nb===OSF.DDA.EventDispId.dispidSettingsChangedEvent||nb===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||nb===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||nb===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||nb===OSF.DDA.EventDispId.dispidRichApiMessageEvent||nb===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||
nb===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||nb===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};a.QPg=function(nb){return Object.assign(new ze.a,{BLa:nb.infoType,id:nb.id,title:nb.title,description:nb.description,buttonText:nb.buttonTxt,Fha:nb.buttonCallback,Idc:nb.highPriority,Aia:nb.dismissCallback,errorCode:nb.errorCode,I$e:nb.iframeNotificationUrl})};a.$La=function(nb){var Hc="FA000000014"===nb;Hc||(Hc="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===nb);
return Hc};a.Iji=function(nb){return"FA000000005"===nb};Sk.Object.defineProperties(a.prototype,{y_b:{configurable:!0,enumerable:!0,get:function(){return this.gfa||(this.gfa=new ec.a(this.$.Vv))}},Ji:{configurable:!0,enumerable:!0,get:function(){if(!this.Pm){var nb={},Hc=!(this.$.Hd&1),Cc=jc.a.current.aL,Sc=this.$.workbookContext,Uc=Za.a.zL+Za.a.K2b,ae=0;lb.EwaSettings.la(509)&&(ae|=2);nb.pageBaseUrl=Cc.LayoutsContentUrlPrefix;nb.appName=OSF.AppName.ExcelWebApp;nb.appVersion="16";nb.appSettings=this.SRh();
nb.singleSignOnSettings=vb.AppsForOfficeSingleSignOnManager.qZh();nb.clientMode=Hc?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;nb.appUILocale=this.$.ya.UICultureTag;nb.dataLocale=this.$.ya.DataCultureTag;nb.docUrl=Sc.ClientUrl;nb.hostControl=this;nb.formFactor=OSF.FormFactor.Default;nb.lcid=this.$.RI.toString();nb.localizedScriptsUrl=Za.a.zL+Za.a.c2c;nb.localizedImagesUrl=Uc;nb.localizedStylesUrl=Za.a.zL+Za.a.rBe;nb.localizedResourcesUrl=Uc;nb.osfOmexBaseUrl=Cc.OsfOmexBaseUrl;nb.firstPartyManifestCDNUrl=
Cc.FirstPartyAddInManifestCDN;nb.sdxAssetsToPrefetchMapping=Ta.AFrameworkApplication.ga.Ua("SdxAssetsToPrefetchMapping");nb.sdxCdnUrl=Cc.SdxCdnUrl;nb.sdxDmsUrl=Cc.SdxDmsUrl;nb.devCatalogUrl=Cc.DevCatalogUrl;nb.controlStatusChanged=this.kma;nb.notifyHost=this.lBf;nb.allowExternalMarketplace=this.$.ea.oh.get(27)&&a.O2c;nb.enableAddinCommands=lb.EwaSettings.la(54);nb.enableBlackForestRedirect=lb.EwaSettings.la(89);nb.enableMyOrg=this.$.ea.oh.get(33);nb.enableMyApps=this.$.ea.oh.get(34);nb.enableDevCatalog=
lb.EwaSettings.la(45);nb.enablePrivateCatalog=this.Xxj();nb.enableTaskpaneUpgradeToAppCommand=lb.EwaSettings.la(94);nb.showSignOutFromPrivateCatalogMessage=this.$.ea.oh.get(36);nb.enableUploadFileDevCatalog=lb.EwaSettings.la(54)&&!lb.EwaSettings.la(286);nb.userNameHashCode=cb.a.Qv(Ta.AFrameworkApplication.userName);nb.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();nb.enableSingleSignOnForAddin=!lb.EwaSettings.la(24)&&Ta.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;
nb.enableDisplayBlockedMinorError=lb.EwaSettings.la(184);nb.hideAppsExtensionUrl=Ta.AFrameworkApplication.hideAppsExtensionUrl;nb.enableAnonymousUseLegacyCatalogService=lb.EwaSettings.la(174);nb.enableInsertDialogAccessibilityFix=lb.EwaSettings.la(181);nb.disableAppsForOfficeThirdParty=lb.EwaSettings.la(187);nb.enableFirstPartySSO=lb.EwaSettings.la(199);nb.wacSessionId=this.$.ya.UserSessionId;nb.disableLogging=!this.$.ya.AriaLoggingIsEnabled;nb.enableFirstPartySDXErrorMessages=lb.EwaSettings.la(212);
nb.enableRichApiCellEditDelay=lb.EwaSettings.la(191);nb.isHostDocumentDomain=lb.EwaSettings.la(228);nb.loggableUserId=Ta.AFrameworkApplication.ga.Ua("LoggableUserId");nb.sessionStartInfoJson=Ta.AFrameworkApplication.ga.Ua("SessionStartInfoJson");nb.wopiHostOriginFromPostMessage=Ta.AFrameworkApplication.wopiHostOriginFromPostMessage;nb.wopiHostOriginFromWacPropBag=Ta.AFrameworkApplication.ga.Ua("PostMessageOrigin");nb.wacIsEmbedded=Ta.AFrameworkApplication.ga.ra("IsEmbedded");nb.accessibilityAllowFocusAddinTaskpane=
Ta.AFrameworkApplication.ga.ra("AccessibilityAllowFocusAddinTaskpane");nb.enableRemoveAppCommandsAddin=Ta.AFrameworkApplication.ga.ra("RemoveAppCommandsAddinIsEnabled");nb.isHostFrameTrustCheckEnabledForAddIns=Ta.AFrameworkApplication.ga.ra("HostFrameTrustCheckIsEnabledForAddIns");nb.isHostFrameTrusted=Ta.AFrameworkApplication.isHostFrameTrusted;nb.agaveAddinUploadEnabled=lb.EwaSettings.la(47);nb.hostAllowedOfficeStore=Ta.AFrameworkApplication.ga.ra("HostAllowedOfficeStore");nb.hostAllowedSdxEmbedding=
Ta.AFrameworkApplication.ga.ra("HostAllowedSdxEmbedding");nb.hostInstallAddIns=Ta.AFrameworkApplication.ga.Ua("HostInstallAddIns");nb.hostInstallAddInsIsEnabled=Ta.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled");nb.approvedAddIns=Ta.AFrameworkApplication.ga.Ua("ApprovedAddIns");nb.addinEnforceHttpsIsEnabled=this.exj(nb.sessionStartInfoJson);nb.hostFeatureGateFlag=ae;nb.isUpnCheckEnabled=Ta.AFrameworkApplication.ga.ra("IsUpnCheckEnabled");nb.wacUpn=Ta.AFrameworkApplication.ga.Ua("UserPrincipalName");
nb.isReactRibbonEnabled=Lb.a.isReactRibbonEnabled();nb.enableSetFocusOnTaskpaneOnUserAction=lb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);nb.isSafariWithIndexedDBDisabled=lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Cb.a.T6a;nb.isIndexedDBDisabled=lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Cb.a.T6a||lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&
Cb.a.Df;nb.enableCustomShortcuts=lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");nb.changeGetModifierKeyStringOutputOrder=lb.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");this.Pm=new OSF.ContextActivationManager(nb);nb={};this.Pm.setIframeAttributeBag((nb.frameborder=0,nb.marginheight=0,nb.marginwidth=0,nb));this.Pm.setWSA(Ta.AFrameworkApplication.Mm);this.Pm&&"undefined"!==typeof this.Pm.hostCheckReadyHandler&&Ta.AFrameworkApplication.zFg(Object(hc.a)(this.Pm,
this.Pm.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var ue=mb.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Pm.setOAuthManager(ue)}catch(Lf){}}return this.Pm}},dYj:{configurable:!0,enumerable:!0,get:function(){return this.WSc}},gj:{configurable:!0,enumerable:!0,get:function(){return this.Gfe}},ena:{configurable:!0,enumerable:!0,get:function(){return this.Dfe}},ULd:{configurable:!0,enumerable:!0,get:function(){return this.Hfe}},TLd:{configurable:!0,enumerable:!0,get:function(){return this.Ffe}},
Djj:{configurable:!0,enumerable:!0,get:function(){return this.Jfe}},Bjj:{configurable:!0,enumerable:!0,get:function(){return this.Efe}},Cjj:{configurable:!0,enumerable:!0,get:function(){return this.Ife}},Ejj:{configurable:!0,enumerable:!0,get:function(){return this.Kfe}},Fjj:{configurable:!0,enumerable:!0,get:function(){return this.Lfe}},VLd:{configurable:!0,enumerable:!0,get:function(){return this.Mfe}},KV:{configurable:!0,enumerable:!0,get:function(){return this.Kqg}},$:{configurable:!0,enumerable:!0,
get:function(){return this.vb}}});Sk.Object.defineProperties(a,{O2c:{configurable:!0,enumerable:!0,get:function(){return a.l4d},set:function(nb){a.l4d=nb}}});a.Y0a=new Dc.a;a.l4d=!0;Object(db.a)(a,"DdaFacade",ic.a,[224,417,415,418,419,3])},869:function(A,F,b){function a(){this.jId=0;this.PW={};this.$sa={}}b.d(F,"a",function(){return a});A=b(0);var c=b(13),e=b(109);a.prototype.oVh=function(l,n){return this.PW[a.SYc(l,n)]};a.prototype.BLe=function(l,n){n||void 0!==this.$sa[l]&&null!==this.$sa[l]?n&&
void 0!==this.$sa[l]&&null!==this.$sa[l]&&delete this.$sa[l]:this.$sa[l]=1};a.prototype.q_b=function(l){return void 0===this.$sa[l]||null===this.$sa[l]};a.prototype.K3h=function(l){var n=a.SYc(l.messageType,l.targetId);1===l.actionType?this.c5h(l.controlId,l.messageType,n):2===l.actionType&&this.N5h(l.controlId,l.messageType,n)};a.prototype.Aaj=function(l){if(l){var n=Object.keys(this.PW);if(!(void 0===n||null===n||0>=n.length)){n=yl(n);for(var m=n.next();!m.done;m=n.next()){m=m.value;var f=this.PW[m];
f[l]&&(delete f[l],Object.keys(f).length||delete this.PW[m])}}}};a.prototype.$Z=function(l,n){l=a.SYc(l,n);l=this.PW[l];return!!l&&0<Object.keys(l).length};a.prototype.E6h=function(){return!e.a.isEmpty(this.PW)};a.prototype.qif=function(){return 0<this.jId};a.prototype.JPh=function(){var l=[],n=this.PW,m;for(m in n){var f=m,x=n[m],y;for(y in x){x=y;var t={};t.eventType=parseInt(f.split("#")[0],10);t.targetId=f.split("#")[1];t.addinId=x;l.push(t)}}return l};a.prototype.c5h=function(l,n,m){if(this.PW[m])m=
this.PW[m],m[l]=m[l]?m[l]+1:1;else{var f={};f[l]=1;this.PW[m]=f}100===n&&this.jId++};a.prototype.N5h=function(l,n,m){if(this.PW[m]){var f=this.PW[m];if(l){var x=f[l];1===x?(delete f[l],Object.keys(f).length||delete this.PW[m]):f[l]=x-1;100===n&&this.jId--}else c.ULS.sendTraceTag(537170459,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",l,m)}else c.ULS.sendTraceTag(537170460,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",m)};a.SYc=function(l,n){return String.format("{0}#{1}",
l,n)};a.bX="Workbook";Object(A.a)(a,"RichApiEventRegistration",null,[])},894:function(A,F,b){function a(c,e,l,n){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=c;this.controlId=e;this.ddaBinding=l;this.ArrayData=void 0===n?null:n}b.d(F,"a",function(){return a});A=b(0);a.prototype.getDispid=function(){return this.dispid};a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(A.a)(a,"DdaEventArgs",null,[])},941:function(A,F,b){function a(e,l,n){this.JPb=
e;this.Ekg=l;this.Fkg=n}function c(){this.title=this.id=this.tabs=null}A=b(0);Object(A.a)(c,"AddInDataTransferObject",null,[]);b.d(F,"a",function(){return a});a.jub=function(e){return(e=e.qW)?Object.assign(new c,{tabs:e.Nr.toArray(),id:e.zBg,title:e.ABg}):null};Sk.Object.defineProperties(a.prototype,{Nr:{configurable:!0,enumerable:!0,get:function(){return this.JPb}},zBg:{configurable:!0,enumerable:!0,get:function(){return this.Ekg}},ABg:{configurable:!0,enumerable:!0,get:function(){return this.Fkg}}});
Object(A.a)(a,"OneLineRibbonExtensibility",null,[])},949:function(A,F,b){function a(){var e={};this.D$c=(e.tabhome="Ribbon.Home",e.tabinsert="Ribbon.Insert",e.tabdata="Ribbon.Data",e.tabreview="Ribbon.Review",e.tabview="Ribbon.View",e);e={};this.B$c=(e.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",c.a.instance.fa(1588),c.a.instance.fa(1592)],e.tabformulas=["Ribbon.Formulas",c.a.instance.fa(1589),c.a.instance.fa(1593)],e.tabdeveloper=["Ribbon.Developer",c.a.instance.fa(1590),c.a.instance.fa(1594)],
e.tabaddins=["Ribbon.AddIns",c.a.instance.fa(1591),c.a.instance.fa(1595)],e);this.Wyh="Ribbon.Home Ribbon.Insert Ribbon.PageLayoutExcel Ribbon.Formulas Ribbon.Data Ribbon.Review Ribbon.View Ribbon.Developer Ribbon.AddIns".split(" ");this.o2a=null}b.d(F,"a",function(){return a});A=b(0);var c=b(14);a.prototype.QTh=function(){if(this.o2a)return this.o2a;this.o2a={};for(var e=yl(Object.keys(this.D$c)),l=e.next();!l.done;l=e.next())l=l.value,this.o2a[l]=this.D$c[l];e=yl(Object.keys(this.B$c));for(l=e.next();!l.done;l=
e.next())l=l.value,this.o2a[l]=this.B$c[l][0];return this.o2a};Sk.Object.defineProperties(a.prototype,{jia:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},oK:{configurable:!0,enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}},jzc:{configurable:!0,enumerable:!0,get:function(){return this.D$c}},i$a:{configurable:!0,enumerable:!0,get:function(){return this.Wyh}},BBi:{configurable:!0,enumerable:!0,
get:function(){return this.B$c}}});Object(A.a)(a,"AddinCommandsStringProvider",null,[454])},985:function(A,F,b){function a(Q,la){this.uEc=new t.a;this.Pm=Q;this.ayg=la}function c(Q,la,ba,T){this.uT=new x.a;this.zG=new x.a;this.vpa=null;this.Zkb=new x.a;this.dae=Promise.resolve(null);this.whe=!1;this.iVb=la;this.lng=Q;this.Yhe=ba;this.Jkg=T}function e(){var Q=l.call(this)||this;Q.errorCode=0;return Q}function l(){this.oQb=new x.a;this.V9=this.U9=!1;this.ooa=this.authChallenge=null;this.startTime=this.retryCount=
0;this.gpe=null}function n(){this.token=null;this.expiresOn=0;this.rha=this.authChallenge=null}function m(){this.accessToken=null}function f(){this.startTime=0;this.callback=null}b.r(F);A=b(0);var x=b(184),y=b(13),t=b(100);Object(A.a)(f,"SSOCallbackInfo",null,[]);Object(A.a)(m,"AccessTokenInformation",null,[548]);var B=b(1117);Object(A.a)(n,"CachedTokenInfo",null,[]);Sk.Object.defineProperties(l.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.oQb}}});Object(A.a)(l,"SSORequestInfo",
null,[]);vm(e,l);Object(A.a)(e,"SSOFailedRequestInfo",l,[]);var z=b(5);c.prototype.$yj=function(Q){if(this.vpa&&this.vpa.authChallenge===Q.authChallenge){if(Date.now()/1E3+c.Fzi>this.vpa.expiresOn)return this.vpa=null,!1;Q=new B.a;Q.token=this.vpa.token;Q.expiresOn=this.vpa.expiresOn;Q.rha=this.vpa.rha;Q.iTa=!0;Q.Yvb=0;this.qwb(Q);return!0}return!1};c.prototype.Dxj=function(Q){for(var la=0;la<this.zG.count;la++)if(this.zG.oa(la).authChallenge===Q.authChallenge&&this.zG.oa(la).ooa===Q.ooa){var ba=
void 0;(ba=this.zG.oa(la)).retryCount=ba.retryCount+1;Q.retryCount=this.zG.oa(la).retryCount;if(this.zG.oa(la).retryCount<c.bAi||!this.zG.oa(la).U9&&Q.U9||!this.zG.oa(la).V9&&Q.V9){if(!this.zG.oa(la).U9&&Q.U9||!this.zG.oa(la).V9&&Q.V9)Q.retryCount=0;this.zG.removeAt(la);break}Q=new B.a;Q.errorCode=this.zG.oa(la).errorCode;this.qwb(Q);return!0}return!1};c.prototype.pDg=function(Q,la){for(var ba=0;ba<this.zG.count;ba++)if(this.zG.oa(ba).ooa===Q.ooa&&this.zG.oa(ba).authChallenge===Q.authChallenge)return;
this.zG.add(Object.assign(new e,{U9:Q.U9,V9:Q.V9,authChallenge:Q.authChallenge,ooa:Q.ooa,errorCode:la,retryCount:Q.retryCount}))};c.prototype.ddd=function(Q,la,ba,T,H,S){var K=this,da=b(985).AppsForOfficeSingleSignOnManager;""===ba&&(ba=null);if(this.whe)da.R5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var fa=null,X=yl(this.uT),ca=X.next();!ca.done;ca=X.next())if(ca=ca.value,ca.U9===Q&&ca.V9===la&&ca.authChallenge===ba&&ca.ooa===H){fa=ca;break}fa||(fa=Object.assign(new l,
{U9:Q,V9:la,authChallenge:ba,gpe:T,ooa:H,retryCount:0,startTime:da.ew()}),this.uT.add(fa));fa.retryCount=0;fa.callbacks.add(S);this.dae=this.dae.then(function(){var ja=b(985).AppsForOfficeSingleSignOnManager;if(0<K.uT.count){var ea=K.uT.oa(0);if(K.$yj(ea)||K.Dxj(ea))return null;for(var qa=0;qa<K.Zkb.count;)K.Zkb.oa(qa)+c.tKj<ja.ew()?K.Zkb.removeAt(qa):qa++;if(K.Zkb.count>=c.Xzi||K.uT.count>=c.Czi)return ea=new B.a,ea.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,K.qwb(ea),null;
var pa=null;z.AFrameworkApplication.sa&&(ja=z.AFrameworkApplication.sa.xD)&&(pa=ja.Hc("ComponentAttach",K.lng+c.Wwg));return ea.ooa.vzg(K.resource,ea.U9,ea.V9,ea.authChallenge,K.Jkg,ea.gpe).then(function(Pa){pa&&pa.stop();K.qwb(Pa)},function(){pa&&pa.stop();var Pa=new B.a;Pa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;K.qwb(Pa)})}return null})}};c.prototype.qwb=function(Q){var la=b(985).AppsForOfficeSingleSignOnManager;try{if(this.uT.count){var ba=this.uT.oa(0);this.uT.removeAt(0);
var T=null;Q.errorCode||(T=new m,T.accessToken=Q.token);Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&Q.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.pDg(ba,Q.errorCode);var H={};null!=Q.Yvb&&(H.getTokenSilentTime=Q.Yvb.toString());null!=Q.Fhd&&(H.getTokenPopupTime=Q.Fhd.toString());null!=Q.pfd&&(H.getIDTokenTime=
Q.pfd.toString());null!=Q.iTa&&(H.tokenCached=Q.iTa.toString());Q.hVd&&(H.detailedError=Q.hVd);Q.rha&&(H.authLibrary=Q.rha);ba.retryCount&&(H.retryCount=ba.retryCount);for(var S=yl(ba.callbacks),K=S.next();!K.done;K=S.next())la.R5(K.value,Q.errorCode,T,H);null!=Q.iTa&&Q.iTa||this.Zkb.add(ba.startTime);if(!Q.errorCode)for(null!=Q.expiresOn&&(this.vpa=Object.assign(new n,{token:Q.token,expiresOn:Q.expiresOn,authChallenge:ba.authChallenge,rha:Q.rha})),this.zG.clear(),S=0;S<this.uT.count;)if(this.uT.oa(S).authChallenge===
ba.authChallenge){var da=yl(this.uT.oa(S).callbacks);for(K=da.next();!K.done;K=da.next())la.R5(K.value,Q.errorCode,T,H);this.uT.removeAt(S)}else S++}}catch(fa){y.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",fa.message)}};c.prototype.shutdown=function(){this.whe=!0;this.uT.clear()};Sk.Object.defineProperties(c.prototype,{resource:{configurable:!0,enumerable:!0,get:function(){return this.iVb}}});c.tKj=6E4;c.Xzi=6;c.Czi=6;c.bAi=3;c.Fzi=300;c.Wwg="GetAccessToken";
Object(A.a)(c,"SSOCallbackManager",null,[]);var u=b(845),C=b(857),r=b(116),J=b(78),v=b(23),D=b(29),V=b(151),U=b(337);b.d(F,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.edd=function(Q,la,ba,T,H,S,K,da,fa,X){X=Object.assign(new f,{startTime:a.ew(),callback:X});try{var ca=!!ba&&""!==ba,ja=X.startTime,ea=this.getOsfControl(Q),qa=ea.getStoreType()||"",pa=ea.getOwnerAddinStoreType()||"",Pa=ea.getSolutionId()||"",Ha=ea.getVersion()||"";qa=qa.toLowerCase();pa=pa.toLowerCase();Pa=Pa.toLowerCase();
var Xa=J.a.ofd(la)||"",Na=J.a.ofd(ea.getIframeUrl())||"",db=Xa.toLowerCase()===Na.toLowerCase();Xa=qa;"inmemory"===qa&&(Xa=pa);var Ja=Telemetry.PrivacyRules.GetAssetId(Xa,ea.getStoreId(),Pa);ea={};var jb=(ea.callInstanceId=ja.toString(),ea.controlAssetId=Ja,ea.controlVersion=Ha,ea.storeType=qa,ea.ownerStoreType=pa,ea.allowConsentPrompt=T.toString(),ea.forMSGraphAccess=H.toString(),ea.allowSignInPrompt=S.toString(),ea.hasAddinAuthChallenge=ca.toString(),ea.securityOriginEqualsSourceLocation=db.toString(),
ea.singleSignOnEnabled=K.toString(),ea.accountTypeFilter=da||"",ea);y.ULS.sendTraceTag(51401115,344,50,"{0}",jb);V.a.sendTelemetryEvent(Object.assign(new U.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:r.a.Rk(jb)}));ja=!0;var hc=z.AFrameworkApplication.ga.Ua("HostAuthType");switch(da){case "aad":ja="aad"===hc;break;case "msa":ja="msa"===hc;break;default:ja=!da||"noFilter"===da}if(ja){da=null;if(K)for(var ma=yl(this.ayg),Ka=ma.next();!Ka.done;Ka=ma.next()){var Ta=Ka.value;
if(Ta.eii(Pa)){da=Ta;break}}da?this.isSSOAddin(Q)?(K=!0,"omex"===Xa&&(K=!1),"spapp"===Xa||"spcatalog"===Xa?(y.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.R5(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):H&&!K?(y.ULS.sendTraceTag(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),a.R5(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(H&&"exchange"===Xa&&
(T=!1),this.ddd(Q,la,ba,Xa,T,S,fa,da,X))):(y.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.R5(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.R5(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else a.R5(X,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,null,null)}catch(ob){this.Njc(),y.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",ob.message),a.R5(X,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(Q,la,ba,T){this.edd(Q,ba[u.a.NVc]||null,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||!1,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,la,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||
null,ba[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,T)};a.prototype.ddd=function(Q,la,ba,T,H,S,K,da,fa){this.uEc.xb(Q)?T=this.uEc.oa(Q):(T=new c(Q,this.getWebApplicationResource(Q).split(",")[0],T,this.getDefaultDisplayName(Q)),this.uEc.add(Q,T));var X=T.resource;Q=a.KXh(X,this.getWebApplicationId(Q));var ca=OfficeExt.WACUtils.getHostSecure(la);Q&&ca?Q.toLowerCase()===ca.toLowerCase()?T.ddd(H,S,ba,K,da,fa):(a.LNa('SSO Resource "'+X+'" cannot be used from "'+la+'" origin due to domain mismatch.'),
y.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.R5(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(Q||y.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),ca||y.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.R5(fa,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))};a.prototype.Njc=function(){var Q={};y.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",
(Q.UserAgent=window.navigator.userAgent,Q))};a.prototype.getOsfControl=function(Q){return this.Pm.getOsfControl(Q)};a.prototype.isSSOAddin=function(Q){return this.getOsfControl(Q).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=function(Q){return this.getOsfControl(Q).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=function(Q){return this.getOsfControl(Q).getManifest().getWebApplicationResource()};a.prototype.getDefaultDisplayName=function(Q){return this.getOsfControl(Q).getManifest().getDefaultDisplayName()};
a.qZh=function(){try{var Q={};v.a.ala&&C.a.hxb&&(Q.UiHostSupportsAuthTokenAddinList=a.KUe);Q.UiHostSupportsAuthToken=C.a.hxb;return Q}catch(la){y.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",la.message)}return null};a.getInstance=function(Q,la,ba){ba=void 0===ba?null:ba;a.Oa||(la=new x.a,ba&&la.add(ba.gyi),a.Oa=new a(Q,la));return a.Oa};a.LNa=function(Q){window.console.warn&&window.console.warn(Q)};a.KXh=function(Q,la){if(!Q)return"";la||(la="");var ba=
Q.toLowerCase(),T=la.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(T)||(a.LNa('SSO App Id "'+la+'" is not a valid format. It will be rejected from store submission.'),y.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));ba.endsWith(T)||(a.LNa('SSO Resource "'+Q+'" does not end with App Id "'+la+'". It will be rejected from store submission.'),y.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!ba.startsWith("https://")&&
!ba.startsWith("api://"))return a.LNa('SSO Resource "'+Q+'" must be https:// or api:// protocol.'),y.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(la=0;la<Q.length;la++){T=Q.charAt(la);var H=D.a.charCodeAt(Q,la);if(33>H||126<H||"&"===T||"?"===T||"#"===T||"%"===T||"\\"===T)return a.LNa('SSO Resource "'+Q+'" contains an invalid character "'+T+'".'),y.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+T+"' in resource URI."),""}if(0<=Q.indexOf("::"))return a.LNa('SSO Resource "'+
Q+'" contains an invalid string "::".'),y.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<Q.length)return a.LNa('SSO Resource "'+Q+'" is '+Q.length+" characters and exceeds the max length of 120 characters."),y.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+Q.length+"."),"";ba.startsWith("api://")&&(ba="https://"+ba.substring(6,ba.length));return 8===ba.length?"":OfficeExt.WACUtils.getHostSecure(ba)||""};a.R5=function(Q,la,ba,T){var H=Q.startTime,S=0;0<H&&(S=a.ew()-H);
var K={};H=(K.callInstanceId=H.toString(),K.callDuration=S.toString(),K.errorCode=la.toString(),K);if(T)for(var da in T)H[da]=T[da];y.ULS.sendTraceTag(51401116,344,50,"{0}",H);V.a.sendTelemetryEvent(Object.assign(new U.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:r.a.Rk(H)}));Q.callback(la,ba)};a.ew=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(Q){}return Date.now()};a.KUe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");
a.Oa=null;Object(A.a)(a,"AppsForOfficeSingleSignOnManager",null,[520])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.agave.js.map/c0eaca4a5beb81db0e84470f041c33c7/EwaDS.agave.js.map